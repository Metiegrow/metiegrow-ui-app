/*! For license information please see 16.daa9efd3.chunk.js.LICENSE.txt */
(this["webpackJsonpgogo-react"]=this["webpackJsonpgogo-react"]||[]).push([[16],Array(124).concat([function(e,t,n){"use strict";function r(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}n.d(t,"a",(function(){return r}))},,function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(25),o=n(124);function i(e){Object(o.a)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===Object(r.a)(e)&&"[object Date]"===t?new Date(e.getTime()):"number"===typeof e||"[object Number]"===t?new Date(e):("string"!==typeof e&&"[object String]"!==t||"undefined"===typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(50);function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Object(r.a)(o.key),o)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(49);function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Object(r.a)(e,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(292);function o(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(o=function(){return!!e})()}var i=n(25),a=n(35);function s(e){var t=o();return function(){var n,o=Object(r.a)(e);if(t){var s=Object(r.a)(this).constructor;n=Reflect.construct(o,arguments,s)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"==Object(i.a)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Object(a.a)(e)}(this,n)}}},,function(e,t,n){"use strict";function r(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}n.d(t,"a",(function(){return r}))},,,,,,,,function(e,t,n){"use strict";var r=n(11),o=n(217),i=n(127),a=n(128),s=n(129),c=n(216),l=n(2),u=n.n(l),d=n(289),p=Number.isNaN||function(e){return"number"===typeof e&&e!==e};function h(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(r=e[n],o=t[n],!(r===o||p(r)&&p(o)))return!1;var r,o;return!0}var f=function(e,t){var n;void 0===t&&(t=h);var r,o=[],i=!1;return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return i&&n===this&&t(a,o)||(r=e.apply(this,a),i=!0,n=this,o=a),r}},m=n(137);for(var v={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},g=function(e){return Object(d.c)("span",Object(r.a)({css:v},e))},E={guidance:function(e){var t=e.isSearchable,n=e.isMulti,r=e.isDisabled,o=e.tabSelectsValue;switch(e.context){case"menu":return"Use Up and Down to choose options".concat(r?"":", press Enter to select the currently focused option",", press Escape to exit the menu").concat(o?", press Tab to select the option and exit the menu":"",".");case"input":return"".concat(e["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(n?" press left to focus selected values":"");case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(e){var t=e.action,n=e.label,r=void 0===n?"":n,o=e.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(r,", deselected.");case"select-option":return"option ".concat(r,o?" is disabled. Select another option.":", selected.");default:return""}},onFocus:function(e){var t=e.context,n=e.focused,r=void 0===n?{}:n,o=e.options,i=e.label,a=void 0===i?"":i,s=e.selectValue,c=e.isDisabled,l=e.isSelected,u=function(e,t){return e&&e.length?"".concat(e.indexOf(t)+1," of ").concat(e.length):""};if("value"===t&&s)return"value ".concat(a," focused, ").concat(u(s,r),".");if("menu"===t){var d=c?" disabled":"",p="".concat(l?"selected":"focused").concat(d);return"option ".concat(a," ").concat(p,", ").concat(u(o,r),".")}return""},onFilter:function(e){var t=e.inputValue,n=e.resultsMessage;return"".concat(n).concat(t?" for search term "+t:"",".")}},y=function(e){var t=e.ariaSelection,n=e.focusedOption,r=e.focusedValue,i=e.focusableOptions,a=e.isFocused,s=e.selectValue,c=e.selectProps,p=c.ariaLiveMessages,h=c.getOptionLabel,f=c.inputValue,m=c.isMulti,v=c.isOptionDisabled,y=c.isSearchable,_=c.menuIsOpen,b=c.options,T=c.screenReaderStatus,S=c.tabSelectsValue,O=c["aria-label"],R=c["aria-live"],C=Object(l.useMemo)((function(){return Object(o.j)(Object(o.j)({},E),p||{})}),[p]),w=Object(l.useMemo)((function(){var e,n="";if(t&&C.onChange){var r=t.option,i=t.removedValue,a=t.value,s=i||r||(e=a,Array.isArray(e)?null:e),c=Object(o.j)({isDisabled:s&&v(s),label:s?h(s):""},t);n=C.onChange(c)}return n}),[t,v,h,C]),I=Object(l.useMemo)((function(){var e="",t=n||r,o=!!(n&&s&&s.includes(n));if(t&&C.onFocus){var i={focused:t,label:h(t),isDisabled:v(t),isSelected:o,options:b,context:t===n?"menu":"value",selectValue:s};e=C.onFocus(i)}return e}),[n,r,h,v,C,b,s]),A=Object(l.useMemo)((function(){var e="";if(_&&b.length&&C.onFilter){var t=T({count:i.length});e=C.onFilter({inputValue:f,resultsMessage:t})}return e}),[i,f,_,C,b,T]),N=Object(l.useMemo)((function(){var e="";if(C.guidance){var t=r?"value":_?"menu":"input";e=C.guidance({"aria-label":O,context:t,isDisabled:n&&v(n),isMulti:m,isSearchable:y,tabSelectsValue:S})}return e}),[O,n,r,m,v,y,_,C,S]),k="".concat(I," ").concat(A," ").concat(N);return Object(d.c)(g,{"aria-live":R,"aria-atomic":"false","aria-relevant":"additions text"},a&&Object(d.c)(u.a.Fragment,null,Object(d.c)("span",{id:"aria-selection"},w),Object(d.c)("span",{id:"aria-context"},k)))},_=[{base:"A",letters:"A\u24b6\uff21\xc0\xc1\xc2\u1ea6\u1ea4\u1eaa\u1ea8\xc3\u0100\u0102\u1eb0\u1eae\u1eb4\u1eb2\u0226\u01e0\xc4\u01de\u1ea2\xc5\u01fa\u01cd\u0200\u0202\u1ea0\u1eac\u1eb6\u1e00\u0104\u023a\u2c6f"},{base:"AA",letters:"\ua732"},{base:"AE",letters:"\xc6\u01fc\u01e2"},{base:"AO",letters:"\ua734"},{base:"AU",letters:"\ua736"},{base:"AV",letters:"\ua738\ua73a"},{base:"AY",letters:"\ua73c"},{base:"B",letters:"B\u24b7\uff22\u1e02\u1e04\u1e06\u0243\u0182\u0181"},{base:"C",letters:"C\u24b8\uff23\u0106\u0108\u010a\u010c\xc7\u1e08\u0187\u023b\ua73e"},{base:"D",letters:"D\u24b9\uff24\u1e0a\u010e\u1e0c\u1e10\u1e12\u1e0e\u0110\u018b\u018a\u0189\ua779"},{base:"DZ",letters:"\u01f1\u01c4"},{base:"Dz",letters:"\u01f2\u01c5"},{base:"E",letters:"E\u24ba\uff25\xc8\xc9\xca\u1ec0\u1ebe\u1ec4\u1ec2\u1ebc\u0112\u1e14\u1e16\u0114\u0116\xcb\u1eba\u011a\u0204\u0206\u1eb8\u1ec6\u0228\u1e1c\u0118\u1e18\u1e1a\u0190\u018e"},{base:"F",letters:"F\u24bb\uff26\u1e1e\u0191\ua77b"},{base:"G",letters:"G\u24bc\uff27\u01f4\u011c\u1e20\u011e\u0120\u01e6\u0122\u01e4\u0193\ua7a0\ua77d\ua77e"},{base:"H",letters:"H\u24bd\uff28\u0124\u1e22\u1e26\u021e\u1e24\u1e28\u1e2a\u0126\u2c67\u2c75\ua78d"},{base:"I",letters:"I\u24be\uff29\xcc\xcd\xce\u0128\u012a\u012c\u0130\xcf\u1e2e\u1ec8\u01cf\u0208\u020a\u1eca\u012e\u1e2c\u0197"},{base:"J",letters:"J\u24bf\uff2a\u0134\u0248"},{base:"K",letters:"K\u24c0\uff2b\u1e30\u01e8\u1e32\u0136\u1e34\u0198\u2c69\ua740\ua742\ua744\ua7a2"},{base:"L",letters:"L\u24c1\uff2c\u013f\u0139\u013d\u1e36\u1e38\u013b\u1e3c\u1e3a\u0141\u023d\u2c62\u2c60\ua748\ua746\ua780"},{base:"LJ",letters:"\u01c7"},{base:"Lj",letters:"\u01c8"},{base:"M",letters:"M\u24c2\uff2d\u1e3e\u1e40\u1e42\u2c6e\u019c"},{base:"N",letters:"N\u24c3\uff2e\u01f8\u0143\xd1\u1e44\u0147\u1e46\u0145\u1e4a\u1e48\u0220\u019d\ua790\ua7a4"},{base:"NJ",letters:"\u01ca"},{base:"Nj",letters:"\u01cb"},{base:"O",letters:"O\u24c4\uff2f\xd2\xd3\xd4\u1ed2\u1ed0\u1ed6\u1ed4\xd5\u1e4c\u022c\u1e4e\u014c\u1e50\u1e52\u014e\u022e\u0230\xd6\u022a\u1ece\u0150\u01d1\u020c\u020e\u01a0\u1edc\u1eda\u1ee0\u1ede\u1ee2\u1ecc\u1ed8\u01ea\u01ec\xd8\u01fe\u0186\u019f\ua74a\ua74c"},{base:"OI",letters:"\u01a2"},{base:"OO",letters:"\ua74e"},{base:"OU",letters:"\u0222"},{base:"P",letters:"P\u24c5\uff30\u1e54\u1e56\u01a4\u2c63\ua750\ua752\ua754"},{base:"Q",letters:"Q\u24c6\uff31\ua756\ua758\u024a"},{base:"R",letters:"R\u24c7\uff32\u0154\u1e58\u0158\u0210\u0212\u1e5a\u1e5c\u0156\u1e5e\u024c\u2c64\ua75a\ua7a6\ua782"},{base:"S",letters:"S\u24c8\uff33\u1e9e\u015a\u1e64\u015c\u1e60\u0160\u1e66\u1e62\u1e68\u0218\u015e\u2c7e\ua7a8\ua784"},{base:"T",letters:"T\u24c9\uff34\u1e6a\u0164\u1e6c\u021a\u0162\u1e70\u1e6e\u0166\u01ac\u01ae\u023e\ua786"},{base:"TZ",letters:"\ua728"},{base:"U",letters:"U\u24ca\uff35\xd9\xda\xdb\u0168\u1e78\u016a\u1e7a\u016c\xdc\u01db\u01d7\u01d5\u01d9\u1ee6\u016e\u0170\u01d3\u0214\u0216\u01af\u1eea\u1ee8\u1eee\u1eec\u1ef0\u1ee4\u1e72\u0172\u1e76\u1e74\u0244"},{base:"V",letters:"V\u24cb\uff36\u1e7c\u1e7e\u01b2\ua75e\u0245"},{base:"VY",letters:"\ua760"},{base:"W",letters:"W\u24cc\uff37\u1e80\u1e82\u0174\u1e86\u1e84\u1e88\u2c72"},{base:"X",letters:"X\u24cd\uff38\u1e8a\u1e8c"},{base:"Y",letters:"Y\u24ce\uff39\u1ef2\xdd\u0176\u1ef8\u0232\u1e8e\u0178\u1ef6\u1ef4\u01b3\u024e\u1efe"},{base:"Z",letters:"Z\u24cf\uff3a\u0179\u1e90\u017b\u017d\u1e92\u1e94\u01b5\u0224\u2c7f\u2c6b\ua762"},{base:"a",letters:"a\u24d0\uff41\u1e9a\xe0\xe1\xe2\u1ea7\u1ea5\u1eab\u1ea9\xe3\u0101\u0103\u1eb1\u1eaf\u1eb5\u1eb3\u0227\u01e1\xe4\u01df\u1ea3\xe5\u01fb\u01ce\u0201\u0203\u1ea1\u1ead\u1eb7\u1e01\u0105\u2c65\u0250"},{base:"aa",letters:"\ua733"},{base:"ae",letters:"\xe6\u01fd\u01e3"},{base:"ao",letters:"\ua735"},{base:"au",letters:"\ua737"},{base:"av",letters:"\ua739\ua73b"},{base:"ay",letters:"\ua73d"},{base:"b",letters:"b\u24d1\uff42\u1e03\u1e05\u1e07\u0180\u0183\u0253"},{base:"c",letters:"c\u24d2\uff43\u0107\u0109\u010b\u010d\xe7\u1e09\u0188\u023c\ua73f\u2184"},{base:"d",letters:"d\u24d3\uff44\u1e0b\u010f\u1e0d\u1e11\u1e13\u1e0f\u0111\u018c\u0256\u0257\ua77a"},{base:"dz",letters:"\u01f3\u01c6"},{base:"e",letters:"e\u24d4\uff45\xe8\xe9\xea\u1ec1\u1ebf\u1ec5\u1ec3\u1ebd\u0113\u1e15\u1e17\u0115\u0117\xeb\u1ebb\u011b\u0205\u0207\u1eb9\u1ec7\u0229\u1e1d\u0119\u1e19\u1e1b\u0247\u025b\u01dd"},{base:"f",letters:"f\u24d5\uff46\u1e1f\u0192\ua77c"},{base:"g",letters:"g\u24d6\uff47\u01f5\u011d\u1e21\u011f\u0121\u01e7\u0123\u01e5\u0260\ua7a1\u1d79\ua77f"},{base:"h",letters:"h\u24d7\uff48\u0125\u1e23\u1e27\u021f\u1e25\u1e29\u1e2b\u1e96\u0127\u2c68\u2c76\u0265"},{base:"hv",letters:"\u0195"},{base:"i",letters:"i\u24d8\uff49\xec\xed\xee\u0129\u012b\u012d\xef\u1e2f\u1ec9\u01d0\u0209\u020b\u1ecb\u012f\u1e2d\u0268\u0131"},{base:"j",letters:"j\u24d9\uff4a\u0135\u01f0\u0249"},{base:"k",letters:"k\u24da\uff4b\u1e31\u01e9\u1e33\u0137\u1e35\u0199\u2c6a\ua741\ua743\ua745\ua7a3"},{base:"l",letters:"l\u24db\uff4c\u0140\u013a\u013e\u1e37\u1e39\u013c\u1e3d\u1e3b\u017f\u0142\u019a\u026b\u2c61\ua749\ua781\ua747"},{base:"lj",letters:"\u01c9"},{base:"m",letters:"m\u24dc\uff4d\u1e3f\u1e41\u1e43\u0271\u026f"},{base:"n",letters:"n\u24dd\uff4e\u01f9\u0144\xf1\u1e45\u0148\u1e47\u0146\u1e4b\u1e49\u019e\u0272\u0149\ua791\ua7a5"},{base:"nj",letters:"\u01cc"},{base:"o",letters:"o\u24de\uff4f\xf2\xf3\xf4\u1ed3\u1ed1\u1ed7\u1ed5\xf5\u1e4d\u022d\u1e4f\u014d\u1e51\u1e53\u014f\u022f\u0231\xf6\u022b\u1ecf\u0151\u01d2\u020d\u020f\u01a1\u1edd\u1edb\u1ee1\u1edf\u1ee3\u1ecd\u1ed9\u01eb\u01ed\xf8\u01ff\u0254\ua74b\ua74d\u0275"},{base:"oi",letters:"\u01a3"},{base:"ou",letters:"\u0223"},{base:"oo",letters:"\ua74f"},{base:"p",letters:"p\u24df\uff50\u1e55\u1e57\u01a5\u1d7d\ua751\ua753\ua755"},{base:"q",letters:"q\u24e0\uff51\u024b\ua757\ua759"},{base:"r",letters:"r\u24e1\uff52\u0155\u1e59\u0159\u0211\u0213\u1e5b\u1e5d\u0157\u1e5f\u024d\u027d\ua75b\ua7a7\ua783"},{base:"s",letters:"s\u24e2\uff53\xdf\u015b\u1e65\u015d\u1e61\u0161\u1e67\u1e63\u1e69\u0219\u015f\u023f\ua7a9\ua785\u1e9b"},{base:"t",letters:"t\u24e3\uff54\u1e6b\u1e97\u0165\u1e6d\u021b\u0163\u1e71\u1e6f\u0167\u01ad\u0288\u2c66\ua787"},{base:"tz",letters:"\ua729"},{base:"u",letters:"u\u24e4\uff55\xf9\xfa\xfb\u0169\u1e79\u016b\u1e7b\u016d\xfc\u01dc\u01d8\u01d6\u01da\u1ee7\u016f\u0171\u01d4\u0215\u0217\u01b0\u1eeb\u1ee9\u1eef\u1eed\u1ef1\u1ee5\u1e73\u0173\u1e77\u1e75\u0289"},{base:"v",letters:"v\u24e5\uff56\u1e7d\u1e7f\u028b\ua75f\u028c"},{base:"vy",letters:"\ua761"},{base:"w",letters:"w\u24e6\uff57\u1e81\u1e83\u0175\u1e87\u1e85\u1e98\u1e89\u2c73"},{base:"x",letters:"x\u24e7\uff58\u1e8b\u1e8d"},{base:"y",letters:"y\u24e8\uff59\u1ef3\xfd\u0177\u1ef9\u0233\u1e8f\xff\u1ef7\u1e99\u1ef5\u01b4\u024f\u1eff"},{base:"z",letters:"z\u24e9\uff5a\u017a\u1e91\u017c\u017e\u1e93\u1e95\u01b6\u0225\u0240\u2c6c\ua763"}],b=new RegExp("["+_.map((function(e){return e.letters})).join("")+"]","g"),T={},S=0;S<_.length;S++)for(var O=_[S],R=0;R<O.letters.length;R++)T[O.letters[R]]=O.base;var C=function(e){return e.replace(b,(function(e){return T[e]}))},w=f(C),I=function(e){return e.replace(/^\s+|\s+$/g,"")},A=function(e){return"".concat(e.label," ").concat(e.value)};function N(e){e.in,e.out,e.onExited,e.appear,e.enter,e.exit;var t=e.innerRef;e.emotion;var n=Object(m.a)(e,["in","out","onExited","appear","enter","exit","innerRef","emotion"]);return Object(d.c)("input",Object(r.a)({ref:t},n,{css:Object(d.b)({label:"dummyInput",background:0,border:0,fontSize:"inherit",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(0)"},"","")}))}var k=["boxSizing","height","overflow","paddingRight","position"],P={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function D(e){e.preventDefault()}function M(e){e.stopPropagation()}function L(){var e=this.scrollTop,t=this.scrollHeight,n=e+this.offsetHeight;0===e?this.scrollTop=1:n===t&&(this.scrollTop=e-1)}function x(){return"ontouchstart"in window||navigator.maxTouchPoints}var U=!("undefined"===typeof window||!window.document||!window.document.createElement),j=0,F={capture:!1,passive:!1};var B=function(){return document.activeElement&&document.activeElement.blur()},V={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function H(e){var t=e.children,n=e.lockEnabled,r=e.captureEnabled,i=function(e){var t=e.isEnabled,n=e.onBottomArrive,r=e.onBottomLeave,i=e.onTopArrive,a=e.onTopLeave,s=Object(l.useRef)(!1),c=Object(l.useRef)(!1),u=Object(l.useRef)(0),d=Object(l.useRef)(null),p=Object(l.useCallback)((function(e,t){if(null!==d.current){var o=d.current,l=o.scrollTop,u=o.scrollHeight,p=o.clientHeight,h=d.current,f=t>0,m=u-p-l,v=!1;m>t&&s.current&&(r&&r(e),s.current=!1),f&&c.current&&(a&&a(e),c.current=!1),f&&t>m?(n&&!s.current&&n(e),h.scrollTop=u,v=!0,s.current=!0):!f&&-t>l&&(i&&!c.current&&i(e),h.scrollTop=0,v=!0,c.current=!0),v&&function(e){e.preventDefault(),e.stopPropagation()}(e)}}),[]),h=Object(l.useCallback)((function(e){p(e,e.deltaY)}),[p]),f=Object(l.useCallback)((function(e){u.current=e.changedTouches[0].clientY}),[]),m=Object(l.useCallback)((function(e){var t=u.current-e.changedTouches[0].clientY;p(e,t)}),[p]),v=Object(l.useCallback)((function(e){if(e){var t=!!o.B&&{passive:!1};"function"===typeof e.addEventListener&&e.addEventListener("wheel",h,t),"function"===typeof e.addEventListener&&e.addEventListener("touchstart",f,t),"function"===typeof e.addEventListener&&e.addEventListener("touchmove",m,t)}}),[m,f,h]),g=Object(l.useCallback)((function(e){e&&("function"===typeof e.removeEventListener&&e.removeEventListener("wheel",h,!1),"function"===typeof e.removeEventListener&&e.removeEventListener("touchstart",f,!1),"function"===typeof e.removeEventListener&&e.removeEventListener("touchmove",m,!1))}),[m,f,h]);return Object(l.useEffect)((function(){if(t){var e=d.current;return v(e),function(){g(e)}}}),[t,v,g]),function(e){d.current=e}}({isEnabled:void 0===r||r,onBottomArrive:e.onBottomArrive,onBottomLeave:e.onBottomLeave,onTopArrive:e.onTopArrive,onTopLeave:e.onTopLeave}),a=function(e){var t=e.isEnabled,n=e.accountForScrollbars,r=void 0===n||n,o=Object(l.useRef)({}),i=Object(l.useRef)(null),a=Object(l.useCallback)((function(e){if(U){var t=document.body,n=t&&t.style;if(r&&k.forEach((function(e){var t=n&&n[e];o.current[e]=t})),r&&j<1){var i=parseInt(o.current.paddingRight,10)||0,a=document.body?document.body.clientWidth:0,s=window.innerWidth-a+i||0;Object.keys(P).forEach((function(e){var t=P[e];n&&(n[e]=t)})),n&&(n.paddingRight="".concat(s,"px"))}t&&x()&&(t.addEventListener("touchmove",D,F),e&&(e.addEventListener("touchstart",L,F),e.addEventListener("touchmove",M,F))),j+=1}}),[]),s=Object(l.useCallback)((function(e){if(U){var t=document.body,n=t&&t.style;j=Math.max(j-1,0),r&&j<1&&k.forEach((function(e){var t=o.current[e];n&&(n[e]=t)})),t&&x()&&(t.removeEventListener("touchmove",D,F),e&&(e.removeEventListener("touchstart",L,F),e.removeEventListener("touchmove",M,F)))}}),[]);return Object(l.useEffect)((function(){if(t){var e=i.current;return a(e),function(){s(e)}}}),[t,a,s]),function(e){i.current=e}}({isEnabled:n});return Object(d.c)(u.a.Fragment,null,n&&Object(d.c)("div",{onClick:B,css:V}),t((function(e){i(e),a(e)})))}var G={clearIndicator:o.k,container:o.m,control:o.n,dropdownIndicator:o.o,group:o.p,groupHeading:o.q,indicatorsContainer:o.r,indicatorSeparator:o.s,input:o.t,loadingIndicator:o.u,loadingMessage:o.v,menu:o.w,menuList:o.x,menuPortal:o.y,multiValue:o.z,multiValueLabel:o.A,multiValueRemove:o.C,noOptionsMessage:o.D,option:o.E,placeholder:o.F,singleValue:o.G,valueContainer:o.H};var W,q={borderRadius:4,colors:{primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},spacing:{baseUnit:4,controlHeight:38,menuGutter:8}},K={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:Object(o.I)(),captureMenuScroll:!Object(o.I)(),closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:function(e,t){var n=Object(o.j)({ignoreCase:!0,ignoreAccents:!0,stringify:A,trim:!0,matchFrom:"any"},W),r=n.ignoreCase,i=n.ignoreAccents,a=n.stringify,s=n.trim,c=n.matchFrom,l=s?I(t):t,u=s?I(a(e)):a(e);return r&&(l=l.toLowerCase(),u=u.toLowerCase()),i&&(l=w(l),u=C(u)),"start"===c?u.substr(0,l.length)===l:u.indexOf(l)>-1},formatGroupLabel:function(e){return e.label},getOptionLabel:function(e){return e.label},getOptionValue:function(e){return e.value},isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:function(e){return!!e.isDisabled},loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!Object(o.a)(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(e){var t=e.count;return"".concat(t," result").concat(1!==t?"s":""," available")},styles:{},tabIndex:"0",tabSelectsValue:!0};function Y(e,t,n,r){return{type:"option",data:t,isDisabled:$(e,t,n),isSelected:ee(e,t,n),label:Z(e,t),value:Q(e,t),index:r}}function z(e,t){return e.options.map((function(n,r){if(n.options){var o=n.options.map((function(n,r){return Y(e,n,t,r)})).filter((function(t){return J(e,t)}));return o.length>0?{type:"group",data:n,options:o,index:r}:void 0}var i=Y(e,n,t,r);return J(e,i)?i:void 0})).filter((function(e){return!!e}))}function X(e){return e.reduce((function(e,t){return"group"===t.type?e.push.apply(e,Object(c.a)(t.options.map((function(e){return e.data})))):e.push(t.data),e}),[])}function J(e,t){var n=e.inputValue,r=void 0===n?"":n,o=t.data,i=t.isSelected,a=t.label,s=t.value;return(!ne(e)||!i)&&te(e,{label:a,value:s,data:o},r)}var Z=function(e,t){return e.getOptionLabel(t)},Q=function(e,t){return e.getOptionValue(t)};function $(e,t,n){return"function"===typeof e.isOptionDisabled&&e.isOptionDisabled(t,n)}function ee(e,t,n){if(n.indexOf(t)>-1)return!0;if("function"===typeof e.isOptionSelected)return e.isOptionSelected(t,n);var r=Q(e,t);return n.some((function(t){return Q(e,t)===r}))}function te(e,t,n){return!e.filterOption||e.filterOption(t,n)}var ne=function(e){var t=e.hideSelectedOptions,n=e.isMulti;return void 0===t?n:t},re=1,oe=function(e){Object(s.a)(n,e);var t=Object(o.i)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={ariaSelection:null,focusedOption:null,focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0},r.blockOptionHover=!1,r.isComposing=!1,r.commonProps=void 0,r.initialTouchX=0,r.initialTouchY=0,r.instancePrefix="",r.openAfterFocus=!1,r.scrollToFocusedOptionOnUpdate=!1,r.userIsDragging=void 0,r.controlRef=null,r.getControlRef=function(e){r.controlRef=e},r.focusedOptionRef=null,r.getFocusedOptionRef=function(e){r.focusedOptionRef=e},r.menuListRef=null,r.getMenuListRef=function(e){r.menuListRef=e},r.inputRef=null,r.getInputRef=function(e){r.inputRef=e},r.focus=r.focusInput,r.blur=r.blurInput,r.onChange=function(e,t){var n=r.props,o=n.onChange,i=n.name;t.name=i,r.ariaOnChange(e,t),o(e,t)},r.setValue=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"set-value",n=arguments.length>2?arguments[2]:void 0,o=r.props,i=o.closeMenuOnSelect,a=o.isMulti;r.onInputChange("",{action:"set-value"}),i&&(r.setState({inputIsHiddenAfterUpdate:!a}),r.onMenuClose()),r.setState({clearFocusValueOnUpdate:!0}),r.onChange(e,{action:t,option:n})},r.selectOption=function(e){var t=r.props,n=t.blurInputOnSelect,o=t.isMulti,i=t.name,a=r.state.selectValue,s=o&&r.isOptionSelected(e,a),l=r.isOptionDisabled(e,a);if(s){var u=r.getOptionValue(e);r.setValue(a.filter((function(e){return r.getOptionValue(e)!==u})),"deselect-option",e)}else{if(l)return void r.ariaOnChange(e,{action:"select-option",name:i});o?r.setValue([].concat(Object(c.a)(a),[e]),"select-option",e):r.setValue(e,"select-option")}n&&r.blurInput()},r.removeValue=function(e){var t=r.props.isMulti,n=r.state.selectValue,o=r.getOptionValue(e),i=n.filter((function(e){return r.getOptionValue(e)!==o})),a=t?i:i[0]||null;r.onChange(a,{action:"remove-value",removedValue:e}),r.focusInput()},r.clearValue=function(){var e=r.state.selectValue;r.onChange(r.props.isMulti?[]:null,{action:"clear",removedValues:e})},r.popValue=function(){var e=r.props.isMulti,t=r.state.selectValue,n=t[t.length-1],o=t.slice(0,t.length-1),i=e?o:o[0]||null;r.onChange(i,{action:"pop-value",removedValue:n})},r.getValue=function(){return r.state.selectValue},r.cx=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.b.apply(void 0,[r.props.classNamePrefix].concat(t))},r.getOptionLabel=function(e){return Z(r.props,e)},r.getOptionValue=function(e){return Q(r.props,e)},r.getStyles=function(e,t){var n=G[e](t);n.boxSizing="border-box";var o=r.props.styles[e];return o?o(n,t):n},r.getElementId=function(e){return"".concat(r.instancePrefix,"-").concat(e)},r.getComponents=function(){return Object(o.c)(r.props)},r.buildCategorizedOptions=function(){return z(r.props,r.state.selectValue)},r.getCategorizedOptions=function(){return r.props.menuIsOpen?r.buildCategorizedOptions():[]},r.buildFocusableOptions=function(){return X(r.buildCategorizedOptions())},r.getFocusableOptions=function(){return r.props.menuIsOpen?r.buildFocusableOptions():[]},r.ariaOnChange=function(e,t){r.setState({ariaSelection:Object(o.j)({value:e},t)})},r.onMenuMouseDown=function(e){0===e.button&&(e.stopPropagation(),e.preventDefault(),r.focusInput())},r.onMenuMouseMove=function(e){r.blockOptionHover=!1},r.onControlMouseDown=function(e){var t=r.props.openMenuOnClick;r.state.isFocused?r.props.menuIsOpen?"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&r.onMenuClose():t&&r.openMenu("first"):(t&&(r.openAfterFocus=!0),r.focusInput()),"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&e.preventDefault()},r.onDropdownIndicatorMouseDown=function(e){if((!e||"mousedown"!==e.type||0===e.button)&&!r.props.isDisabled){var t=r.props,n=t.isMulti,o=t.menuIsOpen;r.focusInput(),o?(r.setState({inputIsHiddenAfterUpdate:!n}),r.onMenuClose()):r.openMenu("first"),e.preventDefault(),e.stopPropagation()}},r.onClearIndicatorMouseDown=function(e){e&&"mousedown"===e.type&&0!==e.button||(r.clearValue(),e.stopPropagation(),r.openAfterFocus=!1,"touchend"===e.type?r.focusInput():setTimeout((function(){return r.focusInput()})))},r.onScroll=function(e){"boolean"===typeof r.props.closeMenuOnScroll?e.target instanceof HTMLElement&&Object(o.d)(e.target)&&r.props.onMenuClose():"function"===typeof r.props.closeMenuOnScroll&&r.props.closeMenuOnScroll(e)&&r.props.onMenuClose()},r.onCompositionStart=function(){r.isComposing=!0},r.onCompositionEnd=function(){r.isComposing=!1},r.onTouchStart=function(e){var t=e.touches,n=t&&t.item(0);n&&(r.initialTouchX=n.clientX,r.initialTouchY=n.clientY,r.userIsDragging=!1)},r.onTouchMove=function(e){var t=e.touches,n=t&&t.item(0);if(n){var o=Math.abs(n.clientX-r.initialTouchX),i=Math.abs(n.clientY-r.initialTouchY);r.userIsDragging=o>5||i>5}},r.onTouchEnd=function(e){r.userIsDragging||(r.controlRef&&!r.controlRef.contains(e.target)&&r.menuListRef&&!r.menuListRef.contains(e.target)&&r.blurInput(),r.initialTouchX=0,r.initialTouchY=0)},r.onControlTouchEnd=function(e){r.userIsDragging||r.onControlMouseDown(e)},r.onClearIndicatorTouchEnd=function(e){r.userIsDragging||r.onClearIndicatorMouseDown(e)},r.onDropdownIndicatorTouchEnd=function(e){r.userIsDragging||r.onDropdownIndicatorMouseDown(e)},r.handleInputChange=function(e){var t=e.currentTarget.value;r.setState({inputIsHiddenAfterUpdate:!1}),r.onInputChange(t,{action:"input-change"}),r.props.menuIsOpen||r.onMenuOpen()},r.onInputFocus=function(e){r.props.onFocus&&r.props.onFocus(e),r.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(r.openAfterFocus||r.props.openMenuOnFocus)&&r.openMenu("first"),r.openAfterFocus=!1},r.onInputBlur=function(e){r.menuListRef&&r.menuListRef.contains(document.activeElement)?r.inputRef.focus():(r.props.onBlur&&r.props.onBlur(e),r.onInputChange("",{action:"input-blur"}),r.onMenuClose(),r.setState({focusedValue:null,isFocused:!1}))},r.onOptionHover=function(e){r.blockOptionHover||r.state.focusedOption===e||r.setState({focusedOption:e})},r.shouldHideSelectedOptions=function(){return ne(r.props)},r.onKeyDown=function(e){var t=r.props,n=t.isMulti,o=t.backspaceRemovesValue,i=t.escapeClearsValue,a=t.inputValue,s=t.isClearable,c=t.isDisabled,l=t.menuIsOpen,u=t.onKeyDown,d=t.tabSelectsValue,p=t.openMenuOnFocus,h=r.state,f=h.focusedOption,m=h.focusedValue,v=h.selectValue;if(!c&&("function"!==typeof u||(u(e),!e.defaultPrevented))){switch(r.blockOptionHover=!0,e.key){case"ArrowLeft":if(!n||a)return;r.focusValue("previous");break;case"ArrowRight":if(!n||a)return;r.focusValue("next");break;case"Delete":case"Backspace":if(a)return;if(m)r.removeValue(m);else{if(!o)return;n?r.popValue():s&&r.clearValue()}break;case"Tab":if(r.isComposing)return;if(e.shiftKey||!l||!d||!f||p&&r.isOptionSelected(f,v))return;r.selectOption(f);break;case"Enter":if(229===e.keyCode)break;if(l){if(!f)return;if(r.isComposing)return;r.selectOption(f);break}return;case"Escape":l?(r.setState({inputIsHiddenAfterUpdate:!1}),r.onInputChange("",{action:"menu-close"}),r.onMenuClose()):s&&i&&r.clearValue();break;case" ":if(a)return;if(!l){r.openMenu("first");break}if(!f)return;r.selectOption(f);break;case"ArrowUp":l?r.focusOption("up"):r.openMenu("last");break;case"ArrowDown":l?r.focusOption("down"):r.openMenu("first");break;case"PageUp":if(!l)return;r.focusOption("pageup");break;case"PageDown":if(!l)return;r.focusOption("pagedown");break;case"Home":if(!l)return;r.focusOption("first");break;case"End":if(!l)return;r.focusOption("last");break;default:return}e.preventDefault()}},r.instancePrefix="react-select-"+(r.props.instanceId||++re),r.state.selectValue=Object(o.e)(e.value),r}return Object(a.a)(n,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isDisabled,r=t.menuIsOpen,i=this.state.isFocused;(i&&!n&&e.isDisabled||i&&r&&!e.menuIsOpen)&&this.focusInput(),i&&n&&!e.isDisabled&&this.setState({isFocused:!1},this.onMenuClose),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(Object(o.f)(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close"}),this.props.onMenuClose()}},{key:"onInputChange",value:function(e,t){this.props.onInputChange(e,t)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(e){var t=this,n=this.state,r=n.selectValue,o=n.isFocused,i=this.buildFocusableOptions(),a="first"===e?0:i.length-1;if(!this.props.isMulti){var s=i.indexOf(r[0]);s>-1&&(a=s)}this.scrollToFocusedOptionOnUpdate=!(o&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:i[a]},(function(){return t.onMenuOpen()}))}},{key:"focusValue",value:function(e){var t=this.state,n=t.selectValue,r=t.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var o=n.indexOf(r);r||(o=-1);var i=n.length-1,a=-1;if(n.length){switch(e){case"previous":a=0===o?0:-1===o?i:o-1;break;case"next":o>-1&&o<i&&(a=o+1)}this.setState({inputIsHidden:-1!==a,focusedValue:n[a]})}}}},{key:"focusOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"first",t=this.props.pageSize,n=this.state.focusedOption,r=this.getFocusableOptions();if(r.length){var o=0,i=r.indexOf(n);n||(i=-1),"up"===e?o=i>0?i-1:r.length-1:"down"===e?o=(i+1)%r.length:"pageup"===e?(o=i-t)<0&&(o=0):"pagedown"===e?(o=i+t)>r.length-1&&(o=r.length-1):"last"===e&&(o=r.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:r[o],focusedValue:null})}}},{key:"getTheme",value:function(){return this.props.theme?"function"===typeof this.props.theme?this.props.theme(q):Object(o.j)(Object(o.j)({},q),this.props.theme):q}},{key:"getCommonProps",value:function(){var e=this.clearValue,t=this.cx,n=this.getStyles,r=this.getValue,o=this.selectOption,i=this.setValue,a=this.props,s=a.isMulti,c=a.isRtl,l=a.options;return{clearValue:e,cx:t,getStyles:n,getValue:r,hasValue:this.hasValue(),isMulti:s,isRtl:c,options:l,selectOption:o,selectProps:a,setValue:i,theme:this.getTheme()}}},{key:"hasValue",value:function(){return this.state.selectValue.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var e=this.props,t=e.isClearable,n=e.isMulti;return void 0===t?n:t}},{key:"isOptionDisabled",value:function(e,t){return $(this.props,e,t)}},{key:"isOptionSelected",value:function(e,t){return ee(this.props,e,t)}},{key:"filterOption",value:function(e,t){return te(this.props,e,t)}},{key:"formatOptionLabel",value:function(e,t){if("function"===typeof this.props.formatOptionLabel){var n=this.props.inputValue,r=this.state.selectValue;return this.props.formatOptionLabel(e,{context:t,inputValue:n,selectValue:r})}return this.getOptionLabel(e)}},{key:"formatGroupLabel",value:function(e){return this.props.formatGroupLabel(e)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var e=this.props,t=e.isDisabled,n=e.isSearchable,i=e.inputId,a=e.inputValue,s=e.tabIndex,c=e.form,l=this.getComponents().Input,d=this.state.inputIsHidden,p=this.commonProps,h=i||this.getElementId("input"),f={"aria-autocomplete":"list","aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"]};return n?u.a.createElement(l,Object(r.a)({},p,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:h,innerRef:this.getInputRef,isDisabled:t,isHidden:d,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:s,form:c,type:"text",value:a},f)):u.a.createElement(N,Object(r.a)({id:h,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:o.g,onFocus:this.onInputFocus,readOnly:!0,disabled:t,tabIndex:s,form:c,value:""},f))}},{key:"renderPlaceholderOrValue",value:function(){var e=this,t=this.getComponents(),n=t.MultiValue,o=t.MultiValueContainer,i=t.MultiValueLabel,a=t.MultiValueRemove,s=t.SingleValue,c=t.Placeholder,l=this.commonProps,d=this.props,p=d.controlShouldRenderValue,h=d.isDisabled,f=d.isMulti,m=d.inputValue,v=d.placeholder,g=this.state,E=g.selectValue,y=g.focusedValue,_=g.isFocused;if(!this.hasValue()||!p)return m?null:u.a.createElement(c,Object(r.a)({},l,{key:"placeholder",isDisabled:h,isFocused:_}),v);if(f)return E.map((function(t,s){var c=t===y;return u.a.createElement(n,Object(r.a)({},l,{components:{Container:o,Label:i,Remove:a},isFocused:c,isDisabled:h,key:"".concat(e.getOptionValue(t)).concat(s),index:s,removeProps:{onClick:function(){return e.removeValue(t)},onTouchEnd:function(){return e.removeValue(t)},onMouseDown:function(e){e.preventDefault(),e.stopPropagation()}},data:t}),e.formatOptionLabel(t,"value"))}));if(m)return null;var b=E[0];return u.a.createElement(s,Object(r.a)({},l,{data:b,isDisabled:h}),this.formatOptionLabel(b,"value"))}},{key:"renderClearIndicator",value:function(){var e=this.getComponents().ClearIndicator,t=this.commonProps,n=this.props,o=n.isDisabled,i=n.isLoading,a=this.state.isFocused;if(!this.isClearable()||!e||o||!this.hasValue()||i)return null;var s={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return u.a.createElement(e,Object(r.a)({},t,{innerProps:s,isFocused:a}))}},{key:"renderLoadingIndicator",value:function(){var e=this.getComponents().LoadingIndicator,t=this.commonProps,n=this.props,o=n.isDisabled,i=n.isLoading,a=this.state.isFocused;if(!e||!i)return null;return u.a.createElement(e,Object(r.a)({},t,{innerProps:{"aria-hidden":"true"},isDisabled:o,isFocused:a}))}},{key:"renderIndicatorSeparator",value:function(){var e=this.getComponents(),t=e.DropdownIndicator,n=e.IndicatorSeparator;if(!t||!n)return null;var o=this.commonProps,i=this.props.isDisabled,a=this.state.isFocused;return u.a.createElement(n,Object(r.a)({},o,{isDisabled:i,isFocused:a}))}},{key:"renderDropdownIndicator",value:function(){var e=this.getComponents().DropdownIndicator;if(!e)return null;var t=this.commonProps,n=this.props.isDisabled,o=this.state.isFocused,i={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return u.a.createElement(e,Object(r.a)({},t,{innerProps:i,isDisabled:n,isFocused:o}))}},{key:"renderMenu",value:function(){var e=this,t=this.getComponents(),n=t.Group,i=t.GroupHeading,a=t.Menu,s=t.MenuList,c=t.MenuPortal,l=t.LoadingMessage,d=t.NoOptionsMessage,p=t.Option,h=this.commonProps,f=this.state.focusedOption,m=this.props,v=m.captureMenuScroll,g=m.inputValue,E=m.isLoading,y=m.loadingMessage,_=m.minMenuHeight,b=m.maxMenuHeight,T=m.menuIsOpen,S=m.menuPlacement,O=m.menuPosition,R=m.menuPortalTarget,C=m.menuShouldBlockScroll,w=m.menuShouldScrollIntoView,I=m.noOptionsMessage,A=m.onMenuScrollToTop,N=m.onMenuScrollToBottom;if(!T)return null;var k,P=function(t,n){var o=t.type,i=t.data,a=t.isDisabled,s=t.isSelected,c=t.label,l=t.value,d=f===i,m=a?void 0:function(){return e.onOptionHover(i)},v=a?void 0:function(){return e.selectOption(i)},g="".concat(e.getElementId("option"),"-").concat(n),E={id:g,onClick:v,onMouseMove:m,onMouseOver:m,tabIndex:-1};return u.a.createElement(p,Object(r.a)({},h,{innerProps:E,data:i,isDisabled:a,isSelected:s,key:g,label:c,type:o,value:l,isFocused:d,innerRef:d?e.getFocusedOptionRef:void 0}),e.formatOptionLabel(t.data,"menu"))};if(this.hasOptions())k=this.getCategorizedOptions().map((function(t){if("group"===t.type){var o=t.data,a=t.options,s=t.index,c="".concat(e.getElementId("group"),"-").concat(s),l="".concat(c,"-heading");return u.a.createElement(n,Object(r.a)({},h,{key:c,data:o,options:a,Heading:i,headingProps:{id:l,data:t.data},label:e.formatGroupLabel(t.data)}),t.options.map((function(e){return P(e,"".concat(s,"-").concat(e.index))})))}if("option"===t.type)return P(t,"".concat(t.index))}));else if(E){var D=y({inputValue:g});if(null===D)return null;k=u.a.createElement(l,h,D)}else{var M=I({inputValue:g});if(null===M)return null;k=u.a.createElement(d,h,M)}var L={minMenuHeight:_,maxMenuHeight:b,menuPlacement:S,menuPosition:O,menuShouldScrollIntoView:w},x=u.a.createElement(o.h,Object(r.a)({},h,L),(function(t){var n=t.ref,o=t.placerProps,i=o.placement,c=o.maxHeight;return u.a.createElement(a,Object(r.a)({},h,L,{innerRef:n,innerProps:{onMouseDown:e.onMenuMouseDown,onMouseMove:e.onMenuMouseMove},isLoading:E,placement:i}),u.a.createElement(H,{captureEnabled:v,onTopArrive:A,onBottomArrive:N,lockEnabled:C},(function(t){return u.a.createElement(s,Object(r.a)({},h,{innerRef:function(n){e.getMenuListRef(n),t(n)},isLoading:E,maxHeight:c,focusedOption:f}),k)})))}));return R||"fixed"===O?u.a.createElement(c,Object(r.a)({},h,{appendTo:R,controlElement:this.controlRef,menuPlacement:S,menuPosition:O}),x):x}},{key:"renderFormField",value:function(){var e=this,t=this.props,n=t.delimiter,r=t.isDisabled,o=t.isMulti,i=t.name,a=this.state.selectValue;if(i&&!r){if(o){if(n){var s=a.map((function(t){return e.getOptionValue(t)})).join(n);return u.a.createElement("input",{name:i,type:"hidden",value:s})}var c=a.length>0?a.map((function(t,n){return u.a.createElement("input",{key:"i-".concat(n),name:i,type:"hidden",value:e.getOptionValue(t)})})):u.a.createElement("input",{name:i,type:"hidden"});return u.a.createElement("div",null,c)}var l=a[0]?this.getOptionValue(a[0]):"";return u.a.createElement("input",{name:i,type:"hidden",value:l})}}},{key:"renderLiveRegion",value:function(){var e=this.commonProps,t=this.state,n=t.ariaSelection,o=t.focusedOption,i=t.focusedValue,a=t.isFocused,s=t.selectValue,c=this.getFocusableOptions();return u.a.createElement(y,Object(r.a)({},e,{ariaSelection:n,focusedOption:o,focusedValue:i,isFocused:a,selectValue:s,focusableOptions:c}))}},{key:"render",value:function(){var e=this.getComponents(),t=e.Control,n=e.IndicatorsContainer,o=e.SelectContainer,i=e.ValueContainer,a=this.props,s=a.className,c=a.id,l=a.isDisabled,d=a.menuIsOpen,p=this.state.isFocused,h=this.commonProps=this.getCommonProps();return u.a.createElement(o,Object(r.a)({},h,{className:s,innerProps:{id:c,onKeyDown:this.onKeyDown},isDisabled:l,isFocused:p}),this.renderLiveRegion(),u.a.createElement(t,Object(r.a)({},h,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:l,isFocused:p,menuIsOpen:d}),u.a.createElement(i,Object(r.a)({},h,{isDisabled:l}),this.renderPlaceholderOrValue(),this.renderInput()),u.a.createElement(n,Object(r.a)({},h,{isDisabled:l}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=t.prevProps,r=t.clearFocusValueOnUpdate,i=t.inputIsHiddenAfterUpdate,a=e.options,s=e.value,c=e.menuIsOpen,l=e.inputValue,u={};if(n&&(s!==n.value||a!==n.options||c!==n.menuIsOpen||l!==n.inputValue)){var d=Object(o.e)(s),p=c?function(e,t){return X(z(e,t))}(e,d):[],h=r?function(e,t){var n=e.focusedValue,r=e.selectValue.indexOf(n);if(r>-1){if(t.indexOf(n)>-1)return n;if(r<t.length)return t[r]}return null}(t,d):null,f=function(e,t){var n=e.focusedOption;return n&&t.indexOf(n)>-1?n:t[0]}(t,p);u={selectValue:d,focusedOption:f,focusedValue:h,clearFocusValueOnUpdate:!1}}var m=null!=i&&e!==n?{inputIsHidden:i,inputIsHiddenAfterUpdate:void 0}:{};return Object(o.j)(Object(o.j)(Object(o.j)({},u),m),{},{prevProps:e})}}]),n}(l.Component);oe.defaultProps=K;var ie={defaultInputValue:"",defaultMenuIsOpen:!1,defaultValue:null},ae=n(160),se=n(328),ce=(n(228),n(565),n(388),n(570),n(278),n(382),n(190),n(19),l.Component,function(e){var t,n;return n=t=function(t){Object(s.a)(c,t);var n=Object(o.i)(c);function c(){var e;Object(i.a)(this,c);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(e=n.call.apply(n,[this].concat(r))).select=void 0,e.state={inputValue:void 0!==e.props.inputValue?e.props.inputValue:e.props.defaultInputValue,menuIsOpen:void 0!==e.props.menuIsOpen?e.props.menuIsOpen:e.props.defaultMenuIsOpen,value:void 0!==e.props.value?e.props.value:e.props.defaultValue},e.onChange=function(t,n){e.callProp("onChange",t,n),e.setState({value:t})},e.onInputChange=function(t,n){var r=e.callProp("onInputChange",t,n);e.setState({inputValue:void 0!==r?r:t})},e.onMenuOpen=function(){e.callProp("onMenuOpen"),e.setState({menuIsOpen:!0})},e.onMenuClose=function(){e.callProp("onMenuClose"),e.setState({menuIsOpen:!1})},e}return Object(a.a)(c,[{key:"focus",value:function(){this.select.focus()}},{key:"blur",value:function(){this.select.blur()}},{key:"getProp",value:function(e){return void 0!==this.props[e]?this.props[e]:this.state[e]}},{key:"callProp",value:function(e){if("function"===typeof this.props[e]){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=this.props)[e].apply(t,r)}}},{key:"render",value:function(){var t=this,n=this.props;n.defaultInputValue,n.defaultMenuIsOpen,n.defaultValue;var o=Object(m.a)(n,["defaultInputValue","defaultMenuIsOpen","defaultValue"]);return u.a.createElement(e,Object(r.a)({},o,{ref:function(e){t.select=e},inputValue:this.getProp("inputValue"),menuIsOpen:this.getProp("menuIsOpen"),onChange:this.onChange,onInputChange:this.onInputChange,onMenuClose:this.onMenuClose,onMenuOpen:this.onMenuOpen,value:this.getProp("value")}))}}]),c}(l.Component),t.defaultProps=ie,n}(oe));t.a=ce},function(e,t,n){},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(344);var o=n(224),i=n(346);function a(e,t){return Object(r.a)(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||Object(o.a)(e,t)||Object(i.a)()}},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return E})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return v})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return p}));var r=n(2),o=n(328),i=(n(11),n(290),n(386),n(383)),a=n(481),s=n(384),c=!1,l="undefined"!==typeof document,u=r.createContext("undefined"!==typeof HTMLElement?Object(o.a)({key:"css"}):null),d=u.Provider,p=function(e){return Object(r.forwardRef)((function(t,n){var o=Object(r.useContext)(u);return e(t,o,n)}))};l||(p=function(e){return function(t){var n=Object(r.useContext)(u);return null===n?(n=Object(o.a)({key:"css"}),r.createElement(u.Provider,{value:n},e(t,n))):e(t,n)}});var h=r.createContext({});var f={}.hasOwnProperty,m="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",v=function(e,t){var n={};for(var r in t)f.call(t,r)&&(n[r]=t[r]);return n[m]=e,n},g=function(e){var t=e.cache,n=e.serialized,o=e.isStringTag;Object(i.c)(t,n,o);var a=Object(s.a)((function(){return Object(i.b)(t,n,o)}));if(!l&&void 0!==a){for(var c,u=n.name,d=n.next;void 0!==d;)u+=" "+d.name,d=d.next;return r.createElement("style",((c={})["data-emotion"]=t.key+" "+u,c.dangerouslySetInnerHTML={__html:a},c.nonce=t.sheet.nonce,c))}return null},E=p((function(e,t,n){var o=e.css;"string"===typeof o&&void 0!==t.registered[o]&&(o=t.registered[o]);var s=e[m],l=[o],u="";"string"===typeof e.className?u=Object(i.a)(t.registered,l,e.className):null!=e.className&&(u=e.className+" ");var d=Object(a.a)(l,void 0,r.useContext(h));u+=t.key+"-"+d.name;var p={};for(var v in e)f.call(e,v)&&"css"!==v&&v!==m&&!c&&(p[v]=e[v]);return p.className=u,n&&(p.ref=n),r.createElement(r.Fragment,null,r.createElement(g,{cache:t,serialized:d,isStringTag:"string"===typeof s}),r.createElement(s,p))}))},,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r={};function o(){return r}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return X}));var r=n(2),o=n.n(r),i=n(31),a=n.n(i),s=n(27),c=n.n(s),l=n(38),u=n.n(l);function d(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"function"===typeof e&&e.apply(void 0,n)}function p(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var h="react-contextmenu",f="react-contextmenu--visible",m="react-contextmenu-wrapper",v="react-contextmenu-item",g="react-contextmenu-item--active",E="react-contextmenu-item--disabled",y="react-contextmenu-item--divider",_="react-contextmenu-item--selected",b="react-contextmenu-submenu",T={},S=Boolean("undefined"!==typeof window&&window.document&&window.document.createElement),O="REACT_CONTEXTMENU_SHOW",R="REACT_CONTEXTMENU_HIDE";function C(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window,r=void 0;"function"===typeof window.CustomEvent?r=new window.CustomEvent(e,{detail:t}):(r=document.createEvent("CustomEvent")).initCustomEvent(e,!1,!0,t),n&&(n.dispatchEvent(r),u()(T,t))}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];C(O,u()({},e,{type:O}),t)}function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];C(R,u()({},e,{type:R}),t)}var A=new function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.handleShowEvent=function(e){for(var n in t.callbacks)p(t.callbacks,n)&&t.callbacks[n].show(e)},this.handleHideEvent=function(e){for(var n in t.callbacks)p(t.callbacks,n)&&t.callbacks[n].hide(e)},this.register=function(e,n){var r=Math.random().toString(36).substring(7);return t.callbacks[r]={show:e,hide:n},r},this.unregister=function(e){e&&t.callbacks[e]&&delete t.callbacks[e]},this.callbacks={},S&&(window.addEventListener(O,this.handleShowEvent),window.addEventListener(R,this.handleHideEvent))},N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},k=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var M=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=r=D(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.handleClick=function(e){0!==e.button&&1!==e.button&&e.preventDefault(),r.props.disabled||r.props.divider||(d(r.props.onClick,e,u()({},r.props.data,T.data),T.target),r.props.preventClose||I())},D(r,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),k(t,[{key:"render",value:function(){var e,t=this,n=this.props,r=n.attributes,i=n.children,a=n.className,s=n.disabled,l=n.divider,u=n.selected,d=c()(a,v,r.className,(P(e={},c()(E,r.disabledClassName),s),P(e,c()(y,r.dividerClassName),l),P(e,c()(_,r.selectedClassName),u),e));return o.a.createElement("div",N({},r,{className:d,role:"menuitem",tabIndex:"-1","aria-disabled":s?"true":"false","aria-orientation":l?"horizontal":null,ref:function(e){t.ref=e},onMouseMove:this.props.onMouseMove,onMouseLeave:this.props.onMouseLeave,onTouchEnd:this.handleClick,onClick:this.handleClick}),l?null:i)}}]),t}(r.Component);M.propTypes={attributes:a.a.object,children:a.a.node,className:a.a.string,data:a.a.object,disabled:a.a.bool,divider:a.a.bool,onClick:a.a.func,onMouseLeave:a.a.func,onMouseMove:a.a.func,preventClose:a.a.bool,selected:a.a.bool},M.defaultProps={attributes:{},children:null,className:"",data:{},disabled:!1,divider:!1,onClick:function(){return null},onMouseMove:function(){return null},onMouseLeave:function(){return null},preventClose:!1,selected:!1};var L=M;var x=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return U.call(n),n.seletedItemRef=null,n.state={selectedItem:null,forceSubMenuOpen:!1},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r.Component);x.propTypes={children:a.a.node.isRequired};var U=function(){var e=this;this.handleKeyNavigation=function(t){if(!1!==e.state.isVisible)switch(t.keyCode){case 37:case 27:t.preventDefault(),e.hideMenu(t);break;case 38:t.preventDefault(),e.selectChildren(!0);break;case 40:t.preventDefault(),e.selectChildren(!1);break;case 39:e.tryToOpenSubMenu(t);break;case 13:t.preventDefault(),e.tryToOpenSubMenu(t);var n=e.seletedItemRef&&e.seletedItemRef.props&&e.seletedItemRef.props.disabled;e.seletedItemRef&&e.seletedItemRef.ref instanceof HTMLElement&&!n?e.seletedItemRef.ref.click():e.hideMenu(t)}},this.handleForceClose=function(){e.setState({forceSubMenuOpen:!1})},this.tryToOpenSubMenu=function(t){e.state.selectedItem&&e.state.selectedItem.type===e.getSubMenuType()&&(t.preventDefault(),e.setState({forceSubMenuOpen:!0}))},this.selectChildren=function(t){var n=e.state.selectedItem,r=[],i=0,a={};if(o.a.Children.forEach(e.props.children,(function t(n,s){n&&([L,e.getSubMenuType()].indexOf(n.type)<0?o.a.Children.forEach(n.props.children,t):n.props.divider||(n.props.disabled&&(++i,a[s]=!0),r.push(n)))})),i!==r.length){var s=function(e){var n=e;do{t?--n:++n,n<0?n=r.length-1:n>=r.length&&(n=0)}while(n!==e&&a[n]);return n===e?null:n}(r.indexOf(n));null!==s&&e.setState({selectedItem:r[s],forceSubMenuOpen:!1})}},this.onChildMouseMove=function(t){e.state.selectedItem!==t&&e.setState({selectedItem:t,forceSubMenuOpen:!1})},this.onChildMouseLeave=function(){e.setState({selectedItem:null,forceSubMenuOpen:!1})},this.renderChildren=function(t){return o.a.Children.map(t,(function(t){var n={};return o.a.isValidElement(t)?[L,e.getSubMenuType()].indexOf(t.type)<0?(n.children=e.renderChildren(t.props.children),o.a.cloneElement(t,n)):(n.onMouseLeave=e.onChildMouseLeave.bind(e),t.type===e.getSubMenuType()&&(n.forceOpen=e.state.forceSubMenuOpen&&e.state.selectedItem===t,n.forceClose=e.handleForceClose,n.parentKeyNavigationHandler=e.handleKeyNavigation),t.props.divider||e.state.selectedItem!==t?(n.onMouseMove=function(){return e.onChildMouseMove(t)},o.a.cloneElement(t,n)):(n.selected=!0,n.ref=function(t){e.seletedItemRef=t},o.a.cloneElement(t,n))):t}))}},j=x,F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},B=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var H=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getMenuPosition=function(){var e=window,t=e.innerWidth,r=e.innerHeight,o=n.subMenu.getBoundingClientRect(),i={};return o.bottom>r?i.bottom=0:i.top=0,o.right<t?i.left="100%":i.right="100%",i},n.getRTLMenuPosition=function(){var e=window.innerHeight,t=n.subMenu.getBoundingClientRect(),r={};return t.bottom>e?r.bottom=0:r.top=0,t.left<0?r.left="100%":r.right="100%",r},n.hideSubMenu=function(e){e.detail&&e.detail.id&&n.menu&&e.detail.id!==n.menu.id||(n.props.forceOpen&&n.props.forceClose(),n.setState({visible:!1,selectedItem:null}),n.unregisterHandlers())},n.handleClick=function(e){e.preventDefault(),n.props.disabled||(d(n.props.onClick,e,u()({},n.props.data,T.data),T.target),n.props.onClick&&!n.props.preventCloseOnClick&&I())},n.handleMouseEnter=function(){n.closetimer&&clearTimeout(n.closetimer),n.props.disabled||n.state.visible||(n.opentimer=setTimeout((function(){return n.setState({visible:!0,selectedItem:null})}),n.props.hoverDelay))},n.handleMouseLeave=function(){n.opentimer&&clearTimeout(n.opentimer),n.state.visible&&(n.closetimer=setTimeout((function(){return n.setState({visible:!1,selectedItem:null})}),n.props.hoverDelay))},n.menuRef=function(e){n.menu=e},n.subMenuRef=function(e){n.subMenu=e},n.registerHandlers=function(){document.removeEventListener("keydown",n.props.parentKeyNavigationHandler),document.addEventListener("keydown",n.handleKeyNavigation)},n.unregisterHandlers=function(e){document.removeEventListener("keydown",n.handleKeyNavigation),e||document.addEventListener("keydown",n.props.parentKeyNavigationHandler)},n.state=u()({},n.state,{visible:!1}),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),B(t,[{key:"componentDidMount",value:function(){this.listenId=A.register((function(){}),this.hideSubMenu)}},{key:"getSubMenuType",value:function(){return t}},{key:"shouldComponentUpdate",value:function(e,t){return this.isVisibilityChange=(this.state.visible!==t.visible||this.props.forceOpen!==e.forceOpen)&&!(this.state.visible&&e.forceOpen)&&!(this.props.forceOpen&&t.visible),!0}},{key:"componentDidUpdate",value:function(){var e=this;if(this.isVisibilityChange)if(this.props.forceOpen||this.state.visible){(window.requestAnimationFrame||setTimeout)((function(){var t=e.props.rtl?e.getRTLMenuPosition():e.getMenuPosition();e.subMenu.style.removeProperty("top"),e.subMenu.style.removeProperty("bottom"),e.subMenu.style.removeProperty("left"),e.subMenu.style.removeProperty("right"),p(t,"top")&&(e.subMenu.style.top=t.top),p(t,"left")&&(e.subMenu.style.left=t.left),p(t,"bottom")&&(e.subMenu.style.bottom=t.bottom),p(t,"right")&&(e.subMenu.style.right=t.right),e.subMenu.classList.add(f),e.registerHandlers(),e.setState({selectedItem:null})}))}else{this.subMenu.addEventListener("transitionend",(function t(){e.subMenu.removeEventListener("transitionend",t),e.subMenu.style.removeProperty("bottom"),e.subMenu.style.removeProperty("right"),e.subMenu.style.top=0,e.subMenu.style.left="100%",e.unregisterHandlers()})),this.subMenu.classList.remove(f)}}},{key:"componentWillUnmount",value:function(){this.listenId&&A.unregister(this.listenId),this.opentimer&&clearTimeout(this.opentimer),this.closetimer&&clearTimeout(this.closetimer),this.unregisterHandlers(!0)}},{key:"render",value:function(){var e,t=this.props,n=t.children,r=t.attributes,i=t.disabled,a=t.title,s=t.selected,l=this.state.visible,u={ref:this.menuRef,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,className:c()(v,b,r.listClassName),style:{position:"relative"}},d={className:c()(v,r.className,(e={},V(e,c()(E,r.disabledClassName),i),V(e,c()(g,r.visibleClassName),l),V(e,c()(_,r.selectedClassName),s),e)),onMouseMove:this.props.onMouseMove,onMouseOut:this.props.onMouseOut,onClick:this.handleClick},p={ref:this.subMenuRef,style:{position:"absolute",transition:"opacity 1ms",top:0,left:"100%"},className:c()(h,this.props.className)};return o.a.createElement("nav",F({},u,{role:"menuitem",tabIndex:"-1","aria-haspopup":"true"}),o.a.createElement("div",F({},r,d),a),o.a.createElement("nav",F({},p,{role:"menu",tabIndex:"-1"}),this.renderChildren(n)))}}]),t}(j);H.propTypes={children:a.a.node.isRequired,attributes:a.a.object,title:a.a.node.isRequired,className:a.a.string,disabled:a.a.bool,hoverDelay:a.a.number,rtl:a.a.bool,selected:a.a.bool,onMouseMove:a.a.func,onMouseOut:a.a.func,forceOpen:a.a.bool,forceClose:a.a.func,parentKeyNavigationHandler:a.a.func},H.defaultProps={disabled:!1,hoverDelay:500,attributes:{},className:"",rtl:!1,selected:!1,onMouseMove:function(){return null},onMouseOut:function(){return null},forceOpen:!1,forceClose:function(){return null},parentKeyNavigationHandler:function(){return null}};var G=H,W=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var q=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.registerHandlers=function(){document.addEventListener("mousedown",n.handleOutsideClick),document.addEventListener("touchstart",n.handleOutsideClick),n.props.preventHideOnScroll||document.addEventListener("scroll",n.handleHide),n.props.preventHideOnContextMenu||document.addEventListener("contextmenu",n.handleHide),document.addEventListener("keydown",n.handleKeyNavigation),n.props.preventHideOnResize||window.addEventListener("resize",n.handleHide)},n.unregisterHandlers=function(){document.removeEventListener("mousedown",n.handleOutsideClick),document.removeEventListener("touchstart",n.handleOutsideClick),document.removeEventListener("scroll",n.handleHide),document.removeEventListener("contextmenu",n.handleHide),document.removeEventListener("keydown",n.handleKeyNavigation),window.removeEventListener("resize",n.handleHide)},n.handleShow=function(e){if(e.detail.id===n.props.id&&!n.state.isVisible){var t=e.detail.position,r=t.x,o=t.y;n.setState({isVisible:!0,x:r,y:o}),n.registerHandlers(),d(n.props.onShow,e)}},n.handleHide=function(e){!n.state.isVisible||e.detail&&e.detail.id&&e.detail.id!==n.props.id||(n.unregisterHandlers(),n.setState({isVisible:!1,selectedItem:null,forceSubMenuOpen:!1}),d(n.props.onHide,e))},n.handleOutsideClick=function(e){n.menu.contains(e.target)||I()},n.handleMouseLeave=function(e){e.preventDefault(),d(n.props.onMouseLeave,e,u()({},n.props.data,T.data),T.target),n.props.hideOnLeave&&I()},n.handleContextMenu=function(e){e.preventDefault(),n.handleHide(e)},n.hideMenu=function(e){27!==e.keyCode&&13!==e.keyCode||I()},n.getMenuPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r={top:t,left:e};if(!n.menu)return r;var o=window,i=o.innerWidth,a=o.innerHeight,s=n.menu.getBoundingClientRect();return t+s.height>a&&(r.top-=s.height),e+s.width>i&&(r.left-=s.width),r.top<0&&(r.top=s.height<a?(a-s.height)/2:0),r.left<0&&(r.left=s.width<i?(i-s.width)/2:0),r},n.getRTLMenuPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r={top:t,left:e};if(!n.menu)return r;var o=window,i=o.innerWidth,a=o.innerHeight,s=n.menu.getBoundingClientRect();return r.left=e-s.width,t+s.height>a&&(r.top-=s.height),r.left<0&&(r.left+=s.width),r.top<0&&(r.top=s.height<a?(a-s.height)/2:0),r.left+s.width>i&&(r.left=s.width<i?(i-s.width)/2:0),r},n.menuRef=function(e){n.menu=e},n.state=u()({},n.state,{x:0,y:0,isVisible:!1}),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),W(t,[{key:"getSubMenuType",value:function(){return G}},{key:"componentDidMount",value:function(){this.listenId=A.register(this.handleShow,this.handleHide)}},{key:"componentDidUpdate",value:function(){var e=this,t=window.requestAnimationFrame||setTimeout;this.state.isVisible?t((function(){var n=e.state,r=n.x,o=n.y,i=e.props.rtl?e.getRTLMenuPosition(r,o):e.getMenuPosition(r,o),a=i.top,s=i.left;t((function(){e.menu&&(e.menu.style.top=a+"px",e.menu.style.left=s+"px",e.menu.style.opacity=1,e.menu.style.pointerEvents="auto")}))})):t((function(){e.menu&&(e.menu.style.opacity=0,e.menu.style.pointerEvents="none")}))}},{key:"componentWillUnmount",value:function(){this.listenId&&A.unregister(this.listenId),this.unregisterHandlers()}},{key:"render",value:function(){var e,t,n,r=this.props,i=r.children,a=r.className,s=r.style,l=this.state.isVisible,d=u()({},s,{position:"fixed",opacity:0,pointerEvents:"none"}),p=c()(h,a,(n=l,(t=f)in(e={})?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e));return o.a.createElement("nav",{role:"menu",tabIndex:"-1",ref:this.menuRef,style:d,className:p,onContextMenu:this.handleContextMenu,onMouseLeave:this.handleMouseLeave},this.renderChildren(i))}}]),t}(j);q.propTypes={id:a.a.string.isRequired,children:a.a.node.isRequired,data:a.a.object,className:a.a.string,hideOnLeave:a.a.bool,rtl:a.a.bool,onHide:a.a.func,onMouseLeave:a.a.func,onShow:a.a.func,preventHideOnContextMenu:a.a.bool,preventHideOnResize:a.a.bool,preventHideOnScroll:a.a.bool,style:a.a.object},q.defaultProps={className:"",data:{},hideOnLeave:!1,rtl:!1,onHide:function(){return null},onMouseLeave:function(){return null},onShow:function(){return null},preventHideOnContextMenu:!1,preventHideOnResize:!1,preventHideOnScroll:!1,style:{}};var K=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var z=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=r=Y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.touchHandled=!1,r.handleMouseDown=function(e){r.props.holdToDisplay>=0&&0===e.button&&(e.persist(),e.stopPropagation(),r.mouseDownTimeoutId=setTimeout((function(){return r.handleContextClick(e)}),r.props.holdToDisplay)),d(r.props.attributes.onMouseDown,e)},r.handleMouseUp=function(e){0===e.button&&clearTimeout(r.mouseDownTimeoutId),d(r.props.attributes.onMouseUp,e)},r.handleMouseOut=function(e){0===e.button&&clearTimeout(r.mouseDownTimeoutId),d(r.props.attributes.onMouseOut,e)},r.handleTouchstart=function(e){r.touchHandled=!1,r.props.holdToDisplay>=0&&(e.persist(),e.stopPropagation(),r.touchstartTimeoutId=setTimeout((function(){r.handleContextClick(e),r.touchHandled=!0}),r.props.holdToDisplay)),d(r.props.attributes.onTouchStart,e)},r.handleTouchEnd=function(e){r.touchHandled&&e.preventDefault(),clearTimeout(r.touchstartTimeoutId),d(r.props.attributes.onTouchEnd,e)},r.handleContextMenu=function(e){e.button===r.props.mouseButton&&r.handleContextClick(e),d(r.props.attributes.onContextMenu,e)},r.handleMouseClick=function(e){e.button===r.props.mouseButton&&r.handleContextClick(e),d(r.props.attributes.onClick,e)},r.handleContextClick=function(e){if(!r.props.disable&&(!r.props.disableIfShiftIsPressed||!e.shiftKey)){e.preventDefault(),e.stopPropagation();var t=e.clientX||e.touches&&e.touches[0].pageX,n=e.clientY||e.touches&&e.touches[0].pageY;r.props.posX&&(t-=r.props.posX),r.props.posY&&(n-=r.props.posY),I();var o=d(r.props.collect,r.props),i={position:{x:t,y:n},target:r.elem,id:r.props.id};o&&"function"===typeof o.then?o.then((function(t){i.data=u()({},t,{target:e.target}),w(i)})):(i.data=u()({},o,{target:e.target}),w(i))}},r.elemRef=function(e){r.elem=e},Y(r,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),K(t,[{key:"render",value:function(){var e=this.props,t=e.renderTag,n=e.attributes,r=e.children,i=u()({},n,{className:c()(m,n.className),onContextMenu:this.handleContextMenu,onClick:this.handleMouseClick,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onTouchStart:this.handleTouchstart,onTouchEnd:this.handleTouchEnd,onMouseOut:this.handleMouseOut,ref:this.elemRef});return o.a.createElement(t,i,r)}}]),t}(r.Component);z.propTypes={id:a.a.string.isRequired,children:a.a.node.isRequired,attributes:a.a.object,collect:a.a.func,disable:a.a.bool,holdToDisplay:a.a.number,posX:a.a.number,posY:a.a.number,renderTag:a.a.elementType,mouseButton:a.a.number,disableIfShiftIsPressed:a.a.bool},z.defaultProps={attributes:{},collect:function(){return null},disable:!1,holdToDisplay:1e3,renderTag:"div",posX:0,posY:0,mouseButton:2,disableIfShiftIsPressed:!1};var X=z;Object.assign,function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}}();[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Object.keys(X.propTypes)),["children"])},,,,function(e,t,n){var r=n(399),o=n(579);e.exports=o,e.exports.default=o,e.exports.Quill=r,e.exports.Mixin=n(402),e.exports.Toolbar=n(671)},,function(e,t,n){},function(e,t,n){},function(e,t,n){var r,o,i;o=[t,n(2),n(31)],r=function(t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(n);function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}i(r);var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function u(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function p(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function h(e){for(var t=[],n=0;n<e.length;n++)-1===t.indexOf(e[n])&&t.push("string"===typeof e[n]?e[n].trim():e[n]);return t}function f(e){return window.clipboardData?window.clipboardData.getData("Text"):e.clipboardData?e.clipboardData.getData("text/plain"):""}function m(e){var t=e.tag,n=e.key,r=e.disabled,i=e.onRemove,a=e.classNameRemove,s=e.getTagDisplayValue,c=p(e,["tag","key","disabled","onRemove","classNameRemove","getTagDisplayValue"]);return o.default.createElement("span",d({key:n},c),s(t),!r&&o.default.createElement("a",{className:a,onClick:function(e){return i(n)}}))}function v(e){e.addTag;var t=p(e,["addTag"]),n=t.onChange,r=t.value,i=p(t,["onChange","value"]);return o.default.createElement("input",d({type:"text",onChange:n,value:r},i))}function g(e,t){return o.default.createElement("span",null,e,t)}function E(e){return e.split(" ").map((function(e){return e.trim()}))}var y={className:"react-tagsinput-input",placeholder:"Add a tag"},_=function(e){function t(){s(this,t);var e=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={tag:"",isFocused:!1},e.focus=e.focus.bind(e),e.blur=e.blur.bind(e),e.accept=e.accept.bind(e),e}return u(t,e),c(t,[{key:"_getTagDisplayValue",value:function(e){var t=this.props.tagDisplayProp;return t?e[t]:e}},{key:"_makeTag",value:function(e){var t=this.props.tagDisplayProp;return t?a({},t,e):e}},{key:"_removeTag",value:function(e){var t=this.props.value.concat([]);if(e>-1&&e<t.length){var n=t.splice(e,1);this.props.onChange(t,n,[e])}}},{key:"_clearInput",value:function(){this.hasControlledInput()?this.props.onChangeInput(""):this.setState({tag:""})}},{key:"_tag",value:function(){return this.hasControlledInput()?this.props.inputValue:this.state.tag}},{key:"_addTags",value:function(e){var t=this,n=this.props,r=n.onChange,o=n.onValidationReject,i=n.onlyUnique,a=n.maxTags,s=n.value;i&&(e=(e=h(e)).filter((function(e){return s.every((function(n){return t._getTagDisplayValue(n)!==t._getTagDisplayValue(e)}))})));var c=e.filter((function(e){return!t._validate(t._getTagDisplayValue(e))}));if(e=(e=e.filter((function(e){return t._validate(t._getTagDisplayValue(e))}))).filter((function(e){var n=t._getTagDisplayValue(e);return"function"===typeof n.trim?n.trim().length>=0:n})),a>=0){var l=Math.max(a-s.length,0);e=e.slice(0,l)}if(o&&c.length>0&&o(c),e.length>0){for(var u=s.concat(e),d=[],p=0;p<e.length;p++)d.push(s.length+p);return r(u,e,d),this._clearInput(),!0}return c.length>0||this._clearInput(),!1}},{key:"_validate",value:function(e){var t=this.props,n=t.validate,r=t.validationRegex;return n(e)&&r.test(e)}},{key:"_shouldPreventDefaultEventOnAdd",value:function(e,t,n){return!!e||"Enter"===n&&(this.props.preventSubmit||!this.props.preventSubmit&&!t)}},{key:"focus",value:function(){this.input&&"function"===typeof this.input.focus&&this.input.focus(),this.handleOnFocus()}},{key:"blur",value:function(){this.input&&"function"===typeof this.input.blur&&this.input.blur(),this.handleOnBlur()}},{key:"accept",value:function(){var e=this.props.preventSubmit,t=this._tag();return(""!==t||!e)&&(t=this._makeTag(t),this._addTags([t]))}},{key:"addTag",value:function(e){return this._addTags([e])}},{key:"clearInput",value:function(){this._clearInput()}},{key:"handlePaste",value:function(e){var t=this,n=this.props,r=n.addOnPaste,o=n.pasteSplit;if(r){e.preventDefault();var i=o(f(e)).map((function(e){return t._makeTag(e)}));this._addTags(i)}}},{key:"handleKeyDown",value:function(e){if(!e.defaultPrevented){var t=this.props,n=t.value,r=t.removeKeys,o=t.addKeys,i=""===this._tag(),a=e.keyCode,s=e.key,c=-1!==o.indexOf(a)||-1!==o.indexOf(s),l=-1!==r.indexOf(a)||-1!==r.indexOf(s);if(c){var u=this.accept();this._shouldPreventDefaultEventOnAdd(u,i,s)&&e.preventDefault()}l&&n.length>0&&i&&(e.preventDefault(),this._removeTag(n.length-1))}}},{key:"handleClick",value:function(e){var t=e.target,n=e.target&&e.target.parentElement;t!==this.div&&n!==this.div||this.focus()}},{key:"handleChange",value:function(e){var t=this.props.onChangeInput,n=this.props.inputProps.onChange,r=e.target.value;n&&n(e),this.hasControlledInput()?t(r):this.setState({tag:r})}},{key:"handleOnFocus",value:function(e){var t=this.props.inputProps.onFocus;t&&t(e),this.setState({isFocused:!0})}},{key:"handleOnBlur",value:function(e){var t=this.props.inputProps.onBlur;if(this.setState({isFocused:!1}),null!=e&&(t&&t(e),this.props.addOnBlur&&e.target.value)){var n=this._makeTag(e.target.value);this._addTags([n])}}},{key:"handleRemove",value:function(e){this._removeTag(e)}},{key:"inputProps",value:function(){var e=this.props.inputProps,t=(e.onChange,e.onFocus,e.onBlur,p(e,["onChange","onFocus","onBlur"])),n=d({},y,t);return this.props.disabled&&(n.disabled=!0),n}},{key:"inputValue",value:function(e){return e.currentValue||e.inputValue||""}},{key:"hasControlledInput",value:function(){var e=this.props,t=e.inputValue;return"function"===typeof e.onChangeInput&&"string"===typeof t}},{key:"componentDidMount",value:function(){this.hasControlledInput()||this.setState({tag:this.inputValue(this.props)})}},{key:"componentDidUpdate",value:function(e){this.hasControlledInput()||this.inputValue(this.props)&&this.inputValue(e)!==this.inputValue(this.props)&&this.setState({tag:this.inputValue(this.props)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,r=t.tagProps,i=t.renderLayout,a=t.renderTag,s=t.renderInput,c=t.className,l=t.focusedClassName,u=t.disabled,p=this.state.isFocused,h=n.map((function(t,n){return a(d({key:n,tag:t,onRemove:e.handleRemove.bind(e),disabled:u,getTagDisplayValue:e._getTagDisplayValue.bind(e)},r))})),f=s(d({ref:function(t){e.input=t},value:this._tag(),onPaste:this.handlePaste.bind(this),onKeyDown:this.handleKeyDown.bind(this),onChange:this.handleChange.bind(this),onFocus:this.handleOnFocus.bind(this),onBlur:this.handleOnBlur.bind(this),addTag:this.addTag.bind(this)},this.inputProps()));return o.default.createElement("div",{ref:function(t){e.div=t},onClick:this.handleClick.bind(this),className:c+(p?" "+l:"")},i(h,f))}}]),t}(o.default.Component);_.defaultProps={className:"react-tagsinput",focusedClassName:"react-tagsinput--focused",addKeys:["Tab","Enter"],addOnBlur:!1,addOnPaste:!1,inputProps:{},removeKeys:["Backspace"],renderInput:v,renderTag:m,renderLayout:g,pasteSplit:E,tagProps:{className:"react-tagsinput-tag",classNameRemove:"react-tagsinput-remove"},onlyUnique:!1,maxTags:-1,validate:function(){return!0},validationRegex:/.*/,disabled:!1,tagDisplayProp:null,preventSubmit:!0},t.default=_,e.exports=t.default},void 0===(i="function"===typeof r?r.apply(t,o):r)||(e.exports=i)},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(512),i=(r=o)&&r.__esModule?r:{default:r};t.default=i.default,e.exports=t.default},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(126),o=n(124),i=n(132),a=n(169);function s(e,t){var n,s,c,l,u,d,p,h;Object(o.a)(1,arguments);var f=Object(a.a)(),m=Object(i.a)(null!==(n=null!==(s=null!==(c=null!==(l=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==l?l:null===t||void 0===t||null===(u=t.locale)||void 0===u||null===(d=u.options)||void 0===d?void 0:d.weekStartsOn)&&void 0!==c?c:f.weekStartsOn)&&void 0!==s?s:null===(p=f.locale)||void 0===p||null===(h=p.options)||void 0===h?void 0:h.weekStartsOn)&&void 0!==n?n:0);if(!(m>=0&&m<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var v=Object(r.default)(e),g=v.getUTCDay(),E=(g<m?7:0)+g-m;return v.setUTCDate(v.getUTCDate()-E),v.setUTCHours(0,0,0,0),v}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(126),o=n(124);function i(e){Object(o.a)(1,arguments);var t=Object(r.default)(e),n=t.getUTCDay(),i=(n<1?7:0)+n-1;return t.setUTCDate(t.getUTCDate()-i),t.setUTCHours(0,0,0,0),t}},function(e,t,n){"use strict";function r(e){return e&&"object"===typeof e&&"default"in e?e.default:e}var o=n(134),i=r(n(2)),a=n(196),s=r(n(31)),c=r(n(176)),l=r(n(187));function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function d(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,p(e,t)}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function h(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}var f=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).history=a.createBrowserHistory(t.props),t}return d(t,e),t.prototype.render=function(){return i.createElement(o.Router,{history:this.history,children:this.props.children})},t}(i.Component);f.propTypes={basename:s.string,children:s.node,forceRefresh:s.bool,getUserConfirmation:s.func,keyLength:s.number},f.prototype.componentDidMount=function(){c(!this.props.history,"<BrowserRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { BrowserRouter as Router }`.")};var m=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).history=a.createHashHistory(t.props),t}return d(t,e),t.prototype.render=function(){return i.createElement(o.Router,{history:this.history,children:this.props.children})},t}(i.Component);m.propTypes={basename:s.string,children:s.node,getUserConfirmation:s.func,hashType:s.oneOf(["hashbang","noslash","slash"])},m.prototype.componentDidMount=function(){c(!this.props.history,"<HashRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { HashRouter as Router }`.")};var v=function(e,t){return"function"===typeof e?e(t):e},g=function(e,t){return"string"===typeof e?a.createLocation(e,null,null,t):e},E=function(e){return e},y=i.forwardRef;"undefined"===typeof y&&(y=E);var _=y((function(e,t){var n=e.innerRef,r=e.navigate,o=e.onClick,a=h(e,["innerRef","navigate","onClick"]),s=a.target,c=u({},a,{onClick:function(e){try{o&&o(e)}catch(t){throw e.preventDefault(),t}e.defaultPrevented||0!==e.button||s&&"_self"!==s||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)||(e.preventDefault(),r())}});return c.ref=E!==y&&t||n,i.createElement("a",c)}));_.displayName="LinkAnchor";var b=y((function(e,t){var n=e.component,r=void 0===n?_:n,s=e.replace,c=e.to,d=e.innerRef,p=h(e,["component","replace","to","innerRef"]);return i.createElement(o.__RouterContext.Consumer,null,(function(e){e||l(!1,"You should not use <Link> outside a <Router>");var n=e.history,o=g(v(c,e.location),e.location),h=o?n.createHref(o):"",f=u({},p,{href:h,navigate:function(){var t=v(c,e.location),r=a.createPath(e.location)===a.createPath(g(t));(s||r?n.replace:n.push)(t)}});return E!==y?f.ref=t||d:f.innerRef=d,i.createElement(r,f)}))})),T=s.oneOfType([s.string,s.object,s.func]),S=s.oneOfType([s.string,s.func,s.shape({current:s.any})]);b.displayName="Link",b.propTypes={innerRef:S,onClick:s.func,replace:s.bool,target:s.string,to:T.isRequired};var O=function(e){return e},R=i.forwardRef;"undefined"===typeof R&&(R=O);var C=R((function(e,t){var n=e["aria-current"],r=void 0===n?"page":n,a=e.activeClassName,s=void 0===a?"active":a,c=e.activeStyle,d=e.className,p=e.exact,f=e.isActive,m=e.location,E=e.sensitive,y=e.strict,_=e.style,T=e.to,S=e.innerRef,C=h(e,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return i.createElement(o.__RouterContext.Consumer,null,(function(e){e||l(!1,"You should not use <NavLink> outside a <Router>");var n=m||e.location,a=g(v(T,n),n),h=a.pathname,w=h&&h.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),I=w?o.matchPath(n.pathname,{path:w,exact:p,sensitive:E,strict:y}):null,A=!!(f?f(I,n):I),N="function"===typeof d?d(A):d,k="function"===typeof _?_(A):_;A&&(N=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return e})).join(" ")}(N,s),k=u({},k,c));var P=u({"aria-current":A&&r||null,className:N,style:k,to:a},C);return O!==R?P.ref=t||S:P.innerRef=S,i.createElement(b,P)}))}));C.displayName="NavLink";var w=s.oneOf(["page","step","location","date","time","true","false"]);C.propTypes=u({},b.propTypes,{"aria-current":w,activeClassName:s.string,activeStyle:s.object,className:s.oneOfType([s.string,s.func]),exact:s.bool,isActive:s.func,location:s.object,sensitive:s.bool,strict:s.bool,style:s.oneOfType([s.object,s.func])}),Object.defineProperty(t,"MemoryRouter",{enumerable:!0,get:function(){return o.MemoryRouter}}),Object.defineProperty(t,"Prompt",{enumerable:!0,get:function(){return o.Prompt}}),Object.defineProperty(t,"Redirect",{enumerable:!0,get:function(){return o.Redirect}}),Object.defineProperty(t,"Route",{enumerable:!0,get:function(){return o.Route}}),Object.defineProperty(t,"Router",{enumerable:!0,get:function(){return o.Router}}),Object.defineProperty(t,"StaticRouter",{enumerable:!0,get:function(){return o.StaticRouter}}),Object.defineProperty(t,"Switch",{enumerable:!0,get:function(){return o.Switch}}),Object.defineProperty(t,"generatePath",{enumerable:!0,get:function(){return o.generatePath}}),Object.defineProperty(t,"matchPath",{enumerable:!0,get:function(){return o.matchPath}}),Object.defineProperty(t,"useHistory",{enumerable:!0,get:function(){return o.useHistory}}),Object.defineProperty(t,"useLocation",{enumerable:!0,get:function(){return o.useLocation}}),Object.defineProperty(t,"useParams",{enumerable:!0,get:function(){return o.useParams}}),Object.defineProperty(t,"useRouteMatch",{enumerable:!0,get:function(){return o.useRouteMatch}}),Object.defineProperty(t,"withRouter",{enumerable:!0,get:function(){return o.withRouter}}),t.BrowserRouter=f,t.HashRouter=m,t.Link=b,t.NavLink=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wizardShape=t.withWizard=t.Steps=t.Wizard=t.WithWizard=t.Step=void 0;var r=c(n(719)),o=c(n(720)),i=c(n(721)),a=c(n(722)),s=c(n(724));function c(e){return e&&e.__esModule?e:{default:e}}var l=(0,r.default)("Step"),u=(0,r.default)("WithWizard");t.Step=l,t.WithWizard=u,t.Wizard=o.default,t.Steps=i.default,t.withWizard=a.default,t.wizardShape=s.default},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(345);var o=n(389),i=n(224);function a(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||Object(o.a)(e)||Object(i.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return P})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return Ne})),n.d(t,"d",(function(){return C})),n.d(t,"e",(function(){return O})),n.d(t,"f",(function(){return N})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return V})),n.d(t,"i",(function(){return _})),n.d(t,"j",(function(){return g})),n.d(t,"k",(function(){return ce})),n.d(t,"l",(function(){return Ae})),n.d(t,"m",(function(){return Z})),n.d(t,"n",(function(){return fe})),n.d(t,"o",(function(){return se})),n.d(t,"p",(function(){return me})),n.d(t,"q",(function(){return ve})),n.d(t,"r",(function(){return $})),n.d(t,"s",(function(){return le})),n.d(t,"t",(function(){return ge})),n.d(t,"u",(function(){return de})),n.d(t,"v",(function(){return q})),n.d(t,"w",(function(){return F})),n.d(t,"x",(function(){return H})),n.d(t,"y",(function(){return X})),n.d(t,"z",(function(){return ye})),n.d(t,"A",(function(){return _e})),n.d(t,"B",(function(){return x})),n.d(t,"C",(function(){return be})),n.d(t,"D",(function(){return W})),n.d(t,"E",(function(){return Ce})),n.d(t,"F",(function(){return we})),n.d(t,"G",(function(){return Ie})),n.d(t,"H",(function(){return Q})),n.d(t,"I",(function(){return k}));var r=n(11),o=n(289);var i=n(137),a=n(25),s=n(382),c=n.n(s),l=n(127),u=n(128),d=n(129),p=n(34),h=n(2),f=n(19);function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}function y(e,t){return!t||"object"!==typeof t&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(ee){return!1}}();return function(){var n,r=E(e);if(t){var o=E(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y(this,n)}}var b=function(){};function T(e,t){return t?"-"===t[0]?e+t:e+"__"+t:e}function S(e,t,n){var r=[n];if(t&&e)for(var o in t)t.hasOwnProperty(o)&&t[o]&&r.push("".concat(T(e,o)));return r.filter((function(e){return e})).map((function(e){return String(e).trim()})).join(" ")}var O=function(e){return Array.isArray(e)?e.filter(Boolean):"object"===Object(a.a)(e)&&null!==e?[e]:[]},R=function(e){return e.className,e.clearValue,e.cx,e.getStyles,e.getValue,e.hasValue,e.isMulti,e.isRtl,e.options,e.selectOption,e.selectProps,e.setValue,e.theme,g({},Object(i.a)(e,["className","clearValue","cx","getStyles","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"]))};function C(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function w(e){return C(e)?window.pageYOffset:e.scrollTop}function I(e,t){C(e)?window.scrollTo(0,t):e.scrollTop=t}function A(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b,o=w(e),i=t-o,a=0;!function t(){var s,c=i*((s=(s=a+=10)/n-1)*s*s+1)+o;I(e,c),a<n?window.requestAnimationFrame(t):r(e)}()}function N(e,t){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),o=t.offsetHeight/3;r.bottom+o>n.bottom?I(e,Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+o,e.scrollHeight)):r.top-o<n.top&&I(e,Math.max(t.offsetTop-o,0))}function k(){try{return document.createEvent("TouchEvent"),!0}catch(ee){return!1}}function P(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch(ee){return!1}}var D=!1,M={get passive(){return D=!0}},L="undefined"!==typeof window?window:{};L.addEventListener&&L.removeEventListener&&(L.addEventListener("p",b,M),L.removeEventListener("p",b,!1));var x=D;function U(e){var t=e.maxHeight,n=e.menuEl,r=e.minHeight,o=e.placement,i=e.shouldScroll,a=e.isFixedPosition,s=e.theme.spacing,c=function(e){var t=getComputedStyle(e),n="absolute"===t.position,r=/(auto|scroll)/,o=document.documentElement;if("fixed"===t.position)return o;for(var i=e;i=i.parentElement;)if(t=getComputedStyle(i),(!n||"static"!==t.position)&&r.test(t.overflow+t.overflowY+t.overflowX))return i;return o}(n),l={placement:"bottom",maxHeight:t};if(!n||!n.offsetParent)return l;var u=c.getBoundingClientRect().height,d=n.getBoundingClientRect(),p=d.bottom,h=d.height,f=d.top,m=n.offsetParent.getBoundingClientRect().top,v=window.innerHeight,g=w(c),E=parseInt(getComputedStyle(n).marginBottom,10),y=parseInt(getComputedStyle(n).marginTop,10),_=m-y,b=v-f,T=_+g,S=u-g-f,O=p-v+g+E,R=g+f-y,C=160;switch(o){case"auto":case"bottom":if(b>=h)return{placement:"bottom",maxHeight:t};if(S>=h&&!a)return i&&A(c,O,C),{placement:"bottom",maxHeight:t};if(!a&&S>=r||a&&b>=r)return i&&A(c,O,C),{placement:"bottom",maxHeight:a?b-E:S-E};if("auto"===o||a){var N=t,k=a?_:T;return k>=r&&(N=Math.min(k-E-s.controlHeight,t)),{placement:"top",maxHeight:N}}if("bottom"===o)return i&&I(c,O),{placement:"bottom",maxHeight:t};break;case"top":if(_>=h)return{placement:"top",maxHeight:t};if(T>=h&&!a)return i&&A(c,R,C),{placement:"top",maxHeight:t};if(!a&&T>=r||a&&_>=r){var P=t;return(!a&&T>=r||a&&_>=r)&&(P=a?_-y:T-y),i&&A(c,R,C),{placement:"top",maxHeight:P}}return{placement:"bottom",maxHeight:t};default:throw new Error('Invalid placement provided "'.concat(o,'".'))}return l}var j=function(e){return"auto"===e?"bottom":e},F=function(e){var t,n=e.placement,r=e.theme,o=r.borderRadius,i=r.spacing,a=r.colors;return t={label:"menu"},Object(p.a)(t,function(e){return e?{bottom:"top",top:"bottom"}[e]:"bottom"}(n),"100%"),Object(p.a)(t,"backgroundColor",a.neutral0),Object(p.a)(t,"borderRadius",o),Object(p.a)(t,"boxShadow","0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)"),Object(p.a)(t,"marginBottom",i.menuGutter),Object(p.a)(t,"marginTop",i.menuGutter),Object(p.a)(t,"position","absolute"),Object(p.a)(t,"width","100%"),Object(p.a)(t,"zIndex",1),t},B=Object(h.createContext)({getPortalPlacement:null}),V=function(e){Object(d.a)(n,e);var t=_(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={maxHeight:e.props.maxMenuHeight,placement:null},e.getPlacement=function(t){var n=e.props,r=n.minMenuHeight,o=n.maxMenuHeight,i=n.menuPlacement,a=n.menuPosition,s=n.menuShouldScrollIntoView,c=n.theme;if(t){var l="fixed"===a,u=U({maxHeight:o,menuEl:t,minHeight:r,placement:i,shouldScroll:s&&!l,isFixedPosition:l,theme:c}),d=e.context.getPortalPlacement;d&&d(u),e.setState(u)}},e.getUpdatedProps=function(){var t=e.props.menuPlacement,n=e.state.placement||j(t);return g(g({},e.props),{},{placement:n,maxHeight:e.state.maxHeight})},e}return Object(u.a)(n,[{key:"render",value:function(){return(0,this.props.children)({ref:this.getPlacement,placerProps:this.getUpdatedProps()})}}]),n}(h.Component);V.contextType=B;var H=function(e){var t=e.maxHeight,n=e.theme.spacing.baseUnit;return{maxHeight:t,overflowY:"auto",paddingBottom:n,paddingTop:n,position:"relative",WebkitOverflowScrolling:"touch"}},G=function(e){var t=e.theme,n=t.spacing.baseUnit;return{color:t.colors.neutral40,padding:"".concat(2*n,"px ").concat(3*n,"px"),textAlign:"center"}},W=G,q=G,K=function(e){var t=e.children,n=e.className,i=e.cx,a=e.getStyles,s=e.innerProps;return Object(o.c)("div",Object(r.a)({css:a("noOptionsMessage",e),className:i({"menu-notice":!0,"menu-notice--no-options":!0},n)},s),t)};K.defaultProps={children:"No options"};var Y=function(e){var t=e.children,n=e.className,i=e.cx,a=e.getStyles,s=e.innerProps;return Object(o.c)("div",Object(r.a)({css:a("loadingMessage",e),className:i({"menu-notice":!0,"menu-notice--loading":!0},n)},s),t)};Y.defaultProps={children:"Loading..."};var z,X=function(e){var t=e.rect,n=e.offset,r=e.position;return{left:t.left,position:r,top:n,width:t.width,zIndex:1}},J=function(e){Object(d.a)(n,e);var t=_(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={placement:null},e.getPortalPlacement=function(t){var n=t.placement;n!==j(e.props.menuPlacement)&&e.setState({placement:n})},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.appendTo,n=e.children,i=e.className,a=e.controlElement,s=e.cx,c=e.innerProps,l=e.menuPlacement,u=e.menuPosition,d=e.getStyles,p="fixed"===u;if(!t&&!p||!a)return null;var h=this.state.placement||j(l),m=function(e){var t=e.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}(a),v=p?0:window.pageYOffset,g={offset:m[h]+v,position:u,rect:m},E=Object(o.c)("div",Object(r.a)({css:d("menuPortal",g),className:s({"menu-portal":!0},i)},c),n);return Object(o.c)(B.Provider,{value:{getPortalPlacement:this.getPortalPlacement}},t?Object(f.createPortal)(E,t):E)}}]),n}(h.Component),Z=function(e){var t=e.isDisabled;return{label:"container",direction:e.isRtl?"rtl":null,pointerEvents:t?"none":null,position:"relative"}},Q=function(e){var t=e.theme.spacing;return{alignItems:"center",display:"flex",flex:1,flexWrap:"wrap",padding:"".concat(t.baseUnit/2,"px ").concat(2*t.baseUnit,"px"),WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"}},$=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}};var ee,te,ne={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},re=function(e){var t=e.size,n=Object(i.a)(e,["size"]);return Object(o.c)("svg",Object(r.a)({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:ne},n))},oe=function(e){return Object(o.c)(re,Object(r.a)({size:20},e),Object(o.c)("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},ie=function(e){return Object(o.c)(re,Object(r.a)({size:20},e),Object(o.c)("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},ae=function(e){var t=e.isFocused,n=e.theme,r=n.spacing.baseUnit,o=n.colors;return{label:"indicatorContainer",color:t?o.neutral60:o.neutral20,display:"flex",padding:2*r,transition:"color 150ms",":hover":{color:t?o.neutral80:o.neutral40}}},se=ae,ce=ae,le=function(e){var t=e.isDisabled,n=e.theme,r=n.spacing.baseUnit,o=n.colors;return{label:"indicatorSeparator",alignSelf:"stretch",backgroundColor:t?o.neutral10:o.neutral20,marginBottom:2*r,marginTop:2*r,width:1}},ue=Object(o.d)(z||(ee=["\n  0%, 80%, 100% { opacity: 0; }\n  40% { opacity: 1; }\n"],te||(te=ee.slice(0)),z=Object.freeze(Object.defineProperties(ee,{raw:{value:Object.freeze(te)}})))),de=function(e){var t=e.isFocused,n=e.size,r=e.theme,o=r.colors,i=r.spacing.baseUnit;return{label:"loadingIndicator",color:t?o.neutral60:o.neutral20,display:"flex",padding:2*i,transition:"color 150ms",alignSelf:"center",fontSize:n,lineHeight:1,marginRight:n,textAlign:"center",verticalAlign:"middle"}},pe=function(e){var t=e.delay,n=e.offset;return Object(o.c)("span",{css:Object(o.b)({animation:"".concat(ue," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:n?"1em":null,height:"1em",verticalAlign:"top",width:"1em"},"","")})},he=function(e){var t=e.className,n=e.cx,i=e.getStyles,a=e.innerProps,s=e.isRtl;return Object(o.c)("div",Object(r.a)({css:i("loadingIndicator",e),className:n({indicator:!0,"loading-indicator":!0},t)},a),Object(o.c)(pe,{delay:0,offset:s}),Object(o.c)(pe,{delay:160,offset:!0}),Object(o.c)(pe,{delay:320,offset:!s}))};he.defaultProps={size:4};var fe=function(e){var t=e.isDisabled,n=e.isFocused,r=e.theme,o=r.colors,i=r.borderRadius,a=r.spacing;return{label:"control",alignItems:"center",backgroundColor:t?o.neutral5:o.neutral0,borderColor:t?o.neutral10:n?o.primary:o.neutral20,borderRadius:i,borderStyle:"solid",borderWidth:1,boxShadow:n?"0 0 0 1px ".concat(o.primary):null,cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:a.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms","&:hover":{borderColor:n?o.primary:o.neutral30}}},me=function(e){var t=e.theme.spacing;return{paddingBottom:2*t.baseUnit,paddingTop:2*t.baseUnit}},ve=function(e){var t=e.theme.spacing;return{label:"group",color:"#999",cursor:"default",display:"block",fontSize:"75%",fontWeight:"500",marginBottom:"0.25em",paddingLeft:3*t.baseUnit,paddingRight:3*t.baseUnit,textTransform:"uppercase"}},ge=function(e){var t=e.isDisabled,n=e.theme,r=n.spacing,o=n.colors;return{margin:r.baseUnit/2,paddingBottom:r.baseUnit/2,paddingTop:r.baseUnit/2,visibility:t?"hidden":"visible",color:o.neutral80}},Ee=function(e){return{label:"input",background:0,border:0,fontSize:"inherit",opacity:e?0:1,outline:0,padding:0,color:"inherit"}},ye=function(e){var t=e.theme,n=t.spacing,r=t.borderRadius;return{label:"multiValue",backgroundColor:t.colors.neutral10,borderRadius:r/2,display:"flex",margin:n.baseUnit/2,minWidth:0}},_e=function(e){var t=e.theme,n=t.borderRadius,r=t.colors,o=e.cropWithEllipsis;return{borderRadius:n/2,color:r.neutral80,fontSize:"85%",overflow:"hidden",padding:3,paddingLeft:6,textOverflow:o?"ellipsis":null,whiteSpace:"nowrap"}},be=function(e){var t=e.theme,n=t.spacing,r=t.borderRadius,o=t.colors;return{alignItems:"center",borderRadius:r/2,backgroundColor:e.isFocused&&o.dangerLight,display:"flex",paddingLeft:n.baseUnit,paddingRight:n.baseUnit,":hover":{backgroundColor:o.dangerLight,color:o.danger}}},Te=function(e){var t=e.children,n=e.innerProps;return Object(o.c)("div",n,t)},Se=Te,Oe=Te;var Re=function(e){var t=e.children,n=e.className,r=e.components,i=e.cx,a=e.data,s=e.getStyles,c=e.innerProps,l=e.isDisabled,u=e.removeProps,d=e.selectProps,p=r.Container,h=r.Label,f=r.Remove;return Object(o.c)(o.a,null,(function(r){var m=r.css,v=r.cx;return Object(o.c)(p,{data:a,innerProps:g({className:v(m(s("multiValue",e)),i({"multi-value":!0,"multi-value--is-disabled":l},n))},c),selectProps:d},Object(o.c)(h,{data:a,innerProps:{className:v(m(s("multiValueLabel",e)),i({"multi-value__label":!0},n))},selectProps:d},t),Object(o.c)(f,{data:a,innerProps:g({className:v(m(s("multiValueRemove",e)),i({"multi-value__remove":!0},n))},u),selectProps:d}))}))};Re.defaultProps={cropWithEllipsis:!0};var Ce=function(e){var t=e.isDisabled,n=e.isFocused,r=e.isSelected,o=e.theme,i=o.spacing,a=o.colors;return{label:"option",backgroundColor:r?a.primary:n?a.primary25:"transparent",color:t?a.neutral20:r?a.neutral0:"inherit",cursor:"default",display:"block",fontSize:"inherit",padding:"".concat(2*i.baseUnit,"px ").concat(3*i.baseUnit,"px"),width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",":active":{backgroundColor:!t&&(r?a.primary:a.primary50)}}},we=function(e){var t=e.theme,n=t.spacing;return{label:"placeholder",color:t.colors.neutral50,marginLeft:n.baseUnit/2,marginRight:n.baseUnit/2,position:"absolute",top:"50%",transform:"translateY(-50%)"}},Ie=function(e){var t=e.isDisabled,n=e.theme,r=n.spacing,o=n.colors;return{label:"singleValue",color:t?o.neutral40:o.neutral80,marginLeft:r.baseUnit/2,marginRight:r.baseUnit/2,maxWidth:"calc(100% - ".concat(2*r.baseUnit,"px)"),overflow:"hidden",position:"absolute",textOverflow:"ellipsis",whiteSpace:"nowrap",top:"50%",transform:"translateY(-50%)"}},Ae={ClearIndicator:function(e){var t=e.children,n=e.className,i=e.cx,a=e.getStyles,s=e.innerProps;return Object(o.c)("div",Object(r.a)({css:a("clearIndicator",e),className:i({indicator:!0,"clear-indicator":!0},n)},s),t||Object(o.c)(oe,null))},Control:function(e){var t=e.children,n=e.cx,i=e.getStyles,a=e.className,s=e.isDisabled,c=e.isFocused,l=e.innerRef,u=e.innerProps,d=e.menuIsOpen;return Object(o.c)("div",Object(r.a)({ref:l,css:i("control",e),className:n({control:!0,"control--is-disabled":s,"control--is-focused":c,"control--menu-is-open":d},a)},u),t)},DropdownIndicator:function(e){var t=e.children,n=e.className,i=e.cx,a=e.getStyles,s=e.innerProps;return Object(o.c)("div",Object(r.a)({css:a("dropdownIndicator",e),className:i({indicator:!0,"dropdown-indicator":!0},n)},s),t||Object(o.c)(ie,null))},DownChevron:ie,CrossIcon:oe,Group:function(e){var t=e.children,n=e.className,i=e.cx,a=e.getStyles,s=e.Heading,c=e.headingProps,l=e.innerProps,u=e.label,d=e.theme,p=e.selectProps;return Object(o.c)("div",Object(r.a)({css:a("group",e),className:i({group:!0},n)},l),Object(o.c)(s,Object(r.a)({},c,{selectProps:p,theme:d,getStyles:a,cx:i}),u),Object(o.c)("div",null,t))},GroupHeading:function(e){var t=e.getStyles,n=e.cx,a=e.className,s=R(e);s.data;var c=Object(i.a)(s,["data"]);return Object(o.c)("div",Object(r.a)({css:t("groupHeading",e),className:n({"group-heading":!0},a)},c))},IndicatorsContainer:function(e){var t=e.children,n=e.className,i=e.cx,a=e.innerProps,s=e.getStyles;return Object(o.c)("div",Object(r.a)({css:s("indicatorsContainer",e),className:i({indicators:!0},n)},a),t)},IndicatorSeparator:function(e){var t=e.className,n=e.cx,i=e.getStyles,a=e.innerProps;return Object(o.c)("span",Object(r.a)({},a,{css:i("indicatorSeparator",e),className:n({"indicator-separator":!0},t)}))},Input:function(e){var t=e.className,n=e.cx,a=e.getStyles,s=R(e),l=s.innerRef,u=s.isDisabled,d=s.isHidden,p=Object(i.a)(s,["innerRef","isDisabled","isHidden"]);return Object(o.c)("div",{css:a("input",e)},Object(o.c)(c.a,Object(r.a)({className:n({input:!0},t),inputRef:l,inputStyle:Ee(d),disabled:u},p)))},LoadingIndicator:he,Menu:function(e){var t=e.children,n=e.className,i=e.cx,a=e.getStyles,s=e.innerRef,c=e.innerProps;return Object(o.c)("div",Object(r.a)({css:a("menu",e),className:i({menu:!0},n),ref:s},c),t)},MenuList:function(e){var t=e.children,n=e.className,i=e.cx,a=e.getStyles,s=e.innerProps,c=e.innerRef,l=e.isMulti;return Object(o.c)("div",Object(r.a)({css:a("menuList",e),className:i({"menu-list":!0,"menu-list--is-multi":l},n),ref:c},s),t)},MenuPortal:J,LoadingMessage:Y,NoOptionsMessage:K,MultiValue:Re,MultiValueContainer:Se,MultiValueLabel:Oe,MultiValueRemove:function(e){var t=e.children,n=e.innerProps;return Object(o.c)("div",n,t||Object(o.c)(oe,{size:14}))},Option:function(e){var t=e.children,n=e.className,i=e.cx,a=e.getStyles,s=e.isDisabled,c=e.isFocused,l=e.isSelected,u=e.innerRef,d=e.innerProps;return Object(o.c)("div",Object(r.a)({css:a("option",e),className:i({option:!0,"option--is-disabled":s,"option--is-focused":c,"option--is-selected":l},n),ref:u},d),t)},Placeholder:function(e){var t=e.children,n=e.className,i=e.cx,a=e.getStyles,s=e.innerProps;return Object(o.c)("div",Object(r.a)({css:a("placeholder",e),className:i({placeholder:!0},n)},s),t)},SelectContainer:function(e){var t=e.children,n=e.className,i=e.cx,a=e.getStyles,s=e.innerProps,c=e.isDisabled,l=e.isRtl;return Object(o.c)("div",Object(r.a)({css:a("container",e),className:i({"--is-disabled":c,"--is-rtl":l},n)},s),t)},SingleValue:function(e){var t=e.children,n=e.className,i=e.cx,a=e.getStyles,s=e.isDisabled,c=e.innerProps;return Object(o.c)("div",Object(r.a)({css:a("singleValue",e),className:i({"single-value":!0,"single-value--is-disabled":s},n)},c),t)},ValueContainer:function(e){var t=e.children,n=e.className,i=e.cx,a=e.innerProps,s=e.isMulti,c=e.getStyles,l=e.hasValue;return Object(o.c)("div",Object(r.a)({css:c("valueContainer",e),className:i({"value-container":!0,"value-container--is-multi":s,"value-container--has-value":l},n)},a),t)}},Ne=function(e){return g(g({},Ae),e.components)}},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(345);function o(e,t){if(e){if("string"==typeof e)return Object(r.a)(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(e,t):void 0}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2);function o(e){var t=r.useRef();t.current=e;var n=r.useCallback((function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return null===(e=t.current)||void 0===e?void 0:e.call.apply(e,[t].concat(r))}),[]);return n}},function(e,t,n){"use strict";function r(){return!("undefined"===typeof window||!window.document||!window.document.createElement)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(148),o=n(2);function i(e){var t=o.useRef(!1),n=o.useState(e),i=Object(r.a)(n,2),a=i[0],s=i[1];return o.useEffect((function(){return t.current=!1,function(){t.current=!0}}),[]),[a,function(e,n){n&&t.current||s(e)}]}},,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(132),o=n(126),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=Object(o.default)(e),a=Object(r.a)(t);if(isNaN(a))return new Date(NaN);if(!a)return n;var s=n.getDate(),c=new Date(n.getTime());return c.setMonth(n.getMonth()+a+1,0),s>=c.getDate()?c:(n.setFullYear(c.getFullYear(),c.getMonth(),s),n)}},function(e,t,n){var r=n(190).default,o=n(388).default,i=n(728).default;const a=["list","setList","children","tag","style","className","clone","onAdd","onChange","onChoose","onClone","onEnd","onFilter","onRemove","onSort","onStart","onUnchoose","onUpdate","onMove","onSpill","onSelect","onDeselect"];var s=n(729),c=n(27),l=n(2),u=n(730);function d(e){return e&&e.__esModule?e.default:e}function p(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}function h(e){null!==e.parentElement&&e.parentElement.removeChild(e)}function f(e){e.forEach((e=>h(e.element)))}function m(e){e.forEach((e=>{!function(e,t,n){const r=e.children[n]||null;e.insertBefore(t,r)}(e.parentElement,e.element,e.oldIndex)}))}function v(e,t){const n=_(e),r={parentElement:e.from};let o=[];switch(n){case"normal":o=[{element:e.item,newIndex:e.newIndex,oldIndex:e.oldIndex,parentElement:e.from}];break;case"swap":o=[i({element:e.item,oldIndex:e.oldIndex,newIndex:e.newIndex},r),i({element:e.swapItem,oldIndex:e.newIndex,newIndex:e.oldIndex},r)];break;case"multidrag":o=e.oldIndicies.map(((t,n)=>i({element:t.multiDragElement,oldIndex:t.index,newIndex:e.newIndicies[n].index},r)))}const a=function(e,t){const n=e.map((e=>i(i({},e),{},{item:t[e.oldIndex]}))).sort(((e,t)=>e.oldIndex-t.oldIndex));return n}(o,t);return a}function g(e,t){return y(e,E(e,t))}function E(e,t){const n=[...t];return e.concat().reverse().forEach((e=>n.splice(e.oldIndex,1))),n}function y(e,t,n,r){const o=[...t];return e.forEach((e=>{const t=r&&n&&r(e.item,n);o.splice(e.newIndex,0,t||e.item)})),o}function _(e){return e.oldIndicies&&e.oldIndicies.length>0?"multidrag":e.swapItem?"swap":"normal"}function b(e){const{list:t,setList:n,children:r,tag:i,style:s,className:c,clone:l,onAdd:u,onChange:d,onChoose:p,onClone:h,onEnd:f,onFilter:m,onRemove:v,onSort:g,onStart:E,onUnchoose:y,onUpdate:_,onMove:b,onSpill:T,onSelect:S,onDeselect:O}=e;return o(e,a)}p(e.exports,"Sortable",(()=>$882b6d93070905b3$re_export$Sortable)),p(e.exports,"Direction",(()=>$882b6d93070905b3$re_export$Direction)),p(e.exports,"DOMRect",(()=>$882b6d93070905b3$re_export$DOMRect)),p(e.exports,"GroupOptions",(()=>$882b6d93070905b3$re_export$GroupOptions)),p(e.exports,"MoveEvent",(()=>$882b6d93070905b3$re_export$MoveEvent)),p(e.exports,"Options",(()=>$882b6d93070905b3$re_export$Options)),p(e.exports,"PullResult",(()=>$882b6d93070905b3$re_export$PullResult)),p(e.exports,"PutResult",(()=>$882b6d93070905b3$re_export$PutResult)),p(e.exports,"SortableEvent",(()=>$882b6d93070905b3$re_export$SortableEvent)),p(e.exports,"SortableOptions",(()=>$882b6d93070905b3$re_export$SortableOptions)),p(e.exports,"Utils",(()=>$882b6d93070905b3$re_export$Utils)),p(e.exports,"ReactSortable",(()=>S));const T={dragging:null};class S extends l.Component{constructor(e){super(e),this.ref=(0,l.createRef)();const t=[...e.list].map((e=>Object.assign(e,{chosen:!1,selected:!1})));e.setList(t,this.sortable,T),d(u)(!e.plugins,'\nPlugins prop is no longer supported.\nInstead, mount it with "Sortable.mount(new MultiDrag())"\nPlease read the updated README.md at https://github.com/SortableJS/react-sortablejs.\n      ')}componentDidMount(){if(null===this.ref.current)return;const e=this.makeOptions();d(s).create(this.ref.current,e)}componentDidUpdate(e){e.disabled!==this.props.disabled&&this.sortable&&this.sortable.option("disabled",this.props.disabled)}render(){const{tag:e,style:t,className:n,id:r}=this.props,o={style:t,className:n,id:r},a=e&&null!==e?e:"div";return(0,l.createElement)(a,i({ref:this.ref},o),this.getChildren())}getChildren(){const{children:e,dataIdAttr:t,selectedClass:n="sortable-selected",chosenClass:r="sortable-chosen",dragClass:o="sortable-drag",fallbackClass:a="sortable-falback",ghostClass:s="sortable-ghost",swapClass:u="sortable-swap-highlight",filter:p="sortable-filter",list:h}=this.props;if(!e||null==e)return null;const f=t||"data-id";return l.Children.map(e,((e,t)=>{if(void 0===e)return;const o=h[t]||{},{className:a}=e.props,s="string"===typeof p&&{[p.replace(".","")]:!!o.filtered},u=d(c)(a,i({[n]:o.selected,[r]:o.chosen},s));return(0,l.cloneElement)(e,{[f]:e.key,className:u})}))}get sortable(){const e=this.ref.current;if(null===e)return null;const t=Object.keys(e).find((e=>e.includes("Sortable")));return t?e[t]:null}makeOptions(){const e=b(this.props);["onAdd","onChoose","onDeselect","onEnd","onRemove","onSelect","onSpill","onStart","onUnchoose","onUpdate"].forEach((t=>e[t]=this.prepareOnHandlerPropAndDOM(t))),["onChange","onClone","onFilter","onSort"].forEach((t=>e[t]=this.prepareOnHandlerProp(t)));return i(i({},e),{},{onMove:(e,t)=>{const{onMove:n}=this.props,r=e.willInsertAfter||-1;if(!n)return r;const o=n(e,t,this.sortable,T);return"undefined"!==typeof o&&o}})}prepareOnHandlerPropAndDOM(e){return t=>{this.callOnHandlerProp(t,e),this[e](t)}}prepareOnHandlerProp(e){return t=>{this.callOnHandlerProp(t,e)}}callOnHandlerProp(e,t){const n=this.props[t];n&&n(e,this.sortable,T)}onAdd(e){const{list:t,setList:n,clone:r}=this.props,o=v(e,[...T.dragging.props.list]);f(o);n(y(o,t,e,r).map((e=>Object.assign(e,{selected:!1}))),this.sortable,T)}onRemove(e){const{list:t,setList:n}=this.props,r=_(e),o=v(e,t);m(o);let a=[...t];if("clone"!==e.pullMode)a=E(o,a);else{let t=o;switch(r){case"multidrag":t=o.map(((t,n)=>i(i({},t),{},{element:e.clones[n]})));break;case"normal":t=o.map((t=>i(i({},t),{},{element:e.clone})));break;default:d(u)(!0,'mode "'.concat(r,'" cannot clone. Please remove "props.clone" from <ReactSortable/> when using the "').concat(r,'" plugin'))}f(t),o.forEach((t=>{const n=t.oldIndex,r=this.props.clone(t.item,e);a.splice(n,1,r)}))}a=a.map((e=>Object.assign(e,{selected:!1}))),n(a,this.sortable,T)}onUpdate(e){const{list:t,setList:n}=this.props,r=v(e,t);f(r),m(r);return n(g(r,t),this.sortable,T)}onStart(){T.dragging=this}onEnd(){T.dragging=null}onChoose(e){const{list:t,setList:n}=this.props;n(t.map(((t,n)=>{let r=t;return n===e.oldIndex&&(r=Object.assign(t,{chosen:!0})),r})),this.sortable,T)}onUnchoose(e){const{list:t,setList:n}=this.props;n(t.map(((t,n)=>{let r=t;return n===e.oldIndex&&(r=Object.assign(r,{chosen:!1})),r})),this.sortable,T)}onSpill(e){const{removeOnSpill:t,revertOnSpill:n}=this.props;t&&!n&&h(e.item)}onSelect(e){const{list:t,setList:n}=this.props,r=t.map((e=>Object.assign(e,{selected:!1})));e.newIndicies.forEach((t=>{const n=t.index;if(-1===n)return console.log('"'.concat(e.type,'" had indice of "').concat(t.index,"\", which is probably -1 and doesn't usually happen here.")),void console.log(e);r[n].selected=!0})),n(r,this.sortable,T)}onDeselect(e){const{list:t,setList:n}=this.props,r=t.map((e=>Object.assign(e,{selected:!1})));e.newIndicies.forEach((e=>{const t=e.index;-1!==t&&(r[t].selected=!0)})),n(r,this.sortable,T)}}r(S,"defaultProps",{clone:e=>e});var O,R;O=e.exports,R={},Object.keys(R).forEach((function(e){"default"===e||"__esModule"===e||O.hasOwnProperty(e)||Object.defineProperty(O,e,{enumerable:!0,get:function(){return R[e]}})}))},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(148),o=n(225),i=n(273),a=n(227);function s(e){return void 0!==e}function c(e,t){var n=t||{},c=n.defaultValue,l=n.value,u=n.onChange,d=n.postState,p=Object(a.a)((function(){return s(l)?l:s(c)?"function"===typeof c?c():c:"function"===typeof e?e():e})),h=Object(r.a)(p,2),f=h[0],m=h[1],v=void 0!==l?l:f,g=d?d(v):v,E=Object(o.a)(u),y=Object(a.a)([v]),_=Object(r.a)(y,2),b=_[0],T=_[1];return Object(i.b)((function(){var e=b[0];f!==e&&E(f,e)}),[b]),Object(i.b)((function(){s(l)||m(l)}),[l]),[g,Object(o.a)((function(e,t){m(e,t),T([v],t)}))]}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(2),o=n(226),i=Object(o.a)()?r.useLayoutEffect:r.useEffect,a=function(e,t){var n=r.useRef(!0);i((function(){return e(n.current)}),t),i((function(){return n.current=!1,function(){n.current=!0}}),[])},s=function(e,t){a((function(t){if(!t)return e()}),t)};t.a=a},,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u}));var r=n(160),o=n(2),i=n(383),a=n(384),s=n(481),c=(n(328),n(228),n(290),n(32),function(e,t){var n=arguments;if(null==t||!r.f.call(t,"css"))return o.createElement.apply(void 0,n);var i=n.length,a=new Array(i);a[0]=r.b,a[1]=Object(r.e)(e,t);for(var s=2;s<i;s++)a[s]=n[s];return o.createElement.apply(null,a)});!function(e){var t;t||(t=e.JSX||(e.JSX={}))}(c||(c={}));function l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object(s.a)(t)}function u(){var e=l.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var d=function e(t){for(var n=t.length,r=0,o="";r<n;r++){var i=t[r];if(null!=i){var a=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))a=e(i);else for(var s in a="",i)i[s]&&s&&(a&&(a+=" "),a+=s);break;default:a=i}a&&(o&&(o+=" "),o+=a)}}return o};var p=function(e){var t,n=e.cache,s=e.serializedArr,c=Object(a.a)((function(){for(var e="",t=0;t<s.length;t++){var o=Object(i.b)(n,s[t],!1);r.g||void 0===o||(e+=o)}if(!r.g)return e}));return r.g||0===c.length?null:o.createElement("style",((t={})["data-emotion"]=n.key+" "+s.map((function(e){return e.name})).join(" "),t.dangerouslySetInnerHTML={__html:c},t.nonce=n.sheet.nonce,t))},h=Object(r.h)((function(e,t){var n=!1,a=[],c=function(){if(n&&r.d)throw new Error("css can only be used during render");for(var e=arguments.length,o=new Array(e),c=0;c<e;c++)o[c]=arguments[c];var l=Object(s.a)(o,t.registered);return a.push(l),Object(i.c)(t,l,!1),t.key+"-"+l.name},l={css:c,cx:function(){if(n&&r.d)throw new Error("cx can only be used during render");for(var e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return function(e,t,n){var r=[],o=Object(i.a)(e,r,n);return r.length<2?n:o+t(r)}(t.registered,c,d(o))},theme:o.useContext(r.c)},u=e.children(l);return n=!0,o.createElement(o.Fragment,null,o.createElement(p,{cache:t,serializedArr:a}),u)}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){var t=new WeakMap;return function(n){if(t.has(n))return t.get(n);var r=e(n);return t.set(n,r),r}}},,function(e,t,n){"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,"a",(function(){return r}))},,,,,,,,,,,function(e,t,n){"use strict";function r(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(132),o=n(126),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=Object(o.default)(e).getTime(),a=Object(r.a)(t);return new Date(n+a)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(126),o=n(124),i=n(206),a=n(132),s=n(169);function c(e,t){var n,c,l,u,d,p,h,f;Object(o.a)(1,arguments);var m=Object(r.default)(e),v=m.getUTCFullYear(),g=Object(s.a)(),E=Object(a.a)(null!==(n=null!==(c=null!==(l=null!==(u=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==u?u:null===t||void 0===t||null===(d=t.locale)||void 0===d||null===(p=d.options)||void 0===p?void 0:p.firstWeekContainsDate)&&void 0!==l?l:g.firstWeekContainsDate)&&void 0!==c?c:null===(h=g.locale)||void 0===h||null===(f=h.options)||void 0===f?void 0:f.firstWeekContainsDate)&&void 0!==n?n:1);if(!(E>=1&&E<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var y=new Date(0);y.setUTCFullYear(v+1,0,E),y.setUTCHours(0,0,0,0);var _=Object(i.a)(y,t),b=new Date(0);b.setUTCFullYear(v,0,E),b.setUTCHours(0,0,0,0);var T=Object(i.a)(b,t);return m.getTime()>=_.getTime()?v+1:m.getTime()>=T.getTime()?v:v-1}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(132),o=n(126),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=Object(o.default)(e),a=Object(r.a)(t);return isNaN(a)?new Date(NaN):a?(n.setDate(n.getDate()+a),n):n}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){Object(o.a)(1,arguments);var t=Object(r.default)(e);return t.setHours(0,0,0,0),t}},,,,function(e,t,n){(function(t,n,r){e.exports=function(){"use strict";function e(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{};function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var a=function(e){try{return!!e()}catch(e){return!0}},s=!a((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),c=s,l=Function.prototype,u=l.call,d=c&&l.bind.bind(u,u),p=c?d:function(e){return function(){return u.apply(e,arguments)}},h=p({}.isPrototypeOf),f=function(e){return e&&e.Math===Math&&e},m=f("object"==typeof globalThis&&globalThis)||f("object"==typeof window&&window)||f("object"==typeof self&&self)||f("object"==typeof o&&o)||f("object"==typeof o&&o)||function(){return this}()||Function("return this")(),v=s,g=Function.prototype,E=g.apply,y=g.call,_="object"==typeof Reflect&&Reflect.apply||(v?y.bind(E):function(){return y.apply(E,arguments)}),b=p,T=b({}.toString),S=b("".slice),O=function(e){return S(T(e),8,-1)},R=O,C=p,w=function(e){if("Function"===R(e))return C(e)},I="object"==typeof document&&document.all,A=void 0===I&&void 0!==I?function(e){return"function"==typeof e||e===I}:function(e){return"function"==typeof e},N={},k=!a((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),P=s,D=Function.prototype.call,M=P?D.bind(D):function(){return D.apply(D,arguments)},L={},x={}.propertyIsEnumerable,U=Object.getOwnPropertyDescriptor,j=U&&!x.call({1:2},1);L.f=j?function(e){var t=U(this,e);return!!t&&t.enumerable}:x;var F,B,V=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},H=a,G=O,W=Object,q=p("".split),K=H((function(){return!W("z").propertyIsEnumerable(0)}))?function(e){return"String"===G(e)?q(e,""):W(e)}:W,Y=function(e){return null==e},z=Y,X=TypeError,J=function(e){if(z(e))throw new X("Can't call method on "+e);return e},Z=K,Q=J,$=function(e){return Z(Q(e))},ee=A,te=function(e){return"object"==typeof e?null!==e:ee(e)},ne={},re=ne,oe=m,ie=A,ae=function(e){return ie(e)?e:void 0},se=function(e,t){return arguments.length<2?ae(re[e])||ae(oe[e]):re[e]&&re[e][t]||oe[e]&&oe[e][t]},ce=m.navigator,le=ce&&ce.userAgent,ue=le?String(le):"",de=m,pe=ue,he=de.process,fe=de.Deno,me=he&&he.versions||fe&&fe.version,ve=me&&me.v8;ve&&(B=(F=ve.split("."))[0]>0&&F[0]<4?1:+(F[0]+F[1])),!B&&pe&&(!(F=pe.match(/Edge\/(\d+)/))||F[1]>=74)&&(F=pe.match(/Chrome\/(\d+)/))&&(B=+F[1]);var ge=B,Ee=ge,ye=a,_e=m.String,be=!!Object.getOwnPropertySymbols&&!ye((function(){var e=Symbol("symbol detection");return!_e(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Ee&&Ee<41})),Te=be&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Se=se,Oe=A,Re=h,Ce=Object,we=Te?function(e){return"symbol"==typeof e}:function(e){var t=Se("Symbol");return Oe(t)&&Re(t.prototype,Ce(e))},Ie=String,Ae=function(e){try{return Ie(e)}catch(e){return"Object"}},Ne=A,ke=Ae,Pe=TypeError,De=function(e){if(Ne(e))return e;throw new Pe(ke(e)+" is not a function")},Me=De,Le=Y,xe=function(e,t){var n=e[t];return Le(n)?void 0:Me(n)},Ue=M,je=A,Fe=te,Be=TypeError,Ve={exports:{}},He=!0,Ge=m,We=Object.defineProperty,qe=m,Ke=function(e,t){try{We(Ge,e,{value:t,configurable:!0,writable:!0})}catch(i){Ge[e]=t}return t},Ye="__core-js_shared__",ze=Ve.exports=qe[Ye]||Ke(Ye,{});(ze.versions||(ze.versions=[])).push({version:"3.39.0",mode:"pure",copyright:"\xa9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Xe=Ve.exports,Je=Xe,Ze=function(e,t){return Je[e]||(Je[e]=t||{})},Qe=J,$e=Object,et=function(e){return $e(Qe(e))},tt=et,nt=p({}.hasOwnProperty),rt=Object.hasOwn||function(e,t){return nt(tt(e),t)},ot=p,it=0,at=Math.random(),st=ot(1..toString),ct=function(e){return"Symbol("+(void 0===e?"":e)+")_"+st(++it+at,36)},lt=Ze,ut=rt,dt=ct,pt=be,ht=Te,ft=m.Symbol,mt=lt("wks"),vt=ht?ft.for||ft:ft&&ft.withoutSetter||dt,gt=function(e){return ut(mt,e)||(mt[e]=pt&&ut(ft,e)?ft[e]:vt("Symbol."+e)),mt[e]},Et=M,yt=te,_t=we,bt=xe,Tt=function(e,t){var n,r;if("string"===t&&je(n=e.toString)&&!Fe(r=Ue(n,e)))return r;if(je(n=e.valueOf)&&!Fe(r=Ue(n,e)))return r;if("string"!==t&&je(n=e.toString)&&!Fe(r=Ue(n,e)))return r;throw new Be("Can't convert object to primitive value")},St=TypeError,Ot=gt("toPrimitive"),Rt=function(e,t){if(!yt(e)||_t(e))return e;var n,r=bt(e,Ot);if(r){if(void 0===t&&(t="default"),n=Et(r,e,t),!yt(n)||_t(n))return n;throw new St("Can't convert object to primitive value")}return void 0===t&&(t="number"),Tt(e,t)},Ct=we,wt=function(e){var t=Rt(e,"string");return Ct(t)?t:t+""},It=te,At=m.document,Nt=It(At)&&It(At.createElement),kt=function(e){return Nt?At.createElement(e):{}},Pt=kt,Dt=!k&&!a((function(){return 7!==Object.defineProperty(Pt("div"),"a",{get:function(){return 7}}).a})),Mt=k,Lt=M,xt=L,Ut=V,jt=$,Ft=wt,Bt=rt,Vt=Dt,Ht=Object.getOwnPropertyDescriptor;N.f=Mt?Ht:function(e,t){if(e=jt(e),t=Ft(t),Vt)try{return Ht(e,t)}catch(e){}if(Bt(e,t))return Ut(!Lt(xt.f,e,t),e[t])};var Gt=a,Wt=A,qt=/#|\.prototype\./,Kt=function(e,t){var n=zt[Yt(e)];return n===Jt||n!==Xt&&(Wt(t)?Gt(t):!!t)},Yt=Kt.normalize=function(e){return String(e).replace(qt,".").toLowerCase()},zt=Kt.data={},Xt=Kt.NATIVE="N",Jt=Kt.POLYFILL="P",Zt=Kt,Qt=De,$t=s,en=w(w.bind),tn=function(e,t){return Qt(e),void 0===t?e:$t?en(e,t):function(){return e.apply(t,arguments)}},nn={},rn=k&&a((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),on=te,an=String,sn=TypeError,cn=function(e){if(on(e))return e;throw new sn(an(e)+" is not an object")},ln=k,un=Dt,dn=rn,pn=cn,hn=wt,fn=TypeError,mn=Object.defineProperty,vn=Object.getOwnPropertyDescriptor,gn="enumerable",En="configurable",yn="writable";nn.f=ln?dn?function(e,t,n){if(pn(e),t=hn(t),pn(n),"function"==typeof e&&"prototype"===t&&"value"in n&&yn in n&&!n[yn]){var r=vn(e,t);r&&r[yn]&&(e[t]=n.value,n={configurable:En in n?n[En]:r[En],enumerable:gn in n?n[gn]:r[gn],writable:!1})}return mn(e,t,n)}:mn:function(e,t,n){if(pn(e),t=hn(t),pn(n),un)try{return mn(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new fn("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var _n=nn,bn=V,Tn=k?function(e,t,n){return _n.f(e,t,bn(1,n))}:function(e,t,n){return e[t]=n,e},Sn=m,On=_,Rn=w,Cn=A,wn=N.f,In=Zt,An=ne,Nn=tn,kn=Tn,Pn=rt,Dn=function(e){var t=function(n,r,o){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(n);case 2:return new e(n,r)}return new e(n,r,o)}return On(e,this,arguments)};return t.prototype=e.prototype,t},Mn=function(e,t){var n,r,o,i,a,s,c,l,u,d=e.target,p=e.global,h=e.stat,f=e.proto,m=p?Sn:h?Sn[d]:Sn[d]&&Sn[d].prototype,v=p?An:An[d]||kn(An,d,{})[d],g=v.prototype;for(i in t)r=!(n=In(p?i:d+(h?".":"#")+i,e.forced))&&m&&Pn(m,i),s=v[i],r&&(c=e.dontCallGetSet?(u=wn(m,i))&&u.value:m[i]),a=r&&c?c:t[i],(n||f||typeof s!=typeof a)&&(l=e.bind&&r?Nn(a,Sn):e.wrap&&r?Dn(a):f&&Cn(a)?Rn(a):a,(e.sham||a&&a.sham||s&&s.sham)&&kn(l,"sham",!0),kn(v,i,l),f&&(Pn(An,o=d+"Prototype")||kn(An,o,{}),kn(An[o],i,a),e.real&&g&&(n||!g[i])&&kn(g,i,a)))},Ln=Math.ceil,xn=Math.floor,Un=Math.trunc||function(e){var t=+e;return(t>0?xn:Ln)(t)},jn=Un,Fn=function(e){var t=+e;return t!=t||0===t?0:jn(t)},Bn=Fn,Vn=Math.max,Hn=Math.min,Gn=function(e,t){var n=Bn(e);return n<0?Vn(n+t,0):Hn(n,t)},Wn=Fn,qn=Math.min,Kn=function(e){var t=Wn(e);return t>0?qn(t,9007199254740991):0},Yn=Kn,zn=function(e){return Yn(e.length)},Xn=$,Jn=Gn,Zn=zn,Qn=function(e){return function(t,n,r){var o=Xn(t),i=Zn(o);if(0===i)return!e&&-1;var a,s=Jn(r,i);if(e&&n!=n){for(;i>s;)if((a=o[s++])!=a)return!0}else for(;i>s;s++)if((e||s in o)&&o[s]===n)return e||s||0;return!e&&-1}},$n={includes:Qn(!0),indexOf:Qn(!1)},er=$n.includes;Mn({target:"Array",proto:!0,forced:a((function(){return!Array(1).includes()}))},{includes:function(e){return er(this,e,arguments.length>1?arguments[1]:void 0)}});var tr=m,nr=ne,rr=function(e,t){var n=nr[e+"Prototype"],r=n&&n[t];if(r)return r;var o=tr[e],i=o&&o.prototype;return i&&i[t]},or=rr("Array","includes"),ir=te,ar=O,sr=gt("match"),cr=function(e){var t;return ir(e)&&(void 0!==(t=e[sr])?!!t:"RegExp"===ar(e))},lr=cr,ur=TypeError,dr={};dr[gt("toStringTag")]="z";var pr="[object z]"===String(dr),hr=pr,fr=A,mr=O,vr=gt("toStringTag"),gr=Object,Er="Arguments"===mr(function(){return arguments}()),yr=hr?mr:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=gr(e),vr))?n:Er?mr(t):"Object"===(r=mr(t))&&fr(t.callee)?"Arguments":r},_r=yr,br=String,Tr=function(e){if("Symbol"===_r(e))throw new TypeError("Cannot convert a Symbol value to a string");return br(e)},Sr=gt("match"),Or=Mn,Rr=function(e){if(lr(e))throw new ur("The method doesn't accept regular expressions");return e},Cr=J,wr=Tr,Ir=function(e){var t=/./;try{"/./"[e](t)}catch(i){try{return t[Sr]=!1,"/./"[e](t)}catch(e){}}return!1},Ar=p("".indexOf);Or({target:"String",proto:!0,forced:!Ir("includes")},{includes:function(e){return!!~Ar(wr(Cr(this)),wr(Rr(e)),arguments.length>1?arguments[1]:void 0)}});var Nr=rr("String","includes"),kr=h,Pr=or,Dr=Nr,Mr=Array.prototype,Lr=String.prototype,xr=function(e){var t=e.includes;return e===Mr||kr(Mr,e)&&t===Mr.includes?Pr:"string"==typeof e||e===Lr||kr(Lr,e)&&t===Lr.includes?Dr:t},Ur=i(xr),jr=De,Fr=et,Br=K,Vr=zn,Hr=TypeError,Gr="Reduce of empty array with no initial value",Wr=function(e){return function(t,n,r,o){var i=Fr(t),a=Br(i),s=Vr(i);if(jr(n),0===s&&r<2)throw new Hr(Gr);var c=e?s-1:0,l=e?-1:1;if(r<2)for(;;){if(c in a){o=a[c],c+=l;break}if(c+=l,e?c<0:s<=c)throw new Hr(Gr)}for(;e?c>=0:s>c;c+=l)c in a&&(o=n(o,a[c],c,i));return o}},qr={left:Wr(!1),right:Wr(!0)},Kr=a,Yr=function(e,t){var n=[][e];return!!n&&Kr((function(){n.call(null,t||function(){return 1},1)}))},zr=m,Xr=ue,Jr=O,Zr=function(e){return Xr.slice(0,e.length)===e},Qr=Zr("Bun/")?"BUN":Zr("Cloudflare-Workers")?"CLOUDFLARE":Zr("Deno/")?"DENO":Zr("Node.js/")?"NODE":zr.Bun&&"string"==typeof Bun.version?"BUN":zr.Deno&&"object"==typeof Deno.version?"DENO":"process"===Jr(zr.process)?"NODE":zr.window&&zr.document?"BROWSER":"REST",$r="NODE"===Qr,eo=qr.left;Mn({target:"Array",proto:!0,forced:!$r&&ge>79&&ge<83||!Yr("reduce")},{reduce:function(e){var t=arguments.length;return eo(this,e,t,t>1?arguments[1]:void 0)}});var to=rr("Array","reduce"),no=h,ro=to,oo=Array.prototype,io=function(e){var t=e.reduce;return e===oo||no(oo,e)&&t===oo.reduce?ro:t},ao=io,so=i(ao),co=O,lo=Array.isArray||function(e){return"Array"===co(e)},uo=Mn,po=lo,ho=p([].reverse),fo=[1,2];uo({target:"Array",proto:!0,forced:String(fo)===String(fo.reverse())},{reverse:function(){return po(this)&&(this.length=this.length),ho(this)}});var mo=rr("Array","reverse"),vo=h,go=mo,Eo=Array.prototype,yo=function(e){var t=e.reverse;return e===Eo||vo(Eo,e)&&t===Eo.reverse?go:t},_o=yo,bo=i(_o),To=ct,So=Ze("keys"),Oo=function(e){return So[e]||(So[e]=To(e))},Ro=!a((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Co=rt,wo=A,Io=et,Ao=Ro,No=Oo("IE_PROTO"),ko=Object,Po=ko.prototype,Do=Ao?ko.getPrototypeOf:function(e){var t=Io(e);if(Co(t,No))return t[No];var n=t.constructor;return wo(n)&&t instanceof n?n.prototype:t instanceof ko?Po:null},Mo=p,Lo=De,xo=te,Uo=function(e){return xo(e)||null===e},jo=String,Fo=TypeError,Bo=function(e,t,n){try{return Mo(Lo(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}},Vo=te,Ho=J,Go=function(e){if(Uo(e))return e;throw new Fo("Can't set "+jo(e)+" as a prototype")},Wo=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Bo(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return Ho(n),Go(r),Vo(n)?(t?e(n,r):n.__proto__=r,n):n}}():void 0),qo={},Ko={},Yo=rt,zo=$,Xo=$n.indexOf,Jo=Ko,Zo=p([].push),Qo=function(e,t){var n,r=zo(e),o=0,i=[];for(n in r)!Yo(Jo,n)&&Yo(r,n)&&Zo(i,n);for(;t.length>o;)Yo(r,n=t[o++])&&(~Xo(i,n)||Zo(i,n));return i},$o=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ei=Qo,ti=$o.concat("length","prototype");qo.f=Object.getOwnPropertyNames||function(e){return ei(e,ti)};var ni={};ni.f=Object.getOwnPropertySymbols;var ri=se,oi=qo,ii=ni,ai=cn,si=p([].concat),ci=ri("Reflect","ownKeys")||function(e){var t=oi.f(ai(e)),n=ii.f;return n?si(t,n(e)):t},li=rt,ui=ci,di=N,pi=nn,hi={},fi=Qo,mi=$o,vi=Object.keys||function(e){return fi(e,mi)},gi=k,Ei=rn,yi=nn,_i=cn,bi=$,Ti=vi;hi.f=gi&&!Ei?Object.defineProperties:function(e,t){_i(e);for(var n,r=bi(t),o=Ti(t),i=o.length,a=0;i>a;)yi.f(e,n=o[a++],r[n]);return e};var Si,Oi=se("document","documentElement"),Ri=cn,Ci=hi,wi=$o,Ii=Ko,Ai=Oi,Ni=kt,ki="prototype",Pi="script",Di=Oo("IE_PROTO"),Mi=function(){},Li=function(e){return"<"+Pi+">"+e+"</"+Pi+">"},xi=function(e){e.write(Li("")),e.close();var t=e.parentWindow.Object;return e=null,t},Ui=function(){try{Si=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;Ui="undefined"!=typeof document?document.domain&&Si?xi(Si):(t=Ni("iframe"),n="java"+Pi+":",t.style.display="none",Ai.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(Li("document.F=Object")),e.close(),e.F):xi(Si);for(var r=wi.length;r--;)delete Ui[ki][wi[r]];return Ui()};Ii[Di]=!0;var ji=Object.create||function(e,t){var n;return null!==e?(Mi[ki]=Ri(e),n=new Mi,Mi[ki]=null,n[Di]=e):n=Ui(),void 0===t?n:Ci.f(n,t)},Fi=te,Bi=Tn,Vi=Error,Hi=p("".replace),Gi=String(new Vi("zxcasd").stack),Wi=/\n\s*at [^:]*:[^\n]*/,qi=Wi.test(Gi),Ki=V,Yi=!a((function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Ki(1,7)),7!==e.stack)})),zi=Tn,Xi=function(e,t){if(qi&&"string"==typeof e&&!Vi.prepareStackTrace)for(;t--;)e=Hi(e,Wi,"");return e},Ji=Yi,Zi=Error.captureStackTrace,Qi={},$i=Qi,ea=gt("iterator"),ta=Array.prototype,na=function(e){return void 0!==e&&($i.Array===e||ta[ea]===e)},ra=yr,oa=xe,ia=Y,aa=Qi,sa=gt("iterator"),ca=function(e){if(!ia(e))return oa(e,sa)||oa(e,"@@iterator")||aa[ra(e)]},la=M,ua=De,da=cn,pa=Ae,ha=ca,fa=TypeError,ma=function(e,t){var n=arguments.length<2?ha(e):t;if(ua(n))return da(la(n,e));throw new fa(pa(e)+" is not iterable")},va=M,ga=cn,Ea=xe,ya=function(e,t,n){var r,o;ga(e);try{if(!(r=Ea(e,"return"))){if("throw"===t)throw n;return n}r=va(r,e)}catch(e){o=!0,r=e}if("throw"===t)throw n;if(o)throw r;return ga(r),n},_a=tn,ba=M,Ta=cn,Sa=Ae,Oa=na,Ra=zn,Ca=h,wa=ma,Ia=ca,Aa=ya,Na=TypeError,ka=function(e,t){this.stopped=e,this.result=t},Pa=ka.prototype,Da=function(e,t,n){var r,o,i,a,s,c,l,u=n&&n.that,d=!(!n||!n.AS_ENTRIES),p=!(!n||!n.IS_RECORD),h=!(!n||!n.IS_ITERATOR),f=!(!n||!n.INTERRUPTED),m=_a(t,u),v=function(e){return r&&Aa(r,"normal",e),new ka(!0,e)},g=function(e){return d?(Ta(e),f?m(e[0],e[1],v):m(e[0],e[1])):f?m(e,v):m(e)};if(p)r=e.iterator;else if(h)r=e;else{if(!(o=Ia(e)))throw new Na(Sa(e)+" is not iterable");if(Oa(o)){for(i=0,a=Ra(e);a>i;i++)if((s=g(e[i]))&&Ca(Pa,s))return s;return new ka(!1)}r=wa(e,o)}for(c=p?e.next:r.next;!(l=ba(c,r)).done;){try{s=g(l.value)}catch(e){Aa(r,"throw",e)}if("object"==typeof s&&s&&Ca(Pa,s))return s}return new ka(!1)},Ma=Tr,La=Mn,xa=h,Ua=Do,ja=Wo,Fa=function(e,t,n){for(var r=ui(t),o=pi.f,i=di.f,a=0;a<r.length;a++){var s=r[a];li(e,s)||n&&li(n,s)||o(e,s,i(t,s))}},Ba=ji,Va=Tn,Ha=V,Ga=function(e,t){Fi(t)&&"cause"in t&&Bi(e,"cause",t.cause)},Wa=function(e,t,n,r){Ji&&(Zi?Zi(e,t):zi(e,"stack",Xi(n,r)))},qa=Da,Ka=function(e,t){return void 0===e?arguments.length<2?"":t:Ma(e)},Ya=gt("toStringTag"),za=Error,Xa=[].push,Ja=function(e,t){var n,r=xa(Za,this);ja?n=ja(new za,r?Ua(this):Za):(n=r?this:Ba(Za),Va(n,Ya,"Error")),void 0!==t&&Va(n,"message",Ka(t)),Wa(n,Ja,n.stack,1),arguments.length>2&&Ga(n,arguments[2]);var o=[];return qa(e,Xa,{that:o}),Va(n,"errors",o),n};ja?ja(Ja,za):Fa(Ja,za,{name:!0});var Za=Ja.prototype=Ba(za.prototype,{constructor:Ha(1,Ja),message:Ha(1,""),name:Ha(1,"AggregateError")});La({global:!0,constructor:!0,arity:2},{AggregateError:Ja});var Qa,$a,es,ts=A,ns=m.WeakMap,rs=ts(ns)&&/native code/.test(String(ns)),os=m,is=te,as=Tn,ss=rt,cs=Xe,ls=Oo,us=Ko,ds="Object already initialized",ps=os.TypeError,hs=os.WeakMap;if(rs||cs.state){var fs=cs.state||(cs.state=new hs);fs.get=fs.get,fs.has=fs.has,fs.set=fs.set,Qa=function(e,t){if(fs.has(e))throw new ps(ds);return t.facade=e,fs.set(e,t),t},$a=function(e){return fs.get(e)||{}},es=function(e){return fs.has(e)}}else{var ms=ls("state");us[ms]=!0,Qa=function(e,t){if(ss(e,ms))throw new ps(ds);return t.facade=e,as(e,ms,t),t},$a=function(e){return ss(e,ms)?e[ms]:{}},es=function(e){return ss(e,ms)}}var vs,gs,Es,ys={set:Qa,get:$a,has:es,enforce:function(e){return es(e)?$a(e):Qa(e,{})},getterFor:function(e){return function(t){var n;if(!is(t)||(n=$a(t)).type!==e)throw new ps("Incompatible receiver, "+e+" required");return n}}},_s=k,bs=rt,Ts=Function.prototype,Ss=_s&&Object.getOwnPropertyDescriptor,Os=bs(Ts,"name"),Rs={EXISTS:Os,PROPER:Os&&"something"===function(){}.name,CONFIGURABLE:Os&&(!_s||_s&&Ss(Ts,"name").configurable)},Cs=Tn,ws=function(e,t,n,r){return r&&r.enumerable?e[t]=n:Cs(e,t,n),e},Is=a,As=A,Ns=te,ks=ji,Ps=Do,Ds=ws,Ms=gt("iterator"),Ls=!1;[].keys&&("next"in(Es=[].keys())?(gs=Ps(Ps(Es)))!==Object.prototype&&(vs=gs):Ls=!0);var xs=!Ns(vs)||Is((function(){var e={};return vs[Ms].call(e)!==e}));As((vs=xs?{}:ks(vs))[Ms])||Ds(vs,Ms,(function(){return this}));var Us={IteratorPrototype:vs,BUGGY_SAFARI_ITERATORS:Ls},js=yr,Fs=pr?{}.toString:function(){return"[object "+js(this)+"]"},Bs=pr,Vs=nn.f,Hs=Tn,Gs=rt,Ws=Fs,qs=gt("toStringTag"),Ks=function(e,t,n,r){var o=n?e:e&&e.prototype;o&&(Gs(o,qs)||Vs(o,qs,{configurable:!0,value:t}),r&&!Bs&&Hs(o,"toString",Ws))},Ys=Us.IteratorPrototype,zs=ji,Xs=V,Js=Ks,Zs=Qi,Qs=function(){return this},$s=function(e,t,n,r){var o=t+" Iterator";return e.prototype=zs(Ys,{next:Xs(+!r,n)}),Js(e,o,!1,!0),Zs[o]=Qs,e},ec=Mn,tc=M,nc=$s,rc=Do,oc=Ks,ic=ws,ac=Qi,sc=Us,cc=Rs.PROPER,lc=sc.BUGGY_SAFARI_ITERATORS,uc=gt("iterator"),dc="keys",pc="values",hc="entries",fc=function(){return this},mc=function(e,t,n,r,o,i,a){nc(n,t,r);var s,c,l,u=function(e){if(e===o&&m)return m;if(!lc&&e&&e in h)return h[e];switch(e){case dc:case pc:case hc:return function(){return new n(this,e)}}return function(){return new n(this)}},d=t+" Iterator",p=!1,h=e.prototype,f=h[uc]||h["@@iterator"]||o&&h[o],m=!lc&&f||u(o),v="Array"===t&&h.entries||f;if(v&&(s=rc(v.call(new e)))!==Object.prototype&&s.next&&(oc(s,d,!0,!0),ac[d]=fc),cc&&o===pc&&f&&f.name!==pc&&(p=!0,m=function(){return tc(f,this)}),o)if(c={values:u(pc),keys:i?m:u(dc),entries:u(hc)},a)for(l in c)(lc||p||!(l in h))&&ic(h,l,c[l]);else ec({target:t,proto:!0,forced:lc||p},c);return a&&h[uc]!==m&&ic(h,uc,m,{name:o}),ac[t]=m,c},vc=function(e,t){return{value:e,done:t}},gc=$,Ec=Qi,yc=ys;nn.f;var _c=mc,bc=vc,Tc="Array Iterator",Sc=yc.set,Oc=yc.getterFor(Tc);_c(Array,"Array",(function(e,t){Sc(this,{type:Tc,target:gc(e),index:0,kind:t})}),(function(){var e=Oc(this),t=e.target,n=e.index++;if(!t||n>=t.length)return e.target=null,bc(void 0,!0);switch(e.kind){case"keys":return bc(n,!1);case"values":return bc(t[n],!1)}return bc([n,t[n]],!1)}),"values"),Ec.Arguments=Ec.Array;var Rc=nn,Cc=function(e,t,n){return Rc.f(e,t,n)},wc=se,Ic=Cc,Ac=k,Nc=gt("species"),kc=h,Pc=TypeError,Dc=function(e,t){if(kc(t,e))return e;throw new Pc("Incorrect invocation")},Mc=A,Lc=Xe,xc=p(Function.toString);Mc(Lc.inspectSource)||(Lc.inspectSource=function(e){return xc(e)});var Uc=Lc.inspectSource,jc=p,Fc=a,Bc=A,Vc=yr,Hc=Uc,Gc=function(){},Wc=se("Reflect","construct"),qc=/^\s*(?:class|function)\b/,Kc=jc(qc.exec),Yc=!qc.test(Gc),zc=function(e){if(!Bc(e))return!1;try{return Wc(Gc,[],e),!0}catch(e){return!1}},Xc=function(e){if(!Bc(e))return!1;switch(Vc(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Yc||!!Kc(qc,Hc(e))}catch(e){return!0}};Xc.sham=!0;var Jc,Zc,Qc,$c,el=!Wc||Fc((function(){var e;return zc(zc.call)||!zc(Object)||!zc((function(){e=!0}))||e}))?Xc:zc,tl=el,nl=Ae,rl=TypeError,ol=cn,il=function(e){if(tl(e))return e;throw new rl(nl(e)+" is not a constructor")},al=Y,sl=gt("species"),cl=function(e,t){var n,r=ol(e).constructor;return void 0===r||al(n=ol(r)[sl])?t:il(n)},ll=p([].slice),ul=TypeError,dl=function(e,t){if(e<t)throw new ul("Not enough arguments");return e},pl=/(?:ipad|iphone|ipod).*applewebkit/i.test(ue),hl=m,fl=_,ml=tn,vl=A,gl=rt,El=a,yl=Oi,_l=ll,bl=kt,Tl=dl,Sl=pl,Ol=$r,Rl=hl.setImmediate,Cl=hl.clearImmediate,wl=hl.process,Il=hl.Dispatch,Al=hl.Function,Nl=hl.MessageChannel,kl=hl.String,Pl=0,Dl={},Ml="onreadystatechange";El((function(){Jc=hl.location}));var Ll=function(e){if(gl(Dl,e)){var t=Dl[e];delete Dl[e],t()}},xl=function(e){return function(){Ll(e)}},Ul=function(e){Ll(e.data)},jl=function(e){hl.postMessage(kl(e),Jc.protocol+"//"+Jc.host)};Rl&&Cl||(Rl=function(e){Tl(arguments.length,1);var t=vl(e)?e:Al(e),n=_l(arguments,1);return Dl[++Pl]=function(){fl(t,void 0,n)},Zc(Pl),Pl},Cl=function(e){delete Dl[e]},Ol?Zc=function(e){wl.nextTick(xl(e))}:Il&&Il.now?Zc=function(e){Il.now(xl(e))}:Nl&&!Sl?($c=(Qc=new Nl).port2,Qc.port1.onmessage=Ul,Zc=ml($c.postMessage,$c)):hl.addEventListener&&vl(hl.postMessage)&&!hl.importScripts&&Jc&&"file:"!==Jc.protocol&&!El(jl)?(Zc=jl,hl.addEventListener("message",Ul,!1)):Zc=Ml in bl("script")?function(e){yl.appendChild(bl("script"))[Ml]=function(){yl.removeChild(this),Ll(e)}}:function(e){setTimeout(xl(e),0)});var Fl={set:Rl,clear:Cl},Bl=m,Vl=k,Hl=Object.getOwnPropertyDescriptor,Gl=function(e){if(!Vl)return Bl[e];var t=Hl(Bl,e);return t&&t.value},Wl=function(){this.head=null,this.tail=null};Wl.prototype={add:function(e){var t={item:e,next:null},n=this.tail;n?n.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}};var ql,Kl,Yl,zl,Xl,Jl=Wl,Zl=/ipad|iphone|ipod/i.test(ue)&&"undefined"!=typeof Pebble,Ql=/web0s(?!.*chrome)/i.test(ue),$l=m,eu=Gl,tu=tn,nu=Fl.set,ru=Jl,ou=pl,iu=Zl,au=Ql,su=$r,cu=$l.MutationObserver||$l.WebKitMutationObserver,lu=$l.document,uu=$l.process,du=$l.Promise,pu=eu("queueMicrotask");if(!pu){var hu=new ru,fu=function(){var e,t;for(su&&(e=uu.domain)&&e.exit();t=hu.get();)try{t()}catch(e){throw hu.head&&ql(),e}e&&e.enter()};ou||su||au||!cu||!lu?!iu&&du&&du.resolve?((zl=du.resolve(void 0)).constructor=du,Xl=tu(zl.then,zl),ql=function(){Xl(fu)}):su?ql=function(){uu.nextTick(fu)}:(nu=tu(nu,$l),ql=function(){nu(fu)}):(Kl=!0,Yl=lu.createTextNode(""),new cu(fu).observe(Yl,{characterData:!0}),ql=function(){Yl.data=Kl=!Kl}),pu=function(e){hu.head||ql(),hu.add(e)}}var mu=pu,vu=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},gu=m.Promise,Eu=m,yu=gu,_u=A,bu=Zt,Tu=Uc,Su=gt,Ou=Qr,Ru=ge,Cu=yu&&yu.prototype,wu=Su("species"),Iu=!1,Au=_u(Eu.PromiseRejectionEvent),Nu=bu("Promise",(function(){var e=Tu(yu),t=e!==String(yu);if(!t&&66===Ru)return!0;if(!Cu.catch||!Cu.finally)return!0;if(!Ru||Ru<51||!/native code/.test(e)){var n=new yu((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};if((n.constructor={})[wu]=r,!(Iu=n.then((function(){}))instanceof r))return!0}return!(t||"BROWSER"!==Ou&&"DENO"!==Ou||Au)})),ku={CONSTRUCTOR:Nu,REJECTION_EVENT:Au,SUBCLASSING:Iu},Pu={},Du=De,Mu=TypeError,Lu=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw new Mu("Bad Promise constructor");t=e,n=r})),this.resolve=Du(t),this.reject=Du(n)};Pu.f=function(e){return new Lu(e)};var xu,Uu,ju=Mn,Fu=$r,Bu=m,Vu=M,Hu=ws,Gu=Ks,Wu=function(e){var t=wc(e);Ac&&t&&!t[Nc]&&Ic(t,Nc,{configurable:!0,get:function(){return this}})},qu=De,Ku=A,Yu=te,zu=Dc,Xu=cl,Ju=Fl.set,Zu=mu,Qu=function(e,t){try{1===arguments.length?console.error(e):console.error(e,t)}catch(e){}},$u=vu,ed=Jl,td=ys,nd=gu,rd=ku,od=Pu,id="Promise",ad=rd.CONSTRUCTOR,sd=rd.REJECTION_EVENT,cd=td.getterFor(id),ld=td.set,ud=nd&&nd.prototype,dd=nd,pd=ud,hd=Bu.TypeError,fd=Bu.document,md=Bu.process,vd=od.f,gd=vd,Ed=!!(fd&&fd.createEvent&&Bu.dispatchEvent),yd="unhandledrejection",_d=function(e){var t;return!(!Yu(e)||!Ku(t=e.then))&&t},bd=function(e,t){var n,r,o,i=t.value,a=1===t.state,s=a?e.ok:e.fail,c=e.resolve,l=e.reject,u=e.domain;try{s?(a||(2===t.rejection&&Cd(t),t.rejection=1),!0===s?n=i:(u&&u.enter(),n=s(i),u&&(u.exit(),o=!0)),n===e.promise?l(new hd("Promise-chain cycle")):(r=_d(n))?Vu(r,n,c,l):c(n)):l(i)}catch(e){u&&!o&&u.exit(),l(e)}},Td=function(e,t){e.notified||(e.notified=!0,Zu((function(){for(var n,r=e.reactions;n=r.get();)bd(n,e);e.notified=!1,t&&!e.rejection&&Od(e)})))},Sd=function(e,t,n){var r,o;Ed?((r=fd.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),Bu.dispatchEvent(r)):r={promise:t,reason:n},!sd&&(o=Bu["on"+e])?o(r):e===yd&&Qu("Unhandled promise rejection",n)},Od=function(e){Vu(Ju,Bu,(function(){var t,n=e.facade,r=e.value;if(Rd(e)&&(t=$u((function(){Fu?md.emit("unhandledRejection",r,n):Sd(yd,n,r)})),e.rejection=Fu||Rd(e)?2:1,t.error))throw t.value}))},Rd=function(e){return 1!==e.rejection&&!e.parent},Cd=function(e){Vu(Ju,Bu,(function(){var t=e.facade;Fu?md.emit("rejectionHandled",t):Sd("rejectionhandled",t,e.value)}))},wd=function(e,t,n){return function(r){e(t,r,n)}},Id=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Td(e,!0))},Ad=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw new hd("Promise can't be resolved itself");var r=_d(t);r?Zu((function(){var n={done:!1};try{Vu(r,t,wd(Ad,n,e),wd(Id,n,e))}catch(t){Id(n,t,e)}})):(e.value=t,e.state=1,Td(e,!1))}catch(t){Id({done:!1},t,e)}}};ad&&(pd=(dd=function(e){zu(this,pd),qu(e),Vu(xu,this);var t=cd(this);try{e(wd(Ad,t),wd(Id,t))}catch(e){Id(t,e)}}).prototype,(xu=function(e){ld(this,{type:id,done:!1,notified:!1,parent:!1,reactions:new ed,rejection:!1,state:0,value:null})}).prototype=Hu(pd,"then",(function(e,t){var n=cd(this),r=vd(Xu(this,dd));return n.parent=!0,r.ok=!Ku(e)||e,r.fail=Ku(t)&&t,r.domain=Fu?md.domain:void 0,0===n.state?n.reactions.add(r):Zu((function(){bd(r,n)})),r.promise})),Uu=function(){var e=new xu,t=cd(e);this.promise=e,this.resolve=wd(Ad,t),this.reject=wd(Id,t)},od.f=vd=function(e){return e===dd||void 0===e?new Uu(e):gd(e)}),ju({global:!0,constructor:!0,wrap:!0,forced:ad},{Promise:dd}),Gu(dd,id,!1,!0),Wu(id);var Nd=gt("iterator"),kd=!1;try{var Pd=0,Dd={next:function(){return{done:!!Pd++}},return:function(){kd=!0}};Dd[Nd]=function(){return this},Array.from(Dd,(function(){throw 2}))}catch(e){}var Md=gu,Ld=function(e,t){try{if(!t&&!kd)return!1}catch(e){return!1}var n=!1;try{var r={};r[Nd]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},xd=ku.CONSTRUCTOR||!Ld((function(e){Md.all(e).then(void 0,(function(){}))})),Ud=M,jd=De,Fd=Pu,Bd=vu,Vd=Da;Mn({target:"Promise",stat:!0,forced:xd},{all:function(e){var t=this,n=Fd.f(t),r=n.resolve,o=n.reject,i=Bd((function(){var n=jd(t.resolve),i=[],a=0,s=1;Vd(e,(function(e){var c=a++,l=!1;s++,Ud(n,t,e).then((function(e){l||(l=!0,i[c]=e,--s||r(i))}),o)})),--s||r(i)}));return i.error&&o(i.value),n.promise}});var Hd=Mn,Gd=ku.CONSTRUCTOR;gu&&gu.prototype,Hd({target:"Promise",proto:!0,forced:Gd,real:!0},{catch:function(e){return this.then(void 0,e)}});var Wd=M,qd=De,Kd=Pu,Yd=vu,zd=Da;Mn({target:"Promise",stat:!0,forced:xd},{race:function(e){var t=this,n=Kd.f(t),r=n.reject,o=Yd((function(){var o=qd(t.resolve);zd(e,(function(e){Wd(o,t,e).then(n.resolve,r)}))}));return o.error&&r(o.value),n.promise}});var Xd=Pu;Mn({target:"Promise",stat:!0,forced:ku.CONSTRUCTOR},{reject:function(e){var t=Xd.f(this);return(0,t.reject)(e),t.promise}});var Jd=cn,Zd=te,Qd=Pu,$d=function(e,t){if(Jd(e),Zd(t)&&t.constructor===e)return t;var n=Qd.f(e);return(0,n.resolve)(t),n.promise},ep=Mn,tp=gu,np=ku.CONSTRUCTOR,rp=$d,op=se("Promise"),ip=!np;ep({target:"Promise",stat:!0,forced:!0},{resolve:function(e){return rp(ip&&this===op?tp:this,e)}});var ap=M,sp=De,cp=Pu,lp=vu,up=Da;Mn({target:"Promise",stat:!0,forced:xd},{allSettled:function(e){var t=this,n=cp.f(t),r=n.resolve,o=n.reject,i=lp((function(){var n=sp(t.resolve),o=[],i=0,a=1;up(e,(function(e){var s=i++,c=!1;a++,ap(n,t,e).then((function(e){c||(c=!0,o[s]={status:"fulfilled",value:e},--a||r(o))}),(function(e){c||(c=!0,o[s]={status:"rejected",reason:e},--a||r(o))}))})),--a||r(o)}));return i.error&&o(i.value),n.promise}});var dp=M,pp=De,hp=se,fp=Pu,mp=vu,vp=Da,gp="No one promise resolved";Mn({target:"Promise",stat:!0,forced:xd},{any:function(e){var t=this,n=hp("AggregateError"),r=fp.f(t),o=r.resolve,i=r.reject,a=mp((function(){var r=pp(t.resolve),a=[],s=0,c=1,l=!1;vp(e,(function(e){var u=s++,d=!1;c++,dp(r,t,e).then((function(e){d||l||(l=!0,o(e))}),(function(e){d||l||(d=!0,a[u]=e,--c||i(new n(a,gp)))}))})),--c||i(new n(a,gp))}));return a.error&&i(a.value),r.promise}});var Ep=Mn,yp=_,_p=ll,bp=Pu,Tp=De,Sp=vu,Op=m.Promise,Rp=!1;Ep({target:"Promise",stat:!0,forced:!Op||!Op.try||Sp((function(){Op.try((function(e){Rp=8===e}),8)})).error||!Rp},{try:function(e){var t=arguments.length>1?_p(arguments,1):[],n=bp.f(this),r=Sp((function(){return yp(Tp(e),void 0,t)}));return(r.error?n.reject:n.resolve)(r.value),n.promise}});var Cp=Pu;Mn({target:"Promise",stat:!0},{withResolvers:function(){var e=Cp.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var wp=Mn,Ip=gu,Ap=a,Np=se,kp=A,Pp=cl,Dp=$d,Mp=Ip&&Ip.prototype;wp({target:"Promise",proto:!0,real:!0,forced:!!Ip&&Ap((function(){Mp.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=Pp(this,Np("Promise")),n=kp(e);return this.then(n?function(n){return Dp(t,e()).then((function(){return n}))}:e,n?function(n){return Dp(t,e()).then((function(){throw n}))}:e)}});var Lp=p,xp=Fn,Up=Tr,jp=J,Fp=Lp("".charAt),Bp=Lp("".charCodeAt),Vp=Lp("".slice),Hp=function(e){return function(t,n){var r,o,i=Up(jp(t)),a=xp(n),s=i.length;return a<0||a>=s?e?"":void 0:(r=Bp(i,a))<55296||r>56319||a+1===s||(o=Bp(i,a+1))<56320||o>57343?e?Fp(i,a):r:e?Vp(i,a,a+2):o-56320+(r-55296<<10)+65536}},Gp={codeAt:Hp(!1),charAt:Hp(!0)},Wp=Gp.charAt,qp=Tr,Kp=ys,Yp=mc,zp=vc,Xp="String Iterator",Jp=Kp.set,Zp=Kp.getterFor(Xp);Yp(String,"String",(function(e){Jp(this,{type:Xp,string:qp(e),index:0})}),(function(){var e,t=Zp(this),n=t.string,r=t.index;return r>=n.length?zp(void 0,!0):(e=Wp(n,r),t.index+=e.length,zp(e,!1))}));var Qp=ne.Promise,$p={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},eh=m,th=Ks,nh=Qi;for(var rh in $p)th(eh[rh],rh),nh[rh]=nh.Array;var oh=Qp,ih=i(oh),ah=rr("Array","values"),sh=yr,ch=rt,lh=h,uh=ah,dh=Array.prototype,ph={DOMTokenList:!0,NodeList:!0},hh=function(e){var t=e.values;return e===dh||lh(dh,e)&&t===dh.values||ch(ph,sh(e))?uh:t},fh=i(hh),mh=Mn,vh=p,gh=Gn,Eh=RangeError,yh=String.fromCharCode,_h=String.fromCodePoint,bh=vh([].join);mh({target:"String",stat:!0,arity:1,forced:!!_h&&1!==_h.length},{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,o=0;r>o;){if(t=+arguments[o++],gh(t,1114111)!==t)throw new Eh(t+" is not a valid code point");n[o]=t<65536?yh(t):yh(55296+((t-=65536)>>10),t%1024+56320)}return bh(n,"")}});var Th=a,Sh=He,Oh=gt("iterator"),Rh=!Th((function(){var e=new URL("b?a=1&b=2&c=3","https://a"),t=e.searchParams,n=new URLSearchParams("a=1&a=2&b=3"),r="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),r+=n+e})),n.delete("a",2),n.delete("b",void 0),!e.toJSON||!n.has("a",1)||n.has("a",2)||!n.has("a",void 0)||n.has("b")||!t.size&&Sh||!t.sort||"https://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[Oh]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("https://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("https://a#\u0431").hash||"a1c3"!==r||"x"!==new URL("https://x",void 0).host})),Ch=ws,wh=ll,Ih=Math.floor,Ah=function(e,t){var n=e.length;if(n<8)for(var r,o,i=1;i<n;){for(o=i,r=e[i];o&&t(e[o-1],r)>0;)e[o]=e[--o];o!==i++&&(e[o]=r)}else for(var a=Ih(n/2),s=Ah(wh(e,0,a),t),c=Ah(wh(e,a),t),l=s.length,u=c.length,d=0,p=0;d<l||p<u;)e[d+p]=d<l&&p<u?t(s[d],c[p])<=0?s[d++]:c[p++]:d<l?s[d++]:c[p++];return e},Nh=Ah,kh=Mn,Ph=m,Dh=Gl,Mh=se,Lh=M,xh=p,Uh=k,jh=Rh,Fh=ws,Bh=Cc,Vh=function(e,t,n){for(var r in t)n&&n.unsafe&&e[r]?e[r]=t[r]:Ch(e,r,t[r],n);return e},Hh=Ks,Gh=$s,Wh=ys,qh=Dc,Kh=A,Yh=rt,zh=tn,Xh=yr,Jh=cn,Zh=te,Qh=Tr,$h=ji,ef=V,tf=ma,nf=ca,rf=vc,of=dl,af=Nh,sf=gt("iterator"),cf="URLSearchParams",lf=cf+"Iterator",uf=Wh.set,df=Wh.getterFor(cf),pf=Wh.getterFor(lf),hf=Dh("fetch"),ff=Dh("Request"),mf=Dh("Headers"),vf=ff&&ff.prototype,gf=mf&&mf.prototype,Ef=Ph.TypeError,yf=Ph.encodeURIComponent,_f=String.fromCharCode,bf=Mh("String","fromCodePoint"),Tf=parseInt,Sf=xh("".charAt),Of=xh([].join),Rf=xh([].push),Cf=xh("".replace),wf=xh([].shift),If=xh([].splice),Af=xh("".split),Nf=xh("".slice),kf=xh(/./.exec),Pf=/\+/g,Df=/^[0-9a-f]+$/i,Mf=function(e,t){var n=Nf(e,t,t+2);return kf(Df,n)?Tf(n,16):NaN},Lf=function(e){for(var t=0,n=128;n>0&&e&n;n>>=1)t++;return t},xf=function(e){var t=null;switch(e.length){case 1:t=e[0];break;case 2:t=(31&e[0])<<6|63&e[1];break;case 3:t=(15&e[0])<<12|(63&e[1])<<6|63&e[2];break;case 4:t=(7&e[0])<<18|(63&e[1])<<12|(63&e[2])<<6|63&e[3]}return t>1114111?null:t},Uf=function(e){for(var t=(e=Cf(e,Pf," ")).length,n="",r=0;r<t;){var o=Sf(e,r);if("%"===o){if("%"===Sf(e,r+1)||r+3>t){n+="%",r++;continue}var i=Mf(e,r+1);if(i!=i){n+=o,r++;continue}r+=2;var a=Lf(i);if(0===a)o=_f(i);else{if(1===a||a>4){n+="\ufffd",r++;continue}for(var s=[i],c=1;c<a&&!(3+ ++r>t||"%"!==Sf(e,r));){var l=Mf(e,r+1);if(l!=l){r+=3;break}if(l>191||l<128)break;Rf(s,l),r+=2,c++}if(s.length!==a){n+="\ufffd";continue}var u=xf(s);null===u?n+="\ufffd":o=bf(u)}}n+=o,r++}return n},jf=/[!'()~]|%20/g,Ff={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Bf=function(e){return Ff[e]},Vf=function(e){return Cf(yf(e),jf,Bf)},Hf=Gh((function(e,t){uf(this,{type:lf,target:df(e).entries,index:0,kind:t})}),cf,(function(){var e=pf(this),t=e.target,n=e.index++;if(!t||n>=t.length)return e.target=null,rf(void 0,!0);var r=t[n];switch(e.kind){case"keys":return rf(r.key,!1);case"values":return rf(r.value,!1)}return rf([r.key,r.value],!1)}),!0),Gf=function(e){this.entries=[],this.url=null,void 0!==e&&(Zh(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===Sf(e,0)?Nf(e,1):e:Qh(e)))};Gf.prototype={type:cf,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,o,i,a,s,c=this.entries,l=nf(e);if(l)for(n=(t=tf(e,l)).next;!(r=Lh(n,t)).done;){if(i=(o=tf(Jh(r.value))).next,(a=Lh(i,o)).done||(s=Lh(i,o)).done||!Lh(i,o).done)throw new Ef("Expected sequence with length 2");Rf(c,{key:Qh(a.value),value:Qh(s.value)})}else for(var u in e)Yh(e,u)&&Rf(c,{key:u,value:Qh(e[u])})},parseQuery:function(e){if(e)for(var t,n,r=this.entries,o=Af(e,"&"),i=0;i<o.length;)(t=o[i++]).length&&(n=Af(t,"="),Rf(r,{key:Uf(wf(n)),value:Uf(Of(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],r=0;r<t.length;)e=t[r++],Rf(n,Vf(e.key)+"="+Vf(e.value));return Of(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Wf=function(){qh(this,qf);var e=uf(this,new Gf(arguments.length>0?arguments[0]:void 0));Uh||(this.size=e.entries.length)},qf=Wf.prototype;if(Vh(qf,{append:function(e,t){var n=df(this);of(arguments.length,2),Rf(n.entries,{key:Qh(e),value:Qh(t)}),Uh||this.length++,n.updateURL()},delete:function(e){for(var t=df(this),n=of(arguments.length,1),r=t.entries,o=Qh(e),i=n<2?void 0:arguments[1],a=void 0===i?i:Qh(i),s=0;s<r.length;){var c=r[s];if(c.key!==o||void 0!==a&&c.value!==a)s++;else if(If(r,s,1),void 0!==a)break}Uh||(this.size=r.length),t.updateURL()},get:function(e){var t=df(this).entries;of(arguments.length,1);for(var n=Qh(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){var t=df(this).entries;of(arguments.length,1);for(var n=Qh(e),r=[],o=0;o<t.length;o++)t[o].key===n&&Rf(r,t[o].value);return r},has:function(e){for(var t=df(this).entries,n=of(arguments.length,1),r=Qh(e),o=n<2?void 0:arguments[1],i=void 0===o?o:Qh(o),a=0;a<t.length;){var s=t[a++];if(s.key===r&&(void 0===i||s.value===i))return!0}return!1},set:function(e,t){var n=df(this);of(arguments.length,1);for(var r,o=n.entries,i=!1,a=Qh(e),s=Qh(t),c=0;c<o.length;c++)(r=o[c]).key===a&&(i?If(o,c--,1):(i=!0,r.value=s));i||Rf(o,{key:a,value:s}),Uh||(this.size=o.length),n.updateURL()},sort:function(){var e=df(this);af(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=df(this).entries,r=zh(e,arguments.length>1?arguments[1]:void 0),o=0;o<n.length;)r((t=n[o++]).value,t.key,this)},keys:function(){return new Hf(this,"keys")},values:function(){return new Hf(this,"values")},entries:function(){return new Hf(this,"entries")}},{enumerable:!0}),Fh(qf,sf,qf.entries,{name:"entries"}),Fh(qf,"toString",(function(){return df(this).serialize()}),{enumerable:!0}),Uh&&Bh(qf,"size",{get:function(){return df(this).entries.length},configurable:!0,enumerable:!0}),Hh(Wf,cf),kh({global:!0,constructor:!0,forced:!jh},{URLSearchParams:Wf}),!jh&&Kh(mf)){var Kf=xh(gf.has),Yf=xh(gf.set),zf=function(e){if(Zh(e)){var t,n=e.body;if(Xh(n)===cf)return t=e.headers?new mf(e.headers):new mf,Kf(t,"content-type")||Yf(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),$h(e,{body:ef(0,Qh(n)),headers:ef(0,t)})}return e};if(Kh(hf)&&kh({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return hf(e,arguments.length>1?zf(arguments[1]):{})}}),Kh(ff)){var Xf=function(e){return qh(this,vf),new ff(e,arguments.length>1?zf(arguments[1]):{})};vf.constructor=Xf,Xf.prototype=vf,kh({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:Xf})}}var Jf,Zf={URLSearchParams:Wf,getState:df},Qf=ne.URLSearchParams,$f=k,em=p,tm=M,nm=a,rm=vi,om=ni,im=L,am=et,sm=K,cm=Object.assign,lm=Object.defineProperty,um=em([].concat),dm=!cm||nm((function(){if($f&&1!==cm({b:1},cm(lm({},"a",{enumerable:!0,get:function(){lm(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol("assign detection"),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!==cm({},e)[n]||rm(cm({},t)).join("")!==r}))?function(e,t){for(var n=am(e),r=arguments.length,o=1,i=om.f,a=im.f;r>o;)for(var s,c=sm(arguments[o++]),l=i?um(rm(c),i(c)):rm(c),u=l.length,d=0;u>d;)s=l[d++],$f&&!tm(a,c,s)||(n[s]=c[s]);return n}:cm,pm=cn,hm=ya,fm=k,mm=nn,vm=V,gm=function(e,t,n){fm?mm.f(e,t,vm(0,n)):e[t]=n},Em=tn,ym=M,_m=et,bm=function(e,t,n,r){try{return r?t(pm(n)[0],n[1]):t(n)}catch(t){hm(e,"throw",t)}},Tm=na,Sm=el,Om=zn,Rm=gm,Cm=ma,wm=ca,Im=Array,Am=p,Nm=2147483647,km=/[^\0-\u007E]/,Pm=/[.\u3002\uFF0E\uFF61]/g,Dm="Overflow: input needs wider integers to process",Mm=RangeError,Lm=Am(Pm.exec),xm=Math.floor,Um=String.fromCharCode,jm=Am("".charCodeAt),Fm=Am([].join),Bm=Am([].push),Vm=Am("".replace),Hm=Am("".split),Gm=Am("".toLowerCase),Wm=function(e){return e+22+75*(e<26)},qm=function(e,t,n){var r=0;for(e=n?xm(e/700):e>>1,e+=xm(e/t);e>455;)e=xm(e/35),r+=36;return xm(r+36*e/(e+38))},Km=function(e){var t=[];e=function(e){for(var t=[],n=0,r=e.length;n<r;){var o=jm(e,n++);if(o>=55296&&o<=56319&&n<r){var i=jm(e,n++);56320==(64512&i)?Bm(t,((1023&o)<<10)+(1023&i)+65536):(Bm(t,o),n--)}else Bm(t,o)}return t}(e);var n,r,o=e.length,i=128,a=0,s=72;for(n=0;n<e.length;n++)(r=e[n])<128&&Bm(t,Um(r));var c=t.length,l=c;for(c&&Bm(t,"-");l<o;){var u=Nm;for(n=0;n<e.length;n++)(r=e[n])>=i&&r<u&&(u=r);var d=l+1;if(u-i>xm((Nm-a)/d))throw new Mm(Dm);for(a+=(u-i)*d,i=u,n=0;n<e.length;n++){if((r=e[n])<i&&++a>Nm)throw new Mm(Dm);if(r===i){for(var p=a,h=36;;){var f=h<=s?1:h>=s+26?26:h-s;if(p<f)break;var m=p-f,v=36-f;Bm(t,Um(Wm(f+m%v))),p=xm(m/v),h+=36}Bm(t,Um(Wm(p))),s=qm(a,d,l===c),a=0,l++}}a++,i++}return Fm(t,"")},Ym=Mn,zm=k,Xm=Rh,Jm=m,Zm=tn,Qm=p,$m=ws,ev=Cc,tv=Dc,nv=rt,rv=dm,ov=function(e){var t=_m(e),n=Sm(this),r=arguments.length,o=r>1?arguments[1]:void 0,i=void 0!==o;i&&(o=Em(o,r>2?arguments[2]:void 0));var a,s,c,l,u,d,p=wm(t),h=0;if(!p||this===Im&&Tm(p))for(a=Om(t),s=n?new this(a):Im(a);a>h;h++)d=i?o(t[h],h):t[h],Rm(s,h,d);else for(s=n?new this:[],u=(l=Cm(t,p)).next;!(c=ym(u,l)).done;h++)d=i?bm(l,o,[c.value,h],!0):c.value,Rm(s,h,d);return s.length=h,s},iv=ll,av=Gp.codeAt,sv=function(e){var t,n,r=[],o=Hm(Vm(Gm(e),Pm,"."),".");for(t=0;t<o.length;t++)n=o[t],Bm(r,Lm(km,n)?"xn--"+Km(n):n);return Fm(r,".")},cv=Tr,lv=Ks,uv=dl,dv=Zf,pv=ys,hv=pv.set,fv=pv.getterFor("URL"),mv=dv.URLSearchParams,vv=dv.getState,gv=Jm.URL,Ev=Jm.TypeError,yv=Jm.parseInt,_v=Math.floor,bv=Math.pow,Tv=Qm("".charAt),Sv=Qm(/./.exec),Ov=Qm([].join),Rv=Qm(1..toString),Cv=Qm([].pop),wv=Qm([].push),Iv=Qm("".replace),Av=Qm([].shift),Nv=Qm("".split),kv=Qm("".slice),Pv=Qm("".toLowerCase),Dv=Qm([].unshift),Mv="Invalid scheme",Lv="Invalid host",xv="Invalid port",Uv=/[a-z]/i,jv=/[\d+-.a-z]/i,Fv=/\d/,Bv=/^0x/i,Vv=/^[0-7]+$/,Hv=/^\d+$/,Gv=/^[\da-f]+$/i,Wv=/[\0\t\n\r #%/:<>?@[\\\]^|]/,qv=/[\0\t\n\r #/:<>?@[\\\]^|]/,Kv=/^[\u0000-\u0020]+/,Yv=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,zv=/[\t\n\r]/g,Xv=function(e){var t,n,r,o;if("number"==typeof e){for(t=[],n=0;n<4;n++)Dv(t,e%256),e=_v(e/256);return Ov(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,o=0,i=0;i<8;i++)0!==e[i]?(o>n&&(t=r,n=o),r=null,o=0):(null===r&&(r=i),++o);return o>n?r:t}(e),n=0;n<8;n++)o&&0===e[n]||(o&&(o=!1),r===n?(t+=n?":":"::",o=!0):(t+=Rv(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},Jv={},Zv=rv({},Jv,{" ":1,'"':1,"<":1,">":1,"`":1}),Qv=rv({},Zv,{"#":1,"?":1,"{":1,"}":1}),$v=rv({},Qv,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),eg=function(e,t){var n=av(e,0);return n>32&&n<127&&!nv(t,e)?e:encodeURIComponent(e)},tg={ftp:21,file:null,http:80,https:443,ws:80,wss:443},ng=function(e,t){var n;return 2===e.length&&Sv(Uv,Tv(e,0))&&(":"===(n=Tv(e,1))||!t&&"|"===n)},rg=function(e){var t;return e.length>1&&ng(kv(e,0,2))&&(2===e.length||"/"===(t=Tv(e,2))||"\\"===t||"?"===t||"#"===t)},og=function(e){return"."===e||"%2e"===Pv(e)},ig={},ag={},sg={},cg={},lg={},ug={},dg={},pg={},hg={},fg={},mg={},vg={},gg={},Eg={},yg={},_g={},bg={},Tg={},Sg={},Og={},Rg={},Cg=function(e,t,n){var r,o,i,a=cv(e);if(t){if(o=this.parse(a))throw new Ev(o);this.searchParams=null}else{if(void 0!==n&&(r=new Cg(n,!0)),o=this.parse(a,null,r))throw new Ev(o);(i=vv(new mv)).bindURL(this),this.searchParams=i}};Cg.prototype={type:"URL",parse:function(e,t,n){var r,o,i,a,s,c=this,l=t||ig,u=0,d="",p=!1,h=!1,f=!1;for(e=cv(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=Iv(e,Kv,""),e=Iv(e,Yv,"$1")),e=Iv(e,zv,""),r=ov(e);u<=r.length;){switch(o=r[u],l){case ig:if(!o||!Sv(Uv,o)){if(t)return Mv;l=sg;continue}d+=Pv(o),l=ag;break;case ag:if(o&&(Sv(jv,o)||"+"===o||"-"===o||"."===o))d+=Pv(o);else{if(":"!==o){if(t)return Mv;d="",l=sg,u=0;continue}if(t&&(c.isSpecial()!==nv(tg,d)||"file"===d&&(c.includesCredentials()||null!==c.port)||"file"===c.scheme&&!c.host))return;if(c.scheme=d,t)return void(c.isSpecial()&&tg[c.scheme]===c.port&&(c.port=null));d="","file"===c.scheme?l=Eg:c.isSpecial()&&n&&n.scheme===c.scheme?l=cg:c.isSpecial()?l=pg:"/"===r[u+1]?(l=lg,u++):(c.cannotBeABaseURL=!0,wv(c.path,""),l=Sg)}break;case sg:if(!n||n.cannotBeABaseURL&&"#"!==o)return Mv;if(n.cannotBeABaseURL&&"#"===o){c.scheme=n.scheme,c.path=iv(n.path),c.query=n.query,c.fragment="",c.cannotBeABaseURL=!0,l=Rg;break}l="file"===n.scheme?Eg:ug;continue;case cg:if("/"!==o||"/"!==r[u+1]){l=ug;continue}l=hg,u++;break;case lg:if("/"===o){l=fg;break}l=Tg;continue;case ug:if(c.scheme=n.scheme,o===Jf)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=iv(n.path),c.query=n.query;else if("/"===o||"\\"===o&&c.isSpecial())l=dg;else if("?"===o)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=iv(n.path),c.query="",l=Og;else{if("#"!==o){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=iv(n.path),c.path.length--,l=Tg;continue}c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=iv(n.path),c.query=n.query,c.fragment="",l=Rg}break;case dg:if(!c.isSpecial()||"/"!==o&&"\\"!==o){if("/"!==o){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,l=Tg;continue}l=fg}else l=hg;break;case pg:if(l=hg,"/"!==o||"/"!==Tv(d,u+1))continue;u++;break;case hg:if("/"!==o&&"\\"!==o){l=fg;continue}break;case fg:if("@"===o){p&&(d="%40"+d),p=!0,i=ov(d);for(var m=0;m<i.length;m++){var v=i[m];if(":"!==v||f){var g=eg(v,$v);f?c.password+=g:c.username+=g}else f=!0}d=""}else if(o===Jf||"/"===o||"?"===o||"#"===o||"\\"===o&&c.isSpecial()){if(p&&""===d)return"Invalid authority";u-=ov(d).length+1,d="",l=mg}else d+=o;break;case mg:case vg:if(t&&"file"===c.scheme){l=_g;continue}if(":"!==o||h){if(o===Jf||"/"===o||"?"===o||"#"===o||"\\"===o&&c.isSpecial()){if(c.isSpecial()&&""===d)return Lv;if(t&&""===d&&(c.includesCredentials()||null!==c.port))return;if(a=c.parseHost(d))return a;if(d="",l=bg,t)return;continue}"["===o?h=!0:"]"===o&&(h=!1),d+=o}else{if(""===d)return Lv;if(a=c.parseHost(d))return a;if(d="",l=gg,t===vg)return}break;case gg:if(!Sv(Fv,o)){if(o===Jf||"/"===o||"?"===o||"#"===o||"\\"===o&&c.isSpecial()||t){if(""!==d){var E=yv(d,10);if(E>65535)return xv;c.port=c.isSpecial()&&E===tg[c.scheme]?null:E,d=""}if(t)return;l=bg;continue}return xv}d+=o;break;case Eg:if(c.scheme="file","/"===o||"\\"===o)l=yg;else{if(!n||"file"!==n.scheme){l=Tg;continue}switch(o){case Jf:c.host=n.host,c.path=iv(n.path),c.query=n.query;break;case"?":c.host=n.host,c.path=iv(n.path),c.query="",l=Og;break;case"#":c.host=n.host,c.path=iv(n.path),c.query=n.query,c.fragment="",l=Rg;break;default:rg(Ov(iv(r,u),""))||(c.host=n.host,c.path=iv(n.path),c.shortenPath()),l=Tg;continue}}break;case yg:if("/"===o||"\\"===o){l=_g;break}n&&"file"===n.scheme&&!rg(Ov(iv(r,u),""))&&(ng(n.path[0],!0)?wv(c.path,n.path[0]):c.host=n.host),l=Tg;continue;case _g:if(o===Jf||"/"===o||"\\"===o||"?"===o||"#"===o){if(!t&&ng(d))l=Tg;else if(""===d){if(c.host="",t)return;l=bg}else{if(a=c.parseHost(d))return a;if("localhost"===c.host&&(c.host=""),t)return;d="",l=bg}continue}d+=o;break;case bg:if(c.isSpecial()){if(l=Tg,"/"!==o&&"\\"!==o)continue}else if(t||"?"!==o)if(t||"#"!==o){if(o!==Jf&&(l=Tg,"/"!==o))continue}else c.fragment="",l=Rg;else c.query="",l=Og;break;case Tg:if(o===Jf||"/"===o||"\\"===o&&c.isSpecial()||!t&&("?"===o||"#"===o)){if(".."===(s=Pv(s=d))||"%2e."===s||".%2e"===s||"%2e%2e"===s?(c.shortenPath(),"/"===o||"\\"===o&&c.isSpecial()||wv(c.path,"")):og(d)?"/"===o||"\\"===o&&c.isSpecial()||wv(c.path,""):("file"===c.scheme&&!c.path.length&&ng(d)&&(c.host&&(c.host=""),d=Tv(d,0)+":"),wv(c.path,d)),d="","file"===c.scheme&&(o===Jf||"?"===o||"#"===o))for(;c.path.length>1&&""===c.path[0];)Av(c.path);"?"===o?(c.query="",l=Og):"#"===o&&(c.fragment="",l=Rg)}else d+=eg(o,Qv);break;case Sg:"?"===o?(c.query="",l=Og):"#"===o?(c.fragment="",l=Rg):o!==Jf&&(c.path[0]+=eg(o,Jv));break;case Og:t||"#"!==o?o!==Jf&&("'"===o&&c.isSpecial()?c.query+="%27":c.query+="#"===o?"%23":eg(o,Jv)):(c.fragment="",l=Rg);break;case Rg:o!==Jf&&(c.fragment+=eg(o,Zv))}u++}},parseHost:function(e){var t,n,r;if("["===Tv(e,0)){if("]"!==Tv(e,e.length-1))return Lv;if(t=function(e){var t,n,r,o,i,a,s,c=[0,0,0,0,0,0,0,0],l=0,u=null,d=0,p=function(){return Tv(e,d)};if(":"===p()){if(":"!==Tv(e,1))return;d+=2,u=++l}for(;p();){if(8===l)return;if(":"!==p()){for(t=n=0;n<4&&Sv(Gv,p());)t=16*t+yv(p(),16),d++,n++;if("."===p()){if(0===n)return;if(d-=n,l>6)return;for(r=0;p();){if(o=null,r>0){if(!("."===p()&&r<4))return;d++}if(!Sv(Fv,p()))return;for(;Sv(Fv,p());){if(i=yv(p(),10),null===o)o=i;else{if(0===o)return;o=10*o+i}if(o>255)return;d++}c[l]=256*c[l]+o,2!=++r&&4!==r||l++}if(4!==r)return;break}if(":"===p()){if(d++,!p())return}else if(p())return;c[l++]=t}else{if(null!==u)return;d++,u=++l}}if(null!==u)for(a=l-u,l=7;0!==l&&a>0;)s=c[l],c[l--]=c[u+a-1],c[u+--a]=s;else if(8!==l)return;return c}(kv(e,1,-1)),!t)return Lv;this.host=t}else if(this.isSpecial()){if(e=sv(e),Sv(Wv,e))return Lv;if(t=function(e){var t,n,r,o,i,a,s,c=Nv(e,".");if(c.length&&""===c[c.length-1]&&c.length--,(t=c.length)>4)return e;for(n=[],r=0;r<t;r++){if(""===(o=c[r]))return e;if(i=10,o.length>1&&"0"===Tv(o,0)&&(i=Sv(Bv,o)?16:8,o=kv(o,8===i?1:2)),""===o)a=0;else{if(!Sv(10===i?Hv:8===i?Vv:Gv,o))return e;a=yv(o,i)}wv(n,a)}for(r=0;r<t;r++)if(a=n[r],r===t-1){if(a>=bv(256,5-t))return null}else if(a>255)return null;for(s=Cv(n),r=0;r<n.length;r++)s+=n[r]*bv(256,3-r);return s}(e),null===t)return Lv;this.host=t}else{if(Sv(qv,e))return Lv;for(t="",n=ov(e),r=0;r<n.length;r++)t+=eg(n[r],Jv);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return nv(tg,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"===this.scheme&&1===t&&ng(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,r=e.password,o=e.host,i=e.port,a=e.path,s=e.query,c=e.fragment,l=t+":";return null!==o?(l+="//",e.includesCredentials()&&(l+=n+(r?":"+r:"")+"@"),l+=Xv(o),null!==i&&(l+=":"+i)):"file"===t&&(l+="//"),l+=e.cannotBeABaseURL?a[0]:a.length?"/"+Ov(a,"/"):"",null!==s&&(l+="?"+s),null!==c&&(l+="#"+c),l},setHref:function(e){var t=this.parse(e);if(t)throw new Ev(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"===e)try{return new wg(e.path[0]).origin}catch(e){return"null"}return"file"!==e&&this.isSpecial()?e+"://"+Xv(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(cv(e)+":",ig)},getUsername:function(){return this.username},setUsername:function(e){var t=ov(cv(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=eg(t[n],$v)}},getPassword:function(){return this.password},setPassword:function(e){var t=ov(cv(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=eg(t[n],$v)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?Xv(e):Xv(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,mg)},getHostname:function(){var e=this.host;return null===e?"":Xv(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,vg)},getPort:function(){var e=this.port;return null===e?"":cv(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""===(e=cv(e))?this.port=null:this.parse(e,gg))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+Ov(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,bg))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""===(e=cv(e))?this.query=null:("?"===Tv(e,0)&&(e=kv(e,1)),this.query="",this.parse(e,Og)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!==(e=cv(e))?("#"===Tv(e,0)&&(e=kv(e,1)),this.fragment="",this.parse(e,Rg)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var wg=function(e){var t=tv(this,Ig),n=uv(arguments.length,1)>1?arguments[1]:void 0,r=hv(t,new Cg(e,!1,n));zm||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},Ig=wg.prototype,Ag=function(e,t){return{get:function(){return fv(this)[e]()},set:t&&function(e){return fv(this)[t](e)},configurable:!0,enumerable:!0}};if(zm&&(ev(Ig,"href",Ag("serialize","setHref")),ev(Ig,"origin",Ag("getOrigin")),ev(Ig,"protocol",Ag("getProtocol","setProtocol")),ev(Ig,"username",Ag("getUsername","setUsername")),ev(Ig,"password",Ag("getPassword","setPassword")),ev(Ig,"host",Ag("getHost","setHost")),ev(Ig,"hostname",Ag("getHostname","setHostname")),ev(Ig,"port",Ag("getPort","setPort")),ev(Ig,"pathname",Ag("getPathname","setPathname")),ev(Ig,"search",Ag("getSearch","setSearch")),ev(Ig,"searchParams",Ag("getSearchParams")),ev(Ig,"hash",Ag("getHash","setHash"))),$m(Ig,"toJSON",(function(){return fv(this).serialize()}),{enumerable:!0}),$m(Ig,"toString",(function(){return fv(this).serialize()}),{enumerable:!0}),gv){var Ng=gv.createObjectURL,kg=gv.revokeObjectURL;Ng&&$m(wg,"createObjectURL",Zm(Ng,gv)),kg&&$m(wg,"revokeObjectURL",Zm(kg,gv))}lv(wg,"URL"),Ym({global:!0,constructor:!0,forced:!Xm,sham:!zm},{URL:wg});var Pg=Mn,Dg=a,Mg=dl,Lg=Tr,xg=Rh,Ug=se("URL"),jg=xg&&Dg((function(){Ug.canParse()})),Fg=Dg((function(){return 1!==Ug.canParse.length}));Pg({target:"URL",stat:!0,forced:!jg||Fg},{canParse:function(e){var t=Mg(arguments.length,1),n=Lg(e),r=t<2||void 0===arguments[1]?void 0:Lg(arguments[1]);try{return!!new Ug(n,r)}catch(e){return!1}}});var Bg=Mn,Vg=dl,Hg=Tr,Gg=Rh,Wg=se("URL");Bg({target:"URL",stat:!0,forced:!Gg},{parse:function(e){var t=Vg(arguments.length,1),n=Hg(e),r=t<2||void 0===arguments[1]?void 0:Hg(arguments[1]);try{return new Wg(n,r)}catch(e){return null}}});var qg=i(ne.URL);let Kg=!0,Yg=!0;function zg(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function Xg(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,o=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return o.apply(this,arguments);const i=e=>{const t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,i),o.apply(this,[e,i])};const i=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return i.apply(this,arguments);if(!this._eventMap[t].has(n))return i.apply(this,arguments);const r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,i.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function Jg(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Kg=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Zg(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Yg=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Qg(){if("object"==typeof window){if(Kg)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function $g(e,t){Yg&&console.warn(e+" is deprecated, please use "+t+" instead.")}function eE(e){return"[object Object]"===Object.prototype.toString.call(e)}function tE(e){var t;return eE(e)?so(t=Object.keys(e)).call(t,(function(t,n){const r=eE(e[n]),o=r?tE(e[n]):e[n],i=r&&!Object.keys(o).length;return void 0===o||i?t:Object.assign(t,{[n]:o})}),{}):e}function nE(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((r=>{r.endsWith("Id")?nE(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((t=>{nE(e,e.get(t),n)}))})))}function rE(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;const i=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&i.push(e)})),i.forEach((t=>{e.forEach((n=>{n.type===r&&n.trackId===t.id&&nE(e,n,o)}))})),o}const oE=Qg;function iE(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);const o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];let e={};"number"==typeof r.ideal?(e[o("min",n)]=r.ideal,t.optional.push(e),e={},e[o("max",n)]=r.ideal,t.optional.push(e)):(e[o("",n)]=r.ideal,t.optional.push(e))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=r.exact):["min","max"].forEach((e=>{void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=r[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},o=function(e,o){if(t.version>=61)return o(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"==typeof e.video){let i=e.video.facingMode;i=i&&("object"==typeof i?i:{ideal:i});const a=t.version<66;if(i&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||a)){let t;if(delete e.video.facingMode,"environment"===i.exact||"environment"===i.ideal?t=["back","rear"]:"user"!==i.exact&&"user"!==i.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{let a=(n=n.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>{var n;return Ur(n=e.label.toLowerCase()).call(n,t)}))));return!a&&n.length&&Ur(t).call(t,"back")&&(a=n[n.length-1]),a&&(e.video.deviceId=i.exact?{exact:a.deviceId}:{ideal:a.deviceId}),e.video=r(e.video),oE("chrome: "+JSON.stringify(e)),o(e)}))}e.video=r(e.video)}return oE("chrome: "+JSON.stringify(e)),o(e)},i=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){o(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{r&&r(i(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return o(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>ih.reject(i(e))))))}}}function aE(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function sE(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const o=new Event("track");o.track=n.track,o.receiver=r,o.transceiver={receiver:r},o.streams=[t.stream],this.dispatchEvent(o)})),t.stream.getTracks().forEach((n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=[t.stream],this.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Xg(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function cE(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){let o=n.apply(this,arguments);return o||(o=t(this,e),this._senders.push(o)),o};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function lE(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,r]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const o=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},i=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const r=function(e){n(i(o(e)))};return t.apply(this,[r,e])}return new ih(((e,n)=>{t.apply(this,[function(t){e(i(o(t)))},n])})).then(n,r)}}function uE(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>rE(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Xg(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>rE(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,r;return this.getSenders().forEach((n=>{n.track===e&&(t?r=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?r=!0:n=t),t.track===e))),r||t&&n?ih.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():ih.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function dE(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const r=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(r)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};const o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),o.apply(this,arguments)}}function pE(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return dE(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};const o=e.RTCPeerConnection.prototype.removeStream;function i(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const r=e._reverseStreams[t],o=e._streams[r.id];n=n.replace(new RegExp(o.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const o=this.getSenders().find((e=>e.track===t));if(o)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const i=this._streams[n.id];if(i)i.addTrack(t),ih.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const r=new e.MediaStream([t]);this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=i(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>i(this,e)))}};e.RTCPeerConnection.prototype[t]=r[t]}));const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const r=e._reverseStreams[t],o=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),o.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=s.get.apply(this);return""===e.type?e:i(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function hE(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}))}function fE(e,t){Xg(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}var mE=Object.freeze({__proto__:null,fixNegotiationNeeded:fE,shimAddTrackRemoveTrack:pE,shimAddTrackRemoveTrackWithNative:dE,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const r=n.video&&n.video.width,o=n.video&&n.video.height,i=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:i||3}},r&&(n.video.mandatory.maxWidth=r),o&&(n.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:cE,shimGetStats:lE,shimGetUserMedia:iE,shimMediaStream:aE,shimOnTrack:sE,shimPeerConnection:hE,shimSenderReceiverGetStats:uE});function vE(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){$g("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},r&&r.prototype.getSettings){const t=r.prototype.getSettings;r.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(r&&r.prototype.applyConstraints){const t=r.prototype.applyConstraints;r.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function gE(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function EE(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,o,i]=arguments;return r.apply(this,[e||null]).then((e=>{if(t.version<53&&!o)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,r)=>{e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(o,i)}}function yE(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):ih.resolve(new Map)}}function _E(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Xg(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function bE(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){$g("removeStream","removeTrack"),this.getSenders().forEach((t=>{var n;t.track&&Ur(n=e.getTracks()).call(n,t.track)&&this.removeTrack(t)}))})}function TE(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function SE(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach((e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const r=t.apply(this,arguments);if(n){const{sender:t}=r,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return r})}function OE(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function RE(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?ih.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function CE(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?ih.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}var wE=Object.freeze({__proto__:null,shimAddTransceiver:SE,shimCreateAnswer:CE,shimCreateOffer:RE,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,ih.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:OE,shimGetUserMedia:vE,shimOnTrack:gE,shimPeerConnection:EE,shimRTCDataChannel:TE,shimReceiverGetStats:_E,shimRemoveStream:bE,shimSenderGetStats:yE});function IE(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n;this._localStreams||(this._localStreams=[]),Ur(n=this._localStreams).call(n,e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r&&r.forEach((e=>{var t;this._localStreams?Ur(t=this._localStreams).call(t,e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{Ur(n).call(n,e.track)&&this.removeTrack(e)}))})}}function AE(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{var t;if(this._remoteStreams||(this._remoteStreams=[]),Ur(t=this._remoteStreams).call(t,e))return;this._remoteStreams.push(e);const n=new Event("addstream");n.stream=e,this.dispatchEvent(n)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function NE(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,o=t.setLocalDescription,i=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],o=n.apply(this,[r]);return t?(o.then(e,t),ih.resolve()):o},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],o=r.apply(this,[n]);return t?(o.then(e,t),ih.resolve()):o};let s=function(e,t,n){const r=o.apply(this,[e]);return n?(r.then(t,n),ih.resolve()):r};t.setLocalDescription=s,s=function(e,t,n){const r=i.apply(this,[e]);return n?(r.then(t,n),ih.resolve()):r},t.setRemoteDescription=s,s=function(e,t,n){const r=a.apply(this,[e]);return n?(r.then(t,n),ih.resolve()):r},t.addIceCandidate=s}function kE(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(PE(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function PE(e){return e&&void 0!==e.video?Object.assign({},e,{video:tE(e.video)}):e}function DE(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let r=e.iceServers[n];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?($g("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,t.push(r)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function ME(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function LE(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function xE(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var UE=Object.freeze({__proto__:null,shimAudioContext:xE,shimCallbacksAPI:NE,shimConstraints:PE,shimCreateOfferLegacy:LE,shimGetUserMedia:kE,shimLocalStreamsAPI:IE,shimRTCIceServerUrls:DE,shimRemoteStreamsAPI:AE,shimTrackEventTransceiver:ME}),jE="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",FE=J,BE=Tr,VE=jE,HE=p("".replace),GE=RegExp("^["+VE+"]+"),WE=RegExp("(^|[^"+VE+"])["+VE+"]+$"),qE=function(e){return function(t){var n=BE(FE(t));return 1&e&&(n=HE(n,GE,"")),2&e&&(n=HE(n,WE,"$1")),n}},KE={start:qE(1),end:qE(2),trim:qE(3)},YE=Rs.PROPER,zE=a,XE=jE,JE=KE.trim;Mn({target:"String",proto:!0,forced:function(e){return zE((function(){return!!XE[e]()||"\u200b\x85\u180e"!=="\u200b\x85\u180e"[e]()||YE&&XE[e].name!==e}))}("trim")},{trim:function(){return JE(this)}});var ZE=rr("String","trim"),QE=h,$E=ZE,ey=String.prototype,ty=function(e){var t=e.trim;return"string"==typeof e||e===ey||QE(ey,e)&&t===ey.trim?$E:t},ny=i(ty),ry={exports:{}};!function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((e=>0===e.indexOf(n)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:void 0===n[t[r]]&&(n[t[r]]=t[r+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const r=e.substring(e.indexOf(" ")+1).split(";");for(let o=0;o<r.length;o++)n=r[o].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const r=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substring(t+1,r),n.value=e.substring(r+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],o=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&o?{usernameFragment:r.substring(12),password:o.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" ");n.profile=r[2];for(let i=3;i<r.length;i++){const o=r[i],a=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){const r=t.parseRtpMap(a),i=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(r.parameters=i.length?t.parseFmtp(i[0]):{},r.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),n.codecs.push(r),r.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(r.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach((e=>{n.headerExtensions.push(t.parseExtmap(e))}));const o=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach((e=>{o.forEach((t=>{e.rtcpFeedback.find((e=>e.type===t.type&&e.parameter===t.parameter))||e.rtcpFeedback.push(t)}))})),n},t.writeRtpDescription=function(e,n){let r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=n.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((e=>{r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)}));let o=0;return n.codecs.forEach((e=>{e.maxptime>o&&(o=e.maxptime)})),o>0&&(r+="a=maxptime:"+o+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach((e=>{r+=t.writeExtmap(e)})),r},t.parseRtpEncodingParameters=function(e){const n=[],r=t.parseRtpParameters(e),o=-1!==r.fecMechanisms.indexOf("RED"),i=-1!==r.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),s=a.length>0&&a[0].ssrc;let c;const l=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substring(17).split(" ").map((e=>parseInt(e,10)))));l.length>0&&l[0].length>1&&l[0][0]===s&&(c=l[0][1]),r.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&c&&(t.rtx={ssrc:c}),n.push(t),o&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:s,mechanism:i?"red+ulpfec":"red"},n.push(t))}})),0===n.length&&s&&n.push({ssrc:s});let u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substring(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,n.forEach((e=>{e.maxBitrate=u}))),n},t.parseRtcpParameters=function(e){const n={},r=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);const o=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=o.length>0,n.compound=0===o.length;const i=t.matchPrefix(e,"a=rtcp-mux");return n.mux=i.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const r=t.matchPrefix(e,"a=msid:");if(1===r.length)return n=r[0].substring(7).split(" "),{stream:n[0],track:n[1]};const o=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return o.length>0?(n=o[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),r=t.matchPrefix(e,"a=max-message-size:");let o;r.length>0&&(o=parseInt(r[0].substring(19),10)),isNaN(o)&&(o=65536);const i=t.matchPrefix(e,"a=sctp-port:");if(i.length>0)return{port:parseInt(i[0].substring(12),10),protocol:n.fmt,maxMessageSize:o};const a=t.matchPrefix(e,"a=sctpmap:");if(a.length>0){const e=a[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:o}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,r){let o;const i=void 0!==n?n:2;return o=e||t.generateSessionId(),"v=0\r\no="+(r||"thisisadapterortc")+" "+o+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const r=t.splitLines(e);for(let t=0;t<r.length;t++)switch(r[t]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[t].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let t=0;t<n.length;t++)if(n[t].length<2||"="!==n[t].charAt(1))return!1;return!0},e.exports=t}(ry);var oy=ry.exports,iy=i(oy),ay=e({__proto__:null,default:iy},[oy]);function sy(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const n=new t(e),r=iy.parseCandidate(e.candidate),o=Object.assign(n,r);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Xg(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function cy(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Xg(e,"icecandidate",(e=>{if(e.candidate){const t=iy.parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e}))}function ly(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=iy.splitSections(e.sdp);return t.shift(),t.some((e=>{const t=iy.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),r=function(e,n){let r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);const o=iy.matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?r=parseInt(o[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r}(arguments[0],e);let o;o=0===n&&0===r?Number.POSITIVE_INFINITY:0===n||0===r?Math.max(n,r):Math.min(n,r);const i={};Object.defineProperty(i,"maxMessageSize",{get:()=>o}),this._sctp=i}return n.apply(this,arguments)}}function uy(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const r=arguments[0],o=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},Xg(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function dy(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function py(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==ny(e).call(e))).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function hy(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?ih.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),ih.resolve())})}function fy(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?n.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>n.apply(this,[e])))})}var my=Object.freeze({__proto__:null,removeExtmapAllowMixed:py,shimAddIceCandidateNullOrEmpty:hy,shimConnectionState:dy,shimMaxMessageSize:ly,shimParameterlessSetLocalDescription:fy,shimRTCIceCandidate:sy,shimRTCIceCandidateRelayProtocol:cy,shimSendThrowTypeError:uy});!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=Qg,r=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=zg(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=zg(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=zg(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),o={browserDetails:r,commonShim:my,extractVersion:zg,disableLog:Jg,disableWarnings:Zg,sdp:ay};switch(r.browser){case"chrome":if(!mE||!hE||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),o;if(null===r.version)return n("Chrome shim can not determine version, not shimming."),o;n("adapter.js shimming chrome."),o.browserShim=mE,hy(e,r),fy(e),iE(e,r),aE(e),hE(e,r),sE(e),pE(e,r),cE(e),lE(e),uE(e),fE(e,r),sy(e),cy(e),dy(e),ly(e,r),uy(e),py(e,r);break;case"firefox":if(!wE||!EE||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),o;n("adapter.js shimming firefox."),o.browserShim=wE,hy(e,r),fy(e),vE(e,r),EE(e,r),gE(e),bE(e),yE(e),_E(e),TE(e),SE(e),OE(e),RE(e),CE(e),sy(e),dy(e),ly(e,r),uy(e);break;case"safari":if(!UE||!t.shimSafari)return n("Safari shim is not included in this adapter release."),o;n("adapter.js shimming safari."),o.browserShim=UE,hy(e,r),fy(e),DE(e),LE(e),NE(e),IE(e),AE(e),ME(e),kE(e),xE(e),sy(e),cy(e),ly(e,r),uy(e),py(e,r);break;default:n("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window});var vy=Ae,gy=TypeError,Ey=ue.match(/firefox\/(\d+)/i),yy=!!Ey&&+Ey[1],_y=/MSIE|Trident/.test(ue),by=ue.match(/AppleWebKit\/(\d+)\./),Ty=!!by&&+by[1],Sy=Mn,Oy=p,Ry=De,Cy=et,wy=zn,Iy=function(e,t){if(!delete e[t])throw new gy("Cannot delete property "+vy(t)+" of "+vy(e))},Ay=Tr,Ny=a,ky=Nh,Py=Yr,Dy=yy,My=_y,Ly=ge,xy=Ty,Uy=[],jy=Oy(Uy.sort),Fy=Oy(Uy.push),By=Ny((function(){Uy.sort(void 0)})),Vy=Ny((function(){Uy.sort(null)})),Hy=Py("sort"),Gy=!Ny((function(){if(Ly)return Ly<70;if(!(Dy&&Dy>3)){if(My)return!0;if(xy)return xy<603;var e,t,n,r,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)Uy.push({k:t+r,v:n})}for(Uy.sort((function(e,t){return t.v-e.v})),r=0;r<Uy.length;r++)t=Uy[r].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}}));Sy({target:"Array",proto:!0,forced:By||!Vy||!Hy||!Gy},{sort:function(e){void 0!==e&&Ry(e);var t=Cy(this);if(Gy)return void 0===e?jy(t):jy(t,e);var n,r,o=[],i=wy(t);for(r=0;r<i;r++)r in t&&Fy(o,t[r]);for(ky(o,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:Ay(t)>Ay(n)?1:-1}}(e)),n=wy(o),r=0;r<n;)t[r]=o[r++];for(;r<i;)Iy(t,r++);return t}});var Wy=rr("Array","sort"),qy=h,Ky=Wy,Yy=Array.prototype,zy=function(e){var t=e.sort;return e===Yy||qy(Yy,e)&&t===Yy.sort?Ky:t},Xy=i(zy),Jy=m;Mn({global:!0,forced:Jy.globalThis!==Jy},{globalThis:Jy});var Zy=i(m),Qy={exports:{}};!function(e,t){!function(n,r){var o="function",i="undefined",a="object",s="string",c="major",l="model",u="name",d="type",p="vendor",h="version",f="architecture",m="console",v="mobile",g="tablet",E="smarttv",y="wearable",_="embedded",b="Amazon",T="Apple",S="ASUS",O="BlackBerry",R="Browser",C="Chrome",w="Firefox",I="Google",A="Huawei",N="LG",k="Microsoft",P="Motorola",D="Opera",M="Samsung",L="Sharp",x="Sony",U="Xiaomi",j="Zebra",F="Facebook",B="Chromium OS",V="Mac OS",H=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},G=function(e,t){return typeof e===s&&-1!==W(t).indexOf(W(e))},W=function(e){return e.toLowerCase()},q=function(e,t){if(typeof e===s)return e=e.replace(/^\s\s*/,""),typeof t===i?e:e.substring(0,350)},K=function(e,t){for(var n,i,s,c,l,u,d=0;d<t.length&&!l;){var p=t[d],h=t[d+1];for(n=i=0;n<p.length&&!l&&p[n];)if(l=p[n++].exec(e))for(s=0;s<h.length;s++)u=l[++i],typeof(c=h[s])===a&&c.length>0?2===c.length?typeof c[1]==o?this[c[0]]=c[1].call(this,u):this[c[0]]=c[1]:3===c.length?typeof c[1]!==o||c[1].exec&&c[1].test?this[c[0]]=u?u.replace(c[1],c[2]):r:this[c[0]]=u?c[1].call(this,u,c[2]):r:4===c.length&&(this[c[0]]=u?c[3].call(this,u.replace(c[1],c[2])):r):this[c]=u||r;d+=2}},Y=function(e,t){for(var n in t)if(typeof t[n]===a&&t[n].length>0){for(var o=0;o<t[n].length;o++)if(G(t[n][o],e))return"?"===n?r:n}else if(G(t[n],e))return"?"===n?r:n;return e},z={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},X={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[h,[u,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[h,[u,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[u,h],[/opios[\/ ]+([\w\.]+)/i],[h,[u,D+" Mini"]],[/\bopr\/([\w\.]+)/i],[h,[u,D]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[u,h],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[h,[u,"UC"+R]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[h,[u,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[h,[u,"WeChat"]],[/konqueror\/([\w\.]+)/i],[h,[u,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[h,[u,"IE"]],[/yabrowser\/([\w\.]+)/i],[h,[u,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[u,/(.+)/,"$1 Secure "+R],h],[/\bfocus\/([\w\.]+)/i],[h,[u,w+" Focus"]],[/\bopt\/([\w\.]+)/i],[h,[u,D+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[h,[u,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[h,[u,"Dolphin"]],[/coast\/([\w\.]+)/i],[h,[u,D+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[h,[u,"MIUI "+R]],[/fxios\/([-\w\.]+)/i],[h,[u,w]],[/\bqihu|(qi?ho?o?|360)browser/i],[[u,"360 "+R]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[u,/(.+)/,"$1 "+R],h],[/(comodo_dragon)\/([\w\.]+)/i],[[u,/_/g," "],h],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[u,h],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[u],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[u,F],h],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[u,h],[/\bgsa\/([\w\.]+) .*safari\//i],[h,[u,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[h,[u,C+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[u,C+" WebView"],h],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[h,[u,"Android "+R]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[u,h],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[h,[u,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[h,u],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[u,[h,Y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[u,h],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[u,"Netscape"],h],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[h,[u,w+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[u,h],[/(cobalt)\/([\w\.]+)/i],[u,[h,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[f,"amd64"]],[/(ia32(?=;))/i],[[f,W]],[/((?:i[346]|x)86)[;\)]/i],[[f,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[f,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[f,"armhf"]],[/windows (ce|mobile); ppc;/i],[[f,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[f,/ower/,"",W]],[/(sun4\w)[;\)]/i],[[f,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[f,W]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[l,[p,M],[d,g]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[l,[p,M],[d,v]],[/\((ip(?:hone|od)[\w ]*);/i],[l,[p,T],[d,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[l,[p,T],[d,g]],[/(macintosh);/i],[l,[p,T]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[l,[p,L],[d,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[l,[p,A],[d,g]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[l,[p,A],[d,v]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[l,/_/g," "],[p,U],[d,v]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[l,/_/g," "],[p,U],[d,g]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[l,[p,"OPPO"],[d,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[l,[p,"Vivo"],[d,v]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[l,[p,"Realme"],[d,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[l,[p,P],[d,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[l,[p,P],[d,g]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[l,[p,N],[d,g]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[l,[p,N],[d,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[l,[p,"Lenovo"],[d,g]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[l,/_/g," "],[p,"Nokia"],[d,v]],[/(pixel c)\b/i],[l,[p,I],[d,g]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[l,[p,I],[d,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[l,[p,x],[d,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[l,"Xperia Tablet"],[p,x],[d,g]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[l,[p,"OnePlus"],[d,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[l,[p,b],[d,g]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[l,/(.+)/g,"Fire Phone $1"],[p,b],[d,v]],[/(playbook);[-\w\),; ]+(rim)/i],[l,p,[d,g]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[l,[p,O],[d,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[l,[p,S],[d,g]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[l,[p,S],[d,v]],[/(nexus 9)/i],[l,[p,"HTC"],[d,g]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[p,[l,/_/g," "],[d,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[l,[p,"Acer"],[d,g]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[l,[p,"Meizu"],[d,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[p,l,[d,v]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[p,l,[d,g]],[/(surface duo)/i],[l,[p,k],[d,g]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[l,[p,"Fairphone"],[d,v]],[/(u304aa)/i],[l,[p,"AT&T"],[d,v]],[/\bsie-(\w*)/i],[l,[p,"Siemens"],[d,v]],[/\b(rct\w+) b/i],[l,[p,"RCA"],[d,g]],[/\b(venue[\d ]{2,7}) b/i],[l,[p,"Dell"],[d,g]],[/\b(q(?:mv|ta)\w+) b/i],[l,[p,"Verizon"],[d,g]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[l,[p,"Barnes & Noble"],[d,g]],[/\b(tm\d{3}\w+) b/i],[l,[p,"NuVision"],[d,g]],[/\b(k88) b/i],[l,[p,"ZTE"],[d,g]],[/\b(nx\d{3}j) b/i],[l,[p,"ZTE"],[d,v]],[/\b(gen\d{3}) b.+49h/i],[l,[p,"Swiss"],[d,v]],[/\b(zur\d{3}) b/i],[l,[p,"Swiss"],[d,g]],[/\b((zeki)?tb.*\b) b/i],[l,[p,"Zeki"],[d,g]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[p,"Dragon Touch"],l,[d,g]],[/\b(ns-?\w{0,9}) b/i],[l,[p,"Insignia"],[d,g]],[/\b((nxa|next)-?\w{0,9}) b/i],[l,[p,"NextBook"],[d,g]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[p,"Voice"],l,[d,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[p,"LvTel"],l,[d,v]],[/\b(ph-1) /i],[l,[p,"Essential"],[d,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[l,[p,"Envizen"],[d,g]],[/\b(trio[-\w\. ]+) b/i],[l,[p,"MachSpeed"],[d,g]],[/\btu_(1491) b/i],[l,[p,"Rotor"],[d,g]],[/(shield[\w ]+) b/i],[l,[p,"Nvidia"],[d,g]],[/(sprint) (\w+)/i],[p,l,[d,v]],[/(kin\.[onetw]{3})/i],[[l,/\./g," "],[p,k],[d,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[l,[p,j],[d,g]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[l,[p,j],[d,v]],[/smart-tv.+(samsung)/i],[p,[d,E]],[/hbbtv.+maple;(\d+)/i],[[l,/^/,"SmartTV"],[p,M],[d,E]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[p,N],[d,E]],[/(apple) ?tv/i],[p,[l,T+" TV"],[d,E]],[/crkey/i],[[l,C+"cast"],[p,I],[d,E]],[/droid.+aft(\w)( bui|\))/i],[l,[p,b],[d,E]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[l,[p,L],[d,E]],[/(bravia[\w ]+)( bui|\))/i],[l,[p,x],[d,E]],[/(mitv-\w{5}) bui/i],[l,[p,U],[d,E]],[/Hbbtv.*(technisat) (.*);/i],[p,l,[d,E]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[p,q],[l,q],[d,E]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[d,E]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[p,l,[d,m]],[/droid.+; (shield) bui/i],[l,[p,"Nvidia"],[d,m]],[/(playstation [345portablevi]+)/i],[l,[p,x],[d,m]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[l,[p,k],[d,m]],[/((pebble))app/i],[p,l,[d,y]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[l,[p,T],[d,y]],[/droid.+; (glass) \d/i],[l,[p,I],[d,y]],[/droid.+; (wt63?0{2,3})\)/i],[l,[p,j],[d,y]],[/(quest( 2| pro)?)/i],[l,[p,F],[d,y]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[p,[d,_]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[l,[d,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[l,[d,g]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[d,g]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[d,v]],[/(android[-\w\. ]{0,9});.+buil/i],[l,[p,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[h,[u,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[h,[u,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[u,h],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[h,u]],os:[[/microsoft (windows) (vista|xp)/i],[u,h],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[u,[h,Y,z]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[u,"Windows"],[h,Y,z]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[h,/_/g,"."],[u,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[u,V],[h,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[h,u],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[u,h],[/\(bb(10);/i],[h,[u,O]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[h,[u,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[h,[u,w+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[h,[u,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[h,[u,"watchOS"]],[/crkey\/([\d\.]+)/i],[h,[u,C+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[u,B],h],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[u,h],[/(sunos) ?([\w\.\d]*)/i],[[u,"Solaris"],h],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[u,h]]},J=function(e,t){if(typeof e===a&&(t=e,e=r),!(this instanceof J))return new J(e,t).getResult();var m=typeof n!==i&&n.navigator?n.navigator:r,E=e||(m&&m.userAgent?m.userAgent:""),y=m&&m.userAgentData?m.userAgentData:r,_=t?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(X,t):X;return this.getBrowser=function(){var e={};return e[u]=r,e[h]=r,K.call(e,E,_.browser),e[c]=function(e){return typeof e===s?e.replace(/[^\d\.]/g,"").split(".")[0]:r}(e[h]),m&&m.brave&&typeof m.brave.isBrave==o&&(e[u]="Brave"),e},this.getCPU=function(){var e={};return e[f]=r,K.call(e,E,_.cpu),e},this.getDevice=function(){var e={};return e[p]=r,e[l]=r,e[d]=r,K.call(e,E,_.device),!e[d]&&y&&y.mobile&&(e[d]=v),"Macintosh"==e[l]&&m&&typeof m.standalone!==i&&m.maxTouchPoints&&m.maxTouchPoints>2&&(e[l]="iPad",e[d]=g),e},this.getEngine=function(){var e={};return e[u]=r,e[h]=r,K.call(e,E,_.engine),e},this.getOS=function(){var e={};return e[u]=r,e[h]=r,K.call(e,E,_.os),!e[u]&&y&&"Unknown"!=y.platform&&(e[u]=y.platform.replace(/chrome os/i,B).replace(/macos/i,V)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return E},this.setUA=function(e){return E=typeof e===s&&e.length>350?q(e,350):e,this},this.setUA(E),this};J.VERSION="0.7.34",J.BROWSER=H([u,h,c]),J.CPU=H([f]),J.DEVICE=H([l,p,d,m,v,E,g,y,_]),J.ENGINE=J.OS=H([u,h]),e.exports&&(t=e.exports=J),t.UAParser=J;var Z=typeof n!==i&&(n.jQuery||n.Zepto);if(Z&&!Z.ua){var Q=new J;Z.ua=Q.getResult(),Z.ua.get=function(){return Q.getUA()},Z.ua.set=function(e){Q.setUA(e);var t=Q.getResult();for(var n in t)Z.ua[n]=t[n]}}}("object"==typeof window?window:o)}(Qy,Qy.exports);var $y=i(Qy.exports),e_=yr,t_=rt,n_=Y,r_=Qi,o_=gt("iterator"),i_=Object,a_=function(e){if(n_(e))return!1;var t=i_(e);return void 0!==t[o_]||"@@iterator"in t||t_(r_,e_(t))},s_=i(a_),c_=Fl.clear;Mn({global:!0,bind:!0,enumerable:!0,forced:m.clearImmediate!==c_},{clearImmediate:c_});var l_=m,u_=_,d_=A,p_=Qr,h_=ue,f_=ll,m_=dl,v_=l_.Function,g_=/MSIE .\./.test(h_)||"BUN"===p_&&function(){var e=l_.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}(),E_=Mn,y_=m,__=Fl.set,b_=function(e,t){var n=t?2:1;return g_?function(r,o){var i=m_(arguments.length,1)>n,a=d_(r)?r:v_(r),s=i?f_(arguments,n):[],c=i?function(){u_(a,this,s)}:a;return t?e(c,o):e(c)}:e},T_=y_.setImmediate?b_(__,!1):__;E_({global:!0,bind:!0,enumerable:!0,forced:y_.setImmediate!==T_},{setImmediate:T_});var S_=i(ne.setImmediate),O_=m,R_=mu,C_=De,w_=dl,I_=k;Mn({global:!0,enumerable:!0,dontCallGetSet:!0,forced:a((function(){return I_&&1!==Object.getOwnPropertyDescriptor(O_,"queueMicrotask").value.length}))},{queueMicrotask:function(e){w_(arguments.length,1),R_(C_(e))}});var A_=i(ne.queueMicrotask);function N_(e,t){return function(){return e.apply(t,arguments)}}const{toString:k_}=Object.prototype,{getPrototypeOf:P_}=Object,D_=(M_=Object.create(null),e=>{const t=k_.call(e);return M_[t]||(M_[t]=t.slice(8,-1).toLowerCase())});var M_;const L_=e=>(e=e.toLowerCase(),t=>D_(t)===e),x_=e=>t=>typeof t===e,{isArray:U_}=Array,j_=x_("undefined"),F_=L_("ArrayBuffer"),B_=x_("string"),V_=x_("function"),H_=x_("number"),G_=e=>null!==e&&"object"==typeof e,W_=e=>{if("object"!==D_(e))return!1;const t=P_(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||s_(e))},q_=L_("Date"),K_=L_("File"),Y_=L_("Blob"),z_=L_("FileList"),X_=L_("URLSearchParams"),[J_,Z_,Q_,$_]=["ReadableStream","Request","Response","Headers"].map(L_);function eb(e,t){let n,r,{allOwnKeys:o=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e)if("object"!=typeof e&&(e=[e]),U_(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{const r=o?Object.getOwnPropertyNames(e):Object.keys(e),i=r.length;let a;for(n=0;n<i;n++)a=r[n],t.call(null,e[a],a,e)}}function tb(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,o=n.length;for(;o-- >0;)if(r=n[o],t===r.toLowerCase())return r;return null}const nb=void 0!==Zy?Zy:"undefined"!=typeof self?self:"undefined"!=typeof window?window:t,rb=e=>!j_(e)&&e!==nb,ob=(ib="undefined"!=typeof Uint8Array&&P_(Uint8Array),e=>ib&&e instanceof ib);var ib;const ab=L_("HTMLFormElement"),sb=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),cb=L_("RegExp"),lb=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};eb(n,((n,o)=>{let i;!1!==(i=t(n,o,e))&&(r[o]=i||n)})),Object.defineProperties(e,r)},ub="abcdefghijklmnopqrstuvwxyz",db="0123456789",pb={DIGIT:db,ALPHA:ub,ALPHA_DIGIT:ub+ub.toUpperCase()+db},hb=L_("AsyncFunction"),fb=(mb="function"==typeof S_,vb=V_(nb.postMessage),mb?S_:vb?(gb="axios@".concat(Math.random()),Eb=[],nb.addEventListener("message",(e=>{let{source:t,data:n}=e;t===nb&&n===gb&&Eb.length&&Eb.shift()()}),!1),e=>{Eb.push(e),nb.postMessage(gb,"*")}):e=>setTimeout(e));var mb,vb,gb,Eb;const yb=void 0!==A_?A_.bind(nb):"undefined"!=typeof n&&n.nextTick||fb;var _b={isArray:U_,isArrayBuffer:F_,isBuffer:function(e){return null!==e&&!j_(e)&&null!==e.constructor&&!j_(e.constructor)&&V_(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||V_(e.append)&&("formdata"===(t=D_(e))||"object"===t&&V_(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&F_(e.buffer),t},isString:B_,isNumber:H_,isBoolean:e=>!0===e||!1===e,isObject:G_,isPlainObject:W_,isReadableStream:J_,isRequest:Z_,isResponse:Q_,isHeaders:$_,isUndefined:j_,isDate:q_,isFile:K_,isBlob:Y_,isRegExp:cb,isFunction:V_,isStream:e=>G_(e)&&V_(e.pipe),isURLSearchParams:X_,isTypedArray:ob,isFileList:z_,forEach:eb,merge:function e(){const{caseless:t}=rb(this)&&this||{},n={},r=(r,o)=>{const i=t&&tb(n,o)||o;W_(n[i])&&W_(r)?n[i]=e(n[i],r):W_(r)?n[i]=e({},r):U_(r)?n[i]=r.slice():n[i]=r};for(let o=0,i=arguments.length;o<i;o++)arguments[o]&&eb(arguments[o],r);return n},extend:function(e,t,n){let{allOwnKeys:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return eb(t,((t,r)=>{n&&V_(t)?e[r]=N_(t,n):e[r]=t}),{allOwnKeys:r}),e},trim:e=>ny(e)?ny(e).call(e):e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let o,i,a;const s={};if(t=t||{},null==e)return t;do{for(o=Object.getOwnPropertyNames(e),i=o.length;i-- >0;)a=o[i],r&&!r(a,e,t)||s[a]||(t[a]=e[a],s[a]=!0);e=!1!==n&&P_(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:D_,kindOfTest:L_,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(U_(e))return e;let t=e.length;if(!H_(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:ab,hasOwnProperty:sb,hasOwnProp:sb,reduceDescriptors:lb,freezeMethods:e=>{lb(e,((t,n)=>{if(V_(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];V_(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach((e=>{n[e]=!0}))};return U_(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:tb,global:nb,isContextDefined:rb,ALPHABET:pb,generateString:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pb.ALPHA_DIGIT,n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function(e){return!!(e&&V_(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(G_(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const o=U_(e)?[]:{};return eb(e,((e,t)=>{const i=n(e,r+1);!j_(i)&&(o[t]=i)})),t[r]=void 0,o}}return e};return n(e,0)},isAsyncFn:hb,isThenable:e=>e&&(G_(e)||V_(e))&&V_(e.then)&&V_(e.catch),setImmediate:fb,asap:yb};function bb(e,t,n,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o,this.status=o.status?o.status:null)}_b.inherits(bb,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:_b.toJSONObject(this.config),code:this.code,status:this.status}}});const Tb=bb.prototype,Sb={};function Ob(e){return _b.isPlainObject(e)||_b.isArray(e)}function Rb(e){return _b.endsWith(e,"[]")?e.slice(0,-2):e}function Cb(e,t,n){return e?e.concat(t).map((function(e,t){return e=Rb(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{Sb[e]={value:e}})),Object.defineProperties(bb,Sb),Object.defineProperty(Tb,"isAxiosError",{value:!0}),bb.from=(e,t,n,r,o,i)=>{const a=Object.create(Tb);return _b.toFlatObject(e,a,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),bb.call(a,e.message,t,n,r,o),a.cause=e,a.name=e.name,i&&Object.assign(a,i),a};const wb=_b.toFlatObject(_b,{},null,(function(e){return/^is[A-Z]/.test(e)}));function Ib(e,t,n){if(!_b.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const o=(n=_b.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!_b.isUndefined(t[e])}))).metaTokens,i=n.visitor||u,a=n.dots,s=n.indexes,c=(n.Blob||"undefined"!=typeof Blob&&Blob)&&_b.isSpecCompliantForm(t);if(!_b.isFunction(i))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(_b.isDate(e))return e.toISOString();if(!c&&_b.isBlob(e))throw new bb("Blob is not supported. Use a Buffer instead.");return _b.isArrayBuffer(e)||_b.isTypedArray(e)?c&&"function"==typeof Blob?new Blob([e]):r.from(e):e}function u(e,n,r){let i=e;if(e&&!r&&"object"==typeof e)if(_b.endsWith(n,"{}"))n=o?n:n.slice(0,-2),e=JSON.stringify(e);else if(_b.isArray(e)&&function(e){return _b.isArray(e)&&!e.some(Ob)}(e)||(_b.isFileList(e)||_b.endsWith(n,"[]"))&&(i=_b.toArray(e)))return n=Rb(n),i.forEach((function(e,r){!_b.isUndefined(e)&&null!==e&&t.append(!0===s?Cb([n],r,a):null===s?n:n+"[]",l(e))})),!1;return!!Ob(e)||(t.append(Cb(r,n,a),l(e)),!1)}const d=[],p=Object.assign(wb,{defaultVisitor:u,convertValue:l,isVisitable:Ob});if(!_b.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!_b.isUndefined(n)){if(-1!==d.indexOf(n))throw Error("Circular reference detected in "+r.join("."));d.push(n),_b.forEach(n,(function(n,o){!0===(!(_b.isUndefined(n)||null===n)&&i.call(t,n,_b.isString(o)?ny(o).call(o):o,r,p))&&e(n,r?r.concat(o):[o])})),d.pop()}}(e),t}function Ab(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function Nb(e,t){this._pairs=[],e&&Ib(e,this,t)}const kb=Nb.prototype;function Pb(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Db(e,t,n){if(!t)return e;const r=n&&n.encode||Pb;_b.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let i;if(i=o?o(t,n):_b.isURLSearchParams(t)?t.toString():new Nb(t,n).toString(r),i){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}kb.append=function(e,t){this._pairs.push([e,t])},kb.toString=function(e){const t=e?function(t){return e.call(this,t,Ab)}:Ab;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};var Mb=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){_b.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},Lb={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},xb={exports:{}},Ub=Mn,jb=k,Fb=nn.f;Ub({target:"Object",stat:!0,forced:Object.defineProperty!==Fb,sham:!jb},{defineProperty:Fb});var Bb=ne.Object,Vb=xb.exports=function(e,t,n){return Bb.defineProperty(e,t,n)};Bb.defineProperty.sham&&(Vb.sham=!0);var Hb=i(xb.exports),Gb=TypeError,Wb=lo,qb=el,Kb=te,Yb=gt("species"),zb=Array,Xb=function(e){var t;return Wb(e)&&(t=e.constructor,(qb(t)&&(t===zb||Wb(t.prototype))||Kb(t)&&null===(t=t[Yb]))&&(t=void 0)),void 0===t?zb:t},Jb=function(e,t){return new(Xb(e))(0===t?0:t)},Zb=a,Qb=ge,$b=gt("species"),eT=function(e){return Qb>=51||!Zb((function(){var t=[];return(t.constructor={})[$b]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},tT=Mn,nT=a,rT=lo,oT=te,iT=et,aT=zn,sT=function(e){if(e>9007199254740991)throw Gb("Maximum allowed index exceeded");return e},cT=gm,lT=Jb,uT=eT,dT=ge,pT=gt("isConcatSpreadable"),hT=dT>=51||!nT((function(){var e=[];return e[pT]=!1,e.concat()[0]!==e})),fT=function(e){if(!oT(e))return!1;var t=e[pT];return void 0!==t?!!t:rT(e)};tT({target:"Array",proto:!0,arity:1,forced:!hT||!uT("concat")},{concat:function(e){var t,n,r,o,i,a=iT(this),s=lT(a,0),c=0;for(t=-1,r=arguments.length;t<r;t++)if(fT(i=-1===t?a:arguments[t]))for(o=aT(i),sT(c+o),n=0;n<o;n++,c++)n in i&&cT(s,c,i[n]);else sT(c+1),cT(s,c++,i);return s.length=c,s}});var mT={},vT=O,gT=$,ET=qo.f,yT=ll,_T="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];mT.f=function(e){return _T&&"Window"===vT(e)?function(e){try{return ET(e)}catch(e){return yT(_T)}}(e):ET(gT(e))};var bT={},TT=gt;bT.f=TT;var ST=ne,OT=rt,RT=bT,CT=nn.f,wT=function(e){var t=ST.Symbol||(ST.Symbol={});OT(t,e)||CT(t,e,{value:RT.f(e)})},IT=M,AT=se,NT=gt,kT=ws,PT=function(){var e=AT("Symbol"),t=e&&e.prototype,n=t&&t.valueOf,r=NT("toPrimitive");t&&!t[r]&&kT(t,r,(function(e){return IT(n,this)}),{arity:1})},DT=tn,MT=K,LT=et,xT=zn,UT=Jb,jT=p([].push),FT=function(e){var t=1===e,n=2===e,r=3===e,o=4===e,i=6===e,a=7===e,s=5===e||i;return function(c,l,u,d){for(var p,h,f=LT(c),m=MT(f),v=xT(m),g=DT(l,u),E=0,y=d||UT,_=t?y(c,v):n||a?y(c,0):void 0;v>E;E++)if((s||E in m)&&(h=g(p=m[E],E,f),e))if(t)_[E]=h;else if(h)switch(e){case 3:return!0;case 5:return p;case 6:return E;case 2:jT(_,p)}else switch(e){case 4:return!1;case 7:jT(_,p)}return i?-1:r||o?o:_}},BT={forEach:FT(0),map:FT(1),filter:FT(2),some:FT(3),every:FT(4),find:FT(5),findIndex:FT(6),filterReject:FT(7)},VT=Mn,HT=m,GT=M,WT=p,qT=k,KT=be,YT=a,zT=rt,XT=h,JT=cn,ZT=$,QT=wt,$T=Tr,eS=V,tS=ji,nS=vi,rS=qo,oS=mT,iS=ni,aS=N,sS=nn,cS=hi,lS=L,uS=ws,dS=Cc,pS=Ze,hS=Ko,fS=ct,mS=gt,vS=bT,gS=wT,ES=PT,yS=Ks,_S=ys,bS=BT.forEach,TS=Oo("hidden"),SS="Symbol",OS="prototype",RS=_S.set,CS=_S.getterFor(SS),wS=Object[OS],IS=HT.Symbol,AS=IS&&IS[OS],NS=HT.RangeError,kS=HT.TypeError,PS=HT.QObject,DS=aS.f,MS=sS.f,LS=oS.f,xS=lS.f,US=WT([].push),jS=pS("symbols"),FS=pS("op-symbols"),BS=pS("wks"),VS=!PS||!PS[OS]||!PS[OS].findChild,HS=function(e,t,n){var r=DS(wS,t);r&&delete wS[t],MS(e,t,n),r&&e!==wS&&MS(wS,t,r)},GS=qT&&YT((function(){return 7!==tS(MS({},"a",{get:function(){return MS(this,"a",{value:7}).a}})).a}))?HS:MS,WS=function(e,t){var n=jS[e]=tS(AS);return RS(n,{type:SS,tag:e,description:t}),qT||(n.description=t),n},qS=function(e,t,n){e===wS&&qS(FS,t,n),JT(e);var r=QT(t);return JT(n),zT(jS,r)?(n.enumerable?(zT(e,TS)&&e[TS][r]&&(e[TS][r]=!1),n=tS(n,{enumerable:eS(0,!1)})):(zT(e,TS)||MS(e,TS,eS(1,tS(null))),e[TS][r]=!0),GS(e,r,n)):MS(e,r,n)},KS=function(e,t){JT(e);var n=ZT(t),r=nS(n).concat(JS(n));return bS(r,(function(t){qT&&!GT(YS,n,t)||qS(e,t,n[t])})),e},YS=function(e){var t=QT(e),n=GT(xS,this,t);return!(this===wS&&zT(jS,t)&&!zT(FS,t))&&(!(n||!zT(this,t)||!zT(jS,t)||zT(this,TS)&&this[TS][t])||n)},zS=function(e,t){var n=ZT(e),r=QT(t);if(n!==wS||!zT(jS,r)||zT(FS,r)){var o=DS(n,r);return!o||!zT(jS,r)||zT(n,TS)&&n[TS][r]||(o.enumerable=!0),o}},XS=function(e){var t=LS(ZT(e)),n=[];return bS(t,(function(e){zT(jS,e)||zT(hS,e)||US(n,e)})),n},JS=function(e){var t=e===wS,n=LS(t?FS:ZT(e)),r=[];return bS(n,(function(e){!zT(jS,e)||t&&!zT(wS,e)||US(r,jS[e])})),r};KT||(IS=function(){if(XT(AS,this))throw new kS("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?$T(arguments[0]):void 0,t=fS(e),n=function(e){var r=void 0===this?HT:this;r===wS&&GT(n,FS,e),zT(r,TS)&&zT(r[TS],t)&&(r[TS][t]=!1);var o=eS(1,e);try{GS(r,t,o)}catch(e){if(!(e instanceof NS))throw e;HS(r,t,o)}};return qT&&VS&&GS(wS,t,{configurable:!0,set:n}),WS(t,e)},uS(AS=IS[OS],"toString",(function(){return CS(this).tag})),uS(IS,"withoutSetter",(function(e){return WS(fS(e),e)})),lS.f=YS,sS.f=qS,cS.f=KS,aS.f=zS,rS.f=oS.f=XS,iS.f=JS,vS.f=function(e){return WS(mS(e),e)},qT&&dS(AS,"description",{configurable:!0,get:function(){return CS(this).description}})),VT({global:!0,constructor:!0,wrap:!0,forced:!KT,sham:!KT},{Symbol:IS}),bS(nS(BS),(function(e){gS(e)})),VT({target:SS,stat:!0,forced:!KT},{useSetter:function(){VS=!0},useSimple:function(){VS=!1}}),VT({target:"Object",stat:!0,forced:!KT,sham:!qT},{create:function(e,t){return void 0===t?tS(e):KS(tS(e),t)},defineProperty:qS,defineProperties:KS,getOwnPropertyDescriptor:zS}),VT({target:"Object",stat:!0,forced:!KT},{getOwnPropertyNames:XS}),ES(),yS(IS,SS),hS[TS]=!0;var ZS=be&&!!Symbol.for&&!!Symbol.keyFor,QS=Mn,$S=se,eO=rt,tO=Tr,nO=Ze,rO=ZS,oO=nO("string-to-symbol-registry"),iO=nO("symbol-to-string-registry");QS({target:"Symbol",stat:!0,forced:!rO},{for:function(e){var t=tO(e);if(eO(oO,t))return oO[t];var n=$S("Symbol")(t);return oO[t]=n,iO[n]=t,n}});var aO=Mn,sO=rt,cO=we,lO=Ae,uO=ZS,dO=Ze("symbol-to-string-registry");aO({target:"Symbol",stat:!0,forced:!uO},{keyFor:function(e){if(!cO(e))throw new TypeError(lO(e)+" is not a symbol");if(sO(dO,e))return dO[e]}});var pO=lo,hO=A,fO=O,mO=Tr,vO=p([].push),gO=Mn,EO=se,yO=_,_O=M,bO=p,TO=a,SO=A,OO=we,RO=ll,CO=function(e){if(hO(e))return e;if(pO(e)){for(var t=e.length,n=[],r=0;r<t;r++){var o=e[r];"string"==typeof o?vO(n,o):"number"!=typeof o&&"Number"!==fO(o)&&"String"!==fO(o)||vO(n,mO(o))}var i=n.length,a=!0;return function(e,t){if(a)return a=!1,t;if(pO(this))return t;for(var r=0;r<i;r++)if(n[r]===e)return t}}},wO=be,IO=String,AO=EO("JSON","stringify"),NO=bO(/./.exec),kO=bO("".charAt),PO=bO("".charCodeAt),DO=bO("".replace),MO=bO(1..toString),LO=/[\uD800-\uDFFF]/g,xO=/^[\uD800-\uDBFF]$/,UO=/^[\uDC00-\uDFFF]$/,jO=!wO||TO((function(){var e=EO("Symbol")("stringify detection");return"[null]"!==AO([e])||"{}"!==AO({a:e})||"{}"!==AO(Object(e))})),FO=TO((function(){return'"\\udf06\\ud834"'!==AO("\udf06\ud834")||'"\\udead"'!==AO("\udead")})),BO=function(e,t){var n=RO(arguments),r=CO(t);if(SO(r)||void 0!==e&&!OO(e))return n[1]=function(e,t){if(SO(r)&&(t=_O(r,this,IO(e),t)),!OO(t))return t},yO(AO,null,n)},VO=function(e,t,n){var r=kO(n,t-1),o=kO(n,t+1);return NO(xO,e)&&!NO(UO,o)||NO(UO,e)&&!NO(xO,r)?"\\u"+MO(PO(e,0),16):e};AO&&gO({target:"JSON",stat:!0,arity:3,forced:jO||FO},{stringify:function(e,t,n){var r=RO(arguments),o=yO(jO?BO:AO,null,r);return FO&&"string"==typeof o?DO(o,LO,VO):o}});var HO=ni,GO=et;Mn({target:"Object",stat:!0,forced:!be||a((function(){HO.f(1)}))},{getOwnPropertySymbols:function(e){var t=HO.f;return t?t(GO(e)):[]}}),wT("asyncIterator"),wT("hasInstance"),wT("isConcatSpreadable"),wT("iterator"),wT("match"),wT("matchAll"),wT("replace"),wT("search"),wT("species"),wT("split");var WO=PT;wT("toPrimitive"),WO();var qO=se,KO=Ks;wT("toStringTag"),KO(qO("Symbol"),"Symbol"),wT("unscopables"),Ks(m.JSON,"JSON",!0);var YO=ne.Symbol,zO=gt,XO=nn.f,JO=zO("metadata"),ZO=Function.prototype;void 0===ZO[JO]&&XO(ZO,JO,{value:null}),wT("asyncDispose"),wT("dispose"),wT("metadata");var QO=YO,$O=p,eR=se("Symbol"),tR=eR.keyFor,nR=$O(eR.prototype.valueOf),rR=eR.isRegisteredSymbol||function(e){try{return void 0!==tR(nR(e))}catch(e){return!1}};Mn({target:"Symbol",stat:!0},{isRegisteredSymbol:rR});for(var oR=Ze,iR=se,aR=p,sR=we,cR=gt,lR=iR("Symbol"),uR=lR.isWellKnownSymbol,dR=iR("Object","getOwnPropertyNames"),pR=aR(lR.prototype.valueOf),hR=oR("wks"),fR=0,mR=dR(lR),vR=mR.length;fR<vR;fR++)try{var gR=mR[fR];sR(lR[gR])&&cR(gR)}catch(e){}var ER=function(e){if(uR&&uR(e))return!0;try{for(var t=pR(e),n=0,r=dR(hR),o=r.length;n<o;n++)if(hR[r[n]]==t)return!0}catch(e){}return!1};Mn({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:ER}),wT("customMatcher"),wT("observable"),Mn({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:rR}),Mn({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:ER}),wT("matcher"),wT("metadataKey"),wT("patternMatch"),wT("replaceAll");var yR=i(QO),_R=i(bT.f("iterator"));function bR(e){return bR="function"==typeof yR&&"symbol"==typeof _R?function(e){return typeof e}:function(e){return e&&"function"==typeof yR&&e.constructor===yR&&e!==yR.prototype?"symbol":typeof e},bR(e)}var TR=i(bT.f("toPrimitive"));function SR(e){var t=function(e,t){if("object"!==bR(e)||null===e)return e;var n=e[TR];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==bR(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===bR(t)?t:String(t)}function OR(e,t,n){return(t=SR(t))in e?Hb(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var RR=i(Qf),CR={isBrowser:!0,classes:{URLSearchParams:void 0!==RR?RR:Nb,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]};const wR="undefined"!=typeof window&&"undefined"!=typeof document,IR="object"==typeof navigator&&navigator||void 0,AR=wR&&(!IR||["ReactNative","NativeScript","NS"].indexOf(IR.product)<0),NR="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,kR=wR&&window.location.href||"http://localhost";function PR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function DR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?PR(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PR(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var MR=DR(DR({},Object.freeze({__proto__:null,hasBrowserEnv:wR,hasStandardBrowserEnv:AR,hasStandardBrowserWebWorkerEnv:NR,navigator:IR,origin:kR})),CR),LR=cn,xR=M,UR=rt,jR=h,FR=function(){var e=LR(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},BR=RegExp.prototype,VR=function(e){var t=e.flags;return void 0!==t||"flags"in BR||UR(e,"flags")||!jR(BR,e)?t:xR(FR,e)},HR=Gp.charAt,GR=M,WR=cn,qR=A,KR=O,YR=/./.exec,zR=TypeError,XR=Mn,JR=M,ZR=w,QR=$s,$R=vc,eC=J,tC=Kn,nC=Tr,rC=cn,oC=Y,iC=O,aC=cr,sC=VR,cC=xe,lC=a,uC=cl,dC=function(e,t,n){return t+(n?HR(e,t).length:1)},pC=function(e,t){var n=e.exec;if(qR(n)){var r=GR(n,e,t);return null!==r&&WR(r),r}if("RegExp"===KR(e))return GR(YR,e,t);throw new zR("RegExp#exec called on incompatible receiver")},hC=ys,fC=gt("matchAll"),mC="RegExp String",vC=mC+" Iterator",gC=hC.set,EC=hC.getterFor(vC),yC=TypeError,_C=ZR("".indexOf),bC=ZR("".matchAll),TC=!!bC&&!lC((function(){bC("a",/./)})),SC=QR((function(e,t,n,r){gC(this,{type:vC,regexp:e,string:t,global:n,unicode:r,done:!1})}),mC,(function(){var e=EC(this);if(e.done)return $R(void 0,!0);var t=e.regexp,n=e.string,r=pC(t,n);return null===r?(e.done=!0,$R(void 0,!0)):e.global?(""===nC(r[0])&&(t.lastIndex=dC(n,tC(t.lastIndex),e.unicode)),$R(r,!1)):(e.done=!0,$R(r,!1))})),OC=function(e){var t,n,r,o=rC(this),i=nC(e),a=uC(o,RegExp),s=nC(sC(o));return t=new a(a===RegExp?o.source:o,s),n=!!~_C(s,"g"),r=!!~_C(s,"u"),t.lastIndex=tC(o.lastIndex),new SC(t,i,n,r)};XR({target:"String",proto:!0,forced:TC},{matchAll:function(e){var t,n,r,o,i=eC(this);if(oC(e)){if(TC)return bC(i,e)}else{if(aC(e)&&(t=nC(eC(sC(e))),!~_C(t,"g")))throw new yC("`.matchAll` does not allow non-global regexes");if(TC)return bC(i,e);if(void 0===(r=cC(e,fC))&&"RegExp"===iC(e)&&(r=OC),r)return JR(r,e,i)}return n=nC(i),o=new RegExp(e,"g"),JR(OC,o,n)}});var RC=rr("String","matchAll"),CC=h,wC=RC,IC=String.prototype,AC=function(e){var t=e.matchAll;return"string"==typeof e||e===IC||CC(IC,e)&&t===IC.matchAll?wC:t},NC=i(AC);function kC(e){function t(e,n,r,o){let i=e[o++];if("__proto__"===i)return!0;const a=Number.isFinite(+i),s=o>=e.length;return i=!i&&_b.isArray(r)?r.length:i,s?(_b.hasOwnProp(r,i)?r[i]=[r[i],n]:r[i]=n,!a):(r[i]&&_b.isObject(r[i])||(r[i]=[]),t(e,n,r[i],o)&&_b.isArray(r[i])&&(r[i]=function(e){const t={},n=Object.keys(e);let r;const o=n.length;let i;for(r=0;r<o;r++)i=n[r],t[i]=e[i];return t}(r[i])),!a)}if(_b.isFormData(e)&&_b.isFunction(e.entries)){const n={};return _b.forEachEntry(e,((e,r)=>{t(function(e){return NC(_b).call(_b,/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),r,n,0)})),n}return null}const PC={transitional:Lb,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,o=_b.isObject(e);if(o&&_b.isHTMLForm(e)&&(e=new FormData(e)),_b.isFormData(e))return r?JSON.stringify(kC(e)):e;if(_b.isArrayBuffer(e)||_b.isBuffer(e)||_b.isStream(e)||_b.isFile(e)||_b.isBlob(e)||_b.isReadableStream(e))return e;if(_b.isArrayBufferView(e))return e.buffer;if(_b.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let i;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Ib(e,new MR.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return MR.isNode&&_b.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((i=_b.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Ib(i?{"files[]":e}:e,t&&new t,this.formSerializer)}}return o||r?(t.setContentType("application/json",!1),function(e,t,n){if(_b.isString(e))try{return(t||JSON.parse)(e),ny(_b).call(_b,e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||PC.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(_b.isResponse(e)||_b.isReadableStream(e))return e;if(e&&_b.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw bb.from(e,bb.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:MR.classes.FormData,Blob:MR.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};_b.forEach(["delete","get","head","post","put","patch"],(e=>{PC.headers[e]={}}));var DC=PC;const MC=_b.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),LC=Symbol("internals");function xC(e){var t;return e&&ny(t=String(e)).call(t).toLowerCase()}function UC(e){return!1===e||null==e?e:_b.isArray(e)?e.map(UC):String(e)}function jC(e,t,n,r,o){return _b.isFunction(r)?r.call(this,t,n):(o&&(t=n),_b.isString(t)?_b.isString(r)?-1!==t.indexOf(r):_b.isRegExp(r)?r.test(t):void 0:void 0)}class FC{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function o(e,t,n){const o=xC(t);if(!o)throw new Error("header name must be a non-empty string");const i=_b.findKey(r,o);(!i||void 0===r[i]||!0===n||void 0===n&&!1!==r[i])&&(r[i||t]=UC(e))}const i=(e,t)=>_b.forEach(e,((e,n)=>o(e,n,t)));if(_b.isPlainObject(e)||e instanceof this.constructor)i(e,t);else if(_b.isString(e)&&(e=ny(e).call(e))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(ny(a=e).call(a)))i((e=>{const t={};let n,r,o;return e&&e.split("\n").forEach((function(e){var i,a;o=e.indexOf(":"),n=ny(i=e.substring(0,o)).call(i).toLowerCase(),r=ny(a=e.substring(o+1)).call(a),!n||t[n]&&MC[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t})(e),t);else if(_b.isHeaders(e))for(const[s,c]of e.entries())o(c,s,n);else null!=e&&o(t,e,n);var a;return this}get(e,t){if(e=xC(e)){const n=_b.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(_b.isFunction(t))return t.call(this,e,n);if(_b.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=xC(e)){const n=_b.findKey(this,e);return!(!n||void 0===this[n]||t&&!jC(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function o(e){if(e=xC(e)){const o=_b.findKey(n,e);!o||t&&!jC(0,n[o],o,t)||(delete n[o],r=!0)}}return _b.isArray(e)?e.forEach(o):o(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const o=t[n];e&&!jC(0,this[o],o,e,!0)||(delete this[o],r=!0)}return r}normalize(e){const t=this,n={};return _b.forEach(this,((r,o)=>{var i;const a=_b.findKey(n,o);if(a)return t[a]=UC(r),void delete t[o];const s=e?function(e){return ny(e).call(e).toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(o):ny(i=String(o)).call(i);s!==o&&delete t[o],t[s]=UC(r),n[s]=!0})),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return _b.forEach(this,((n,r)=>{null!=n&&!1!==n&&(t[r]=e&&_b.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((e=>{let[t,n]=e;return t+": "+n})).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.forEach((e=>t.set(e))),t}static accessor(e){const t=(this[LC]=this[LC]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=xC(e);t[r]||(function(e,t){const n=_b.toCamelCase(" "+t);["get","set","has"].forEach((r=>{Object.defineProperty(e,r+n,{value:function(e,n,o){return this[r].call(this,t,e,n,o)},configurable:!0})}))}(n,e),t[r]=!0)}return _b.isArray(e)?e.forEach(r):r(e),this}}FC.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),_b.reduceDescriptors(FC.prototype,((e,t)=>{let{value:n}=e,r=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[r]=e}}})),_b.freezeMethods(FC);var BC=FC;function VC(e,t){const n=this||DC,r=t||n,o=BC.from(r.headers);let i=r.data;return _b.forEach(e,(function(e){i=e.call(n,i,o.normalize(),t?t.status:void 0)})),o.normalize(),i}function HC(e){return!(!e||!e.__CANCEL__)}function GC(e,t,n){bb.call(this,null==e?"canceled":e,bb.ERR_CANCELED,t,n),this.name="CanceledError"}function WC(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new bb("Request failed with status code "+n.status,[bb.ERR_BAD_REQUEST,bb.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}_b.inherits(GC,bb,{__CANCEL__:!0});const qC=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=0;const o=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let o,i=0,a=0;return t=void 0!==t?t:1e3,function(s){const c=Date.now(),l=r[a];o||(o=c),n[i]=s,r[i]=c;let u=a,d=0;for(;u!==i;)d+=n[u++],u%=e;if(i=(i+1)%e,i===a&&(a=(a+1)%e),c-o<t)return;const p=l&&c-l;return p?Math.round(1e3*d/p):void 0}}(50,250);return function(e,t){let n,r,o=0,i=1e3/t;const a=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();o=i,n=null,r&&(clearTimeout(r),r=null),e.apply(null,t)};return[function(){const e=Date.now(),t=e-o;for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];t>=i?a(c,e):(n=c,r||(r=setTimeout((()=>{r=null,a(n)}),i-t)))},()=>n&&a(n)]}((n=>{const i=n.loaded,a=n.lengthComputable?n.total:void 0,s=i-r,c=o(s);r=i,e({loaded:i,total:a,progress:a?i/a:void 0,bytes:s,rate:c||void 0,estimated:c&&a&&i<=a?(a-i)/c:void 0,event:n,lengthComputable:null!=a,[t?"download":"upload"]:!0})}),n)},KC=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},YC=e=>function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return _b.asap((()=>e(...n)))};var zC=MR.hasStandardBrowserEnv?((e,t)=>n=>(n=new qg(n,MR.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new qg(MR.origin),MR.navigator&&/(msie|trident)/i.test(MR.navigator.userAgent)):()=>!0,XC=MR.hasStandardBrowserEnv?{write(e,t,n,r,o,i){const a=[e+"="+encodeURIComponent(t)];_b.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),_b.isString(r)&&a.push("path="+r),_b.isString(o)&&a.push("domain="+o),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function JC(e,t){return e&&!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}function ZC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const QC=e=>e instanceof BC?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ZC(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e):e;function $C(e,t){t=t||{};const n={};function r(e,t,n,r){return _b.isPlainObject(e)&&_b.isPlainObject(t)?_b.merge.call({caseless:r},e,t):_b.isPlainObject(t)?_b.merge({},t):_b.isArray(t)?t.slice():t}function o(e,t,n,o){return _b.isUndefined(t)?_b.isUndefined(e)?void 0:r(void 0,e,0,o):r(e,t,0,o)}function i(e,t){if(!_b.isUndefined(t))return r(void 0,t)}function a(e,t){return _b.isUndefined(t)?_b.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,o,i){return i in t?r(n,o):i in e?r(void 0,n):void 0}const c={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(e,t,n)=>o(QC(e),QC(t),0,!0)};return _b.forEach(Object.keys(Object.assign({},e,t)),(function(r){const i=c[r]||o,a=i(e[r],t[r],r);_b.isUndefined(a)&&i!==s||(n[r]=a)})),n}var ew=e=>{const t=$C({},e);let n,{data:r,withXSRFToken:o,xsrfHeaderName:i,xsrfCookieName:a,headers:s,auth:c}=t;if(t.headers=s=BC.from(s),t.url=Db(JC(t.baseURL,t.url),e.params,e.paramsSerializer),c&&s.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),_b.isFormData(r))if(MR.hasStandardBrowserEnv||MR.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(!1!==(n=s.getContentType())){const[e,...t]=n?n.split(";").map((e=>ny(e).call(e))).filter(Boolean):[];s.setContentType([e||"multipart/form-data",...t].join("; "))}if(MR.hasStandardBrowserEnv&&(o&&_b.isFunction(o)&&(o=o(t)),o||!1!==o&&zC(t.url))){const e=i&&a&&XC.read(a);e&&s.set(i,e)}return t},tw="undefined"!=typeof XMLHttpRequest&&function(e){return new ih((function(t,n){const r=ew(e);let o=r.data;const i=BC.from(r.headers).normalize();let a,s,c,l,u,{responseType:d,onUploadProgress:p,onDownloadProgress:h}=r;function f(){l&&l(),u&&u(),r.cancelToken&&r.cancelToken.unsubscribe(a),r.signal&&r.signal.removeEventListener("abort",a)}let m=new XMLHttpRequest;function v(){if(!m)return;const r=BC.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());WC((function(e){t(e),f()}),(function(e){n(e),f()}),{data:d&&"text"!==d&&"json"!==d?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:r,config:e,request:m}),m=null}m.open(r.method.toUpperCase(),r.url,!0),m.timeout=r.timeout,"onloadend"in m?m.onloadend=v:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(v)},m.onabort=function(){m&&(n(new bb("Request aborted",bb.ECONNABORTED,e,m)),m=null)},m.onerror=function(){n(new bb("Network Error",bb.ERR_NETWORK,e,m)),m=null},m.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const o=r.transitional||Lb;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new bb(t,o.clarifyTimeoutError?bb.ETIMEDOUT:bb.ECONNABORTED,e,m)),m=null},void 0===o&&i.setContentType(null),"setRequestHeader"in m&&_b.forEach(i.toJSON(),(function(e,t){m.setRequestHeader(t,e)})),_b.isUndefined(r.withCredentials)||(m.withCredentials=!!r.withCredentials),d&&"json"!==d&&(m.responseType=r.responseType),h&&([c,u]=qC(h,!0),m.addEventListener("progress",c)),p&&m.upload&&([s,l]=qC(p),m.upload.addEventListener("progress",s),m.upload.addEventListener("loadend",l)),(r.cancelToken||r.signal)&&(a=t=>{m&&(n(!t||t.type?new GC(null,e,m):t),m.abort(),m=null)},r.cancelToken&&r.cancelToken.subscribe(a),r.signal&&(r.signal.aborted?a():r.signal.addEventListener("abort",a)));const g=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);g&&-1===MR.protocols.indexOf(g)?n(new bb("Unsupported protocol "+g+":",bb.ERR_BAD_REQUEST,e)):m.send(o||null)}))},nw=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const o=function(e){if(!n){n=!0,a();const t=e instanceof Error?e:this.reason;r.abort(t instanceof bb?t:new GC(t instanceof Error?t.message:t))}};let i=t&&setTimeout((()=>{i=null,o(new bb("timeout ".concat(t," of ms exceeded"),bb.ETIMEDOUT))}),t);const a=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(o):e.removeEventListener("abort",o)})),e=null)};e.forEach((e=>e.addEventListener("abort",o)));const{signal:s}=r;return s.unsubscribe=()=>_b.asap(a),s}},rw=i(oh),ow=bT.f("asyncIterator"),iw=i(ow);function aw(e,t){this.v=e,this.k=t}function sw(e){var t,n;function r(t,n){try{var i=e[t](n),a=i.value,s=a instanceof aw;rw.resolve(s?a.v:a).then((function(n){if(s){var c="return"===t?"return":"next";if(!a.k||n.done)return r(c,n);n=e[c](n).value}o(i.done?"return":"normal",n)}),(function(e){r("throw",e)}))}catch(e){o("throw",e)}}function o(e,o){switch(e){case"return":t.resolve({value:o,done:!0});break;case"throw":t.reject(o);break;default:t.resolve({value:o,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,o){return new rw((function(i,a){var s={key:e,arg:o,resolve:i,reject:a,next:null};n?n=n.next=s:(t=n=s,r(e,o))}))},"function"!=typeof e.return&&(this.return=void 0)}function cw(e){return function(){return new sw(e.apply(this,arguments))}}function lw(e){return new aw(e,0)}function uw(e){var t={},n=!1;function r(t,r){return n=!0,{done:!1,value:new aw(r=new rw((function(n){n(e[t](r))})),1)}}return t[void 0!==yR&&_R||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):r("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return r("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):r("return",e)}),t}sw.prototype["function"==typeof yR&&iw||"@@asyncIterator"]=function(){return this},sw.prototype.next=function(e){return this._invoke("next",e)},sw.prototype.throw=function(e){return this._invoke("throw",e)},sw.prototype.return=function(e){return this._invoke("return",e)};var dw=i(ow);function pw(e){var t,n,r,o=2;for("undefined"!=typeof Symbol&&(n=dw,r=Symbol.iterator);o--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new hw(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function hw(e){function t(e){if(Object(e)!==e)return ih.reject(new TypeError(e+" is not an object."));var t=e.done;return ih.resolve(e.value).then((function(e){return{value:e,done:t}}))}return hw=function(e){this.s=e,this.n=e.next},hw.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?ih.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?ih.reject(e):t(n.apply(this.s,arguments))}},new hw(e)}const fw=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let r,o=0;for(;o<n;)r=o+t,yield e.slice(o,r),o=r},mw=function(){var e=cw((function*(e,t){var n,r=!1,o=!1;try{for(var i,a=pw(vw(e));r=!(i=yield lw(a.next())).done;r=!1){const e=i.value;yield*uw(pw(fw(e,t)))}}catch(e){o=!0,n=e}finally{try{r&&null!=a.return&&(yield lw(a.return()))}finally{if(o)throw n}}}));return function(t,n){return e.apply(this,arguments)}}(),vw=function(){var e=cw((function*(e){if(e[dw])return void(yield*uw(pw(e)));const t=e.getReader();try{for(;;){const{done:e,value:n}=yield lw(t.read());if(e)break;yield n}}finally{yield lw(t.cancel())}}));return function(t){return e.apply(this,arguments)}}(),gw=(e,t,n,r)=>{const o=mw(e,t);let i,a=0,s=e=>{i||(i=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await o.next();if(t)return s(),void e.close();let i=r.byteLength;if(n){let e=a+=i;n(e)}e.enqueue(new Uint8Array(r))}catch(e){throw s(e),e}},cancel:e=>(s(e),o.return())},{highWaterMark:2})};function Ew(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ew(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ew(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const _w="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,bw=_w&&"function"==typeof ReadableStream,Tw=_w&&("function"==typeof TextEncoder?(Sw=new TextEncoder,e=>Sw.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var Sw;const Ow=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!!e(...n)}catch(e){return!1}},Rw=bw&&Ow((()=>{let e=!1;const t=new Request(MR.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),Cw=bw&&Ow((()=>_b.isReadableStream(new Response("").body))),ww={stream:Cw&&(e=>e.body)};var Iw;_w&&(Iw=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!ww[e]&&(ww[e]=_b.isFunction(Iw[e])?t=>t[e]():(t,n)=>{throw new bb("Response type '".concat(e,"' is not supported"),bb.ERR_NOT_SUPPORT,n)})})));const Aw=async(e,t)=>{const n=_b.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(_b.isBlob(e))return e.size;if(_b.isSpecCompliantForm(e)){const t=new Request(MR.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return _b.isArrayBufferView(e)||_b.isArrayBuffer(e)?e.byteLength:(_b.isURLSearchParams(e)&&(e+=""),_b.isString(e)?(await Tw(e)).byteLength:void 0)})(t):n};var Nw=_w&&(async e=>{let{url:t,method:n,data:r,signal:o,cancelToken:i,timeout:a,onDownloadProgress:s,onUploadProgress:c,responseType:l,headers:u,withCredentials:d="same-origin",fetchOptions:p}=ew(e);l=l?(l+"").toLowerCase():"text";let h,f=nw([o,i&&i.toAbortSignal()],a);const m=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let v;try{if(c&&Rw&&"get"!==n&&"head"!==n&&0!==(v=await Aw(u,r))){let e,n=new Request(t,{method:"POST",body:r,duplex:"half"});if(_b.isFormData(r)&&(e=n.headers.get("content-type"))&&u.setContentType(e),n.body){const[e,t]=KC(v,qC(YC(c)));r=gw(n.body,65536,e,t)}}_b.isString(d)||(d=d?"include":"omit");const o="credentials"in Request.prototype;h=new Request(t,yw(yw({},p),{},{signal:f,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:o?d:void 0}));let i=await fetch(h);const a=Cw&&("stream"===l||"response"===l);if(Cw&&(s||a&&m)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=i[t]}));const t=_b.toFiniteNumber(i.headers.get("content-length")),[n,r]=s&&KC(t,qC(YC(s),!0))||[];i=new Response(gw(i.body,65536,n,(()=>{r&&r(),m&&m()})),e)}l=l||"text";let g=await ww[_b.findKey(ww,l)||"text"](i,e);return!a&&m&&m(),await new ih(((t,n)=>{WC(t,n,{data:g,headers:BC.from(i.headers),status:i.status,statusText:i.statusText,config:e,request:h})}))}catch(t){if(m&&m(),t&&"TypeError"===t.name&&/fetch/i.test(t.message))throw Object.assign(new bb("Network Error",bb.ERR_NETWORK,e,h),{cause:t.cause||t});throw bb.from(t,t&&t.code,e,h)}});const kw={http:null,xhr:tw,fetch:Nw};_b.forEach(kw,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));const Pw=e=>"- ".concat(e),Dw=e=>_b.isFunction(e)||null===e||!1===e;var Mw=e=>{e=_b.isArray(e)?e:[e];const{length:t}=e;let n,r;const o={};for(let i=0;i<t;i++){let t;if(n=e[i],r=n,!Dw(n)&&(r=kw[(t=String(n)).toLowerCase()],void 0===r))throw new bb("Unknown adapter '".concat(t,"'"));if(r)break;o[t||"#"+i]=r}if(!r){const e=Object.entries(o).map((e=>{let[t,n]=e;return"adapter ".concat(t," ")+(!1===n?"is not supported by the environment":"is not available in the build")}));throw new bb("There is no suitable adapter to dispatch the request "+(t?e.length>1?"since :\n"+e.map(Pw).join("\n"):" "+Pw(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return r};function Lw(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new GC(null,e)}function xw(e){return Lw(e),e.headers=BC.from(e.headers),e.data=VC.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Mw(e.adapter||DC.adapter)(e).then((function(t){return Lw(e),t.data=VC.call(e,e.transformResponse,t),t.headers=BC.from(t.headers),t}),(function(t){return HC(t)||(Lw(e),t&&t.response&&(t.response.data=VC.call(e,e.transformResponse,t.response),t.response.headers=BC.from(t.response.headers))),ih.reject(t)}))}const Uw="1.7.9",jw={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{jw[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const Fw={};jw.transitional=function(e,t,n){function r(e,t){return"[Axios v1.7.9] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,o,i)=>{if(!1===e)throw new bb(r(o," has been removed"+(t?" in "+t:"")),bb.ERR_DEPRECATED);return t&&!Fw[o]&&(Fw[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,o,i)}},jw.spelling=function(e){return(t,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(e)),!0)};var Bw={assertOptions:function(e,t,n){if("object"!=typeof e)throw new bb("options must be an object",bb.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let o=r.length;for(;o-- >0;){const i=r[o],a=t[i];if(a){const t=e[i],n=void 0===t||a(t,i,e);if(!0!==n)throw new bb("option "+i+" must be "+n,bb.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new bb("Unknown option "+i,bb.ERR_BAD_OPTION)}},validators:jw};const Vw=Bw.validators;let Hw=class{constructor(e){this.defaults=e,this.interceptors={request:new Mb,response:new Mb}}async request(e,t){try{return await this._request(e,t)}catch(e){if(e instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const n=t.stack?t.stack.replace(/^.+\n/,""):"";try{e.stack?n&&!String(e.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+n):e.stack=n}catch(e){}}throw e}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=$C(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:o}=t;void 0!==n&&Bw.assertOptions(n,{silentJSONParsing:Vw.transitional(Vw.boolean),forcedJSONParsing:Vw.transitional(Vw.boolean),clarifyTimeoutError:Vw.transitional(Vw.boolean)},!1),null!=r&&(_b.isFunction(r)?t.paramsSerializer={serialize:r}:Bw.assertOptions(r,{encode:Vw.function,serialize:Vw.function},!0)),Bw.assertOptions(t,{baseUrl:Vw.spelling("baseURL"),withXsrfToken:Vw.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let i=o&&_b.merge(o.common,o[t.method]);o&&_b.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete o[e]})),t.headers=BC.concat(i,o);const a=[];let s=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,a.unshift(e.fulfilled,e.rejected))}));const c=[];let l;this.interceptors.response.forEach((function(e){c.push(e.fulfilled,e.rejected)}));let u,d=0;if(!s){const e=[xw.bind(this),void 0];for(e.unshift.apply(e,a),e.push.apply(e,c),u=e.length,l=ih.resolve(t);d<u;)l=l.then(e[d++],e[d++]);return l}u=a.length;let p=t;for(d=0;d<u;){const t=a[d++],n=a[d++];try{p=t(p)}catch(e){n.call(this,e);break}}try{l=xw.call(this,p)}catch(e){return ih.reject(e)}for(d=0,u=c.length;d<u;)l=l.then(c[d++],c[d++]);return l}getUri(e){return Db(JC((e=$C(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}};_b.forEach(["delete","get","head","options"],(function(e){Hw.prototype[e]=function(t,n){return this.request($C(n||{},{method:e,url:t,data:(n||{}).data}))}})),_b.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,o){return this.request($C(o||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Hw.prototype[e]=t(),Hw.prototype[e+"Form"]=t(!0)}));var Gw=Hw;class Ww{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new ih((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const r=new ih((e=>{n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e,r,o){n.reason||(n.reason=new GC(e,r,o),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Ww((function(t){e=t})),cancel:e}}}var qw=Ww;const Kw={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Kw).forEach((e=>{let[t,n]=e;Kw[n]=t}));var Yw=Kw;const zw=function e(t){const n=new Gw(t),r=N_(Gw.prototype.request,n);return _b.extend(r,Gw.prototype,n,{allOwnKeys:!0}),_b.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e($C(t,n))},r}(DC);zw.Axios=Gw,zw.CanceledError=GC,zw.CancelToken=qw,zw.isCancel=HC,zw.VERSION=Uw,zw.toFormData=Ib,zw.AxiosError=bb,zw.Cancel=zw.CanceledError,zw.all=function(e){return ih.all(e)},zw.spread=function(e){return function(t){return e.apply(null,t)}},zw.isAxiosError=function(e){return _b.isObject(e)&&!0===e.isAxiosError},zw.mergeConfig=$C,zw.AxiosHeaders=BC,zw.formToJSON=e=>kC(_b.isHTMLForm(e)?new FormData(e):e),zw.getAdapter=Mw,zw.HttpStatusCode=Yw,zw.default=zw;var Xw=zw;const Jw=()=>{};function Zw(){const e={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:Jw};return e.promise=new ih(((t,n)=>{e.resolve=n=>{e.isFinished||(e.isResolved=!0,e.isFinished=!0,t(n),e.value=n)},e.reject=t=>{e.isFinished||(e.isRejected=!0,e.isFinished=!0,n(t))}})),e}const Qw=new Map,$w=new Map,eI=new Map;let tI=function(e){return e.WIN_10="Windows 10",e.WIN_81="Windows 8.1",e.WIN_8="Windows 8",e.WIN_7="Windows 7",e.WIN_VISTA="Windows Vista",e.WIN_SERVER_2003="Windows Server 2003",e.WIN_XP="Windows XP",e.WIN_2000="Windows 2000",e.ANDROID="Android",e.HARMONY_OS="HarmonyOS",e.OPEN_BSD="Open BSD",e.SUN_OS="Sun OS",e.LINUX="Linux",e.IOS="iOS",e.MAC_OS="Mac OS",e.CHROMIUM_OS="Chromium OS",e.QNX="QNX",e.UNIX="UNIX",e.BEOS="BeOS",e.OS_2="OS/2",e.SEARCH_BOT="Search Bot",e}({}),nI=function(e){return e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger",e}({});const rI=new $y;let oI=rI.getResult(),iI=null;function aI(e){if(!iI){e&&rI.setUA(e),oI=rI.getResult();const t=function(e){if("Blink"===e.engine.name&&"WeChat"!==e.browser.name)return nI.CHROME;switch(e.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return nI.CHROME;case"Safari":case"Mobile Safari":return nI.SAFARI;case"Edge":return nI.EDGE;case"Firefox":return nI.FIREFOX;case"QQ":case"QQBrowser":return nI.QQ;case"Opera":return nI.OPERA;case"WeChat":return nI.WECHAT;default:return e.browser.name||""}}(oI),n=sI(oI),r=function(e){return"Windows"===e.os.name?e.os.version?e.os.name+" "+e.os.version:e.os.name:e.os.name||""}(oI),o=oI.os.version,i=sI(oI,!1),a=oI.device.type;if(!(t&&n&&r&&o))return{name:t,version:n,os:r,osVersion:o,browserVersion:i,deviceType:a};iI={name:t,version:n,os:r,osVersion:o,browserVersion:i,deviceType:a}}return iI}function sI(e){let t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t="Blink"===e.engine.name?e.engine.version||"":e.browser.version||"",n?t.split(".")[0]:t}function cI(){return aI().os}function lI(){const e=aI();return"".concat(e.os," ").concat(e.osVersion)}function uI(){const e=aI();return!!("WebKit"===oI.engine.name&&e.os===tI.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&e.name!==nI.SAFARI||mI()&&e.name!==nI.SAFARI)}function dI(){return aI().name===nI.CHROME}function pI(){return aI().name===nI.SAFARI}function hI(){return aI().name===nI.EDGE}function fI(){return aI().name===nI.FIREFOX}function mI(){return aI().os===tI.IOS}function vI(e){const t=aI();return!(t.name!==nI.CHROME||!t.osVersion)&&Number(t.version)>=e}function gI(e){const t=aI();return!(t.name!==nI.CHROME||!t.osVersion)&&Number(t.version)<e}function EI(e,t,n){const r=aI();return!(r.name!==e||!r.osVersion)&&(n?Number(r.version)>=t&&Number(r.version)<=n:Number(r.version)===t)}function yI(e){const t=aI();return!(t.name!==nI.EDGE||!t.osVersion)&&Number(t.version)>=e}function _I(e){const t=aI();return!(t.name!==nI.SAFARI||!t.osVersion)&&Number(t.version)>=e}function bI(e,t,n){const r=aI();if(r.os!==tI.IOS||!r.osVersion)return!1;const o=r.osVersion.split(".");return n?t&&Number(o[0])===e&&Number(o[1])<t||Number(o[0])<e:t?Number(o[0])===e&&Number(o[1])<=t||Number(o[0])<e:Number(o[0])<=e}function TI(e,t,n){const r=aI();if(r.name!==nI.SAFARI||!r.osVersion||!r.browserVersion)return!1;const o=r.browserVersion.split(".");return n?t&&Number(o[0])===e&&Number(o[1])<t||Number(o[0])<e:t?Number(o[0])===e&&Number(o[1])<=t||Number(o[0])<e:Number(o[0])<=e}function SI(e){const t=aI();return!(t.name!==nI.OPERA||!t.osVersion)&&Number(t.version)>=e}function OI(){const e=aI();if(e.os!==tI.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return Number(t[0])<14||14===Number(t[0])&&Number(t[1])<=6}function RI(){const e=aI();if(e.os!==tI.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])}function CI(){const e=aI();if(e.os!==tI.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 16===Number(t[0])}function wI(){const e=aI();if(e.os!==tI.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])&&Number(t[1])>=1}function II(){return pI()&&navigator.maxTouchPoints>0}function AI(){return aI().name===nI.WECHAT}function NI(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function kI(){const e=cI();return function(){const{deviceType:e}=aI();return"mobile"===e||"tablet"===e}()||e===tI.ANDROID||e===tI.IOS||e===tI.HARMONY_OS}function PI(){const e=aI();return e.name!==nI.EDGE&&e.name!==nI.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function DI(){return cI()===tI.ANDROID}function MI(){const e=aI();return DI()&&(e.name===nI.CHROME||e.name===nI.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function LI(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function UI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xI(Object(n),!0).forEach((function(t){LI(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xI(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let jI=function(e){return e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",e.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",e.DATACHANNEL_FAILED="DATACHANNEL_FAILED",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",e.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",e.TOKEN_EXPIRE="TOKEN_EXPIRE",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",e.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",e.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",e.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",e.INVALID_PLUGIN="INVALID_PLUGIN",e.DISCONNECT_P2P="DISCONNECT_P2P",e.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",e.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",e.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",e.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",e.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",e.PROHIBITED_OPERATION="PROHIBITED_OPERATION",e.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",e.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",e}({});class FI extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;super(t),LI(this,"code",void 0),LI(this,"message",void 0),LI(this,"data",void 0),LI(this,"name","AgoraRTCException"),this.code=e,this.message="AgoraRTCError ".concat(this.code,": ").concat(t),this.data=n}toString(){return this.data?"".concat(this.message,"\ndata: ").concat(JSON.stringify(this.data)):this.message}print(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error",t=arguments.length>1?arguments[1]:void 0;return"error"===e&&(t||console).error(this.toString()),"warning"===e&&(t||console).warn(this.toString()),this}throw(e){throw this.print("error",e),this}}function BI(e,t){if("boolean"!=typeof e)throw new FI(jI.INVALID_PARAMS,"Invalid ".concat(t,": The value is of the boolean type."))}function VI(e,t,n){if(!Ur(n).call(n,e))throw new FI(jI.INVALID_PARAMS,"".concat(t," can only be set as ").concat(JSON.stringify(n)))}function HI(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;if(e<n||e>r||(!(arguments.length>4&&void 0!==arguments[4])||arguments[4])&&!function(e){return"number"==typeof e&&e%1==0}(e))throw new FI(jI.INVALID_PARAMS,"invalid ".concat(t,": the value range is [").concat(n,", ").concat(r,"]. integer only"))}function GI(e,t){if("number"!=typeof e){if(!(e.min||e.max||e.ideal||e.exact))throw new FI(jI.INVALID_PARAMS,"".concat(t," is not a valid ConstrainLong"));void 0!==e.min&&HI(e.min,"".concat(t,".min"),0,1/0),void 0!==e.max&&HI(e.max,"".concat(t,".max"),1,1/0),void 0!==e.exact&&HI(e.exact,"".concat(t,".exact"),1,1/0),void 0!==e.ideal&&HI(e.ideal,"".concat(t,".ideal"),1,1/0)}else HI(e,t,1,1/0)}function WI(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(null==e)throw new FI(jI.INVALID_PARAMS,"".concat(t||"param"," cannot be empty"));if(!YI(e,n,r,o))throw new FI(jI.INVALID_PARAMS,"Invalid ".concat(t||"string param",": Length of the string: [").concat(n,",").concat(r,"].").concat(o?" ASCII characters only.":""))}function qI(e,t){if(!Array.isArray(e))throw new FI(jI.INVALID_PARAMS,"".concat(t," should be an array"))}function KI(e){return null==e}function YI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:255,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return"string"==typeof e&&e.length<=n&&e.length>=t&&(!r||function(e){if("string"!=typeof e)return!1;for(let t=0;t<e.length;t+=1){const n=e.charCodeAt(t);if(n<0||n>255)return!1}return!0}(e))}var zI=function(e){return e.COVERED="COVERED",e.POSITION="POSITION",e.SIZE="SIZE",e.STYLE="STYLE",e}(zI||{}),XI=function(e){return e.UNMOUNTED="UNMOUNTED",e.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",e}(XI||{});const JI=new class{constructor(){LI(this,"_clientSize",null),LI(this,"getClientWidth",(()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth)),LI(this,"getClientHeight",(()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight)),LI(this,"getStyle",(e=>window.getComputedStyle(e,null))),LI(this,"checkCssVisibleProperty",(e=>{var t;let n=!0;const r=this.getStyle(e),{display:o,visibility:i,opacity:a,filter:s}=r;return("none"===o||Ur(t=["hidden","collapse"]).call(t,i)||Number(a)<.1)&&(n=!1),!!n&&(s&&s.split(" ").filter((e=>{var t;const n=e.split("(")[0];return Ur(t=["brightness","blur","opacity"]).call(t,n)})).map((e=>{const[t,n]=e.split(/\(|\)/);return[t,Number(n.match(/^[0-9\.]+/))]})).forEach((e=>{const[t,r]=e;switch(t){case"brightness":(r<.1||r>3)&&(n=!1);break;case"blur":r>3&&(n=!1);break;case"opacity":r<.1&&(n=!1)}})),n)})),LI(this,"checkPropertyUpToAllParentNodes",((e,t)=>{let n=!0,r=!0;const o=e=>t(e);let i=e;for(;i&&r;)o(i)||(n=!1,r=!1),i=i.parentElement,i||(r=!1);return n})),LI(this,"checkActualCssVisibleIncludeInherit",(e=>this.checkPropertyUpToAllParentNodes(e,this.checkCssVisibleProperty))),LI(this,"getSizeAboutClient",(e=>{const{width:t,height:n,left:r,right:o,top:i,bottom:a}=e.getBoundingClientRect(),s=this.getClientWidth(),c=this.getClientHeight();return{width:t,height:n,left:r,right:o,top:i,bottom:a,clientWidth:s,clientHeight:c,clientMin:Math.min(s,c)}})),LI(this,"checkActualSize",(()=>{const{width:e,height:t,clientMin:n}=this._clientSize;return this.checkSizeIsVisible(e,t,n)})),LI(this,"elementFromPoint",((e,t)=>document.elementFromPoint?document.elementFromPoint(e,t):null)),LI(this,"checkCoverForAPoint",((e,t,n)=>{const r=this.elementFromPoint(e,t);return null!==r&&r!==n})),LI(this,"getPointPositionList",(()=>{const{width:e,height:t,left:n,top:r}=this._clientSize,o=e/6,i=t/6,a=[],s=10**6;for(let c=0;c<5;c++)for(let e=0;e<5;e++){const t=(n*s+(0===c?.1:4===c?(o*c*s-1e5)/s:o*c)*s)/s,l=(r*s+(0===e?.1:4===e?(i*e*s-1e5)/s:i*e)*s)/s;a.push({x:t,y:l})}return[...a]})),LI(this,"checkElementCover",(e=>this.getPointPositionList().map((t=>this.checkCoverForAPoint(t.x,t.y,e))).filter((e=>!!e)).length>6)),LI(this,"checkSizeIsVisible",((e,t,n)=>(e>50||n/e<=10)&&(t>50||n/t<=10))),LI(this,"checkSizeOfPartInClient",(()=>{const{left:e,right:t,top:n,bottom:r,clientHeight:o,clientWidth:i,clientMin:a}=this._clientSize;let s,c,l,u;if(e<0)s=0;else{if(!(e<i))return!1;s=e}if(t<0)return!1;if(c=t<i?t:i,n<0)l=0;else{if(!(n<o))return!1;l=n}if(r<0)return!1;u=r<o?r:o;const d=c-s,p=u-l;return this.checkSizeIsVisible(d,p,a)})),LI(this,"returnHiddenResult",(e=>(this._clientSize=null,{visible:!1,reason:e}))),LI(this,"checkOneElementVisible",(e=>{if(e instanceof HTMLElement){if(this.checkElementIsMountedOnDom(e)){if(this.checkActualCssVisibleIncludeInherit(e)){if(this._clientSize=this.getSizeAboutClient(e),this.checkElementCover(e))return this.returnHiddenResult(zI.COVERED);{const e=this.checkActualSize(),t=this.checkSizeOfPartInClient();return e&&!t?this.returnHiddenResult(zI.POSITION):e?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(zI.SIZE)}}return this.returnHiddenResult(zI.STYLE)}return this.returnHiddenResult(XI.UNMOUNTED)}return this.returnHiddenResult(XI.INVALID_HTML_ELEMENT)})),LI(this,"checkElementIsMountedOnDom",(e=>this.checkPropertyUpToAllParentNodes(e,(e=>"HTML"!==e.nodeName.toUpperCase()?null!==e.parentElement:!!document.documentElement))))}};function ZI(e){return(new TextEncoder).encode(e)}const QI=function(e,t){const n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n},$I=async e=>function(e,t){let n="";return new Uint8Array(e).forEach((e=>{n+=e.toString(t).padStart(2,"0")})),n}(await crypto.subtle.digest("SHA-256",ZI(e)),16);let eA=class{constructor(){LI(this,"_events",{}),LI(this,"addListener",this.on)}getListeners(e){return this._events[e]?this._events[e].map((e=>e.listener)):[]}on(e,t){this._events[e]||(this._events[e]=[]);const n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!1})}once(e,t){this._events[e]||(this._events[e]=[]);const n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!0})}off(e,t){if(!this._events[e])return;const n=this._events[e],r=this._indexOfListener(n,t);-1!==r&&n.splice(r,1),0===this._events[e].length&&delete this._events[e]}removeAllListeners(e){e?delete this._events[e]:this._events={}}emit(e){this._events[e]||(this._events[e]=[]);const t=this._events[e].map((e=>e));for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];for(let i=0;i<t.length;i+=1){const n=t[i];n.once&&this.off(e,n.listener),n.listener.apply(this,r||[])}}safeEmit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];[...this._events[e]||[]].forEach((t=>{t.once&&this.off(e,t.listener);try{t.listener.apply(this,n)}catch(t){console.error("safeEmit event:".concat(e," error ").concat(null==t?void 0:t.toString()))}}))}_indexOfListener(e,t){let n=e.length;for(;n--;)if(e[n].listener===t)return n;return-1}},tA=null;function nA(){if(tA)return tA;if(window.electron)return tA=window.electron;if(!window.require)return null;try{return tA=window.require("electron"),tA}catch(e){return null}}let rA=function(e){return e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.SET_AREA="setArea",e.PRELOAD="PRELOAD",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.MASS_SUBSCRIBE="Client.massSubscribe",e.MASS_UNSUBSCRIBE="Client.massUnsubscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",e.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",e.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",e.STREAM_TYPE_CHANGE="streamTypeChange",e.CONNECTION_STATE_CHANGE="connectionStateChange",e.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",e.IMAGE_MODERATION_UPLOAD="imageModerationUpload",e.REPUB_AFTER_PC_CONNECTED="repubAfterPCConnected",e}({}),oA=function(e){return e.TRACER="tracer",e}({});function iA(e){return HI(e.timeout,"config.timeout",0,1e5),HI(e.timeoutFactor,"config.timeoutFactor",0,100,!1),HI(e.maxRetryCount,"config.maxRetryConfig",0,1/0),HI(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}let aA=function(e){return e[e.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",e[e.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",e[e.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",e}({}),sA=function(e){return e.LEAVE="LEAVE",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.UID_BANNED="UID_BANNED",e.FALLBACK="FALLBACK",e.IP_BANNED="IP_BANNED",e.CHANNEL_BANNED="CHANNEL_BANNED",e.LICENSE_MISSING="LICENSE_MISSING",e.LICENSE_EXPIRED="LICENSE_EXPIRED",e.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",e.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",e.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",e.LICENSE_ILLEGAL="LICENSE_ILLEGAL",e.TOKEN_EXPIRE="TOKEN_EXPIRE",e}({});function cA(e){if(!Array.isArray(e)||e.length<1)return!1;try{e.forEach((e=>{if(!e.urls)throw Error()}))}catch(e){return!1}return!0}function lA(e){return WI(e.turnServerURL,"turnServerURL"),WI(e.username,"username"),WI(e.password,"password"),e.udpport&&HI(e.udpport,"udpport",1,99999,!0),e.forceturn&&BI(e.forceturn,"forceturn"),e.security&&BI(e.security,"security"),e.tcpport&&HI(e.tcpport,"tcpport",1,99999,!0),!0}function uA(e){return void 0!==e.level&&VI(e.level,"level",[1,2,3]),void 0!==e.delay&&HI(e.delay,"delay",0,3e3,!0),!0}let dA=function(e){return e.PEERCONNECTION_STATE_CHANGE="peerconnection-state-change",e.AUDIO_METADATA="audio-metadata",e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.EXCEPTION="exception",e.ERROR="error",e.P2P_LOST="p2p_lost",e.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",e.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",e.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",e.PUBLISHED_USER_LIST="published-user-list",e.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",e.CONTENT_INSPECT_ERROR="content-inspect-error",e.CONTENT_INSPECT_RESULT="content-inspect-result",e.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",e}({}),pA=function(e){return e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED",e.FALLBACK="FALLBACK",e.REGIONAL_DISTRIBUTION="REGIONAL_DISTRIBUTION",e}({}),hA=function(e){return e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({}),fA=function(e){return e.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({});function mA(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return 0===e.getListeners(t).length?ih.reject(new FI(jI.UNEXPECTED_ERROR,"can not emit promise")):new ih(((n,o)=>{e.emit(t,...r,n,o)}))}function vA(e,t){if(0===e.getListeners(t).length)return ih.resolve();for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return mA(e,t,...r)}function gA(e,t){if(0===e.getListeners(t).length)return null;for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return EA(e,t,...r)}function EA(e,t){let n=null,r=null;for(var o=arguments.length,i=new Array(o>2?o-2:0),a=2;a<o;a++)i[a-2]=arguments[a];if(e.emit(t,...i,(e=>{n=e}),(e=>{r=e})),null!==r)throw r;if(null===n)throw new FI(jI.UNEXPECTED_ERROR,"handler is not sync");return n}const yA=new class extends eA{set networkState(e){this.emit(fA.NETWORK_STATE_CHANGE,e,this._networkState),e===hA.ONLINE?this.emit(fA.ONLINE):e===hA.OFFLINE&&(this.onlineWaiter=new ih((e=>{this.once(fA.ONLINE,(()=>{this.onlineWaiter=void 0,e(hA.ONLINE)}))})),this.emit(fA.OFFLINE)),this._networkState=e}get networkState(){return this._networkState}get isOnline(){return this._networkState===hA.ONLINE}constructor(){super(),LI(this,"_moduleName","network-indicator"),LI(this,"_networkState",hA.ONLINE),LI(this,"onlineWaiter",void 0),window.addEventListener("online",(()=>{this.networkState=hA.ONLINE})),window.addEventListener("offline",(()=>{this.networkState=hA.OFFLINE}))}};function _A(e,t){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}function bA(e){const t=[];return e.forEach((e=>{-1===t.indexOf(e)&&t.push(e)})),t}function TA(e){void 0!==ih?ih.resolve().then(e):setTimeout(e,0)}function SA(e){return JSON.parse(JSON.stringify(e))}function OA(e){try{return SA(e)}catch(o){return e}}const RA={};function CA(e,t){RA[t]||(RA[t]=!0,e())}function wA(e){const t=window.atob(e),n=new Uint8Array(new ArrayBuffer(t.length));for(let r=0;r<t.length;r+=1)n[r]=t.charCodeAt(r);return n}function IA(e){let t="";for(let n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return window.btoa(t)}function AA(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=(new TextEncoder).encode(e);if(n.length>t)n=n.slice(0,t);else if(n.length<t){const e=new Uint8Array(t);e.set(n),n=e}return n}function NA(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=so(t).call(t,((e,t)=>e+t.length),0),o=new Uint8Array(new ArrayBuffer(r));let i=0;return t.forEach((e=>{o.set(e,i),i+=e.length})),o}function kA(e){return window.TextEncoder?(new TextEncoder).encode(e).length:e.length}function PA(e){let t=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&e.realFormData&&(e=e.realFormData),e.forEach((e=>{t+="string"==typeof e?kA(e):e.size})),t+138}function DA(e){const t=new FI(jI.TIMEOUT,"timeout");return new ih(((n,r)=>{window.setTimeout((()=>r(t)),e)}))}function MA(e){return new ih((t=>{window.setTimeout(t,e)}))}function LA(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0;const n=Math.random().toString(16).substr(2,e).toLowerCase();return n.length===e?"".concat(t).concat(n):"".concat(t).concat(n)+LA(e-n.length,"")}function xA(){return LA(32,"").toUpperCase()}const UA=()=>{},jA=new class{constructor(){LI(this,"fnMap",new Map)}throttleByKey(e,t,n,r){for(var o=arguments.length,i=new Array(o>4?o-4:0),a=4;a<o;a++)i[a-4]=arguments[a];if(this.fnMap.has(t)){const o=this.fnMap.get(t);if(o.threshold!==n){o.fn(...o.args),clearTimeout(o.timer);const a=window.setTimeout((()=>{const e=this.fnMap.get(t);e&&e.fn(...e.args),this.fnMap.delete(t)}),n);this.fnMap.set(t,{fn:e,threshold:n,timer:a,args:i,skipFn:r})}else o.skipFn&&o.skipFn(...o.args),this.fnMap.set(t,UI(UI({},o),{},{fn:e,args:i,skipFn:r}))}else{const o=window.setTimeout((()=>{const e=this.fnMap.get(t);e&&e.fn(...e.args),this.fnMap.delete(t)}),n);this.fnMap.set(t,{fn:e,threshold:n,timer:o,args:i,skipFn:r})}}},FA=jA.throttleByKey.bind(jA);function BA(e){return"object"==typeof e&&null!==e&&!(e instanceof RegExp)}function VA(e,t){if(!BA(e)||!BA(t))return t;if(Array.isArray(e)&&!Array.isArray(t)||!Array.isArray(e)&&Array.isArray(t))return t;if(Array.isArray(t)&&Array.isArray(e)){const n=[...e];for(let r=0;r<t.length;r++)n[r]=VA(e[r],t[r]);return n}{const n=UI({},e);for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Object.prototype.hasOwnProperty.call(e,r)?n[r]=VA(e[r],t[r]):n[r]=t[r]);return n}}function HA(e,t){let n=[0];if(t&&(n=new Array(t).fill(0)),0===e)return n;let r=0;for(;e>0&&(n[r]=255&e,e>>=8,r++,!t||r!==t););return n}function GA(e){return"number"==typeof e?e:e.exact||e.ideal||e.max||e.min||0}function WA(e){const t="0123456789abcdef";function n(e){let n,r="";for(n=0;n<=3;n++)r+=t.charAt(e>>8*n+4&15)+t.charAt(e>>8*n&15);return r}function r(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function o(e,t,n,o,i,a){return r(function(e,t){return e<<t|e>>>32-t}(r(r(t,e),r(o,a)),i),n)}function i(e,t,n,r,i,a,s){return o(t&n|~t&r,e,t,i,a,s)}function a(e,t,n,r,i,a,s){return o(t&r|n&~r,e,t,i,a,s)}function s(e,t,n,r,i,a,s){return o(t^n^r,e,t,i,a,s)}function c(e,t,n,r,i,a,s){return o(n^(t|~r),e,t,i,a,s)}const l=function(e){let t;const n=1+(e.length+8>>6),r=new Array(16*n);for(t=0;t<16*n;t++)r[t]=0;for(t=0;t<e.length;t++)r[t>>2]|=e.charCodeAt(t)<<t%4*8;return r[t>>2]|=128<<t%4*8,r[16*n-2]=8*e.length,r}(e);let u,d,p,h,f,m=1732584193,v=-271733879,g=-1732584194,E=271733878;for(u=0;u<l.length;u+=16)d=m,p=v,h=g,f=E,m=i(m,v,g,E,l[u+0],7,-680876936),E=i(E,m,v,g,l[u+1],12,-389564586),g=i(g,E,m,v,l[u+2],17,606105819),v=i(v,g,E,m,l[u+3],22,-1044525330),m=i(m,v,g,E,l[u+4],7,-176418897),E=i(E,m,v,g,l[u+5],12,1200080426),g=i(g,E,m,v,l[u+6],17,-1473231341),v=i(v,g,E,m,l[u+7],22,-45705983),m=i(m,v,g,E,l[u+8],7,1770035416),E=i(E,m,v,g,l[u+9],12,-1958414417),g=i(g,E,m,v,l[u+10],17,-42063),v=i(v,g,E,m,l[u+11],22,-1990404162),m=i(m,v,g,E,l[u+12],7,1804603682),E=i(E,m,v,g,l[u+13],12,-40341101),g=i(g,E,m,v,l[u+14],17,-1502002290),v=i(v,g,E,m,l[u+15],22,1236535329),m=a(m,v,g,E,l[u+1],5,-165796510),E=a(E,m,v,g,l[u+6],9,-1069501632),g=a(g,E,m,v,l[u+11],14,643717713),v=a(v,g,E,m,l[u+0],20,-373897302),m=a(m,v,g,E,l[u+5],5,-701558691),E=a(E,m,v,g,l[u+10],9,38016083),g=a(g,E,m,v,l[u+15],14,-660478335),v=a(v,g,E,m,l[u+4],20,-405537848),m=a(m,v,g,E,l[u+9],5,568446438),E=a(E,m,v,g,l[u+14],9,-1019803690),g=a(g,E,m,v,l[u+3],14,-187363961),v=a(v,g,E,m,l[u+8],20,1163531501),m=a(m,v,g,E,l[u+13],5,-1444681467),E=a(E,m,v,g,l[u+2],9,-51403784),g=a(g,E,m,v,l[u+7],14,1735328473),v=a(v,g,E,m,l[u+12],20,-1926607734),m=s(m,v,g,E,l[u+5],4,-378558),E=s(E,m,v,g,l[u+8],11,-2022574463),g=s(g,E,m,v,l[u+11],16,1839030562),v=s(v,g,E,m,l[u+14],23,-35309556),m=s(m,v,g,E,l[u+1],4,-1530992060),E=s(E,m,v,g,l[u+4],11,1272893353),g=s(g,E,m,v,l[u+7],16,-155497632),v=s(v,g,E,m,l[u+10],23,-1094730640),m=s(m,v,g,E,l[u+13],4,681279174),E=s(E,m,v,g,l[u+0],11,-358537222),g=s(g,E,m,v,l[u+3],16,-722521979),v=s(v,g,E,m,l[u+6],23,76029189),m=s(m,v,g,E,l[u+9],4,-640364487),E=s(E,m,v,g,l[u+12],11,-421815835),g=s(g,E,m,v,l[u+15],16,530742520),v=s(v,g,E,m,l[u+2],23,-995338651),m=c(m,v,g,E,l[u+0],6,-198630844),E=c(E,m,v,g,l[u+7],10,1126891415),g=c(g,E,m,v,l[u+14],15,-1416354905),v=c(v,g,E,m,l[u+5],21,-57434055),m=c(m,v,g,E,l[u+12],6,1700485571),E=c(E,m,v,g,l[u+3],10,-1894986606),g=c(g,E,m,v,l[u+10],15,-1051523),v=c(v,g,E,m,l[u+1],21,-2054922799),m=c(m,v,g,E,l[u+8],6,1873313359),E=c(E,m,v,g,l[u+15],10,-30611744),g=c(g,E,m,v,l[u+6],15,-1560198380),v=c(v,g,E,m,l[u+13],21,1309151649),m=c(m,v,g,E,l[u+4],6,-145523070),E=c(E,m,v,g,l[u+11],10,-1120210379),g=c(g,E,m,v,l[u+2],15,718787259),v=c(v,g,E,m,l[u+9],21,-343485551),m=r(m,d),v=r(v,p),g=r(g,h),E=r(E,f);return n(m)+n(v)+n(g)+n(E)}let qA=1,KA=console,YA=class{static setLogger(e){KA=e}constructor(e,t){LI(this,"id",void 0),LI(this,"lockingPromise",ih.resolve()),LI(this,"locks",0),LI(this,"name",""),LI(this,"lockId",void 0),this.lockId=qA++,e&&(this.name=e),t&&(this.id=t),this.logger("created")}logger(e,t){const n=(this.id?"[".concat(this.id,"]"):"")+"[lock-".concat(this.name,"-").concat(this.lockId,"]"),r="created"===e?"is ".concat(e,"."):"is ".concat(e,", current queue ").concat(this.locks,". ").concat(null!=t?t:"");KA.debug("".concat(n," ").concat(r))}setId(e){this.id=e}get isLocked(){return this.locks>0}lock(e){let t;this.locks+=1,this.logger("locked",e);const n=new ih((n=>{t=()=>{this.locks-=1,this.logger("unlocked",e),n()}})),r=this.lockingPromise.then((()=>t));return this.lockingPromise=this.lockingPromise.then((()=>n)),r}};function zA(e,t){return function(n,r,o){const i=o.value;if("function"!=typeof i)throw new Error("Cannot use mutex on object property.");return o.value=async function(){const n=this[t];if(!n)throw new Error("mutex property key ".concat(t," doesn't exist on ").concat(e));const o=await n.lock("From ".concat(e,".").concat(r));try{for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return await i.apply(this,s)}finally{o()}},o}}const XA={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function JA(e,t){const n=Math.floor(t.timeout*Math.pow(t.timeoutFactor,e));return Math.min(t.maxRetryTimeout,n)}function ZA(e,t,n,r){const o=Object.assign({},XA,r);let i=o.timeout;const a=async()=>{await function(e){return new ih((t=>{window.setTimeout(t,e)}))}(i),i*=o.timeoutFactor,i=Math.min(o.maxRetryTimeout,i)};let s=!1;const c=new ih((async(r,i)=>{t=t||(()=>!1),n=n||(()=>!0);for(let c=0;c<o.maxRetryCount;c+=1){if(s)return i(new FI(jI.OPERATION_ABORTED));try{const n=await e();if(!t(n,c))return r(n);if(c+1===o.maxRetryCount)return r(n);await a()}catch(e){if(!n(e,c))return i(e);if(c+1===o.maxRetryCount)return i(e);await a()}}}));return c.cancel=()=>s=!0,c}let QA,$A=class{constructor(e){LI(this,"input",[]),LI(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}mean(){var e;return 0===this.input.length?0:so(e=this.input).call(e,((e,t)=>e+t))/this.input.length}},eN=0,tN=0;function nN(e,t,n,r){return new ih(((o,i)=>{t.responseType=t.responseType||"json",t.data&&!n?(t.data=JSON.stringify(t.data),eN+=kA(t.data)):n&&(t.data.size?eN+=t.data.size:t.data instanceof FormData?eN+=PA(t.data):eN+=kA(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,Xw.request(t).then((e=>{"string"==typeof e.data?tN+=kA(e.data):e.data instanceof ArrayBuffer||e.data instanceof Uint8Array?tN+=e.data.byteLength:tN+=kA(JSON.stringify(e.data)),r&&o({data:e.data,headers:e.headers}),o(e.data)})).catch((e=>{Xw.isCancel(e)?i(new FI(jI.OPERATION_ABORTED,"cancel token canceled")):"ECONNABORTED"===e.code?i(new FI(jI.NETWORK_TIMEOUT,e.message)):e.response?i(new FI(jI.NETWORK_RESPONSE_ERROR,e.response.status)):i(new FI(jI.NETWORK_ERROR,e.message))}))}))}async function rN(e,t){const n=new Blob([t.data],{type:"buffer"});return await nN(e,UI(UI({},t),{},{data:n,headers:{"Content-Type":"application/octet-stream"}}),!0)}const oN=()=>void 0!==window.isSecureContext;function iN(e){if(Array.isArray(e))return e.map((e=>e));if(!aN(e))return e;const t={};for(const n in e){const r=e[n];aN(r)||Array.isArray(r)?t[n]=iN(r):t[n]=r}return t}function aN(e){return!("object"!=typeof e||Array.isArray(e)||!e)}let sN=class{constructor(e){LI(this,"input",[]),LI(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return 0===this.input.length?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}};const cN={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},lN={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:cN,remoteCandidate:cN},updateInterval:0},uN={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0,packetsDiscarded:0,framesAssembledFromMultiplePackets:0,totalProcessingDelay:0,avgDecodeMs:0,avgFramesAssembledFromMultiplePacketsMs:0,avgProcessingDelayMs:0,avgInterFrameDelayMs:0,totalAssemblyTime:0},dN={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},pN={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},hN={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packetsDiscarded:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0};let fN=class{constructor(e,t){LI(this,"onFirstVideoReceived",void 0),LI(this,"onFirstVideoDecoded",void 0),LI(this,"onFirstAudioReceived",void 0),LI(this,"onFirstVideoDecodedTimeout",void 0),LI(this,"onFirstAudioDecoded",void 0),LI(this,"onSelectedLocalCandidateChanged",void 0),LI(this,"onSelectedRemoteCandidateChanged",void 0),LI(this,"videoIsReady",!1),LI(this,"videoIsReady2",{}),LI(this,"pc",void 0),LI(this,"options",void 0),LI(this,"intervalTimer",void 0),LI(this,"stats",iN(lN)),LI(this,"isFirstVideoReceived",{}),LI(this,"isFirstVideoDecoded",{}),LI(this,"isFirstAudioReceived",{}),LI(this,"isFirstAudioDecoded",{}),LI(this,"isFirstVideoDecodedTimeout",{}),LI(this,"lossRateWindowStats",[]),this.pc=e,this.options=t,this.intervalTimer=window.setInterval((async()=>{this.updateStats()}),this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new ih((e=>{e({local:UI({},cN),remote:UI({},cN)})}))}setVideoIsReady(e){this.videoIsReady=e}setVideoIsReady2(e,t){this.videoIsReady2[e]=t}getVideoIsReady(e){return this.videoIsReady2[e]||!1}setIsFirstAudioDecoded(e){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(e){this.lossRateWindowStats.push(e),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const t=this.lossRateWindowStats.length,n=["videoSend","audioSend","videoRecv","audioRecv"];let r=0,o=0,i=0,a=0;for(const s of n)e[s].forEach(((e,n)=>{if(!this.lossRateWindowStats[t-1][s][n]||!this.lossRateWindowStats[0][s][n])return;const c=this.lossRateWindowStats[t-1][s][n].packets-this.lossRateWindowStats[0][s][n].packets,l=this.lossRateWindowStats[t-1][s][n].packetsLost-this.lossRateWindowStats[0][s][n].packetsLost;"videoSend"===s||"audioSend"===s?(r+=c,i+=l):(o+=c,a+=l),Number.isNaN(c)||Number.isNaN(c)?e.packetLostRate=0:e.packetLostRate=c<=0||l<=0?0:l/(c+l)}));e.sendPacketLossRate=r<=0||i<=0?0:i/(r+i),e.recvPacketLossRate=o<=0||a<=0?0:a/(o+a)}},mN=class extends fN{constructor(){super(...arguments),LI(this,"_stats",lN),LI(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const e=await this._getStats(),t=this.statsResponsesToObjects(e);this._stats=iN(lN);const n=t.filter((e=>"ssrc"===e.type));this.processSSRCStats(n);const r=t.find((e=>"VideoBwe"===e.type));r&&this.processBandwidthStats(r),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(e){this._stats.bitrate={actualEncoded:Number(e.googActualEncBitrate),targetEncoded:Number(e.googTargetEncBitrate),retransmit:Number(e.googRetransmitBitrate),transmit:Number(e.googTransmitBitrate)},this._stats.sendBandwidth=Number(e.googAvailableSendBandwidth)}processSSRCStats(e){e.forEach((e=>{var t;const n=Ur(t=e.id).call(t,"send");switch("".concat(e.mediaType,"_").concat(n?"send":"recv")){case"video_send":{const t=iN(dN);t.codec=e.googCodecName,t.adaptionChangeReason="none",e.googCpuLimitedResolution&&(t.adaptionChangeReason="cpu"),e.googBandwidthLimitedResolution&&(t.adaptionChangeReason="bandwidth"),t.avgEncodeMs=Number(e.googAvgEncodeMs),t.inputFrame={width:Number(e.googFrameWidthInput)||Number(e.googFrameWidthSent),height:Number(e.googFrameHeightInput)||Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},t.sentFrame={width:Number(e.googFrameWidthSent),height:Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},t.firsCount=Number(e.googFirReceived),t.nacksCount=Number(e.googNacksReceived),t.plisCount=Number(e.googPlisReceived),t.frameCount=Number(e.framesEncoded),t.bytes=Number(e.bytesSent),t.packets=Number(e.packetsSent),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.rttMs=Number(e.googRtt||0),this._stats.videoSend.push(t),this._stats.rtt=t.rttMs;break}case"video_recv":{const t=iN(uN),n=this.lastDecodeVideoReceiverStats.get(Number(e.ssrc));if(t.codec=e.googCodecName,t.targetDelayMs=Number(e.googTargetDelayMs),t.renderDelayMs=Number(e.googRenderDelayMs),t.currentDelayMs=Number(e.googCurrentDelayMs),t.minPlayoutDelayMs=Number(e.googMinPlayoutDelayMs),t.decodeMs=Number(e.googDecodeMs),t.maxDecodeMs=Number(e.googMaxDecodeMs),t.receivedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateReceived)},t.decodedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateDecoded)},t.decodeFrameRate=Number(e.googFrameRateDecoded),t.outputFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateOutput)},t.jitterBufferMs=Number(e.googJitterBufferMs),t.firsCount=Number(e.googFirsSent),t.nacksCount=Number(e.googNacksSent),t.plisCount=Number(e.googPlisSent),t.framesDecodeCount=Number(e.framesDecoded),t.bytes=Number(e.bytesReceived),t.packets=Number(e.packetsReceived),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.packets>0&&!this.isFirstVideoReceived[t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(t.ssrc),this.isFirstVideoReceived[t.ssrc]=!0),t.framesDecodeCount>0&&!this.isFirstVideoDecoded[t.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(t.ssrc,t.decodedFrame.width,t.decodedFrame.height),this.isFirstVideoDecoded[t.ssrc]=!0),n){const r=n.stats,o=Date.now()-n.lts;t.framesDecodeFreezeTime=r.framesDecodeFreezeTime,t.framesDecodeInterval=r.framesDecodeInterval,t.framesDecodeCount>r.framesDecodeCount&&this.isFirstVideoDecoded[t.ssrc]?(n.lts=Date.now(),t.framesDecodeInterval=o,t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc,10))?t.framesDecodeFreezeTime+=t.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):t.framesDecodeCount<n.stats.framesDecodeCount&&(t.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(t.ssrc,{stats:UI({},t),lts:Date.now()}),this._stats.videoRecv.push(t);break}case"audio_recv":{const t=iN(hN);t.codec=e.googCodecName,t.outputLevel=Math.abs(Number(e.audioOutputLevel))/32767,t.decodingCNG=Number(e.googDecodingCNG),t.decodingCTN=Number(e.googDecodingCTN),t.decodingCTSG=Number(e.googDecodingCTSG),t.decodingNormal=Number(e.googDecodingNormal),t.decodingPLC=Number(e.googDecodingPLC),t.decodingPLCCNG=Number(e.googDecodingPLCCNG),t.expandRate=Number(e.googExpandRate),t.accelerateRate=Number(e.googAccelerateRate),t.preemptiveExpandRate=Number(e.googPreemptiveExpandRate),t.secondaryDecodedRate=Number(e.googSecondaryDecodedRate),t.speechExpandRate=Number(e.googSpeechExpandRate),t.preferredJitterBufferMs=Number(e.googPreferredJitterBufferMs),t.jitterBufferMs=Number(e.googJitterBufferMs),t.jitterMs=Number(e.googJitterReceived),t.bytes=Number(e.bytesReceived),t.packets=Number(e.packetsReceived),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.receivedFrames=Number(e.googDecodingCTN)||Number(e.packetsReceived),t.droppedFrames=Number(e.googDecodingPLC)+Number(e.googDecodingPLCCNG)||Number(e.packetsLost),t.receivedFrames>0&&!this.isFirstAudioReceived[t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(t.ssrc),this.isFirstAudioReceived[t.ssrc]=!0),t.decodingNormal>0&&!this.isFirstAudioDecoded[t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(t.ssrc),this.isFirstAudioDecoded[t.ssrc]=!0),this._stats.audioRecv.push(t);break}case"audio_send":{const t=iN(pN);t.codec=e.googCodecName,t.inputLevel=Math.abs(Number(e.audioInputLevel))/32767,t.aecReturnLoss=Number(e.googEchoCancellationReturnLoss||0),t.aecReturnLossEnhancement=Number(e.googEchoCancellationReturnLossEnhancement||0),t.residualEchoLikelihood=Number(e.googResidualEchoLikelihood||0),t.residualEchoLikelihoodRecentMax=Number(e.googResidualEchoLikelihoodRecentMax||0),t.bytes=Number(e.bytesSent),t.packets=Number(e.packetsSent),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.rttMs=Number(e.googRtt||0),this._stats.rtt=t.rttMs,this._stats.audioSend.push(t);break}}}))}_getStats(){return new ih(((e,t)=>{this.pc.getStats(e,t)}))}statsResponsesToObjects(e){const t=[];return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp.valueOf().toString(),type:e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t.push(n)})),t}},vN=function(e){return e.BANDWIDTH="bandwidth",e.CPU="cpu",e.NONE="none",e.OTHER="other",e}({}),gN=function(e){return e.L1T1="L1T1",e.L1T2="L1T2",e.L1T3="L1T3",e.L1T3_KEY="L1T3_KEY",e.L2T1_KEY="L2T1_KEY",e.L2T2_KEY="L2T2_KEY",e.L2T3_KEY="L2T3_KEY",e.L3T1_KEY="L3T1_KEY",e.L3T2_KEY="L3T2_KEY",e.L3T3_KEY="L3T3_KEY",e}({}),EN=function(e){return e[e.new=0]="new",e[e.connecting=1]="connecting",e[e.connected=2]="connected",e[e.disconnected=3]="disconnected",e[e.failed=4]="failed",e[e.closed=5]="closed",e}({}),yN=function(e){return e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver",e}({});var _N=function(e){return e[e.kNone=1]="kNone",e[e.kMillisecondsFromSeconds=1e3]="kMillisecondsFromSeconds",e[e.kBytesToBits=8]="kBytesToBits",e}(_N||{});function bN(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:_N.kNone;if(!t)return;const i=Number(t[n]);if("number"!=typeof i)return;const a=Number(t[r]);if("number"!=typeof a)return;if(!e)return a?i/a*o:void 0;const s=Number(e[n]);if("number"!=typeof s)return;const c=Number(e[r]);if("number"!=typeof c)return;const l=a-c;return l?(i-s)/l*o:void 0}let TN=class extends fN{constructor(){super(...arguments),LI(this,"_stats",lN),LI(this,"report",void 0),LI(this,"lastDecodeVideoReceiverStats",new Map),LI(this,"lastVideoFramesRecv",new Map),LI(this,"lastVideoFramesSent",new Map),LI(this,"lastVideoFramesDecode",new Map),LI(this,"lastVideoFramesOutput",new Map),LI(this,"lastVideoJBDelay",new Map),LI(this,"lastAudioJBDelay",new Map),LI(this,"mediaBytesSent",new Map),LI(this,"mediaBytesRetransmit",new Map),LI(this,"mediaBytesTargetEncode",new Map),LI(this,"lastDecodeAudioReceiverStats",new Map),LI(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=iN(lN),this.report.forEach((e=>{switch(e.type){case yN.OUTBOUND:case yN.INBOUND:{const t=e.mediaType||e.kind,n=!t&&"frameWidth"in e,r=!t&&!("frameWidth"in e);e.type===yN.OUTBOUND?"audio"===t||r?this.processAudioOutboundStats(e):("video"===t||n)&&this.processVideoOutboundStats(e):e.type===yN.INBOUND&&("audio"===t||r?this.processAudioInboundStats(e):("video"===t||n)&&this.processVideoInboundStats(e));break}case yN.TRANSPORT:{const t=this.report.get(e.selectedCandidatePairId);t&&this.processCandidatePairStats(t);break}case yN.CANDIDATE_PAIR:e.selected&&this.processCandidatePairStats(e)}})),this.updateSendBitrate(),this._stats.updateInterval=Date.now()-this.stats.timestamp,this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const e=await this.pc.getStats(),t={local:UI({},cN),remote:UI({},cN)};return e.forEach((n=>{let r;if(n.type===yN.TRANSPORT&&(r=e.get(n.selectedCandidatePairId)),n.type===yN.CANDIDATE_PAIR&&n.selected&&(r=n),r){const n=(e,t)=>{e.type=t.type,e.id=t.id,t.address&&(e.address=t.address),t.candidateType&&(e.candidateType=t.candidateType),t.port&&(e.port=t.port),t.priority&&(e.priority=t.priority),t.protocol&&(e.protocol=t.protocol),t.relayProtocol&&(e.relayProtocol=t.relayProtocol)};if(r.localCandidateId){const o=e.get(r.localCandidateId);o&&n(t.local,o)}if(r.remoteCandidateId){const o=e.get(r.remoteCandidateId);o&&n(t.remote,o)}}})),t}processCandidatePairStats(e){if(this._stats.sendBandwidth=e.availableOutgoingBitrate||0,e.currentRoundTripTime&&(this._stats.rtt=1e3*e.currentRoundTripTime),this._stats.videoSend.forEach((t=>{e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)})),this._stats.audioSend.forEach((t=>{e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)})),this._stats.selectedCandidatePair.id=e.id,e.localCandidateId){const t=this.report.get(e.localCandidateId);t&&this.processCandidateStats(t)}if(e.remoteCandidateId){const t=this.report.get(e.remoteCandidateId);t&&this.processCandidateStats(t)}}processCandidateStats(e){let t;e.type===yN.LOCAL_CANDIDATE&&(t=this._stats.selectedCandidatePair.localCandidate),e.type===yN.REMOTE_CANDIDATE&&(t=this._stats.selectedCandidatePair.remoteCandidate),t&&(t.type=e.type,t.id=e.id,e.address&&(t.address=e.address),e.candidateType&&(t.candidateType=e.candidateType),e.port&&(t.port=e.port),e.priority&&(t.priority=e.priority),e.protocol&&(t.protocol=e.protocol),e.relayProtocol&&(t.relayProtocol=e.relayProtocol),e.type===yN.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==t.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(UI({},t),UI({},this.stats.selectedCandidatePair.localCandidate)),e.type===yN.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==t.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(UI({},t),UI({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(e){let t=this._stats.audioRecv.find((t=>t.ssrc===e.ssrc));t||(t=iN(hN),this._stats.audioRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.packetsDiscarded=e.packetsDiscarded,t.bytes=e.bytesReceived,t.jitterMs=1e3*e.jitter,t.retransmittedBytesReceived=e.retransmittedBytesReceived,t.retransmittedPacketsReceived=e.retransmittedPacketsReceived,t.totalProcessingDelay=e.totalProcessingDelay,t.jitterBufferEmittedCount=e.jitterBufferEmittedCount;const n=this.lastDecodeAudioReceiverStats.get(t.ssrc);t.avgProcessingDelayMs=bN(n,t,"totalProcessingDelay","jitterBufferEmittedCount",_N.kMillisecondsFromSeconds),this.processAudioTrackReceiverStats(e,e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),t.receivedFrames||(t.receivedFrames=e.packetsReceived),t.droppedFrames||(t.droppedFrames=e.packetsLost),t.receivedFrames>0&&!this.isFirstAudioReceived[t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(t.ssrc),this.isFirstAudioReceived[t.ssrc]=!0),t.outputLevel&&t.outputLevel>0&&!this.isFirstAudioDecoded[t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(t.ssrc),this.isFirstAudioDecoded[t.ssrc]=!0),"number"==typeof e.concealedSamples&&(t.concealedSamples=e.concealedSamples),this.lastDecodeAudioReceiverStats.set(t.ssrc,UI({},t))}processVideoInboundStats(e){let t=this._stats.videoRecv.find((t=>t.ssrc===e.ssrc));t||(t=iN(uN),this._stats.videoRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.bytes=e.bytesReceived,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.framesDecodeCount=e.framesDecoded,t.framesDroppedCount=e.framesDropped,t.totalInterFrameDelay=e.totalInterFrameDelay,t.totalSquaredInterFrameDelay=e.totalSquaredInterFrameDelay,t.totalFreezesDuration=e.totalFreezesDuration,t.totalProcessingDelay=e.totalProcessingDelay,t.packetsDiscarded=e.packetsDiscarded,t.framesAssembledFromMultiplePackets=e.framesAssembledFromMultiplePackets,t.totalAssemblyTime=e.totalAssemblyTime,t.keyFramesDecoded=e.keyFramesDecoded,t.retransmittedBytesReceived=e.retransmittedBytesReceived,t.retransmittedPacketsReceived=e.retransmittedPacketsReceived;const n=this.lastDecodeVideoReceiverStats.get(t.ssrc),r=this.lastVideoFramesDecode.get(t.ssrc),o=this.lastVideoFramesOutput.get(t.ssrc),i=Date.now();if(t.framesDecodeCount>0&&!this.isFirstVideoDecoded[t.ssrc]){const e=t.decodedFrame?t.decodedFrame.width:0,n=t.decodedFrame?t.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(t.ssrc,e,n),this.isFirstVideoDecoded[t.ssrc]=!0}if(n){const r=n.stats,o=i-n.lts;t.framesDecodeFreezeTime=r.framesDecodeFreezeTime,t.framesDecodeInterval=r.framesDecodeInterval,!this.isFirstVideoDecoded[t.ssrc]&&o>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[t.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(t.ssrc),this.isFirstVideoDecodedTimeout[t.ssrc]=!0),t.framesDecodeCount>r.framesDecodeCount&&this.isFirstVideoDecoded[t.ssrc]?(n.lts=Date.now(),t.framesDecodeInterval=o,t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc))?t.framesDecodeFreezeTime+=t.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):t.framesDecodeCount<r.framesDecodeCount&&(t.framesDecodeInterval=0),e.framesDecoded&&e.qpSum&&(n.stats.framesDecodeCount>e.framesDecoded?t.qpSumPerFrame=e.qpSum/e.framesDecoded:t.qpSumPerFrame=(e.qpSum-n.qpSum)/(e.framesDecoded-n.stats.framesDecodeCount))}e.totalDecodeTime&&(t.decodeMs=1e3*e.totalDecodeTime,t.avgDecodeMs=bN(null==n?void 0:n.stats,t,"decodeMs","framesDecodeCount")),t.avgProcessingDelayMs=bN(null==n?void 0:n.stats,t,"totalProcessingDelay","framesDecodeCount",_N.kMillisecondsFromSeconds),t.avgFramesAssembledFromMultiplePacketsMs=bN(null==n?void 0:n.stats,t,"totalAssemblyTime","framesAssembledFromMultiplePackets",_N.kMillisecondsFromSeconds),t.avgInterFrameDelayMs=bN(null==n?void 0:n.stats,t,"totalInterFrameDelay","framesDecodeCount",_N.kMillisecondsFromSeconds),r&&i-r.lts>=800?(t.decodeFrameRate=Math.round((t.framesDecodeCount-r.count)/((i-r.lts)/1e3)),this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:i,rate:t.decodeFrameRate})):r?t.decodeFrameRate=r.rate:this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:i,rate:0}),t.framesDroppedCount&&e.framesReceived&&(o&&i-o.lts>=800?(t.outputFrameRate=Math.round((e.framesReceived-t.framesDroppedCount-o.count)/((i-o.lts)/1e3)),this.lastVideoFramesOutput.set(t.ssrc,{count:e.framesReceived-t.framesDroppedCount,lts:i,rate:Math.max(t.outputFrameRate,0)})):o?t.outputFrameRate=o.rate:this.lastVideoFramesOutput.set(t.ssrc,{count:e.framesReceived-t.framesDroppedCount,lts:i,rate:0})),this.processVideoTrackReceiverStats(e,e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.framerateMean&&(t.framesRateFirefox=e.framerateMean),t.packets>0&&!this.isFirstVideoReceived[t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(t.ssrc),this.isFirstVideoReceived[t.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(t.ssrc,{stats:UI({},t),lts:n?n.lts:Date.now(),qpSum:e.qpSum})}processVideoOutboundStats(e){let t=this._stats.videoSend.find((t=>t.ssrc===e.ssrc));t||(t=iN(dN),this._stats.videoSend.push(t));const n=this.mediaBytesSent.get(e.ssrc);if(n)n.add(e.bytesSent);else{const t=new sN(10);t.add(e.bytesSent),this.mediaBytesSent.set(e.ssrc,t)}if(void 0!==e.retransmittedBytesSent){const t=this.mediaBytesRetransmit.get(e.ssrc);if(t)t.add(e.retransmittedBytesSent);else{const t=new sN(10);t.add(e.retransmittedBytesSent),this.mediaBytesRetransmit.set(e.ssrc,t)}}if(e.totalEncodedBytesTarget){const t=this.mediaBytesTargetEncode.get(e.ssrc);if(t)t.add(e.totalEncodedBytesTarget);else{const t=new sN(10);t.add(e.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(e.ssrc,t)}}if(t.ssrc=e.ssrc,t.bytes=e.bytesSent,t.packets=e.packetsSent,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.frameCount=e.framesEncoded,t.adaptionChangeReason=e.qualityLimitationReason,t.scalabilityMode=e.scalabilityMode,t.retransmittedBytesSent=e.retransmittedBytesSent,t.retransmittedPacketsSent=e.retransmittedPacketsSent,t.hugeFramesSent=e.hugeFramesSent,t.keyFramesEncoded=e.keyFramesEncoded,e.totalEncodeTime&&e.framesEncoded){const n=this.lastEncoderMs.get(e.ssrc);if(!n||n.lastFrameCount>e.framesEncoded)t.avgEncodeMs=1e3*e.totalEncodeTime/e.framesEncoded;else{const r=e.framesEncoded-n.lastFrameCount,o=e.totalEncodeTime-n.lastEncoderTime;t.avgEncodeMs=1e3*o/r}}if(e.framesEncoded&&e.qpSum){const n=this.lastEncoderMs.get(e.ssrc);!n||n.lastFrameCount>e.framesEncoded?t.qpSumPerFrame=e.qpSum/e.framesEncoded:t.qpSumPerFrame=(e.qpSum-n.lastQpSum)/(e.framesEncoded-n.lastFrameCount)}if(this.lastEncoderMs.set(e.ssrc,{lastFrameCount:e.framesEncoded,lastEncoderTime:e.totalEncodeTime,lastQpSum:e.qpSum,lts:Date.now()}),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.mediaSourceId&&this.processVideoMediaSource(e.mediaSourceId,t),this.processVideoTrackSenderStats(e,e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{const n=this.findRemoteStatsId(e.ssrc,yN.REMOTE_INBOUND);n&&this.processRemoteInboundStats(n,t)}}processAudioOutboundStats(e){let t=this._stats.audioSend.find((t=>t.ssrc===e.ssrc));if(t||(t=iN(pN),this._stats.audioSend.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsSent,t.bytes=e.bytesSent,t.retransmittedBytesSent=e.retransmittedBytesSent,t.retransmittedPacketsSent=e.retransmittedPacketsSent,e.mediaSourceId&&this.processAudioMediaSource(e.mediaSourceId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),this.processAudioTrackSenderStats(e,e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{const n=this.findRemoteStatsId(e.ssrc,yN.REMOTE_INBOUND);n&&this.processRemoteInboundStats(n,t)}}findRemoteStatsId(e,t){var n;const r=Array.from(fh(n=this.report).call(n)).find((n=>n.type===t&&n.ssrc===e));return r?r.id:null}processVideoMediaSource(e,t){const n=this.report.get(e);n&&n.width&&n.height&&n.framesPerSecond&&(t.inputFrame={width:n.width,height:n.height,frameRate:n.framesPerSecond})}processAudioMediaSource(e,t){const n=this.report.get(e);n&&(t.inputLevel=n.audioLevel)}processVideoTrackSenderStats(e,t,n){var r,o,i,a;const s=t?this.report.get(t):void 0,c=null!==(r=null==s?void 0:s.framesSent)&&void 0!==r?r:e.framesSent;if("number"!=typeof c)return;let l=null!==(o=null==s?void 0:s.frameWidth)&&void 0!==o?o:e.frameWidth,u=null!==(i=null==s?void 0:s.frameHeight)&&void 0!==i?i:e.frameHeight,d=null!==(a=null==s?void 0:s.framesPerSecond)&&void 0!==a?a:e.framesPerSecond;if("number"==typeof l&&"number"==typeof u||(l=0,u=0),null==d){const e=Date.now(),t=this.lastVideoFramesSent.get(n.ssrc);t&&e-t.lts>=800?(d=Math.round((c-t.count)/((e-t.lts)/1e3)),this.lastVideoFramesSent.set(n.ssrc,{count:c,lts:e,rate:d})):t?d=t.rate:this.lastVideoFramesSent.set(n.ssrc,{count:c,lts:e,rate:0})}n.sentFrame={width:l,height:u,frameRate:Math.max(0,d)}}processVideoTrackReceiverStats(e,t,n){var r,o,i,a,s;const c=t?this.report.get(t):void 0,l=null!==(r=null==c?void 0:c.framesReceived)&&void 0!==r?r:e.framesReceived,u=null!==(o=null==c?void 0:c.frameWidth)&&void 0!==o?o:e.frameWidth,d=null!==(i=null==c?void 0:c.frameHeight)&&void 0!==i?i:e.frameHeight,p=null!==(a=null==c?void 0:c.jitterBufferDelay)&&void 0!==a?a:e.jitterBufferDelay,h=null!==(s=null==c?void 0:c.jitterBufferEmittedCount)&&void 0!==s?s:e.jitterBufferEmittedCount;if("number"==typeof l){const e=this.lastVideoFramesRecv.get(n.ssrc),t=Date.now();n.framesReceivedCount=l;let r=0;e&&t-e.lts>=800?(r=Math.round((l-e.count)/((t-e.lts)/1e3)),this.lastVideoFramesRecv.set(n.ssrc,{count:l,lts:t,rate:r})):e?r=e.rate:this.lastVideoFramesRecv.set(n.ssrc,{count:l,lts:t,rate:0}),n.receivedFrame={width:u||0,height:d||0,frameRate:r||0},n.decodedFrame={width:u||0,height:d||0,frameRate:n.decodeFrameRate||0},n.outputFrame={width:u||0,height:d||0,frameRate:n.outputFrameRate||n.decodeFrameRate||0}}if(p&&h){const e=this.lastVideoJBDelay.get(n.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let t=e.jitterBufferMs;const r=h-e.jitterBufferEmittedCount;r>0&&(t=1e3*(p-e.jitterBufferDelay)/r),n.jitterBufferMs=t,n.currentDelayMs=Math.round(t),this.lastVideoJBDelay.set(n.ssrc,{jitterBufferDelay:p,jitterBufferEmittedCount:h,jitterBufferMs:n.currentDelayMs})}}processAudioTrackSenderStats(e,t,n){var r,o,i,a;const s=t?this.report.get(t):void 0,c=null!==(r=null!==(o=null==s?void 0:s.echoReturnLoss)&&void 0!==o?o:e.echoReturnLoss)&&void 0!==r?r:0,l=null!==(i=null!==(a=null==s?void 0:s.echoReturnLossEnhancement)&&void 0!==a?a:e.echoReturnLossEnhancement)&&void 0!==i?i:0;n.aecReturnLoss=c,n.aecReturnLossEnhancement=l}processAudioTrackReceiverStats(e,t,n){var r,o,i,a,s,c,l;const u=t?this.report.get(t):void 0,d=null!==(r=null==u?void 0:u.removedSamplesForAcceleration)&&void 0!==r?r:e.removedSamplesForAcceleration,p=null!==(o=null==u?void 0:u.totalSamplesReceived)&&void 0!==o?o:e.totalSamplesReceived,h=null!==(i=null==u?void 0:u.jitterBufferDelay)&&void 0!==i?i:e.jitterBufferDelay,f=null!==(a=null==u?void 0:u.jitterBufferEmittedCount)&&void 0!==a?a:e.jitterBufferEmittedCount,m=null!==(s=null==u?void 0:u.audioLevel)&&void 0!==s?s:null==e?void 0:e.audioLevel,v=null!==(c=null==u?void 0:u.totalSamplesDuration)&&void 0!==c?c:null==e?void 0:e.totalSamplesDuration,g=null!==(l=null==u?void 0:u.concealedSamples)&&void 0!==l?l:e.concealedSamples;if(d&&p&&(n.accelerateRate=d/p),h&&f){const e=this.lastAudioJBDelay.get(n.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let t=e.jitterBufferMs;const r=f-e.jitterBufferEmittedCount;r>0&&(t=1e3*(h-e.jitterBufferDelay)/r),n.jitterBufferMs=Math.round(t),this.lastAudioJBDelay.set(n.ssrc,{jitterBufferDelay:h,jitterBufferEmittedCount:f,jitterBufferMs:n.jitterBufferMs})}n.outputLevel=m;let E=1920;v&&p&&(E=p/v/50,n.receivedFrames=Math.round(p/E)),g&&(n.droppedFrames=Math.round(g/E))}processRemoteInboundStats(e,t){const n=this.report.get(e);n&&(t.packetsLost=n.packetsLost,n.roundTripTime&&(t.rttMs=1e3*n.roundTripTime),n.jitter&&(t.jitterMs=1e3*n.jitter),n.timestamp&&(t.timestamp=n.timestamp))}getCodecFromCodecStats(e){const t=this.report.get(e);if(!t)return"";const n=t.mimeType.match(/\/(.*)$/);return n&&n[1]?n[1]:""}updateSendBitrate(){let e=0,t=null,n=null;this.mediaBytesSent.forEach((t=>{e+=t.diffMean()})),this.mediaBytesRetransmit.forEach((e=>{t=null===t?e.diffMean():t+e.diffMean()})),this.mediaBytesTargetEncode.forEach((e=>{n=null===n?e.diffMean():n+e.diffMean()}));const r=null!==t?e-t:e;this._stats.bitrate={actualEncoded:8*r/(this.options.updateInterval/1e3),transmit:8*e/(this.options.updateInterval/1e3)},null!==t&&(this._stats.bitrate.retransmit=8*t/(this.options.updateInterval/1e3)),null!==n&&(this._stats.bitrate.targetEncoded=8*n/(this.options.updateInterval/1e3))}},SN=class extends fN{updateStats(){return ih.resolve()}};function ON(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e4;const i=function(){const e=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return e&&e[0]?Number(e[0].split("/")[1]):null}();return i?i<76?new mN(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:o}):new TN(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:o}):function(e){if(!window.RTCStatsReport)return!1;const t=e.getStats();return!!(t instanceof ih||function(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then}(t))}(e)?new TN(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:o}):new SN(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:o})}const RN="websdk_ng_install_id";function CN(){try{if(UN("INSTALL_ID"))return UN("INSTALL_ID");let e=window.localStorage.getItem(RN);return e||(e=xA(),window.localStorage.setItem(RN,e)),xN("INSTALL_ID",e),e}catch(e){return}}const wN=function(e){if(e.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return e;const t=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-([0-9]+)/);if(t&&t[1]&&t[2]){const e=t[1],n=t[2];return"".concat(e,".").concat(n)}return"4.0.0.999"}("4.23.1"),IN=function(){try{return!0===JSON.parse("true")}catch(e){return!0}}();let AN=function(e){return e.Default="default",e.Auto="auto",e.Relay="relay",e.SdRtn="sd-rtn",e}({});const NN=function(){const e="us".concat("erna","me"),t="pa".concat("sswo","rd"),n=["t","s","t"];n.splice(1,0,"e");const r=n.join(""),o=[];for(let s=0;s<6;s++)o.push("1");const i=o.join(""),a={};return a[e]=r,a[t]=i,Object.assign(a,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=NN;const kN={ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,ENABLE_USER_LICENSE_CHECK:!0,DISABLE_FEC:void 0,ENABLE_NTP_REPORT:!1,ENABLE_INSTANT_VIDEO:!1,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:!1,ENABLE_CC_FALLBACK:void 0,SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,ENABLE_SVC_DEFAULT_CODECS:["H264","VP8","VP9","AV1"],SVC:[],ENABLE_FULL_LINK_AV_SYNC:!1,SVC_MODE:null,PRE_SUB_NUM:2,ENABLE_AUT_FEEDBACK:!1,SVC_EXTENDED:["VP9"]},PN={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},DN="v4.23.1-0-gea45199f-dirty(1/16/2025, 3:18:04 PM)",MN={ENABLE_EVENT_REPORT:!0,UPLOAD_LOG:!1,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,ENABLE_PRELOAD:!0,NEW_ICE_RESTART:!1,ICE_RESTART_INTERVAL:1e4,RESTART_SEQUENCE:["udp_tcp_relay","relay"]},LN=UI(UI(UI({},MN),{},{PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,NOT_REPORT_EVENT:[],PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,SHOW_REPORT_USER_INVOKER_LOG:!0,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,FIRST_H264_PROFILE_LEVEL_ID:"42001f",FIRST_PACKETIZATION_MODE:"",X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,FINGERPRINT:null,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,ENABLE_AUDIO_TOPN:!1,ENABLE_AUDIO_METADATA:!1,TOPN_SMOOTH_LEVEL:void 0,TOPN_NEW_SPEAKER_DELAY:void 0,TOPN_SWITCH_HOLD_MS:void 0,TOPN_AUDIO_GAIN:void 0,TOPN_SILENCE_THRESHOLD:250,AP_AREA:!0,ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,DATASTREAM_MAX_RETRANSMITS:10,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:PN,CUSTOM_ADAPTATION_DEFAULT_MODE:"",HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,DISABLE_SCREEN_SHARE_REMB:!1},kN),{},{USE_CANDIDATE_FROM_AP_DETAIL:!1,AP_REQUEST_DETAIL:void 0,ENABLE_ROLE_SELECT_EDGE:!1,CLIENT_ROLE_OPTIONS:void 0,COMPATIBLE_SDP_EXTENSION:["gdpr_forbidden"],LIMIT_BITRATE:void 0,EXPERIMENTS:{},USE_PUB_RTX:!0,USE_SUB_RTX:!0,ENABLE_DATASTREAM_2:!1,USE_XR:!0,ENABLE_PREALLOC_PC:!1,ENABLE_PRE_SUB:!1,ENABLE_SVC:!1},{INSTALL_ID:""});function xN(e,t,n){var r,o,i;Ur(r=Object.keys(LN)).call(r,e)&&(!n&&Ur(o=Object.keys(FN)).call(o,e)||(LN[e]=t,"ENABLE_VIDEO_SEI"!==e&&"ENABLE_AUDIO_TOPN"!==e&&"ENABLE_AUDIO_METADATA"!==e||!0!==t||(LN.ENABLE_ENCODED_TRANSFORM=!0),"USE_NEW_NETWORK_CONFIG"===e&&t&&(i=!!t,LN.USE_NEW_NETWORK_CONFIG=i,i&&(LN.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],LN.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],LN.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],LN.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],LN.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",LN.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",LN.GATEWAY_DOMAINS=["edge.sd-rtn.com"])),"ENABLE_PRE_SUB"===e&&t&&(LN.ENABLE_INSTANT_VIDEO=!0,LN.ENABLE_PREALLOC_PC=!0),"ENABLE_SVC"===e&&t&&(LN.ENABLE_AUT_CC=!0)))}function UN(e){return LN[e]}IN||(LN.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],LN.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],LN.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],LN.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],LN.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],LN.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],LN.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",LN.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",LN.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",LN.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",LN.AREAS=["NORTH_AMERICA","OVERSEA"]);let jN=function(e){return e[e.REALTIME=1]="REALTIME",e}({});const FN={};var BN=function(e){return e.SET_SESSION_ID="SET_SESSION_ID",e.SET_P2P_ID="SET_P2P_id",e.SET_DC_ID="SET_DC_id",e.SET_UID="SET_UID",e.SET_INT_UID="SET_INT_UID",e.SET_PUB_ID="SET_PUB_ID",e.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",e.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",e.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",e.AVOID_JOIN_START="AVOID_JOIN_START",e.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",e.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",e.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",e.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",e.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",e.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",e.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",e.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",e.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",e.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",e.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",e.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",e.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",e.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",e.RESET_KEY_METRICS="RESET_KEY_METRICS",e.SET_USE_P2P="SET_USE_P2P",e.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",e}(BN||{});let VN=class{constructor(e,t,n,r){LI(this,"state",void 0),this.state={codec:e,audioCodec:t,mode:n,clientId:r,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useP2P:!1,p2pTransport:AN.Default,hasStartJoinChannel:!1,isABTestSuccess:!1}}dispatch(e){this.state=function(e,t){switch(t.type){case BN.SET_SESSION_ID:return UI(UI({},e),{},{sessionId:t.sessionId});case BN.SET_P2P_ID:return UI(UI({},e),{},{p2pId:t.p2pId});case BN.SET_UID:return UI(UI({},e),{},{uid:t.uid});case BN.SET_INT_UID:return UI(UI({},e),{},{intUid:t.intUid});case BN.SET_PUB_ID:return UI(UI({},e),{},{pubId:t.pubId});case BN.KEY_METRIC_CLIENT_CREATED:return UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{clientCreated:t.metric})});case BN.KEY_METRIC_JOIN_START:return UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{joinStart:t.metric})});case BN.AVOID_JOIN_START:return UI(UI({},e),{},{avoidJoinStart:t.avoidJoinStart});case BN.KEY_METRIC_JOIN_END:return UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{joinEnd:t.metric})});case BN.KEY_METRIC_REQUEST_AP_START:return UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{requestAPStart:t.metric})});case BN.KEY_METRIC_REQUEST_AP_END:return UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{requestAPEnd:t.metric})});case BN.KEY_METRIC_JOIN_GATEWAY_START:return UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{joinGatewayStart:t.metric})});case BN.KEY_METRIC_JOIN_GATEWAY_END:return UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{joinGatewayEnd:t.metric})});case BN.KEY_METRIC_PEER_CONNECTION_START:return UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{peerConnectionStart:t.metric})});case BN.KEY_METRIC_PEER_CONNECTION_END:return UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{peerConnectionEnd:t.metric})});case BN.KEY_METRIC_DESCRIPTION_START:return UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{descriptionStart:t.metric})});case BN.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{signalChannelOpen:t.metric})});case BN.KEY_METRIC_ICE_CONNECTION_END:return UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{iceConnectionEnd:t.metric})});case BN.KEY_METRIC_PUBLISH:{const n=e.keyMetrics.publish,r=n.findIndex((e=>e.trackId===t.metric.trackId));return-1!==r?(n[r]=UI(UI({},n[r]),t.metric),UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{publish:[...n]})})):UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{publish:[...e.keyMetrics.publish,t.metric]})})}case BN.KEY_METRIC_SUBSCRIBE:{const n=e.keyMetrics.subscribe,r=n.findIndex((e=>e.userId===t.metric.userId&&e.type===t.metric.type));return-1!==r?(n[r]=UI(UI({},n[r]),t.metric),UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{subscribe:[...n]})})):UI(UI({},e),{},{keyMetrics:UI(UI({},e.keyMetrics),{},{subscribe:[...e.keyMetrics.subscribe,t.metric]})})}case BN.SET_CLOUD_PROXY_SERVER_MODE:return e.cloudProxyServerMode=t.mode,e;case BN.RECORD_JOIN_CHANNEL_SERVICE:return"number"!=typeof t.index?e.joinChannelServiceRecords=[...e.joinChannelServiceRecords,t.record]:(e.joinChannelServiceRecords[t.index]=UI(UI({},e.joinChannelServiceRecords[t.index]),t.record),e.joinChannelServiceRecords=[...e.joinChannelServiceRecords]),e;case BN.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return e.joinChannelServiceRecords=[],e;case BN.RESET_KEY_METRICS:return e.keyMetrics={publish:[],subscribe:[]},e;case BN.SET_USE_P2P:return UI(UI({},e),{},{useP2P:t.val});case BN.SET_TRANSPORT_TYPE:return UI(UI({},e),{},{p2pTransport:t.val});default:return e}}(this.state,e)}set sessionId(e){this.dispatch({type:BN.SET_SESSION_ID,sessionId:e})}get sessionId(){return this.state.sessionId}set cid(e){this.state.cid=e}get cid(){return this.state.cid}set codec(e){this.state.codec=e}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(e){this.dispatch({type:BN.SET_P2P_ID,p2pId:e})}get p2pId(){return this.state.p2pId}set dcId(e){this.dispatch({type:BN.SET_DC_ID,dcId:e})}get dcId(){return this.state.dcId}set uid(e){this.dispatch({type:BN.SET_UID,uid:e})}get uid(){return this.state.uid}set intUid(e){this.dispatch({type:BN.SET_INT_UID,intUid:e})}get intUid(){return this.state.intUid}set pubId(e){this.dispatch({type:BN.SET_PUB_ID,pubId:e})}get pubId(){return this.state.pubId}set cloudProxyServerMode(e){this.dispatch({type:BN.SET_CLOUD_PROXY_SERVER_MODE,mode:e})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useP2P(e){this.dispatch({type:BN.SET_USE_P2P,val:e})}get useP2P(){return this.state.useP2P}set p2pTransport(e){this.dispatch({type:BN.SET_TRANSPORT_TYPE,val:e})}get p2pTransport(){return this.state.p2pTransport}set hasStartJoinChannel(e){this.state.hasStartJoinChannel=e}get hasStartJoinChannel(){return this.state.hasStartJoinChannel}set isABTestSuccess(e){this.state.isABTestSuccess=e}get isABTestSuccess(){return this.state.isABTestSuccess}clientCreated(){this.dispatch({type:BN.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:BN.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:BN.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:BN.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:BN.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:BN.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:BN.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:BN.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:BN.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:BN.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:BN.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:BN.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(e,t,n,r){this.dispatch({type:BN.KEY_METRIC_PUBLISH,metric:UI(UI({trackId:e,type:t},n&&{publishStart:n}),r&&{publishEnd:r})})}subscribe(e,t,n,r,o,i,a){this.dispatch({type:BN.KEY_METRIC_SUBSCRIBE,metric:UI(UI(UI(UI(UI({userId:e,type:t},n&&{subscribeStart:n}),r&&{subscribeEnd:r}),o&&{firstFrame:o}),i&&{streamAdded:i}),a&&{firstDecoded:a})})}massSubscribe(e,t,n,r){e.forEach((e=>{this.dispatch({type:BN.KEY_METRIC_SUBSCRIBE,metric:UI(UI(UI({userId:e.userId,type:e.type},t&&{subscribeStart:t}),n&&{subscribeEnd:n}),r&&{firstFrame:r})})}))}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(e,t){"gateway"===e.service&&Array.isArray(e.urls)&&(e.urls=e.urls.map((e=>e.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2"))));try{return"number"!=typeof t?(this.dispatch({type:BN.RECORD_JOIN_CHANNEL_SERVICE,record:UI(UI({},e),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(t<0||t>=this.state.joinChannelServiceRecords.length||this.dispatch({type:BN.RECORD_JOIN_CHANNEL_SERVICE,record:e,index:t}),t)}catch(e){return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:BN.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:BN.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch(e){return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(e){this.dispatch({type:BN.AVOID_JOIN_START,avoidJoinStart:e})}},HN=function(e){return e.h264="h264",e.h265="h265",e.vp8="vp8",e.vp9="vp9",e.av1="av1",e}({});!function(e){e.opus="opus",e.pcma="pcma",e.pcmu="pcmu",e.g722="g722"}({});let GN=0;var WN=(()=>{var e={8:(e,t,n)=>{n.r(t),n.d(t,{Parser:()=>T,Printer:()=>w,parse:()=>k,print:()=>P});const r="\n",o="".concat("\r").concat(r),i=" ";let a;function s(e){return e>="0"&&e<="9"}function c(e){return e>="!"&&e<="~"}function l(e){return c(e)||e>="\x80"&&e<="\xff"}function u(e){return"!"===e||e>="#"&&e<="'"||e>="*"&&e<="+"||e>="-"&&e<="."||e>="0"&&e<="9"||e>="A"&&e<="Z"||e>="^"&&e<="~"}function d(e){return e>="1"&&e<="9"}function p(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"}function h(e){return"d"===e||"h"===e||"m"===e||"s"===e}function f(e){return e>"\x01"&&e<"\t"||e>"\v"&&e<"\f"||e>"\x0e"&&e<"\xff"}function m(e){return p(e)||s(e)||"+"===e||"/"===e}function v(e){return s(e)||p(e)||"+"===e||"/"===e||"-"===e||"_"===e}function g(e){return p(e)||s(e)||"+"===e||"/"===e}function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.VERSION="v",e.ORIGIN="o",e.SESSION_NAME="s",e.INFORMATION="i",e.URI="u",e.EMAIL="e",e.PHONE="p",e.CONNECTION="c",e.BANDWIDTH="b",e.TIME="t",e.REPEAT="r",e.ZONE_ADJUSTMENTS="z",e.KEY="k",e.ATTRIBUTE="a",e.MEDIA="m"}(a||(a={}));class b{consumeText(e,t){let n=t;for(;n<e.length;){const t=e[n];if("\0"===t||"\r"===t||t===r)break;n+=1}if(n-t==0)throw new Error("Invalid text, at ".concat(e));return n}consumeUnicastAddress(e,t,n){return this.consumeTill(e,t,i)}consumeOneOrMore(e,t,n){let r=t;for(;n(e[r]);)r++;if(r-t==0)throw new Error("Invalid rule at ".concat(t,"."));return r}consumeSpace(e,t){if(e[t]===i)return t+1;throw new Error("Invalid space at ".concat(t,"."))}consumeIP4Address(e,t){let n=t;for(let r=0;r<4;r++)if(n=this.consumeDecimalUChar(e,n),3!==r){if("."!==e[n])throw new Error("Invalid IP4 address.");n++}return n}consumeDecimalUChar(e,t){let n=t;for(let o=0;o<3&&s(e[n]);o++,n++);if(n-t==0)throw new Error("Invalid decimal uchar.");const r=parseInt(e.slice(t,n));if(r>=0&&r<=255)return n;throw new Error("Invalid decimal uchar")}consumeIP6Address(e,t){let n=this.consumeHexpart(e,t);return":"===e[n]?(n+=1,n=this.consumeIP4Address(e,n),n):n}consumeHexpart(e,t){let n=t;if(":"===e[n]&&":"===e[n+1]){n+=2;try{n=this.consumeHexseq(e,n)}catch(e){}return n}if(n=this.consumeHexseq(e,n),":"===e[n]&&":"===e[n+1]){n+=2;try{n=this.consumeHexseq(e,n)}catch(e){}return n}return n}consumeHexseq(e,t){let n=t;for(;n=this.consumeHex4(e,n),":"===e[n]&&":"!==e[n+1];)n+=1;return n}consumeHex4(e,t){let n=0;for(;n<4;n++)if(!((r=e[t+n])>="0"&&r<="9"||r>="a"&&r<="f"||r>="A"&&r<="F")){if(0===n)throw new Error("Invalid hex 4");break}var r;return t+n}consumeFQDN(e,t){let n=t;for(;s(e[n])||p(e[n])||"-"===e[n]||"."===e[n];)n+=1;if(n-t<4)throw new Error("Invalid FQDN");return n}consumeExtnAddr(e,t){return this.consumeOneOrMore(e,t,l)}consumeMulticastAddress(e,t,n){switch(n){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(e,t);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(e,t);default:try{return this.consumeFQDN(e,t)}catch(n){return this.consumeExtnAddr(e,t)}}}consumeIP6MulticastAddress(e,t){const n=this.consumeHexpart(e,t);return"/"===e[n]?this.consumeInteger(e,n+1):n}consumeIP4MulticastAddress(e,t){let n=t+3;const r=e.slice(t,n),o=parseInt(r);if(o<224||o>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let i=0;i<3;i++){if("."!==e[n])throw new Error("Invalid IP4 multicast address.");n+=1,n=this.consumeDecimalUChar(e,n)}return"/"===e[n]&&(n+=1),n=this.consumeTTL(e,n),"/"===e[n]&&(n=this.consumeInteger(e,n)),n}consumeInteger(e,t){if(!d(e[t]))throw new Error("Invalid integer.");for(t+=1;s(e[t]);)t+=1;return t}consumeTTL(e,t){if("0"===e[t])return t+1;if(!d(e[t]))throw new Error("Invalid TTL.");t+=1;for(let n=0;n<2&&s(e[t]);n++)t+=1;return t}consumeToken(e,t){return this.consumeOneOrMore(e,t,u)}consumeTime(e,t){let n=t;if("0"===e[n])return n+1;for(d(e[n])&&(n+=1);s(e[n]);)n++;if(n-t<10)throw new Error("Invalid time");return n}consumeAddress(e,t){return this.consumeTill(e,t,i)}consumeTypedTime(e,t){let n=t;return n=this.consumeOneOrMore(e,n,s),h(e[n])?n+1:n}consumeRepeatInterval(e,t){if(!d(e[t]))throw new Error("Invalid repeat interval");for(t+=1;s(e[t]);)t+=1;return h(e[t])&&(t+=1),t}consumePort(e,t){return this.consumeOneOrMore(e,t,s)}consume(e,t,n){for(let r=0;r<n.length;r++){if(t+r>=e.length)throw new Error("consume exceeding value length");if(e[t+r]!==n[r])throw new Error("consume ".concat(n," failed at ").concat(r))}return t+n.length}consumeTill(e,t,n){let r=t;for(;r<e.length&&("string"!=typeof n||e[r]!==n)&&("function"!=typeof n||!n(e[r]));)r++;return r}}class T extends b{constructor(){super(),_(this,"records",[]),_(this,"currentLine",0)}parse(e){const t=this.probeEOL(e);this.records=e.split(t).filter((e=>!!ny(e).call(e))).map(this.parseLine),this.currentLine=0;const n=this.parseVersion(),r=this.parseOrigin(),o=this.parseSessionName(),i=this.parseInformation(),a=this.parseUri(),s=this.parseEmail(),c=this.parsePhone(),l=this.parseConnection(),u=this.parseBandWidth(),d=this.parseTimeFields(),p=this.parseKey(),h=this.parseSessionAttribute(),f=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:n,origin:r,sessionName:o,information:i,uri:a,emails:s,phones:c,connection:l,bandwidths:u,timeFields:d,key:p,attributes:h,mediaDescriptions:f}}getCurrentRecord(){const e=this.records[this.currentLine];if(!e)throw new Error("Record doesn't exit.");return e}probeEOL(e){for(let t=0;t<e.length;t++)if(e[t]===r)return"\r"===e[t-1]?o:r;throw new Error("Invalid newline character.")}parseLine(e,t){if(e.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const n=e[0];if("="!==e[1])throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:n,value:e.slice(2),line:t,cur:0}}parseSessionAttribute(){const e=new O;for(;this.currentLine<this.records.length;){const t=this.getCurrentRecord();if(t.type!==a.ATTRIBUTE)break;const n={attField:this.extractOneOrMore(t,(e=>u(e)&&":"!==e)),_cur:0};":"===t.value[t.cur]&&(t.cur+=1,n.attValue=this.extractOneOrMore(t,f)),e.parse(n),this.currentLine++}return e.digest()}parseMediaAttributes(e){const t=new R(e);for(;this.currentLine<this.records.length;){const e=this.getCurrentRecord();if(e.type!==a.ATTRIBUTE)break;const n={attField:this.extractOneOrMore(e,(e=>u(e)&&":"!==e)),_cur:0};":"===e.value[e.cur]&&(e.cur+=1,n.attValue=this.extractOneOrMore(e,f)),t.parse(n),this.currentLine++}return t.digest()}parseKey(){const e=this.getCurrentRecord();if(e.type===a.KEY){if("prompt"===e.value||"clear:"===e.value||"base64:"===e.value||"uri:"===e.value)return e.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const e=this.getCurrentRecord();if(e.type===a.ZONE_ADJUSTMENTS){const t=[];for(;;)try{const n=this.extract(e,this.consumeTime);this.consumeSpaceForRecord(e);let r=!1;"-"===e.value[e.cur]&&(r=!0,e.cur+=1);const o=this.extract(e,this.consumeTypedTime);t.push({time:n,typedTime:o,back:r})}catch(e){break}if(0===t.length)throw new Error("Invalid zone adjustments");return this.currentLine++,t}return[]}parseRepeat(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==a.REPEAT)break;{const n=this.extract(t,this.consumeRepeatInterval),r=this.parseTypedTime(t);e.push({repeatInterval:n,typedTimes:r}),this.currentLine++}}return e}parseTypedTime(e){const t=[];for(;;)try{this.consumeSpaceForRecord(e),t.push(this.extract(e,this.consumeTypedTime))}catch(e){break}if(0===t.length)throw new Error("Invalid typed time.");return t}parseTime(){const e=this.getCurrentRecord(),t=this.extract(e,this.consumeTime);this.consumeSpaceForRecord(e);const n=this.extract(e,this.consumeTime);return this.currentLine++,{startTime:t,stopTime:n}}parseBandWidth(){const e=[];for(;this.currentLine<this.records.length;){const t=this.getCurrentRecord();if(t.type!==a.BANDWIDTH)break;{const n=this.extractOneOrMore(t,u);if(":"!==t.value[t.cur])throw new Error("Invalid bandwidth field.");t.cur++;const r=this.extractOneOrMore(t,s);e.push({bwtype:n,bandwidth:r}),this.currentLine++}}return e}parseVersion(){const e=this.getCurrentRecord();if(e.type!==a.VERSION)throw new Error("first sdp record must be version");const t=e.value.slice(0,this.consumeOneOrMore(e.value,0,s));if(t.length!==e.value.length)throw new Error('invalid proto version, "v='.concat(e.value,'"'));return this.currentLine++,t}parseOrigin(){const e=this.getCurrentRecord();if(e.type!==a.ORIGIN)throw new Error("second line of sdp must be origin");const t=this.extractOneOrMore(e,l);this.consumeSpaceForRecord(e);const n=this.extractOneOrMore(e,s);this.consumeSpaceForRecord(e);const r=this.extractOneOrMore(e,s);this.consumeSpaceForRecord(e);const o=this.extractOneOrMore(e,u);this.consumeSpaceForRecord(e);const i=this.extractOneOrMore(e,u);this.consumeSpaceForRecord(e);const c=this.extract(e,this.consumeUnicastAddress);return this.currentLine++,{username:t,sessId:n,sessVersion:r,nettype:o,addrtype:i,unicastAddress:c}}parseSessionName(){const e=this.getCurrentRecord();if(e.type===a.SESSION_NAME){const t=this.extract(e,this.consumeText);return this.currentLine++,t}}parseInformation(){const e=this.getCurrentRecord();if(e.type!==a.INFORMATION)return;const t=this.extract(e,this.consumeText);return this.currentLine++,t}parseUri(){const e=this.getCurrentRecord();if(e.type===a.URI)return this.currentLine++,e.value}parseEmail(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==a.EMAIL)break;e.push(t.value),this.currentLine++}return e}parsePhone(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==a.PHONE)break;e.push(t.value),this.currentLine++}return e}parseConnection(){const e=this.getCurrentRecord();if(e.type===a.CONNECTION){const t=this.extractOneOrMore(e,u);this.consumeSpaceForRecord(e);const n=this.extractOneOrMore(e,u);this.consumeSpaceForRecord(e);const r=this.extract(e,this.consumeAddress);return this.currentLine++,{nettype:t,addrtype:n,address:r}}}parseMedia(){const e=this.getCurrentRecord(),t=this.extract(e,this.consumeToken);this.consumeSpaceForRecord(e);let n=this.extract(e,this.consumePort);"/"===e.value[e.cur]&&(e.cur+=1,n+=this.extract(e,this.consumeInteger)),this.consumeSpaceForRecord(e);const r=[];for(r.push(this.extract(e,this.consumeToken));"/"===e.value[e.cur];)e.cur+=1,r.push(this.extract(e,this.consumeToken));if(0===r.length)throw new Error("Invalid proto");const o=this.parseFmt(e);return this.currentLine++,{mediaType:t,port:n,protos:r,fmts:o}}parseTimeFields(){const e=[];for(;this.getCurrentRecord().type===a.TIME;){const t=this.parseTime(),n=this.parseRepeat(),r=this.parseZone();e.push({time:t,repeats:n,zones:r})}return e}parseMediaDescription(){const e=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===a.MEDIA;){const t=this.parseMedia(),n=this.parseInformation(),r=this.parseConnections(),o=this.parseBandWidth(),i=this.parseKey(),a=this.parseMediaAttributes(t);e.push({media:t,information:n,connections:r,bandwidths:o,key:i,attributes:a})}return e}parseConnections(){const e=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===a.CONNECTION;)e.push(this.parseConnection());return e}parseFmt(e){const t=[];for(;;)try{this.consumeSpaceForRecord(e),t.push(this.extract(e,this.consumeToken))}catch(e){break}if(0===t.length)throw new Error("Invalid fmts");return t}extract(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];const i=t.call(this,e.value,e.cur,...r),a=e.value.slice(e.cur,i);return e.cur=i,a}extractOneOrMore(e,t){const n=this.consumeOneOrMore(e.value,e.cur,t),r=e.value.slice(e.cur,n);return e.cur=n,r}consumeSpaceForRecord(e){if(e.value[e.cur]!==i)throw new Error("Invalid space at ".concat(e.cur,"."));e.cur+=1}}class S extends b{constructor(){super(...arguments),_(this,"attributes",void 0),_(this,"digested",!1)}extractOneOrMore(e,t,n){const r=this.consumeOneOrMore(e.attValue,e._cur,t),o=e.attValue.slice(e._cur,r),[i,a]=n||[];if("number"==typeof i&&o.length<i)throw new Error("error in length, should be more or equal than ".concat(i," characters."));if("number"==typeof a&&o.length>a)throw new Error("error in length, should be less or equal than ".concat(a," characters."));return e._cur=r,o}consumeAttributeSpace(e){if(e.attValue[e._cur]!==i)throw new Error("Invalid space at ".concat(e._cur,"."));e._cur+=1}extract(e,t){if(!e.attValue)throw new Error("Nothing to extract from attValue.");for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];const i=t.call(this,e.attValue,e._cur,...r),a=e.attValue.slice(e._cur,i);return e._cur=i,a}atEnd(e){if(!e.attValue)throw new Error;return e._cur>=e.attValue.length}peekChar(e){if(!e.attValue)throw new Error;return e.attValue[e._cur]}peek(e,t){if(!e.attValue)throw new Error;for(let n=0;n<t.length;n++)if(t[n]!==e.attValue[e._cur+n])return!1;return!0}parseIceUfrag(e){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(e,m,[4,256])}parseIcePwd(e){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(e,m,[22,256])}parseIceOptions(e){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const t=[];for(;!this.atEnd(e);){t.push(this.extractOneOrMore(e,m));try{this.consumeAttributeSpace(e)}catch(t){if(this.atEnd(e))break;throw t}}this.attributes.iceOptions=t}parseFingerprint(e){const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill);this.attributes.fingerprints.push({hashFunction:t,fingerprint:n})}parseExtmap(e){const t=this.extractOneOrMore(e,s);let n;"/"===this.peekChar(e)&&(this.extract(e,this.consume,"/"),n=this.extract(e,this.consumeToken)),this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeTill,i),o=y(y({entry:parseInt(t,10)},n&&{direction:n}),{},{extensionName:r});this.peekChar(e)===i&&(this.consumeAttributeSpace(e),o.extensionAttributes=this.extract(e,this.consumeTill)),this.attributes.extmaps.push(o)}parseSetup(e){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const t=this.extract(e,this.consumeTill);if("active"!==t&&"passive"!==t&&"actpass"!==t&&"holdconn"!==t)throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=t}}class O extends S{constructor(){super(...arguments),_(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(e){if(this.digested)throw new Error("already digested");try{switch(e.attField){case"group":this.parseGroup(e);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(e);break;case"ice-pwd":this.parseIcePwd(e);break;case"ice-options":this.parseIceOptions(e);break;case"fingerprint":this.parseFingerprint(e);break;case"setup":this.parseSetup(e);break;case"tls-id":this.parseTlsId(e);break;case"identity":this.parseIdentity(e);break;case"extmap":this.parseExtmap(e);break;case"msid-semantic":this.parseMsidSemantic(e);break;default:e.ignored=!0,this.attributes.unrecognized.push(e)}}catch(t){throw console.error("parsing session attribute ".concat(e.attField,' error, "a=').concat(e.attField,":").concat(e.attValue,'"')),t}if(!e.ignored&&e.attValue&&!this.atEnd(e))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(e){const t=this.extract(e,this.consumeToken),n=[];for(;!this.atEnd(e)&&this.peekChar(e)===i;)this.consumeAttributeSpace(e),n.push(this.extract(e,this.consumeToken));this.attributes.groups.push({semantic:t,identificationTag:n})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(e){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(e,v)}parseIdentity(e){const t=this.extractOneOrMore(e,g),n=[];for(;!this.atEnd(e)&&this.peekChar(e)===i;){this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeToken);this.extract(e,this.consume,"=");const r=this.extractOneOrMore(e,(e=>e!==i&&f(e)));n.push({name:t,value:r})}this.attributes.identities.push({assertionValue:t,extensions:n})}parseMsidSemantic(e){this.peekChar(e)===i&&this.consumeAttributeSpace(e);const t={semantic:this.extract(e,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(e)}catch(e){break}if("*"===this.peekChar(e)){this.extract(e,this.consume,"*"),t.applyForAll=!0;break}{const n=this.extract(e,this.consumeTill,i);t.identifierList.push(n)}}this.attributes.msidSemantic=t}}class R extends S{constructor(e){super(),_(this,"attributes",void 0),-1!==e.protos.indexOf("RTP")||e.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(e){if(this.digested)throw new Error("already digested");try{switch(e.attField){case"extmap":this.parseExtmap(e);break;case"setup":this.parseSetup(e);break;case"ice-ufrag":this.parseIceUfrag(e);break;case"ice-pwd":this.parseIcePwd(e);break;case"ice-options":this.parseIceOptions(e);break;case"candidate":this.parseCandidate(e);break;case"remote-candidate":this.parseRemoteCandidate(e);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(e);break;case"rtpmap":this.parseRtpmap(e);break;case"ptime":this.parsePtime(e);break;case"maxptime":this.parseMaxPtime(e);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(e);break;case"ssrc":this.parseSSRC(e);break;case"fmtp":this.parseFmtp(e);break;case"rtcp-fb":this.parseRtcpFb(e);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(e);break;case"mid":this.parseMid(e);break;case"msid":this.parseMsid(e);break;case"imageattr":this.parseImageAttr(e);break;case"rid":this.parseRid(e);break;case"simulcast":this.parseSimulcast(e);break;case"sctp-port":this.parseSctpPort(e);break;case"max-message-size":this.parseMaxMessageSize(e);break;case"ssrc-group":this.parseSSRCGroup(e);break;default:e.ignored=!0,this.attributes.unrecognized.push(e)}}catch(t){throw console.error("parsing media attribute ".concat(e.attField,' error, "a=').concat(e.attField,":").concat(e.attValue,'"')),t}if(!e.ignored&&e.attValue&&!this.atEnd(e))throw new Error("attribute parsing error")}parseCandidate(e){const t=this.extractOneOrMore(e,m,[1,32]);this.consumeAttributeSpace(e);const n=this.extractOneOrMore(e,s,[1,5]);this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const o=this.extractOneOrMore(e,s,[1,10]);this.consumeAttributeSpace(e);const a=this.extract(e,this.consumeAddress);this.consumeAttributeSpace(e);const l=this.extract(e,this.consumePort);this.consumeAttributeSpace(e),this.extract(e,this.consume,"typ"),this.consumeAttributeSpace(e);const u={foundation:t,componentId:n,transport:r,priority:o,connectionAddress:a,port:l,type:this.extract(e,this.consumeToken),extension:{}};for(this.peek(e," raddr")&&(this.extract(e,this.consume," raddr"),this.consumeAttributeSpace(e),u.relAddr=this.extract(e,this.consumeAddress)),this.peek(e," rport")&&(this.extract(e,this.consume," rport"),this.consumeAttributeSpace(e),u.relPort=this.extract(e,this.consumePort));this.peekChar(e)===i;){this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e),u.extension[t]=this.extractOneOrMore(e,c)}this.attributes.candidates.push(u)}parseRemoteCandidate(e){const t=[];for(;;){const n=this.extractOneOrMore(e,s,[1,5]);this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeAddress);this.consumeAttributeSpace(e);const o=this.extract(e,this.consumePort);t.push({componentId:n,connectionAddress:r,port:o});try{this.consumeAttributeSpace(e)}catch(e){break}}this.attributes.remoteCandidatesList.push(t)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(e){const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill,"/");this.extract(e,this.consume,"/");const r={encodingName:n,clockRate:this.extractOneOrMore(e,s)};this.atEnd(e)||"/"!==this.peekChar(e)||(this.extract(e,this.consume,"/"),r.encodingParameters=parseInt(this.extract(e,this.consumeTill),10));const o=this.attributes.payloads.find((e=>e.payloadType===parseInt(t,10)));o?o.rtpMap=r:this.attributes.payloads.push({payloadType:parseInt(t,10),rtpMap:r,rtcpFeedbacks:[]})}parsePtime(e){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(e,this.consumeTill)}parseMaxPtime(e){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(e,this.consumeTill)}parseDirection(e){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=e.attField}parseSSRC(e){const t=this.extractOneOrMore(e,s);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill,":");let r;":"===this.peekChar(e)&&(this.extract(e,this.consume,":"),r=this.extract(e,this.consumeTill));const o=this.attributes.ssrcs.find((e=>e.ssrcId===parseInt(t,10)));o?o.attributes[n]=r:this.attributes.ssrcs.push({ssrcId:parseInt(t,10),attributes:{[n]:r}})}parseFmtp(e){const t=this.extract(e,this.consumeTill,i);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill),r={};n.split(";").forEach((e=>{let[t,n]=e.split("=");t=ny(t).call(t);const o="string"==typeof n?ny(n).call(n):null;"string"==typeof t&&t.length>0&&(r[t]=o)}));const o=this.attributes.payloads.find((e=>e.payloadType===parseInt(t,10)));o?o.fmtp={parameters:r}:this.attributes.payloads.push({payloadType:parseInt(t,10),rtcpFeedbacks:[],fmtp:{parameters:r}})}parseFmtParameters(e){const t={},n=this.extract(e,this.consumeTill,"=");e._cur++;const r=this.extract(e,this.consumeTill,";");for(t[n]=r;";"===e.attValue[e._cur];){const n=this.extract(e,this.consumeTill,"=");e._cur++;const r=this.extract(e,this.consumeTill,";");t[n]=r}return t}parseRtcpFb(e){let t="";t="*"===this.peekChar(e)?this.extract(e,this.consume,"*"):this.extract(e,this.consumeTill,i),this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill,i);let r;if("trr-int"===n)r={type:n,interval:this.extract(e,this.consumeTill)};else{const t={type:n};this.peekChar(e)===i&&(this.consumeAttributeSpace(e),t.parameter=this.extract(e,this.consumeToken),this.peekChar(e)===i&&(t.additional=this.extract(e,this.consumeTill))),r=t}if("*"===t)this.attributes.rtcpFeedbackWildcards.push(r);else{const e=this.attributes.payloads.find((e=>e.payloadType===parseInt(t,10)));e?e.rtcpFeedbacks.push(r):this.attributes.payloads.push({payloadType:parseInt(t,10),rtcpFeedbacks:[r]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(e){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const t={port:this.extract(e,this.consumePort)};this.peekChar(e)===i&&(this.consumeAttributeSpace(e),t.netType=this.extractOneOrMore(e,u),this.consumeAttributeSpace(e),t.addressType=this.extractOneOrMore(e,u),this.consumeAttributeSpace(e),t.address=this.extract(e,this.consumeAddress)),this.attributes.rtcp=t}parseMsid(e){const t={id:this.extractOneOrMore(e,u,[1,64])};this.peekChar(e)===i&&(this.consumeAttributeSpace(e),t.appdata=this.extractOneOrMore(e,u,[1,64])),this.attributes.msids.push(t)}parseImageAttr(e){this.attributes.imageattr.push(e.attValue)}parseRid(e){const t=this.extractOneOrMore(e,(e=>p(e)||s(e)||"_"===e||"-"===e));this.consumeAttributeSpace(e);const n={id:t,direction:this.extract(e,this.consumeToken),params:[]};if(this.peekChar(e)===i){if(this.consumeAttributeSpace(e),this.peek(e,"pt=")){this.extract(e,this.consume,"pt=");const t=[];for(;;){const n=this.extract(e,this.consumeToken);t.push(n);try{this.extract(e,this.consume,",")}catch(e){break}}n.payloads=t,this.peekChar(e)===i&&this.extract(e,this.consume,i)}for(;;){const t=this.extract(e,this.consumeToken);switch(t){case"depend":{const r={type:t,rids:this.extract(e,this.consume,"=").split(",")};n.params.push(r);break}default:{const r={type:t};"="===this.peekChar(e)&&(this.extract(e,this.consume,"="),r.val=this.extract(e,this.consumeTill,";")),n.params.push(r)}}try{this.extract(e,this.consume,";")}catch(e){break}}}this.attributes.rids.push(n)}parseSimulcast(e){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=e.attValue,this.extract(e,this.consumeTill)}parseSctpPort(e){this.attributes.sctpPort=this.extractOneOrMore(e,s,[1,5])}parseMaxMessageSize(e){this.attributes.maxMessageSize=this.extractOneOrMore(e,s,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(e){this.attributes.mid=this.extract(e,this.consumeToken)}parseSSRCGroup(e){const t=this.extract(e,this.consumeToken),n=[];for(;;)try{this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeInteger);n.push(parseInt(t,10))}catch(e){break}this.attributes.ssrcGroups.push({semantic:t,ssrcIds:n})}}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class w{constructor(){C(this,"eol",o)}print(e,t){let n="";return t&&(this.eol=t),n+=this.printVersion(e.version),n+=this.printOrigin(e.origin),n+=this.printSessionName(e.sessionName),n+=this.printInformation(e.information),n+=this.printUri(e.uri),n+=this.printEmail(e.emails),n+=this.printPhone(e.phones),n+=this.printConnection(e.connection),n+=this.printBandwidth(e.bandwidths),n+=this.printTimeFields(e.timeFields),n+=this.printKey(e.key),n+=this.printSessionAttributes(e.attributes),n+=this.printMediaDescription(e.mediaDescriptions),n}printVersion(e){return"v=".concat(e).concat(this.eol)}printOrigin(e){return"o=".concat(e.username," ").concat(e.sessId," ").concat(e.sessVersion," ").concat(e.nettype," ").concat(e.addrtype," ").concat(e.unicastAddress).concat(this.eol)}printSessionName(e){return e?"s=".concat(e).concat(this.eol):""}printInformation(e){return e?"i=".concat(e).concat(this.eol):""}printUri(e){return e?"u=".concat(e).concat(this.eol):""}printEmail(e){let t="";for(const n of e)t+="e=".concat(n).concat(this.eol);return t}printPhone(e){let t="";for(const n of e)t+="e=".concat(n).concat(this.eol);return t}printConnection(e){return e?"c=".concat(e.nettype," ").concat(e.addrtype," ").concat(e.address).concat(this.eol):""}printBandwidth(e){let t="";for(const n of e)t+="b=".concat(n.bwtype,":").concat(n.bandwidth).concat(this.eol);return t}printTimeFields(e){let t="";for(const n of e){t+="t=".concat(n.time.startTime," ").concat(n.time.startTime).concat(this.eol);for(const e of n.repeats)t+="r=".concat(e.repeatInterval," ").concat(e.typedTimes.join(" ")).concat(this.eol);n.zoneAdjustments&&(t+="z=",t+="z=".concat(n.zoneAdjustments.map((e=>"".concat(e.time," ").concat(e.back?"-":""," ").concat(e.typedTime))).join(" ")).concat(this.eol),t+=this.eol)}return t}printKey(e){return e?"k=".concat(e).concat(this.eol):""}printAttributes(e){let t="";for(const n of e)t+="a=".concat(n.attField).concat(n.attValue?":".concat(n.attValue):"").concat(this.eol);return t}printMediaDescription(e){let t="";for(const n of e)t+=this.printMedia(n.media),t+=this.printInformation(n.information),t+=this.printConnections(n.connections),t+=this.printBandwidth(n.bandwidths),t+=this.printKey(n.key),t+=this.printMediaAttributes(n);return t}printConnections(e){let t="";for(const n of e)t+=this.printConnection(n);return t}printMedia(e){return"m=".concat(e.mediaType," ").concat(e.port," ").concat(e.protos.join("/")," ").concat(e.fmts.join(" ")).concat(this.eol)}printSessionAttributes(e){return new A(this.eol).print(e)}printMediaAttributes(e){return new N(this.eol).print(e)}}class I{constructor(e){C(this,"eol",void 0),this.eol=e}printIceUfrag(e){return void 0===e?"":"a=ice-ufrag:".concat(e).concat(this.eol)}printIcePwd(e){return void 0===e?"":"a=ice-pwd:".concat(e).concat(this.eol)}printIceOptions(e){return void 0===e?"":"a=ice-options:".concat(e.join(i)).concat(this.eol)}printFingerprints(e){return e.length>0?e.map((e=>"a=fingerprint:".concat(e.hashFunction).concat(i).concat(e.fingerprint))).join(this.eol)+this.eol:""}printExtmap(e){return e.map((e=>"a=extmap:".concat(e.entry).concat(e.direction?"/".concat(e.direction):"").concat(i).concat(e.extensionName).concat(e.extensionAttributes?"".concat(i).concat(e.extensionAttributes):"").concat(this.eol))).join("")}printSetup(e){return void 0===e?"":"a=setup:".concat(e).concat(this.eol)}printUnrecognized(e){return e.map((e=>"a=".concat(e.attField).concat(e.attValue?":".concat(e.attValue):"").concat(this.eol))).join("")}}class A extends I{print(e){let t="";return t+=this.printGroups(e.groups),t+=this.printMsidSemantic(e.msidSemantic),t+=this.printIceLite(e.iceLite),t+=this.printIceUfrag(e.iceUfrag),t+=this.printIcePwd(e.icePwd),t+=this.printIceOptions(e.iceOptions),t+=this.printFingerprints(e.fingerprints),t+=this.printSetup(e.setup),t+=this.printTlsId(e.tlsId),t+=this.printIdentity(e.identities),t+=this.printExtmap(e.extmaps),t+=this.printUnrecognized(e.unrecognized),t}printGroups(e){let t="";return e.length>0&&(t+=e.map((e=>"a=group:".concat(e.semantic).concat(e.identificationTag.map((e=>"".concat(i).concat(e))).join("")).concat(this.eol))).join("")),t}printIceLite(e){return void 0===e?"":"a=ice-lite"+this.eol}printTlsId(e){return e?"a=tls-id:".concat(e).concat(this.eol):""}printIdentity(e){return 0===e.length?"":e.map((e=>"a=identity:".concat(e.assertionValue).concat(e.extensions.map((e=>"".concat(i).concat(e.name).concat(e.value?"=".concat(e.value):"")))))).join(this.eol)+this.eol}printMsidSemantic(e){if(!e)return"";let t="a=msid-semantic:".concat(e.semantic);return e.applyForAll?t+="".concat(i,"*"):e.identifierList.length>0&&(t+=e.identifierList.map((e=>"".concat(i).concat(e)))),t+this.eol}}class N extends I{print(e){const t=e.attributes;let n="";return n+=this.printRTCP(t.rtcp),n+=this.printIceUfrag(t.iceUfrag),n+=this.printIcePwd(t.icePwd),n+=this.printIceOptions(t.iceOptions),n+=this.printCandidates(t.candidates),n+=this.printRemoteCandidatesList(t.remoteCandidatesList),n+=this.printEndOfCandidates(t.endOfCandidates),n+=this.printFingerprints(t.fingerprints),n+=this.printSetup(t.setup),n+=this.printMid(t.mid),n+=this.printExtmap(t.extmaps),n+=this.printRTPRelated(t),n+=this.printPtime(t.ptime),n+=this.printMaxPtime(t.maxPtime),n+=this.printDirection(t.direction),n+=this.printSSRCGroups(t.ssrcGroups),n+=this.printSSRC(t.ssrcs),n+=this.printRTCPMux(t.rtcpMux),n+=this.printRTCPMuxOnly(t.rtcpMuxOnly),n+=this.printRTCPRsize(t.rtcpRsize),n+=this.printMSId(t.msids),n+=this.printImageattr(t.imageattr),n+=this.printRid(t.rids),n+=this.printSimulcast(t.simulcast),n+=this.printSCTPPort(t.sctpPort),n+=this.printMaxMessageSize(t.maxMessageSize),n+=this.printUnrecognized(t.unrecognized),n}printCandidates(e){return e.map((e=>"a=candidate:".concat(e.foundation).concat(i).concat(e.componentId).concat(i).concat(e.transport).concat(i).concat(e.priority).concat(i).concat(e.connectionAddress).concat(i).concat(e.port).concat(i,"typ").concat(i).concat(e.type).concat(e.relAddr?"".concat(i,"raddr").concat(i).concat(e.relAddr):"").concat(e.relPort?"".concat(i,"rport").concat(i).concat(e.relPort):"").concat(Object.keys(e.extension).map((t=>"".concat(i).concat(t).concat(i).concat(e.extension[t]))).join("")).concat(this.eol))).join("")}printRemoteCandidatesList(e){return e.map((e=>"a=remote-candidates:".concat(e.join(i)).concat(this.eol))).join("")}printEndOfCandidates(e){return void 0===e?"":"a=end-of-candidates"+this.eol}printRTPRelated(e){if(!e.payloads)return"";const t=e.payloads;let n="";n+=e.rtcpFeedbackWildcards.map((e=>this.printRTCPFeedback("*",e))).join("");for(const r of t)n+=this.printRtpMap(r.payloadType,r.rtpMap),n+=this.printFmtp(r.payloadType,r.fmtp),n+=r.rtcpFeedbacks.map((e=>this.printRTCPFeedback(r.payloadType,e))).join("");return n}printFmtp(e,t){if(!t)return"";const n=Object.keys(t.parameters);return 1===n.length&&null===t.parameters[n[0]]?"a=fmtp:".concat(e).concat(i).concat(n[0]).concat(this.eol):"a=fmtp:".concat(e).concat(i).concat(Object.keys(t.parameters).map((e=>"".concat(e,"=").concat(t.parameters[e]))).join(";")).concat(this.eol)}printRtpMap(e,t){return t?"a=rtpmap:".concat(e).concat(i).concat(t.encodingName,"/").concat(t.clockRate).concat(t.encodingParameters?"/".concat(t.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(e,t){let n="a=rtcp-fb:".concat(e).concat(i),r=t;return"trr-int"===r.type?n+="ttr-int".concat(i).concat(r.interval):(n+="".concat(r.type),r.parameter&&(n+="".concat(i).concat(r.parameter),r.additional&&(n+="".concat(i).concat(r.additional)))),n+this.eol}printPtime(e){return void 0===e?"":"a=ptime:".concat(e).concat(this.eol)}printMaxPtime(e){return void 0===e?"":"a=maxptime:".concat(e).concat(this.eol)}printDirection(e){return void 0===e?"":"a=".concat(e).concat(this.eol)}printSSRC(e){return e.map((e=>Object.keys(e.attributes).map((t=>"a=ssrc:".concat(e.ssrcId.toString(10)).concat(i).concat(t).concat(e.attributes[t]?":".concat(e.attributes[t]):"").concat(this.eol))).join(""))).join("")}printRTCPMux(e){return void 0===e?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(e){return void 0===e?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(e){return void 0===e?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(e){if(void 0===e)return"";let t="a=rtcp:".concat(e.port);return e.netType&&(t+="".concat(i).concat(e.netType)),e.addressType&&(t+="".concat(i).concat(e.addressType)),e.address&&(t+="".concat(i).concat(e.address)),t+this.eol}printMSId(e){return e.map((e=>"a=msid:".concat(e.id).concat(e.appdata?"".concat(i).concat(e.appdata):"").concat(this.eol))).join("")}printImageattr(e){return e.map((e=>"a=imageattr:".concat(e).concat(this.eol))).join("")}printRid(e){return e.map((e=>{let t="a=rid:".concat(e.id).concat(i).concat(e.direction);return e.payloads&&(t+="".concat(i,"pt=").concat(e.payloads.join(","))),e.params.length>0&&(t+="".concat(i).concat(e.params.map((e=>"depend"===e.type?"depend=".concat(e.rids.join(",")):"".concat(e.type,"=").concat(e.val))).join(";"))),t+this.eol})).join("")}printSimulcast(e){return void 0===e?"":"a=simulcast:".concat(e).concat(this.eol)}printSCTPPort(e){return void 0===e?"":"a=sctp-port:".concat(e).concat(this.eol)}printMaxMessageSize(e){return void 0===e?"":"a=max-message-size:".concat(e).concat(this.eol)}printMid(e){return void 0===e?"":"a=mid:".concat(e).concat(this.eol)}printSSRCGroups(e){return e.map((e=>"a=ssrc-group:".concat(e.semantic).concat(e.ssrcIds.map((e=>"".concat(i).concat(e.toString(10)))).join("")).concat(this.eol))).join("")}}function k(e){return(new T).parse(e)}function P(e,t){return(new w).print(e,t)}}},t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}return n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(8)})();function qN(e){return WN.parse(e)}function KN(e,t){return WN.print(e,t)}var YN=rr("Array","keys"),zN=yr,XN=rt,JN=h,ZN=YN,QN=Array.prototype,$N={DOMTokenList:!0,NodeList:!0},ek=function(e){var t=e.keys;return e===QN||JN(QN,e)&&t===QN.keys||XN($N,zN(e))?ZN:t},tk=i(ek);function nk(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ok(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rk(Object(n),!0).forEach((function(t){nk(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rk(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const ik=new class extends eA{constructor(){super(...arguments),nk(this,"currentUploadLogID",0)}reportLogUploadError(e){const{errorRange:t}=e;t[t.length-1]&&t[t.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=t[t.length-1],this.emit("REPORT_LOG_UPLOAD",e))}};class ak{constructor(e){nk(this,"logger",void 0),nk(this,"prefixLists",[]),this.logger=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.debug(...this.prefixLists,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.info(...this.prefixLists,...t)}warning(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.warning(...this.prefixLists,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.error(...this.prefixLists,...t)}prefix(e){return this.prefixLists.push(e),this}popPrefix(){return this.prefixLists.pop(),this}}function sk(){const e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}function ck(){const e=new Date,t=/((\d+:){2}\d+)/.exec((new Date).toUTCString());return t?(null==t?void 0:t[0])+":"+e.getUTCMilliseconds():e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}const lk={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},uk=Date.now(),dk=e=>{for(const t in lk)if(Object.prototype.hasOwnProperty.call(lk,t)&&lk[t]===e)return t;return"DEFAULT"},pk=new class{constructor(){nk(this,"proxyServerURL",void 0),nk(this,"logLevel",lk.DEBUG),nk(this,"uploadState","collecting"),nk(this,"uploadLogWaitingList",[]),nk(this,"uploadLogUploadingList",[]),nk(this,"uploadErrorCount",0),nk(this,"currentLogID",0),nk(this,"url",void 0),nk(this,"extLog",((e,t)=>{this.appendLogToWaitingList(e,...t)}))}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[lk.DEBUG].concat(t);this.log.apply(this,r)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[lk.INFO].concat(t);this.log.apply(this,r)}warning(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[lk.WARNING].concat(t);this.log.apply(this,r)}warn(){this.warning(...arguments)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[lk.ERROR].concat(t);this.log.apply(this,r)}upload(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[lk.DEBUG].concat(t);this.uploadLog.apply(this,r)}setLogLevel(e){e=Math.min(Math.max(0,e),4),this.logLevel=e}enableLogUpload(){xN("UPLOAD_LOG",!0)}disableLogUpload(){xN("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(e){this.proxyServerURL=e}prefix(e){return new ak(this).prefix(e)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(Date.now()-uk<100)return void setTimeout((()=>{this.log(...t)}),Date.now()-uk);const r=Math.max(0,Math.min(4,t[0]));if(t[0]=sk()+" Agora-SDK [".concat(dk(r),"]:"),this.appendLogToWaitingList(r,...t),r<this.logLevel)return;const o=sk()+" %cAgora-SDK [".concat(dk(r),"]:");let i=[];if(!UN("USE_NEW_LOG"))switch(r){case lk.DEBUG:i=[o,"color: #64B5F6;"].concat(t.slice(1)),console.log.apply(console,i);break;case lk.INFO:i=[o,"color: #1E88E5; font-weight: bold;"].concat(t.slice(1)),console.log.apply(console,i);break;case lk.WARNING:i=[o,"color: #FB8C00; font-weight: bold;"].concat(t.slice(1)),console.warn.apply(console,i);break;case lk.ERROR:i=[o,"color: #B00020; font-weight: bold;"].concat(t.slice(1)),console.error.apply(console,i)}}uploadLog(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(Date.now()-uk<100)return void setTimeout((()=>{this.uploadLog(...t)}),Date.now()-uk);const r=Math.max(0,Math.min(4,t[0]));t[0]=sk()+" Agora-SDK [".concat(dk(r),"]:"),this.appendLogToWaitingList(r,...t)}appendLogToWaitingList(e){if(!UN("UPLOAD_LOG"))return;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Array.isArray(n[0])?n[0][0]=ck()+" Agora-SDK [".concat(dk(e),"]:"):n[0]=ck()+" Agora-SDK [".concat(dk(e),"]:");let o="";n.forEach((e=>{"object"==typeof e&&(e=JSON.stringify(e)),o+="".concat(e," ")})),this.uploadLogWaitingList.push({payload_str:o,log_level:e,log_item_id:this.currentLogID++}),"uploading"===this.uploadState&&0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}async uploadLogs(){const e=this.uploadLogUploadingList,t={sdk_version:wN,process_id:UN("PROCESS_ID"),payload:JSON.stringify(e)};return ZA((async()=>{const e=await Xw.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(UN("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(UN("LOG_UPLOAD_SERVER"),"/upload/v1")),t,{responseType:"text"});if("OK"!==e.data){const t=new Error("unexpected upload log response");throw t.response=e,t}}),(()=>(this.uploadLogUploadingList=[],!1)),(t=>{const n={status:-1,message:t.message,errorRange:e.map((e=>e.log_item_id))};return t.response?(n.status=t.response.status,n.data=t.response.data,n.headers=t.response.headers):t.request&&(n.status=t.request.status),ik.reportLogUploadError(n),!0}),{timeout:UN("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:UN("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){0===this.uploadLogUploadingList.length&&0===this.uploadLogWaitingList.length||(0===this.uploadLogUploadingList.length&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,UN("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then((()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout((()=>this.uploadLogInterval()),UN("UPLOAD_LOG_INTERVAL"))})).catch((e=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout((()=>this.uploadLogInterval()),UN("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout((()=>this.uploadLogInterval()),UN("UPLOAD_LOG_RETRY_INTERVAL_V1"))})))}};var hk;function fk(e){return WI(e.reportId,"params.reportId",0,100,!1),WI(e.category,"params.category",0,100,!1),WI(e.event,"params.event",0,100,!1),WI(e.label,"params.label",0,100,!1),HI(e.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(hk={}).FREE="free",hk.UPLOADING="uploading",function(e){e[e.MISC=0]="MISC",e[e.INTERNAL_EVENT=1]="INTERNAL_EVENT",e[e.PUBLIC_EVENT=2]="PUBLIC_EVENT",e[e.WEB_EVENT=3]="WEB_EVENT",e[e.INTERNAL_API=4]="INTERNAL_API",e[e.WEB_API=5]="WEB_API",e[e.PUBLIC_API=6]="PUBLIC_API"}({});const mk={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let vk=function(e){return e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.WS_COMPRESSOR_INIT="ws_compressor_init",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.REJOIN_GATEWAY="rejoin_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics",e.PC_STATS="pc_stats",e.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",e.AB_TEST="ab_test",e}({}),gk=function(e){return e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",e.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",e.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",e.PC_STATS="io.agora.pb.Wrtc.PCStats",e.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",e.AB_TEST="io.agora.pb.Wrtc.ABTest",e}({});!function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}({});let Ek=function(e){return e[e.SESSION=26]="SESSION",e[e.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",e[e.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",e[e.JOIN_GATEWAY=28]="JOIN_GATEWAY",e[e.PUBLISH=30]="PUBLISH",e[e.SUBSCRIBE=29]="SUBSCRIBE",e[e.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",e[e.STREAM_SWITCH=32]="STREAM_SWITCH",e[e.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",e[e.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",e[e.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",e[e.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",e[e.API_INVOKE=41]="API_INVOKE",e[e.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",e[e.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",e[e.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",e[e.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",e[e.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",e[e.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",e[e.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",e[e.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",e[e.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",e[e.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",e[e.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",e[e.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",e[e.USER_ANALYTICS=1e4]="USER_ANALYTICS",e[e.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",e}({});function yk(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,n,r){const o=r.value;if("function"==typeof o){const i=e.className||t.__className__||("AgoraRTCClient"===t.constructor.name?"Client":t.constructor.name);r.value=function(){for(var t,r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];let c=a;if(e.argsMap)try{c=e.argsMap(this,...a)}catch(e){pk.warning(e),c=[]}try{JSON.stringify(c)}catch(e){pk.warning("arguments for method ".concat(i,".").concat(String(n)," not serializable for apiInvoke.")),c=[]}const l=(e.report||_k).reportApiInvoke(this._sessionId||null,{id:this._clientId||(null===(t=this.store)||void 0===t?void 0:t.clientId)||this._ID,name:"".concat(i,".").concat(String(n)),options:c,tag:oA.TRACER,reportResult:e.reportResult},e.throttleTime);try{const t=o.apply(this,a);return t instanceof ih?t.then((t=>(l.onSuccess(e.reportResult&&t),t))).catch((e=>{throw l.onError(e),e})):(l.onSuccess(e.reportResult&&t),t)}catch(e){throw l.onError(e),e}}}return r}}const _k=new class{constructor(){nk(this,"baseInfoMap",new Map),nk(this,"proxyServer",void 0),nk(this,"eventUploadTimer",void 0),nk(this,"setSessionIdTimer",void 0),nk(this,"url",void 0),nk(this,"sids",new Set),nk(this,"backupUrl",void 0),nk(this,"_appId",void 0),nk(this,"_aid",0),nk(this,"keyEventUploadPendingItems",[]),nk(this,"normalEventUploadPendingItems",[]),nk(this,"apiInvokeUploadPendingItems",[]),nk(this,"apiInvokeCount",0),nk(this,"apiInvokeLoggedCount",0),nk(this,"ltsList",[]),nk(this,"lastSendNormalEventTime",Date.now()),nk(this,"customReportCounterTimer",void 0),nk(this,"customReportCount",0),nk(this,"extApiInvoke",(async e=>{for(const t of e){const e=ok(ok({},t),{},{sid:null,invokeId:++this.apiInvokeCount,tag:oA.TRACER});this.sendApiInvoke(e)}})),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),UN("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),UN("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(e){return this.baseInfoMap.get(e)}setAppId(e){this._appId=e,this._aid=parseInt(e.replace(/[a-fA-F0-9]{8}/g,(e=>{let[t,n]=e;return t+n})),16)||0}reportApiInvoke(e,t,n){t.timeout=t.timeout||6e4,t.reportResult=void 0===t.reportResult||t.reportResult;const r=Date.now();this.apiInvokeCount+=1;const o=this.apiInvokeCount,i=!!UN("SHOW_REPORT_INVOKER_LOG"),a=!!UN("SHOW_REPORT_USER_INVOKER_LOG"),s=i||a&&t.id;s&&(this.apiInvokeLoggedCount+=1);const c=this.apiInvokeLoggedCount;function l(e,n){if(s){let r="[apiInvoke-".concat(c,"]");t.id&&(r+="[".concat(t.id,"]")),t.name&&(r+="[".concat(t.name,"]")),pk.info("".concat(r," ").concat(e),"start"===e?t.options:n||"")}}const u=()=>({tag:t.tag,invokeId:o,sid:e,name:t.name,apiInvokeTime:r,options:t.options,states:t.states||null});l("start");let d=!1;MA(t.timeout).then((()=>{d||(this.sendApiInvoke(ok(ok({},u()),{},{error:jI.API_INVOKE_TIMEOUT,success:!1})),l("timeout"))}));const p=new FI(jI.UNEXPECTED_ERROR,"".concat(t.name,": this api invoke is end"));return{onSuccess:e=>{const r=()=>{if(d)throw p;return d=!0,this.sendApiInvoke(ok(ok({},u()),{},{success:!0},t.reportResult&&{result:e})),l("onSuccess"),e};return n?FA(r,t.name+"Success",n,(()=>d=!0)):r()},onError:e=>{const r=()=>{if(d)throw e;d=!0,this.sendApiInvoke(ok(ok({},u()),{},{success:!1,error:e})),l("onFailure",e.toString())};return n?FA(r,t.name+"Error",n,(()=>d=!0)):r()}}}sessionInit(e,t){if(this.baseInfoMap.has(e))return;const n=Date.now(),r=this.createBaseInfo(e,n);r.cname=t.cname;const o=Object.assign({},{willUploadConsoleLog:UN("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:IN?"global":"oversea",areas:UN("AREAS")&&UN("AREAS").join(",")},t.extend),{stringUid:i,channelProfile:a,channelMode:s,isABTestSuccess:c,lsid:l,clientRole:u}=t,d=Date.now(),p=ok(ok({},r),{},{eventType:vk.SESSION_INIT,appid:t.appid,browser:navigator.userAgent,buildFormat:t.buildFormat,build:DN,lts:d,elapse:d-n,extend:JSON.stringify(o),mode:t.mode,process:UN("PROCESS_ID"),appType:UN("APP_TYPE"),success:!0,version:wN,stringUid:i,channelProfile:a,channelMode:s,isABTestSuccess:c,lsid:l,clientType:Ur(h=window.navigator.userAgent).call(h,"AgoraWebView")?42:20,clientRole:u,serviceId:UN("PROCESS_ID"),extensionID:UN("PLUGIN_INFO").join(",")||""});var h;this.send({type:gk.SESSION,data:p},!0)}joinChooseServer(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now(),i=ok(ok({},r),{},{role:t.role,eventType:vk.JOIN_CHOOSE_SERVER,lts:o,eventElapse:t.elapse||o-t.lts,chooseServerAddr:t.csAddr,errorCode:t.ec,elapse:o-n.startTime,success:t.succ,chooseServerAddrList:JSON.stringify(t.serverList),uid:t.uid?parseInt(t.uid):null,cid:t.cid?parseInt(t.cid):null,chooseServerIp:t.csIp||"",opid:t.opid,unilbsServerIds:t.unilbsServerIds,extend:t.extend||void 0,isHttp3:t.isHttp3,corssRegionTagReq:t.corssRegionTagReq||void 0,corssRegionTagRes:t.corssRegionTagRes||void 0});this.send({type:gk.JOIN_CHOOSE_SERVER,data:i},!0)}reqUserAccount(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now(),i=ok(ok({},r),{},{eventType:vk.REQ_USER_ACCOUNT,lts:o,success:t.success,serverAddress:t.serverAddr,stringUid:t.stringUid,uid:t.uid,errorCode:t.errorCode,elapse:t.elapse||o-n.startTime,eventElapse:o-t.lts,extend:JSON.stringify(t.extend)});this.send({type:gk.REQ_USER_ACCOUNT,data:i},!0)}joinGateway(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info;t.vid&&(r.vid=t.vid),r.uid=t.uid,r.cid=t.cid;const o=Date.now(),{firstSuccess:i,avoidJoinStartTime:a,addr:s,isProxy:c}=t,l=o-(i&&a?a:n.startTime),u=ok(ok({},r),{},{eventType:vk.JOIN_GATEWAY,lts:o,gatewayAddr:t.addr,success:t.succ,errorCode:t.ec,errorMsg:t.errorMsg||"",elapse:l,eventElapse:o-t.lts,firstSuccess:i,signalChannel:t.signalChannel,preload:t.preload?1:0,installId:CN(),isABTestSuccess:t.isABTestSuccess?1:0}),d=u.success?1:0;if(t.succ&&(n.lastJoinSuccessTime=o),i)this.send({type:gk.JOIN_GATEWAY,data:u},!0);else{let e;if(s)if(c){const t=s.match(/h=(\d{1,3}-){3}\d{1,3}/g),n=s.match(/p=[0-9]{1,6}/g);e={isSuccess:d,gatewayIp:t&&t.length?t[0].split("=")[1].replace(/-/g,"."):"",port:n&&n.length?n[0].split("=")[1]:"",isProxy:c?1:0}}else{const t=s.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),n=s.match(/(:|p=)[0-9]{1,6}/g);e={isSuccess:d,gatewayIp:t&&t.length?t[0].split("//")[1].replace(/-/g,"."):"",port:n&&n.length?n[0].split(/:|p=/g)[1]:"",isProxy:c?1:0}}else e={isSuccess:d,gatewayIp:"",port:"",isProxy:c?1:0};delete u.success,delete u.eventType,delete u.firstSuccess,u.vid=Number(u.vid);const t=Object.assign({},u,e,{eventType:vk.REJOIN_GATEWAY});this.send({type:gk.RE_JOIN_GATEWAY,data:t},!0)}}joinChannelTimeout(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=Date.now(),o=ok(ok({},n.info),{},{lts:r,timeout:t,elapse:r-n.startTime});this.send({type:gk.JOIN_CHANNEL_TIMEOUT,data:o},!0)}publish(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now(),i=ok(ok({},r),{},{eventType:vk.PUBLISH,lts:o,eventElapse:t.eventElapse,elapse:o-n.startTime,success:t.succ,errorCode:t.ec,videoName:t.videoName,audioName:t.audioName,screenName:t.screenName,screenshare:t.screenshare,audio:t.audio,video:t.video,p2pid:t.p2pid,publishRequestid:t.publishRequestid});this.send({type:gk.PUBLISH,data:i},!0)}subscribe(e,t,n){const r=this.baseInfoMap.get(e);if(!r)return;const o=r.info,i=Date.now(),a=ok(ok({},o),{},{eventType:vk.SUBSCRIBE,lts:i,eventElapse:t.eventElapse,elapse:i-r.startTime,success:t.succ,errorCode:t.ec,video:t.video,audio:t.audio,subscribeRequestid:t.subscribeRequestid,p2pid:t.p2pid,preSsrc:t.preSsrc?1:0},n&&{extend:JSON.stringify({isMassSubscribe:!0})});"string"==typeof t.peerid?a.peerSuid=t.peerid:a.peer=t.peerid,this.send({type:gk.SUBSCRIBE,data:a},!0)}wsCompressorInit(e){var t;const n=[...tk(t=this.baseInfoMap).call(t)],r=n.length?n[0]:"UnableToGetSid",o=this.baseInfoMap.get(r);if(!o)return;const i=o.info,a=Date.now(),s=ok(ok({},i),{},{eventType:vk.WS_COMPRESSOR_INIT,lts:a,eventElapse:e.eventElapse,elapse:a-o.startTime,status:e.status?1:2});this.send({type:gk.WS_COMPRESSOR_INIT,data:s},!0)}firstRemoteVideoDecode(e,t,n,r){const o=this.baseInfoMap.get(e);if(!o)return;const i=o.info,a=Date.now(),s=ok(ok(ok({},i),r),{},{elapse:a-o.startTime,eventType:t,lts:a,firstDecodeFrame:Math.max((r.firstFrame||a)-o.startTime,0),apEnd:Math.max(r.apEnd-o.startTime,0),apStart:Math.max(r.apStart-o.startTime,0),joinGwEnd:Math.max(r.joinGwEnd-o.startTime,0),joinGwStart:Math.max(r.joinGwStart-o.startTime,0),pcEnd:Math.max(r.pcEnd-o.startTime,0),pcStart:Math.max(r.pcStart-o.startTime,0),subscriberEnd:Math.max(r.subscriberEnd-o.startTime,0),subscriberStart:Math.max(r.subscriberStart-o.startTime,0),videoAddNotify:Math.max(r.videoAddNotify-o.startTime,0)});this.send({type:n,data:s},!0)}firstRemoteFrame(e,t,n,r){const o=this.baseInfoMap.get(e);if(!o)return;const i=o.info,a=Date.now(),s=ok(ok(ok({},i),r),{},{elapse:a-o.startTime,eventType:t,lts:a});this.send({type:n,data:s},!0)}abTest(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now(),i=ok(ok(ok({},r),t),{},{vid:void 0===r.vid?0:Number(r.vid),elapse:o-n.startTime,eventType:vk.AB_TEST,lts:o});this.send({type:gk.AB_TEST,data:i},!0)}pcStats(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now(),i=ok(ok(ok({},r),t),{},{vid:void 0===r.vid?0:Number(r.vid),elapse:o-n.startTime,eventType:vk.PC_STATS,lts:o,preallocation:t.preallocation?1:0});this.send({type:gk.PC_STATS,data:i},!0)}updateRemoteRTPCapabilities(e,t){if(e){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now(),i=ok(ok(ok({},r),t),{},{vid:void 0===r.vid?0:Number(r.vid),eventType:vk.UPDATE_REMOTE_RTPCAPABILITIES,lts:o});this.send({type:gk.UPDATE_REMOTE_RTPCAPABILITIES,data:i},!0)}}onGatewayStream(e,t,n,r){const o=this.baseInfoMap.get(e);if(!o)return;const i=o.info,a=Date.now(),s=ok(ok(ok({},i),r),{},{eventType:t,lts:a});this.send({type:n,data:s},!0)}streamSwitch(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now(),i=ok(ok({},r),{},{eventType:vk.STREAM_SWITCH,lts:o,isDual:t.isdual,elapse:o-n.startTime,success:t.succ});this.send({type:gk.STREAM_SWITCH,data:i},!0)}requestProxyAppCenter(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now(),i=ok(ok({},r),{},{eventType:vk.REQUEST_PROXY_APPCENTER,lts:o,eventElapse:o-t.lts,elapse:o-n.startTime,APAddr:t.APAddr,workerManagerList:t.workerManagerList,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:gk.REQUEST_PROXY_APPCENTER,data:i},!0)}requestProxyWorkerManager(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now(),i=ok(ok({},r),{},{eventType:vk.REQUEST_PROXY_WORKER_MANAGER,lts:o,eventElapse:o-t.lts,elapse:o-n.startTime,workerManagerAddr:t.workerManagerAddr,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:gk.REQUEST_PROXY_WORKER_MANAGER,data:i},!0)}setProxyServer(e){this.proxyServer=e,e?pk.debug("reportProxyServerurl: ".concat(e)):pk.debug("disable reportProxyServerurl: ".concat(e))}peerPublishStatus(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now(),i=ok(ok({},r),{},{subscribeElapse:t.subscribeElapse,peer:t.peer,peerPublishDuration:Math.max(t.audioPublishDuration,t.videoPublishDuration),audiotag:t.audioPublishDuration>0?1:-1,videotag:t.videoPublishDuration>0?1:-1,lts:o,elapse:o-n.startTime,joinChannelSuccessElapse:o-(n.lastJoinSuccessTime||o),peerPublishDurationVideo:t.videoPublishDuration,peerPublishDurationAudio:t.audioPublishDuration});this.send({type:gk.PEER_PUBLISH_STATUS,data:i},!0)}workerEvent(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now();(function(e,t,n){const r=e[t];if(!r||"string"!=typeof r)return[e];e[t]="";const o=kA(JSON.stringify(e));let i=0;const a=[];let s=0;for(let c=0;c<r.length;c++)s+=r.charCodeAt(c)<=127?1:3,s<=n-o||(a[a.length]=UI(UI({},e),{},{[t]:r.substring(i,c)}),i=c,s=r.charCodeAt(c)<=127?1:3);return i!==r.length-1&&(a[a.length]=UI(UI({},e),{},{[t]:r.substring(i)})),a})(ok(ok(ok({},r),t),{},{elapse:o-n.startTime,lts:o,productType:"WebRTC"}),"payload",1300).forEach((e=>this.send({type:gk.WORKER_EVENT,data:e},!0)))}apworkerEvent(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now(),i=ok(ok(ok({},r),t),{},{elapse:o-n.startTime,lts:o});this.send({type:gk.AP_WORKER_EVENT,data:i},!0)}joinWebProxyAP(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now(),i=ok(ok(ok({},r),t),{},{elapse:o-n.startTime,lts:o,extend:t.extend||void 0});this.send({type:gk.JOIN_WEB_PROXY_AP,data:i},!0)}WebSocketQuit(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now(),i=ok(ok(ok({},r),t),{},{elapse:o-n.startTime,lts:o});this.send({type:gk.WEBSOCKET_QUIT,data:i},!0)}async sendCustomReportMessage(e,t){if(this.customReportCount+=t.length,this.customReportCount>UN("CUSTOM_REPORT_LIMIT"))throw new FI(jI.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval((()=>{this.customReportCount=0}),5e3));const n=Date.now(),r=t.map((t=>({type:gk.USER_ANALYTICS,data:ok(ok({sid:e},t),{},{lts:n})})));try{UN("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(r):await this.postDataToStatsCollector(r)}catch(e){throw pk.error("send custom report message failed",e.toString()),new FI(jI.CUSTOM_REPORT_SEND_FAILED,e.message)}}sendApiInvoke(e){const t=UN("NOT_REPORT_EVENT");if(e.tag&&Ur(t)&&Ur(t).call(t,e.tag))return!1;if(null===e.sid)return this.apiInvokeUploadPendingItems.push(e),!1;const n=this.baseInfoMap.get(e.sid);if(!n)return this.apiInvokeUploadPendingItems.push(e),!1;const{cname:r,uid:o,cid:i}=n.info;let a;if(e.lts=e.lts||Date.now(),e.error)if(e.error instanceof FI){const{code:t,message:n}=e.error;a=t||n||e.error.toString()}else a=e.error.toString();const s={invokeId:e.invokeId,sid:e.sid,cname:r,cid:i,uid:o,lts:e.lts,success:e.success,elapse:e.lts-n.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?JSON.stringify(e.options):void 0,execStates:e.states?JSON.stringify(e.states):void 0,execResult:e.result?JSON.stringify(e.result):void 0,errorCode:e.error?a:void 0,errorMsg:e.error?JSON.stringify(e.error):void 0};return this.send({type:gk.API_INVOKE,data:s},!1),!0}addSid(e){this.sids.add(e)}removeSid(e){this.sids.delete(e)}appendSessionId(){const e=this.apiInvokeUploadPendingItems;if(0===e.length)return;const t=Array.from(this.sids).find((e=>null!==e));t&&e.forEach((e=>{e&&(e.sid=t,this.sendApiInvoke(Object.assign({},e)))})),e.length=0}send(e,t){if(t)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>UN("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(e,t){const n=[],r=[];for(;e.length;){const t=e.shift();n.length<20?n.push(t):r.push(t)}e.push(...r);for(const i of[...n]){var o;-1!==this.ltsList.indexOf(i.data.lts)?(i.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(i.data.lts)):(this.ltsList.push(i.data.lts),Xy(o=this.ltsList).call(o,((e,t)=>e-t)))}return t||(this.lastSendNormalEventTime=Date.now()),UN("ENABLE_EVENT_REPORT")?(n.length&&(UN("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(n):this.postDataToStatsCollector(n)).catch((e=>n=>{UN("EVENT_REPORT_RETRY")&&(t?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(e):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(e),this.normalEventUploadPendingItems.length>UN("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-UN("NORMAL_EVENT_QUEUE_CAPACITY")),pk.warning("report: drop normal events"))))})(n)),e):e}async postDataToStatsCollector2(e){yA.networkState===hA.OFFLINE&&await ih.race([yA.onlineWaiter,MA(2*XA.maxRetryTimeout)]);const t=e=>{let t=new Uint8Array;return e.forEach((e=>{const n=ZI(JSON.stringify(e.data)),r=new ArrayBuffer(5),o=(e=>{let t=0;return Object.entries(gk).forEach((n=>{let[r,o]=n;o===e.type&&(t=Ek[r])})),t})(e),i=new DataView(r);i.setUint16(0,n.byteLength,!0),i.setUint8(2,255&o),i.setUint8(3,o>>>8&255),i.setUint8(4,o>>>16&255),t=QI(t,new Uint8Array(r)),t=QI(t,n)})),t},n="event";let r=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(UN("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(n):"https://".concat(UN("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(n);for(let o=0;o<2;o+=1){1===o&&(r=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(UN("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(n):"https://".concat(UN("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(n));try{await nN(r,{timeout:1e4,data:t(e),headers:ok(ok({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(e){if(1===o)throw e;continue}return}}async postDataToStatsCollector(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(e=>{const t=e&&e.data.sid&&this.baseInfoMap.get(e.data.sid);return t&&t.info.vid&&+t.info.vid||0})(e[0]),r=n?void 0:this._aid,o={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:e.map((e=>JSON.stringify(e))),vid:n,aid:r};yA.networkState===hA.OFFLINE&&await ih.race([yA.onlineWaiter,MA(2*XA.maxRetryTimeout)]);const i=t?"/events/proto-raws":"/events/messages";let a=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(UN("EVENT_REPORT_DOMAIN"),"&p=").concat(UN("STATS_COLLECTOR_PORT"),"&d=").concat(i):"https://".concat(UN("EVENT_REPORT_DOMAIN"),":").concat(UN("STATS_COLLECTOR_PORT")).concat(i));for(let s=0;s<2;s+=1){1===s&&(a=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(UN("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(UN("STATS_COLLECTOR_PORT"),"&d=").concat(i):"https://".concat(UN("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(UN("STATS_COLLECTOR_PORT")).concat(i)));try{t?await rN(a,{timeout:1e4,data:o}):await nN(a,{timeout:1e4,data:o})}catch(t){if(1===s)throw t;continue}return}}createBaseInfo(e,t){const n=Object.assign({},mk);return n.sid=e,this.baseInfoMap.set(e,{info:n,startTime:t}),n}reportResourceTiming(e,t){const n=performance.getEntriesByName(e),r=n[n.length-1];r&&this.reportApiInvoke(t,{name:"Client.resourceTiming",options:r,tag:oA.TRACER}).onSuccess()}};ik.on("REPORT_LOG_UPLOAD",(e=>{e.networkState=yA.networkState,_k.reportApiInvoke(null,{name:"logUploadError",options:e,tag:oA.TRACER}).onSuccess("logUploadError")}));class bk extends FI{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",arguments.length>2?arguments[2]:void 0),nk(this,"name","AgoraRTCException")}print(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error";return super.print(e,pk)}throw(){super.throw(pk)}}const Tk={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1};function Sk(){return Tk}function Ok(){return"setSinkId"in HTMLAudioElement.prototype&&(!UN("RESTRICTION_SET_PLAYBACK_DEVICE")||(dI()||hI())&&!kI())}function Rk(){return!Tk.supportUnifiedPlan||UN("CHROME_FORCE_PLAN_B")&&PI()}let Ck=function(e){return e.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",e.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",e.IOS_INTERRUPTION_START="ios-interruption-start",e.IOS_INTERRUPTION_END="ios-interruption-end",e.STATE_CHANGE="state-change",e}({});function wk(e,t,n){return{sampleRate:e,stereo:t,bitrate:n}}function Ik(e,t,n,r,o){return{width:e,height:t,frameRate:n,bitrateMin:r,bitrateMax:o}}function Ak(e,t,n,r,o){return{width:{max:e},height:{max:t},frameRate:n,bitrateMin:r,bitrateMax:o}}function Nk(e,t){return{numSpatialLayers:e,numTemporalLayers:t}}const kk={"90p":Ik(160,90),"90p_1":Ik(160,90),"120p":Ik(160,120,15,30,65),"120p_1":Ik(160,120,15,30,65),"120p_3":Ik(120,120,15,30,50),"120p_4":Ik(212,120),"180p":Ik(320,180,15,30,140),"180p_1":Ik(320,180,15,30,140),"180p_3":Ik(180,180,15,30,100),"180p_4":Ik(240,180,15,30,120),"240p":Ik(320,240,15,40,200),"240p_1":Ik(320,240,15,40,200),"240p_3":Ik(240,240,15,40,140),"240p_4":Ik(424,240,15,40,220),"360p":Ik(640,360,15,80,400),"360p_1":Ik(640,360,15,80,400),"360p_3":Ik(360,360,15,80,260),"360p_4":Ik(640,360,30,80,600),"360p_6":Ik(360,360,30,80,400),"360p_7":Ik(480,360,15,80,320),"360p_8":Ik(480,360,30,80,490),"360p_9":Ik(640,360,15,80,800),"360p_10":Ik(640,360,24,80,800),"360p_11":Ik(640,360,24,80,1e3),"480p":Ik(640,480,15,100,500),"480p_1":Ik(640,480,15,100,500),"480p_2":Ik(640,480,30,100,1e3),"480p_3":Ik(480,480,15,100,400),"480p_4":Ik(640,480,30,100,750),"480p_6":Ik(480,480,30,100,600),"480p_8":Ik(848,480,15,100,610),"480p_9":Ik(848,480,30,100,930),"480p_10":Ik(640,480,10,100,400),"720p":Ik(1280,720,15,120,1130),"720p_auto":Ik(1280,720,30,900,3e3),"720p_1":Ik(1280,720,15,120,1130),"720p_2":Ik(1280,720,30,120,2e3),"720p_3":Ik(1280,720,30,120,1710),"720p_5":Ik(960,720,15,120,910),"720p_6":Ik(960,720,30,120,1380),"1080p":Ik(1920,1080,15,120,2080),"1080p_1":Ik(1920,1080,15,120,2080),"1080p_2":Ik(1920,1080,30,120,3e3),"1080p_3":Ik(1920,1080,30,120,3150),"1080p_5":Ik(1920,1080,60,120,4780),"1440p":Ik(2560,1440,30,120,4850),"1440p_1":Ik(2560,1440,30,120,4850),"1440p_2":Ik(2560,1440,60,120,7350),"4k":Ik(3840,2160,30,120,8910),"4k_1":Ik(3840,2160,30,120,8910),"4k_3":Ik(3840,2160,60,120,13500)},Pk={"480p":Ak(640,480,5),"480p_1":Ak(640,480,5),"480p_2":Ak(640,480,30),"480p_3":Ak(640,480,15),"720p":Ak(1280,720,5),"720p_auto":Ik(1280,720,30,900,3e3),"720p_1":Ak(1280,720,5),"720p_2":Ak(1280,720,30),"720p_3":Ak(1280,720,15),"1080p":Ak(1920,1080,5),"1080p_1":Ak(1920,1080,5),"1080p_2":Ak(1920,1080,30),"1080p_3":Ak(1920,1080,15)},Dk={"1SL1TL":Nk(1,1),"3SL3TL":Nk(3,3),"2SL3TL":Nk(2,3)};function Mk(e){return e||(e="480p_1"),"string"==typeof e?Object.assign({},kk[e]):e}function Lk(e){return"string"==typeof e?Object.assign({},Pk[e]):e}function xk(e){return"string"==typeof e?Object.assign({},Dk[e]):e}const Uk={speech_low_quality:wk(16e3,!1),speech_standard:wk(32e3,!1,18),music_standard:wk(48e3,!1),standard_stereo:wk(48e3,!0,56),high_quality:wk(48e3,!1,128),high_quality_stereo:wk(48e3,!0,192)};function jk(e){return"string"==typeof e?Object.assign({},Uk[e]):e}const Fk=[];function Bk(e){return VI(e,"mediaSource",["screen","window","application"]),!0}let Vk=function(e){return e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",e.NEED_CLOSE="@need_close",e.NEED_ENABLE_TRACK="@need_enable_track",e.NEED_DISABLE_TRACK="@need_disable_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_RTC_STATS="@get_rtc_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",e.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",e.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",e.NEED_MUTE_TRACK="@need_mute_track",e.NEED_UNMUTE_TRACK="@need_unmute_track",e}({}),Hk=function(e){return e.SCREEN_TRACK="screen_track",e.CUSTOM_TRACK="custome_track",e.LOW_STREAM="low_stream",e.SCREEN_LOW_TRACK="screen_low_track",e}({}),Gk=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e}({}),Wk=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.HIGH_STREAM_LAYER1=4]="HIGH_STREAM_LAYER1",e[e.HIGH_STREAM_LAYER2=5]="HIGH_STREAM_LAYER2",e[e.HIGH_STREAM_LAYER3=6]="HIGH_STREAM_LAYER3",e[e.HIGH_STREAM_LAYER4=7]="HIGH_STREAM_LAYER4",e[e.HIGH_STREAM_LAYER5=8]="HIGH_STREAM_LAYER5",e[e.HIGH_STREAM_LAYER6=9]="HIGH_STREAM_LAYER6",e}({}),qk=function(e){return e[e.DISABLE=0]="DISABLE",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.AUDIO_ONLY=2]="AUDIO_ONLY",e[e.HIGH_STREAM_LAYER1=3]="HIGH_STREAM_LAYER1",e[e.HIGH_STREAM_LAYER2=4]="HIGH_STREAM_LAYER2",e[e.HIGH_STREAM_LAYER3=5]="HIGH_STREAM_LAYER3",e[e.HIGH_STREAM_LAYER4=6]="HIGH_STREAM_LAYER4",e[e.HIGH_STREAM_LAYER5=7]="HIGH_STREAM_LAYER5",e[e.HIGH_STREAM_LAYER6=8]="HIGH_STREAM_LAYER6",e}({}),Kk=function(e){return e.TRANSCEIVER_UPDATED="transceiver-updated",e.SEI_TO_SEND="sei-to-send",e.SEI_RECEIVED="sei-received",e.TRACK_UPDATED="track-updated",e}({}),Yk=function(e){return e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.CLOSED="closed",e}({}),zk=function(e){return e.FIRST_FRAME_DECODED="first-frame-decoded",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.VIDEO_STATE_CHANGED="video-state-changed",e}({}),Xk=function(e){return e.AUDIO="audio",e.VIDEO="video",e.DATA="data",e}({}),Jk=function(e){return e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer",e.UPDATE_SOURCE="update_source",e}({});const Zk={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},Qk={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},$k={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receivePacketsDiscarded:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},eP={uplinkNetworkQuality:0,downlinkNetworkQuality:0},tP={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let nP=function(e){return e.ON_TRACK="on_track",e.ON_NODE="on_node",e}({}),rP=function(e){return e.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",e.REQUEST_CONSTRAINTS="request_constraints",e}({}),oP=function(e){return e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND",e}({}),iP=function(e){return e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",e}({}),aP=function(e){return e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied",e.LOADEDDATA="loadeddata",e}({}),sP=function(e){return e[e.VideoStateStopped=0]="VideoStateStopped",e[e.VideoStateStarting=1]="VideoStateStarting",e[e.VideoStateDecoding=2]="VideoStateDecoding",e[e.VideoStateFrozen=3]="VideoStateFrozen",e}({});const cP={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};let lP=function(e){return e.OPEN="open",e.MESSAGE="message",e.CLOSE="close",e.CLOSING="closing",e.ERROR="error",e}({});function uP(e,t,n,r,o){var i,a,s={};return Object.keys(r).forEach((function(e){s[e]=r[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=so(i=bo(a=n.slice()).call(a)).call(i,(function(n,r){return r(e,t,n)||n}),s),o&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(o):void 0,s.initializer=void 0),void 0===s.initializer?(Object.defineProperty(e,t,s),null):s}function dP(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pP(Object(n),!0).forEach((function(t){dP(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pP(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class fP extends eA{set _mediaStreamTrack(e){e!==this.mediaStreamTrack&&(this.safeEmit(Kk.TRACK_UPDATED,e),this.mediaStreamTrack=e)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(e,t){super(),dP(this,"trackMediaType",void 0),dP(this,"_ID",void 0),dP(this,"_rtpTransceiver",void 0),dP(this,"_lowRtpTransceiver",void 0),dP(this,"_hints",[]),dP(this,"_isClosed",!1),dP(this,"_originMediaStreamTrack",void 0),dP(this,"mediaStreamTrack",void 0),dP(this,"_external",{}),this._ID=t||LA(8,"track-"),this._originMediaStreamTrack=e,this.mediaStreamTrack=e,function(e){Ur(Fk).call(Fk,e)||Fk.push(e)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(e){return e||CA((()=>{var e;_k.reportApiInvoke(null,{name:rA.GET_MEDIA_STREAM_TRACK,options:[],tag:oA.TRACER}).onSuccess((null===(e=this._mediaStreamTrack)||void 0===e?void 0:e.label)||"")}),this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(e){return e===Gk.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(e){const t=Fk.indexOf(e);-1!==t&&Fk.splice(t,1)}(this),this.emit(Yk.CLOSED),this.removeAllListeners(Kk.SEI_RECEIVED)}_updateRtpTransceiver(e,t){if(t===Gk.LOW_STREAM){if(this._lowRtpTransceiver===e)return;this._lowRtpTransceiver=e}else{if(this._rtpTransceiver===e)return;this._rtpTransceiver=e}this.emit(Kk.TRANSCEIVER_UPDATED,e,t)}}class mP extends fP{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(e,t){super(e,t),dP(this,"_enabled",!0),dP(this,"_muted",!1),dP(this,"_isExternalTrack",!1),dP(this,"_isClosed",!1),dP(this,"_enabledMutex",void 0),dP(this,"processor",void 0),dP(this,"_processorContext",void 0),dP(this,"_handleTrackEnded",(()=>{this.onTrackEnded()})),this._enabledMutex=new YA("".concat(this.getTrackId())),e.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var e,t;return null!==(e=null===(t=this._originMediaStreamTrack)||void 0===t?void 0:t.label)&&void 0!==e?e:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,pk.debug("[".concat(this.getTrackId(),"] close")),this.emit(Vk.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._isExternalTrack=n,e!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await vA(this,Vk.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){pk.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Yk.TRACK_ENDED)}stateCheck(e,t){if(pk.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(e,": ").concat(t,"]")),BI(t,e),this._enabled&&this._muted&&"enabled"===e&&!1===t)throw new FI(jI.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",pk);if(!this._enabled&&!this._muted&&"muted"===e&&!0===t)throw new FI(jI.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",pk)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():ih.resolve([])}}const vP=window.AudioContext||window.webkitAudioContext;let gP=null;const EP=new class extends eA{constructor(){super(...arguments),dP(this,"prevState",void 0),dP(this,"curState",void 0),dP(this,"currentTime",void 0),dP(this,"currentTimeStuckAt",void 0),dP(this,"interruptDetectorTrack",void 0),dP(this,"onLocalAudioTrackMute",(()=>{pk.info("ios15-interruption-start"),this.emit(Ck.IOS_15_16_INTERRUPTION_START)})),dP(this,"onLocalAudioTrackUnmute",(async()=>{pk.info("ios15-interruption-end"),"running"!==this.curState||this.duringInterruption?pk.info("ios15-interruption-end-canceled"):(gP&&await gP.suspend(),this.emit(Ck.IOS_15_16_INTERRUPTION_END))}))}get duringInterruption(){return"running"===this.prevState&&"interrupted"===this.curState}bindInterruptDetectorTrack(e){pk.debug("webaudio bindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=e,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(e){pk.debug("webaudio unbindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===e&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function yP(){if(!gP){if(function(){if(!vP)return void pk.error("your browser is not support web audio");pk.info("create audio context");const e=hP({},UN("WEBAUDIO_INIT_OPTIONS"));pk.debug("audio context init option:",JSON.stringify(e)),gP=new vP(e),EP.curState=gP.state,gP.onstatechange=()=>{EP.prevState=EP.curState,EP.curState=gP?gP.state:void 0;const{prevState:e,curState:t}=EP,n="running"===t,r="interrupted"===t,o="running"===e,i="suspended"===e,a="interrupted"===e,s=aI().osVersion;(mI()||II())&&o&&r&&(pk.info("ios".concat(s,"-interruption-start")),EP.emit(Ck.IOS_INTERRUPTION_START)),(mI()||II())&&(i||a)&&n&&(pk.info("ios".concat(s,"-interruption-end")),EP.emit(Ck.IOS_INTERRUPTION_END)),e!==t&&EP.emit(Ck.STATE_CHANGE,t,e)},setInterval((()=>{var e;const t=null===(e=gP)||void 0===e?void 0:e.currentTime;EP.currentTime!==t?(EP.currentTimeStuckAt&&(pk.debug("AudioContext current time resume at ".concat(t)),EP.currentTimeStuckAt=void 0),EP.currentTime=t):(t!==EP.currentTimeStuckAt&&(_k.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:t},tag:oA.TRACER}).onSuccess(),pk.warning("AudioContext current time stuck at ".concat(t))),EP.currentTimeStuckAt=t)}),5e3),async function(e){const t=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let n,r=!1,o=!1,i=!1;function a(t){"running"===e.state?s(!1):mI()||II()?"suspended"===e.state&&(s(!0),t&&e.resume().then(c,c)):"closed"!==e.state&&(s(!0),t&&e.resume().then(c,c))}function s(e){if(r!==e){r=e;for(let n=0,r=t;n<r.length;n+=1){const t=r[n];e?window.addEventListener(t,l,{capture:!0,passive:!0}):window.removeEventListener(t,l,{capture:!0,passive:!0})}}}function c(){a(!1)}function l(){a(!0)}function u(e){if(!i)if(n.paused)if(e){let t;d(!1),i=!0;try{t=n.play(),t?t.then(p,p):(n.addEventListener("playing",p),n.addEventListener("abort",p),n.addEventListener("error",p))}catch(e){p()}}else d(!0);else d(!1)}function d(e){if(o!==e){o=e;for(let n=0,r=t;n<r.length;n++){const t=r[n];e?window.addEventListener(t,h,{capture:!0,passive:!0}):window.removeEventListener(t,h,{capture:!0,passive:!0})}}}function p(){n.removeEventListener("playing",p),n.removeEventListener("abort",p),n.removeEventListener("error",p),i=!1,u(!1)}function h(){u(!0)}if(mI()){const t=e.createMediaStreamDestination(),r=document.createElement("div");r.innerHTML="<audio x-webkit-airplay='deny'></audio>",n=r.children.item(0),n.controls=!1,n.disableRemotePlayback=!0,n.preload="auto",n.srcObject=t.stream,u(!0)}EP.on(Ck.STATE_CHANGE,(function(){a(!0)})),a(!1)}(gP)}(),!gP)throw new FI(jI.NOT_SUPPORTED,"can not create audio context");return gP}return gP}function _P(e){if(function(){if(null!==bP)return bP;const e=yP(),t=e.createBufferSource(),n=e.createGain(),r=e.createGain();t.connect(n),t.connect(r),t.disconnect(n);let o=!1;try{t.disconnect(n)}catch(e){o=!0}return t.disconnect(),bP=o,o}())return;const t=e.connect,n=e.disconnect;e.connect=(n,r,o)=>{var i;return e._inputNodes||(e._inputNodes=[]),Ur(i=e._inputNodes).call(i,n)||(n instanceof AudioNode?(e._inputNodes.push(n),t.call(e,n,r,o)):t.call(e,n,r)),e},e.disconnect=(r,o,i)=>{n.call(e),r?_A(e._inputNodes,r):e._inputNodes=[];for(const n of e._inputNodes)t.call(e,n)}}let bP=null;function TP(e,t){let n=!1;const r=1/t;if(UN("DISABLE_WEBAUDIO")){const t=window.setInterval((()=>{n?window.clearInterval(t):e(performance.now()/1e3)}),1e3*r)}else{const t=yP();let o=t.createGain();o.gain.value=0,o.connect(t.destination);const i=()=>{if(n)return void(o=null);const a=t.createOscillator();a.onended=i,a.connect(o),a.start(0),a.stop(t.currentTime+r),e(t.currentTime)};i()}return()=>{n=!0}}class SP{constructor(){dP(this,"context",void 0),dP(this,"analyserNode",void 0),dP(this,"sourceNode",void 0),this.context=yP(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(e){if(e!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch(e){}this.sourceNode=e,null==e||e.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode)return 0;if(!this.context||mI()||II()||"running"!==this.context.state&&this.context.resume(),!this.analyserNode)return 0;const e=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(e);else{const t=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(t);for(let n=0;n<e.length;++n)e[n]=t[n]/128-1}const t=so(e).call(e,((e,t)=>e+t*t),0)/e.length;return Math.max(10*Math.log10(t)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var e,t;null===(e=this.sourceNode)||void 0===e||e.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,null===(t=this.sourceNode)||void 0===t||t.connect(this.analyserNode)}catch(e){pk.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class OP extends eA{get processSourceNode(){return this.sourceNode}set processedNode(e){var t;if(!this.isDestroyed&&this._processedNode!==e){try{var n;null===(n=this.sourceNode)||void 0===n||n.disconnect(this.outputNode)}catch(e){}null===(t=this._processedNode)||void 0===t||t.disconnect(),this._processedNode=e,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),dP(this,"outputNode",void 0),dP(this,"outputTrack",void 0),dP(this,"isPlayed",!1),dP(this,"sourceNode",void 0),dP(this,"context",void 0),dP(this,"audioBufferNode",void 0),dP(this,"destNode",void 0),dP(this,"audioOutputLevel",0),dP(this,"volumeLevelAnalyser",void 0),dP(this,"_processedNode",void 0),dP(this,"playNode",void 0),dP(this,"isDestroyed",!1),dP(this,"onNoAudioInput",void 0),dP(this,"isNoAudioInput",!1),dP(this,"_noAudioInputCount",0),this.context=yP(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),_P(this.outputNode),this.volumeLevelAnalyser=new SP}startGetAudioBuffer(e){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(e),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=e=>{this.emit(Jk.ON_AUDIO_BUFFER,function(e){for(let t=0;t<e.outputBuffer.numberOfChannels;t+=1){const n=e.outputBuffer.getChannelData(t);for(let e=0;e<n.length;e+=1)n[e]=0}return e.inputBuffer}(e))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!Sk().webAudioMediaStreamDest)throw new FI(jI.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(e){"running"!==this.context.state&&TA((()=>{EP.emit("autoplay-failed")})),this.isPlayed=!0,this.playNode=e||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch(e){}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(e>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;mI()||II()?"suspended"===this.context.state&&this.context.resume():"running"!==this.context.state&&this.context.resume();const t=this.volumeLevelAnalyser.getAnalyserNode();let n;t.getFloatTimeDomainData?(n=new Float32Array(t.fftSize),t.getFloatTimeDomainData(n)):(n=new Uint8Array(t.fftSize),t.getByteTimeDomainData(n));let r=!1;for(let o=0;o<n.length;o++)0!==n[o]&&(r=!0);return r?(this.isNoAudioInput=!1,!0):(await MA(200),await this.checkHasAudioInput(e?e+1:1)&&r)}getAudioVolume(){return this.outputNode.gain.value}setVolume(e){this.outputNode.gain.setValueAtTime(e,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var e,t;null===(e=this.processedNode)||void 0===e||e.disconnect(),null===(t=this.sourceNode)||void 0===t||t.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var e;this.processedNode?null===(e=this.processedNode)||void 0===e||e.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class RP extends OP{get isFreeze(){return!1}constructor(e,t,n){var r;if(super(),dP(this,"sourceNode",void 0),dP(this,"track",void 0),dP(this,"clonedTrack",void 0),dP(this,"audioElement",void 0),dP(this,"isCurrentTrackCloned",!1),dP(this,"isRemoteTrack",!1),dP(this,"originVolumeLevelAnalyser",void 0),dP(this,"rebuildWebAudio",(async()=>{if(pk.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void pk.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then((()=>pk.info("resume success"))),pk.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const e=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?e.stop():this.isCurrentTrackCloned=!0;const t=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(t),_P(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const n=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(n,this.context.currentTime),_P(this.outputNode),this.emit(Jk.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=t,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()})),"audio"!==e.kind)throw new FI(jI.UNEXPECTED_ERROR);this.track=e;const o=new MediaStream([this.track]);if(this.isRemoteTrack=!!t,this.sourceNode=this.context.createMediaStreamSource(o),_P(this.sourceNode),n){const e=n.clone();e.enabled=!0,this.clonedTrack=e,pk.debug("create an unmuted track ".concat(e.id," from the original track ").concat(n.id," to get the volume"));const t=this.context.createMediaStreamSource(new MediaStream([e]));_P(t),this.originVolumeLevelAnalyser=new SP,this.originVolumeLevelAnalyser.updateSource(t)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=o;const i=aI();t&&i.os===tI.IOS&&Number(null===(r=i.osVersion)||void 0===r?void 0:r.split(".")[0])<15&&(EP.on(Ck.STATE_CHANGE,(()=>{"suspended"===this.context.state?document.body.addEventListener("click",this.rebuildWebAudio,!0):"running"===this.context.state&&this.rebuildWebAudio()})),this.checkHasAudioInput().then((e=>{e||document.body.addEventListener("click",this.rebuildWebAudio,!0)})))}updateTrack(e){this.sourceNode.disconnect(),this.track=e,this.isCurrentTrackCloned=!1;const t=new MediaStream([e]);this.sourceNode=this.context.createMediaStreamSource(t),_P(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(Jk.UPDATE_SOURCE),this.audioElement.srcObject=t}destroy(){var e;this.audioElement.srcObject=null,this.audioElement.remove(),EP.off("state-change",this.rebuildWebAudio),null===(e=this.originVolumeLevelAnalyser)||void 0===e||e.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(e){return this.context.createMediaStreamSource(new MediaStream([e]))}updateOriginTrack(e){const t=e.clone();t.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=t),pk.debug("create an unmuted track ".concat(t.id," from the original track ").concat(e.id," to get the volume"));const n=this.context.createMediaStreamSource(new MediaStream([t]));_P(n),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(n)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function CP(e,t,n){const r=(e,t)=>e?"number"!=typeof e?e.max||e.exact||e.ideal||e.min||t:e:t,o={audio:!!n&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:r(t.height,1080),maxWidth:r(t.width,1920)}}};return t.frameRate&&"number"!=typeof t.frameRate?(o.video.mandatory.maxFrameRate=t.frameRate.max,o.video.mandatory.minFrameRate=t.frameRate.min):"number"==typeof t.frameRate&&(o.video.mandatory.maxFrameRate=t.frameRate),await navigator.mediaDevices.getUserMedia(o)}async function wP(e,t){const n=await IP(e.mediaSource),{sourceId:r,audio:o}=await function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new ih(((n,r)=>{const o=document.createElement("div");o.innerText="share screen",o.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const i=document.createElement("div");i.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const a=document.createElement("div");a.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",a.setAttribute("style","height: 12%;");const s=document.createElement("div");s.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const c=document.createElement("div");c.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const l=document.createElement("button");l.innerHTML="cancel",l.setAttribute("style","width: 85px;"),l.onclick=()=>{document.body.removeChild(p);const e=new Error("NotAllowedError");e.name="NotAllowedError",r(e)};let u=t;const d=document.createElement("div");if(t){const e=document.createElement("input");e.setAttribute("type","checkbox");const t=document.createElement("span");e.setAttribute("style","margin-right: 6px;"),t.innerText="Share audio",e.checked=u,e.onchange=()=>{u=e.checked},d.appendChild(e),d.appendChild(t)}c.appendChild(d),c.appendChild(l),i.appendChild(a),i.appendChild(s),i.appendChild(c);const p=document.createElement("div");p.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),p.appendChild(o),p.appendChild(i),document.body.appendChild(p),e.map((e=>{if(e.id){const t=document.createElement("div");t.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let r=e.thumbnail;try{const{width:e}=r.getSize();e>1920&&(r=r.resize({width:1920}))}catch(e){throw e&&e.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),e}t.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+r.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+e.name.replace(/[\u00A0-\u9999<>\&]/g,(function(e){return"&#"+e.charCodeAt(0)+";"}))+"</span>",t.onclick=()=>{document.body.removeChild(p),n({sourceId:e.id,audio:u})},s.appendChild(t)}}))}))}(n,t);return await CP(r,e,o)}async function IP(e){let t=["window","screen"];"application"!==e&&"window"!==e||(t=["window"]),"screen"===e&&(t=["screen"]);const n=nA();if(!n)throw console.error("failed to fetch electron, please mount it to window"),new FI(jI.ELECTRON_IS_NULL);let r=null;try{var o;r=(null===(o=n.desktopCapturer)||void 0===o?void 0:o.getSources({types:t}))||n.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:t})}catch(e){r=null}r&&r.then||(r=new ih(((e,r)=>{n.desktopCapturer.getSources({types:t},((t,n)=>{t?r(t):e(n)}))})));try{return await r}catch(e){throw new FI(jI.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,e.toString())}}const AP=new YA("safari");let NP=!1,kP=!1;async function PP(e,t){let n=0,r=null;for(;n<2;)try{r=await DP(e,t,n>0);break}catch(e){if(e instanceof FI)throw pk.error("[".concat(t,"] ").concat(e.toString())),e;const r=MP(e.name||e.code||e,e.message);if(r.code===jI.MEDIA_OPTION_INVALID){pk.debug("[".concat(t,"] detect media option invalid, retry")),n+=1,await MA(500);continue}throw pk.error("[".concat(t,"] ").concat(r.toString())),r}if(!r)throw new FI(jI.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return r}async function DP(e,t,n){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new FI(jI.NOT_SUPPORTED,"can not find getUserMedia");n&&(e.video&&(delete e.video.width,delete e.video.height),e.screen&&(delete e.screen.width,delete e.screen.height));const r=Sk(),o=new MediaStream;if(e.audioSource&&o.addTrack(e.audioSource),e.videoSource&&o.addTrack(e.videoSource),!e.audio&&!e.video&&!e.screen)return pk.debug("Using Video Source/ Audio Source"),o;if(e.screen)if(nA())e.screen.sourceId?LP(o,await CP(e.screen.sourceId,e.screen,!!e.screenAudio)):LP(o,await wP(e.screen,!!e.screenAudio));else if(dI()&&e.screen.extensionId&&e.screen.mandatory){if(!r.getStreamFromExtension)throw new FI(jI.NOT_SUPPORTED,"This browser does not support screen sharing");pk.debug("[".concat(t,'] Screen access on chrome stable, looking for extension"'));const n=await(a=e.screen.extensionId,s=t,new ih(((e,t)=>{try{chrome.runtime.sendMessage(a,{getStream:!0},(n=>{if(!n||!n.streamId)return pk.error("[".concat(s,"] No response from Chrome Plugin. Plugin not installed properly"),n),void t(new FI(jI.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));e(n.streamId)}))}catch(e){pk.error("[".concat(s,"] AgoraRTC screensharing plugin is not accessible(").concat(a,")"),e.toString()),t(new FI(jI.CHROME_PLUGIN_NOT_INSTALL))}})));e.screen.mandatory.chromeMediaSourceId=n,LP(o,await navigator.mediaDevices.getUserMedia({video:{mandatory:e.screen.mandatory}}))}else if(r.getDisplayMedia){var i;e.screen.mediaSource&&Bk(e.screen.mediaSource);const n={width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate,displaySurface:null!==(i=e.screen.displaySurface)&&void 0!==i?i:"screen"===e.screen.mediaSource?"monitor":e.screen.mediaSource},{selfBrowserSurface:r,surfaceSwitching:a,systemAudio:s,preferCurrentTab:c}=e.screen,l={selfBrowserSurface:r,surfaceSwitching:a,systemAudio:s,preferCurrentTab:c};!r&&delete l.selfBrowserSurface,!a&&delete l.surfaceSwitching,!s&&delete l.systemAudio,!c&&delete l.preferCurrentTab,pk.debug("[".concat(t,"] getDisplayMedia:"),JSON.stringify({video:n,audio:e.screenAudio,controls:l})),LP(o,await navigator.mediaDevices.getDisplayMedia(hP({video:n,audio:e.screenAudio},l)))}else{if(!fI())throw pk.error("[".concat(t,"] This browser does not support screenSharing")),new FI(jI.NOT_SUPPORTED,"This browser does not support screen sharing");{e.screen.mediaSource&&Bk(e.screen.mediaSource);const n={video:{mediaSource:e.screen.mediaSource,width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate}};pk.debug("[".concat(t,"] getUserMedia: ").concat(JSON.stringify(n))),LP(o,await navigator.mediaDevices.getUserMedia(n))}}var a,s;if(!e.video&&!e.audio)return o;let c={video:e.video,audio:e.audio},l=UN("MEDIA_DEVICE_CONSTRAINTS");if(l)try{"string"==typeof l&&(l=JSON.parse(l)),c=VA(c,l)}catch(e){}pk.debug("[".concat(t,"] GetUserMedia"),JSON.stringify(c)),aI();let u,d=null;(pI()||mI()||uI())&&(d=await AP.lock());try{u=await navigator.mediaDevices.getUserMedia(c)}catch(e){throw d&&d(),e}return c.audio&&(NP=!0),c.video&&(kP=!0),LP(o,u),d&&d(),o}function MP(e,t){switch(e){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new FI(jI.MEDIA_OPTION_INVALID,"".concat(e,": ").concat(t));case"NotFoundError":case"DevicesNotFoundError":return new FI(jI.DEVICE_NOT_FOUND,"".concat(e,": ").concat(t));case"NotSupportedError":return new FI(jI.NOT_SUPPORTED,"".concat(e,": ").concat(t));case"NotReadableError":return new FI(jI.NOT_READABLE,"".concat(e,": ").concat(t));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new FI(jI.PERMISSION_DENIED,"".concat(e,": ").concat(t));case"ConstraintNotSatisfiedError":return new FI(jI.CONSTRAINT_NOT_SATISFIED,"".concat(e,": ").concat(t));default:return pk.error("getUserMedia unexpected error",e),new FI(jI.UNEXPECTED_ERROR,"".concat(e,": ").concat(t))}}function LP(e,t){const n=e.getVideoTracks()[0],r=e.getAudioTracks()[0],o=t.getVideoTracks()[0],i=t.getAudioTracks()[0];i&&(r&&e.removeTrack(r),e.addTrack(i)),o&&(n&&e.removeTrack(n),e.addTrack(o))}const xP=new class extends eA{get state(){return this._state}set state(e){e!==this._state&&(this.emit(iP.STATE_CHANGE,e),this._state=e)}constructor(){super(),dP(this,"_state",oP.IDLE),dP(this,"isAccessMicrophonePermission",!1),dP(this,"isAccessCameraPermission",!1),dP(this,"lastAccessMicrophonePermission",!1),dP(this,"lastAccessCameraPermission",!1),dP(this,"checkdeviceMatched",!1),dP(this,"deviceInfoMap",new Map),this.init().then((()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval((()=>{(UN("ENUMERATE_DEVICES_INTERVAL")||(DI()||cI()===tI.HARMONY_OS)&&PI())&&this.updateDevicesInfo()}),UN("ENUMERATE_DEVICES_INTERVAL_TIME"))})).catch((e=>pk.error(e.toString())))}async enumerateDevices(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new FI(jI.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const r=await navigator.mediaDevices.enumerateDevices(),o=this.checkMediaDeviceInfoIsOk(r);let i=!this.isAccessMicrophonePermission&&e,a=!this.isAccessCameraPermission&&t;o.audio&&(i=!1),o.video&&(a=!1);let s=null,c=null,l=null;if(!n&&(i||a)){if(AP.isLocked&&(pk.debug("[device manager] wait GUM lock"),(await AP.lock())(),pk.debug("[device manager] GUM unlock")),NP&&(i=!1,this.isAccessMicrophonePermission=!0),kP&&(a=!1,this.isAccessCameraPermission=!0),pk.debug("[device manager] check media device permissions",e,t,i,a),i&&a){try{l=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(e){const t=MP(e.name||e.code||e,e.message);if(t.code===jI.PERMISSION_DENIED)throw t;pk.warning("getUserMedia failed in getDevices",t)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(i){try{s=await navigator.mediaDevices.getUserMedia({audio:e})}catch(e){const t=MP(e.name||e.code||e,e.message);if(t.code===jI.PERMISSION_DENIED)throw t;pk.warning("getUserMedia failed in getDevices",t)}this.isAccessMicrophonePermission=!0}else if(a){try{c=await navigator.mediaDevices.getUserMedia({video:t})}catch(e){const t=MP(e.name||e.code||e,e.message);if(t.code===jI.PERMISSION_DENIED)throw t;pk.warning("getUserMedia failed in getDevices",t)}this.isAccessCameraPermission=!0}pk.debug("[device manager] mic permission",e,"cam permission",t)}try{const e=await navigator.mediaDevices.enumerateDevices();return s&&s.getTracks().forEach((e=>e.stop())),c&&c.getTracks().forEach((e=>e.stop())),l&&l.getTracks().forEach((e=>e.stop())),s=null,c=null,l=null,e}catch(e){return s&&s.getTracks().forEach((e=>e.stop())),c&&c.getTracks().forEach((e=>e.stop())),l&&l.getTracks().forEach((e=>e.stop())),s=null,c=null,l=null,new FI(jI.ENUMERATE_DEVICES_FAILED,e.toString()).throw()}}async getRecordingDevices(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter((e=>"audioinput"===e.kind))}async getCamerasDevices(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!1,!0,e)).filter((e=>"videoinput"===e.kind))}async getSpeakers(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter((e=>"audiooutput"===e.kind))}searchDeviceIdByName(e){let t=null;return this.deviceInfoMap.forEach((n=>{n.device.label===e&&(t=n.device.deviceId)})),t}async getDeviceById(e){const t=(await this.enumerateDevices(!0,!0,!0)).find((t=>t.deviceId===e));if(!t)throw new FI(jI.DEVICE_NOT_FOUND,"deviceId: ".concat(e));return t}async init(){this.state=oP.INITING;try{await this.updateDevicesInfo(),this.state=oP.INITEND}catch(e){throw pk.warning("Device Detection functionality cannot start properly.",e.toString()),this.state=oP.IDLE,("boolean"==typeof isSecureContext?isSecureContext:"https:"===location.protocol||"file:"===location.protocol||"localhost"===location.hostname||"127.0.0.1"===location.hostname||"::1"===location.hostname)||new FI(jI.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),e}}async updateDevicesInfo(){const e=await this.enumerateDevices(!0,!0,!0),t=Date.now(),n=[];if(e[0]&&e[0].label&&!1===this.checkdeviceMatched){this.checkdeviceMatched=!0;const t=e.find((e=>"audioinput"===e.kind&&"default"===e.deviceId)),n=e.find((e=>"audiooutput"===e.kind&&"default"===e.deviceId));t&&n?n.groupId===t.groupId?pk.debug("[device-check] default input ".concat(t.label," and output ").concat(n.label," is the same group")):pk.debug("[device-check] default input ".concat(t.label," and output ").concat(n.label," is not the same group")):pk.debug("[device-check] default input or output not found")}const r=this.checkMediaDeviceInfoIsOk(e);if(e.forEach((e=>{if(!e.deviceId)return;const r=this.deviceInfoMap.get("".concat(e.kind,"_").concat(e.deviceId));if("ACTIVE"!==(r?r.state:"INACTIVE")){const r={initAt:t,updateAt:t,device:e,state:"ACTIVE"};this.deviceInfoMap.set("".concat(e.kind,"_").concat(e.deviceId),r),n.push(r)}r&&(r.updateAt=t)})),this.deviceInfoMap.forEach(((e,r)=>{"ACTIVE"===e.state&&e.updateAt!==t&&(e.state="INACTIVE",n.push(e))})),this.state!==oP.INITEND)return r.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(r.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));n.forEach((e=>{switch(e.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(iP.RECORDING_DEVICE_CHANGED,e);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(iP.CAMERA_DEVICE_CHANGED,e);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(iP.PLAYOUT_DEVICE_CHANGED,e)}})),r.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),r.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(e){const t=e.filter((e=>"audioinput"===e.kind)),n=e.filter((e=>"videoinput"===e.kind)),r={audio:!1,video:!1};for(const o of t)if(o.label&&o.deviceId){r.audio=!0;break}for(const o of n)if(o.label&&o.deviceId){r.video=!0;break}return r}};let UP=!1;const jP=new class extends eA{constructor(){super(...arguments),dP(this,"onAutoplayFailed",void 0),dP(this,"onAudioAutoplayFailed",void 0)}};function FP(){if(aI(),!UP){const e=t=>{t.preventDefault(),UP=!1,MI()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};UP=!0,MI()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),pk.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),jP.onAutoplayFailed?jP.onAutoplayFailed():jP.onAudioAutoplayFailed?pk.warning("AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.\n\n  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."):pk.warning("We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.\n\n  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.\n\n  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."),jP.emit("autoplay-failed")}}function BP(e,t,n,r){if(!e)return;const o=_k.getBaseInfoBySessionId(e);if(!o)return;const i=o.info,a=Date.now(),s=hP(hP({},i),{},{vid:void 0===i.vid?0:Number(i.vid),lts:a,elapse:a-o.startTime,cbRegistered:jP.onAutoplayFailed||jP.onAudioAutoplayFailed?1:-1,errorMsg:n,mediaType:t,trackId:r,extend:void 0});_k.send({type:gk.AUTOPLAY_FAILED,data:s},!0)}const VP=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],HP=new class{constructor(){dP(this,"onAutoplayFailed",void 0),dP(this,"elementMap",new Map),dP(this,"elementStateMap",new Map),dP(this,"elementsNeedToResume",[]),dP(this,"sinkIdMap",new Map),dP(this,"autoResumeAfterInterruption",(e=>{Array.from(this.elementMap.entries()).forEach((t=>{let[n,r]=t;const o=this.elementStateMap.get(n),i=r.srcObject.getAudioTracks()[0],a=i&&i.readyState;if(pk.debug("resume after interrupted, ele: ".concat(o," audio: ").concat(a," ").concat(e)),"live"===a){if(e)return r.pause(),void r.play();if("running"===EP.curState)return RI()?(r.pause(),void r.play()):void(o&&"paused"===o&&r.play())}}))})),dP(this,"autoResumeAfterInterruptionOnIOS15_16",(()=>{Array.from(this.elementMap.entries()).forEach((e=>{let[t,n]=e;const r=n.srcObject.getAudioTracks()[0];r&&"live"===r.readyState&&(pk.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),n.pause(),n.play())}))})),this.autoResumeAudioElement(),EP.on(Ck.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),EP.on(Ck.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),EP.on(Ck.STATE_CHANGE,(()=>{mI()&&"suspended"===EP.prevState&&"running"===EP.curState&&this.autoResumeAfterInterruption()}))}async setSinkID(e,t){const n=this.elementMap.get(e);if(this.sinkIdMap.set(e,t),n)try{await n.setSinkId(t)}catch(e){throw new FI(jI.PERMISSION_DENIED,"can not set sink id: "+e.toString())}}play(e,t,n,r){if(this.elementMap.has(t))return;const o=document.createElement("audio");o.autoplay=!0,o.srcObject=new MediaStream([e]),this.bindAudioElementEvents(t,o),this.elementMap.set(t,o),this.elementStateMap.set(t,aP.INIT),this.setVolume(t,n);const i=this.sinkIdMap.get(t);if(i)try{o.setSinkId(i).catch((e=>{pk.warning("[".concat(t,"] set sink id failed"),e.toString())}))}catch(e){pk.warning("[".concat(t,"] set sink id failed"),e.toString())}const a=o.play();a&&a.then&&a.catch((e=>{r&&BP(r,"audio",e.message,t),pk.warning("audio element play warning",e.toString()),this.elementMap.has(t)&&"NotAllowedError"===e.name&&(pk.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(o),TA((()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),FP()})))}))}updateTrack(e,t){const n=this.elementMap.get(e);n&&(n.srcObject=new MediaStream([t]))}isPlaying(e){return this.elementMap.has(e)&&"playing"===this.elementStateMap.get(e)}setVolume(e,t){const n=this.elementMap.get(e);n&&(t=Math.max(0,Math.min(100,t)),n.volume=t/100)}stop(e){const t=this.elementMap.get(e);if(this.sinkIdMap.delete(e),!t)return;const n=this.elementsNeedToResume.indexOf(t);this.elementsNeedToResume.splice(n,1),t.srcObject=null,t.remove(),this.elementMap.delete(e),this.elementStateMap.delete(e)}bindAudioElementEvents(e,t){VP.forEach((n=>{t.addEventListener(n,(n=>{const r=this.elementStateMap.get(e),o="pause"===n.type?"paused":n.type;if(pk.debug("[".concat(e,"] audio-element-status change ").concat(r," => ").concat(o)),"error"===n.type){const n=null==t?void 0:t.error;n&&pk.error("[".concat(e,"] media error, code: ").concat(n.code,", message: ").concat(n.message))}this.elementStateMap.set(e,o)}))}))}getPlayerState(e){return this.elementStateMap.get(e)||"uninit"}autoResumeAudioElement(){const e=()=>{this.elementsNeedToResume.forEach((e=>{e.play().then((e=>{pk.debug("Auto resume audio element success")})).catch((e=>{pk.warning("Auto resume audio element failed!",e)}))})),this.elementsNeedToResume=[]};new ih((e=>{document.body?e():window.addEventListener("load",(()=>e()))})).then((()=>{MI()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0))}))}};function GP(){return function(e,t,n){const r=n.value;return"function"==typeof r&&(n.value=function(){this._isClosed&&new FI(jI.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",pk);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const o=r.apply(this,t);return o instanceof ih?new ih(((e,t)=>{o.then(e).catch(t)})):o}),n}}class WP extends eA{constructor(e){super(),dP(this,"name","VideoProcessorDestination"),dP(this,"ID","0"),dP(this,"_source",void 0),dP(this,"videoContext",void 0),dP(this,"inputTrack",void 0),this.videoContext=e}get kind(){return"video"}get enabled(){return!0}pipe(){throw new FI(jI.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new FI(jI.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(e){if(e.context!==this.videoContext)throw new Error("ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.\nProbably you are making pipeline like this:\nvideoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).");e.track&&e.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=e.track,this.emit(nP.ON_TRACK,e.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(nP.ON_TRACK,void 0)}}class qP extends eA{set chained(e){this._chained=e}get chained(){return this._chained}constructor(e,t){super(),dP(this,"constraintsMap",new Map),dP(this,"statsRegistry",[]),dP(this,"usageRegistry",[]),dP(this,"trackId",void 0),dP(this,"direction",void 0),dP(this,"_chained",!1),this.trackId=e,this.direction=t}async getConstraints(){return await mA(this,rP.REQUEST_CONSTRAINTS)}async requestApplyConstraints(e,t){var n;return pk.info("processor ".concat(t.name," requestApplyConstraints for ").concat(this.trackId)),e&&this.constraintsMap.set(t,e),vA(this,rP.REQUEST_UPDATE_CONSTRAINTS,Array.from(fh(n=this.constraintsMap).call(n)))}async requestRevertConstraints(e){var t;if(this.constraintsMap.has(e))return pk.info("processor ".concat(e.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(e),vA(this,rP.REQUEST_UPDATE_CONSTRAINTS,Array.from(fh(t=this.constraintsMap).call(t)))}registerStats(e,t,n){this.statsRegistry.find((n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t))||this.statsRegistry.push({processorName:e.name,processorID:e.ID,type:t,cb:n})}unregisterStats(e,t){const n=this.statsRegistry.findIndex((n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t));-1!==n&&this.statsRegistry.splice(n,1)}gatherStats(){const e=[];for(const{processorID:t,processorName:n,type:r,cb:o}of this.statsRegistry)try{const i=o();e.push({processorID:t,processorName:n,type:r,stats:i})}catch(e){pk.error(new FI(jI.UNEXPECTED_ERROR,e.message))}return e}registerUsage(e,t){this.usageRegistry.find((t=>t.processorID===e.ID&&t.processorName===e.name))||this.usageRegistry.push({processorID:e.ID,processorName:e.name,cb:t})}unregisterUsage(e){const t=this.usageRegistry.findIndex((t=>t.processorID===e.ID&&t.processorName===e.name));-1!==t&&this.usageRegistry.splice(t,1)}async gatherUsage(){const e=[];if(!this.chained)return[];for(const{cb:t}of this.usageRegistry)try{let n=t();n instanceof ih&&(n=await n),e.push(hP(hP({},n),{},{direction:this.direction}))}catch(e){pk.error("gather extension usage error",e)}return e}getDirection(){return this.direction}}class KP extends eA{constructor(e){super(),dP(this,"name","AudioProcessorDestination"),dP(this,"ID","0"),dP(this,"inputTrack",void 0),dP(this,"inputNode",void 0),dP(this,"audioProcessorContext",void 0),dP(this,"_source",void 0),this.audioProcessorContext=e}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new FI(jI.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new FI(jI.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(nP.ON_TRACK,void 0),this.emit(nP.ON_NODE,void 0)}updateInput(e){if(e.context!==this.audioProcessorContext)throw new Error("ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.\n        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).");e.track&&this.inputTrack!==e.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=e.track,this.emit(nP.ON_TRACK,this.inputTrack)),e.node&&this.inputNode!==e.node&&(this.audioProcessorContext.chained=!0,this.inputNode=e.node,this.emit(nP.ON_NODE,this.inputNode))}}class YP extends eA{set chained(e){this._chained=e}get chained(){return this._chained}constructor(e,t,n){super(),dP(this,"constraintsMap",new Map),dP(this,"statsRegistry",[]),dP(this,"audioContext",void 0),dP(this,"trackId",void 0),dP(this,"direction",void 0),dP(this,"usageRegistry",[]),dP(this,"_chained",!1),this.audioContext=e,this.trackId=t,this.direction=n}async getConstraints(){return mA(this,rP.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(e,t){var n;return pk.info("processor ".concat(t.name," requestApplyConstraints for ").concat(this.trackId)),e&&this.constraintsMap.set(t,e),vA(this,rP.REQUEST_UPDATE_CONSTRAINTS,Array.from(fh(n=this.constraintsMap).call(n)))}async requestRevertConstraints(e){var t;if(this.constraintsMap.has(e))return this.constraintsMap.delete(e),vA(this,rP.REQUEST_UPDATE_CONSTRAINTS,Array.from(fh(t=this.constraintsMap).call(t)))}registerStats(e,t,n){this.statsRegistry.find((n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t))||this.statsRegistry.push({processorName:e.name,processorID:e.ID,type:t,cb:n})}unregisterStats(e,t){const n=this.statsRegistry.findIndex((n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t));-1!==n&&this.statsRegistry.splice(n,1)}gatherStats(){const e=[];for(const{processorID:t,processorName:n,type:r,cb:o}of this.statsRegistry)try{const i=o();e.push({processorID:t,processorName:n,type:r,stats:i})}catch(e){pk.error(new FI(jI.UNEXPECTED_ERROR,e.message))}return e}registerUsage(e,t){this.usageRegistry.find((t=>t.processorID===e.ID&&t.processorName===e.name))||this.usageRegistry.push({processorID:e.ID,processorName:e.name,cb:t})}unregisterUsage(e){const t=this.usageRegistry.findIndex((t=>t.processorID===e.ID&&t.processorName===e.name));-1!==t&&this.usageRegistry.splice(t,1)}async gatherUsage(){const e=[];if(!this.chained)return[];for(const{cb:t}of this.usageRegistry)try{let n=t();n instanceof ih&&(n=await n),e.push(hP(hP({},n),{},{direction:this.direction}))}catch(e){pk.error("gather extension usage error",e)}return e}getDirection(){return this.direction}}class zP extends eA{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),dP(this,"context",void 0),dP(this,"processSourceNode",void 0),dP(this,"outputTrack",void 0),dP(this,"processedNode",void 0),dP(this,"clonedTrack",void 0),dP(this,"outputNode",void 0),this.outputNode=new XP}setVolume(){}createOutputTrack(){throw new FI(jI.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class XP{disconnect(){}connect(){}}function JP(e){return new ih(((t,n)=>{let r=!1;const o=document.createElement("video");o.setAttribute("autoplay",""),o.setAttribute("muted",""),o.muted=!0,o.autoplay=!0,o.setAttribute("playsinline",""),o.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(o);const i=mI()?"canplay":"playing";o.addEventListener(i,(()=>{const e=o.videoWidth,n=o.videoHeight;!e&&fI()||(r=!0,o.srcObject=null,o.remove(),t([e,n]))})),o.srcObject=new MediaStream([e]),o.play().catch(UA),setTimeout((()=>{r||(o.srcObject=null,o.remove(),t([o.videoWidth,o.videoHeight]))}),4e3)}))}function ZP(e){const t={};e.facingMode&&(t.facingMode=e.facingMode),e.cameraId&&(t.deviceId={exact:e.cameraId});const n=Mk(e.encoderConfig);return null!=n.width&&(t.width=n.width),null!=n.height&&(t.height=n.height),!NI()&&n.frameRate&&(t.frameRate=n.frameRate),hI()&&"object"==typeof t.frameRate&&(t.frameRate.max=60),fI()&&(t.frameRate={ideal:30,max:30}),t}function QP(e){const t={};return NI()||(void 0!==e.AGC&&(t.autoGainControl=e.AGC),void 0!==e.AEC&&(t.echoCancellation=e.AEC),void 0!==e.ANS&&(t.noiseSuppression=e.ANS,dI()&&e.ANS&&(t.googHighpassFilter=e.ANS))),t}function $P(e){const t=QP(e);if(e.encoderConfig){const n=jk(e.encoderConfig);t.channelCount=n.stereo?2:1,t.sampleRate=n.sampleRate,t.sampleSize=n.sampleSize}return e.microphoneId&&(t.deviceId={exact:e.microphoneId}),DI()&&(t.sampleRate=void 0),t}const eD=e=>{const t=e._encoderConfig;if(!t)return;const{frameRate:n,width:r,height:o}=e.getMediaStreamTrackSettings();let{frameRate:i=n,width:a=r,height:s=o}=t;if(!i||!a||!s)return;a=GA(a),s=GA(s),i=GA(i);const{max:c,min:l}=function(e,t,n){const r=200*Math.pow(n/15,.6)*Math.pow(e*t/640/360,.75);return{min:Math.floor(r),max:Math.floor(4*r)}}(a,s,i),{bitrateMax:u,bitrateMin:d}=t||{};u||pk.debug("calculate bitrate: [w: ".concat(a,", h: ").concat(s,", fps: ").concat(i,"] => [brMax: ").concat(u,", brMin: ").concat(d,"]"));const{maxFramerate:p}=UN("ENCODER_CONFIG_LIMIT");return p&&"number"==typeof p&&(i=Math.min(i,p)),{frameRate:i,bitrateMax:u||c,bitrateMin:d||l,scaleResolutionDownBy:1,scale:0}},tD=async(e,t,n)=>await(async(e,t,n)=>{const r=function(e){const t=[];for(let n=0;n<e.length;n+=2)t.push(parseInt(e.slice(n,n+2),16));return Uint8Array.from(t)}(WA(""+t+n)).slice(0,16),o=r.slice(0,12),i=await window.crypto.subtle.importKey("raw",r,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:o},i,e))})(e.buffer,t,n),nD=e=>{const t=document.createElement("canvas");return t.width=2,t.height=2,new ih(((n,r)=>{t.toBlob((async e=>{if(t.remove(),e){const r=await rD(e);n({buffer:r,width:t.width,height:t.height})}else r(new FI(jI.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))}),e,1)}))},rD=async e=>{const t=await e.arrayBuffer();return new Uint8Array(t)};var oD,iD,aD,sD,cD,lD,uD,dD,pD,hD,fD,mD,vD,gD,ED,yD,_D,bD,TD,SD,OD,RD,CD,wD,ID,AD,ND,kD,PD,DD,MD,LD,xD,UD,jD,FD,BD,VD,HD,GD;let WD=(oD=yk({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),iD=yk({argsMap:(e,t)=>[e.getTrackId(),t]}),aD=GP(),sD=zA("LocalAudioTrack","_enabledMutex"),cD=yk({argsMap:(e,t)=>[e.getTrackId(),t]}),lD=GP(),uD=zA("LocalAudioTrack","_enabledMutex"),dD=yk({argsMap:(e,t)=>[e.getTrackId(),t]}),pD=GP(),hD=GP(),fD=GP(),mD=yk({argsMap:e=>[e.getTrackId()]}),vD=GP(),gD=yk({argsMap:e=>[e.getTrackId()]}),ED=GP(),yD=yk({argsMap:e=>[e.getTrackId()]}),_D=yk({argsMap:(e,t)=>[e.getTrackId(),t.name]}),bD=yk({argsMap:e=>[e.getTrackId()]}),uP((TD=class extends mP{get _source(){return this.initWebAudio()}set _source(e){this._trackSource=e}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?HP.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(e,t,n,r){super(e,n),dP(this,"trackMediaType",Xk.AUDIO),dP(this,"_encoderConfig",void 0),dP(this,"_trackSource",void 0),dP(this,"metadata",[]),dP(this,"_enabled",!0),dP(this,"_volume",100),dP(this,"_useAudioElement",!0),dP(this,"_bypassWebAudio",!1),dP(this,"processor",void 0),dP(this,"_processorContext",void 0),dP(this,"_processorDestination",void 0),dP(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=t,this._getOriginVolumeLevel=!!r,this._trackSource=new zP,UN("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),UN("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),pI()&&!gP?setTimeout((()=>this.initWebAudio())):this.initWebAudio()}setVolume(e){HI(e,"volume",0,1e3),this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&HP.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return void pk.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const e=this._source.createOutputTrack();this._mediaStreamTrack!==e&&(this._mediaStreamTrack=e,vA(this,Vk.NEED_REPLACE_TRACK,this).then((()=>{pk.debug("[".concat(this.getTrackId(),"] replace web audio track success"))})).catch((e=>{pk.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),e)})))}catch(e){}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(e){if(!this._useAudioElement||!Ok())throw new FI(jI.NOT_SUPPORTED,"your browser does not support setting the audio output device");await HP.setSinkID(this.getTrackId(),e)}async setEnabled(e,t,n){return this._setEnabled(e,t,n)}async _setEnabled(e,t,n){if(!n){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(pk.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){this._originMediaStreamTrack.enabled=!0;try{n||(this._enabled=!0),await vA(this,Vk.NEED_ENABLE_TRACK,this),pk.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(e," success"))}catch(e){throw n||(this._enabled=!1),pk.error("[".concat(this.getTrackId(),"] setEnabled to true error"),e.toString()),e}}else{this._originMediaStreamTrack.enabled=!1,n||(this._enabled=!1);try{await vA(this,Vk.NEED_DISABLE_TRACK,this)}catch(e){throw n||(this._enabled=!0),pk.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}}}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,pk.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),e?await vA(this,Vk.NEED_MUTE_TRACK,this):await vA(this,Vk.NEED_UNMUTE_TRACK,this))}getStats(){return CA((()=>{pk.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")}),"localAudioTrackGetStatsWarning"),gA(this,Vk.GET_STATS)||hP({},Zk)}setAudioFrameCallback(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!e)return this._source.removeAllListeners(Jk.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(Jk.ON_AUDIO_BUFFER),this._source.on(Jk.ON_AUDIO_BUFFER,(t=>e(t)))}play(){pk.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(pk.debug("[".concat(this.getTrackId(),"] start audio playback in element")),HP.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){pk.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?HP.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];pk.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&HP.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(e,t){this._originMediaStreamTrack!==e&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:e,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await vA(this,Vk.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(e))}renewMediaStreamTrack(e){return ih.resolve(void 0)}pipe(e){if(this._bypassWebAudio)throw new FI(jI.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===e)return e;if(e._source)throw new FI(jI.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(!this.processor)return;const t=this.processor;null===(e=this._source.processSourceNode)||void 0===e||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(e){e.on(nP.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e),await vA(this,Vk.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await vA(this,Vk.NEED_REPLACE_TRACK,this))})),e.on(nP.ON_NODE,(e=>{this._source.processedNode=e}))}unbindProcessorDestinationEvents(e){e.removeAllListeners(nP.ON_TRACK),e.removeAllListeners(nP.ON_NODE)}bindProcessorContextEvents(e){e.on(rP.REQUEST_CONSTRAINTS,(async e=>{e(this._originMediaStreamTrack.getSettings())}))}unbindProcessorContextEvents(e){e.removeAllListeners(rP.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof zP&&(this._trackSource=new RP(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const e=new YP(this._source.context,this.getTrackId(),"local"),t=new KP(e);return this._processorContext=e,this._processorDestination=t,this.bindProcessorContextEvents(e),this.bindProcessorDestinationEvents(t),this._source.on(Jk.UPDATE_SOURCE,(()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:e})})),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(HP.stop(this.getTrackId()),this._source.play()),vA(this,Vk.NEED_REPLACE_MIXING_TRACK,this).then((()=>{pk.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))})).catch((e=>{pk.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),e)}))),{processorContext:e,processorDestination:t}}}).prototype,"setVolume",[oD],Object.getOwnPropertyDescriptor(TD.prototype,"setVolume"),TD.prototype),uP(TD.prototype,"setPlaybackDevice",[iD,aD],Object.getOwnPropertyDescriptor(TD.prototype,"setPlaybackDevice"),TD.prototype),uP(TD.prototype,"setEnabled",[sD,cD,lD],Object.getOwnPropertyDescriptor(TD.prototype,"setEnabled"),TD.prototype),uP(TD.prototype,"setMuted",[uD,dD,pD],Object.getOwnPropertyDescriptor(TD.prototype,"setMuted"),TD.prototype),uP(TD.prototype,"getStats",[hD],Object.getOwnPropertyDescriptor(TD.prototype,"getStats"),TD.prototype),uP(TD.prototype,"setAudioFrameCallback",[fD],Object.getOwnPropertyDescriptor(TD.prototype,"setAudioFrameCallback"),TD.prototype),uP(TD.prototype,"play",[mD,vD],Object.getOwnPropertyDescriptor(TD.prototype,"play"),TD.prototype),uP(TD.prototype,"stop",[gD,ED],Object.getOwnPropertyDescriptor(TD.prototype,"stop"),TD.prototype),uP(TD.prototype,"close",[yD],Object.getOwnPropertyDescriptor(TD.prototype,"close"),TD.prototype),uP(TD.prototype,"pipe",[_D],Object.getOwnPropertyDescriptor(TD.prototype,"pipe"),TD.prototype),uP(TD.prototype,"unpipe",[bD],Object.getOwnPropertyDescriptor(TD.prototype,"unpipe"),TD.prototype),TD),qD=(SD=yk({argsMap:(e,t)=>[e.getTrackId(),t]}),OD=GP(),RD=zA("MicrophoneAudioTrack","_enabledMutex"),CD=yk({argsMap:(e,t,n)=>[e.getTrackId(),t,n]}),wD=GP(),ID=yk({argsMap:e=>[e.getTrackId()]}),uP((AD=class extends WD{get __className__(){return"MicrophoneAudioTrack"}constructor(e,t,n,r){super(e,t.encoderConfig?jk(t.encoderConfig):{},r,UN("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),dP(this,"_config",void 0),dP(this,"_deviceName","default"),dP(this,"_constraints",void 0),dP(this,"_originalConstraints",void 0),dP(this,"_enabled",!0),this._config=t,this._constraints=n,this._originalConstraints=n,this._deviceName=e.label,"boolean"==typeof t.bypassWebAudio&&(this._bypassWebAudio=t.bypassWebAudio),(RI()||CI())&&EP.bindInterruptDetectorTrack(this)}async setDevice(e){if(pk.info("[".concat(this.getTrackId(),"] start set device to ").concat(e)),this._enabled)try{const t=await xP.getDeviceById(e),n={};n.audio=hP({},this._constraints),n.audio.deviceId={exact:e},this._originMediaStreamTrack.stop();let r=null;try{r=await PP(n,this.getTrackId())}catch(e){throw pk.error("[".concat(this.getTrackId(),"] setDevice failed"),e.toString()),r=await PP({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(r.getAudioTracks()[0],!1),e}await this._updateOriginMediaStreamTrack(r.getAudioTracks()[0],!1),this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(e){throw pk.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}else try{const t=await xP.getDeviceById(e);this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(e){throw pk.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}pk.info("[".concat(this.getTrackId(),"] set device to ").concat(e," success"))}async setEnabled(e,t,n){if(t)return pk.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(e);if(!n){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(pk.info("[".concat(this.getTrackId(),"] start setEnabled"),e),UN("AUTO_RESET_AUDIO_ROUTE")&&(mI()||II())){const t=navigator.audioSession;t&&(e||(t.type="playback"),t.type="auto")}if(!e){var r;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),null===(r=this._source.clonedTrack)||void 0===r||r.stop(),n||(this._enabled=!1);try{await vA(this,Vk.NEED_DISABLE_TRACK,this)}catch(e){throw pk.error("[".concat(this.getTrackId(),"] setEnabled false failed"),e.toString()),e}return}const o=hP({},this._constraints),i=xP.searchDeviceIdByName(this._deviceName);i&&!o.deviceId&&(o.deviceId=i);try{n||(this._enabled=!0);const e=await PP({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getAudioTracks()[0],!1),await vA(this,Vk.NEED_ENABLE_TRACK,this)}catch(e){throw n||(this._enabled=!1),pk.error("[".concat(this.getTrackId(),"] setEnabled true failed"),e.toString()),e}pk.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(RI()||CI())&&EP.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((mI()||II())&&this._enabled&&!this._isClosed&&EP.duringInterruption){const e=async()=>{EP.off(Ck.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(pk.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};EP.on(Ck.IOS_INTERRUPTION_END,e)}else pk.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Yk.TRACK_ENDED)}async renewMediaStreamTrack(e){const t=e||this._constraints,n=xP.searchDeviceIdByName(this._deviceName);if(n&&!t.deviceId&&(t.deviceId=n),this._constraints=t,this._enabled){this._originMediaStreamTrack.stop();const e=await PP({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getAudioTracks()[0],!0)}}bindProcessorContextEvents(e){super.bindProcessorContextEvents(e),e.on(rP.REQUEST_UPDATE_CONSTRAINTS,(async(e,t,n)=>{try{const n=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(n),t()}catch(e){n(e)}}))}unbindProcessorContextEvents(e){super.unbindProcessorContextEvents(e),e.removeAllListeners(rP.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[SD,OD],Object.getOwnPropertyDescriptor(AD.prototype,"setDevice"),AD.prototype),uP(AD.prototype,"setEnabled",[RD,CD,wD],Object.getOwnPropertyDescriptor(AD.prototype,"setEnabled"),AD.prototype),uP(AD.prototype,"close",[ID],Object.getOwnPropertyDescriptor(AD.prototype,"close"),AD.prototype),AD),KD=(ND=yk({argsMap:(e,t)=>[e.getTrackId(),t,e.duration]}),kD=GP(),PD=yk({argsMap:e=>[e.getTrackId()]}),DD=GP(),MD=yk({argsMap:e=>[e.getTrackId()]}),LD=GP(),xD=yk({argsMap:e=>[e.getTrackId()]}),UD=GP(),jD=yk({argsMap:e=>[e.getTrackId()]}),FD=GP(),BD=yk({argsMap:e=>[e.getTrackId()]}),VD=yk({argsMap:e=>[e.getTrackId()]}),HD=GP(),uP((GD=class extends WD{get __className__(){return"BufferSourceAudioTrack"}constructor(e,t,n,r){super(t.createOutputTrack(),n,r),dP(this,"source",void 0),dP(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=e,this._bufferSource=t,this._bufferSource.on(Jk.AUDIO_SOURCE_STATE_CHANGE,(e=>{this.safeEmit(Yk.SOURCE_STATE_CHANGE,e)}));try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(e){this._bufferSource.seekAudioBuffer(e)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(e){HI(e,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(e)}}).prototype,"startProcessAudioBuffer",[ND,kD],Object.getOwnPropertyDescriptor(GD.prototype,"startProcessAudioBuffer"),GD.prototype),uP(GD.prototype,"pauseProcessAudioBuffer",[PD,DD],Object.getOwnPropertyDescriptor(GD.prototype,"pauseProcessAudioBuffer"),GD.prototype),uP(GD.prototype,"seekAudioBuffer",[MD,LD],Object.getOwnPropertyDescriptor(GD.prototype,"seekAudioBuffer"),GD.prototype),uP(GD.prototype,"resumeProcessAudioBuffer",[xD,UD],Object.getOwnPropertyDescriptor(GD.prototype,"resumeProcessAudioBuffer"),GD.prototype),uP(GD.prototype,"stopProcessAudioBuffer",[jD,FD],Object.getOwnPropertyDescriptor(GD.prototype,"stopProcessAudioBuffer"),GD.prototype),uP(GD.prototype,"close",[BD],Object.getOwnPropertyDescriptor(GD.prototype,"close"),GD.prototype),uP(GD.prototype,"setAudioBufferPlaybackSpeed",[VD,HD],Object.getOwnPropertyDescriptor(GD.prototype,"setAudioBufferPlaybackSpeed"),GD.prototype),GD);class YD extends WD{get __className__(){return"MixingAudioTrack"}get isActive(){for(const e of this.trackList)if(e._enabled&&!e._isClosed&&!e.muted)return!0;return!1}constructor(){const e=yP().createMediaStreamDestination();super(e.stream.getAudioTracks()[0],void 0,LA(8,"track-mix-")),dP(this,"trackList",void 0),dP(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}this.destNode=e,this.trackList=[]}hasAudioTrack(e){return-1!==this.trackList.indexOf(e)}addAudioTrack(e){-1===this.trackList.indexOf(e)?(pk.debug("add ".concat(e.getTrackId()," to mixing track")),e._source.outputNode.connect(this.destNode),this.trackList.push(e),this.updateEncoderConfig()):pk.debug("track ".concat(e.getTrackId()," is already added"))}removeAudioTrack(e){if(-1!==this.trackList.indexOf(e)){pk.debug("remove ".concat(e.getTrackId()," from mixing track"));try{e._source.outputNode.disconnect(this.destNode)}catch(e){}_A(this.trackList,e),this.updateEncoderConfig()}}updateEncoderConfig(){const e={};this.trackList.forEach((t=>{t._encoderConfig&&((t._encoderConfig.bitrate||0)>(e.bitrate||0)&&(e.bitrate=t._encoderConfig.bitrate),(t._encoderConfig.sampleRate||0)>(e.sampleRate||0)&&(e.sampleRate=t._encoderConfig.sampleRate),(t._encoderConfig.sampleSize||0)>(e.sampleSize||0)&&(e.sampleSize=t._encoderConfig.sampleSize),t._encoderConfig.stereo&&(e.stereo=!0))})),this._encoderConfig=e}_updateRtpTransceiver(e){this._rtpTransceiver!==e&&(this._rtpTransceiver=e,this.trackList.forEach((t=>{t instanceof YD?t.emit(Kk.TRANSCEIVER_UPDATED,e):t._updateRtpTransceiver(e)})))}}class zD extends OP{set currentState(e){e!==this._currentState&&(this._currentState=e,this.safeEmit(Jk.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),dP(this,"audioBuffer",void 0),dP(this,"sourceNode",void 0),dP(this,"startPlayTime",0),dP(this,"startPlayOffset",0),dP(this,"pausePlayTime",0),dP(this,"options",void 0),dP(this,"currentLoopCount",0),dP(this,"currentPlaybackSpeed",100),dP(this,"_currentState","stopped"),this.audioBuffer=e,this.options=t,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?"stopped"===this.currentState?0:"paused"===this.currentState?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(e){"stopped"===this.currentState?(this.options=e,this.startPlayOffset=this.options.startPlayTime||0):pk.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&"playing"===this.currentState&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(e){this.sourceNode&&(this.sourceNode.onended=null,"playing"===this.currentState&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),"playing"===this.currentState?(this.startPlayOffset=e,this.startSourceNode()):"paused"===this.currentState&&(this.pausePlayTime=e))}resumeProcessAudioBuffer(){"paused"===this.currentState&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch(e){}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(e){this.sourceNode&&("playing"===this.currentState&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=e/100),this.currentPlaybackSpeed=e}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const e=this.context.createBufferSource();return e.buffer=this.audioBuffer,e.loop=!!this.options.loop,e.connect(this.outputNode),e.playbackRate.value=this.currentPlaybackSpeed/100,e}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const XD=new Map;class JD{get rendFrameRate(){if(this.renderStats&&this.renderStats.curTs!==this.renderStats.lastTs){const e=this.renderStats.curTs-this.renderStats.lastTs,t=(this.renderStats.renderNum-this.renderStats.lastRenderNum)/e;return this.renderStats.lastRenderNum=this.renderStats.renderNum,this.renderStats.lastTs=this.renderStats.curTs,t}return 0}get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(e){e!==this._videoElementStatus&&(pk.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(e)),this._videoElementStatus=e)}get videoState(){return this._videoState}set videoState(e){var t;e!==this._videoState&&(this._videoState=e,null===(t=this.onVideoStateChanged)||void 0===t||t.call(this,this.videoState))}constructor(e){dP(this,"trackId",void 0),dP(this,"config",void 0),dP(this,"onFirstVideoFrameDecoded",void 0),dP(this,"onVideoStateChanged",void 0),dP(this,"freezeTimeCounterList",[]),dP(this,"renderFreezeAccTime",0),dP(this,"isKeepLastFrame",!1),dP(this,"timeUpdatedCount",0),dP(this,"freezeTime",0),dP(this,"playbackTime",0),dP(this,"lastTimeUpdatedTime",0),dP(this,"autoplayFailed",!1),dP(this,"videoTrack",void 0),dP(this,"videoElement",void 0),dP(this,"cacheVideoElement",void 0),dP(this,"renderStats",void 0),dP(this,"_videoState",sP.VideoStateStopped),dP(this,"videoElementCheckInterval",void 0),dP(this,"videoElementFreezeTimeout",void 0),dP(this,"_videoElementStatus",aP.NONE),dP(this,"isGettingVideoDimensions",!1),dP(this,"startGetVideoDimensions",(()=>{const e=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return pk.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(e,500)};!this.isGettingVideoDimensions&&e()})),dP(this,"autoResumeAfterInterruption",(()=>{this.videoTrack&&"live"===this.videoTrack.readyState&&"running"===EP.curState&&(pk.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(lI())),wI()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))})),dP(this,"handleVideoEvents",(e=>{switch(e.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=aP.PLAYING;break;case"loadeddata":if(this.videoState=sP.VideoStateStarting,this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch(e){}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=aP.CANPLAY;break;case"stalled":this.videoElementStatus=aP.STALLED;break;case"suspend":this.videoElementStatus=aP.SUSPEND;break;case"pause":this.videoElementStatus=aP.PAUSED,mI()||II()||pI()&&this.autoplayFailed||!this.videoTrack||"live"!==this.videoTrack.readyState||(pk.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=aP.WAITING;break;case"abort":this.videoElementStatus=aP.ABORT;break;case"ended":this.videoElementStatus=aP.ENDED;break;case"emptied":this.videoElementStatus=aP.EMPTIED;break;case"error":{const e=this.videoElement.error;e&&(this.videoElementStatus=aP.ERROR,pk.error("[".concat(this.trackId,"] media error: ").concat(e.message," (").concat(e.code,")")));break}case"timeupdate":{const e=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=e);const t=e-this.lastTimeUpdatedTime,n=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=e,ZM.lastVisibleTime<ZM.lastHiddenTime||n<ZM.lastHiddenTime||n<ZM.lastVisibleTime)return;for(t>UN("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=t),this.playbackTime+=t;this.playbackTime>=6e3;){this.playbackTime-=6e3;const e=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(e),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}})),dP(this,"autoResumeAfterInterruptionOnIOS15_16",(()=>{this.videoTrack&&"live"===this.videoTrack.readyState&&(pk.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(lI())),wI()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))})),this.trackId=e.trackId,this.config=e,e.element instanceof HTMLVideoElement?this.videoElement=e.element:this.videoElement=document.createElement("video"),EP.on(Ck.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),EP.on(Ck.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var e;return null!==(e=this.videoElement.parentElement)&&void 0!==e?e:void 0}updateConfig(e){this.config=e,this.trackId=e.trackId,e.element!==this.videoElement&&(this.destroy(),this.videoElement=e.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.initVideoElement())}play(e){const t=this.videoElement.play();t&&t.catch&&t.catch((t=>{e&&BP(e,"video",t.message,this.trackId),"NotAllowedError"===t.name?(pk.warning("detected video element autoplay failed",t),this.autoplayFailed=!0,this.handleAutoPlayFailed()):pk.warning("[".concat(this.trackId,"] play warning: "),t)}));const n=aI();if(("Safari"===n.name&&15===Number(n.version)||RI())&&t&&t.then){const e=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};t.then(e).catch(e)}}getCurrentFrame(){const e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;const t=e.getContext("2d");if(!t)return pk.error("create canvas context failed!"),new ImageData(2,2);t.drawImage(this.videoElement,0,0,e.width,e.height);const n=t.getImageData(0,0,e.width,e.height);return e.remove(),n}async getCurrentFrameToUint8Array(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=document.createElement("canvas");n.width=this.videoElement.videoWidth,n.height=this.videoElement.videoHeight;const r=n.getContext("2d");return r?(r.drawImage(this.videoElement,0,0,n.width,n.height),new ih(((r,o)=>{n.toBlob((async e=>{if(n.remove(),e){const t=await rD(e);r({buffer:t,width:n.width,height:n.height})}else o(new FI(jI.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))}),e,t<0?.1:t>1?1:t)}))):await nD(e)}destroy(){this.renderStats=void 0,EP.off(Ck.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),EP.off(Ck.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=sP.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=aP.INIT,!this.videoElementCheckInterval&&(ZD.forEach((e=>{this.videoElement.addEventListener(e,this.handleVideoEvents)})),this.videoElementCheckInterval=window.setInterval((()=>{(function(e){return e!==document.body&&document.body.contains(e)})(this.videoElement)||(this.videoElementStatus=aP.DESTROYED)}),1e3),UN("ENABLE_VIDEO_FRAME_CALLBACK"))){var e,t;let n;const r=()=>{"visible"===document.visibilityState&&(document.removeEventListener("visibilitychange",r),this.videoElementFreezeTimeout=window.setTimeout(o,UN("VIDEO_FREEZE_DURATION")))},o=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===sP.VideoStateDecoding&&("visible"===document.visibilityState?this.videoState=sP.VideoStateFrozen:document.addEventListener("visibilitychange",r))},i=(e,t)=>{if(this.videoElementStatus===aP.PLAYING){if(this.renderStats?(this.renderStats.renderNum++,this.renderStats.curTs=t.mediaTime):this.renderStats={lastTs:t.mediaTime,curTs:t.mediaTime,lastRenderNum:0,renderNum:0},n){const e=t.presentationTime-n.presentationTime;this.videoState===sP.VideoStateStarting&&(this.videoState=sP.VideoStateDecoding),this.videoState===sP.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(o,UN("VIDEO_FREEZE_DURATION"))),e<UN("VIDEO_FREEZE_DURATION")&&this.videoState===sP.VideoStateFrozen&&(this.videoState=sP.VideoStateDecoding),e>UN("VIDEO_FREEZE_DURATION")&&ZM.lastVisibleTime>=ZM.lastHiddenTime&&n.timestamp>ZM.lastVisibleTime&&n.timestamp>ZM.lastHiddenTime&&(this.renderFreezeAccTime+=e)}n=hP(hP({},t),{},{timestamp:e})}var r,a;UN("ENABLE_VIDEO_FRAME_CALLBACK")&&(null===(r=(a=this.videoElement).requestVideoFrameCallback)||void 0===r||r.call(a,i))};null===(e=(t=this.videoElement).requestVideoFrameCallback)||void 0===e||e.call(t,i)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),DI()&&!UN("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");const n=aI();"Safari"===n.name&&15===Number(n.version)||RI()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,fI()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,fI()&&this.videoElement.load());const r=this.videoElement.play();void 0!==r&&r.catch((e=>{pk.debug("[".concat(this.trackId,"] playback interrupted"),e.toString())}))}resetVideoElement(){ZD.forEach((e=>{this.videoElement&&this.videoElement.removeEventListener(e,this.handleVideoEvents)})),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=aP.NONE}handleAutoPlayFailed(){const e=t=>{t.preventDefault(),this.videoElement.play().then((()=>{pk.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))})).catch((e=>{pk.error(e)})),this.autoplayFailed=!1,MI()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};MI()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),FP()}}const ZD=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class QD extends JD{constructor(e){super(e),dP(this,"container",void 0),dP(this,"slot",void 0),this.slot=e.element,this.updateConfig(e)}updateConfig(e){this.config=e,this.trackId=e.trackId;const t=e.element;t!==this.slot&&(this.destroy(),this.slot=t),this.createElements()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.createElements())}play(e){var t;null!==(t=this.container)&&void 0!==t&&t.contains(this.videoElement)&&super.play(e)}getCurrentFrame(){var e;return null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return null!==(t=this.container)&&void 0!==t&&t.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(e,n):await nD(e)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch(e){}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",UN("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var e;!this.container||null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var e;if(null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch(e){}this.videoElement=document.createElement("video")}}resetVideoElement(){var e;null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}var $D,eM,tM,nM,rM,oM,iM,aM,sM,cM,lM,uM,dM,pM,hM,fM,mM,vM,gM,EM,yM,_M,bM,TM,SM,OM,RM,CM,wM,IM,AM,NM,kM,PM;let DM=($D=yk({argsMap:(e,t,n)=>[e.getTrackId(),"string"==typeof t?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",n]}),eM=GP(),tM=yk({argsMap:e=>[e.getTrackId()]}),nM=zA("LocalVideoTrack","_enabledMutex"),rM=yk({argsMap:(e,t)=>[e.getTrackId(),t]}),oM=GP(),iM=zA("LocalVideoTrack","_enabledMutex"),aM=yk({argsMap:(e,t)=>[e.getTrackId(),t]}),sM=GP(),cM=yk({argsMap:(e,t)=>[e.getTrackId(),t]}),lM=GP(),uM=GP(),dM=yk({argsMap:(e,t,n)=>[e.getTrackId(),t,n]}),pM=GP(),hM=GP(),fM=GP(),mM=GP(),vM=GP(),gM=GP(),EM=GP(),yM=yk({argsMap:(e,t)=>[e.getTrackId(),t.name]}),_M=yk({argsMap:e=>[e.getTrackId()]}),bM=yk({argsMap:e=>[e.getTrackId()]}),TM=yk({argsMap:(e,t,n)=>[e.getTrackId(),t.label,n]}),SM=class e extends mP{get videoHeight(){if(pI()){const{height:e}=this._mediaStreamTrack.getSettings();return this._videoHeight=e,this._videoHeight}return this._videoHeight}get videoWidth(){if(pI()){const{width:e}=this._mediaStreamTrack.getSettings();return this._videoWidth=e,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==aP.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(e){this._processorContext=e}get __className__(){return"LocalVideoTrack"}constructor(e,t,n,r,o,i){if(super(e,o),dP(this,"trackMediaType",Xk.VIDEO),dP(this,"_player",void 0),dP(this,"isUseScaleResolutionDownBy",!1),dP(this,"_videoVisibleTimer",null),dP(this,"_previousVideoVisibleStatus",void 0),dP(this,"_clearPreviousVideoVisibleStatus",(()=>this._previousVideoVisibleStatus=void 0)),dP(this,"_encoderConfig",void 0),dP(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),dP(this,"_optimizationMode",void 0),dP(this,"_videoHeight",void 0),dP(this,"_videoWidth",void 0),dP(this,"_forceBitrateLimit",void 0),dP(this,"_enabled",!0),dP(this,"_processorDestination",void 0),dP(this,"_processorContext",void 0),pI()){const{width:t,height:n}=e.getSettings();this._videoWidth=t,this._videoHeight=n}else this.updateMediaStreamTrackResolution();if(this._encoderConfig=t,this._scalabilityMode=n,this._optimizationMode=r,this._hints=i||[],-1===this._hints.indexOf(Hk.SCREEN_TRACK))this.updateBitrateFromProfile();else if(EI(nI.CHROME,115)&&-1!==cI().indexOf("Windows")){const t=function(e,t){if("VideoFrame"in window&&"TransformStream"in window&&Sk().supportWebRTCInsertableStream){const n=new MediaStreamTrackProcessor(e),r=new MediaStreamTrackGenerator({kind:"video"});let o,i,a=Date.now();const s=()=>{c&&(clearInterval(c),c=void 0),o&&(o.close(),o=void 0),e.stop(),i=void 0,r.removeEventListener("ended",s)};let c=window.setInterval((()=>{if(i&&o&&Date.now()-a>(null!=t?t:1e3))try{"live"===r.readyState?i.enqueue(o.clone()):s()}catch(e){s()}}),null!=t?t:1e3);const l=new TransformStream({transform:(e,t)=>{"live"===r.readyState?(i=t,a=Date.now(),void 0===o?(o=e,t.enqueue(e.clone())):(t.enqueue(o),o=e)):e.close()}});return r.addEventListener("ended",s),n.readable.pipeThrough(l).pipeTo(r.writable),r}}(e);t&&(pk.info("local screen video track begin to inject frame"),this._mediaStreamTrack=t)}t&&-1!==this._hints.indexOf(Hk.CUSTOM_TRACK)&&this.setEncoderConfiguration(t),this._processorContext=new qP(this.getTrackId(),"local"),this._processorDestination=new WP(this.processorContext),this.bindProcessorDestinationEvents()}play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){const t=document.getElementById(e);t?e=t:(pk.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}pk.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(t));const n=hP(hP(hP({},this._getDefaultPlayerConfig()),t),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(n):(e instanceof HTMLVideoElement?this._player=new JD(n):this._player=new QD(n),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval((()=>{try{const e=this.getVideoElementVisibleStatus();this.safeEmit(Yk.VIDEO_ELEMENT_VISIBLE_STATUS,e)}catch(e){}}),UN("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,pk.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(e,t){if(!t){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(pk.info("[".concat(this.getTrackId(),"] start setEnabled"),e),!e){this._originMediaStreamTrack.enabled=!1;try{await vA(this,Vk.NEED_DISABLE_TRACK,this)}catch(e){throw pk.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}return t||(this._enabled=!1),void pk.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await vA(this,Vk.NEED_ENABLE_TRACK,this)}catch(e){throw pk.error("[".concat(this.getTrackId(),"] setEnabled to true error"),e.toString()),e}pk.info("[".concat(this.getTrackId(),"] setEnabled to true success")),t||(this._enabled=!0)}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,pk.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),e?await vA(this,Vk.NEED_MUTE_TRACK,this):await vA(this,Vk.NEED_UNMUTE_TRACK,this))}async setEncoderConfiguration(e,t){if(!this._enabled)throw new FI(jI.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(e=Mk(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin),e.width||e.height||e.frameRate){const t=ZP({encoderConfig:e});(pI()||mI()||II())&&(t.deviceId=void 0),pk.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(e),JSON.stringify(t));try{await this._originMediaStreamTrack.applyConstraints(t),this.updateMediaStreamTrackResolution()}catch(e){const t=new FI(jI.UNEXPECTED_ERROR,e.toString());throw pk.error("[".concat(this.getTrackId(),"] applyConstraints error"),t.toString()),t}}this._encoderConfig=e,-1===this._hints.indexOf(Hk.SCREEN_TRACK)&&this.updateBitrateFromProfile();try{await vA(this,Vk.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(pk)}}getStats(){return CA((()=>{pk.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")}),"localVideoTrackGetStatsWarning"),gA(this,Vk.GET_STATS)||hP({},Qk)}async setBeautyEffect(e){pk.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(e,t):await nD(e)}async setBitrateLimit(e){pk.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(e))),e&&(this._forceBitrateLimit=e,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<e.max_bitrate?this._encoderConfig.bitrateMax:e.max_bitrate:this._encoderConfig.bitrateMax=e.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=e.min_bitrate))}async setOptimizationMode(e){if("motion"!==e&&"detail"!==e&&"balanced"!==e)return void pk.error(jI.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const t=this._optimizationMode;try{this._optimizationMode=e,await vA(this,Vk.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this)}catch(e){throw this._optimizationMode=t,pk.error("[".concat(this.getTrackId(),"] set optimization mode failed"),e.toString()),e}pk.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(e,")"))}setScalabiltyMode(e){if(1===e.numSpatialLayers&&1!==e.numTemporalLayers)return pk.error(jI.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=e,pk.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(e,")"))}updateMediaStreamTrackResolution(){JP(this._originMediaStreamTrack).then((e=>{let[t,n]=e;this._videoHeight=n,this._videoWidth=t})).catch(UA)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(e){if(!this._enabled)throw new FI(jI.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");pk.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(e)),e=Mk(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin),this._encoderConfig=e,-1===this._hints.indexOf(Hk.SCREEN_TRACK)&&this.updateBitrateFromProfile();try{await vA(this,Vk.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(pk)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:e,height:t,frameRate:n}=this.getMediaStreamTrackSettings();if(!e||!t||!n)return;const{bitrateMax:r,bitrateMin:o}=this._encoderConfig;if(null==o||null==r){const{max:i,min:a}=function(e,t,n,r,o){const i=UN("BITRATE_ADAPTER_TYPE");if("DEFAULT_BITRATE"===i)return{min:r,max:o};if(void 0===o){var a;const s=Math.floor(200*Math.pow(n/15,.6)*Math.pow(e*t/640/360,.75));o="STANDARD_BITRATE"===i?4*s:2*s,r=null!==(a=r)&&void 0!==a?a:s}else{var s;r=null!==(s=r)&&void 0!==s?s:Math.floor(o/10)}return{min:r,max:o}}(e,t,n,o,r);this._encoderConfig.bitrateMin=a,this._encoderConfig.bitrateMax=i,pk.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(e,", h: ").concat(t,", fps: ").concat(n,"] => [brMax: ").concat(i,", brMin: ").concat(a,"]"))}}getVideoElementVisibleStatus(){try{var e,t;const n=null==this||null===(e=this._player)||void 0===e?void 0:e.getContainerElement(),r={track:this,element:null==this||null===(t=this._player)||void 0===t?void 0:t.getVideoElement(),slot:null==n?void 0:n.parentElement},{element:o,slot:i}=r;if(this.isPlaying&&o instanceof HTMLVideoElement&&i instanceof HTMLElement){const e=JI.checkOneElementVisible(o),t=Object.assign({},e);if(t.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=t.visible;const e=_k.reportApiInvoke(null,{tag:oA.TRACER,name:rA.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});t.visible?e.onSuccess("Video is visible"):e.onSuccess("Invisible because of ".concat(t.reason))}return t}return}catch(e){throw new FI(jI.GET_VIDEO_ELEMENT_VISIBLE_ERROR,e.message)}}async renewMediaStreamTrack(e){}pipe(e){if(this.processor===e)return e;if(e._source)throw new FI(jI.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this._encoderConfig;t&&(r=hP(hP({},r),Mk(t))),r=OA(r);const o=LA(8,"track-video-cloned-"),i=new e(n?this._mediaStreamTrack.clone():this._mediaStreamTrack,r,OA(this._scalabilityMode),this._optimizationMode,o,OA(this._hints));return t&&r&&i.setEncoderConfiguration(r),pk.debug("clone video track from ".concat(this.getTrackId()," to ").concat(o,", clone ").concat(n)),i}async replaceTrack(e,t){if(!(e instanceof MediaStreamTrack))throw new FI(jI.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if("video"!==e.kind)throw new FI(jI.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(e,t,!0),this.updateMediaStreamTrackResolution()}sendSeiData(e){if(CA((()=>{_k.reportApiInvoke(null,{name:rA.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:oA.TRACER}).onSuccess("")}),this._mediaStreamTrack.id||this.getTrackId()),!UN("ENABLE_VIDEO_SEI")||!UN("ENABLE_ENCODED_TRANSFORM"))return void pk.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(e instanceof Uint8Array==0)return new FI(jI.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const t=this.getRTCRtpTransceiver();if(!t)return void pk.warning("Video track is not published, SEI can not be send");const n=t.sender.getParameters();if(0===n.codecs.length)return;const r=n.codecs[0].mimeType.toLocaleLowerCase();"video/h264"===r?this.safeEmit("sei-to-send",e):pk.warning("SEI is not supported by ".concat(r))}bindProcessorDestinationEvents(){this.processorDestination.on(nP.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(),await vA(this,Vk.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await vA(this,Vk.NEED_REPLACE_TRACK,this))}))}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(nP.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(rP.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(rP.REQUEST_CONSTRAINTS)}},uP(SM.prototype,"play",[$D,eM],Object.getOwnPropertyDescriptor(SM.prototype,"play"),SM.prototype),uP(SM.prototype,"stop",[tM],Object.getOwnPropertyDescriptor(SM.prototype,"stop"),SM.prototype),uP(SM.prototype,"setEnabled",[nM,rM,oM],Object.getOwnPropertyDescriptor(SM.prototype,"setEnabled"),SM.prototype),uP(SM.prototype,"setMuted",[iM,aM,sM],Object.getOwnPropertyDescriptor(SM.prototype,"setMuted"),SM.prototype),uP(SM.prototype,"setEncoderConfiguration",[cM,lM],Object.getOwnPropertyDescriptor(SM.prototype,"setEncoderConfiguration"),SM.prototype),uP(SM.prototype,"getStats",[uM],Object.getOwnPropertyDescriptor(SM.prototype,"getStats"),SM.prototype),uP(SM.prototype,"setBeautyEffect",[dM,pM],Object.getOwnPropertyDescriptor(SM.prototype,"setBeautyEffect"),SM.prototype),uP(SM.prototype,"getCurrentFrameData",[hM],Object.getOwnPropertyDescriptor(SM.prototype,"getCurrentFrameData"),SM.prototype),uP(SM.prototype,"getCurrentFrameImage",[fM],Object.getOwnPropertyDescriptor(SM.prototype,"getCurrentFrameImage"),SM.prototype),uP(SM.prototype,"setBitrateLimit",[mM],Object.getOwnPropertyDescriptor(SM.prototype,"setBitrateLimit"),SM.prototype),uP(SM.prototype,"setOptimizationMode",[vM],Object.getOwnPropertyDescriptor(SM.prototype,"setOptimizationMode"),SM.prototype),uP(SM.prototype,"setScalabiltyMode",[gM],Object.getOwnPropertyDescriptor(SM.prototype,"setScalabiltyMode"),SM.prototype),uP(SM.prototype,"updateMediaStreamTrackResolution",[EM],Object.getOwnPropertyDescriptor(SM.prototype,"updateMediaStreamTrackResolution"),SM.prototype),uP(SM.prototype,"pipe",[yM],Object.getOwnPropertyDescriptor(SM.prototype,"pipe"),SM.prototype),uP(SM.prototype,"unpipe",[_M],Object.getOwnPropertyDescriptor(SM.prototype,"unpipe"),SM.prototype),uP(SM.prototype,"close",[bM],Object.getOwnPropertyDescriptor(SM.prototype,"close"),SM.prototype),uP(SM.prototype,"replaceTrack",[TM],Object.getOwnPropertyDescriptor(SM.prototype,"replaceTrack"),SM.prototype),SM),MM=(OM=yk({argsMap:(e,t)=>[e.getTrackId(),t]}),RM=GP(),CM=zA("CameraVideoTrack","_enabledMutex"),wM=yk({argsMap:(e,t)=>[e.getTrackId(),t]}),IM=GP(),AM=yk({argsMap:(e,t)=>[e.getTrackId(),t]}),NM=GP(),kM=yk({argsMap:e=>[e.getTrackId()]}),PM=class e extends DM{get __className__(){return"CameraVideoTrack"}constructor(e,t,n,r,o,i){super(e,Mk(t.encoderConfig),r,o,i),dP(this,"_config",void 0),dP(this,"_originalConstraints",void 0),dP(this,"_constraints",void 0),dP(this,"_enabled",!0),dP(this,"_deviceName","default"),dP(this,"tryResumeVideoForIOS15_16WeChat",(async()=>{(RI()||CI())&&!function(){const e=aI();if(e.os!==tI.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])&&Number(t[1])>=2}()&&AI()&&this._enabled&&!this._isClosed&&(pk.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())})),this._config=t,this._originalConstraints=n,this._constraints=n,this._deviceName=e.label,this._encoderConfig=Mk(this._config.encoderConfig),EP.on(Ck.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),EP.on(Ck.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(e){return"string"==typeof e?this._setDeviceById(e):e.deviceId?this._setDeviceById(e.deviceId):e.facingMode?this._setDeviceByFacingModel(e.facingMode):void 0}async _setDeviceById(e){if(pk.info("[".concat(this.getTrackId(),"] set device to ").concat(e)),this._enabled)try{const t=await xP.getDeviceById(e),n={};n.video=hP({},this._constraints),n.video.deviceId={exact:e},n.video.facingMode=void 0,this._originMediaStreamTrack.stop();let r=null;try{r=await PP(n,this.getTrackId())}catch(e){throw pk.error("[".concat(this.getTrackId(),"] setDevice failed"),e.toString()),r=await PP({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(r.getVideoTracks()[0],!1),e}await this._updateOriginMediaStreamTrack(r.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=t.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(e){throw pk.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}else try{const t=await xP.getDeviceById(e);this._deviceName=t.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(e){throw pk.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}pk.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(e){pk.info("[".concat(this.getTrackId(),"] set facingMode ").concat(e));const t={video:hP(hP({},this._constraints),{},{deviceId:void 0,facingMode:{exact:e}})};if(this._enabled){this._originMediaStreamTrack.stop();let e=null;try{e=await PP(t,this.getTrackId())}catch(t){throw pk.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),t.toString()),e=await PP({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1),t}await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=e,this._config.cameraId=void 0,this._constraints=hP({},t.video),pk.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(e,t){if(!t){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(pk.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const e=await PP({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1)}await vA(this,Vk.NEED_ENABLE_TRACK,this)}catch(e){throw pk.error("[".concat(this.getTrackId(),"] setEnabled true error"),e.toString()),e}this.updateMediaStreamTrackResolution(),pk.info("[".concat(this.getTrackId(),"] setEnabled to true success")),t||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),t||(this._enabled=!1);try{await vA(this,Vk.NEED_DISABLE_TRACK,this)}catch(e){throw pk.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}pk.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(e,t){if(!this._enabled)throw new FI(jI.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");e=Mk(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate||e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate||e.bitrateMin);const n=SA(this._config);n.encoderConfig=e;const r=ZP(n);(pI()||mI()||II())&&(r.deviceId=void 0),pk.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(e),JSON.stringify(r));try{await this._originMediaStreamTrack.applyConstraints(r),this.updateMediaStreamTrackResolution()}catch(e){const t=new FI(jI.UNEXPECTED_ERROR,e.toString());throw pk.error("[".concat(this.getTrackId(),"] applyConstraints error"),t.toString()),t}this._config=n,this._constraints=r,this._originalConstraints=r,this._encoderConfig=e,-1===this._hints.indexOf(Hk.SCREEN_TRACK)&&this.updateBitrateFromProfile();try{await vA(this,Vk.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(pk)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((mI()||II())&&this._enabled&&!this._isClosed&&EP.duringInterruption){const e=async()=>{EP.off(Ck.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(pk.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};EP.on(Ck.IOS_INTERRUPTION_END,e)}else pk.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Yk.TRACK_ENDED)}async renewMediaStreamTrack(e){const t=e||this._constraints,n=xP.searchDeviceIdByName(this._deviceName);if(n&&!t.deviceId&&(t.deviceId={exact:n}),this._enabled){const e=await PP({video:t},this.getTrackId());this._constraints=t,await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),EP.off(Ck.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),EP.off(Ck.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this._encoderConfig;t&&(r=hP(hP({},r),Mk(t))),r=OA(r);const o=LA(8,"track-cam-cloned-"),i=new e(n?this._mediaStreamTrack.clone():this._mediaStreamTrack,OA(hP(hP({},this._config),{},{encoderConfig:r})),OA(this._constraints),OA(this._scalabilityMode),this._optimizationMode,o);return t&&r&&i.setEncoderConfiguration(r),pk.debug("clone track from ".concat(this.getTrackId()," to ").concat(o,", clone ").concat(n)),i}bindProcessorContextEvents(){this.processorContext.on(rP.REQUEST_UPDATE_CONSTRAINTS,(async(e,t,n)=>{try{const n=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(n),t()}catch(e){n(e)}})),this.processorContext.on(rP.REQUEST_CONSTRAINTS,(async e=>{e(this._originMediaStreamTrack.getSettings())}))}},uP(PM.prototype,"setDevice",[OM,RM],Object.getOwnPropertyDescriptor(PM.prototype,"setDevice"),PM.prototype),uP(PM.prototype,"setEnabled",[CM,wM,IM],Object.getOwnPropertyDescriptor(PM.prototype,"setEnabled"),PM.prototype),uP(PM.prototype,"setEncoderConfiguration",[AM,NM],Object.getOwnPropertyDescriptor(PM.prototype,"setEncoderConfiguration"),PM.prototype),uP(PM.prototype,"close",[kM],Object.getOwnPropertyDescriptor(PM.prototype,"close"),PM.prototype),PM);function LM(e,t,n,r){n.optimizationMode&&(r&&r.width&&r.height?(n.encoderConfig=hP(hP({},r),{},{bitrateMin:r.bitrateMin,bitrateMax:r.bitrateMax}),"motion"!==n.optimizationMode&&"detail"!==n.optimizationMode||(t.contentHint=n.optimizationMode,t.contentHint===n.optimizationMode?pk.debug("[".concat(e,"] set content hint to"),n.optimizationMode):pk.debug("[".concat(e,"] set content hint failed")))):pk.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig")))}var xM,UM,jM,FM,BM,VM,HM,GM,WM,qM,KM,YM;class zM extends fP{getUserId(){return this._userId}constructor(e,t,n,r){super(e,"track-".concat(e.kind,"-").concat(t,"-").concat(r.clientId,"_").concat(LA(5,""))),dP(this,"_userId",void 0),dP(this,"_uintId",void 0),dP(this,"_isDestroyed",!1),dP(this,"store",void 0),dP(this,"processor",void 0),dP(this,"processorContext",void 0),this._userId=t,this._uintId=n,this.store=r}_updateOriginMediaStreamTrack(e){this._originMediaStreamTrack=e,this._mediaStreamTrack=e,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,pk.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let XM=(xM=yk({argsMap:(e,t,n)=>[e.getTrackId(),"string"==typeof t?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",n]}),UM=yk({argsMap:e=>[e.getTrackId()]}),jM=yk({argsMap:(e,t)=>[e.getTrackId(),t.name]}),FM=yk({argsMap:e=>[e.getTrackId()]}),uP((BM=class extends zM{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==aP.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(e,t,n,r){super(e,t,n,r),dP(this,"_videoVisibleTimer",null),dP(this,"_previousVideoVisibleStatus",void 0),dP(this,"_clearPreviousVideoVisibleStatus",(()=>this._previousVideoVisibleStatus=void 0)),dP(this,"trackMediaType",Xk.VIDEO),dP(this,"_videoWidth",void 0),dP(this,"_videoHeight",void 0),dP(this,"_player",void 0),dP(this,"processorDestination",void 0),dP(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new qP(this.getTrackId(),"remote"),this.processorDestination=new WP(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return CA((()=>{pk.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")}),"remoteVideoTrackGetStatsWarning"),gA(this,Vk.GET_STATS)||hP({},tP)}play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){const t=document.getElementById(e);t?e=t:(pk.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}pk.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(t));const n=hP(hP({fit:"cover"},t),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(n):(e instanceof HTMLVideoElement?this._player=new JD(n):this._player=new QD(n),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(zk.FIRST_FRAME_DECODED)},this._player.onVideoStateChanged=e=>{this.safeEmit(zk.VIDEO_STATE_CHANGED,e)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval((()=>{try{const e=this.getVideoElementVisibleStatus();this.safeEmit(zk.VIDEO_ELEMENT_VISIBLE_STATUS,e)}catch(e){}}),UN("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,pk.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){JP(this._originMediaStreamTrack).then((e=>{let[t,n]=e;this._videoHeight=n,this._videoWidth=t})).catch(UA)}_updatePlayerSource(){pk.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,t;const n=null==this||null===(e=this._player)||void 0===e?void 0:e.getContainerElement(),r={track:this,element:null==this||null===(t=this._player)||void 0===t?void 0:t.getVideoElement(),slot:null==n?void 0:n.parentElement},{element:o,slot:i}=r;if(this.isPlaying&&o instanceof HTMLVideoElement&&i instanceof HTMLElement){const e=JI.checkOneElementVisible(o),t=Object.assign({},e);if(t.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=t.visible;const e=_k.reportApiInvoke(null,{tag:oA.TRACER,name:rA.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});t.visible?e.onSuccess("Video is visible"):e.onSuccess("Invisible because of ".concat(t.reason))}return t}return}catch(e){throw new FI(jI.GET_VIDEO_ELEMENT_VISIBLE_ERROR,e.message)}}pipe(e){if(this.processor===e)return e;if(e._source)throw new FI(jI.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(nP.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}))}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(nP.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(e){this.emit(Kk.SEI_RECEIVED,e)}}).prototype,"play",[xM],Object.getOwnPropertyDescriptor(BM.prototype,"play"),BM.prototype),uP(BM.prototype,"stop",[UM],Object.getOwnPropertyDescriptor(BM.prototype,"stop"),BM.prototype),uP(BM.prototype,"pipe",[jM],Object.getOwnPropertyDescriptor(BM.prototype,"pipe"),BM.prototype),uP(BM.prototype,"unpipe",[FM],Object.getOwnPropertyDescriptor(BM.prototype,"unpipe"),BM.prototype),BM),JM=(VM=yk({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),HM=yk({argsMap:(e,t)=>[e.getTrackId(),t]}),GM=yk({argsMap:e=>[e.getTrackId()]}),WM=yk({argsMap:e=>[e.getTrackId()]}),qM=yk({argsMap:(e,t)=>[e.getTrackId(),t.name]}),KM=yk({argsMap:e=>[e.getTrackId()]}),uP((YM=class extends zM{get isPlaying(){return this._useAudioElement?HP.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(e,t,n,r){super(e,t,n,r),dP(this,"trackMediaType",Xk.AUDIO),dP(this,"_source",void 0),dP(this,"_useAudioElement",!0),dP(this,"_volume",100),dP(this,"processorContext",void 0),dP(this,"processorDestination",void 0),dP(this,"_played",!1),dP(this,"_bypassWebAudio",!1),UN("DISABLE_WEBAUDIO")?(this._source=new zP,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new RP(e,!0),UN("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(Jk.RECEIVE_TRACK_BUFFER,(()=>{this.safeEmit(zk.FIRST_FRAME_DECODED)})),this.processorContext=new YP(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new KP(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(Jk.UPDATE_SOURCE,(()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})}))}setAudioFrameCallback(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!e)return this._source.removeAllListeners(Jk.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(Jk.ON_AUDIO_BUFFER),this._source.on(Jk.ON_AUDIO_BUFFER,(t=>e(t)))}setVolume(e){this._volume=e,this._useAudioElement?HP.setVolume(this.getTrackId(),e):this._source.setVolume(e/100)}async setPlaybackDevice(e){if(!this._useAudioElement||!Ok())throw new FI(jI.NOT_SUPPORTED,"your browser does not support setting the audio output device");await HP.setSinkID(this.getTrackId(),e)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return CA((()=>{pk.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")}),"remoteAudioTrackGetStatsWarning"),gA(this,Vk.GET_STATS)||hP({},$k)}play(){pk.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(pk.debug("[".concat(this.getTrackId(),"] use audio element to play")),HP.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){pk.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?HP.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];pk.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&HP.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(e){if(this._bypassWebAudio)throw new FI(jI.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===e)return e;if(e._source)throw new FI(jI.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(this._bypassWebAudio)throw new FI(jI.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const t=this.processor;null===(e=this._source.processSourceNode)||void 0===e||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(nP.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})),this.processorDestination.on(nP.ON_NODE,(e=>{this._source.processedNode=e;const t=!e;this._useAudioElement!==t&&(this._played?(this.stop(),this._useAudioElement=t,this.play()):this._useAudioElement=t)}))}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(nP.ON_TRACK),this.processorDestination.removeAllListeners(nP.ON_NODE)}}).prototype,"setVolume",[VM],Object.getOwnPropertyDescriptor(YM.prototype,"setVolume"),YM.prototype),uP(YM.prototype,"setPlaybackDevice",[HM],Object.getOwnPropertyDescriptor(YM.prototype,"setPlaybackDevice"),YM.prototype),uP(YM.prototype,"play",[GM],Object.getOwnPropertyDescriptor(YM.prototype,"play"),YM.prototype),uP(YM.prototype,"stop",[WM],Object.getOwnPropertyDescriptor(YM.prototype,"stop"),YM.prototype),uP(YM.prototype,"pipe",[qM],Object.getOwnPropertyDescriptor(YM.prototype,"pipe"),YM.prototype),uP(YM.prototype,"unpipe",[KM],Object.getOwnPropertyDescriptor(YM.prototype,"unpipe"),YM.prototype),YM);const ZM=new class extends eA{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),dP(this,"_lastHiddenTime",0),dP(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),pk.debug("current web page is ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)}))}};class QM extends eA{constructor(e,t){super(),dP(this,"trackMediaType",Xk.DATA),dP(this,"_version",1),dP(this,"_type",3),dP(this,"_config",void 0),dP(this,"_originDataChannel",void 0),dP(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),dP(this,"_dataStreamPacketHandler",{serialize:e=>e,deserialize:e=>e}),dP(this,"_datachannelEventMap",new Map),this._config=e,t&&(this._originDataChannel=t,this._bandDataChannelEvents(t)),this._initPacketHeader()}useDataStream(e){this._dataStreamPacketHandler=e}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return UN("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var e,t;return null!==(e=null===(t=this._originDataChannel)||void 0===t?void 0:t.readyState)&&void 0!==e?e:"connecting"}get _originDataChannelId(){var e,t;return null!==(e=null===(t=this._originDataChannel)||void 0===t?void 0:t.id)&&void 0!==e?e:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new ih(((e,t)=>{if(this._originDataChannel){"open"===this._originDataChannel.readyState&&e();const n=setTimeout((()=>{var e;t(new FI(jI.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat(null===(e=this._originDataChannel)||void 0===e?void 0:e.id)))}),1e4);this._originDataChannel.onopen=()=>{clearTimeout(n),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),e()},this._originDataChannel.onerror=()=>{throw clearTimeout(n),new FI(jI.DATACHANNEL_CONNECTION_TIMEOUT)}}else t(new FI(jI.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))}))}_updateOriginDataChannel(e){this._originDataChannel=e,this._bandDataChannelEvents(e)}_initPacketHeader(){const e=new DataView(this._dataStreamPacketHeader);e.setUint16(0,this._version),e.setUint8(2,this._type),e.setUint8(3,this._config.id)}_bandDataChannelEvents(e){this._unbindDataChannelEvents(e),[lP.OPEN,lP.CLOSE,lP.ERROR].forEach((t=>{const n=()=>{this.emit(t)};this._datachannelEventMap.set(t,n),e.addEventListener(t,n)}))}_unbindDataChannelEvents(e){Array.from(this._datachannelEventMap.entries()).forEach((t=>{let[n,r]=t;e.removeEventListener(n,r)})),this._datachannelEventMap.clear()}}class $M extends QM{constructor(e){super(e),dP(this,"_messageListener",void 0),this._messageListener=e=>{if(e.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const t=e.data.slice(0,this._dataStreamPacketHeader.byteLength),n=new DataView(t).getUint8(3);if(n!==this.id)return void(UN("SHOW_DATASTREAM2_LOG")&&pk.debug("invalid datachannel id: ".concat(n," !== ").concat(this.id)));let r=e.data.slice(this._dataStreamPacketHeader.byteLength);r=this._dataStreamPacketHandler.deserialize(r),this.emit(lP.MESSAGE,r)}}_updateOriginDataChannel(e){super._updateOriginDataChannel(e),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class eL extends QM{send(e){if(this._originDataChannel){let t=e;t=this._dataStreamPacketHandler.serialize(e);const n=new Uint8Array(this._dataStreamPacketHeader.byteLength+t.byteLength);n.set(new Uint8Array(this._dataStreamPacketHeader),0),n.set(new Uint8Array(t),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(n.buffer)}}}function tL(){const e=new Blob([atob("ZnVuY3Rpb24gZShlLHQsbil7bGV0IHI9bmV3IFVpbnQ4QXJyYXkoZSx0LG4pLGE9W10sbz0wO2Zvcig7YS5sZW5ndGg8bjspbyszPG4mJjA9PT1yW29dJiYwPT09cltvKzFdJiYzPT09cltvKzJdJiYoMD09PXJbbyszXXx8MT09PXJbbyszXXx8Mj09PXJbbyszXXx8Mz09PXJbbyszXSk/KGEucHVzaChyW29dLHJbbysxXSxyW28rM10pLG8rPTQpOihhLnB1c2gocltvXSksbysrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoYSl9ZnVuY3Rpb24gdChlLHQpe2NvbnN0IG49ZnVuY3Rpb24oZSl7Y29uc3QgdD1lLmxlbmd0aDtsZXQgbj1bXSxyPTA7Zm9yKDtyPHQ7KXIrMjx0JiYwPT09ZVtyXSYmMD09PWVbcisxXSYmKDA9PT1lW3IrMl18fDE9PT1lW3IrMl18fDI9PT1lW3IrMl18fDM9PT1lW3IrMl0pPyhuLnB1c2goZVtyXSxlW3IrMV0sMyxlW3IrMl0pLHIrPTMpOihuLnB1c2goZVtyXSkscisrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobil9KHQpLHI9bi5sZW5ndGgsYT1NYXRoLmZsb29yKHIvMjU1KSxvPXIlMjU1LHM9bmV3IFVpbnQ4QXJyYXkoNithKzErcitlLmJ5dGVMZW5ndGgpO3NbMF09MCxzWzFdPTAsc1syXT0wLHNbM109MSxzWzRdPTYsc1s1XT0xMDE7bGV0IGk9MDtmb3IoO2k8YTspc1s2K2ldPTI1NSxpKys7cmV0dXJuIHNbNitpXT1vLGkrKyxzLnNldChuLDYraSkscy5zZXQobmV3IFVpbnQ4QXJyYXkoZSksNitpK3IpLHMuYnVmZmVyfW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiU2FmYXJpIik+LTEmJi0xPT09bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJDaHJvbWUiKSYmKHNlbGYub25ydGN0cmFuc2Zvcm09bj0+e2NvbnN0IHI9bi50cmFuc2Zvcm1lcjtsZXQgYT1bXTtyLm9wdGlvbnMucG9ydC5vbm1lc3NhZ2U9ZT0+e2UuZGF0YS5zZWkmJmEucHVzaChlLmRhdGEuc2VpKX0sc2VsZi5wb3N0TWVzc2FnZSgic3RhcnRlZCIpO2NvbnN0IG89ci5yZWFkYWJsZS5nZXRSZWFkZXIoKSxzPXIud3JpdGFibGUuZ2V0V3JpdGVyKCk7InJ4Ij09PXIub3B0aW9ucy5uYW1lP2Z1bmN0aW9uIHQobil7by5yZWFkKCkudGhlbigocj0+e2lmKCFyLmRvbmUpe2lmKHIudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgdD1mdW5jdGlvbih0KXtjb25zdCBuPW5ldyBEYXRhVmlldyh0LmRhdGEpO2xldCByPTA7Zm9yKDtyKzQ8dC5kYXRhLmJ5dGVMZW5ndGg7KXtpZigwPT09bi5nZXRVaW50OChyKzApJiYwPT09bi5nZXRVaW50OChyKzEpJiYwPT09bi5nZXRVaW50OChyKzIpJiYxPT09bi5nZXRVaW50OChyKzMpJiY2PT09bi5nZXRVaW50OChyKzQpKXtsZXQgYT1yKzYsbz0wLHM9MDtmb3IoOzI1NT09PShzPW4uZ2V0VWludDgoYSsrKSk7KW8rPTI1NTtvKz1zO2NvbnN0IGk9ZSh0LmRhdGEsYSxvKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoaSl9cisrfXJldHVybiBudWxsfShyLnZhbHVlKTt0JiZuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7c2VpOnR9KX1zLndyaXRlKHIudmFsdWUpLG4ub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQobil9fSkpfShyKToidHgiPT09ci5vcHRpb25zLm5hbWUmJmZ1bmN0aW9uIGUobil7by5yZWFkKCkudGhlbigocj0+e2lmKCFyLmRvbmUpe2lmKHIudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgZT1hLnNoaWZ0KCk7ZSYmKHIudmFsdWUuZGF0YT10KHIudmFsdWUuZGF0YSxlKSl9cy53cml0ZShyLnZhbHVlKSxuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSxlKG4pfX0pKX0ocil9LHNlbGYucG9zdE1lc3NhZ2UoInJlZ2lzdGVyZWQiKSk7Cg==")],{type:"text/javascript"});return setTimeout((()=>qg.revokeObjectURL(e)),0),new Worker(qg.createObjectURL(e))}var nL=function(e){return e[e.AUDIO_LEVEL=1]="AUDIO_LEVEL",e[e.METADATA=2]="METADATA",e}(nL||{});function rL(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.getUint8(0);if(71!==n)return;const r=e.getUint16(1),o=3+r,i=new Uint8Array(e.byteLength-o);i.set(new Uint8Array(e.buffer,o,e.byteLength-o));const a={m:n,tlvLen:r,tlv:[],frame:i};let s=3;for(;s<o;){const n=e.getUint8(s),r=e.getUint16(s+1),o=3;if(n===nL.AUDIO_LEVEL){let i=e.getUint8(s+o);for(let t=1;t<r;t++)i=i<<8|e.getUint8(s+o+t);a.tlv.push({tag:n,length:r,value:t?127^i>>1:127&i})}else if(n===nL.METADATA){const t=new Uint8Array(r);for(let n=0;n<r;n++)t[n]=e.getUint8(s+o+n);a.tlv.push({tag:n,length:r,value:t})}s+=o+r}return a}const oL=new Map;async function iL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Sk().supportWebRTCEncodedTransform)return void pk.warning("browser not support audio encoded transform");if(oL.has(e))return;if(!e.track)return;const n={track:e.track};if(dI()){if(!e.createEncodedStreams)return void pk.warning("browser not support createEncodedStreams() API");let o=null;try{o=e.createEncodedStreams()}catch(e){return void pk.error("create audio-encoded-streams error",e&&e.message)}const i=new TransformStream({transform(o,i){n.controller||(n.controller=i),e.track&&e.track.id!==n.track.id&&(pk.debug("audio track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r));const a=t.metadata&&t.metadata();a?function(e,t){const{chunk:n,controller:r}=t;n.data=function(e,t,n){const r=n.byteLength,o=r+1+2,i=3+o,a=new ArrayBuffer(e.byteLength+i),s=new DataView(a);s.setUint8(0,71),s.setUint16(1,o),s.setUint8(3,t),s.setUint16(4,r);for(let l=0;l<r;l++)s.setUint8(6+l,n[l]);const c=new Uint8Array(s.buffer);return c.set(new Uint8Array(e),i),c.buffer}(n.data,nL.METADATA,e),r.enqueue(n)}(a,{sender:e,chunk:o,controller:i}):i.enqueue(o)}});o.readable.pipeThrough(i).pipeTo(o.writable)}else if(pI()){if("undefined"==typeof RTCRtpScriptTransform)return void pk.warning("browser not support RTCRtpScriptTransform");const t=tL(),o=new MessageChannel;await new ih((e=>t.onmessage=t=>{"registered"===t.data&&e(void 0)}));const i=new RTCRtpScriptTransform(t,{name:"tx",port:o.port2},[o.port2]);e.transform=i,await new ih((e=>t.onmessage=t=>{"started"===t.data&&e(void 0)})),o.port1.onmessage=t=>{var o;t.data.transformed&&e.track&&(null===(o=e.track)||void 0===o?void 0:o.id)!==n.track.id&&(pk.debug("audio track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r))},n.worker=t}function r(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",r)}const t=oL.get(e);if(t){oL.delete(e);try{var n,o;null===(n=t.controller)||void 0===n||n.terminate(),null===(o=t.worker)||void 0===o||o.terminate()}catch(e){pk.warning(e&&e.message)}}}oL.set(e,n),e.track.addEventListener("ended",r)}const aL=127,sL=1e-10,cL=139/13,lL=new Map;function uL(e,t,n){const r="".concat(e,"-").concat(t,"-").concat(n);let o=0;if(lL.has(r))o=lL.get(r);else{const i=.5;o=Math.log(function(e,t){const n=e-t;t<n&&(t=n);let r=1;for(let o=e,i=1;o>t;o--,i++)r=r*o/i;return r}(t,e))+e*Math.log(i)+(t-e)*Math.log(1-i)-Math.log(n)+n*e,lL.set(r,o)}return o<sL&&(o=sL),o}function dL(e,t,n){const r=t.length,o=e.length/r;let i=!1;for(let a=0,s=0;a<r;a++){let r=0;for(let t=s+o;s<t;s++)e[s]>n&&r++;t[a]!==r&&(t[a]=r,i=!0)}return i}window.cache=lL;let pL=0;class hL{constructor(e){dP(this,"id",void 0),dP(this,"immediates",[]),dP(this,"lastNonSilence",-1),dP(this,"immediateSpeechActivityScore",sL),dP(this,"lastLevelChangedTime",Date.now()),dP(this,"levels",[]),dP(this,"longs",[]),dP(this,"longSpeechActivityScore",sL),dP(this,"mediums",[]),dP(this,"mediumSpeechActivityScore",sL),dP(this,"minLevel",0),dP(this,"nextMinLevel",0),dP(this,"nextMinLevelWindowLength",0),dP(this,"energyScore",0),this.id=e||"".concat(pL++),this.immediates.length=50,this.mediums.length=10,this.longs.length=1,this.levels.length=this.immediates.length}computeImmediates(){const e=this.immediates,t=this.levels,n=this.minLevel+cL;let r=!1;for(let o=0;o<e.length;++o){let i=t[o];i<n&&(i=0);const a=Math.floor(i/cL);e[o]!==a&&(e[o]=a,r=!0)}return r}computeLongs(){return dL(this.mediums,this.longs,4)}computeMediums(){return dL(this.immediates,this.mediums,7)}evaluateImmediateSpeechActivityScore(){this.immediateSpeechActivityScore=uL(this.immediates[0],13,.78)}evaluateLongSpeechActivityScore(e){this.longSpeechActivityScore=uL(this.longs[0],10,47),this.longSpeechActivityScore>sL&&(this.lastNonSilence=e)}evaluateMediumSpeechActivityScore(){this.mediumSpeechActivityScore=uL(this.mediums[0],5,24)}evaluateSpeechActivityScores(e){this.computeImmediates()&&(this.evaluateImmediateSpeechActivityScore(),this.computeMediums()&&(this.evaluateMediumSpeechActivityScore(),this.computeLongs()&&this.evaluateLongSpeechActivityScore(e)))}getLastLevelChangedTime(){return this.lastLevelChangedTime}getLevels(){var e;return"[".concat(bo(e=[...this.levels]).call(e).join(),"]")}getSpeechActivityScore(e){switch(e){case 0:return this.immediateSpeechActivityScore;case 1:return this.mediumSpeechActivityScore;case 2:return this.longSpeechActivityScore;default:throw new Error("interval "+e)}}levelChanged(e,t){if(this.lastLevelChangedTime<=t){this.lastLevelChangedTime=t;let n=e;return e<0&&(n=0),e>aL&&(n=aL),this.levels.unshift(n),this.levels.length>this.immediates.length&&this.levels.pop(),this.updateMinLevel(n),n>=this.minLevel+cL?n:n/2}return-1}levelTimedOut(){this.levelChanged(0,this.lastLevelChangedTime)}updateMinLevel(e){if(0!==e){if(0===this.minLevel||this.minLevel>e)return this.minLevel=e,this.nextMinLevel=0,void(this.nextMinLevelWindowLength=0);if(0===this.nextMinLevel)return this.nextMinLevel=e,void(this.nextMinLevelWindowLength=1);if(this.nextMinLevel>e&&(this.nextMinLevel=e),this.nextMinLevelWindowLength++,this.nextMinLevelWindowLength>=750){let e=Math.sqrt(this.minLevel*this.nextMinLevel);e<0?e=0:e>aL&&(e=aL),this.minLevel=e,this.nextMinLevel=0,this.nextMinLevelWindowLength=0}}}}class fL{constructor(e){dP(this,"algorithm",void 0),this.algorithm=e}execute(){let e=!this.algorithm;if(!e)try{const t=this.algorithm.runInDecisionMaker(this);t<=0?e=!0:setTimeout(this.execute.bind(this),t)}catch(o){e=!0}e&&this.algorithm&&this.algorithm.decisionMakerExited(this)}}class mL{constructor(e,t,n){dP(this,"isDominant",void 0),dP(this,"energyRanking",void 0),dP(this,"energyScore",void 0),this.isDominant=e,this.energyRanking=t,this.energyScore=n}}class vL extends eA{constructor(e){super(),dP(this,"dominantId",null),dP(this,"lastDecisionTime",0),dP(this,"lastLevelChangedTime",0),dP(this,"lastLevelIdleTime",0),dP(this,"relativeSpeechActivities",[]),dP(this,"speakers",new Map),dP(this,"enableSilence",!1),dP(this,"timeoutToSilenceInterval",0),dP(this,"decisionMaker",null),dP(this,"loudest",[]),dP(this,"numLoudestToTrack",3),dP(this,"energyExpireTimeMs",250),dP(this,"energyAlphaPct",50),this.timeoutToSilenceInterval=e,this.enableSilence=e>0,this.relativeSpeechActivities.length=3}setLoudestConfig(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;this.numLoudestToTrack=e,null!=t&&(this.energyExpireTimeMs=t),null!=n&&(this.energyAlphaPct=n),this.loudest.length>e&&this.loudest.splice(e)}getDominantSpeaker(){return this.dominantId}isAmongLoudest(e){return this.loudest.some((t=>t.id===e))}levelChanged(e,t){const n=Date.now(),r=this.getOrCreateSpeaker(e);this.lastLevelChangedTime<n&&(this.lastLevelChangedTime=n,this.maybeStartDecisionMaker());const o=r.levelChanged(t,n);return this.updateLoudestList(r,o,n)}runInDecisionMaker(e){return this.decisionMaker!==e||this.lastDecisionTime>0&&this.lastDecisionTime-this.lastLevelChangedTime>=15e3?-1:this._runInDecisionMaker()}decisionMakerExited(e){this.decisionMaker===e&&(this.decisionMaker=null)}destroy(){this.decisionMaker=null,this.loudest.length=0,this.speakers.clear(),this.removeAllListeners()}addSpeakers(e){e.forEach((e=>{this.speakers.has(e.id)||this.speakers.set(e.id,e)}))}removeSpeakers(e){e.forEach((e=>{this.speakers.delete(e.id)}))}getOrCreateSpeaker(e){let t=this.speakers.get(e);return t||(t=new hL(e),this.speakers.set(e,t),this.maybeStartDecisionMaker()),t}updateLoudestList(e,t,n){const r=e.id===this.dominantId;if(t<0){let t=0;for(;t<this.loudest.length&&this.loudest[t]!==e;)++t;return new mL(r,t,e.energyScore)}if(e.energyScore=Math.floor((this.energyAlphaPct*t+(100-this.energyAlphaPct)*e.energyScore+50)/100),0===this.numLoudestToTrack)return new mL(r,0,e.energyScore);const o=n-this.energyExpireTimeMs;let i=0;for(;i<this.loudest.length;){const t=this.loudest[i];if(t.getLastLevelChangedTime()<o&&this.loudest.length>=this.numLoudestToTrack)this.loudest.splice(i,1);else if(t.id!==e.id)++i;else if(this.loudest.splice(i,1),this.loudest.length<this.numLoudestToTrack)break}let a=0;for(;a<this.loudest.length&&!(this.loudest[a].energyScore<e.energyScore);)++a;return a<this.numLoudestToTrack&&(this.loudest.splice(a,0,e),this.loudest.length>this.numLoudestToTrack&&this.loudest.splice(this.numLoudestToTrack,1)),new mL(r,a,e.energyScore)}maybeStartDecisionMaker(){!this.decisionMaker&&this.speakers.size>0&&(this.decisionMaker=new fL(this),this.decisionMaker.execute())}makeDecision(e){let t=null,n=null;const r=this.speakers.size;let o=null;if(0===r)o=null;else if(1===r){var i;const t=fh(i=this.speakers).call(i).next().value;this.enableSilence&&t&&(o=t.id,t.evaluateSpeechActivityScores(e),e-t.lastNonSilence>this.timeoutToSilenceInterval&&(o=null))}else{let t=null==this.dominantId?null:this.speakers.get(this.dominantId);if(null==t){const e=this.speakers.entries().next();e.value&&(o=e.value[0],t=e.value[1])}else o=t.id;null!=t&&t.evaluateSpeechActivityScores(e);const n=this.relativeSpeechActivities;let r=2;for(const i of this.speakers.entries()){const[a,s]=i;if(s===t)continue;s.evaluateSpeechActivityScores(e);for(let e=0;e<n.length;++e){const r=null==t?sL:t.getSpeechActivityScore(e);n[e]=Math.log(s.getSpeechActivityScore(e)/r)}const c=n[0],l=n[1],u=n[2];c>3&&l>2&&u>0&&l>r&&(r=l,o=a)}this.enableSilence&&null!=t&&o===t.id&&e-t.lastNonSilence>this.timeoutToSilenceInterval&&(o=null)}null==o&&!this.enableSilence||o===this.dominantId||(t=this.dominantId,this.dominantId=o,n=this.dominantId),null==n&&!this.enableSilence||n===t||this.emit("ActiveSpeakerChanged",n)}_runInDecisionMaker(){const e=Date.now(),t=300-(e-this.lastLevelIdleTime);let n=0;t<=0?(0!==this.lastLevelIdleTime&&this.timeoutIdleLevels(e),this.lastLevelIdleTime=e):n=t;let r=300-(e-this.lastDecisionTime);return r<=0&&(this.lastDecisionTime=e,this.makeDecision(e),r=300-(Date.now()-e)),r>0&&n>r&&(n=r),n}timeoutIdleLevels(e){const t=[];for(const r of fh(n=this.speakers).call(n)){var n;const o=e-r.getLastLevelChangedTime();36e5<o&&(null==this.dominantId||r.id!==this.dominantId)?t.push(r.id):300<o&&r.levelTimedOut()}t.forEach((e=>this.speakers.delete(e)))}}const gL=new Map;let EL=null,yL=null,_L=[];const bL=1e3/15,TL=new Map,SL=new Map;class OL{get samples(){return this.actives+this.inactives}get activeRate(){return this.actives/this.samples}constructor(e,t){dP(this,"id",void 0),dP(this,"track",void 0),dP(this,"score",0),dP(this,"active",!0),dP(this,"muted",!1),dP(this,"timer",0),dP(this,"actives",0),dP(this,"inactives",0),this.id=e,this.track=t,this.setActive(TL.size<3)}autoCheckActive(){this.autoSetActive(),this.autoAdjustActive(),this.resetTimer(),this.actives=0,this.inactives=0}autoSetActive(){const e=this.active;this.active=this.activeRate>=.8;const{actives:t,inactives:n}=function(){const e=[],t=[];return Array.from(fh(TL).call(TL)).forEach((n=>{n.active?e.push(n):t.push(n)})),{actives:e,inactives:t}}();if(t.length>3){let e;t.forEach((t=>{(!e||e.score>t.score)&&(e=t)})),e&&e.setActive(!1)}if(t.length<3&&n.length>0){let t;n.forEach((e=>{(!t||t.score<e.score)&&e.id!==this.id&&(t=e)})),t&&e&&!this.active&&(t.samples>40&&t.activeRate-this.activeRate>.4?t.setActive(!0):this.active=!0)}this.setMuted(!this.active)}setActive(e){this.active=e,this.resetTimer(),this.setMuted(!e)}autoAdjustActive(){this.active?this.autoSwitchToInactive():this.autoSwitchToActive()}autoSwitchToActive(){const e=function(e){let t;return Array.from(fh(TL).call(TL)).forEach((n=>{!n.active||n.id===e||n.samples<40||(!t||n.score<t.score)&&(t=n)})),t}(this.id);e&&this.activeRate-e.activeRate>.4&&(e.setActive(!1),this.setActive(!0))}autoSwitchToInactive(){const e=function(e){let t;return Array.from(fh(TL).call(TL)).forEach((n=>{n.active||n.id===e||n.samples<40||(!t||n.score>t.score)&&(t=n)})),t}(this.id);e&&e.activeRate-this.activeRate>.4&&(e.setActive(!0),this.setActive(!1))}addSample(e){e?this.actives+=1:this.inactives+=1,this.samples>bL&&this.autoCheckActive()}setMuted(e){this.track&&(this.track.enabled=!e,this.muted=e)}resetTimer(){this.clearTimer(),this.timer=window.setTimeout((()=>{if(0!==this.samples)return this.samples<50?this.resetTimer():void this.autoCheckActive()}),1e3)}clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=0)}}let RL;function CL(e){const t=TL.get(e);t&&(TL.delete(e),t.clearTimer())}const wL=new Map,IL=new Map;async function AL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Sk().supportWebRTCEncodedTransform)return void pk.warning("browser not support audio encoded transform");if(wL.has(e))return;const n={track:e.track};if(dI()){if(!e.createEncodedStreams)return void pk.warning("browser not support createEncodedStreams() API");EI(nI.CHROME,87,116)||(t.enableTopn=!1);let o=null;try{o=e.createEncodedStreams()}catch(e){return void pk.error("create audio-encoded-streams error",e&&e.message)}const i=new TransformStream({transform(o,i){n.controller||(n.controller=i),e.track&&e.track.id!==n.track.id&&(pk.debug("audio track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r)),t.enableTopn?function(e,t,n){var r;const o=rL(new DataView(t.data));if(!o)return n.enqueue(t);const i=e.track.id;IL.set(i,e.track);const a=null===(r=o.tlv.find((e=>e.tag===nL.AUDIO_LEVEL)))||void 0===r?void 0:r.value;let s=0;"number"==typeof a&&(s=127-a);const c=Math.round(Math.pow(10,s/60)-1),{selected:l,speaker:u}=function(e,t){let n=gL.get(e);if(n||(n=function(e){const t=new hL;return gL.set(e,t),EL||(EL=new vL(UN("TOPN_SILENCE_THRESHOLD")||500),EL.on("ActiveSpeakerChanged",(e=>{null!=e&&(yL=e)}))),EL.addSpeakers([t]),t}(e)),gL.size<=3)return{selected:!0,speaker:n};if(!EL)throw new Error("no active speaker detector");return EL.levelChanged(n.id,t),_L=EL.loudest.map((e=>e.id)),yL&&!Ur(_L).call(_L,yL)&&_L.length>=3&&_L.pop(),{selected:Ur(_L).call(_L,n.id)||n.id===yL,speaker:n}}(e,c),d=function(e,t,n){const r=TL.get(e)||new OL(e,t);return r.score=n,TL.set(e,r),function(e){if(SL.set(e,!0),!RL)return void(RL=Date.now());const t=Date.now();t-RL>1e3&&(SL.get(e)?SL.set(e,!1):(CL(e),SL.delete(e)),RL=t)}(e),r}(i,e.track,u.energyScore);d.addSample(l),d.active&&(t.data=o.frame.buffer,n.enqueue(t))}(e,o,i):t.enableMetadata?function(e,t,n){const r=rL(new DataView(e.data));if(!r)return t.enqueue(e);const o=r.tlv.find((e=>e.tag===nL.METADATA));o&&n&&o.value instanceof Uint8Array&&n(o.value),e.data=r.frame.buffer,t.enqueue(e)}(o,i,t.onMetadata):i.enqueue(o)}});o.readable.pipeThrough(i).pipeTo(o.writable)}else if(pI()){if("undefined"==typeof RTCRtpScriptTransform)return void pk.warning("browser not support RTCRtpScriptTransform");const t=tL(),o=new MessageChannel;await new ih((e=>t.onmessage=t=>{"registered"===t.data&&e(void 0)}));const i=new RTCRtpScriptTransform(t,{name:"rx",port:o.port2},[o.port2]);e.transform=i,await new ih((e=>t.onmessage=t=>{"started"===t.data&&e(void 0)})),o.port1.onmessage=t=>{var o;t.data.transformed&&e.track&&(null===(o=e.track)||void 0===o?void 0:o.id)!==n.track.id&&(pk.debug("audio track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r))},n.worker=t}function r(){e.track.removeEventListener("ended",r),function(e){const t=wL.get(e);if(t){!function(e){const t=gL.get(e);t&&(gL.delete(e),EL&&(EL.removeSpeakers([t]),0===gL.size&&(EL.destroy(),EL=null)))}(e),CL(e.track.id),wL.delete(e);try{var n,r;null===(n=t.controller)||void 0===n||n.terminate(),null===(r=t.worker)||void 0===r||r.terminate()}catch(e){pk.warning(e&&e.message)}}}(e)}wL.set(e,n),e.track.addEventListener("ended",r)}function NL(e,t,n){let r=new Uint8Array(e,t,n),o=[],i=0;for(;o.length<n;)i+3<n&&0===r[i]&&0===r[i+1]&&3===r[i+2]&&(0===r[i+3]||1===r[i+3]||2===r[i+3]||3===r[i+3])?(o.push(r[i],r[i+1],r[i+3]),i+=4):(o.push(r[i]),i++);return new Uint8Array(o)}const kL=new Map;async function PL(e,t){if(!Sk().supportWebRTCEncodedTransform)return void pk.warning("browser not support video encoded transform");if(kL.has(e))return;if(!e.track)return;const n={track:e.track};if(dI()){if(!e.createEncodedStreams)return void pk.warning("browser not support createEncodedStreams() API");let o=null;try{o=e.createEncodedStreams()}catch(e){return void pk.error("create video-encoded-streams error",e&&e.message)}const i=[];t.on("sei-to-send",(e=>{i.push(e)}));const a=new TransformStream({transform(t,o){n.controller||(n.controller=o),e.track&&e.track.id!==n.track.id&&(pk.debug("video track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r));const a=i.shift();a&&(t.data=function(e,t){const n=function(e){const t=e.length;let n=[],r=0;for(;r<t;)r+2<t&&0===e[r]&&0===e[r+1]&&(0===e[r+2]||1===e[r+2]||2===e[r+2]||3===e[r+2])?(n.push(e[r],e[r+1],3,e[r+2]),r+=3):(n.push(e[r]),r++);return new Uint8Array(n)}(t),r=n.length,o=Math.floor(r/255),i=r%255,a=new Uint8Array(6+o+1+r+e.byteLength);a[0]=0,a[1]=0,a[2]=0,a[3]=1,a[4]=6,a[5]=101;let s=0;for(;s<o;)a[6+s]=255,s++;return a[6+s]=i,s++,a.set(n,6+s),a.set(new Uint8Array(e),6+s+r),a.buffer}(t.data,a)),o.enqueue(t)}});o.readable.pipeThrough(a).pipeTo(o.writable)}else{if(!pI())return;{if("undefined"==typeof RTCRtpScriptTransform)return void pk.warning("browser not support RTCRtpScriptTransform");const o=tL(),i=new MessageChannel;await new ih((e=>o.onmessage=t=>{"registered"===t.data&&e(void 0)}));const a=new RTCRtpScriptTransform(o,{name:"tx",port:i.port2},[i.port2]);e.transform=a,await new ih((e=>o.onmessage=t=>{"started"===t.data&&e(void 0)})),t.on("sei-to-send",(e=>{i.port1.postMessage({sei:e})})),i.port1.onmessage=t=>{var o;t.data.transformed&&e.track&&(null===(o=e.track)||void 0===o?void 0:o.id)!==n.track.id&&(pk.debug("video track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r))},n.worker=o}}function r(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",r)}const t=kL.get(e);if(t){kL.delete(e);try{var n,o;null===(n=t.controller)||void 0===n||n.terminate(),null===(o=t.worker)||void 0===o||o.terminate()}catch(e){pk.warning(e&&e.message)}}}kL.set(e,n),e.track.addEventListener("ended",r)}const DL=new Map;async function ML(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Sk().supportWebRTCEncodedTransform)return void pk.warning("browser not support video encoded transform");if(!e.track)return;if(DL.has(e)){const n=DL.get(e);return void(n&&(n.onSei=t.onSei))}const n={track:e.track,onSei:t.onSei};if(dI()){if(!e.createEncodedStreams)return void pk.warning("browser not support createEncodedStreams() API");let t=null;try{t=e.createEncodedStreams()}catch(e){return void pk.error("create video-encoded-streams error",e&&e.message)}const o=new TransformStream({transform(t,o){n.controller||(n.controller=o),e.track&&e.track.id!==n.track.id&&(pk.debug("video track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r));const i=function(e){const t=new DataView(e.data);let n=0;for(;n+4<e.data.byteLength;){if(0===t.getUint8(n+0)&&0===t.getUint8(n+1)&&0===t.getUint8(n+2)&&1===t.getUint8(n+3)&&6===t.getUint8(n+4)){let r=n+6,o=0,i=0;for(;255===(i=t.getUint8(r++));)o+=255;o+=i;const a=NL(e.data,r,o);return new Uint8Array(a)}n++}return null}(t);i&&n.onSei&&n.onSei(i),o.enqueue(t)}});t.readable.pipeThrough(o).pipeTo(t.writable)}else if(pI()){if("undefined"==typeof RTCRtpScriptTransform)return void pk.warning("browser not support RTCRtpScriptTransform");const t=tL(),o=new MessageChannel;await new ih((e=>t.onmessage=t=>{"registered"===t.data&&e(void 0)}));const i=new RTCRtpScriptTransform(t,{name:"rx",port:o.port2},[o.port2]);e.transform=i,await new ih((e=>t.onmessage=t=>{"started"===t.data&&e(void 0)})),o.port1.onmessage=t=>{var o;t.data.transformed&&e.track&&(null===(o=e.track)||void 0===o?void 0:o.id)!==n.track.id?(pk.debug("video track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r)):t.data.sei&&n.onSei&&n.onSei(t.data.sei)},n.worker=t}function r(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",r)}!function(e){const t=DL.get(e);if(t){DL.delete(e);try{var n,r;null===(n=t.controller)||void 0===n||n.terminate(),null===(r=t.worker)||void 0===r||r.terminate()}catch(e){pk.warning(e&&e.message)}}}(e)}DL.set(e,n),e.track.addEventListener("ended",r)}!function(){const e=aI();Tk.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),Tk.getStreamFromExtension=e.name===nI.CHROME&&Number(e.version)>34,Tk.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver)return!1;if(!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const e=new RTCPeerConnection;let t=!1;try{e.addTransceiver("audio"),t=!0}catch(e){}return e.close(),t}(),Tk.supportMinBitrate=e.name===nI.CHROME||e.name===nI.EDGE,Tk.supportSetRtpSenderParameters=function(){const e=aI();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!PI()||!(!pI()&&!uI())||e.name===nI.FIREFOX&&Number(e.version)>=64)}(),e.name===nI.SAFARI&&(Number(e.version)>=14?Tk.supportDualStream=!0:Tk.supportDualStream=!1),Tk.webAudioMediaStreamDest=function(){const e=aI();return!(e.name===nI.SAFARI&&Number(e.version)<12)}(),Tk.supportReplaceTrack=!!window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack,Tk.supportWebGL="undefined"!=typeof WebGLRenderingContext,Tk.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,PI()||(Tk.webAudioWithAEC=!0),Tk.supportShareAudio=function(){const e=aI();return(e.os===tI.WIN_10||e.os===tI.WIN_81||e.os===tI.WIN_7||e.os===tI.LINUX||e.os===tI.MAC_OS||e.os===tI.CHROMIUM_OS)&&e.name===nI.CHROME&&Number(e.version)>=74}(),Tk.supportDataChannel=!!(vI(76)||function(e){const t=aI();return!(t.name!==nI.FIREFOX||!t.osVersion)&&Number(t.version)>=e}(68)||_I(14)),Tk.supportPCSetConfiguration=function(){const e=window.RTCPeerConnection;return!fI()&&!!e&&e.prototype.setConfiguration instanceof Function}(),Tk.supportWebRTCEncodedTransform=function(){const e=aI();return"Chrome"===e.name&&Number(e.version)>=87||"Safari"===e.name&&Number(e.version)>=15}(),Tk.supportWebRTCInsertableStream=function(){const e=aI();return(e.name===nI.CHROME||e.name===nI.EDGE)&&Number(e.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),Tk.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,Tk.supportWebCrypto="undefined"!=typeof window&&void 0!==window.crypto&&void 0!==window.crypto.subtle,TA((()=>{Tk.supportDualStreamEncoding=function(){const e=aI();return!!UN("DISABLE_WEBAUDIO")||"Safari"===e.name&&Number(e.version)>=14||!!("Chrome"===e.name&&/Windows/i.test(e.os||"")&&Number(e.version)>=100&&UN("CHROME_DUAL_STREAM_USE_ENCODING"))}(),pk.debug("browser ua: ",navigator.userAgent),pk.info("browser info: ",e),pk.info("browser compatibility: ",Tk)}))}();const LL=["CHINA","GLOBAL"],xL=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],UL=[],jL=[];function FL(e,t){return!!t&&UL.some((n=>n.uid===e&&n.channelName===t))}function BL(){return jL.length>0}var VL=BT.forEach,HL=Yr("forEach")?[].forEach:function(e){return VL(this,e,arguments.length>1?arguments[1]:void 0)};Mn({target:"Array",proto:!0,forced:[].forEach!==HL},{forEach:HL});var GL=rr("Array","forEach"),WL=yr,qL=rt,KL=h,YL=GL,zL=Array.prototype,XL={DOMTokenList:!0,NodeList:!0},JL=function(e){var t=e.forEach;return e===zL||KL(zL,e)&&t===zL.forEach||qL(XL,WL(e))?YL:t},ZL=i(JL),QL=et,$L=vi;Mn({target:"Object",stat:!0,forced:a((function(){$L(1)}))},{keys:function(e){return $L(QL(e))}});var ex=i(ne.Object.keys),tx=i(ao),nx=i(_o),rx=Mn,ox=lo,ix=el,ax=te,sx=Gn,cx=zn,lx=$,ux=gm,dx=gt,px=ll,hx=eT("slice"),fx=dx("species"),mx=Array,vx=Math.max;rx({target:"Array",proto:!0,forced:!hx},{slice:function(e,t){var n,r,o,i=lx(this),a=cx(i),s=sx(e,a),c=sx(void 0===t?a:t,a);if(ox(i)&&(n=i.constructor,(ix(n)&&(n===mx||ox(n.prototype))||ax(n)&&null===(n=n[fx]))&&(n=void 0),n===mx||void 0===n))return px(i,s,c);for(r=new(void 0===n?mx:n)(vx(c-s,0)),o=0;s<c;s++,o++)s in i&&ux(r,o,i[s]);return r.length=o,r}});var gx=rr("Array","slice"),Ex=h,yx=gx,_x=Array.prototype,bx=function(e){var t=e.slice;return e===_x||Ex(_x,e)&&t===_x.slice?yx:t},Tx=i(bx);function Sx(e,t,n,r,o){var i,a,s,c={};return ZL(i=ex(r)).call(i,(function(e){c[e]=r[e]})),c.enumerable=!!c.enumerable,c.configurable=!!c.configurable,("value"in c||c.initializer)&&(c.writable=!0),c=tx(a=nx(s=Tx(n).call(n)).call(s)).call(a,(function(n,r){return r(e,t,n)||n}),c),o&&void 0!==c.initializer&&(c.value=c.initializer?c.initializer.call(o):void 0,c.initializer=void 0),void 0===c.initializer&&(Hb(e,t,c),c=null),c}let Ox=function(e){return e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",e}({}),Rx=function(e){return e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR",e}({}),Cx=function(e){return e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",e}({}),wx=function(e){return e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",e[e.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",e}({}),Ix=function(e){return e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.DATASTREAM2_NOT_AVAILABLE=27]="DATASTREAM2_NOT_AVAILABLE",e[e.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",e[e.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",e[e.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",e[e.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",e[e.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",e[e.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",e[e.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",e[e.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",e}({}),Ax=function(e){return e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed",e}({}),Nx=function(e){return e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.ABORT_P2P_EXECUTION="abort_p2p_execution",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success",e.JOIN_RESPONSE="join_response",e.PRE_CONNECT_PC="pre_connect_pc",e.P2P_CONNECTION="p2p_connection",e.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",e.P2P_SUBSCRIBE="p2p_subscribe",e.P2P_UNSUBSCRIBE="p2p_unsubscribe",e.P2P_EXCHANGE_SDP="p2p_exchange_sdp",e.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",e.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",e.RECOVER_NOTIFICATION="recover_notification",e}({}),kx=function(e){return e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v3",e.REJOIN="rejoin_v3",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.PUBLISH_DATASTREAM="publish_datastream",e.UNPUBLISH="unpublish",e.UNPUBLISH_DATASTREAM="unpublish_datastream",e.SUBSCRIBE="subscribe",e.PRE_SUBSCRIBE="pre_subscribe",e.SUBSCRIBE_DATASTREAM="subscribe_datastream",e.SUBSCRIBE_STREAMS="subscribe_streams",e.UNSUBSCRIBE="unsubscribe",e.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",e.UNSUBSCRIBE_STREAMS="unsubscribe_streams",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.DEFAULT_VIDEO_STREAM="default_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer",e.RESTART_ICE="restart_ice",e.CONNECT_PC="connect_pc",e.SET_VIDEO_PROFILE="set_video_profile",e.SET_PARAMETER="set_parameter",e.SET_RTM2_FLAG="set_rtm2_flag",e}({}),Px=function(e){return e.WRTC_STATS="wrtc_stats",e.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",e.DENOISER_STATS="denoiser_stats",e.EXTENSION_USAGE_STATS="extension_usage_stats",e}({}),Dx=function(e){return e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_USER_LICENSE_BANNED="on_user_license_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.ON_P2P_OK="on_p2p_ok",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",e.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",e.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio",e.ON_PUBLISHED_USER_LIST="on_published_user_list",e}({}),Mx=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({}),Lx=function(e){return e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls",e.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",e}({});function xx(e){if("string"!=typeof e||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e))throw pk.error("Invalid Channel Name ".concat(e)),new bk(jI.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function Ux(e){if(!("number"==typeof(t=e)&&Math.floor(t)===t&&0<=t&&t<=4294967295||YI(e,1,255)))throw new bk(jI.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var t;"string"==typeof e&&pk.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}let jx=function(e){return e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e}({});const Fx={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},Bx={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function Vx(e,t){WI(e.url,"".concat(t,".url"),1,1e3,!1),KI(e.x)||HI(e.x,"".concat(t,".x"),0,1e4),KI(e.y)||HI(e.y,"".concat(t,".y"),0,1e4),KI(e.width)||HI(e.width,"".concat(t,".width"),0,1e4),KI(e.height)||HI(e.height,"".concat(t,".height"),0,1e4),KI(e.zOrder)||HI(e.zOrder,"".concat(t,".zOrder"),0,255),KI(e.alpha)||HI(e.alpha,"".concat(t,".alpha"),0,1,!1)}const Hx={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""};let Gx=function(e){return e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address",e}({}),Wx=function(e){return e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",e}({}),qx=function(e){return e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",e}({});function Kx(e){if(!e.channelName)throw new bk(jI.INVALID_PARAMS,"invalid channelName in info");if("number"!=typeof e.uid)throw new bk(jI.INVALID_PARAMS,"invalid uid in info, uid must be a number");return e.token&&WI(e.token,"info.token",1,2047),Ux(e.uid),xx(e.channelName),!0}let Yx=function(e){return e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile",e}({}),zx=function(e){return e.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",e.NETWORK_CONNECTED="NETWORK_CONNECTED",e.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",e.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",e.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",e.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",e.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",e.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",e.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",e}({}),Xx=function(e){return e.RELAY_STATE_IDLE="RELAY_STATE_IDLE",e.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",e.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",e.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",e}({}),Jx=function(e){return e.RELAY_OK="RELAY_OK",e.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",e.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",e.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",e}({}),Zx=function(e){return e.High="high",e.Low="low",e.Audio="audio",e.Screen="screen",e.ScreenLow="screen_low",e}({}),Qx=function(e){return e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid",e.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",e.JOIN_RESPONSE="join-response",e.RESET_CONNECTION_EVENTS="reset-connection-events",e.PRE_CONNECT_PC="pre-connect_pc",e.UPDATE_GATEWAY_CONFIG="update-gateway-config",e}({}),$x=function(e){return e.P2P_DISCONNECTED="P2P_DISCONNECTED",e.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",e.TIMEOUT="TIMEOUT",e.UNKNOWN_REASON="UNKNOWN_REASON",e}({}),eU=function(e){return e[e.Nothing=0]="Nothing",e[e.Audio=1]="Audio",e[e.LwoVideo=2]="LwoVideo",e[e.Video=4]="Video",e[e.Data=8]="Data",e[e.DataStream0=256]="DataStream0",e[e.DataStream1=512]="DataStream1",e[e.DataStream2=1024]="DataStream2",e[e.DataStream3=2048]="DataStream3",e[e.DataStream4=4096]="DataStream4",e[e.DataStream5=8192]="DataStream5",e[e.DataStream6=16384]="DataStream6",e[e.DataStream7=32768]="DataStream7",e}({}),tU=function(e){return e.CHINA="CHINA",e.ASIA="ASIA",e.NORTH_AMERICA="NORTH_AMERICA",e.EUROPE="EUROPE",e.JAPAN="JAPAN",e.INDIA="INDIA",e.KOREA="KOREA",e.HKMC="HKMC",e.US="US",e.OCEANIA="OCEANIA",e.SOUTH_AMERICA="SOUTH_AMERICA",e.AFRICA="AFRICA",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="EXTENSIONS",e}({});const nU=[tU.AFRICA,tU.ASIA,tU.CHINA,tU.EUROPE,tU.GLOBAL,tU.INDIA,tU.JAPAN,tU.NORTH_AMERICA,tU.OCEANIA,tU.OVERSEA,tU.SOUTH_AMERICA];let rU=function(e){return e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.KOREA="KR",e.HKMC="HK",e.US="US",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="GLOBAL",e}({});const oU={CHINA:{},ASIA:{CODE:rU.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:rU.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:rU.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:rU.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:rU.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:rU.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:rU.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:rU.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:rU.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:rU.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:rU.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:rU.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:rU.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};IN&&(oU.CHINA={CODE:rU.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});let iU=function(e){return e.UPDATE_BITRATE_LIMIT="update_bitrate_limit",e.UPDATE_CLIENT_ROLE_OPTIONS="update_client_role_options",e}({});function aU(e){return!!e&&!(!e.uplink||!e.id)&&void 0!==e.uplink.max_bitrate&&void 0!==e.uplink.min_bitrate}class sU extends eA{constructor(e,t){super(),OR(this,"onICEConnectionStateChange",void 0),OR(this,"onConnectionStateChange",void 0),OR(this,"onDTLSTransportStateChange",void 0),OR(this,"onDTLSTransportError",void 0),OR(this,"onICETransportStateChange",void 0),OR(this,"onFirstAudioReceived",void 0),OR(this,"onFirstVideoReceived",void 0),OR(this,"onFirstAudioDecoded",void 0),OR(this,"onFirstVideoDecoded",void 0),OR(this,"onFirstVideoDecodedTimeout",void 0),OR(this,"onSelectedLocalCandidateChanged",void 0),OR(this,"onSelectedRemoteCandidateChanged",void 0),OR(this,"onICECandidateError",void 0),OR(this,"getLocalVideoStats",void 0)}}class cU extends sU{constructor(e,t){super(e,t),OR(this,"establishPromise",void 0)}}let lU=function(e){return e.VIDEO="video",e.AUDIO="audio",e}({}),uU=function(e){return e.UDP_RELAY="udp_relay",e.UDP_TCP_RELAY="udp_tcp_relay",e.TCP_RELAY="tcp_relay",e.RELAY="relay",e}({}),dU=function(e){return e[e.FIRST_CONNECTION=0]="FIRST_CONNECTION",e[e.UDP_TCP_RESTART=1]="UDP_TCP_RESTART",e[e.RELAY_RESTART=2]="RELAY_RESTART",e[e.TCP_RESTART=3]="TCP_RESTART",e[e.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",e[e.OLD_RESTART=11]="OLD_RESTART",e[e.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",e}({});const pU=["disconnected","failed"];let hU=function(e){return e.LocalVideoTrack="videoTrack",e.LocalAudioTrack="audioTrack",e.LocalVideoLowTrack="videoLowTrack",e}({}),fU=function(e){return e.New="new",e.Connected="connected",e.Reconnecting="reconnecting",e.Disconnected="disconnected",e}({}),mU=function(e){return e.AudioMetadata="audioMetadata",e.StateChange="stateChange",e.IceConnectionStateChange="iceConnectionStateChange",e.RequestMuteLocal="requestMuteLocal",e.RequestUnmuteLocal="requestUnmuteLocal",e.RequestRePublish="requestRePublish",e.RequestRePublishDataChannel="requestRePublishDataChannel",e.RequestReSubscribe="requestReSubscribe",e.RequestUploadStats="requestUploadStats",e.RequestUpload="requestUpload",e.MediaReconnectStart="MediaReconnectStart",e.MediaReconnectEnd="MediaReconnectEnd",e.NeedSignalRTT="NeedSignalRTT",e.RequestRestartICE="RequestRestartIce",e.PeerConnectionStateChange="PeerConnectionStateChange",e.RequestReconnect="RequestReconnect",e.RequestReconnectPC="RequestReconnectPC",e.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",e.P2PLost="P2PLost",e.UpdateVideoEncoder="UpdateVideoEncoder",e.ConnectionTypeChange="ConnectionTypeChange",e.RequestLowStreamParameter="RequestLowStreamParameter",e.QueryClientConnectionState="QueryClientConnectionState",e.LocalCandidate="LocalCandidate",e.RequestP2PMuteLocal="requestP2PMuteLocal",e.RequestP2PUnPublish="RequestP2PUnPublish",e.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",e.RequestP2PMuteRemote="RequestP2PMuteRemote",e.RequestP2PRestartICE="RequestP2PRestartICE",e}({}),vU=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),gU=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),EU=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),yU=function(e){return e.CONNECTED="transmitter:connected",e.RECONNECTING="transmitter:reconnecting",e.WILL_RECONNECT="transmitter:will_reconnect",e.CLOSED="transmitter:closed",e.FAILED="transmitter:failed",e.ON_MESSAGE="transmitter:on_message",e.REQUEST_NEW_URLS="transmitter:request_new_urls",e.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",e.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",e.FAILBACK="transmitter:failback",e.PRE_CONNECT_PC="transmitter:pre_connect_pc",e}({}),_U=function(e){return e.CAMERA_CHANGED="camera-changed",e.MICROPHONE_CHANGED="microphone-changed",e.PLAYBACK_DEVICE_CHANGED="playback-device-changed",e.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",e.AUTOPLAY_FAILED="autoplay-failed",e.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",e.SECURITY_POLICY_VIOLATION="security-policy-violation",e}({}),bU=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),TU=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),SU=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),OU=function(e){return e.CALL="call",e.CANDIDATE="candidate",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.CONTROL="control",e.RESTART_ICE="restart_ice",e.ACK="ack",e.RESPONSE="response",e.JOIN="join",e.CHECK="check",e}({}),RU=function(e){return e.ABORT="abort",e}({}),CU=function(e){return e.MUTE_LOCAL_AUDIO="mute_local_audio",e.MUTE_LOCAL_VIDEO="mute_local_video",e.UNMUTE_LOCAL_AUDIO="unmute_local_audio",e.UNMUTE_LOCAL_VIDEO="unmute_local_video",e}({}),wU=function(e){return e.P2P_TOKEN_TIMEOUT="p2p_token_timeout",e.P2P_TOKEN_CHANGED="p2p_token_changed",e}({});const IU={[Ox.ACCESS_POINT]:{[wx.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[wx.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[wx.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[wx.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[wx.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[wx.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[wx.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[wx.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[wx.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[wx.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[wx.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[wx.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[wx.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[wx.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[wx.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[wx.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[wx.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[wx.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[Ox.UNILBS]:{[Cx.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[Cx.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[Cx.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[Cx.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[Cx.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[Cx.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[Cx.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[Cx.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[Cx.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[Cx.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[Cx.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[Cx.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[Ox.STRING_UID_ALLOCATOR]:{[Rx.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[Rx.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[Rx.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function AU(e){const t=IU[Math.floor(e/1e4)];if(!t)return{desc:"unknown error",retry:!1};const n=t[e%1e4];if(!n){if(Math.floor(e/1e4)===Ox.ACCESS_POINT){const t=e%1e4;if("1"===t.toString()[0])return{desc:e.toString(),retry:!1};if("2"===t.toString()[0])return{desc:e.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return n}const NU={[Ix.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[Ix.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[Ix.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[Ix.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[Ix.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[Ix.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[Ix.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[Ix.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[Ix.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[Ix.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[Ix.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[Ix.DATASTREAM2_NOT_AVAILABLE]:{desc:"DATASTREAM2_NOT_AVAILABLE",action:"quit"},[Ix.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[Ix.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[Ix.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[Ix.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[Ix.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[Ix.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[Ix.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[Ix.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[Ix.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[Ix.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[Ix.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[Ix.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[Ix.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[Ix.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[Ix.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[Ix.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[Ix.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[Ix.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[Ix.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[Ix.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[Ix.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[Ix.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[Ix.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[Ix.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[Ix.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[Ix.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[Ix.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[Ix.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[Ix.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[Ix.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Ix.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Ix.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[Ix.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[Ix.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[Ix.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[Ix.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[Ix.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[Ix.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[Ix.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[Ix.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[Ix.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[Ix.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[Ix.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[Ix.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[Ix.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[Ix.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[Ix.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[Ix.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[Ix.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[Ix.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[Ix.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[Ix.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function kU(e){return NU[e]||{desc:"UNKNOWN_ERROR_".concat(e),action:"failed"}}function PU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function DU(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?PU(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PU(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function MU(e,t){if("string"==typeof e)return e;const{proxy:n,host:r,port:o}=e;if(t){const e=UN("JOIN_GATEWAY_FALLBACK_PORT")||443;return 443===e?"wss://".concat(r,"/ws/?p=").concat(Number(o)+150):"wss://".concat(r,":").concat(e,"/ws/?p=").concat(Number(o)+150)}return n?"wss://".concat(n,"/ws/?h=").concat(r,"&p=").concat(o):"wss://".concat(r,":").concat(o)}const LU=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,xU=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,UU=/wss:\/\/(.+):([0-9]+)\/?/,jU=/wss:\/\/(.[^\/]+)\/?/;let FU=0;class BU{constructor(e,t){OR(this,"id",0),OR(this,"store",void 0),OR(this,"recordIndex",void 0),OR(this,"websockets",[]),OR(this,"try443PortDuration",2e3),OR(this,"forceCloseWSDuration",5e3),OR(this,"try443PortTimeout",null),OR(this,"forceCloseTimeout",null),OR(this,"isTry443PortFailed",!1),OR(this,"isNormalPortFailed",!1),OR(this,"useDoubleDomain",!1),OR(this,"useProxy",!1),OR(this,"startTime",Date.now()),this.id=++FU,this.try443PortDuration=UN("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=e||5e3,this.store=t}closeAllWebsockets(){this.websockets.forEach((e=>{e.onopen=null,e.onclose=null,e.onmessage=null,e.close()})),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout),this.forceCloseTimeout=null,this.try443PortTimeout=null}logger(){var e;const t=Date.now()-this.startTime;for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];pk.debug("[choose-best-ws ".concat(null===(e=this.store)||void 0===e?void 0:e.clientId," ").concat(this.id,"] ").concat(t,"ms:"),...r)}createWebSocket(e,t,n){this.logger("createWebSocket:",e,{isTry443Port:t,hasTimeoutDetection:n});const r=UN("GATEWAY_DOMAINS"),o=Date.now(),i=[],a=r.find((t=>{var n;return Ur(n=e.host).call(n,t)}));a||(this.useDoubleDomain=!1);const s=[];if(this.useDoubleDomain)r.forEach((n=>{s.push(MU(DU(DU({},e),{},{host:e.host.replace(a,n)}),t))}));else{const n=DU({},e);if(t&&a){const e=r.find((e=>e!==a));e&&(n.host=n.host.replace(a,e))}s.push(MU(n,t))}try{s.forEach((e=>{const t=new WebSocket(e);t.binaryType="arraybuffer",i.push(t),this.logger("ws is connecting:",t.url)}))}catch(r){if(this.logger("ws create failed"),i.forEach((e=>e.close())),i.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(e,t,n);if(!t&&443!==Number(e.port))return this.createWebSocket(e,!0,n);throw new bk(jI.WS_ERR,"init websocket failed! Error: ".concat(r.toString()))}const c=Zw();this.store&&this.store.recordJoinChannelService({urls:i.map((e=>e.url)),service:"gateway"},this.recordIndex),i.forEach((e=>{e.onopen=()=>{this.logger("onopen: ws ".concat(e.url," open cost ").concat(Date.now()-o,"ms")),this.websockets.forEach((t=>{t!==e&&(t.onopen=null,t.onclose=null,t.onmessage=null,t.close(),this.logger("close backup websocket: ".concat(t.url)))})),this.websockets.length=0,c.resolve(e)},e.onclose=n=>{this.logger("onclose: ws ".concat(e.url," closed cost ").concat(Date.now()-o,"ms state: ").concat(e.readyState));const r=i.every((e=>e.readyState===WebSocket.CLOSED||e.readyState===WebSocket.CLOSING));this.logger("".concat(t?"443":"47xx"," websocket closed, all failed: ").concat(r)),r&&(t||this.isTry443PortFailed||this.useProxy)?(this.logger("onclose: all websocket is closed, ".concat(n.reason)),c.reject({code:n.code,reason:$x.A_ROUND_WS_FAILED})):!t&&r&&!this.isNormalPortFailed&&this.try443PortTimeout&&(this.logger("all 47xx websocket is closed, try 443 port"),this.clearTimeout(),u()),t?this.isTry443PortFailed=r:this.isNormalPortFailed=r},e.onmessage=t=>this.logger("".concat(e.url," onmessage: ").concat(t.data))})),this.websockets.push(...i);const l=()=>{this.websockets.forEach((e=>e.readyState!==WebSocket.OPEN&&e.close()))},u=()=>{if(c.isResolved)return l();aI().os===tI.MAC_OS&&fI()&&l(),this.createWebSocket(e,!0,!0).then((e=>{c.resolve(e)})).catch((e=>{this.isNormalPortFailed&&c.reject(e),this.logger("try 443 port to create ws failed")})),this.forceCloseTimeout=window.setTimeout((()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",c.isResolved),this.forceCloseTimeout=null,l()}),this.forceCloseWSDuration)};return n||(()=>{if(t||this.useProxy)return this.logger("add 5s timeout at ".concat(t?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout((()=>{this.forceCloseTimeout=null,l()}),this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout((()=>{this.logger("2s timeout, isWebsocket created: ",c.isResolved),this.try443PortTimeout=null,u()}),this.try443PortDuration)})(),c.promise}chooseBestWebsocket(e,t,n,r){return this.useDoubleDomain=!!t,"string"==typeof e&&(e=function(e){let t,n,r;return[,t,n,r]=e.match(LU)||[],t||([,n,r]=e.match(xU)||[]),n&&r||([,n,r]=e.match(UU)||[]),n&&r||([,n]=e.match(jU)||[]),n||pk.warning("un-destructible url: ",e),{proxy:t,host:n,port:r||"443"}}(e)),this.recordIndex=r,this.useProxy=!!e.proxy,n&&this.useProxy&&(pk.warn("cannot use 443 only when use proxy"),n=!1),this.createWebSocket(e,!!n,!1).finally((()=>this.clearTimeout()))}}function VU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}class HU extends eA{get url(){return this.websocket&&this.websocket.url||null}get reconnectMode(){return this._reconnectMode}set reconnectMode(e){var t;Ur(t=["tryNext","recover"]).call(t,e)&&this.resetReconnectCount(e),this._reconnectMode=e}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,"reconnecting"===this._state?this.emit(Lx.RECONNECTING,this.reconnectReason):"connected"===this._state?this.emit(Lx.CONNECTED):"closed"===this._state?this.emit(Lx.CLOSED):"failed"===this._state&&this.emit(Lx.FAILED))}resetReconnectCount(e){pk.debug("websocket reset reconnect count, reason: "+e),this.reconnectCount=0}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5?arguments[5]:void 0;super(),OR(this,"connectionID",0),OR(this,"currentURLIndex",0),OR(this,"urls",[]),OR(this,"_reconnectMode","tryNext"),OR(this,"reconnectReason",void 0),OR(this,"_initMutex",void 0),OR(this,"name",void 0),OR(this,"_state","closed"),OR(this,"reconnectInterrupter",void 0),OR(this,"websocket",void 0),OR(this,"retryConfig",void 0),OR(this,"reconnectCount",0),OR(this,"forceCloseTimeout",5e3),OR(this,"onlineReconnectListener",void 0),OR(this,"useCompress",void 0),OR(this,"tryDoubleDomain",!1),OR(this,"use443PortOnly",!1),OR(this,"wsInflateLength",0),OR(this,"wsDeflateLength",0),OR(this,"closeEstablishingWs",(()=>{})),OR(this,"store",void 0),OR(this,"joinGatewayRecordIndex",void 0),this.store=i,this.name=e,this.retryConfig=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?VU(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VU(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t),this.useCompress=n,this.tryDoubleDomain=r,this.use443PortOnly=o,this._initMutex=new YA("websocket",i?i.clientId:void 0);const{timeout:a,timeoutFactor:s}=t,c=Math.max(300,Math.floor(3*a/5)),l=Math.max(1.2,Math.floor(8*s)/10);hA.ONLINE&&(this.retryConfig.timeout=c,this.retryConfig.timeoutFactor=l),yA.on(fA.NETWORK_STATE_CHANGE,((e,t)=>{e!==t&&(this.resetReconnectCount("network state change: ".concat(t," -> ").concat(e)),e===hA.ONLINE?(this.retryConfig.timeout=c,this.retryConfig.timeoutFactor=l):(this.retryConfig.timeout=a,this.retryConfig.timeoutFactor=s))}))}getConnection(){return this.websocket||void 0}async init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const n=await this._initMutex.lock();this._reconnectMode="tryNext",this.forceCloseTimeout=t,this.urls=e,this.state="connecting";try{const e=Zw(),t=this.urls[this.currentURLIndex];UN("ENABLE_PREALLOC_PC")&&this.emit(yU.PRE_CONNECT_PC),this.createWebSocketConnection(t).then(e.resolve).catch(e.reject),this.once(Lx.CLOSED,(()=>{e.reject(new FI(jI.WS_DISCONNECT))})),this.once(Lx.CONNECTED,e.resolve),await e.promise}catch(e){}finally{n()}}close(e,t){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const e=this.websocket;t?setTimeout((()=>e.close()),500):e.close(),this.websocket=void 0}this.state=e?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(e,t){if(!this.websocket)return void pk.warning("[".concat(this.name,"] can not reconnect, no websocket"));void 0!==e&&(this.reconnectMode=e),pk.debug("[".concat(this.name,"] reconnect is triggered initiative")),"number"==typeof this.joinGatewayRecordIndex&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(t)]},this.joinGatewayRecordIndex);const n=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),n&&n.bind(this.websocket)({code:9999,reason:t})}sendMessage(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new FI(jI.WS_ABORT,"websocket is not ready");try{t||(e=JSON.stringify(e)),this.websocket.send(e)}catch(e){throw new FI(jI.WS_ERR,"send websocket message error"+e.toString())}}setWsInflateData(e){this.wsDeflateLength=this.wsDeflateLength+e.originLength,this.wsInflateLength=this.wsInflateLength+e.compressedLength}getWsInflateData(){const e=this.wsInflateLength,t=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:e,wsDeflateLength:t}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(e){var t;const n=Zw();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const r=e=>{var t;null===(t=this.store)||void 0===t||t.signalChannelOpen(),pk.debug("[".concat(this.name,"] websocket opened:"),e),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),n.resolve()},o=async e=>{var t;if(pk.debug("[".concat(this.name,"] websocket close ").concat(null===(t=this.websocket)||void 0===t?void 0:t.url,", code: ").concat(e.code,", reason: ").concat(e.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)n.reject(new FI(jI.WS_DISCONNECT,"websocket close: ".concat(e.code))),this.close();else{"connected"===this.state&&(this.reconnectReason=e.reason,this.state="reconnecting");const t=gA(this,Lx.WILL_RECONNECT,this.reconnectMode,e.reason)||this.reconnectMode,r=await this.reconnectWithAction(t);if("closed"===this.state)return void pk.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!r)return n.reject(new FI(jI.WS_DISCONNECT,"websocket reconnect failed: ".concat(e.code))),this.close(!0);n.resolve()}},i=e=>{this.emit(Lx.ON_MESSAGE,e)},a=e=>{pk.warn("[".concat(this.connectionID,"] ws open error ").concat(e))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),UN("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(e=UN("GATEWAY_WSS_ADDRESS")),pk.debug("[".concat(this.name,"] start connect, url:"),e);const s=null===(t=this.store)||void 0===t?void 0:t.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var c;const t=await this.chooseBestWebsocketConnection(e);this.websocket=t,r&&r(this.websocket.url),this.websocket.onclose=o,this.websocket.onmessage=i,this.websocket.onerror=a,null===(c=this.store)||void 0===c||c.recordJoinChannelService({endTs:Date.now(),status:"success"},s),this.joinGatewayRecordIndex=s}catch(e){const t="closed"===this.state,r=e instanceof FI,i=r&&e.code===jI.WS_ABORT,a=r&&e.code===jI.WS_ERR,c=r?e.message:e&&(e.reason||e.toString());pk.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(c)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:i?"aborted":"error",errors:[e]},s),t||a?(n.reject(t?new FI(jI.WS_DISCONNECT,"websocket is closed: ".concat(c)):new FI(jI.WS_ERR,"init websocket failed: ".concat(c))),a&&pk.error("[".concat(this.name,"] init websocket failed: ").concat(c))):o&&o(e)}return n.promise}async reconnectWithAction(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount)return!1;if(0===this.urls.length)return!1;if("closed"===this.state)return!1;pk.warning("[choose-best-ws] action: =>",e),this.onlineReconnectListener||yA.isOnline||!yA.onlineWaiter||(this.onlineReconnectListener=yA.onlineWaiter.then((()=>{this.onlineReconnectListener=void 0})));let n=!0;if(this.reconnectInterrupter=()=>n=!1,t){const t=JA(this.reconnectCount,this.retryConfig);pk.debug("[".concat(this.name,"] wait ").concat(t,"ms to reconnect websocket, mode: ").concat(e)),await ih.race([MA(t),this.onlineReconnectListener||new ih((()=>{}))])}if("closed"===this._state||!n)return!1;this.reconnectCount+=1;const r=async(e,t)=>{this.emit(Lx.RECONNECT_CREATE_CONNECTION,t),await this.createWebSocketConnection(e)};try{if("retry"===e)await r(this.urls[this.currentURLIndex],e);else if("tryNext"===e){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);pk.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),await r(this.urls[this.currentURLIndex],e)}else"recover"===e&&(pk.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.urls=await mA(this,Lx.REQUEST_NEW_URLS),this.currentURLIndex=0,await r(this.urls[this.currentURLIndex],e))}catch(n){var o;pk.error("[".concat(this.name,"] reconnect failed ").concat(n&&n.toString()));const r=null==n||null===(o=n.data)||void 0===o?void 0:o.desc;return Array.isArray(r)&&Ur(r).call(r,"dynamic key expired")?(this.emit(Lx.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(e,t)}return!0}}class GU extends HU{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(e,t){const n=Zw(),r=function(e,t){return new BU(e,t)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{pk.debug("[choose-best-ws] close establishing websockets"),r.closeAllWebsockets(),n.reject(new FI(jI.WS_ABORT,"choose best websocket aborted"))};const o=UN("GATEWAY_DOMAINS");return pk.debug("[choose-best-ws] currentDomain: ",e,", domains: ",o,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),r.chooseBestWebsocket(e,this.tryDoubleDomain,this.use443PortOnly,t).then(n.resolve).catch(n.reject),n.promise.finally((()=>{this.closeEstablishingWs=void 0}))}}class WU extends HU{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(e,t){return new ih(((n,r)=>{let o=!1;const i=[];this.closeEstablishingWs=()=>{pk.debug("[choose-best-ws] close establishing websockets"),i.forEach((e=>{e.onclose=null,e.onopen=null,e.onmessage=null,e.close()})),r(new FI(jI.WS_ABORT,"choose best websocket aborted"))};const a=UN("GATEWAY_DOMAINS");let s;const c=e.indexOf("?h="),l=a.find((t=>-1!==c?Ur(e).call(e,t,c):Ur(e).call(e,t)));pk.debug("[choose-best-ws] currentDomain: ",l,", domains: ",a);let u=!this.tryDoubleDomain||!l;if(!u&&l){var d;const p=Date.now();try{a.forEach((t=>{const n=-1===c?e.replace(l,t):e.substr(0,c)+e.substr(c).replace(l,t),r=new WebSocket(n);r.binaryType="arraybuffer",i.push(r),pk.debug("[choose-best-ws] ws is connecting:",r.url)}))}catch(e){for(pk.debug("[choose-best-ws] ws create failed, fallback to single url"),i.forEach((e=>e.close()));i.length;)i.pop();u=!0}null===(d=this.store)||void 0===d||d.recordJoinChannelService({urls:i.map((e=>e.url)),service:"gateway"},t),i.forEach((e=>{e.onopen=()=>{if(o)return;const t=Date.now()-p;pk.debug("[choose-best-ws] ws open cost ".concat(t,"ms")),i.filter((t=>t!==e)).forEach((e=>{pk.debug("[choose-best-ws]close backup websocket: ".concat(e.url)),e.close()})),o=!0,n(e)},e.onclose=e=>{s=e,o||i.find((e=>!(e.readyState===WebSocket.CLOSED||e.readyState===WebSocket.CLOSING)))||(pk.debug("[choose-best-ws] all websocket is closed"),o=!0,r(s))},e.onmessage=t=>{pk.debug("[choose-best-ws]".concat(e.url," onmessage: ").concat(t.data))}})),MA(this.forceCloseTimeout).then((()=>{i.forEach((e=>{e.readyState!==WebSocket.OPEN&&e.close()}))}))}if(u){var p;let o;pk.debug("[choose-best-ws] use single url: ",e),null===(p=this.store)||void 0===p||p.recordJoinChannelService({urls:[e],service:"gateway"},t);try{o=new WebSocket(e),i.push(o),o.binaryType="arraybuffer"}catch(e){const n=new FI(jI.WS_ERR,"init websocket failed! Error: ".concat(e.toString()));return pk.error("[".concat(this.name,"]").concat(n)),void r(n)}o.onopen=()=>{n(o)},o.onclose=e=>{r(e)},o.onmessage=e=>{pk.debug("[choose-best-ws]".concat(o.url," onmessage: ").concat(e.data))},MA(this.forceCloseTimeout).then((()=>{o&&o.readyState!==WebSocket.OPEN&&o.close()}))}})).then((e=>(this.closeEstablishingWs=void 0,e))).catch((e=>{throw this.closeEstablishingWs=void 0,e}))}}class qU extends eA{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===Ax.CONNECTED?this.emit(Nx.WS_CONNECTED):e===Ax.RECONNECTING?this.emit(Nx.WS_RECONNECTING,this._websocketReconnectReason):e===Ax.CLOSED&&this.emit(Nx.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(e,t){super(),OR(this,"_disconnectedReason",void 0),OR(this,"_websocketReconnectReason",void 0),OR(this,"_connectionState",Ax.CLOSED),OR(this,"reconnectToken",void 0),OR(this,"websocket",void 0),OR(this,"openConnectionTime",void 0),OR(this,"clientId",void 0),OR(this,"lastMsgTime",Date.now()),OR(this,"uploadCache",[]),OR(this,"uploadCacheInterval",void 0),OR(this,"rttRolling",new $A(5)),OR(this,"pingpongTimer",void 0),OR(this,"wsInflateDataTimer",void 0),OR(this,"pingpongTimeoutCount",0),OR(this,"joinResponse",void 0),OR(this,"multiIpOption",void 0),OR(this,"initError",void 0),OR(this,"spec",void 0),OR(this,"store",void 0),OR(this,"onWebsocketMessage",(e=>{if(e.data instanceof ArrayBuffer)return void this.emit(Nx.ON_BINARY_DATA,e.data);const t=JSON.parse(e.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(t,"_id")){const e="res-@".concat(t._id);this.emit(e,t._result,t._message)}else if(Object.prototype.hasOwnProperty.call(t,"_type")){if(this.emit(t._type,t._message),t._type===Dx.ON_NOTIFICATION&&this.handleNotification(t._message),t._type===Dx.ON_USER_BANNED)switch(t._message.error_code){case 14:this.close(sA.UID_BANNED);break;case 15:this.close(sA.IP_BANNED);break;case 16:this.close(sA.CHANNEL_BANNED)}if(t._type===Dx.ON_USER_LICENSE_BANNED)switch(t._message.error_code){case Ix.ERR_LICENSE_MISSING:this.close(sA.LICENSE_MISSING);break;case Ix.ERR_LICENSE_EXPIRED:this.close(sA.LICENSE_EXPIRED);break;case Ix.ERR_LICENSE_MINUTES_EXCEEDED:this.close(sA.LICENSE_MINUTES_EXCEEDED);break;case Ix.ERR_LICENSE_PERIOD_INVALID:this.close(sA.LICENSE_PERIOD_INVALID);break;case Ix.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(sA.LICENSE_MULTIPLE_SDK_SERVICE);break;case Ix.ERR_LICENSE_ILLEGAL:this.close(sA.LICENSE_ILLEGAL);break;default:this.close()}}})),this.clientId=e.clientId,this.spec=e,this.store=t,this.websocket=new GU("gateway-".concat(this.clientId),this.spec.retryConfig,!0,UN("JOIN_GATEWAY_USE_DUAL_DOMAIN"),UN("JOIN_GATEWAY_USE_443PORT_ONLY"),t),this.handleWebsocketEvents(),window.addEventListener("offline",(()=>{this.connectionState===Ax.CONNECTED&&this.reconnect("retry",pA.OFFLINE)}))}async request(e,t,n,r){const o=LA(6,""),i={_id:o,_type:e,_message:t},a=this.websocket.connectionID,s=()=>new ih(((t,n)=>{if(this.connectionState===Ax.CONNECTED)return t();const r=()=>{this.off(Nx.WS_CLOSED,o),t()},o=()=>{this.off(Nx.WS_CONNECTED,r),n(new bk(jI.WS_ABORT))};this.once(Nx.WS_CONNECTED,r),this.once(Nx.WS_CLOSED,o),e!==kx.PUBLISH&&e!==kx.PUBLISH_DATASTREAM&&e!==kx.SUBSCRIBE&&e!==kx.SUBSCRIBE_DATASTREAM&&e!==kx.UNSUBSCRIBE&&e!==kx.UNSUBSCRIBE_DATASTREAM&&e!==kx.UNPUBLISH&&e!==kx.UNPUBLISH_DATASTREAM&&e!==kx.CONTROL&&e!==kx.RESTART_ICE||this.once(Nx.DISCONNECT_P2P,(()=>{n(new bk(jI.DISCONNECT_P2P))})),e!==kx.PUBLISH&&e!==kx.RESTART_ICE||this.once(Nx.ABORT_P2P_EXECUTION,(()=>{n(new bk(jI.DISCONNECT_P2P))}))}));if(this.connectionState!==Ax.CONNECTING&&this.connectionState!==Ax.RECONNECTING||e===kx.JOIN||e===kx.REJOIN||await s(),this.websocket.sendMessage(i,!0),r)return;const c=new ih(((n,r)=>{let i=!1;const s=(r,o)=>{i=!0,n({isSuccess:"success"===r,message:o||{}}),this.off(Nx.WS_CLOSED,c),this.off(Nx.WS_RECONNECTING,c),this.emit(Nx.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(o),s);const c=()=>{r(new bk(jI.WS_ABORT,"type: ".concat(e))),this.off(Nx.WS_CLOSED,c),this.off(Nx.WS_RECONNECTING,c),this.off("res-@".concat(o),s)};this.once(Nx.WS_CLOSED,c),this.once(Nx.WS_RECONNECTING,c),MA(UN("SIGNAL_REQUEST_TIMEOUT")).then((()=>{this.websocket.connectionID!==a||i||(pk.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(e)),this.emit(Nx.REQUEST_TIMEOUT,e,t))}))}));let l=null;try{l=await c}catch(r){if(this.connectionState===Ax.CLOSED||e===kx.LEAVE)throw new bk(jI.WS_ABORT);return!this.spec.forceWaitGatewayResponse||n?r.throw():e===kx.JOIN||e===kx.REJOIN?null:(await s(),await this.request(e,t))}if(l.isSuccess)return l.message;const u=Number(l.message.error_code||l.message.code),d=kU(u),p=new bk(jI.UNEXPECTED_RESPONSE,"".concat(d.desc,": ").concat(l.message.error_str),{code:u,data:l.message,desc:d.desc});return"success"===d.action?l.message:(pk.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(u,", message: ").concat(d.desc,", action: ").concat(d.action)),u===Ix.ERR_TOO_MANY_BROADCASTERS?e===kx.JOIN||e===kx.REJOIN?(this.initError=p,this.close(),p.throw()):p.throw():"failed"===d.action?p.throw():"quit"===d.action?(this.initError=p,this.close(),p.throw()):(u===Ix.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=l.message.option,pk.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",pA.MULTI_IP)):this.reconnect(d.action,pA.SERVER_ERROR),e===kx.JOIN||e===kx.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new ih((n=>{const r=o=>{(!t||t(o))&&(this.off(e,r),n(o))};this.on(e,r)}))}uploadWRTCStats(e){if(!this.store.sessionId)return void pk.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(Px.WRTC_STATS,t)}upload(e,t){const n={_type:e,_message:t};try{this.websocket.sendMessage(n)}catch(e){const t=UN("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(n),this.uploadCache.length>t&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval((()=>{if(this.connectionState!==Ax.CONNECTED)return;const e=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(e._type,e._message)}),UN("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,t){const n={_type:e,_message:t};this.websocket.sendMessage(n)}init(e){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new ih(((t,n)=>{this.once(Nx.WS_CONNECTED,(()=>t(this.joinResponse))),this.once(Nx.WS_CLOSED,(e=>n(this.initError||new bk(jI.WS_ABORT,e)))),this.connectionState=Ax.CONNECTING,this.websocket.init(e).catch(n),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval((()=>{this.handleWsInflateData()}),2e4)}))}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=e||sA.LEAVE,this.connectionState=Ax.CLOSED,pk.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close()}async join(){if(!this.joinResponse){this.emit(Nx.ABORT_P2P_EXECUTION);const e=await mA(this,Nx.REQUEST_JOIN_INFO),t=await this.request(kx.JOIN,e);if(!t)return this.emit(Nx.REPORT_JOIN_GATEWAY,$x.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.emit(Nx.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Ax.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new bk(jI.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const e=EA(this,Nx.REQUEST_REJOIN_INFO);e.token=this.reconnectToken;const t=await this.request(kx.REJOIN,e);return!!t&&(this.connectionState=Ax.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),t.peers&&t.peers.forEach((e=>{this.emit(Dx.ON_USER_ONLINE,{uid:e.uid}),e.audio&&this.emit(Dx.ON_ADD_AUDIO_STREAM,{uid:e.uid,uint_id:e.uint_id,audio:!0,ssrcId:e.audio_ssrc}),e.video&&this.emit(Dx.ON_ADD_VIDEO_STREAM,{uid:e.uid,uint_id:e.uint_id,video:!0,ssrcId:e.video_ssrc}),e.audio_mute?this.emit(Dx.MUTE_AUDIO,{uid:e.uid}):this.emit(Dx.UNMUTE_AUDIO,{uid:e.uid}),e.video_mute?this.emit(Dx.MUTE_VIDEO,{uid:e.uid}):this.emit(Dx.UNMUTE_VIDEO,{uid:e.uid}),e.audio_enable_local?this.emit(Dx.ENABLE_LOCAL_AUDIO,{uid:e.uid}):this.emit(Dx.DISABLE_LOCAL_AUDIO,{uid:e.uid}),e.video_enable_local?this.emit(Dx.ENABLE_LOCAL_VIDEO,{uid:e.uid}):this.emit(Dx.DISABLE_LOCAL_VIDEO,{uid:e.uid}),e.audio||e.video||this.emit(Dx.ON_REMOVE_STREAM,{uid:e.uid,uint_id:e.uint_id})})),!0)}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}handleNotification(e){pk.debug("[".concat(this.clientId,"] receive notification: "),e);const t=kU(e.code);if(28===e.code&&"detail"in e&&(pk.info("[".concat(this.clientId,"] receive recover notification: "),e.detail),this.emit(Nx.RECOVER_NOTIFICATION,e.detail)),"success"!==t.action){if("failed"!==t.action)return"quit"===t.action?("ERR_REPEAT_JOIN_CHANNEL"===t.desc&&this.close(sA.UID_BANNED),void this.close()):void this.reconnect(t.action,pA.SERVER_ERROR);pk.error("[".concat(this.clientId,"] ignore error: "),t.desc)}}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=UN("PING_PONG_TIME_OUT"),t=Date.now();this.pingpongTimeoutCount>=e&&(pk.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>UN("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",pA.TIMEOUT):this.request(kx.PING,void 0,!0).then((()=>{this.pingpongTimeoutCount=0;const e=Date.now()-t;this.rttRolling.add(e),UN("REPORT_STATS")&&this.send(kx.PING_BACK,{pingpongElapse:e})})).catch((e=>{}))}handleWsInflateData(){const{wsInflateLength:e,wsDeflateLength:t}=this.websocket.getWsInflateData();0!==e&&0!==t&&this.upload(Px.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:t,ws_inflate_length:e})}handleWebsocketEvents(){this.websocket.on(Lx.RECONNECT_CREATE_CONNECTION,(e=>{this.emit(Nx.WS_RECONNECT_CREATE_CONNECTION,e)})),this.websocket.on(Lx.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(Lx.CLOSED,(()=>{this.connectionState=Ax.CLOSED})),this.websocket.on(Lx.FAILED,(()=>{this._disconnectedReason=sA.NETWORK_ERROR,this.connectionState=Ax.CLOSED})),this.websocket.on(Lx.RECONNECTING,(e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===Ax.CONNECTED?this.connectionState=Ax.RECONNECTING:this.connectionState=Ax.CONNECTING})),this.websocket.on(Lx.WILL_RECONNECT,((e,t,n)=>{const r=EA(this,Nx.IS_P2P_DISCONNECTED),o=r||"retry"!==e;r&&"retry"===e&&(pk.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),e="tryNext",t=$x.P2P_DISCONNECTED),o&&(pk.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(e)),this.emit(Nx.REPORT_JOIN_GATEWAY,t||$x.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(Nx.DISCONNECT_P2P)),n(e)})),this.websocket.on(Lx.CONNECTED,(()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch((e=>{pk.warning("[".concat(this.clientId,"] rejoin failed ").concat(e)),this.reconnect("tryNext",pA.SERVER_ERROR)})):this.join().catch((e=>{if(this.emit(Nx.REPORT_JOIN_GATEWAY,e,this.url||""),e instanceof bk){if(e.code===jI.UNEXPECTED_RESPONSE&&e.data.code===Ix.ERR_NO_AUTHORIZED)return this.initError=new bk(jI.TOKEN_EXPIRE,"dynamic key expired"),void this.close(sA.TOKEN_EXPIRE);pk.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",pA.SERVER_ERROR):(this.initError=e,this.close())}}))})),this.websocket.on(Lx.REQUEST_NEW_URLS,((e,t)=>{mA(this,Nx.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)})),this.websocket.on(Lx.ON_TOKEN_PRIVILEGE_DID_EXPIRE,(()=>{this.emit(Dx.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})),this.websocket.on(yU.PRE_CONNECT_PC,(()=>{this.emit(Nx.PRE_CONNECT_PC)}))}}let KU=function(e){return e.NATIVE_RTC="native_rtc",e.NATIVE_RTM="native_rtm",e.WEB_RTC="web_rtc",e.WEB_RTM="web_rtm",e}({}),YU=function(e){return e[e.CHOOSE_SERVER=11]="CHOOSE_SERVER",e[e.CLOUD_PROXY=18]="CLOUD_PROXY",e[e.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",e[e.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",e}({});function zU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function XU(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zU(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zU(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function JU(e){return e.match(/^[\.\:\d]+$/)?"".concat(e.replace(/[^\d]/g,"-"),".").concat(UN("TURN_DOMAIN")):(pk.debug("Cannot recognized as ip address: ".concat(e,", use as host")),e)}function ZU(e,t){e.addresses||(e.addresses=[]);const n=function(e,t){if(UN("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return e.map((e=>{let{ip:t,port:n}=e;return{address:"".concat(t,":").concat(n)}}));const n=UN("GATEWAY_DOMAINS");let r=n[1]&&Ur(t).call(t,n[1])?1:0;return e.map((e=>{let{domain_prefix:t,port:o,ip:i}=e;if(t)return{address:"".concat(t,".").concat(n[r++%n.length],":").concat(o)};const a=/^[\.\:\d]+$/.test(i),s=a?"".concat(i.replace(/[^\d]/g,"-"),".").concat(n[r++%n.length],":").concat(o):"".concat(i,":").concat(o);return a||pk.debug("Cannot recognized as ip address: ".concat(i,", use as host")),{ip:i,port:o,address:s}}))}(e.addresses,t),r=Array.isArray(e.detail)&&e.detail[18];if(r&&"string"==typeof r){const e=r.split(";");for(let t=0;t<e.length;t++){var o;const r=ny(o=e[t]).call(o);n[t]&&r&&(n[t].ip6=r)}}const i=e.detail&&e.detail.candidate;let a;if(i){const[e,t]=i.split(":");e&&t&&(a={port:Number(t),ip:e,address:"".concat(e,":").concat(t)})}return{gatewayAddrs:n,apGatewayAddress:a,uid:e.uid,cid:e.cid,cert:e.cert,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e,csIp:e.detail&&e.detail[502]}}function QU(e){return"number"==typeof e?e:e.exact||e.ideal||e.max||e.min||0}function $U(e){const t=e._encoderConfig;if(!t)return{};const n={resolution:t.width&&t.height?"".concat(QU(t.width),"x").concat(QU(t.height)):void 0,maxVideoBW:t.bitrateMax,minVideoBW:t.bitrateMin};return"number"==typeof t.frameRate?(n.maxFrameRate=t.frameRate,n.minFrameRate=t.frameRate):t.frameRate&&(n.maxFrameRate=t.frameRate.max||t.frameRate.ideal||t.frameRate.exact||t.frameRate.min,n.minFrameRate=t.frameRate.min||t.frameRate.ideal||t.frameRate.exact||t.frameRate.max),n}function ej(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0}function tj(e,t){let n,r,o;switch(t){case YU.CHOOSE_SERVER:r=4096,o="choose server";break;case YU.CLOUD_PROXY:r=1048576,o="proxy";break;case YU.CLOUD_PROXY_5:r=4194304,o="proxy5";break;case YU.CLOUD_PROXY_FALLBACK:r=4194310,o="proxy fallback";break;default:throw new bk(jI.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:e.detail&&e.detail[502],retry:!1})}if(e.response_body.forEach((t=>{t.buffer&&t.buffer.flag===r&&(n={code:t.buffer.code,addresses:(t.buffer.edges_services||[]).map((e=>XU(XU({},e),{},{ticket:t.buffer.cert}))),server_ts:e.enter_ts,uid:t.buffer.uid,cid:t.buffer.cid,cname:t.buffer.cname,detail:XU(XU({},t.buffer.detail),e.detail),flag:t.buffer.flag,opid:e.opid,cert:t.buffer.cert})})),!n)throw new bk(jI.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(o," from multi unilbs response"),{csIp:e.detail&&e.detail[502]});return n}async function nj(e,t){return await ih.all(e.addresses.map((async e=>({address:JU(e.ip),tcpport:e.port,udpport:e.port,username:t&&UN("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?t.toString():NN.username,password:t&&UN("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await $I(t.toString()):NN.password}))))}function rj(e,t){const n=t.getMediaStreamTrack(!0).getSettings(),r=t.videoHeight||n.height,o=t.videoWidth||n.width;return r&&o?Math.max(Math.min(r,o)/Math.min(QU(e.height),QU(e.width)),1):(pk.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function oj(e){let{candidateType:t,relayProtocol:n,type:r,address:o,port:i,protocol:a}=e;const s={candidateType:t,relayProtocol:n,protocol:a};if("local-candidate"!==r){const e=o.split(".");e.length>=4&&(e[1]="*",e[2]="*"),s.address=e.join("."),s.port=i}return s}function ij(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:UN("SVC_MODE");if(UN("ENABLE_SVC"))return function(e){return e in gN}(e)?e:gN.L1T3}const aj={[lU.VIDEO]:[{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"},{key:"video-orientation",extensionName:"urn:3gpp:video-orientation"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"playout-delay",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"},{key:"video-content-type",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type"},{key:"color-space",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/color-space"},{key:"video-timing",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing"}],[lU.AUDIO]:[{key:"ssrc-audio-level",extensionName:"urn:ietf:params:rtp-hdrext:ssrc-audio-level"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}]};function sj(e,t,n){t.forEach((t=>{var r;const o=aj[e].find((e=>{var n;let{key:r}=e;return Ur(n=t.extensionName).call(n,r)}));if(!o)return;const i=n.find((e=>{let{extensionName:t}=e;return Ur(t).call(t,o.key)}));i&&Ur(r=i.extensionName).call(r,"gdpr_forbidden")&&(t.extensionName=i.extensionName)}))}function cj(e,t){t.forEach((t=>{var n;const r=aj[e].find((e=>{var n;let{key:r}=e;return Ur(n=t.extensionName).call(n,r)}));Ur(n=t.extensionName).call(n,"gdpr_forbidden")&&r&&(t.extensionName=r.extensionName)}))}function lj(e){return"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e||Ur(e).call(e,"abs-send-time")}function uj(e){return"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e||Ur(e).call(e,"draft-holmer-rmcat-transport-wide-cc-extensions-01")}function dj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dj(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hj(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;const{filterRTX:o,filterVideoFec:i,filterAudioFec:a,filterAudioCodec:s,filterVideoCodec:c}=t,{useXR:l}=n;let u=[],d=[],p=[],h=[],f=!1,m=!1;if(qN(e).mediaDescriptions.forEach((e=>{r&&r!==e.attributes.direction||("video"!==e.media.mediaType||f||(d=e.attributes.payloads,h=e.attributes.extmaps,f=!0),"audio"!==e.media.mediaType||m||(u=e.attributes.payloads,p=e.attributes.extmaps,m=!0))})),!h||0===d.length)throw new Error("Cannot get video capabilities from SDP.");if(!p||0===u.length)throw new Error("Cannot get audio capabilities from SDP.");if(d.forEach((e=>{var t;null!==(t=e.rtpMap)&&void 0!==t&&t.clockRate&&(e.rtpMap.clockRate=parseInt(e.rtpMap.clockRate)),l&&e.rtcpFeedbacks.push({type:"rrtr"})})),u.forEach((e=>{var t;null!==(t=e.rtpMap)&&void 0!==t&&t.clockRate&&(e.rtpMap.clockRate=parseInt(e.rtpMap.clockRate)),l&&e.rtcpFeedbacks.push({type:"rrtr"})})),o&&(u=u.filter((e=>{var t;return"rtx"!==(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())})),d=d.filter((e=>{var t;return"rtx"!==(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())}))),i&&(d=d.filter((e=>{var t;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName)||"")}))),a&&(u=u.filter((e=>{var t;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName)||"")}))),s&&(null==s?void 0:s.length)>0&&(u=u.filter((e=>{var t;return Ur(s).call(s,(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"")}))),c&&(null==c?void 0:c.length)>0){const e=d.filter((e=>{var t;return Ur(c).call(c,(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"")}));d=e.concat(o?[]:kj(e,d))}const v=UN("UNSUPPORTED_VIDEO_CODEC");return v&&v.length>0&&(d=d.filter((e=>!(e.rtpMap&&Ur(v).call(v,e.rtpMap.encodingName.toLowerCase()))))),{audioCodecs:u,videoCodecs:d,audioExtensions:p,videoExtensions:h}}function fj(e){const t=qN(e);let n,r;for(const o of t.mediaDescriptions){if(!n){const e=o.attributes.iceUfrag,t=o.attributes.icePwd;if(!e||!t)throw new Error("Cannot get iceUfrag or icePwd from SDP.");n={iceUfrag:e,icePwd:t}}if(!r){const e=o.attributes.fingerprints;e.length>0&&(r={fingerprints:e})}}if(!r&&t.attributes.fingerprints.length>0&&(r={fingerprints:t.attributes.fingerprints}),!r||!n)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:n,dtlsParameters:r}}function mj(e,t){const n=[],r=e.attributes.ssrcGroups.filter((e=>"FID"===e.semantic)),o=e.attributes.ssrcGroups.find((e=>"SIM"===e.semantic)),i=e.attributes.ssrcs;if(o)o.ssrcIds.forEach((e=>{var o;const i=null===(o=r.find((t=>t.ssrcIds[0]===e)))||void 0===o?void 0:o.ssrcIds[1];n.push({ssrcId:e,rtx:t?i:void 0})}));else if(r.length>0){const e=r[0].ssrcIds[0],o=r[0].ssrcIds[1];n.push({ssrcId:e,rtx:t?o:void 0})}else{if(0===i.length)throw new Error("No ssrcs found on local media description.");n.push({ssrcId:i[0].ssrcId})}return n}function vj(e,t,n){const{cname:r}=e;let o=[];t&&(o=gj(t)),0===o.length&&(o=e.iceParameters.candidates.map((e=>({foundation:e.foundation,componentId:"1",transport:e.protocol,priority:e.priority.toString(),connectionAddress:e.ip,port:e.port.toString(),type:e.type,extension:{}}))),pk.debug("Using candidates from gateway."));const i={fingerprints:e.dtlsParameters.fingerprints.map((e=>({hashFunction:e.algorithm,fingerprint:e.fingerprint})))},a={iceUfrag:e.iceParameters.iceUfrag,icePwd:e.iceParameters.icePwd};let s;switch(e.dtlsParameters.role){case"server":s="passive";break;case"client":s="active";break;case"auto":s="actpass"}const c=Ij(e.rtpCapabilities),l=[];return Array.isArray(n)&&n.length>0&&n.forEach((e=>{l.push({kind:lU.VIDEO,ssrcId:e.v,rtx:e.v_rtx,mslabel:"".concat(e.v,"_").concat(e.a)},{kind:lU.AUDIO,ssrcId:e.a,mslabel:"".concat(e.v,"_").concat(e.a)})})),{dtlsParameters:i,iceParameters:a,candidates:o,rtpCapabilities:c,setup:s,cname:r,preSSRCs:l}}function gj(e){let t=[];return e.ip&&"number"==typeof e.port&&(t=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip,port:e.port.toString(),type:"host",extension:{}}],pk.debug("Using remote candidate from AP ".concat(e.ip,":").concat(e.port)),e.ip6&&(t.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip6,port:e.port.toString(),type:"host",extension:{}}),pk.debug("Using IPV6 remote candidate from AP ".concat(e.ip6,":").concat(e.port)))),t}function Ej(e,t,n){const r=[],o=[];return e.forEach((e=>{let{ssrcId:i,rtx:a}=e;const s=LA(8,"track-"),c={ssrcId:i,attributes:pj({label:s,mslabel:n=n||LA(10,""),msid:"".concat(n," ").concat(s)},t&&{cname:t})};if(r.push(c),void 0!==a){const e={ssrcId:a,attributes:pj({label:s,mslabel:n,msid:"".concat(n," ").concat(s)},t&&{cname:t})};r.push(e),o.push({semantic:"FID",ssrcIds:[i,a]})}})),e.length>1&&o.push({semantic:"SIM",ssrcIds:e.map((e=>{let{ssrcId:t}=e;return t}))}),{ssrcs:r,ssrcGroups:o}}function yj(e,t){t instanceof WD&&e.attributes.payloads.forEach((e=>{var n;const r=null===(n=e.rtpMap)||void 0===n?void 0:n.encodingName.toLowerCase();if(!r||-1===["opus","pcmu","pcma","g722"].indexOf(r))return;e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters.minptime="10",e.fmtp.parameters.useinbandfec="1";const o=t._encoderConfig;o&&"pcmu"!==r&&"pcma"!==r&&"g722"!==r&&(o.bitrate&&!fI()&&(e.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*o.bitrate))),o.sampleRate&&(e.fmtp.parameters.maxplaybackrate="".concat(o.sampleRate),e.fmtp.parameters["sprop-maxcapturerate"]="".concat(o.sampleRate)),o.stereo&&(e.fmtp.parameters.stereo="1",e.fmtp.parameters["sprop-stereo"]="1"))}))}function _j(e){const t=e.attributes.unrecognized.findIndex((e=>"x-google-flag"===e.attField&&"conference"===e.attValue));-1!==t&&e.attributes.unrecognized.splice(t,1)}function bj(e,t){var n;if(!(t instanceof DM&&t._encoderConfig&&-1===t._hints.indexOf(Hk.SCREEN_TRACK)))return;const r=t._encoderConfig;Sk().supportMinBitrate&&r.bitrateMin&&e.attributes.payloads.forEach((e=>{var t,n;Ur(t=["h264","h265","vp8","vp9","av1"]).call(t,(null===(n=e.rtpMap)||void 0===n?void 0:n.encodingName.toLowerCase())||"")&&(e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters["x-google-min-bitrate"]="".concat(r.bitrateMin))})),Sk().supportMinBitrate&&!Ur(n=t._hints).call(n,Hk.LOW_STREAM)&&r.bitrateMax&&e.attributes.payloads.forEach((e=>{var t,n;Ur(t=["h264","h265","vp8","vp9","av1"]).call(t,(null===(n=e.rtpMap)||void 0===n?void 0:n.encodingName.toLowerCase())||"")&&(e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters["x-google-start-bitrate"]="".concat(UN("X_GOOGLE_START_BITRATE")||Math.floor(r.bitrateMax)))}))}function Tj(e){if("video"!==e.media.mediaType)return;const t=aI();if(t.name!==nI.SAFARI&&t.os!==tI.IOS)return;const n=e.attributes.extmaps.findIndex((e=>/video-orientation/g.test(e.extensionName)));-1!==n&&e.attributes.extmaps.splice(n,1)}function Sj(e,t,n){if(!t)return;let r,o;if("video"===e.media.mediaType?(r=n.videoExtensions,o=n.videoCodecs):(r=n.audioExtensions,o=n.audioCodecs),!0===t.twcc){const t=r.find((e=>uj(e.extensionName)));if(t){const n=t.extensionName;e.attributes.extmaps.find((e=>uj(e.extensionName)))||e.attributes.extmaps.push({entry:t.entry,extensionName:n});const r=function(e,t){return t.filter((t=>!!e.find((e=>e.payloadType===t.payloadType&&!!e.rtcpFeedbacks.find((e=>"transport-cc"===e.type))))))}(o,e.attributes.payloads);r.forEach((e=>{e.rtcpFeedbacks.find((e=>"transport-cc"===e.type))||e.rtcpFeedbacks.push({type:"transport-cc"})}))}}else if(!1===t.twcc){const t=e.attributes.extmaps.findIndex((e=>uj(e.extensionName)));-1!==t&&e.attributes.extmaps.splice(t,1),e.attributes.payloads.forEach((e=>{const t=e.rtcpFeedbacks.findIndex((e=>"transport-cc"===e.type));-1!==t&&e.rtcpFeedbacks.splice(t,1)}))}if(!0===t.remb){const t=r.find((e=>lj(e.extensionName)));if(t){const n=t.extensionName;e.attributes.extmaps.find((e=>e.extensionName===n))||e.attributes.extmaps.push({entry:t.entry,extensionName:n});const r=function(e,t){return t.filter((t=>!!e.find((e=>e.payloadType===t.payloadType&&!!e.rtcpFeedbacks.find((e=>"goog-remb"===e.type))))))}(o,e.attributes.payloads);r.forEach((e=>{e.rtcpFeedbacks.find((e=>"goog-remb"===e.type))||e.rtcpFeedbacks.push({type:"goog-remb"})}))}}else if(!1===t.remb){const t=e.attributes.extmaps.findIndex((e=>lj(e.extensionName)));-1!==t&&e.attributes.extmaps.splice(t,1),e.attributes.payloads.forEach((e=>{const t=e.rtcpFeedbacks.findIndex((e=>"goog-remb"===e.type));-1!==t&&e.rtcpFeedbacks.splice(t,1)}))}}function Oj(e,t,n){if(fI())return;if("video"!==e.media.mediaType)return;if(!(t instanceof DM))return;if("vp9"!==n&&"vp8"!==n)return;if("vp8"===n&&!UN("SIMULCAST"))return;if("vp9"===n&&UN("ENABLE_SVC"))return;if(void 0===t._scalabilityMode||t._scalabilityMode.numSpatialLayers<=1)return;const r="vp8"===n?2:t._scalabilityMode.numSpatialLayers,o=e.attributes.ssrcs[0],i=e.attributes.ssrcGroups.find((e=>"FID"===e.semantic&&e.ssrcIds[0]===o.ssrcId)),a={semantic:"SIM",ssrcIds:[o.ssrcId]};for(let s=1;s<r;s++)e.attributes.ssrcs.push({ssrcId:o.ssrcId+s,attributes:SA(o.attributes)}),a.ssrcIds.push(o.ssrcId+s),i&&(e.attributes.ssrcs.push({ssrcId:i.ssrcIds[1]+s,attributes:SA(o.attributes)}),e.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[o.ssrcId+s,i.ssrcIds[1]+s]}));e.attributes.ssrcGroups.unshift(a)}async function Rj(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new RTCPeerConnection;n.addTransceiver("video",{direction:"sendonly"}),n.addTransceiver("audio",{direction:"sendonly"}),n.addTransceiver("video",{direction:"recvonly"}),n.addTransceiver("audio",{direction:"recvonly"});const r=(await n.createOffer()).sdp,{send:o,recv:i,sendrecv:a}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=hj(n,e,t,"sendonly"),o=hj(n,e,t,"recvonly"),i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},a={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},s={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(wj(r,o,"videoExtensions",i,a,s),wj(r,o,"videoCodecs",i,a,s),wj(r,o,"audioExtensions",i,a,s),wj(r,o,"audioCodecs",i,a,s),UN("RAISE_H264_BASELINE_PRIORITY")){const e=[],t=[];s.videoCodecs.forEach(((n,r)=>{var o;if("h264"===(null===(o=n.rtpMap)||void 0===o?void 0:o.encodingName.toLocaleLowerCase())){var i,a;const o=s.videoCodecs[r+1],c=o&&xj(n,o),l=null===(i=n.fmtp)||void 0===i?void 0:i.parameters["profile-level-id"],u=null===(a=n.fmtp)||void 0===a?void 0:a.parameters["packetization-mode"];!l||l!==UN("FIRST_H264_PROFILE_LEVEL_ID")||UN("FIRST_PACKETIZATION_MODE")&&u!==UN("FIRST_PACKETIZATION_MODE")?c?t.push([n,o]):t.push([n]):c?e.push([n,o]):e.push([n])}})),e.length>0&&t.length>0&&(pk.debug("raising H264 baseline profile priority"),s.videoCodecs.forEach(((n,r)=>{var o;if("h264"===(null===(o=n.rtpMap)||void 0===o?void 0:o.encodingName.toLocaleLowerCase())){const o=xj(n,s.videoCodecs[r+1]),i=e.shift()||t.shift()||[];i.length>0&&(o?s.videoCodecs.splice(r,2,...i):s.videoCodecs.splice(r,1,...i))}})),a.videoCodecs=a.videoCodecs.filter((e=>{var t,n;return!("h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())&&(null===(n=e.fmtp)||void 0===n?void 0:n.parameters["profile-level-id"])!==UN("FIRST_H264_PROFILE_LEVEL_ID"))})),UN("FILTER_SEND_H264_BASELINE")&&(i.videoCodecs=i.videoCodecs.filter((e=>{var t,n;return!("h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())&&(null===(n=e.fmtp)||void 0===n?void 0:n.parameters["profile-level-id"])!==UN("FIRST_H264_PROFILE_LEVEL_ID"))}))))}return{send:i,recv:a,sendrecv:s}}(e,t,r);try{n.close()}catch(e){}return{send:o,recv:i,sendrecv:a}}function Cj(){const e={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},t=hj(arguments.length>2?arguments[2]:void 0,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"recvonly"),n={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},o={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(wj(e,t,"videoExtensions",n,r,o),wj(e,t,"videoCodecs",n,r,o),wj(e,t,"audioExtensions",n,r,o),wj(e,t,"audioCodecs",n,r,o),UN("RAISE_H264_BASELINE_PRIORITY")){const e=o.videoCodecs.findIndex((e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"===e.fmtp.parameters["profile-level-id"]));if(-1!==e){const t=o.videoCodecs.findIndex((e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()));if(t<e){pk.debug("raising H264 baseline profile priority");const n=o.videoCodecs[e];o.videoCodecs.splice(e,1),o.videoCodecs.splice(t,0,n)}-1!==t&&(r.videoCodecs=r.videoCodecs.filter((e=>!(e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"!==e.fmtp.parameters["profile-level-id"]))))}}return{send:n,recv:r,sendrecv:o}}function wj(e,t,n,r,o,i){if("videoExtensions"===n||"audioExtensions"===n){const a=[];return e[n].forEach((e=>{t[n].some(((t,n)=>{if(e.entry===t.entry&&e.extensionName===t.extensionName)return a.push(n),!0}))?i[n].push(e):r[n].push(e)})),void t[n].forEach(((e,t)=>{-1===a.indexOf(t)&&o[n].push(e)}))}if("videoCodecs"===n||"audioCodecs"===n){const a=[];return e[n].forEach((e=>{t[n].some(((t,n)=>{if(e.payloadType===t.payloadType&&JSON.stringify(e)===JSON.stringify(t))return a.push(n),!0}))?i[n].push(e):r[n].push(e)})),void t[n].forEach(((e,t)=>{-1===a.indexOf(t)&&o[n].push(e)}))}}function Ij(e){const{send:t,recv:n,sendrecv:r}=e;if(!r){if(!t||!n)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:t,recv:n}}let o,i;return t?(o={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},o.audioCodecs=[...t.audioCodecs,...r.audioCodecs],o.videoCodecs=[...t.videoCodecs,...r.videoCodecs],o.audioExtensions=[...t.audioExtensions,...r.audioExtensions],o.videoExtensions=[...t.videoExtensions,...r.videoExtensions]):o=r,n?(i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},i.audioCodecs=[...n.audioCodecs,...r.audioCodecs],i.videoCodecs=[...n.videoCodecs,...r.videoCodecs],i.audioExtensions=[...n.audioExtensions,...r.audioExtensions],i.videoExtensions=[...n.videoExtensions,...r.videoExtensions]):i=r,{send:o,recv:i}}function Aj(e){"audio"===e.media.mediaType&&e.attributes.payloads.filter((e=>{var t;return"opus"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())})).forEach((e=>{e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters.stereo="1",e.fmtp.parameters["sprop-stereo"]="1"}))}function Nj(e,t,n,r){let o=[];if(e===lU.VIDEO){if(UN("H264_PROFILE_LEVEL_ID")&&"h264"===r&&(o=t.videoCodecs.filter((e=>{var t;return Ur(t=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(t,r)&&e&&e.fmtp&&e.fmtp.parameters["profile-level-id"]===UN("H264_PROFILE_LEVEL_ID")}))),!Array.isArray(o)||0===o.length){let e=[];const i=[],a=[],s=[];if(n.videoCodecs.forEach((t=>{const n=t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"";Ur(n).call(n,r)?e.push(t):Ur(n).call(n,"vp9")?i.push(t):Ur(n).call(n,"vp8")?a.push(t):Ur(n).call(n,"h264")&&s.push(t)})),0===e.length){let t="";0!==i.length?(e=i,t="vp9"):0!==a.length?(e=a,t="vp8"):0!==s.length&&(e=s,t="h264"),pk.warning("codec ".concat(r," not included in rtpCapabilities, fallback to default payloads: ").concat(t))}0!==e.length&&(o=t.videoCodecs.filter((t=>e.some((e=>e.payloadType===t.payloadType)))))}if(0===o.length&&(pk.warning("codec ".concat(r," not included in rtpCapabilities, fallback to default payloads: ").concat(t.videoCodecs[0].rtpMap&&t.videoCodecs[0].rtpMap.encodingName)),o=t.videoCodecs),UN("USE_PUB_RTX")||UN("USE_SUB_RTX")){const e=kj(o,t.videoCodecs);o=[...o,...e]}}else o=t.audioCodecs.filter((e=>{var t;return Ur(t=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(t,r)})),0===o.length&&(pk.warning("codec ".concat(r," not included in rtpCapabilities, fallback to opus")),o=t.audioCodecs.filter((e=>{var t;return Ur(t=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(t,"opus")})));return o}function kj(e,t){const n=e.map((e=>e.payloadType.toString()));return t.filter((e=>e.rtpMap&&"rtx"===e.rtpMap.encodingName&&e.fmtp&&e.fmtp.parameters.apt&&Ur(n).call(n,e.fmtp&&e.fmtp.parameters.apt)))}async function Pj(e,t,n){const r=t.toString(),o=Mj(r,"offer","remote","exchangeSDP");await e.setRemoteDescription({type:"offer",sdp:r});const i=await e.createAnswer();if(!i.sdp)throw new Error("cannot get answer sdp");let a=i.sdp;a=Dj(a,n||{}),null==o||o(a||""),await e.setLocalDescription({type:"answer",sdp:a})}function Dj(e,t,n){const r=qN(e),{useXR:o}=t;return r.mediaDescriptions.forEach((e=>{var t;e.attributes.mid&&(Array.isArray(n)&&!Ur(n).call(n,e.attributes.mid)||("audio"===e.media.mediaType&&Aj(e),o&&Ur(t=["audio","video"]).call(t,e.media.mediaType)&&e.attributes.payloads.forEach((e=>{-1===e.rtcpFeedbacks.findIndex((e=>"rrtr"===e.type))&&e.rtcpFeedbacks.push({type:"rrtr"})}))))})),KN(r)}function Mj(e,t,n,r){if(UN("SDP_LOGGING"))return pk.upload("exchanging ".concat(n," ").concat(t," SDP during P2PConnection.").concat(r,"\n"),e),"offer"===t?e=>{Mj(e,"answer","local"===n?"remote":"local",r)}:void 0}function Lj(e){const t=UN("COMPATIBLE_SDP_EXTENSION");return!!(Array.isArray(t)&&t.length>0)&&t.some((t=>Ur(e).call(e,t)))}function xj(e,t){try{var n;return(null===(n=e.fmtp)||void 0===n?void 0:n.parameters.apt)===t.payloadType.toString()}catch(e){return!1}}function Uj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jj(e,t){return typeof UN(e)===t?UN(e):void 0}function Fj(){try{const e=UN("EXPERIMENTS")||{};return"string"==typeof e||Array.isArray(e)?{}:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Uj(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e)}catch(e){return pk.debug("handle gateway attributes failed: ",e),{}}}const Bj={};function Vj(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&pk.debug("install service ".concat(e.name)),Bj[e.name]=e}function Hj(e){const t=Bj[e];if(!t)throw new FI(jI.INVALID_OPERATION,"".concat(e," not found, please use AgoraRTC.use(").concat(e,"Service) to load it first"));return t}function Gj(e,t){return Hj("DataStream").create(e,t)}function Wj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wj(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Kj=new Map;class Yj extends eA{get state(){return this._state}set state(e){if(e===this._state)return;const t=this._state;this._state=e,"DISCONNECTED"===e&&this._disconnectedReason?this.emit(Qx.CONNECTION_STATE_CHANGE,e,t,this._disconnectedReason):this.emit(Qx.CONNECTION_STATE_CHANGE,e,t)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(e){pk.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(e)),this._joinGatewayStartTime=e}constructor(e,t){var n,r,o;super(),OR(this,"store",void 0),OR(this,"joinInfo",void 0),OR(this,"key",void 0),OR(this,"ntpOffset",0),OR(this,"signal",void 0),OR(this,"role",void 0),OR(this,"inChannelInfo",{joinAt:null,duration:0}),OR(this,"spec",void 0),OR(this,"_state","DISCONNECTED"),OR(this,"_statsCollector",void 0),OR(this,"_disconnectedReason",void 0),OR(this,"isSignalRecover",!1),OR(this,"hasChangeBGPAddress",!1),OR(this,"trafficStatsInterval",void 0),OR(this,"networkQualityInterval",void 0),OR(this,"_joinGatewayStartTime",0),OR(this,"_signalTimeout",!1),OR(this,"_clientRoleOptions",void 0),OR(this,"_isProactiveJoin",!1),this.store=e,this.spec=t,this.signal=this.store.useP2P?(n={spec:qj(qj({},t),{},{retryConfig:t.websocketRetryConfig}),store:e},null===(r=(o=Hj("P2PChannel")).createSubmodule)||void 0===r?void 0:r.call(o,n)):new qU(qj(qj({},t),{},{retryConfig:t.websocketRetryConfig}),e),this._statsCollector=t.statsCollector,this.role=t.role||"audience",this._clientRoleOptions=t.clientRoleOptions,this.handleSignalEvents()}async join(e,t,n){this.store.joinGatewayStart(),"disabled"!==e.cloudProxyServer&&(this.hasChangeBGPAddress=!0);const r=Date.now();let o=Kj.get(e.cname);if(o||(o=new Map,Kj.set(e.cname,o)),this._isProactiveJoin=!0,o.has(e.uid)){const t=new bk(jI.UID_CONFLICT);throw _k.joinGateway(e.sid,{lts:r,succ:!1,ec:t.code,addr:null,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!e.proxyServer,signalChannel:"0",preload:e.preload}),t}o.set(e.uid,!0),this.joinInfo=e,this.key=t;let i=0;this.joinGatewayStartTime=r;const a=e.proxyServer;try{pk.debug("[".concat(this.store.clientId,"] use websocket join uid ").concat(i));const t=e.gatewayAddrs.map((t=>{let{address:n}=t;const[r,o]=n.split(":"),i={host:r,port:o};return e.proxyServer&&(i.proxy=e.proxyServer),i}));i=(await this.signal.init(t)).uid,pk.debug("[".concat(this.store.clientId,"] websocket join uid ").concat(i," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(t){var s;throw pk.error("[".concat(this.store.clientId,"] User join failed"),t.toString()),_k.joinGateway(e.sid,{lts:r,succ:!1,ec:(null===(s=t.data)||void 0===s?void 0:s.desc)||t.code,errorMsg:t.message,addr:this.signal.url,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!a,signalChannel:"0",preload:e.preload}),o.delete(e.uid),this.signal.close(),t}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),pk.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval((()=>{this.updateTrafficStats().catch((e=>{pk.warning("[".concat(this.store.clientId,"] get traffic stats error"),e.toString())}))}),3e3),this.networkQualityInterval=window.setInterval((()=>{navigator&&void 0!==navigator.onLine&&!navigator.onLine?this.emit(Qx.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(Qx.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):"CONNECTED"===this.state&&this._statsCollector.trafficStats?this.emit(Qx.NETWORK_QUALITY,{uplinkNetworkQuality:ej(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:ej(this._statsCollector.trafficStats.B_dnq)}):this.emit(Qx.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})}),2e3),this.store.joinGatewayEnd(),i}async leave(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if("DISCONNECTED"!==this.state){t!==sA.FALLBACK&&(this.state="DISCONNECTING");try{e||this.signal.connectionState!==Ax.CONNECTED||await function(e,t){return t===1/0?e:ih.race([e,DA(t)])}(this.signal.request(kx.LEAVE,void 0,!0),3e3)}catch(e){pk.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),e)}this.signal.close(t),t!==sA.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(e,t,n){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new bk(jI.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const r={state:"offer",p2p_id:this.store.p2pId,ortc:t,mode:this.spec.mode,extend:UN("PUB_EXTEND"),twcc:!!UN("PUBLISH_TWCC"),rtx:!!UN("USE_PUB_RTX")};try{return(await this.signal.request(kx.PUBLISH,r,!0))._message}catch(r){if(n&&r.data&&r.data.code===Ix.ERR_PUBLISH_REQUEST_INVALID)return pk.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),r.toString()),await this.tryUnpubBeforeRepub(e,t),this.publish(e,t,!1);throw r}}async publishDataChannel(e,t,n){var r;if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new bk(jI.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const o={stream_id:t.streamId,ordered:t.ordered?1:0,max_retrans_times:null!==(r=t.maxRetransmits)&&void 0!==r?r:10,channel_id:t.channelId,metadata:t.metadata};try{await this.signal.request(kx.PUBLISH_DATASTREAM,o,!0)}catch(r){if(n&&r.data&&r.data.code===Ix.ERR_PUBLISH_REQUEST_INVALID)return pk.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),r.toString()),await this.tryUnpubDataChannelBeforeRepub(e,t),this.publishDataChannel(e,t,!1);throw r}}async unpublish(e,t){try{if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new bk(jI.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(kx.UNPUBLISH,{stream_id:t,ortc:e},!0)}catch(e){pk.warning("[".concat(this.store.clientId,"] unpublish warning: "),e)}}async unpublishDataChannel(e){try{if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new bk(jI.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await ih.all(e.map((e=>this.signal.request(kx.UNPUBLISH_DATASTREAM,{channel_id:e},!0))))}catch(e){pk.warning("unpublish datachannels warning: ",e)}}async presubscribe(e,t,n){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new bk(jI.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const r={stream_id:e,stream_type:t,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!UN("SUBSCRIBE_TWCC"),rtx:!!UN("USE_SUB_RTX")||void 0,extend:UN("SUB_EXTEND"),svc:Array.isArray(UN("SVC"))&&0!==UN("SVC").length?UN("SVC"):void 0};try{return await this.signal.request(kx.PRE_SUBSCRIBE,r,!0)}catch(r){if(n&&r.data&&r.data.code===Ix.ERR_SUBSCRIBE_REQUEST_INVALID)return pk.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),r.toString()),this.presubscribe(e,t,!1);throw r}}async subscribe(e,t,n){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new bk(jI.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const r={stream_id:e,stream_type:t.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!UN("SUBSCRIBE_TWCC"),rtx:!!UN("USE_SUB_RTX"),extend:UN("SUB_EXTEND"),ssrcId:t.ssrcId,svc:Array.isArray(UN("SVC"))&&0!==UN("SVC").length?UN("SVC"):void 0};try{return(await this.signal.request(kx.SUBSCRIBE,r,!0))._message}catch(r){if(n&&r.data&&r.data.code===Ix.ERR_SUBSCRIBE_REQUEST_INVALID)return pk.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),r.toString()),await this.tryUnsubBeforeResub(e,t),await this.subscribe(e,t,!1);throw r}}async subscribeDataChannel(e,t,n){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new bk(jI.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const r={uid:e,stream_id:t.id,channel_id:t.datachannelId};try{return void await this.signal.request(kx.SUBSCRIBE_DATASTREAM,r,!0)}catch(r){if(n&&r.data&&r.data.code===Ix.ERR_SUBSCRIBE_REQUEST_INVALID)return pk.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),r.toString()),await this.tryUnsubDataChannelBeforeResub(e,t),await this.subscribeDataChannel(e,t,!1);throw r}}async subscribeAll(e,t){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new bk(jI.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const n={p2p_id:this.store.p2pId,users:e,dtx:!1,rtx:!!UN("USE_SUB_RTX"),twcc:!!UN("SUBSCRIBE_TWCC"),svc:Array.isArray(UN("SVC"))&&0!==UN("SVC").length?UN("SVC"):void 0};try{return await this.signal.request(kx.SUBSCRIBE_STREAMS,n,!0)}catch(n){if(t&&n.data&&n.data.code===Ix.ERR_SUBSCRIBE_REQUEST_INVALID)return pk.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),n.toString()),await this.tryMassUnsubBeforeResub(e),await this.subscribeAll(e,!1);throw n}}async setVideoProfile(e){const t=function(e){if(!(e.bitrateMax&&e.bitrateMin&&e.frameRate&&e.height&&e.width))return;let t=e.frameRate,n=e.width,r=e.height,o=!0;return"number"!=typeof t&&(t=t.exact||t.ideal||t.max||t.min||0,t||(o=!1)),"number"!=typeof n&&(n=n.exact||n.ideal||n.max||n.min||0,n||(o=!1)),"number"!=typeof r&&(r=r.exact||r.ideal||r.max||r.min||0,t||(o=!1)),o?{stream_type:0,width:n,height:r,fps:t,start_bps:1e3*e.bitrateMax,min_bps:1e3*e.bitrateMin,target_bps:1e3*e.bitrateMax}:void 0}(e);if(t)return this.signal.request(kx.SET_VIDEO_PROFILE,t);pk.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(e,t){try{await this.signal.request(kx.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:e,stream_id:t},!0)}catch(e){pk.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),e)}}async unsubscribeDataChannel(e,t){try{if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new bk(jI.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await ih.all(e.map((e=>this.signal.request(kx.UNSUBSCRIBE_DATASTREAM,{stream_id:e,uid:t},!0))))}catch(e){pk.warning("unsubscribeDataChannel warning: ",e)}}async massUnsubscribe(e){try{await this.signal.request(kx.UNSUBSCRIBE_STREAMS,e,!0)}catch(e){pk.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),e)}}async reconnectPC(e){const{iceParameters:t,dtlsParameters:n,rtpCapabilities:r}=e;return{gatewayEstablishParams:await this.signal.request(kx.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:t,dtlsParameters:n,rtpCapabilities:r}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(kx.GATEWAY_INFO)}async renewToken(e){await this.signal.request(kx.RENEW_TOKEN,e),this.key=e.token}updateClientRole(e,t){t&&(this._clientRoleOptions=Object.assign({},t)),UN("CLIENT_ROLE_OPTIONS")&&(pk.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(UN("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," ")),this._clientRoleOptions=Object.assign({},UN("CLIENT_ROLE_OPTIONS"))),this.role=e}async setClientRole(e,t){if(t&&(this._clientRoleOptions=Object.assign({},t)),UN("CLIENT_ROLE_OPTIONS")&&(this._clientRoleOptions=Object.assign({},UN("CLIENT_ROLE_OPTIONS")),pk.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(UN("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," "))),"CONNECTED"!==this.state)return void(this.role=e);let n,r=0;"audience"===e?this._clientRoleOptions&&this._clientRoleOptions.delay?(n=this._clientRoleOptions.delay,r=1):r=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:r=0,await this.signal.request(kx.SET_CLIENT_ROLE,{role:e,level:r,delay:n,client_ts:Date.now()}),this.role=e}async setRemoteVideoStreamType(e,t){await this.signal.request(kx.SWITCH_VIDEO_STREAM,{stream_id:e,stream_type:t})}async setDefaultRemoteVideoStreamType(e){await this.signal.request(kx.DEFAULT_VIDEO_STREAM,{stream_type:e})}async setStreamFallbackOption(e,t){await this.signal.request(kx.SET_FALLBACK_OPTION,{stream_id:e,fallback_type:t})}async pickSVCLayer(e,t){await this.signal.request(kx.PICK_SVC_LAYER,{stream_id:e,spatial_layer:t.spatialLayer,temporal_layer:t.temporalLayer})}async setRTM2Flag(e){await this.signal.request(kx.SET_RTM2_FLAG,{rtm2_flag:e})}async sendExtensionMessage(e,t,n){if(this.store.useP2P)return this.signal.sendExtensionMessage(e,t,n)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),qj({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(kx.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const e=Kj.get(this.joinInfo.cname);e&&e.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const e=function(e){let t;return t=e.startsWith("dc")?e.match(/(dc\:\/\/)?([^:]+):(\d+)/):e.match(/(wss\:\/\/)?([^:]+):(\d+)/),t?{username:NN.username,password:NN.password,turnServerURL:t[2],tcpport:parseInt(t[3])+30,udpport:parseInt(t[3])+30,forceturn:!1}:null}(("disabled"===this.joinInfo.cloudProxyServer?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],e&&"off"!==this.joinInfo.turnServer.mode&&"disabled"===this.joinInfo.cloudProxyServer&&this.joinInfo.turnServer.serversFromGateway.push(qj(qj({},NN),{},{turnServerURL:e.turnServerURL,tcpport:e.tcpport,udpport:e.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if("CONNECTED"!==this.state)return;const e=await this.signal.request(kx.TRAFFIC_STATS,void 0,!0);e.timestamp=Date.now(),null!=e.ntp_offset&&(this.ntpOffset=e.ntp_offset),e.peer_delay.forEach((e=>{const t=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find((t=>t.peer_uid===e.peer_uid));t&&t.B_st!==e.B_st&&TA((()=>{this.emit(Qx.STREAM_TYPE_CHANGE,e.peer_uid,e.B_st)}))})),this._statsCollector.updateTrafficStats(e)}getJoinMessage(e){if(!this.joinInfo||!this.key)throw new bk(jI.UNEXPECTED_ERROR,"can not generate join message, no join info");const t=Object.assign({},this.joinInfo.apResponse);let n=UN("REPORT_APP_SCENARIO");if("string"!=typeof n)try{n=JSON.stringify(n)}catch(e){n=void 0}var r;n&&n.length>128&&(n=void 0),this.store.hasStartJoinChannel=!0,this.store.isABTestSuccess||this.emit(Qx.UPDATE_GATEWAY_CONFIG),r=this.store.clientId,Ur(jL).call(jL,r)||jL.push(r);const o=!(fI()||gI(87)||Rk())&&"boolean"==typeof UN("ENABLE_PRE_SUB")&&UN("ENABLE_PRE_SUB"),i=!Rk()&&jj("ENABLE_PREALLOC_PC","boolean"),a=Fj(),s=qj({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:wN,browser:navigator.userAgent,process_id:UN("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:t,extend:UN("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:"proxy3"===this.joinInfo.cloudProxyServer?"1":"proxy5"===this.joinInfo.cloudProxyServer?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:n,attributes:{userAttributes:qj({enableEncodedTransform:!!UN("ENABLE_AUDIO_METADATA")&&vI(87)||!!UN("ENABLE_AUDIO_TOPN")&&EI(nI.CHROME,87,116)||void 0,enableAudioMetadata:!!UN("ENABLE_AUDIO_METADATA")&&vI(87),topnSmoothLevel:UN("TOPN_SMOOTH_LEVEL"),topnNewSpeakerDelay:UN("TOPN_NEW_SPEAKER_DELAY"),topnSwitchHoldMs:UN("TOPN_SWITCH_HOLD_MS"),topnAudioGain:UN("TOPN_AUDIO_GAIN"),enablePublishedUserList:UN("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:UN("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:jj("SUBSCRIBE_AUDIO_FILTER_TOPN","number"),enablePublishAudioFilter:jj("ENABLE_PUBLISH_AUDIO_FILTER","boolean"),enableUserLicenseCheck:jj("ENABLE_USER_LICENSE_CHECK","boolean"),enableRTX:!0===UN("USE_PUB_RTX")||!0===UN("USE_SUB_RTX")||void 0,disableFEC:UN("DISABLE_FEC"),enableNTPReport:!!UN("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!UN("ENABLE_INSTANT_VIDEO")||void 0,enableFulllinkAvSync:!!UN("ENABLE_FULL_LINK_AV_SYNC")||void 0,enableDataStream2:jj("ENABLE_DATASTREAM_2","boolean"),enableAutFeedback:!!UN("ENABLE_AUT_FEEDBACK")||void 0,rtm2Flag:"number"==typeof this.joinInfo.rtmFlag?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!UN("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:jj("USE_XR","boolean"),enableLossbasedBwe:jj("ENABLE_LOSSBASED_BWE","boolean"),enableAutCC:!!UN("ENABLE_AUT_CC")||void 0,enableCCFallback:jj("ENABLE_CC_FALLBACK","boolean"),enablePreallocPC:i,preSubNum:o?jj("PRE_SUB_NUM","number"):void 0,enablePubTWCC:jj("PUBLISH_TWCC","boolean"),enableSubTWCC:jj("SUBSCRIBE_TWCC","boolean"),enablePubRTX:jj("USE_PUB_RTX","boolean"),enableSubRTX:jj("USE_SUB_RTX","boolean"),enableSubSVC:UN("ENABLE_SVC")?UN("ENABLE_SVC_DEFAULT_CODECS"):Array.isArray(UN("SVC"))&&0!==UN("SVC").length?UN("SVC"):void 0,enableSvcExtended:UN("ENABLE_SVC")&&Array.isArray(UN("SVC_EXTENDED"))&&0!==UN("SVC_EXTENDED").length?UN("SVC_EXTENDED"):void 0},a)},join_ts:this.joinGatewayStartTime},e);return this.joinInfo.stringUid&&(s.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(s.aes_mode=this.joinInfo.aesmode,UN("ENCRYPT_AES")?(s.aes_secret=this.joinInfo.aespassword,s.aes_encrypt=!0):s.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(s.aes_salt=this.joinInfo.aessalt)),t.addresses[this.signal.websocket.currentURLIndex]&&(s.ap_response.ticket=t.addresses[this.signal.websocket.currentURLIndex].ticket,delete t.addresses),void 0!==this.joinInfo.defaultVideoStream&&(s.default_video_stream=this.joinInfo.defaultVideoStream),s}getRejoinMessage(){if(!this.joinInfo)throw new bk(jI.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(Nx.WS_RECONNECT_CREATE_CONNECTION,(e=>{this.joinGatewayStartTime=Date.now()})),this.signal.on(Nx.WS_RECONNECTING,(e=>{this.joinInfo&&_k.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:e||pA.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",_k.sessionInit(this.joinInfo.sid,{lts:(new Date).getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:"live"===this.spec.mode?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:"audience"===this.role?2:1,buildFormat:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())})),this.signal.on(Nx.WS_CLOSED,(e=>{let t;switch(e){case sA.LEAVE:t=pA.LEAVE;break;case sA.UID_BANNED:case sA.IP_BANNED:case sA.CHANNEL_BANNED:case sA.SERVER_ERROR:t=pA.SERVER_ERROR;break;case sA.FALLBACK:t=pA.FALLBACK;break;case sA.LICENSE_MISSING:case sA.LICENSE_EXPIRED:case sA.LICENSE_MINUTES_EXCEEDED:case sA.LICENSE_PERIOD_INVALID:case sA.LICENSE_MULTIPLE_SDK_SERVICE:case sA.LICENSE_ILLEGAL:case sA.TOKEN_EXPIRE:t=e;break;default:t=pA.NETWORK_ERROR}pk.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(t||"undefined -> "+pA.NETWORK_ERROR)),this.joinInfo&&_k.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:e===sA.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:t}),this._disconnectedReason=e,e!==sA.FALLBACK&&(this.state="DISCONNECTED"),this.reset()})),this.signal.on(Nx.WS_CONNECTED,(()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo){if("audience"===this.role){const e=UN("CLIENT_ROLE_OPTIONS")||this._clientRoleOptions;e&&(e.level||e.delay)&&(pk.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(e.level,", delay: ").concat(e.delay)),this.setClientRole(this.role,e))}if(_k.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload,isABTestSuccess:this.store.isABTestSuccess}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&1===this.joinInfo.setLocalAPVersion){const e=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!e)return void pk.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(e));xN("EVENT_REPORT_DOMAIN",e[1]),xN("EVENT_REPORT_BACKUP_DOMAIN",e[1]),xN("LOG_UPLOAD_SERVER","".concat(e[1],":6444"))}}})),this.signal.on(Dx.ON_UPLINK_STATS,(e=>{this._statsCollector.updateUplinkStats(e)})),this.signal.on(Nx.REQUEST_RECOVER,((e,t,n)=>{if(!this.joinInfo)return n(new bk(jI.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));e&&(this.joinInfo.multiIP=e,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,mA(this,Qx.REQUEST_NEW_GATEWAY_LIST).then(t).catch(n)})),this.signal.on(Nx.REQUEST_JOIN_INFO,(async(e,t,n)=>{var r;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void e(this.getJoinMessage({ortc:{}}));const{iceParameters:o,dtlsParameters:i,rtpCapabilities:a}=await mA(this,Qx.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:null===(r=this.joinInfo)||void 0===r?void 0:r.turnServer});try{e(this.getJoinMessage({ortc:{iceParameters:o,dtlsParameters:i,rtpCapabilities:a,version:"2"}}))}catch(e){t(e)}})),this.signal.on(Nx.REQUEST_REJOIN_INFO,(e=>{e(this.getRejoinMessage())})),this.signal.on(Nx.REPORT_JOIN_GATEWAY,((e,t)=>{if(!this.joinInfo)return;let n,r="";var o;e instanceof bk?(n=(null===(o=e.data)||void 0===o?void 0:o.desc)||e.code,r=e.message):n=e,_k.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:n,errorMsg:r,addr:t,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload})})),this.signal.on(Nx.IS_P2P_DISCONNECTED,(e=>{e(EA(this,Qx.IS_P2P_DISCONNECTED))})),this.signal.on(Nx.DISCONNECT_P2P,(()=>{this.emit(Qx.DISCONNECT_P2P)})),this.signal.on(Nx.REQUEST_SUCCESS,(()=>{this._signalTimeout=!1})),this.signal.on(Nx.REQUEST_TIMEOUT,(()=>{this._signalTimeout=!0})),this.signal.on(Nx.JOIN_RESPONSE,(e=>{const t=this.getCurrentGatewayAddress();this.emit(Qx.JOIN_RESPONSE,e,t)})),this.signal.on(Nx.PRE_CONNECT_PC,(async()=>{if(this.joinInfo){this.updateTurnConfigFromSignal();const e=this.getCurrentGatewayAddress(),t=UN("FINGERPRINT")||this.joinInfo.apResponse.addresses[this.signal.currentURLIndex].fingerprint;if(e&&t){const n=gj(e);this.emit(Qx.PRE_CONNECT_PC,{candidates:n,fingerprint:t})}}})),this.signal.on(Nx.RECOVER_NOTIFICATION,(e=>{this.joinInfo&&"string"==typeof UN("AP_REQUEST_DETAIL")&&(this.joinInfo.apRequestDetail="".concat(UN("AP_REQUEST_DETAIL"),";").concat(e))}))}async tryUnsubBeforeResub(e,t){try{await this.signal.request(kx.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:e,ortc:[t]},!0)}catch(e){throw pk.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),e),e}}async tryUnsubDataChannelBeforeResub(e,t){try{await this.signal.request(kx.UNSUBSCRIBE,{stream_id:t.id},!0)}catch(e){throw pk.warning("unsubscribe datachannel warning",e),e}}async tryUnpubBeforeRepub(e,t){try{await this.signal.request(kx.UNPUBLISH,{stream_id:e,ortc:t},!0)}catch(e){throw pk.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),e),e}}async tryUnpubDataChannelBeforeRepub(e,t){try{await this.signal.request(kx.UNPUBLISH_DATASTREAM,{channnel_id:t.channelId},!0)}catch(e){throw pk.warning("unpublish datastream warning: ",e),e}}async tryMassUnsubBeforeResub(e){const t={users:e.map((e=>({stream_id:e.stream_id,stream_type:e.stream_type})))};try{await this.signal.request(kx.UNSUBSCRIBE_STREAMS,t,!0)}catch(e){throw pk.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),e),e}}async muteLocal(e,t){const n={action:e.find((e=>e.stream_type===Zx.Audio))?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:t};try{await this.signal.request(kx.CONTROL,n,!0,!0)}catch(e){throw pk.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),e),e}}async unmuteLocal(e,t){const n={action:e.find((e=>e.stream_type===Zx.Audio))?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:t};try{await this.signal.request(kx.CONTROL,n,!0,!0)}catch(e){throw pk.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),e),e}}async muteRemote(e,t){const n={action:e===lU.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:t};try{await this.signal.request(kx.CONTROL,n,!0,!0)}catch(e){throw pk.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),e),e}}async unmuteRemote(e,t){const n={action:e===lU.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:t};try{await this.signal.request(kx.CONTROL,n,!0,!0)}catch(e){throw pk.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),e),e}}uploadWRTCStats(e){this.signal.uploadWRTCStats(e)}upload(e,t){this.signal.upload(e,t)}getSignalRTT(){return this.signal.rtt}async restartICE(e){const t={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:e};try{return await this.signal.request(kx.RESTART_ICE,t,!0)}catch(e){throw pk.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),e),e}}reconnect(e,t){"CONNECTED"===this.state&&this.signal.reconnect(e||void 0,t||pA.P2P_FAILED)}getCurrentGatewayAddress(){var e,t;if(!UN("GATEWAY_WSS_ADDRESS"))return UN("USE_CANDIDATE_FROM_AP_DETAIL")&&null!==(e=this.joinInfo)&&void 0!==e&&e.apGatewayAddress?(pk.debug("[".concat(this.store.clientId,"] use candidate from ap detail, ").concat(JSON.stringify(this.joinInfo.apGatewayAddress))),this.joinInfo.apGatewayAddress):null!==(t=this.joinInfo)&&void 0!==t&&t.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(e){await this.signal.request(kx.SET_PARAMETER,{enablePublishAudioFilter:e})}}let zj=0,Xj=0;function Jj(e,t,n,r){return new ih(((o,i)=>{t.timeout=t.timeout||UN("HTTP_CONNECT_TIMEOUT"),t.responseType=t.responseType||"json",t.data&&!n?(t.data=JSON.stringify(t.data),zj+=kA(t.data)):n&&(t.data.size?zj+=t.data.size:t.data instanceof FormData?zj+=PA(t.data):zj+=kA(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,Xw.request(t).then((e=>{"string"==typeof e.data?Xj+=kA(e.data):e.data instanceof ArrayBuffer||e.data instanceof Uint8Array?Xj+=e.data.byteLength:Xj+=kA(JSON.stringify(e.data)),r&&o({data:e.data,headers:e.headers}),o(e.data)})).catch((e=>{Xw.isCancel(e)?i(new bk(jI.OPERATION_ABORTED,"cancel token canceled")):"ECONNABORTED"===e.code?i(new bk(jI.NETWORK_TIMEOUT,e.message)):e.response?i(new bk(jI.NETWORK_RESPONSE_ERROR,e.response.status)):i(new bk(jI.NETWORK_ERROR,e.message))}))}))}!function(){var e;function t(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var n,r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},i=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof o&&o];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function a(e,t){if(t)e:{var n=i;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];if(!(a in n))break e;n=n[a]}(t=t(o=n[e=e[e.length-1]]))!=o&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function s(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function c(e){var n="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return n?n.call(e):{next:t(e)}}if(a("Symbol",(function(e){function t(e,t){this.A=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.A};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",o=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+o++,r)}})),a("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var n="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<n.length;o++){var a=i[n[o]];"function"==typeof a&&"function"!=typeof a.prototype[e]&&r(a.prototype,e,{configurable:!0,writable:!0,value:function(){return s(t(this))}})}return e})),"function"==typeof Object.setPrototypeOf)n=Object.setPrototypeOf;else{var l;e:{var u={};try{u.__proto__={a:!0},l=u.a;break e}catch(e){}l=!1}n=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var d=n;function p(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function h(e){if(e.m)throw new TypeError("Generator is already running");e.m=!0}function f(e,t){return e.h=3,{value:t}}function m(e){this.g=new p,this.G=e}function v(e,t,n,r){try{var o=t.call(e.g.j,n);if(!(o instanceof Object))throw new TypeError("Iterator result "+o+" is not an object");if(!o.done)return e.g.m=!1,o;var i=o.value}catch(t){return e.g.j=null,e.g.s(t),g(e)}return e.g.j=null,r.call(e.g,i),g(e)}function g(e){for(;e.g.h;)try{var t=e.G(e.g);if(t)return e.g.m=!1,{value:t.value,done:!1}}catch(t){e.g.v=void 0,e.g.s(t)}if(e.g.m=!1,e.g.l){if(t=e.g.l,e.g.l=null,t.F)throw t.D;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function E(e){this.next=function(t){return e.o(t)},this.throw=function(t){return e.s(t)},this.return=function(t){return function(e,t){h(e.g);var n=e.g.j;return n?v(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),g(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function y(e,t){return t=new E(new m(t)),d&&e.prototype&&d(t,e.prototype),t}if(p.prototype.o=function(e){this.v=e},p.prototype.s=function(e){this.l={D:e,F:!0},this.h=this.C||this.u},p.prototype.return=function(e){this.l={return:e},this.h=this.u},m.prototype.o=function(e){return h(this.g),this.g.j?v(this,this.g.j.next,e,this.g.o):(this.g.o(e),g(this))},m.prototype.s=function(e){return h(this.g),this.g.j?v(this,this.g.j.throw,e,this.g.o):(this.g.s(e),g(this))},a("Array.prototype.entries",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,o={next:function(){if(!r&&n<e.length){var o=n++;return{value:t(o,e[o]),done:!1}}return r=!0,{done:!0,value:void 0}}};return o[Symbol.iterator]=function(){return o},o}(this,(function(e,t){return[e,t]}))}})),"undefined"!=typeof Blob&&("undefined"==typeof FormData||!FormData.prototype.keys)){var _=function(e,t){for(var n=0;n<e.length;n++)t(e[n])},b=function(e){return e.replace(/\r?\n|\r/g,"\r\n")},T=function(e,t,n){return t instanceof Blob?(n=void 0!==n?String(n+""):"string"==typeof t.name?t.name:"blob",t.name===n&&"[object Blob]"!==Object.prototype.toString.call(t)||(t=new File([t],n)),[String(e),t]):[String(e),String(t)]},S=function(e,t){if(e.length<t)throw new TypeError(t+" argument required, but only "+e.length+" present.")},O="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:this,R=O.FormData,C=O.XMLHttpRequest&&O.XMLHttpRequest.prototype.send,w=O.Request&&O.fetch,I=O.navigator&&O.navigator.sendBeacon,A=O.Element&&O.Element.prototype,N=O.Symbol&&Symbol.toStringTag;N&&(Blob.prototype[N]||(Blob.prototype[N]="Blob"),"File"in O&&!File.prototype[N]&&(File.prototype[N]="File"));try{new File([],"")}catch(e){O.File=function(e,t,n){return e=new Blob(e,n||{}),Object.defineProperties(e,{name:{value:t},lastModified:{value:+(n&&void 0!==n.lastModified?new Date(n.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),N&&Object.defineProperty(e,N,{value:"File"}),e}}var k=function(e){return e.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},P=function(e){this.i=[];var t=this;e&&_(e.elements,(function(e){if(e.name&&!e.disabled&&"submit"!==e.type&&"button"!==e.type&&!e.matches("form fieldset[disabled] *"))if("file"===e.type){var n=e.files&&e.files.length?e.files:[new File([],"",{type:"application/octet-stream"})];_(n,(function(n){t.append(e.name,n)}))}else"select-multiple"===e.type||"select-one"===e.type?_(e.options,(function(n){!n.disabled&&n.selected&&t.append(e.name,n.value)})):"checkbox"===e.type||"radio"===e.type?e.checked&&t.append(e.name,e.value):(n="textarea"===e.type?b(e.value):e.value,t.append(e.name,n))}))};if((e=P.prototype).append=function(e,t,n){S(arguments,2),this.i.push(T(e,t,n))},e.delete=function(e){S(arguments,1);var t=[];e=String(e),_(this.i,(function(n){n[0]!==e&&t.push(n)})),this.i=t},e.entries=function e(){var t,n=this;return y(e,(function(e){if(1==e.h&&(t=0),3!=e.h)return t<n.i.length?e=f(e,n.i[t]):(e.h=0,e=void 0),e;t++,e.h=2}))},e.forEach=function(e,t){S(arguments,1);for(var n=c(this),r=n.next();!r.done;r=n.next()){var o=c(r.value);r=o.next().value,o=o.next().value,e.call(t,o,r,this)}},e.get=function(e){S(arguments,1);var t=this.i;e=String(e);for(var n=0;n<t.length;n++)if(t[n][0]===e)return t[n][1];return null},e.getAll=function(e){S(arguments,1);var t=[];return e=String(e),_(this.i,(function(n){n[0]===e&&t.push(n[1])})),t},e.has=function(e){S(arguments,1),e=String(e);for(var t=0;t<this.i.length;t++)if(this.i[t][0]===e)return!0;return!1},e.keys=function e(){var t,n,r,o=this;return y(e,(function(e){if(1==e.h&&(t=c(o),n=t.next()),3!=e.h)return n.done?void(e.h=0):(r=n.value,f(e,c(r).next().value));n=t.next(),e.h=2}))},e.set=function(e,t,n){S(arguments,2),e=String(e);var r=[],o=T(e,t,n),i=!0;_(this.i,(function(t){t[0]===e?i&&(i=!r.push(o)):r.push(t)})),i&&r.push(o),this.i=r},e.values=function e(){var t,n,r,o,i=this;return y(e,(function(e){if(1==e.h&&(t=c(i),n=t.next()),3!=e.h)return n.done?void(e.h=0):(r=n.value,(o=c(r)).next(),f(e,o.next().value));n=t.next(),e.h=2}))},P.prototype._asNative=function(){for(var e=new R,t=c(this),n=t.next();!n.done;n=t.next()){var r=c(n.value);n=r.next().value,r=r.next().value,e.append(n,r)}return e},P.prototype._blob=function(){var e="----formdata-polyfill-"+Math.random(),t=[],n="--"+e+'\r\nContent-Disposition: form-data; name="';return this.forEach((function(e,r){return"string"==typeof e?t.push(n+k(b(r))+'"\r\n\r\n'+b(e)+"\r\n"):t.push(n+k(b(r))+'"; filename="'+k(e.name)+'"\r\nContent-Type: '+(e.type||"application/octet-stream")+"\r\n\r\n",e,"\r\n")})),t.push("--"+e+"--"),new Blob(t,{type:"multipart/form-data; boundary="+e})},P.prototype[Symbol.iterator]=function(){return this.entries()},P.prototype.toString=function(){return"[object FormData]"},A&&!A.matches&&(A.matches=A.matchesSelector||A.mozMatchesSelector||A.msMatchesSelector||A.oMatchesSelector||A.webkitMatchesSelector||function(e){for(var t=(e=(this.document||this.ownerDocument).querySelectorAll(e)).length;0<=--t&&e.item(t)!==this;);return-1<t}),N&&(P.prototype[N]="FormData"),C){var D=O.XMLHttpRequest.prototype.setRequestHeader;O.XMLHttpRequest.prototype.setRequestHeader=function(e,t){D.call(this,e,t),"content-type"===e.toLowerCase()&&(this.B=!0)},O.XMLHttpRequest.prototype.send=function(e){e instanceof P?(e=e._blob(),this.B||this.setRequestHeader("Content-Type",e.type),C.call(this,e)):C.call(this,e)}}w&&(O.fetch=function(e,t){return t&&t.body&&t.body instanceof P&&(t.body=t.body._blob()),w.call(this,e,t)}),I&&(O.navigator.sendBeacon=function(e,t){return t instanceof P&&(t=t._asNative()),I.call(this,e,t)}),O.FormData=P}}();const Zj=()=>{const e=UN("AREAS");return 0===e.length&&e.push(tU.GLOBAL),so(e).call(e,((e,t,n)=>{const r=Qj(t);return r?0===n?r:"".concat(e,",").concat(r):e}),"")},Qj=e=>e===tU.OVERSEA?"".concat(rU.ASIA,",").concat(rU.EUROPE,",").concat(rU.AFRICA,",").concat(rU.NORTH_AMERICA,",").concat(rU.SOUTH_AMERICA,",").concat(rU.OCEANIA):rU[e],$j={GLOBAL:{ASIA:[tU.CHINA,tU.JAPAN,tU.INDIA,tU.KOREA,tU.HKMC],EUROPE:[],NORTH_AMERICA:[tU.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},eF=Object.keys($j[tU.GLOBAL]),tF=[tU.CHINA,tU.NORTH_AMERICA,tU.EUROPE,tU.ASIA,tU.JAPAN,tU.INDIA,tU.OCEANIA,tU.SOUTH_AMERICA,tU.AFRICA,tU.KOREA,tU.HKMC,tU.US],nF=function(e,t){let n=[];if(Ur(e).call(e,tU.GLOBAL)){const i=[tU.GLOBAL,tU.OVERSEA],a=Object.keys(oU);if(t===tU.GLOBAL)throw new bk(jI.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(t===tU.CHINA)n=[tU.OVERSEA];else if(o=t,Ur(eF).call(eF,o)){const e=(r=t,$j[tU.GLOBAL][r]||[]),o=[...i,t,...e];n=a.filter((e=>!Ur(o).call(o,e)))}else if(function(e){let t=!1;return eF.forEach((n=>{var r;Ur(r=$j[tU.GLOBAL][n]).call(r,e)&&(t=!0)})),t}(t)){const e=function(e){let t;return eF.forEach((n=>{var r;Ur(r=$j[tU.GLOBAL][n]).call(r,e)&&(t=n)})),t}(t),r=[...i,e,t];n=a.filter((e=>!Ur(r).call(r,e)))}else n=e;n=function(e){const t=[];return tF.forEach((n=>{Ur(e).call(e,n)&&t.push(n)})),t.concat(e.filter((e=>!Ur(tF).call(tF,e))))}(n)}else n=e;var r,o;return n};function rF(e){var t,n;if(!e&&Ur(t=UN("AREAS")).call(t,tU.EXTENSIONS))return pk.debug("update area from ap : reset"),void oF(LL,!0);if(!Ur(n=UN("AREAS")).call(n,tU.GLOBAL)||!e)return;let r=oU.EXTENSIONS;r&&(r={CODE:Qj(tU.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(e,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(e,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(e,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(e,".agora.io"),"cds-ap-web-2-".concat(e,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(e,".agora.io"),"sua-ap-web-2-".concat(e,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(e,".agora.io"),"uap-ap-web-2-".concat(e,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(e,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(e,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(e,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(e,".agora.io")]},pk.debug("update area from ap success: ".concat(e,",config is "),r),xN("AREAS",[tU.EXTENSIONS],!0),Object.keys(r).map((e=>{xN(e,"LOG_UPLOAD_SERVER"===e||"EVENT_REPORT_DOMAIN"===e||"EVENT_REPORT_BACKUP_DOMAIN"===e||"PROXY_SERVER_TYPE3"===e?r[e][0]:r[e])})))}function oF(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=_k.reportApiInvoke(null,{name:rA.SET_AREA,options:e,tag:oA.TRACER});try{let r=[];if("string"==typeof e&&(r=[e]),Array.isArray(e)&&(e.forEach((e=>{if(!Ur(nU).call(nU,e))throw new bk(jI.INVALID_PARAMS,"invalid area code")})),r=e),"[object Object]"===Object.prototype.toString.call(e)){const{areaCode:t,excludedArea:n}=e;if(!t)throw new bk(jI.INVALID_PARAMS,"area code is needed");let o=t;"string"==typeof t&&(o=[t]),r=n?nF(o,n):o}if(!t){if(FN.AREAS){const e=new bk(jI.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return n.onError(e),void pk.warning("setArea is prohibited because of config-distribute")}if(Ur(r).call(r,tU.GLOBAL)&&UN("AREAS")===tU.EXTENSIONS){const e=new bk(jI.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return n.onError(e),void pk.warning("setArea is prohibited because of ap extensions")}}xN("AREAS",r,t);const o=(e=>{const t={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return e.map((e=>{const n=oU[e],r=Object.keys(n);r&&r.map((e=>{"CODE"!==e&&(t[e]=t[e].concat(n[e]))}))})),t})(r);Object.keys(o).map((e=>{xN(e,"LOG_UPLOAD_SERVER"===e||"EVENT_REPORT_DOMAIN"===e||"EVENT_REPORT_BACKUP_DOMAIN"===e||"PROXY_SERVER_TYPE3"===e?o[e][0]:o[e])})),pk.debug("set area success:",r.join(","))}catch(e){throw n.onError(e),e}n.onSuccess()}function iF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function aF(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iF(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iF(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let sF=1;function cF(e,t,n,r,o){sF+=1;const i={sid:n.sid,command:"convergeAllocateEdge",uid:"666",appId:n.appId,ts:Math.floor(Date.now()/1e3),seq:sF,requestId:sF,version:wN,cname:n.cname},a={service_name:t,json_body:JSON.stringify(i)};let s,c,l=e[0];return ZA((async()=>{s=Date.now();const e=await Jj(l,{data:a,cancelToken:r,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(c=Date.now()-s,0!==e.code){const t=new bk(jI.UNEXPECTED_RESPONSE,"live streaming ap error, code"+e.code,{retry:!0,responseTime:c});throw pk.error(t.toString()),t}const n=JSON.parse(e.json_body);if(200!==n.code){const e=new bk(jI.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(n.code,", reason: ").concat(n.reason),{code:n.code,responseTime:c});throw pk.error(e.toString()),e}if(!n.servers||0===n.servers.length){const e=new bk(jI.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:n.code,responseTime:c});throw pk.error(e.toString()),e}const o=function(e,t){return{addressList:e.servers.map((e=>"wss://".concat(e.address.replace(/\./g,"-"),".").concat(UN("WORKER_DOMAIN"),":").concat(e.wss,"?serviceName=").concat(encodeURIComponent(t)))),workerToken:e.workerToken,vid:e.vid}}(n,t);return UN("LIVE_STREAMING_ADDRESS")&&(o.addressList=UN("LIVE_STREAMING_ADDRESS")instanceof Array?UN("LIVE_STREAMING_ADDRESS"):[UN("LIVE_STREAMING_ADDRESS")]),aF(aF({},o),{},{responseTime:c})}),((r,o)=>(_k.apworkerEvent(n.sid,{success:!0,sc:200,serviceName:t,responseDetail:JSON.stringify(r.addressList),firstSuccess:0===o,responseTime:c,serverIp:e[o%e.length]}),!1)),((r,o)=>(_k.apworkerEvent(n.sid,{success:!1,sc:r.data&&r.data.code||200,serviceName:t,responseTime:c,serverIp:e[o%e.length]}),!!(r.code!==jI.OPERATION_ABORTED&&r.code!==jI.UNEXPECTED_RESPONSE||r.data&&r.data.retry)&&(l=e[(o+1)%e.length],!0))),o)}let lF=1;function uF(e,t,n,r){let{url:o,areaCode:i}=e;const{clientId:a,sid:s}=t,c=Date.now();let l;const u=t.role,[d,p]=mF(t,i,[YU.CHOOSE_SERVER]);let h=yA.networkState;return ZA((async()=>{h&&yA.networkState===hA.OFFLINE&&yA.onlineWaiter&&await ih.race([yA.onlineWaiter,MA(r&&r.maxRetryTimeout||XA.maxRetryTimeout)]),h=yA.networkState;const{data:e,headers:i}=await Jj(o,{data:d,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);l="1"===i.http3?1:-1,_k.reportResourceTiming(o,s),pF(e,o,t,c,[YU.CHOOSE_SERVER],l);const a=tj(e,YU.CHOOSE_SERVER);return hF(a),ZU(a,o)}),(e=>(e&&_k.joinChooseServer(s,{role:u,lts:c,succ:!0,csAddr:o,opid:p,serverList:e.gatewayAddrs.map((e=>e.address)),ec:null,cid:e.cid.toString(),uid:e.uid.toString(),csIp:e.csIp,unilbsServerIds:[YU.CHOOSE_SERVER].toString(),isHttp3:l,corssRegionTagReq:t.apRequestDetail,corssRegionTagRes:e.res.detail&&e.res.detail[38]}),!1)),(e=>e.code!==jI.OPERATION_ABORTED&&(e.code===jI.CAN_NOT_GET_GATEWAY_SERVER?e.data.retry:(_k.joinChooseServer(s,{role:u,lts:c,succ:!1,csAddr:o,serverList:null,opid:p,ec:e.code,csIp:e.data&&e.data.csIp,unilbsServerIds:[YU.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:h}),isHttp3:l,corssRegionTagReq:t.apRequestDetail}),pk.warning("[".concat(a||"sid-".concat(s.slice(0,6)),"] Choose server network error, retry"),e),!0))),r)}function dF(e,t,n,r){let o,{url:i,areaCode:a,serviceIds:s}=e;const c=Date.now(),l=t.role,[u,d]=mF(t,a,s);let p;return ZA((async()=>{p&&yA.networkState===hA.OFFLINE&&yA.onlineWaiter&&await ih.race([yA.onlineWaiter,MA(r&&r.maxRetryTimeout||XA.maxRetryTimeout)]),p=yA.networkState;const{data:e,headers:a}=await Jj(i,{data:u,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);o="1"===a.http3?1:-1,_k.reportResourceTiming(i,t.sid),pF(e,i,t,c,s,o);const l=tj(e,YU.CHOOSE_SERVER),d=tj(e,"proxy5"===t.cloudProxyServer?YU.CLOUD_PROXY_5:"proxy3"===t.cloudProxyServer||"proxy4"===t.cloudProxyServer?YU.CLOUD_PROXY:YU.CLOUD_PROXY_FALLBACK);return hF(l),{gatewayInfo:ZU(l,i),proxyInfo:d,url:i}}),(e=>(e.gatewayInfo&&_k.joinChooseServer(t.sid,{role:l,lts:c,succ:!0,csAddr:i,serverList:e.gatewayInfo.gatewayAddrs.map((e=>e.address)),ec:null,opid:d,cid:e.gatewayInfo.cid.toString(),uid:e.gatewayInfo.uid.toString(),csIp:e.gatewayInfo.csIp,unilbsServerIds:s.toString(),isHttp3:o,corssRegionTagReq:t.apRequestDetail,corssRegionTagRes:e.gatewayInfo.res.detail&&e.gatewayInfo.res.detail[38]}),e.proxyInfo&&_k.joinWebProxyAP(t.sid,{lts:c,sucess:1,apServerAddr:i,turnServerAddrList:e.proxyInfo.addresses.map((e=>e.ip)).join(","),errorCode:null,eventType:t.cloudProxyServer,unilbsServerIds:s.toString()}),!1)),(e=>e.code!==jI.OPERATION_ABORTED&&(e.code===jI.CAN_NOT_GET_GATEWAY_SERVER?e.data.retry:(_k.joinWebProxyAP(t.sid,{lts:c,sucess:0,apServerAddr:i,turnServerAddrList:null,errorCode:e.code,eventType:t.cloudProxyServer,unilbsServerIds:s.toString(),extend:JSON.stringify({networkState:p})}),pk.warning("[".concat(t.clientId,"] multi unilbs network error, retry"),e),!0))),r)}const pF=(e,t,n,r,o,i)=>{const{sid:a,clientId:s,cloudProxyServer:c}=n,l=[],u=s=>{4096===s.flag?_k.joinChooseServer(a,{role:n.role,lts:r,succ:!1,csAddr:t,opid:e.opid,serverList:null,ec:s.error.message,csIp:s.error.data&&s.error.data.csIp,unilbsServerIds:o.toString(),isHttp3:i,corssRegionTagReq:n.apRequestDetail}):1048576!==s.flag&&4194304!==s.flag&&4194310!==s.flag||_k.joinWebProxyAP(a,{lts:r,sucess:0,apServerAddr:t,turnServerAddrList:null,errorCode:s.error.code,eventType:c,unilbsServerIds:o.toString()})};if(e.response_body.forEach((t=>{const n=t.buffer.code;if(23===t.uri&&0===n&&!t.buffer.edges_services)if(4194310===t.buffer.flag)pk.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),t.buffer.edges_services=[];else{const n={error:new bk(jI.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:e.detail[502]}),flag:t.buffer.flag};l.push(n),u(n)}if(0!==n){const r=AU(n),o={error:new bk(jI.CAN_NOT_GET_GATEWAY_SERVER,r.desc,{desc:r.desc,retry:r.retry,csIp:e.detail[502]}),flag:t.buffer.flag};4194310===t.buffer.flag?pk.warning(o.error.toString()):l.push(o),u(o)}})),l.length)throw pk.warning("[".concat(s||"sid-".concat(a.slice(0,6)),"] multi unilbs ").concat(t," failed, ").concat(l.map((e=>"flag: ".concat(e.flag,", message: ").concat(e.error.message,", retry: ").concat(e.error.data.retry))).join(" | "))),new bk(jI.CAN_NOT_GET_GATEWAY_SERVER,l.map((e=>"flag: ".concat(e.flag,", message: ").concat(e.error.message))).join(" | "),{retry:!!l.find((e=>e.error.data.retry)),csIp:e.detail[502],desc:[...new Set(l.map((e=>{var t;return null==e||null===(t=e.error)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.desc})).filter((e=>!!e)))]})},hF=e=>{var t,n,r,o;if(e.addresses&&0===e.addresses.length&&0===e.code)throw new bk(jI.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:e.detail&&e.detail[502]});if(UN("AP_AREA")&&(null!==(r=e.detail)&&void 0!==r&&r[23]&&"string"==typeof(null===(o=e.detail)||void 0===o?void 0:o[23])?rF(e.detail[23].toLowerCase()):rF()),null!==(t=e.detail)&&void 0!==t&&t[19]&&"string"==typeof(null===(n=e.detail)||void 0===n?void 0:n[19])){const t=e.detail[19],n=null==t?void 0:t.split(";");for(let r=0;r<n.length;r++){var i;const t=ny(i=n[r]).call(i);e.addresses[r]&&n&&(e.addresses[r].fingerprint=t)}}if(UN("GATEWAY_ADDRESS")&&UN("GATEWAY_ADDRESS").length>0){pk.debug("assign gateway address to",UN("GATEWAY_ADDRESS"));const t=UN("GATEWAY_ADDRESS").map((t=>{var n,r;const o=null!==(n=null===(r=e.addresses.find((e=>e.ip===t.ip&&e.port===t.port)))||void 0===r?void 0:r.fingerprint)&&void 0!==n?n:"";return{ip:t.ip,port:t.port,ticket:e.addresses[0]&&e.addresses[0].ticket,fingerprint:o}}));e.addresses=t}},fF=(e,t)=>{if(e.response_body&&e.response_body.length){const t=e.response_body[0];if(0!==t.buffer.code){const e=AU(t.buffer.code);throw new bk(jI.UPDATE_TICKET_FAILED,"[".concat(t.buffer.code,"]: ").concat(e.desc),{retry:e.retry})}return t.buffer.ticket}throw pk.debug("update ticket request received ap response without response body:",t),new bk(jI.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},mF=(e,t,n)=>{const r=Math.floor(Math.random()*10**12),o="host"===e.role?"1":"audience"===e.role?"2":void 0,i={appid:e.appId,client_ts:Date.now(),opid:r,sid:e.sid,request_bodies:[{uri:22,buffer:{cname:e.cname,detail:aF(aF(aF({6:e.stringUid,11:t,12:UN("USE_NEW_TOKEN")?"1":void 0},o?{17:o}:{}),{},{22:t},e.apRequestDetail?{33:e.apRequestDetail}:{}),e.apRTM?{26:"RTM2"}:{}),key:e.token,service_ids:n,uid:e.uid||0}}]};i.request_bodies.forEach((t=>{e.multiIP&&e.multiIP.gateway_ip&&(t.buffer.detail[5]=JSON.stringify({vocs_ip:[e.multiIP.uni_lbs_ip],vos_ip:[e.multiIP.gateway_ip]}))}));const a=new FormData;return a.append("request",JSON.stringify(i)),[a,r]},vF=(e,t)=>{const n=Math.floor(Math.random()*10**12),r={appid:e.appId,client_ts:Date.now(),opid:n,sid:e.sid,request_bodies:[{uri:28,buffer:{cname:e.cname,detail:{1:"",6:e.stringUid,12:"1"},token:e.token,service_ids:t,uid:e.uid||0,edges_services:e.apResponse.addresses.map((e=>({ip:e.ip,port:e.port})))}}]},o=new FormData;return o.append("request",JSON.stringify(r)),[o,n]};let gF=0;function EF(e){return ih.all(e.map((e=>e.then((e=>{throw e}),(e=>e))))).then((e=>{throw e}),(e=>e))}const yF=async e=>{let{fragementLength:t,referenceList:n,asyncMapHandler:r,allFailedhandler:o,promisesCollector:i}=e,a=0;const s=t;let c,l=0;const u=async()=>{const e=(()=>{const e=a*s,t=e+s;return n.slice(e,t).map(r)})();i&&i.push(...e);try{c=await EF(e)}catch(e){if(l+=s,a++,!(l>=n.length))return void await u();o(e)}e.forEach((e=>e.cancel()))};return await u(),c},_F=async e=>{let{referenceList:t,asyncMapHandler:n,closeFn:r}=e;const o=t.length;let i=0;const a=async()=>{const e=n(t.shift());try{return await e}catch(e){if(i++,i>=o||null!=r&&r(e))throw e;return a()}};return a()};async function bF(e,t,n,r){const o=async function(e,t,n,r){let o=null;const i=[],a=async()=>{const o=UN("WEBCS_DOMAIN").slice(0,UN("AJAX_REQUEST_CONCURRENT")).map((t=>({url:e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"),areaCode:Zj()}))),a=r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:o.map((e=>e.url))}),s=await yF({fragementLength:UN("FRAGEMENT_LENGTH"),referenceList:o,asyncMapHandler:r=>(pk.debug("[".concat(e.clientId,"] Connect to choose_server:"),r.url),uF(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},a),e[0]},promisesCollector:i});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},a),s},s=async()=>{if(await MA(1e3),null!==o)return o;const a=UN("WEBCS_DOMAIN_BACKUP_LIST").map((t=>({url:e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"),areaCode:Zj()}))),s=r.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:a.map((e=>e.url))}),c=await yF({fragementLength:UN("FRAGEMENT_LENGTH"),referenceList:a,asyncMapHandler:r=>(pk.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),r.url),uF(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},s),e[0]},promisesCollector:i});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},s),c};try{return o=await EF([a(),s()]),i.length&&i.forEach((e=>e.cancel&&"function"==typeof e.cancel&&e.cancel())),o}catch(e){throw e[0]}}(e,t,n,r);return{gatewayInfo:await o}}async function TF(e,t,n,r,o){const i=e.cloudProxyServer;if("disabled"===i){if(!r)return;if(e.useLocalAccessPoint)return await bF(e,t,n,o);if(UN("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:r,proxyInfo:i}=await wF(e,t,n,o);if(e.turnServer&&"auto"!==e.turnServer.mode)return{gatewayInfo:r};const s=i.map((e=>({turnServerURL:e.address,tcpport:e.tcpport||NN.tcpport,udpport:e.udpport||NN.udpport,username:e.username||NN.username,password:e.password||NN.password,forceturn:!1,security:!0})));if(o.useP2P){var a;const t=null!==(a=e.uid)&&void 0!==a?a:r.uid,n="glb:".concat(t.toString()),o=await $I(n),c=i.map((e=>({turnServerURL:e.address,tcpport:e.tcpport||NN.tcpport,udpport:e.udpport||NN.udpport,username:n,password:o,forceturn:!1,security:!0})));s.push(...c)}return e.turnServer={mode:"manual",servers:s},{gatewayInfo:r}}return await bF(e,t,n,o)}const{proxyInfo:s,gatewayInfo:c}=await wF(e,t,n,o),l={gatewayInfo:c},u=s.map((e=>({turnServerURL:e.address,tcpport:"proxy3"===i?void 0:e.tcpport?e.tcpport:NN.tcpport,udpport:"proxy4"===i?void 0:e.udpport?e.udpport:NN.udpport,username:e.username||NN.username,password:e.password||NN.password,forceturn:"proxy4"!==i,security:"proxy5"===i})));if(o.useP2P){var d;const t=null!==(d=e.uid)&&void 0!==d?d:c.uid,n="glb:".concat(t.toString()),r=await $I(n),o=s.map((e=>({turnServerURL:e.address,tcpport:"proxy3"===i?void 0:e.tcpport||NN.tcpport,udpport:"proxy4"===i?void 0:e.udpport||NN.udpport,username:n,password:r,forceturn:"proxy4"!==i,security:"proxy5"===i})));u.push(...o)}return e.turnServer={mode:"manual",servers:u},pk.debug("[".concat(e.clientId,"] set proxy server: ").concat(e.proxyServer,", mode: ").concat(i)),l}async function SF(e,t,n,r,o){const i=UN("ACCOUNT_REGISTER").slice(0,UN("AJAX_REQUEST_CONCURRENT"));let a=[];a=t.proxyServer?i.map((e=>"https://".concat(t.proxyServer,"/ap/?url=").concat(e+"/api/v1"))):i.map((e=>"https://".concat(e,"/api/v1")));const s=null==o?void 0:o.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:a});try{const i=await async function(e,t,n,r,o){const i=Date.now(),a={sid:n.sid,opid:10,appid:n.appId,string_uid:t};let s=e[0];const c=await ZA((()=>Jj(s+"".concat(-1===s.indexOf("?")?"?":"&","action=stringuid"),{data:a,cancelToken:r,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}})),((n,r)=>{if(0===n.code){if(n.uid<=0||n.uid>=Math.pow(2,32))throw pk.error("Invalid Uint Uid ".concat(t," => ").concat(n.uid),n),_k.reqUserAccount(a.sid,{lts:i,success:!1,serverAddr:s,stringUid:a.string_uid,uid:n.uid,errorCode:jI.INVALID_UINT_UID_FROM_STRING_UID,extend:a}),new bk(jI.INVALID_UINT_UID_FROM_STRING_UID);return _k.reqUserAccount(a.sid,{lts:i,success:!0,serverAddr:s,stringUid:a.string_uid,uid:n.uid,errorCode:null,extend:a}),!1}const o=AU(n.code);return o.retry&&(s=e[(r+1)%e.length]),_k.reqUserAccount(a.sid,{lts:i,success:!1,serverAddr:s,stringUid:a.string_uid,uid:n.uid,errorCode:o.desc,extend:a}),o.retry}),((t,n)=>t.code!==jI.OPERATION_ABORTED&&(_k.reqUserAccount(a.sid,{lts:i,success:!1,serverAddr:s,stringUid:a.string_uid,uid:null,errorCode:t.code,extend:a}),s=e[(n+1)%e.length],!0)),o);if(0!==c.code){const e=AU(c.code);throw new bk(jI.UNEXPECTED_RESPONSE,e.desc)}return c}(a,e,t,n,r);return null==o||o.recordJoinChannelService({status:"success",endTs:Date.now()},s),i.uid}catch(e){throw null==o||o.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[e]},s),e}}async function OF(e,t,n){const r=UN("ACCOUNT_REGISTER");let o=[];o=t.proxyServer?r.map((e=>"https://".concat(t.proxyServer,"/ap/?url=").concat(e+"/api/v1"))):r.map((e=>"https://".concat(e,"/api/v1")));try{const r=await _F({referenceList:o,asyncMapHandler:r=>async function(e,t,n,r){const o=Date.now(),i={sid:n.sid,opid:10,appid:n.appId,string_uid:t};try{const t=await Jj(e+"".concat(-1===e.indexOf("?")?"?":"&","action=stringuid"),{data:i,cancelToken:r,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(0!==t.code){const e=AU(t.code);throw new bk(jI.UNEXPECTED_RESPONSE,"preload sua error:".concat(e.desc),e)}if(t.uid<=0||t.uid>=Math.pow(2,32))throw new bk(jI.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:o,url:e,req:i,uid:t.uid,elapse:Date.now()-o}}catch(e){throw e}}(r,e,t,n),closeFn:e=>e.code===jI.OPERATION_ABORTED||e.code===jI.UNEXPECTED_RESPONSE&&!e.data.retry});return r}catch(e){throw e}}async function RF(e,t,n){const r=UN("CDS_AP").slice(0,UN("AJAX_REQUEST_CONCURRENT")).map((t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v1"):"https://".concat(t,"/api/v1?action=config"))),o=r.map((r=>function(e,t,n,r){const o=aI(),i={flag:64,cipher_method:0,features:aF(aF(aF(aF(aF({install_id:CN(),device:o.name,system:o.os,system_general:navigator.userAgent,vendor:t.appId,version:wN,cname:t.cname,session_id:t.sid,proxyServer:t.proxyServer,sdk_type:KU.WEB_RTC,browser_name:o.name,browser_version:o.version,user_agent:navigator.userAgent,channel_name:t.cname},t.stringUid&&{string_uid:t.stringUid}),t.uid&&{uid:t.uid+""}),o.os&&{os_name:o.os}),o.osVersion&&{os_version:o.osVersion}),{},{detail:""})};return ZA((()=>Jj(e,{data:i,timeout:1e3,cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}})),void 0,(e=>e.code!==jI.OPERATION_ABORTED),r)}(r,e,t,n)));let i=null,a=null,s={};try{i=await EF(o)}catch(e){if(e.code===jI.OPERATION_ABORTED)throw e;a=e}if(o.forEach((e=>e.cancel())),_k.reportApiInvoke(e.sid,{name:rA.REQUEST_CONFIG_DISTRIBUTE,options:{error:a,res:i}}).onSuccess(),i&&i.test_tags)try{s=function(e){if(!e.test_tags)return{};const t=e.test_tags,n=Object.keys(t),r={};return n.forEach((e=>{var n;const o=ny(n=e.slice(4)).call(n),i=JSON.parse(t[e]),a=i[1];r[o]={tag:i[0]||"",value:a}})),r}(i)}catch(e){}return s}async function CF(e,t){const n=UN("WEBCS_DOMAIN").concat(UN("WEBCS_DOMAIN_BACKUP_LIST")).map((e=>({url:"https://".concat(e,"/api/v2/transpond/webrtc?v=2"),areaCode:Zj(),serviceIds:[YU.CHOOSE_SERVER,YU.CLOUD_PROXY_FALLBACK]})));try{const r=await _F({referenceList:n,asyncMapHandler:n=>async function(e,t,n){let r,{url:o,areaCode:i,serviceIds:a}=e;const s=Date.now(),[c,l]=mF(t,i,a);let u=yA.networkState;try{u&&yA.networkState===hA.OFFLINE&&yA.onlineWaiter&&await ih.race([yA.onlineWaiter,MA(XA.maxRetryTimeout)]),u=yA.networkState;const{data:e,headers:t}=await Jj(o,{data:c,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);r="1"===t.http3?1:-1;const i=e=>{const t=[];if(e.response_body.forEach((n=>{const r=n.buffer.code;if(23===n.uri&&0===r&&!n.buffer.edges_services)if(4194310===n.buffer.flag)n.buffer.edges_services=[];else{const r={error:new bk(jI.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:e.detail[502]}),flag:n.buffer.flag};t.push(r)}if(0!==r){const o=AU(r),i={error:new bk(jI.CAN_NOT_GET_GATEWAY_SERVER,o.desc,{desc:o.desc,retry:o.retry,csIp:e.detail[502]}),flag:n.buffer.flag};4194310===n.buffer.flag?pk.warning(i.error.toString()):t.push(i)}})),t.length)throw new bk(jI.CAN_NOT_GET_GATEWAY_SERVER,t.map((e=>"flag: ".concat(e.flag,", message: ").concat(e.error.message))).join(" | "),{retry:!!t.find((e=>e.error.data.retry)),csIp:e.detail[502],desc:[...new Set(t.map((e=>{var t;return null==e||null===(t=e.error)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.desc})).filter((e=>!!e)))]})};i(e);const a=tj(e,YU.CHOOSE_SERVER),d=tj(e,YU.CLOUD_PROXY_FALLBACK);return hF(a),{gatewayInfo:ZU(a,o),proxyInfo:d,opid:l,requestTime:s,url:o,isHttp3:r,elapse:Date.now()-s}}catch(e){throw e}}(n,e,t),closeFn:e=>e.code===jI.OPERATION_ABORTED||e.code===jI.CAN_NOT_GET_GATEWAY_SERVER&&!e.data.retry});return r}catch(e){throw e}}async function wF(e,t,n,r){const o=UN("PROXY_SERVER_TYPE3"),i=(e,t,n)=>{let r=n||o;return Array.isArray(r)&&(r=t%2==0?o[1]:o[0]),"https://".concat(r,"/ap/?url=").concat(e)};let a=null;const s=[],c=async()=>{const o=UN("WEBCS_DOMAIN").slice(0,UN("AJAX_REQUEST_CONCURRENT")).map(((t,n)=>{let r;return r="disabled"===e.cloudProxyServer&&e.proxyServer?i("".concat(t,"/api/v2/transpond/webrtc?v=2"),n,e.proxyServer):"disabled"===e.cloudProxyServer||"fallback"===e.cloudProxyServer?"https://".concat(t,"/api/v2/transpond/webrtc?v=2"):i("".concat(t,"/api/v2/transpond/webrtc?v=2"),n),{url:r,areaCode:Zj(),serviceIds:[YU.CHOOSE_SERVER,"proxy5"===e.cloudProxyServer?YU.CLOUD_PROXY_5:"proxy3"===e.cloudProxyServer||"proxy4"===e.cloudProxyServer?YU.CLOUD_PROXY:YU.CLOUD_PROXY_FALLBACK]}})),a=r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:o.map((e=>e.url))}),c=await yF({fragementLength:UN("FRAGEMENT_LENGTH"),referenceList:o,asyncMapHandler:r=>(pk.debug("[".concat(e.clientId,"] Connect to choose_server:"),r.url),dF(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},a),e[0]},promisesCollector:s});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},a),c},l=async()=>{if(await MA(1e3),null!==a)return a;const o=UN("WEBCS_DOMAIN_BACKUP_LIST").map(((t,n)=>{let r;return r="disabled"===e.cloudProxyServer&&e.proxyServer?i("".concat(t,"/api/v2/transpond/webrtc?v=2"),n,e.proxyServer):"disabled"===e.cloudProxyServer||"fallback"===e.cloudProxyServer?"https://".concat(t,"/api/v2/transpond/webrtc?v=2"):i("".concat(t,"/api/v2/transpond/webrtc?v=2"),n),{url:r,areaCode:Zj(),serviceIds:[YU.CHOOSE_SERVER,"proxy5"===e.cloudProxyServer?YU.CLOUD_PROXY_5:"proxy3"===e.cloudProxyServer||"proxy4"===e.cloudProxyServer?YU.CLOUD_PROXY:YU.CLOUD_PROXY_FALLBACK]}})),c=r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:o.map((e=>e.url))}),l=await yF({fragementLength:UN("FRAGEMENT_LENGTH"),referenceList:o,asyncMapHandler:r=>(pk.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),r.url),dF(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},c),e[0]},promisesCollector:s});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},c),l};let u,d,p;try{({gatewayInfo:u,proxyInfo:d,url:p}=await EF([c(),l()]))}catch(e){throw e[0]}if(s.length&&s.forEach((e=>e.cancel&&"function"==typeof e.cancel&&e.cancel())),!u||!d)throw new bk(jI.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(e.apUrl=p,"disabled"!==e.cloudProxyServer&&Array.isArray(o)&&p){const t=/^https?:\/\/(.+?)(\/.*)?$/.exec(p)[1];Ur(o).call(o,t)&&(e.proxyServer=t,pk.setProxyServer(t),_k.setProxyServer(t))}return a={gatewayInfo:u,proxyInfo:await nj(d,u.uid)},a}async function IF(e,t,n){const r=UN("UAP_AP").slice(0,UN("AJAX_REQUEST_CONCURRENT")).map((t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v1?action=uap"):"https://".concat(t,"/api/v1?action=uap"))),o=r.map((r=>function(e,t,n,r){const o={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:t.token,ts:Date.now(),version:wN,cname:t.cname,uid:t.uid.toString(),requestId:lF,seq:lF};lF+=1;const i={service_name:"tele_channel",json_body:JSON.stringify(o)};return ZA((async()=>{const t=await Jj(e,{data:i,cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(0!==t.code){const e=new bk(jI.UNEXPECTED_RESPONSE,"cross channel ap error, code"+t.code,{retry:!0});throw pk.error(e.toString()),e}const r=JSON.parse(t.json_body);if(200!==r.code){const e=new bk(jI.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(r.code,", reason: ").concat(r.reason));throw pk.error(e.toString()),e}if(!r.servers||0===r.servers.length){const e=new bk(jI.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw pk.error(e.toString()),e}return{vid:r.vid,workerToken:r.workerToken,addressList:(UN("CHANNEL_MEDIA_RELAY_SERVERS")||r.servers).map((e=>"wss://".concat(e.address.replace(/\./g,"-"),".").concat(UN("WORKER_DOMAIN"),":").concat(e.wss)))}}),void 0,(e=>!!(e.code!==jI.OPERATION_ABORTED&&e.code!==jI.UNEXPECTED_RESPONSE||e.data&&e.data.retry)),r)}(r,e,t,n)));try{const e=await EF(o);return o.forEach((e=>e.cancel())),e}catch(e){throw e[0]}}async function AF(e,t,n){let r=null;const o=[],i=async i=>{const a=UN(i?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map((t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2")));return i&&(await MA(1e3),null!==r)?r:await yF({fragementLength:UN("FRAGEMENT_LENGTH"),referenceList:a,asyncMapHandler:r=>(pk.debug("[".concat(e.clientId,"] update ticket, Connect to ").concat(i?"backup":""," choose_server:"),r),function(e,t,n,r){const[o]=vF(t,[YU.CHOOSE_SERVER]);let i=yA.networkState;return ZA((async()=>{i&&yA.networkState===hA.OFFLINE&&yA.onlineWaiter&&await ih.race([yA.onlineWaiter,MA(r&&r.maxRetryTimeout||XA.maxRetryTimeout)]),i=yA.networkState;const t=await Jj(e,{data:o,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0);return fF(t,e)}),(()=>!1),(e=>e.code!==jI.OPERATION_ABORTED&&(e.code===jI.UPDATE_TICKET_FAILED?e.data.retry:(pk.warning("[".concat(t.clientId,"] update ticket network error, retry"),e),!0))),r)}(r,e,t,n)),allFailedhandler:e=>{throw e[0]},promisesCollector:o})};try{return r=await EF([i(!1),i(!0)]),o.length&&o.forEach((e=>e.cancel&&"function"==typeof e.cancel&&e.cancel())),r}catch(e){throw e[0]}}function NF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kF(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?NF(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NF(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class PF extends eA{get isSuccess(){return!!this.configs}constructor(e,t){super(),OR(this,"configs",void 0),OR(this,"store",void 0),OR(this,"joinInfo",void 0),OR(this,"cancelToken",void 0),OR(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),OR(this,"interval",void 0),OR(this,"mutex",void 0),OR(this,"mutableParamsRead",!1),OR(this,"configCache",{}),OR(this,"limit_bitrate",void 0),this.mutex=new YA("config-distribute",e),this.store=t}startGetConfigDistribute(e,t){this.joinInfo=e,this.cancelToken=t,this.interval&&this.stopGetConfigDistribute(),UN("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval((()=>{this.updateConfigDistribute()}),UN("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0,this.configs=void 0,this.limit_bitrate=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,_k.reportApiInvoke(null,{options:void 0,name:rA.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:oA.TRACER}).onSuccess(JSON.stringify(FN))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void pk.debug("[config-distribute] get config distribute interrupted have no joininfo");let e;const t=await this.mutex.lock();try{e=await RF(this.joinInfo,this.cancelToken,this.retryConfig),pk.debug("[config-distribute] get config distribute",JSON.stringify(e));const t=function(e){var t;const n=Xy(t=Object.keys(e).filter((e=>/^webrtc_ng_global_parameter/.test(e)))).call(t);for(let i=0;i<n.length;i++)for(let t=n.length-1;t>i;t--){const r=n[t],o=e[r].value;if("number"==typeof o.__priority){const i=o.__priority,a=n[t-1],s=e[a].value;if("number"==typeof s.__priority){if(!(i>s.__priority))continue;{const e=r;n[t]=n[t-1],n[t-1]=e}}else{const e=r;n[t]=n[t-1],n[t-1]=e}}}const r=Date.now();let o={};return n.forEach((t=>{const n=e[t].value.__expires;n&&n<=r||(o[t]=e[t])})),o}(e);this.cacheGlobalParameterConfig(t),this.store.hasStartJoinChannel||(this.store.isABTestSuccess=!0),this.configs=t}catch(e){const t=new bk(jI.NETWORK_RESPONSE_ERROR,e);pk.warning("[config-distribute] ".concat(t.toString()))}finally{t()}}getBitrateLimit(){return this.limit_bitrate||void 0}handleBitrateLimit(e){aU(e)&&(this.limit_bitrate?this.limit_bitrate&&this.limit_bitrate.id!==e.id&&this.emit(iU.UPDATE_BITRATE_LIMIT,e):this.emit(iU.UPDATE_BITRATE_LIMIT,e))}getLowStreamConfigDistribute(){return this.limit_bitrate&&kF({},this.limit_bitrate.low_stream_uplink)}handleABTestConfigDistribute(e){try{const t={},n=Object.keys(e),r=[];n.forEach((n=>{const o=e[n].value;t[n]=o;const i=o.__id;if(i&&this.configCache[n]&&this.configCache[n].__id===i)return;const a=o.__type,s=e[n].value,c=e[n].tag;let l=0;a?a===jN.REALTIME&&(l=1):Object.keys(s).some((e=>Object.prototype.hasOwnProperty.call(MN,e)||!BL()&&Object.prototype.hasOwnProperty.call(kN,e)?(l=1,!0):void 0)),r.push({tag:c,isApplied:l,feature:n,params:JSON.stringify(o)})})),r.forEach((e=>{let{tag:t,feature:n,params:r,isApplied:o}=e;this.store.sessionId&&_k.abTest(this.store.sessionId,{intSucc:1,isApplied:o,tag:t,feature:n,params:r,cid:this.store.cid,uid:this.store.intUid})})),this.configCache=t}catch(e){pk.debug("handleABTestConfigDistribute error",e)}}cacheGlobalParameterConfig(e){const t=function(e){const t={};return Object.keys(e).forEach((n=>{const r=e[n].value,o=r.__expires,i=r.__type;Object.keys(r).forEach((e=>{"__id"===e||"__type"===e||"__priority"===e||"__expires"===e||Object.prototype.hasOwnProperty.call(t,e)||(t[e]=kF(kF({value:r[e]},o&&{expires:o}),i&&{type:i}))}))})),t}(e);try{var n;const r=null===(n=t.LIMIT_BITRATE)||void 0===n?void 0:n.value;delete t.LIMIT_BITRATE,r&&aU(r)&&this.handleBitrateLimit(r),this.limit_bitrate=r,this.handleGlobalParameterConfig(t),this.handleABTestConfigDistribute(e),function(e){try{const t=Date.now();Object.keys(e).forEach((n=>{const{value:r,type:o,expires:i}=e[n];i&&i<=t||((o===jN.REALTIME||Object.prototype.hasOwnProperty.call(MN,n))&&(FN[n]=r,LN[n]=r,pk.debug("Update realtime parameters from config distribute",n,r)),o||BL()||!Object.prototype.hasOwnProperty.call(kN,n)||(FN[n]=r,LN[n]=r,pk.debug("Update gateway parameters from config distribute",n,r)))}))}catch(t){pk.error("Error update config immediately: ".concat(e),t.message)}}(t);const o=JSON.stringify(t),i=window.btoa(o);window.localStorage.setItem("websdk_ng_global_parameter",i),pk.debug("Caching global parameters ".concat(o))}catch(e){pk.error("Error caching global parameters:",e.message)}}handleGlobalParameterConfig(e){try{const t=Date.now();Object.keys(e).forEach((n=>{if("CLIENT_ROLE_OPTIONS"===n&&Object.prototype.hasOwnProperty.call(LN,n)){const{value:r,expires:o}=e[n];if(o&&o<=t)return;(function(e,t){try{return"object"==typeof e&&"object"==typeof t&&JSON.stringify(e)===JSON.stringify(t)}catch(e){return!1}})(LN[n],r)||(FN[n]=r,LN[n]=r,this.emit(iU.UPDATE_CLIENT_ROLE_OPTIONS,r),pk.debug("Updating client role options: ".concat(JSON.stringify(r))))}}))}catch(e){pk.error("Error handling global parameter config:",e.message)}}}class DF extends eA{constructor(){super(...arguments),OR(this,"resultStorage",new Map)}setLocalAudioStats(e,t,n){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",e,this.checkAudioInputLevel(n,t)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",e,this.checkSendAudioBitrate(n,t))}setLocalVideoStats(e,t,n){this.record("SEND_VIDEO_BITRATE_TOO_LOW",e,this.checkSendVideoBitrate(n,t)),this.record("FRAMERATE_INPUT_TOO_LOW",e,this.checkFramerateInput(n,t)),this.record("FRAMERATE_SENT_TOO_LOW",e,this.checkFramerateSent(n))}setRemoteAudioStats(e,t){const n=e.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",n,this.checkAudioOutputLevel(t))}setRemoteVideoStats(e,t){const n=e.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",n,this.checkVideoDecode(t))}record(e,t,n){if(UN("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(e)||this.resultStorage.set(e,{result:[],isPrevNormal:!0});const r=this.resultStorage.get(e);if(r&&(r.result.push(n),r.result.length>=5)){var o;const n=Ur(o=r.result).call(o,!0);r.isPrevNormal&&!n&&this.emit("exception",MF[e],e,t),!r.isPrevNormal&&n&&this.emit("exception",MF[e]+2e3,e+"_RECOVER",t),r.isPrevNormal=n,r.result=[]}}checkAudioOutputLevel(e){return!(e.receiveBitrate>0&&0===e.receiveLevel)}checkAudioInputLevel(e,t){return t instanceof YD&&!t.isActive||!!t.muted||0!==e.sendVolumeLevel}checkFramerateInput(e,t){let n=null;t._encoderConfig&&t._encoderConfig.frameRate&&(n=QU(t._encoderConfig.frameRate));const r=e.captureFrameRate;return!n||!r||!(n>10&&r<5||n<10&&n>=5&&r<=1)}checkFramerateSent(e){return!(e.captureFrameRate&&e.sendFrameRate&&e.captureFrameRate>5&&e.sendFrameRate<=1)}checkSendVideoBitrate(e,t){return!!t.muted||0!==e.sendBitrate}checkSendAudioBitrate(e,t){return t instanceof YD&&!t.isActive||!!t.muted||0!==e.sendBitrate}checkVideoDecode(e){return 0===e.receiveBitrate||0!==e.decodeFrameRate}}const MF={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},LF=new class{markSubscribeStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/subscribe-").concat(t))}markPublishStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/publish-").concat(t))}measureFromSubscribeStart(e,t){const n=performance.getEntriesByName("agora-web-sdk/".concat(e,"/subscribe-").concat(t));if(n.length>0){const e=n[n.length-1];return Math.round(performance.now()-e.startTime)}return 0}measureFromPublishStart(e,t){const n=performance.getEntriesByName("agora-web-sdk/".concat(e,"/publish-").concat(t));if(n.length>0){const e=n[n.length-1];return Math.round(performance.now()-e.startTime)}return 0}};function xF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function UF(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xF(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xF(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class jF{constructor(e){OR(this,"store",void 0),OR(this,"onStatsException",void 0),OR(this,"onUploadPublishDuration",void 0),OR(this,"onStatsChanged",void 0),OR(this,"localStats",new Map),OR(this,"remoteStats",new Map),OR(this,"updateStatsInterval",void 0),OR(this,"trafficStats",void 0),OR(this,"trafficStatsPeerList",[]),OR(this,"uplinkStats",void 0),OR(this,"exceptionMonitor",void 0),OR(this,"p2pChannel",void 0),OR(this,"scalabilityMode",gN.L1T1),OR(this,"updateStats",(()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))})),this.store=e,this.exceptionMonitor=new DF,this.exceptionMonitor.on("exception",((e,t,n)=>{this.onStatsException&&this.onStatsException(e,t,n)}))}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(hU.LocalAudioTrack)||UF({},Zk)}getLocalVideoTrackStats(){return this.localStats.get(hU.LocalVideoTrack)||UF({},Qk)}getRemoteAudioTrackStats(e){const t=(e,t)=>{if(!this.trafficStats)return t;const n=this.trafficStats.peer_delay.find((t=>t.peer_uid===e));return n&&(t.publishDuration=n.B_ppad+(Date.now()-this.trafficStats.timestamp)),t},n={};if(e){var r;const o=null===(r=this.remoteStats.get(e))||void 0===r?void 0:r.audioStats;o&&(n[e]=t(e,o))}else Array.from(this.remoteStats.entries()).forEach((e=>{let[r,{audioStats:o}]=e;o&&(n[r]=t(r,o))}));return n}getRemoteNetworkQualityStats(e){const t={};if(e){var n;const r=null===(n=this.remoteStats.get(e))||void 0===n?void 0:n.networkStats;r&&(t[e]=r)}else Array.from(this.remoteStats.entries()).forEach((e=>{let[n,{networkStats:r}]=e;r&&(t[n]=r)}));return t}getRemoteVideoTrackStats(e){const t=(e,t)=>{if(!this.trafficStats)return t;const n=this.trafficStats.peer_delay.find((t=>t.peer_uid===e));return n&&(t.publishDuration=n.B_ppvd+(Date.now()-this.trafficStats.timestamp)),t},n={};if(e){var r;const o=null===(r=this.remoteStats.get(e))||void 0===r?void 0:r.videoStats;o&&(n[e]=t(e,o))}else Array.from(this.remoteStats.entries()).forEach((e=>{let[r,{videoStats:o}]=e;o&&(n[r]=t(r,o))}));return n}getRTCStats(){let e=0,t=0,n=0,r=0;const o=this.localStats.get(hU.LocalAudioTrack);o&&(e+=o.sendBytes,t+=o.sendBitrate);const i=this.localStats.get(hU.LocalVideoTrack);i&&(e+=i.sendBytes,t+=i.sendBitrate);const a=this.localStats.get(hU.LocalVideoLowTrack);a&&(e+=a.sendBytes,t+=a.sendBitrate),this.remoteStats.forEach((e=>{let{audioStats:t,videoStats:o}=e;t&&(n+=t.receiveBytes,r+=t.receiveBitrate),o&&(n+=o.receiveBytes,r+=o.receiveBitrate)}));let s=1;return this.trafficStats&&(s+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:s,SendBitrate:t,SendBytes:e,RecvBytes:n,RecvBitrate:r,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(e){this.localStats.set(e,void 0)}removeLocalStats(e){e?this.localStats.delete(e):this.localStats.clear()}addRemoteStats(e){this.remoteStats.set(e,{})}removeRemoteStats(e){e?this.remoteStats.delete(e):this.remoteStats.clear()}addP2PChannel(e){this.p2pChannel=e}updateTrafficStats(e){e.peer_delay=e.peer_delay.filter((e=>void 0!==e.B_ppad||void 0!==e.B_ppvd)),e.peer_delay.filter((e=>-1===this.trafficStatsPeerList.indexOf(e.peer_uid))).forEach((e=>{var t;const n=null===(t=this.p2pChannel)||void 0===t?void 0:t.getRemoteMedia(e.peer_uid),r=null!=n&&n.videoSSRC?LF.measureFromSubscribeStart(this.store.clientId,n.videoSSRC):0,o=null!=n&&n.audioSSRC?LF.measureFromSubscribeStart(this.store.clientId,n.audioSSRC):0;void 0!==e.B_ppad&&void 0!==e.B_ppvd&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(e.peer_uid,e.B_ppad,e.B_ppvd,r>o?r:o),this.trafficStatsPeerList.push(e.peer_uid))})),this.trafficStats=e}updateUplinkStats(e){this.uplinkStats&&this.uplinkStats.B_fir!==e.B_fir&&pk.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(e.B_fir)),this.uplinkStats=e}static isRemoteVideoFreeze(e,t,n){if(!e)return!1;const r=!!n&&t.framesDecodeFreezeTime>n.framesDecodeFreezeTime,o=!n||t.framesDecodeCount>n.framesDecodeCount;return r||!o}static isRemoteAudioFreeze(e){return!!e&&e._isFreeze()}isLocalVideoFreeze(e){return!(!e.inputFrame||!e.sentFrame)&&e.inputFrame.frameRate>5&&e.sentFrame.frameRate<3}updateLocalStats(e){Array.from(this.localStats.entries()).forEach((t=>{let[n,r]=t;switch(n){case hU.LocalVideoTrack:case hU.LocalVideoLowTrack:{const t=r,i=UF({},Qk),a=e.getStats(),s=e.getLocalMedia(n);if(a){const n=a.videoSend.find((e=>e.ssrc===(null==s?void 0:s.ssrcs[0].ssrcId)));if(n){const r=e.getLocalVideoSize(),o=e.getEncoderConfig(hU.LocalVideoTrack);"H264"!==n.codec&&"H265"!==n.codec&&"VP8"!==n.codec&&"VP9"!==n.codec&&"AV1X"!==n.codec&&"AV1"!==n.codec||(i.codecType=n.codec),i.sendBytes=n.bytes,i.sendBitrate=t?8*Math.max(0,i.sendBytes-t.sendBytes):0,n.inputFrame?(i.captureFrameRate=n.inputFrame.frameRate,i.captureResolutionHeight=n.inputFrame.height,i.captureResolutionWidth=n.inputFrame.width):r&&(i.captureResolutionWidth=r.width,i.captureResolutionHeight=r.height),n.sentFrame?(i.sendFrameRate=n.sentFrame.frameRate,i.sendResolutionHeight=n.sentFrame.height,i.sendResolutionWidth=n.sentFrame.width):r&&(i.sendResolutionWidth=r.width,i.sendResolutionHeight=r.height),n.avgEncodeMs&&(i.encodeDelay=n.avgEncodeMs),o&&o.bitrateMax&&(i.targetSendBitrate=1e3*o.bitrateMax),i.sendPackets=n.packets,i.sendPacketsLost=n.packetsLost,i.sendJitterMs=n.jitterMs,i.sendRttMs=n.rttMs,i.totalDuration=t?t.totalDuration+1:1,i.totalFreezeTime=t?t.totalFreezeTime:0,this.isLocalVideoFreeze(n)&&(i.totalFreezeTime+=1),n.scalabilityMode&&this.scalabilityMode!==n.scalabilityMode&&(pk.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(n.scalabilityMode)),this.scalabilityMode=n.scalabilityMode)}this.trafficStats&&(i.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var o;this.localStats.set(n,i),((null==t?void 0:t.sendResolutionWidth)!==i.sendResolutionWidth||(null==t?void 0:t.sendResolutionHeight)!==i.sendResolutionHeight)&&(null===(o=this.onStatsChanged)||void 0===o||o.call(this,"resolution",{width:i.sendResolutionWidth,height:i.sendResolutionHeight})),i&&s&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,s.track,i);break}case hU.LocalAudioTrack:{const t=r,o=UF({},Zk),i=e.getStats(),a=e.getLocalMedia(n);if(i){const n=i.audioSend.find((e=>e.ssrc===(null==a?void 0:a.ssrcs[0].ssrcId)));if(n){if("opus"!==n.codec&&"aac"!==n.codec&&"PCMU"!==n.codec&&"PCMA"!==n.codec&&"G722"!==n.codec||(o.codecType=n.codec),n.inputLevel)o.sendVolumeLevel=Math.round(32767*n.inputLevel);else{const t=e.getLocalAudioVolume();t&&(o.sendVolumeLevel=Math.round(32767*t))}o.sendBytes=n.bytes,o.sendPackets=n.packets,o.sendPacketsLost=n.packetsLost,o.sendJitterMs=n.jitterMs,o.sendRttMs=n.rttMs,o.sendBitrate=t?8*Math.max(0,o.sendBytes-t.sendBytes):0}}this.trafficStats&&(o.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(hU.LocalAudioTrack,o),o&&a&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,a.track,o);break}}}))}updateRemoteStats(e){Array.from(this.remoteStats.entries()).forEach((t=>{var n,r;let[o,{videoStats:i,audioStats:a,videoPcStats:s}]=t;const c=a,l=i,u=s,d=UF({},$k),p=UF({},tP),h=UF({},eP),{audioTrack:f,videoTrack:m,audioSSRC:v,videoSSRC:g}=e.getRemoteMedia(o);let E;E=this.store.useP2P?e.getStats(!0):e.getStats();const y=null===(n=E)||void 0===n?void 0:n.audioRecv.find((e=>e.ssrc===v)),_=null===(r=E)||void 0===r?void 0:r.videoRecv.find((e=>e.ssrc===g)),b=this.trafficStats&&this.trafficStats.peer_delay.find((e=>e.peer_uid===o));if(y&&("opus"!==y.codec&&"aac"!==y.codec&&"PCMU"!==y.codec&&"PCMA"!==y.codec&&"G722"!==y.codec||(d.codecType=y.codec),y.outputLevel?d.receiveLevel=Math.round(32767*y.outputLevel):f&&(d.receiveLevel=Math.round(32767*f.getVolumeLevel())),d.receiveBytes=y.bytes,d.receivePackets=y.packets,d.receivePacketsLost=y.packetsLost,d.receivePacketsDiscarded=y.packetsDiscarded,d.packetLossRate=d.receivePacketsLost/(d.receivePackets+d.receivePacketsLost),d.receiveBitrate=c?8*Math.max(0,d.receiveBytes-c.receiveBytes):0,d.totalDuration=c?c.totalDuration+1:1,d.totalFreezeTime=c?c.totalFreezeTime:0,d.freezeRate=d.totalFreezeTime/d.totalDuration,d.receiveDelay=y.jitterBufferMs,d.totalDuration>10&&jF.isRemoteAudioFreeze(f)&&(d.totalFreezeTime+=1)),_){var T;"H264"!==_.codec&&"H265"!==_.codec&&"VP8"!==_.codec&&"VP9"!==_.codec&&"AV1X"!==_.codec&&"AV1"!==_.codec||(p.codecType=_.codec),p.receiveBytes=_.bytes,p.receiveBitrate=l?8*Math.max(0,p.receiveBytes-l.receiveBytes):0,p.decodeFrameRate=_.decodeFrameRate<0?0:_.decodeFrameRate,p.renderFrameRate=_.decodeFrameRate<0?0:_.decodeFrameRate,_.outputFrame&&(p.renderFrameRate=_.outputFrame.frameRate),_.receivedFrame?(p.receiveFrameRate=_.receivedFrame.frameRate,p.receiveResolutionHeight=_.receivedFrame.height,p.receiveResolutionWidth=_.receivedFrame.width):m&&(p.receiveResolutionHeight=m._videoHeight||0,p.receiveResolutionWidth=m._videoWidth||0),void 0!==_.framesRateFirefox&&(p.receiveFrameRate=Math.round(_.framesRateFirefox)),p.receivePackets=_.packets,p.receivePacketsLost=_.packetsLost,p.packetLossRate=p.receivePacketsLost/(p.receivePackets+p.receivePacketsLost);const t=l?l.totalFreezeTime:0,n=l?l.totalDuration:0;p.totalDuration=l?l.totalDuration+1:1,p.totalFreezeTime=null!==(T=_.totalFreezesDuration)&&void 0!==T?T:t||0,p.receiveDelay=_.jitterBufferMs||0;const r=!!g&&e.getRemoteVideoIsReady(g);void 0===_.totalFreezesDuration&&m&&r&&jF.isRemoteVideoFreeze(m,_,u)&&(p.totalFreezeTime+=1),p.freezeRate=Math.max(0,Math.min((p.totalFreezeTime-t)/(p.totalDuration-n),1))}b&&(d.end2EndDelay=b.B_ad,p.end2EndDelay=b.B_vd,d.transportDelay=b.B_ed,p.transportDelay=b.B_ed,d.currentPacketLossRate=b.B_ealr4/100,p.currentPacketLossRate=b.B_evlr4/100,h.uplinkNetworkQuality=b.B_punq?b.B_punq:0,h.downlinkNetworkQuality=b.B_pdnq?b.B_pdnq:0),this.remoteStats.set(o,{audioStats:d,videoStats:p,videoPcStats:_,networkStats:h}),f&&this.exceptionMonitor.setRemoteAudioStats(f,d),m&&this.exceptionMonitor.setRemoteVideoStats(m,p)}))}}class FF{constructor(){OR(this,"destChannelMediaInfos",new Map),OR(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(e){Kx(e),this.srcChannelMediaInfo=e}addDestChannelInfo(e){Kx(e),this.destChannelMediaInfos.set(e.channelName,e)}removeDestChannelInfo(e){xx(e),this.destChannelMediaInfos.delete(e)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function BF(e){if(!(e instanceof FF))return new bk(jI.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const t=e.getSrcChannelMediaInfo(),n=e.getDestChannelMediaInfo();return t?0===n.size?new bk(jI.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw():void 0:new bk(jI.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw()}class VF{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(e,t){OR(this,"uid",void 0),OR(this,"_uintid",void 0),OR(this,"_trust_in_room_",!0),OR(this,"_trust_audio_enabled_state_",!0),OR(this,"_trust_video_enabled_state_",!0),OR(this,"_trust_audio_mute_state_",!0),OR(this,"_trust_video_mute_state_",!0),OR(this,"_audio_muted_",!1),OR(this,"_video_muted_",!1),OR(this,"_audio_enabled_",!0),OR(this,"_video_enabled_",!0),OR(this,"_audio_added_",!1),OR(this,"_video_added_",!1),OR(this,"_is_pre_created",!1),OR(this,"_video_pre_subscribed",!1),OR(this,"_audio_pre_subscribed",!1),OR(this,"_trust_video_stream_added_state_",!0),OR(this,"_trust_audio_stream_added_state_",!0),OR(this,"_audioTrack",void 0),OR(this,"_videoTrack",void 0),OR(this,"_dataChannels",[]),OR(this,"_audioSSRC",void 0),OR(this,"_videoSSRC",void 0),OR(this,"_audioOrtc",void 0),OR(this,"_videoOrtc",void 0),OR(this,"_cname",void 0),OR(this,"_rtxSsrcId",void 0),OR(this,"_videoMid",void 0),OR(this,"_audioMid",void 0),this.uid=e,this._uintid=t}}function HF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function GF(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HF(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HF(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const WF="9",qF=4e4;let KF=class{get localCapabilities(){return SA(this._localCapabilities)}get rtpCapabilities(){return SA(this._rtpCapabilities)}get candidates(){return SA(this._candidates)}get iceParameters(){return SA(this._iceParameters)}get dtlsParameters(){return SA(this._dtlsParameters)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];OR(this,"sessionDesc",void 0),OR(this,"_localCapabilities",void 0),OR(this,"_rtpCapabilities",void 0),OR(this,"_candidates",void 0),OR(this,"_originCandidates",void 0),OR(this,"_iceParameters",void 0),OR(this,"_isUseExtmapAllowMixed",void 0),OR(this,"_dtlsParameters",void 0),OR(this,"setup",void 0),OR(this,"currentMidIndex",void 0),OR(this,"cname",void 0),OR(this,"firefoxSsrcMidMap",new Map),this._isUseExtmapAllowMixed=t,e=SA(e);const{iceParameters:n,dtlsParameters:r,candidates:o,rtpCapabilities:i,setup:a,localCapabilities:s,cname:c}=e;this._rtpCapabilities=i,this._candidates=o,this._originCandidates=SA(o),this._iceParameters=n,this._dtlsParameters=r,this._localCapabilities=s,this.setup=a,this.cname=c,this.sessionDesc=this.updateRemoteRTPCapabilities(i),this.currentMidIndex=this.sessionDesc.mediaDescriptions.length-1}preloadRemoteMedia(e){const t=this.candidates,n=this.dtlsParameters,r=this.iceParameters,o=this.rtpCapabilities.send;let i=this.sessionDesc.mediaDescriptions.length-1;for(let a=1;a<e;a++){const e=2*a+2e4,s=2*a+qF,{ssrcs:c,ssrcGroups:l}=Ej([{ssrcId:e}],this.cname),{ssrcs:u,ssrcGroups:d}=Ej([{ssrcId:s,rtx:UN("USE_SUB_RTX")?s+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:WF,protos:["UDP","TLS","RTP","SAVPF"],fmts:o.videoCodecs.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:r.iceUfrag,icePwd:r.icePwd,unrecognized:[],candidates:t,extmaps:o.videoExtensions,fingerprints:n.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:u,ssrcGroups:d,rtcpFeedbackWildcards:[],payloads:o.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++i)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:WF,protos:["UDP","TLS","RTP","SAVPF"],fmts:o.audioCodecs.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:r.iceUfrag,icePwd:r.icePwd,unrecognized:[],candidates:t,extmaps:o.audioExtensions,fingerprints:n.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:c,ssrcGroups:l,rtcpFeedbackWildcards:[],payloads:o.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++i)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return KN(this.sessionDesc)}send(e,t,n,r){const{ssrcs:o,ssrcGroups:i}=Ej(t,this.cname,UN("SYNC_GROUP")?n:void 0),a=this.findPreloadMediaDesc(o);if(a){if(fI()&&this.firefoxSsrcMidMap.set(o[0].ssrcId,a.attributes.mid),r&&(r.twcc||r.remb)){const e=this.sessionDesc.mediaDescriptions.indexOf(a);return this.sessionDesc.mediaDescriptions[e]=this.mungSendMediaDesc(a,r),{mid:a.attributes.mid,needExchangeSDP:!0}}return{mid:a.attributes.mid,needExchangeSDP:!1}}{const t=this.findAvailableMediaIndex(e,o);let n;return-1===t||1===t&&(pI()||function(){const e=aI();return!(e.name!==nI.CHROME||!e.osVersion)&&Number(e.version)<=90}()||UN("ENABLE_ENCODED_TRANSFORM")&&dI())||0===t&&UN("USE_SUB_RTX")||OI()?(n=this.createOrRecycleSendMedia(e,o,i,"sendonly",r),this.updateBundleMids()):(n=SA(this.sessionDesc.mediaDescriptions[t]),n.attributes.direction="sendonly",n.attributes.ssrcs=o,n.attributes.ssrcGroups=i,this.sessionDesc.mediaDescriptions[t]=this.mungSendMediaDesc(n,r)),fI()&&this.firefoxSsrcMidMap.set(o[0].ssrcId,n.attributes.mid),{mid:n.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:e,needExchangeSDP:t}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:e.attributes.mid,needExchangeSDP:t}}batchSend(e){const t=e.map((e=>{let{kind:t,ssrcMsg:n,mslabel:r}=e;return this.send(t,n,r)})),n=[];let r=!1;return t.forEach((e=>{let{mid:t,needExchangeSDP:o}=e;o&&(r=!0),n.push(t)})),{mids:n,needExchangeSDP:r}}stopSending(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>t.attributes.mid&&-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach((e=>{"0"===e.attributes.mid||fI()||OI()?e.attributes.ssrcs=[]:(e.attributes.ssrcs=[],e.attributes.direction="inactive",e.media.port="0")})),this.updateBundleMids()}mute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));t.attributes.direction="inactive"}unmute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));t.attributes.direction="sendonly"}muteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>Ur(e).call(e,t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="inactive"}))}unmuteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>Ur(e).call(e,t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="recvonly"}))}receive(e,t,n,r){e.forEach(((e,o)=>{this.createOrRecycleRecvMedia(e,[],"recvonly",t,n,r[o])})),this.updateBundleMids()}stopReceiving(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach((e=>{e.media.port="0",e.attributes.direction="inactive"})),this.updateBundleMids()}updateRemoteRTPCapabilities(e){const t=this.sessionDesc||qN((n=this._isUseExtmapAllowMixed,"v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=ice-lite".concat(n?"\na=extmap-allow-mixed":"","\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n")));var n;this._rtpCapabilities=e;const r=this.rtpCapabilities.send,o=this.localCapabilities.send;for(const i of t.mediaDescriptions){if(i.attributes.iceUfrag=this._iceParameters.iceUfrag,i.attributes.icePwd=this._iceParameters.icePwd,i.attributes.fingerprints=this._dtlsParameters.fingerprints,i.attributes.candidates=this._candidates,i.attributes.setup=this.setup,"application"===i.media.mediaType&&(i.attributes.sctpPort="5000"),"video"===i.media.mediaType)if(0===r.videoCodecs.length){const e=o.videoCodecs.filter((e=>{var t,n;return null===(t=e.rtpMap)||void 0===t?void 0:Ur(n=t.encodingName.toLowerCase()).call(n,"vp8")}))||[o.videoCodecs[0]];i.media.fmts=e.map((e=>e.payloadType.toString(10))),i.attributes.payloads=e,i.attributes.extmaps=[]}else if(i.media.fmts=r.videoCodecs.map((e=>e.payloadType.toString(10))),i.attributes.payloads=r.videoCodecs,i.attributes.extmaps=r.videoExtensions,UN("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:e,ssrcGroups:t}=Ej([{ssrcId:qF,rtx:UN("USE_SUB_RTX")?40001:void 0}],this.cname);i.attributes.ssrcs=e,i.attributes.ssrcGroups=t}if("audio"===i.media.mediaType)if(0===r.audioCodecs.length){const e=o.audioCodecs.filter((e=>{var t,n;return null===(t=e.rtpMap)||void 0===t?void 0:Ur(n=t.encodingName.toLowerCase()).call(n,"opus")}))||[o.audioCodecs[0]];i.media.fmts=e.map((e=>e.payloadType.toString(10))),i.attributes.payloads=e,i.attributes.extmaps=[]}else if(i.media.fmts=r.audioCodecs.map((e=>e.payloadType.toString(10))),i.attributes.payloads=r.audioCodecs,i.attributes.extmaps=r.audioExtensions,Aj(i),UN("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:e,ssrcGroups:t}=Ej([{ssrcId:2e4}],this.cname);i.attributes.ssrcs=e,i.attributes.ssrcGroups=t}}return this.sessionDesc=t,this.currentMidIndex=t.mediaDescriptions.length-1,this.sessionDesc}updateCandidates(e){const t=this._originCandidates.filter((e=>"udp"===e.transport)),n=[];if(t.forEach((e=>{n.push(GF(GF({},e),{},{foundation:"tcpcandidate",priority:Number(e.priority)-1+"",transport:"tcp",port:Number(e.port)+90+""}))})),0!==t.length){switch(e){case uU.TCP_RELAY:this._candidates=n;break;case uU.UDP_TCP_RELAY:case uU.RELAY:this._candidates=[...t,...n];break;default:this._candidates=t}for(const e of this.sessionDesc.mediaDescriptions)e.attributes.candidates=this.candidates}}restartICE(e){e=SA(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach((t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd}))}predictReceivingMids(e){const t=[];for(let n=0;n<e;n++)t.push((this.currentMidIndex+n+1).toString(10));return t}findAvailableMediaIndex(e,t){return this.sessionDesc.mediaDescriptions.findIndex((n=>{const r=n.media.mediaType===e&&"0"!==n.media.port&&("sendonly"===n.attributes.direction||"sendrecv"===n.attributes.direction)&&0===n.attributes.ssrcs.length;if(fI()){if(r){const e=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(e||"0"!==n.attributes.mid&&"1"!==n.attributes.mid)||!(!e||e!==n.attributes.mid)}return!1}return r}))}createOrRecycleDataChannel(){for(const n of this.sessionDesc.mediaDescriptions)if("application"===n.media.mediaType)return{mediaDesc:n,needExchangeSDP:!1};this.currentMidIndex+=1;const e="".concat(this.currentMidIndex),t={media:{mediaType:"application",port:WF,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(e),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(t),{mediaDesc:t,needExchangeSDP:!0}}createOrRecycleRecvMedia(e,t,n,r,o,i){const a=e._mediaStreamTrack.kind,s=this.rtpCapabilities.recv,c=Nj(a,s,this.localCapabilities.send,a===lU.VIDEO?r:o),l=a===lU.VIDEO?s.videoExtensions:s.audioExtensions;this.currentMidIndex+=1;const u="".concat(this.currentMidIndex);let d={media:{mediaType:a,port:WF,protos:["UDP","TLS","RTP","SAVPF"],fmts:c.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:l,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:c,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(u)}};d=this.mungRecvMediaDsec(d,e,i);const p=this.findFirstClosedMedia(a);if(p){const e=this.sessionDesc.mediaDescriptions.indexOf(p);this.sessionDesc.mediaDescriptions[e]=d}else this.sessionDesc.mediaDescriptions.push(d);return d}updateRemoteCodec(e,t,n){const r=[...new Set(this._rtpCapabilities.recv.videoCodecs.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")).filter((e=>{var t;return Ur(t=Object.keys(HN)).call(t,e)})))],o=new Set(t);if(r.every((e=>o.has(e))))return pk.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(t)),!1;const i=this._rtpCapabilities.recv.videoCodecs.filter((e=>t.some((t=>{var n;return Ur(n=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(n,t)}))));if(0===i.length)return pk.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(r," codecs: ").concat(t)),!1;const a=[...new Set(i.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")))];let s;if(pk.debug("updateRemoteCodec, from ".concat(r," to ").concat(a)),0===e.length)s=this.sessionDesc.mediaDescriptions.filter((e=>"video"===e.media.mediaType&&"recvonly"===e.attributes.direction));else if(s=this.sessionDesc.mediaDescriptions.filter((t=>t.attributes.mid&&Ur(e).call(e,t.attributes.mid)&&"recvonly"===t.attributes.direction)),s.length!==e.length)return pk.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(e,", codecs: ").concat(t)),!1;if(UN("USE_PUB_RTX")||UN("USE_SUB_RTX")){const e=kj(i,this.rtpCapabilities.recv.videoCodecs);i.push(...e)}this._rtpCapabilities.recv.videoCodecs=i;const c=this.localCapabilities.send,l=this.rtpCapabilities.recv,u=Nj(lU.VIDEO,l,c,n);return s.forEach((e=>{const t=u.map((e=>e.payloadType.toString(10)));pk.debug("updateRemoteCodec mid: ".concat(e.attributes.mid,", from"),e.attributes.payloads,"to",u),e.attributes.payloads=u,e.media.fmts=t})),!0}createOrRecycleSendMedia(e,t,n,r,o){const i=this.rtpCapabilities.send,a=e===lU.VIDEO?i.videoCodecs:i.audioCodecs,s=e===lU.VIDEO?i.videoExtensions:i.audioExtensions;this.currentMidIndex+=1;const c="".concat(this.currentMidIndex);let l={media:{mediaType:e,port:WF,protos:["UDP","TLS","RTP","SAVPF"],fmts:a.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:s,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:n,rtcpFeedbackWildcards:[],payloads:a,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(c)}};l=this.mungSendMediaDesc(l,o);const u=this.findFirstClosedMedia(e);if(u){const e=this.sessionDesc.mediaDescriptions.indexOf(u);this.sessionDesc.mediaDescriptions[e]=l}else this.sessionDesc.mediaDescriptions.push(l);return l}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter((e=>"0"!==e.media.port)).map((e=>e.attributes.mid))}mungRecvMediaDsec(e,t,n){const r=SA(e);return _j(r),yj(r,t),bj(r,t),Tj(r),Sj(r,n,this.localCapabilities.send),r}mungSendMediaDesc(e,t){const n=SA(e);return Sj(n,t,this.localCapabilities.recv),Aj(n),n}updateRecvMedia(e,t){const n=this.sessionDesc.mediaDescriptions.findIndex((t=>t.attributes.mid===e));if(-1!==n){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],t);this.sessionDesc.mediaDescriptions[n]=e}}bumpMid(e){this.currentMidIndex+=e}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find((t=>fI()?"0"===t.media.port&&t.media.mediaType===e:"0"===t.media.port))}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find((t=>{var n;return(null===(n=t.attributes)||void 0===n||null===(n=n.ssrcs[0])||void 0===n?void 0:n.ssrcId)===e[0].ssrcId}))}getSSRC(e){var t;return null===(t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e)))||void 0===t?void 0:t.attributes.ssrcs}};function YF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zF(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?YF(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YF(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var XF=function(e){return e[e.DOWN=0]="DOWN",e[e.UP=1]="UP",e}(XF||{});const JF=new Map;function ZF(e,t,n,r){let{scale:o}=e;if(0===o&&r===XF.UP||o>=t.length-1&&r===XF.DOWN)return e;let i=zF(zF({},e),{},{scale:r===XF.DOWN?++o:--o});switch(n){case"maintain-framerate":i=zF(zF({},i),t[o].motion);break;case"maintain-resolution":i=zF(zF({},i),t[o].detail);break;case"balanced":i=zF(zF({},i),t[o].balanced)}return i}function QF(e,t){if(t){const n={overUse:0,underUse:0,adaptationList:$F(t)};JF.set(e,n)}else JF.delete(e)}function $F(e){const t=zF({},e),{bitrateMax:n,frameRate:r,scaleResolutionDownBy:o,bitrateMin:i}=t,{MIN_FRAME_RATE:a,MAX_THRESHOLD_FRAMERATE:s,MAX_SCALE:c,BITRATE_MIN_THRESHOLD:l,BITRATE_MAX_THRESHOLD:u,BWE_SCALE_UP_THRESHOLD:d,BWE_SCALE_DOWN_THRESHOLD:p,PERF_SCALE_DOWN_THRESHOLD:h,PERF_SCALE_UP_THRESHOLD:f,BALANCE_BITRATE_FACTOR:m,BALANCE_FRAMERATE_FACTOR:v,BALANCE_RESOLUTION_FACTOR:g,MOTION_RESOLUTION_FACTOR:E,MOTION_BITRATE_FACTOR:y,DETAIL_FRAMERATE_FACTOR:_,DETAIL_BITRATE_FACTOR:b}=PN,T=Math.min(t.frameRate,s),S=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(p,1)*n),bwe_up:n,fps_down:Math.round(Math.pow(h,1)*T),fps_up:r},balanced:{scaleResolutionDownBy:1,frameRate:r,bitrateMax:n,bitrateMin:i},motion:{scaleResolutionDownBy:1,frameRate:r,bitrateMax:n,bitrateMin:i},detail:{scaleResolutionDownBy:1,frameRate:r,bitrateMax:n,bitrateMin:i}}];for(let O=1;O<=c;O++){const e={bwe_up:Math.round(Math.pow(d,O)*n),bwe_down:Math.round(Math.pow(p,O+1)*n),fps_up:Math.round(Math.pow(f,O)*T),fps_down:Math.round(Math.pow(h,O+1)*T)},t={scaleResolutionDownBy:o/Math.pow(g,O),frameRate:Math.max(Math.round(Math.pow(v,O)*r),a),bitrateMax:Math.max(Math.round(Math.pow(m,O)*n),u),bitrateMin:Math.max(Math.round(Math.pow(m,O)*i),l)},s={scaleResolutionDownBy:o/Math.pow(E,O),frameRate:r,bitrateMax:Math.max(Math.round(Math.pow(y,O)*n),u),bitrateMin:Math.max(Math.round(Math.pow(y,O)*i),l)},c={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(_,O)*r),a),bitrateMax:Math.max(Math.round(Math.pow(b,O)*n),u),bitrateMin:Math.max(Math.round(Math.pow(b,O)*i),l)};S.push({scale:O,threshold:e,balanced:t,motion:s,detail:c})}return S}function eB(e,t,n,r,o,i){const a=JF.get(e)||{overUse:0,underUse:0,adaptationList:$F(o)},{adaptationList:s}=a;JF.set(e,a);const{OVERUSE_TIMES_THRESHOLD:c,UNDERUSE_TIMES_THRESHOLD:l}=PN,{scale:u}=r;let d,p;return"number"==typeof t&&t>0&&function(e,t,n,r){if(t>=n.length)return!1;let{threshold:{fps_down:o}}=n[t];return UN("FORCE_AG_HIGH_FRAMERATE")&&"maintain-framerate"===r&&(o=n[0].threshold.fps_down),e<o}(t,u,s,i)&&(a.overUse++,p=vN.CPU,a.overUse>c)||"number"==typeof n&&n>0&&function(e,t,n){if(t>=n.length)return!1;const{threshold:{bwe_down:r}}=n[t];return e<r}(n,u,s)&&(a.overUse++,p=vN.BANDWIDTH,a.overUse>c)?(a.overUse=0,a.underUse=0,d=ZF(r,s,i,XF.DOWN),[d,p]):("number"==typeof t&&t>0&&"number"==typeof n&&n>0&&function(e,t,n,r){if(0===t)return;let{threshold:{fps_up:o}}=n[t];return UN("FORCE_AG_HIGH_FRAMERATE")&&"maintain-framerate"===r&&(o=n[1].threshold.fps_up),e>o}(t,u,s,i)&&function(e,t,n){if(0===t)return;const{threshold:{bwe_up:r}}=n[t];return e>r}(n,u,s)&&(a.underUse++,a.underUse>l&&(a.overUse=0,a.underUse=0,d=ZF(r,s,i,XF.UP),0===d.scale&&(p=vN.NONE))),[d,p])}function tB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nB(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tB(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tB(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rB(e){var t;return!!UN("ENABLE_AG_ADAPTATION")&&!!(e instanceof MM||Ur(t=e._hints).call(t,Hk.CUSTOM_TRACK))&&(!!UN("FORCE_SUPPORT_AG_ADAPTATION")||!!(function(e){const t=aI();if(t.os!==tI.IOS||!t.osVersion)return!1;const n=t.osVersion.split(".");return Number(n[0])>=e}(14)&&bI(17,4,!0)||_I(14)&&TI(17,4,!0)))}const oB=new Map;function iB(e,t){const n=oB.get(e);if(n){const{timer:t}=n;window.clearTimeout(t),oB.delete(e)}t.qualityLimitationReason=vN.NONE,QF(e)}function aB(e,t){var n;let r;switch(t){case hU.LocalAudioTrack:r=Zx.Audio;break;case hU.LocalVideoTrack:r=Ur(n=e._hints).call(n,Hk.SCREEN_TRACK)?Zx.Screen:Zx.High;break;case hU.LocalVideoLowTrack:r=Zx.Low}return r}function sB(e){const t=Sk();if(e.some((e=>e._bypassWebAudio)))throw new FI(jI.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!t.webAudioMediaStreamDest)throw new FI(jI.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function cB(e,t){sB(e);const n=t||new YD;return e.forEach((e=>n.addAudioTrack(e))),n}const lB=!Sk().supportUnifiedPlan||UN("CHROME_FORCE_PLAN_B")&&PI();function uB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;return lB?(n={spec:t,store:e},Hj("PlanBConnection").create(n)):new vB(t,e)}function dB(e){return e&&("disconnected"===e.iceConnectionState||"checking"===e.iceConnectionState||"failed"===e.iceConnectionState)}function pB(e){try{if(e.iceServers)return!1;if(e.turnServer&&"off"!==e.turnServer.mode){if(cA(e.turnServer.servers))return!1;if(UN("FORCE_TURN_TCP")||e.turnServer.servers.concat(e.turnServer.serversFromGateway||[]).some((e=>e.forceturn)))return!0}return!1}catch(e){return!1}}var hB;function fB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mB(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fB(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fB(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let vB=(hB=class e extends cU{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var e,t;return null!==(e=null===(t=this.peerConnection.getReceivers()[0])||void 0===t||null===(t=t.transport)||void 0===t?void 0:t.state)&&void 0!==e?e:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")).filter((e=>{var t;return Ur(t=Object.keys(HN)).call(t,e)})))]}constructor(t,n){super(t,n),OR(this,"id",LA(5,"connection-")),OR(this,"store",void 0),OR(this,"peerConnection",void 0),OR(this,"forceTurn",!1),OR(this,"remoteSDP",void 0),OR(this,"initialOffer",void 0),OR(this,"transportEventReceiver",void 0),OR(this,"statsFilter",void 0),OR(this,"extension",{useXR:UN("USE_XR")}),OR(this,"localCapabilities",void 0),OR(this,"remoteCodecs",void 0),OR(this,"localCandidateCount",0),OR(this,"allCandidatesReceived",!1),OR(this,"isPreallocation",!1),OR(this,"preSSRCMap",new Map),OR(this,"dataStreamChannelMap",new Map),OR(this,"establishPromise",void 0),OR(this,"recoveredDataChannelIds",[]),OR(this,"currentDataChannelId",1),OR(this,"supportAV1RtpSpec",!1),OR(this,"mutex",void 0),OR(this,"qualityLimitationReason",vN.NONE),this.store=n,this.forceTurn=pB(t),this.mutex=new YA("P2PConnection-mutex",n.clientId),this.peerConnection=new RTCPeerConnection(e.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=ON(this.peerConnection,UN("STATS_UPDATE_INTERVAL"),void 0,fI()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}getPreMedia(e){const t=this.preSSRCMap.get(e);if(void 0!==t){const e=this.peerConnection.getTransceivers().find((e=>e.mid===t));if(e)return{transceiver:e,track:e.receiver.track,id:t}}}async updateRemoteRTPCapabilities(e,t){if(this.remoteCodecs=t,this.remoteSDP)if(this.remoteSDP.updateRemoteCodec(e,t,this.store.codec)){const e=await this.peerConnection.createOffer(),t=this.logSDPExchange(e.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(e);const n=this.remoteSDP.toString();null==t||t(n),await this.peerConnection.setRemoteDescription({type:"answer",sdp:n})}else pk.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.");else pk.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(t))}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const n=await this.peerConnection.createOffer();if(!n.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const r=fj(n.sdp),o=await Rj({filterRTX:!UN("USE_PUB_RTX")&&!UN("USE_SUB_RTX"),filterVideoFec:UN("FILTER_VIDEO_FEC"),filterAudioFec:UN("FILTER_AUDIO_FEC"),filterVideoCodec:UN("FILTER_VIDEO_CODEC")},this.extension);if(this.localCapabilities=Ij(o),this.initialOffer=n,UN("ENABLE_SVC")&&"av1"==this.store.codec){const t=await async function(){try{const e=new RTCPeerConnection;e.addTransceiver("video",{direction:"sendonly",sendEncodings:[{scalabilityMode:gN.L1T3}]});const t=await e.createOffer();if(!t.sdp)return void e.close();const n=qN(t.sdp).mediaDescriptions[0];if(!n)return;const r=n.attributes.extmaps.find((e=>"https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension"===e.extensionName));return e.close(),r}catch(e){return}}();var e;t&&(this.supportAV1RtpSpec=!0,null===(e=o.send)||void 0===e||e.videoExtensions.push(t))}let i;return n.sdp&&Lj(n.sdp)&&(i=SA(o),(t=i).send&&(cj(lU.VIDEO,t.send.videoExtensions),cj(lU.AUDIO,t.send.audioExtensions)),t.recv&&(cj(lU.VIDEO,t.recv.videoExtensions),cj(lU.AUDIO,t.recv.audioExtensions)),t.sendrecv&&(cj(lU.VIDEO,t.sendrecv.videoExtensions),cj(lU.AUDIO,t.sendrecv.audioExtensions))),mB(mB({},r),{},{rtpCapabilities:i||o,offerSDP:n.sdp})}catch(e){throw new FI(jI.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}var t}async connect(e){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.initialOffer.sdp&&Lj(this.initialOffer.sdp)&&(t=e.rtpCapabilities,n=this.localCapabilities,t.send&&(sj(lU.VIDEO,t.send.videoExtensions,n.send.videoExtensions),sj(lU.AUDIO,t.send.audioExtensions,n.send.audioExtensions)),t.recv&&(sj(lU.VIDEO,t.recv.videoExtensions,n.recv.videoExtensions),sj(lU.AUDIO,t.recv.audioExtensions,n.recv.audioExtensions))),this.remoteSDP=new KF(mB(mB({},e),{},{localCapabilities:this.localCapabilities}),this.supportAV1RtpSpec),e.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const r=this.remoteSDP.toString(),o=Dj(this.initialOffer.sdp,this.extension),i=this.logSDPExchange(o||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:o}),null==i||i(r),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r});const a=this.peerConnection.getTransceivers()[0];if(null!=a&&a.receiver&&this.tryBindTransportEvents(a.receiver),UN("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia(UN("PRELOAD_MEDIA_COUNT"));const e=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});const t=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(t)}const{preSSRCs:s}=e;if(Array.isArray(s)&&s.length>0){const{mids:e}=this.remoteSDP.batchSend(s.map((e=>({kind:e.kind,ssrcMsg:[{ssrcId:e.ssrcId,rtx:e.rtx}],mslabel:e.mslabel}))));e.forEach(((e,t)=>{this.preSSRCMap.set(s[t].ssrcId,e)})),await Pj(this.peerConnection,this.remoteSDP,this.extension),pk.debug("[".concat(this.store.clientId,"] [P2PConnection] pre-batchReceive exchange SDP."))}}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}var t,n}async updateRemoteConnect(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateRemoteConnect before remote SDP created");const{rtpCapabilities:t}=e;this.remoteSDP.updateRemoteRTPCapabilities(t),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const{preSSRCs:n}=e;if(Array.isArray(n)&&n.length>0){const{mids:e}=this.remoteSDP.batchSend(n.map((e=>Object.assign({},{kind:e.kind,ssrcMsg:[{ssrcId:e.ssrcId,rtx:e.rtx}],mslabel:e.mslabel}))));e.forEach(((e,t)=>{this.preSSRCMap.set(n[t].ssrcId,e)}))}await Pj(this.peerConnection,this.remoteSDP,this.extension),pk.debug("[P2PConnection] updateRemoteRTPCapabilities by exchanging SDP.")}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.updateRemoteConnect failed; ".concat(e.toString()))}}send(e,t,n){var r=this;return cw((function*(){const o=yield lw(r.mutex.lock("From P2PConnection.send"));try{if(!r.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const i=[],a=ij();e.forEach((e=>{const t=r.peerConnection.addTransceiver(e._mediaStreamTrack,mB({direction:"sendonly"},"video"===e.trackMediaType&&r.supportAV1RtpSpec&&a?{sendEncodings:[{scalabilityMode:a}]}:{}));i.push(t),e._updateRtpTransceiver(t)})),fI()&&!0===UN("SIMULCAST")&&(yield lw(r.applySimulcastForFirefox(i,e)));const s=yield lw(r.peerConnection.createOffer()),c=r.remoteSDP.predictReceivingMids(e.length),l=r.mungSendOfferSDP(s.sdp,e,c),u=qN(l),d=c.map((e=>{const t=u.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("Cannot extract ssrc from mediaDescription.");return mj(t,UN("USE_PUB_RTX"))}));let p;try{p=yield d}catch(o){p=[],r.remoteSDP.receive(e,t,n,p);const i=r.remoteSDP.toString();throw yield lw(r.peerConnection.setLocalDescription({type:"offer",sdp:l})),yield lw(r.peerConnection.setRemoteDescription({type:"answer",sdp:i})),yield lw(r.stopSending(c,!0)),o}r.remoteSDP.receive(e,t,n,p);const h=r.remoteSDP.toString(),f=r.logSDPExchange(l,"offer","local","send");return yield lw(r.peerConnection.setLocalDescription({type:"offer",sdp:l})),yield lw(r.applySimulcastEncodings(i,e)),yield lw(r.applySendEncodings(i,e)),null==f||f(h),yield lw(r.peerConnection.setRemoteDescription({type:"answer",sdp:h})),i.map(((e,t)=>{const n=c[t];return{localSSRC:d[t],id:n,transceiver:e}}))}catch(e){throw e instanceof FI?e:new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{o()}}))()}async createDataChannels(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let n=this.dataStreamChannelMap.get(e);if(n&&"open"===n.readyState)pk.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const t=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if("number"!=typeof t)throw new Error("create DataChannel error, because cannot get dc id");n=this.peerConnection.createDataChannel("datastream-channel",{id:t,negotiated:!0,ordered:!1,maxRetransmits:UN("DATASTREAM_MAX_RETRANSMITS")}),n.binaryType="arraybuffer",this.dataStreamChannelMap.set(e,n)}t.forEach((e=>{e._updateOriginDataChannel(n)}));const{needExchangeSDP:r}=this.remoteSDP.sendDataChannel();if(r){const e=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});const t=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(t),pk.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else pk.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(e){throw e instanceof FI?e:new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(e.toString()))}}async stopDataChannels(e){try{const t=this.dataStreamChannelMap.get(e);return t&&(t.id&&this.recoveredDataChannelIds.push(t.id),t.close()),void this.dataStreamChannelMap.delete(e)}catch(e){throw e instanceof FI?e:new FI(jI.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(e.toString()))}}async stopSending(e,t){const n=t?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const t=this.peerConnection.getTransceivers().filter((t=>-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");t.map((e=>{var t;iB(this.id+e.mid,this),e.direction="inactive",null===(t=e.stop)||void 0===t||t.call(e)}));const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(n),this.remoteSDP.stopReceiving(e);const o=this.remoteSDP.toString();null==r||r(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}finally{n&&n()}}async receive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:o,needExchangeSDP:i}=this.remoteSDP.send(e,t,n,r);i&&(await Pj(this.peerConnection,this.remoteSDP,this.extension),pk.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP.")));const a=this.peerConnection.getTransceivers().find((e=>e.mid===o));if(!a)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:a.receiver.track,id:o,transceiver:a}}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:t,needExchangeSDP:n}=this.remoteSDP.batchSend(e);return n&&(await Pj(this.peerConnection,this.remoteSDP,this.extension),pk.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))),t.map((e=>{const t=this.peerConnection.getTransceivers().find((t=>t.mid===e));if(!t)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:t.receiver.track,id:e,transceiver:t}}))}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");e.forEach((e=>{Array.from(this.preSSRCMap.entries()).some((t=>{let[n,r]=t;if(r===e)return this.preSSRCMap.delete(n),!0}))})),this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async muteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.mute(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(e.toString()))}}async unmuteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.unmute(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(e.toString()))}}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((e=>{e.direction="inactive"}));const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.muteRemote(e);const o=this.remoteSDP.toString();null==r||r(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((async(e,t)=>{e.direction="sendonly"}));const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.unmuteRemote(e),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec(e,this.remoteCodecs,this.store.codec);const o=this.remoteSDP.toString();null==r||r(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}restartICE(e){var t=this;return cw((function*(){const n=yield lw(t.mutex.lock("From P2PConnection.restartICE"));try{if(!t.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const n=Sk().supportPCSetConfiguration,r=UN("FORCE_TURN_TCP")||t.forceTurn;if(e===uU.RELAY&&!n)return;if(n&&!r){const n=e===uU.RELAY?"relay":"all",r=t.peerConnection.getConfiguration();r.iceTransportPolicy!==n&&(pk.debug("[".concat(t.store.clientId,"] restartICE change iceTransportPolicy from [").concat(r.iceTransportPolicy,"] to [").concat(n,"]")),r.iceTransportPolicy=n,t.peerConnection.setConfiguration(r))}t.remoteSDP.updateCandidates(e);const o=yield lw(t.peerConnection.createOffer({iceRestart:!0}));if(!o.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const i=fj(o.sdp),{remoteIceParameters:a}=yield i.iceParameters;t.remoteSDP.restartICE(a);const s=t.remoteSDP.toString(),c=t.logSDPExchange(o.sdp||"","offer","local","restartICE");t.store.descriptionStart(),yield lw(t.peerConnection.setLocalDescription(o)),null==c||c(s),yield lw(t.peerConnection.setRemoteDescription({type:"answer",sdp:s}))}catch(e){pk.warning("[".concat(t.store.clientId,"] restart ICE failed, abort operation"),e)}finally{n()}}))()}close(){var e;this.peerConnection.getTransceivers().forEach((e=>{iB(this.id+e.mid,this)})),this.preSSRCMap.clear(),this.peerConnection.close(),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return mB(mB({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const n=await this.peerConnection.createOffer(),r=this.mungSendOfferSDP(n.sdp,[t],[e]);this.remoteSDP.updateRecvMedia(e,t);const o=this.remoteSDP.toString(),i=this.logSDPExchange(r,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:r}),null==i||i(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const n=this.peerConnection.getTransceivers().filter((t=>t.mid===e));1===n.length&&(this.isVP8Simulcast(t)?fI()||await this.applySimulcastEncodings(n,[t]):await this.applySendEncodings(n,[t]))}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const n=this.peerConnection.getTransceivers().find((e=>e.mid===t));n&&await n.sender.replaceTrack(e._mediaStreamTrack)}async getSelectedCandidatePair(){const e=this.peerConnection.getReceivers();if(e.length>0&&e[0].transport&&e[0].transport.iceTransport&&e[0].transport.iceTransport.getSelectedCandidatePair&&e[0].transport.iceTransport.getSelectedCandidatePair()){const t=e[0].transport.iceTransport,{local:n,remote:r}=t.getSelectedCandidatePair();return{local:mB(mB({},cN),{},{candidateType:n.type,protocol:n.protocol,address:n.address,port:n.port}),remote:mB(mB({},cN),{},{candidateType:r.type,protocol:r.protocol,address:r.address,port:r.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;null===(e=this.onICEConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidateerror=e=>{if(e&&(e.errorCode||e.errorText)){var t;const n="code: ".concat(e.errorCode,", message: ").concat(e.errorText),r=e.port?"local: ".concat(e.port):"";pk.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICECandidateError(").concat(n,"), url: ").concat(e.url||"",", host_candidate:").concat(r)),null===(t=this.onICECandidateError)||void 0===t||t.call(this,n)}},this.peerConnection.onicegatheringstatechange=e=>{e&&e.target&&"iceGatheringState"in e.target&&pk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] RTCPeerConnection.onicegatheringstatechange(").concat(e.target.iceGatheringState,")"))},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,pk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout((()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,pk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))}),UN("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const n={iceServers:[]};return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(cA(t.turnServer.servers)?n.iceServers=t.turnServer.servers:(n.iceServers&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.servers)),UN("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),UN("FORCE_TURN_TCP")?n.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach((e=>{e.forceturn&&(n.iceTransportPolicy="relay")})))),UN("ENABLE_ENCODED_TRANSFORM")&&Sk().supportWebRTCEncodedTransform&&(n.encodedInsertableStreams=!0),n}static turnServerConfigToIceServers(e){const t=[];return e.forEach((e=>{e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(JU(e.turnServerURL),":").concat(e.tcpport,"?transport=tcp")}):(e.udpport&&!UN("FORCE_TURN_TCP")&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}))})),t}tryBindTransportEvents(e){const t=e.transport;if(t){this.transportEventReceiver=e,t.onstatechange=()=>{var e;null!=t&&t.state&&(null===(e=this.onDTLSTransportStateChange)||void 0===e||e.call(this,t.state))},t.onerror=e=>{var t;null===(t=this.onDTLSTransportError)||void 0===t||t.call(this,"error"in e?e.error:e)};const n=t.iceTransport;n&&(n.onstatechange=()=>{const e=null==t?void 0:t.iceTransport.state;var n;e&&(null===(n=this.onICETransportStateChange)||void 0===n||n.call(this,e))},n.getSelectedCandidatePair&&(n.onselectedcandidatepairchange=()=>{if(n.getSelectedCandidatePair()){const{local:e,remote:t}=n.getSelectedCandidatePair();pk.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:e.type,protocol:e.protocol}),", remote ").concat(JSON.stringify({candidateType:t.type,protocol:t.protocol,address:t.address,port:t.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(e,t){var n,r;if(!t){const n=this.peerConnection.getSenders();t=n.find((t=>t.track===e._mediaStreamTrack))}if(!t)return pk.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(e))return pk.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!Sk().supportSetRtpSenderParameters)return pk.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const o={},i={};switch(e._optimizationMode){case"motion":o.degradationPreference="maintain-framerate";break;case"detail":o.degradationPreference="maintain-resolution";break;case"balanced":o.degradationPreference="balanced"}const a=function(e,t){return e.getTransceivers().find((e=>e.sender.track===t||e.receiver.track===t))}(this.peerConnection,e._mediaStreamTrack),s=eD(e);if(rB(e)&&a&&t&&s&&this.getLocalVideoStats&&Ur(n=["vp8","vp9"]).call(n,this.store.codec)){var c;const n=o.degradationPreference||(Ur(c=e._hints).call(c,Hk.CUSTOM_TRACK)?UN("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");!function(e,t,n,r,o,i){if(iB(e,n),o(t),"balanced"!==r&&"maintain-framerate"!==r&&"maintain-resolution"!==r)return;let a=-1;QF(e,t);const s=window.setInterval((()=>{const s=oB.get(e);if(!UN("ENABLE_AG_ADAPTATION")||!s)return iB(e,n),void o(t);const c=i();if(c.sendPackets>0&&c.OutgoingAvailableBandwidth>0){if(-1===a)return void(a=Date.now());if(Date.now()-a<1e3)return;const i=c.sendFrameRate,l=c.OutgoingAvailableBandwidth,[u,d]=eB(e,i,l,s.adaptationConfig,t,r);d&&(n.qualityLimitationReason=d),u&&s.adaptationConfig.scale!==u.scale&&(pk.debug("[".concat(e,"] applyAdaptation: ").concat(n.qualityLimitationReason,"\n           sendFps ").concat(i,", bwe ").concat(l,", switch from ").concat(s.adaptationConfig.scale," to ").concat(u.scale," ")),s.adaptationConfig=nB(nB({},s.adaptationConfig),u),o(u))}}),UN("CHECK_LOCAL_STATS_INTERVAL")),c=nB({},t);oB.set(e,{timer:s,adaptationConfig:c,originConfig:t,adaptationFunc:o}),pk.debug("[".concat(e,"] start adaptation, originConfig: ").concat(JSON.stringify(t),", degradationPreference: ").concat(r))}(this.id+a.mid,s,this,n,(e=>{t&&this.updateAdaptation(t,e)}),this.getLocalVideoStats.bind(this))}if(e._encoderConfig){var l;const{bitrateMax:t,frameRate:n,scaleResolutionDownBy:r}=e._encoderConfig;t&&(i.maxBitrate=1e3*t),(Ur(l=e._hints).call(l,Hk.LOW_STREAM)||e.isUseScaleResolutionDownBy)&&(n&&(i.maxFramerate=QU(n)),r&&r>=1&&(i.scaleResolutionDownBy=r))}const{maxFramerate:u}=UN("ENCODER_CONFIG_LIMIT");if(u&&"number"==typeof u&&(i.maxFramerate=i.maxFramerate?Math.min(i.maxFramerate,u):u),UN("DSCP_TYPE")&&PI()){var d;const e=UN("DSCP_TYPE");Ur(d=["very-low","low","medium","high"]).call(d,e)&&(i.networkPriority=e)}const p=t.getParameters(),h=null===(r=p.encodings)||void 0===r?void 0:r[0];fI()&&!h&&(o.encodings=[i]),h&&Object.assign(h,i),Object.assign(p,o),pk.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(p.encodings))),await t.setParameters(p),await async function(e,t,n){try{var r;if(!Sk().supportSetRtpSenderParameters)return;if(!function(e){return"vp9"===e||"av1"===e}(e)||!UN("ENABLE_SVC"))return;const o={},i={},a=t.getParameters(),s=null===(r=a.encodings)||void 0===r?void 0:r[0];i.scalabilityMode=ij(n),s&&Object.assign(s,i),Object.assign(a,o),await t.setParameters(a),pk.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode success: ".concat(JSON.stringify(a.encodings)))}catch(e){pk.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode failed",e)}}(this.store.codec,t,UN("SVC_MODE"))}async updateAdaptation(e,t){var n,r;if(!e)return pk.debug("[updateAdaptation] no rtpSender found");if(!Sk().supportSetRtpSenderParameters)return pk.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const o={},{bitrateMax:i,frameRate:a,scaleResolutionDownBy:s}=t;i&&(o.maxBitrate=1e3*i),a&&(o.maxFramerate=QU(a)),s&&s>=1&&Ur(n=["vp8","vp9"]).call(n,this.store.codec)&&(o.scaleResolutionDownBy=s);const c=e.getParameters(),l=null===(r=c.encodings)||void 0===r?void 0:r[0];l&&Object.assign(l,o),Object.assign(c,{});try{await e.setParameters(c),pk.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(c.encodings)))}catch(t){!("transport"in e)||e.transport&&"connected"===e.transport.state?"connected"!==this.peerConnectionState?pk.debug("[updateAdaptation] peerConnection not connected}"):pk.debug("[updateAdaptation] updateRtpSenderEncodings failed",t):pk.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(e,t){try{if(!Sk().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let n=0;n<e.length;n++){const r=e[n],o=t[n];o instanceof DM&&!this.isVP8Simulcast(o)&&await this.updateRtpSenderEncodings(o,r.sender)}}catch(e){pk.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,t,n){const r=qN(e);return t.forEach(((e,t)=>{const o=n[t],i=r.mediaDescriptions.find((e=>e.attributes.mid===o));i&&(yj(i,e),Oj(i,e,this.store.codec))})),KN(r)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,n)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,e,t,n)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedLocalCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedRemoteCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onFirstVideoDecodedTimeout=e=>{var t;null===(t=this.onFirstVideoDecodedTimeout)||void 0===t||t.call(this,e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(e,t){if(e.length===t.length)for(let s=0;s<e.length;s++){var n,r,o,i,a;const c=e[s],l=t[s];if(l instanceof DM&&!Ur(n=l._hints).call(n,Hk.LOW_STREAM)&&null!==(r=l._encoderConfig)&&void 0!==r&&r.bitrateMax&&(null===(o=l._encoderConfig)||void 0===o?void 0:o.bitrateMax)>200&&null!==(i=l._scalabilityMode)&&void 0!==i&&i.numSpatialLayers&&(null===(a=l._scalabilityMode)||void 0===a?void 0:a.numSpatialLayers)>1&&"vp8"===this.store.codec){const e={},t={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};e.encodings=[{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:t.high}];const n=c.sender.getParameters();await c.sender.setParameters(Object.assign(n,e))}}}async applySimulcastEncodings(e,t){if(!fI()&&e.length===t.length)for(let n=0;n<e.length;n++){const r=t[n];if(r instanceof DM&&this.isVP8Simulcast(r)){const t=e[n],o={},i={high:1e3*(r._encoderConfig.bitrateMax-50),medium:5e4};o.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:i.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:i.medium,scaleResolutionDownBy:4}];const a=t.sender.getParameters();await t.sender.setParameters(Object.assign(a,o))}}}isVP8Simulcast(e){var t,n,r,o,i;return!!(e instanceof DM&&UN("SIMULCAST")&&"vp8"===this.store.codec&&!Ur(t=e._hints).call(t,Hk.LOW_STREAM)&&null!==(n=e._encoderConfig)&&void 0!==n&&n.bitrateMax&&(null===(r=e._encoderConfig)||void 0===r?void 0:r.bitrateMax)>200&&null!==(o=e._scalabilityMode)&&void 0!==o&&o.numSpatialLayers&&(null===(i=e._scalabilityMode)||void 0===i?void 0:i.numSpatialLayers)>1)}logSDPExchange(e,t,n,r){if(UN("SDP_LOGGING"))return pk.upload("[".concat(this.store.clientId,"] exchanging ").concat(n," ").concat(t," SDP during P2PConnection.").concat(r,"\n"),e),"offer"===t?e=>{this.logSDPExchange(e,"answer","local"===n?"remote":"local",r)}:void 0}async getRemoteSSRC(e){if(!this.remoteSDP)return;const t=this.remoteSDP.getSSRC(e);return t&&0!==t.length?t[0].ssrcId:void 0}setConfiguration(t){if(Sk().supportPCSetConfiguration){const n=e.resolvePCConfiguration(t);this.peerConnection.setConfiguration(n)}}},Sx(hB.prototype,"updateRemoteRTPCapabilities",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"updateRemoteRTPCapabilities"),hB.prototype),Sx(hB.prototype,"connect",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"connect"),hB.prototype),Sx(hB.prototype,"updateRemoteConnect",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"updateRemoteConnect"),hB.prototype),Sx(hB.prototype,"createDataChannels",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"createDataChannels"),hB.prototype),Sx(hB.prototype,"receive",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"receive"),hB.prototype),Sx(hB.prototype,"batchReceive",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"batchReceive"),hB.prototype),Sx(hB.prototype,"stopReceiving",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"stopReceiving"),hB.prototype),Sx(hB.prototype,"muteRemote",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"muteRemote"),hB.prototype),Sx(hB.prototype,"unmuteRemote",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"unmuteRemote"),hB.prototype),Sx(hB.prototype,"muteLocal",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"muteLocal"),hB.prototype),Sx(hB.prototype,"unmuteLocal",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"unmuteLocal"),hB.prototype),Sx(hB.prototype,"close",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"close"),hB.prototype),Sx(hB.prototype,"updateEncoderConfig",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"updateEncoderConfig"),hB.prototype),Sx(hB.prototype,"updateSendParameters",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"updateSendParameters"),hB.prototype),Sx(hB.prototype,"replaceTrack",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"replaceTrack"),hB.prototype),Sx(hB.prototype,"updateAdaptation",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"updateAdaptation"),hB.prototype),Sx(hB.prototype,"getRemoteSSRC",[gB],Object.getOwnPropertyDescriptor(hB.prototype,"getRemoteSSRC"),hB.prototype),hB);function gB(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("From P2PConnection.".concat(t));try{for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return await r.apply(this,i)}finally{n()}},n}function EB(e,t){let n=document.createElement("video"),r=document.createElement("canvas");n.setAttribute("style","display:none"),r.setAttribute("style","display:none"),n.setAttribute("muted",""),n.muted=!0,n.setAttribute("autoplay",""),n.autoplay=!0,n.setAttribute("playsinline",""),r.width=QU(t.width),r.height=QU(t.height);const o=QU(t.framerate||15);document.body.append(n),document.body.append(r);let i=e._mediaStreamTrack;n.srcObject=new MediaStream([i]),n.play();const a=r.getContext("2d");if(!a)throw new bk(jI.UNEXPECTED_ERROR,"can not get canvas context");const s=Sk(),c=r.captureStream(s.supportRequestFrame?0:o).getVideoTracks()[0];c.canvas||(c.canvas=r),r.startCapture=()=>{if(!n)return r.stopCapture&&r.stopCapture();if(n.paused&&n.play(),n.videoHeight>2&&n.videoWidth>2){const e=n.videoWidth,t=n.videoHeight/e,o=r.width*t;Math.abs(o-r.height)>=2&&(pk.debug("adjust low stream resolution","".concat(r.width,"x").concat(r.height," -> ").concat(r.width,"x").concat(o)),r.height=o)}a.drawImage(n,0,0,r.width,r.height),c.requestFrame&&c.requestFrame(),i!==e._mediaStreamTrack&&(i=e._mediaStreamTrack,n.srcObject=new MediaStream([i]))},r.stopCapture=TP((()=>r.startCapture&&r.startCapture()),o);const l=c.stop;return c.stop=()=>{l.call(c),n&&(n.remove(),n.srcObject=null,n=null),r&&(r.width=0,r.remove(),r.stopCapture&&r.stopCapture(),r.startCapture=void 0,r.stopCapture=void 0,r=null),pk.debug("clean low stream renderer")},c}var yB=function(e){return e[e.HEIGHT=2033]="HEIGHT",e[e.FRAME_RATE=2034]="FRAME_RATE",e[e.WIDTH=2035]="WIDTH",e}(yB||{}),_B=function(e){return e[e.FRAME_RATE=2002]="FRAME_RATE",e[e.WIDTH=2003]="WIDTH",e[e.HEIGHT=2004]="HEIGHT",e[e.PACKAGE_LOST=2005]="PACKAGE_LOST",e[e.AVG_ENCODE=2007]="AVG_ENCODE",e[e.NACKS=2009]="NACKS",e[e.PLIS=2010]="PLIS",e[e.FIRS=2011]="FIRS",e[e.BITRATE=2012]="BITRATE",e[e.PACKAGE_RATE=2031]="PACKAGE_RATE",e[e.ADAPTATION=2032]="ADAPTATION",e[e.ACTUAL_ENCODED=2060]="ACTUAL_ENCODED",e[e.BANDWIDTH=2061]="BANDWIDTH",e[e.RETRANSMIT=2062]="RETRANSMIT",e[e.TARGET_ENCODED=2064]="TARGET_ENCODED",e[e.TRANSMIT=2066]="TRANSMIT",e[e.FREEZE=2082]="FREEZE",e[e.DISABLED=2095]="DISABLED",e[e.PLAYER_STATUS=2128]="PLAYER_STATUS",e[e.QP_SUM=2143]="QP_SUM",e[e.BYTES_RETRANSMIT=2173]="BYTES_RETRANSMIT",e[e.PACKAGES_RETRANSMIT=2172]="PACKAGES_RETRANSMIT",e[e.HUGE_FRAME_SENT=2174]="HUGE_FRAME_SENT",e[e.KEY_FRAMES_ENCODED=2207]="KEY_FRAMES_ENCODED",e}(_B||{}),bB=function(e){return e[e.BITRATE=2069]="BITRATE",e[e.PACKAGE_LOST=2070]="PACKAGE_LOST",e[e.PACKAGE_RATE=2071]="PACKAGE_RATE",e[e.HEIGHT=2073]="HEIGHT",e[e.FRAME_RATE=2075]="FRAME_RATE",e[e.WIDTH=2077]="WIDTH",e}(bB||{}),TB=function(e){return e[e.JITTER=-1]="JITTER",e[e.PACKAGE_LOST=2014]="PACKAGE_LOST",e[e.WIDTH=2018]="WIDTH",e[e.HEIGHT=2019]="HEIGHT",e[e.FRAME_RATE=2020]="FRAME_RATE",e[e.JITTER_BUFFER=2023]="JITTER_BUFFER",e[e.CURRENT_DELAY=2024]="CURRENT_DELAY",e[e.NACKS=2026]="NACKS",e[e.PLIS=2027]="PLIS",e[e.FIRS=2028]="FIRS",e[e.BITRATE=2029]="BITRATE",e[e.PACKAGE_RATE=2078]="PACKAGE_RATE",e[e.FREEZE=2084]="FREEZE",e[e.DISABLED=2101]="DISABLED",e[e.PLAYER_STATUS=2129]="PLAYER_STATUS",e[e.QP_SUM=2144]="QP_SUM",e[e.I_FRAME_DELAY=2149]="I_FRAME_DELAY",e[e.FRAMES_DROPPED=2181]="FRAMES_DROPPED",e[e.BYTES_RETRANSMIT=2175]="BYTES_RETRANSMIT",e[e.PACKAGES_RETRANSMIT=2176]="PACKAGES_RETRANSMIT",e[e.PACKAGES_DISCARDED=2198]="PACKAGES_DISCARDED",e[e.AVG_DECODE=2200]="AVG_DECODE",e[e.AVG_PROCESSING_DELAY=2202]="AVG_PROCESSING_DELAY",e[e.AVG_ASSEMBLY_TIME=2203]="AVG_ASSEMBLY_TIME",e[e.AVG_INTER_FRAME_DELAY=2204]="AVG_INTER_FRAME_DELAY",e[e.KEY_FRAMES_DECODED=2206]="KEY_FRAMES_DECODED",e}(TB||{}),SB=function(e){return e[e.FRAME_RATE_DECODE=2021]="FRAME_RATE_DECODE",e[e.FRAME_RATE_RENDER=2022]="FRAME_RATE_RENDER",e[e.FRAME_RATE_OUTPUT=2155]="FRAME_RATE_OUTPUT",e[e.FREEZE_TIME=2109]="FREEZE_TIME",e[e.FREEZE_TIME_RENDER=2147]="FREEZE_TIME_RENDER",e[e.FREEZE_DURATION=2156]="FREEZE_DURATION",e}(SB||{}),OB=function(e){return e[e.PCM_LEVEL=2104]="PCM_LEVEL",e}(OB||{}),RB=function(e){return e[e.PACKAGE_LOST=-1]="PACKAGE_LOST",e[e.LEVEL=2038]="LEVEL",e[e.BITRATE=2039]="BITRATE",e[e.PACKAGE_RATE=2040]="PACKAGE_RATE",e[e.AEC_RETURN_LOSS=2041]="AEC_RETURN_LOSS",e[e.AEC_RETURN_LOSS_ENH=2042]="AEC_RETURN_LOSS_ENH",e[e.FREEZE=2081]="FREEZE",e[e.DISABLED=2096]="DISABLED",e[e.BYTES_RETRANSMIT=2179]="BYTES_RETRANSMIT",e[e.PACKAGES_RETRANSMIT=2180]="PACKAGES_RETRANSMIT",e}(RB||{}),CB=function(e){return e[e.BITRATE=2044]="BITRATE",e[e.PACKAGE_LOST=2045]="PACKAGE_LOST",e[e.PACKAGE_RATE=2046]="PACKAGE_RATE",e[e.CURRENT_DELAY=2047]="CURRENT_DELAY",e[e.JITTER_BUFFER=2054]="JITTER_BUFFER",e[e.JITTER=2055]="JITTER",e[e.FREEZE=2083]="FREEZE",e[e.DISABLED=2102]="DISABLED",e[e.PCM_LEVEL=2105]="PCM_LEVEL",e[e.PLAYER_STATUS=2130]="PLAYER_STATUS",e[e.CONCEALED_SAMPLES=2148]="CONCEALED_SAMPLES",e[e.BYTES_RETRANSMIT=2178]="BYTES_RETRANSMIT",e[e.PACKAGES_RETRANSMIT=2177]="PACKAGES_RETRANSMIT",e[e.PACKAGES_DISCARDED=2199]="PACKAGES_DISCARDED",e[e.AVG_PROCESSING_DELAY=2201]="AVG_PROCESSING_DELAY",e}(CB||{}),wB=function(e){return e[e.FREEZE_TIME=-1]="FREEZE_TIME",e[e.LEVEL=2043]="LEVEL",e}(wB||{}),IB=function(e){return e[e.RTT=2006]="RTT",e[e.CONN_TYPE=801]="CONN_TYPE",e[e.STATS_UPDATE_INTERVAL=2205]="STATS_UPDATE_INTERVAL",e}(IB||{}),AB=function(e){return e[e.RTC_PEER_CONNECTION_STATE=2219]="RTC_PEER_CONNECTION_STATE",e}(AB||{});const NB=1e3,kB=Math.max(6,3);function PB(e,t,n){null!=n&&Number.isFinite(n)&&(e[t]=Math.round(Math.max(0,n)))}function DB(e){const t={[IB.CONN_TYPE]:0,[IB.RTT]:e.rtt,[IB.STATS_UPDATE_INTERVAL]:e.updateInterval?Math.round(Math.max(0,e.updateInterval)):void 0};switch(e.selectedCandidatePair.localCandidate.candidateType){case"relay":{const n=e.selectedCandidatePair.localCandidate.relayProtocol;"udp"===n&&(t[IB.CONN_TYPE]=1),"tcp"===n&&(t[IB.CONN_TYPE]=3),"tls"===n&&(t[IB.CONN_TYPE]=4);break}case"srflx":t[IB.CONN_TYPE]=2;break;case"unknown":t[IB.CONN_TYPE]=5;break;default:t[IB.CONN_TYPE]=0}return t}function MB(e){let t=0;switch(e){case"none":t=0;break;case"cpu":t=1;break;case"bandwidth":t=2;break;case"other":t=3}return t}class LB extends eA{constructor(e){super(),OR(this,"store",void 0),OR(this,"uploadWRTCStatsTimer",void 0),OR(this,"uploadOutboundDenoiserStatsTimer",void 0),OR(this,"uploadExtStatsTimer",void 0),OR(this,"uploadExtUsageStatsTimer",void 0),OR(this,"uploadInboundExtStatsTimer",void 0),OR(this,"requestStats",void 0),OR(this,"requestTransportStats",void 0),OR(this,"requestLocalMedia",void 0),OR(this,"requestRemoteMedia",void 0),OR(this,"requestAllTracks",void 0),OR(this,"requestVideoIsReady",void 0),OR(this,"requestUploadStats",void 0),OR(this,"requestUpload",void 0),OR(this,"uploadOutboundStarted",!1),OR(this,"uploadInboundStarted",!1),OR(this,"uploadTransportStarted",!1),OR(this,"uploadBaseStatsStarted",!1),OR(this,"uploadExtensionUsageStarted",!1),OR(this,"lastRecvStats",void 0),OR(this,"lastSendStats",void 0),OR(this,"lastRefRecvStats",void 0),OR(this,"lastRefSendStats",void 0),OR(this,"lastFullRecvStats",void 0),OR(this,"lastFullSendStats",void 0),OR(this,"needUploadRenderFreezeTime",!0),this.store=e}uploadWRTCStats(e){if(!this.requestStats||!this.requestUploadStats)return;const t=e%3==0,n=e%6==0;let r,o;if(this.uploadTransportStarted&&(r=this.requestStats(),this.store.useP2P&&(o=this.requestStats(!0))),!r&&this.uploadOutboundStarted&&(r=this.requestStats()),!o&&this.uploadInboundStarted&&(o=this.requestStats(!0)),r||o){var i;const e={};if(this.uploadTransportStarted&&r){const n=this.getTransportStats(r,o,t);n&&(e.misc=[n])}if(this.uploadOutboundStarted&&r){const o=this.getOutboundStats(r,n?this.lastFullSendStats:t?this.lastRefSendStats:this.lastSendStats,t,n);o&&(e.outbound=[o])}if(this.uploadInboundStarted&&o){const r=this.getInboundStats(o,n?this.lastFullRecvStats:t?this.lastRefRecvStats:this.lastRecvStats,t,n);r&&(e.inbound=r)}const a=null===(i=this.requestTransportStats)||void 0===i?void 0:i.call(this).connectState;a&&(Array.isArray(e.misc)?e.misc[0]&&e.misc[0].addition&&(e.misc[0].addition[AB.RTC_PEER_CONNECTION_STATE]=EN[a]):e.misc=[{addition:{[AB.RTC_PEER_CONNECTION_STATE]:EN[a]}}]),this.requestUploadStats(e)}this.lastRecvStats=o,this.lastSendStats=r,n&&(this.lastFullRecvStats=o,this.lastFullSendStats=r),t&&(this.lastRefRecvStats=o,this.lastRefSendStats=r)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;this.uploadBaseStatsStarted=!0;let e=1;this.uploadWRTCStatsTimer=window.setInterval((()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted){if(this.uploadBaseStatsStarted){var t,n;const e=null===(t=this.requestTransportStats)||void 0===t?void 0:t.call(this);return void(e&&(null===(n=this.requestUploadStats)||void 0===n||n.call(this,{misc:[{addition:{[AB.RTC_PEER_CONNECTION_STATE]:EN[e.connectState]}}]})))}return this.stopUploadWRTCStats()}this.uploadWRTCStats(e),++e===kB+1&&(e=1)}),NB)}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0)}getTransportStats(e,t,n){if(!this.requestStats)return;if(!n)return null==e.rtt?void 0:{addition:{[IB.RTT]:e.rtt,[IB.CONN_TYPE]:void 0,[IB.STATS_UPDATE_INTERVAL]:e.updateInterval||void 0}};const r=DB(e);if(this.store.useP2P){if(t){const e=DB(t);r[IB.CONN_TYPE]+=e[IB.CONN_TYPE]<<3}r[IB.CONN_TYPE]+=110}else r[IB.CONN_TYPE]+=100;return{addition:r}}getOutboundStats(e,t,n,r){if(!this.requestUploadStats||!this.requestLocalMedia)return;const o=this.requestLocalMedia();if(!o||0===o.length)return;let i,a,s;return o.forEach((o=>{let[c,{track:l,ssrcs:u}]=o;switch(c){case hU.LocalVideoLowTrack:case hU.LocalVideoTrack:if(c===hU.LocalVideoTrack){const o=function(e,t,n,r,o,i){const a=t.videoSend.find((t=>t.ssrc===e));if(!a)return;const s={},{sentFrame:c,inputFrame:l}=a;if(i&&(PB(s,_B.QP_SUM,a.qpSumPerFrame),l&&c)){const e=l.frameRate,t=c.frameRate;s[_B.FREEZE]=function(e,t){let n=!0;return n=!(e<=5)&&(e<=10?t<3:e<=20?t<4:t<5),n}(e,t)?1:0}if(o){switch(c&&(PB(s,_B.HEIGHT,c.height),PB(s,_B.WIDTH,c.width),PB(s,_B.FRAME_RATE,c.frameRate)),s[_B.DISABLED]=r._originMediaStreamTrack&&!r._originMediaStreamTrack.enabled||r._mediaStreamTrack&&!r._mediaStreamTrack.enabled?1:0,a.adaptionChangeReason){case"none":s[_B.ADAPTATION]=0;break;case"cpu":s[_B.ADAPTATION]=1;break;case"bandwidth":s[_B.ADAPTATION]=2;break;case"other":s[_B.ADAPTATION]=3}let i=0;a.adaptionChangeReason&&(i+=MB(a.adaptionChangeReason)),t.qualityLimitationReason&&(i+=MB(t.qualityLimitationReason)<<3),s[_B.ADAPTATION]=i,s[_B.PLAYER_STATUS]=cP[r._player?r._player.videoElementStatus:"uninit"],PB(s,_B.NACKS,a.nacksCount),PB(s,_B.PLIS,a.plisCount),PB(s,_B.FIRS,a.firsCount),PB(s,_B.AVG_ENCODE,a.avgEncodeMs),PB(s,_B.HUGE_FRAME_SENT,a.hugeFramesSent),PB(s,_B.BYTES_RETRANSMIT,a.retransmittedBytesSent),PB(s,_B.PACKAGES_RETRANSMIT,a.retransmittedPacketsSent),PB(s,_B.KEY_FRAMES_ENCODED,a.keyFramesEncoded);const l=n&&n.videoSend.find((t=>t.ssrc===e));if(l){let e=o?NB:6e3;l.timestamp&&a.timestamp&&(e=a.timestamp-l.timestamp),null!=l.packets&&null!=a.packets&&PB(s,_B.PACKAGE_RATE,1e3*(a.packets-l.packets)/e),null!=a.packetsLost&&null!=l.packetsLost&&PB(s,_B.PACKAGE_LOST,a.packetsLost-l.packetsLost),null!=l.bytes&&null!=a.bytes&&PB(s,_B.BITRATE,8*(a.bytes-l.bytes)/e)}}return s}(u[0].ssrcId,e,t,l,n,r),i=l&&function(e,t,n,r){const o=t.videoSend.find((t=>t.ssrc===e));if(!o)return null;const i={};if(r){const e=o.inputFrame,t=e&&e.height||n.videoHeight||0,r=e&&e.width||n.videoWidth||0,a=e&&e.frameRate||0;PB(i,yB.HEIGHT,t),PB(i,yB.WIDTH,r),PB(i,yB.FRAME_RATE,a)}return i}(u[0].ssrcId,e,l,n),s=function(e,t){const n={};return t&&(PB(n,_B.RETRANSMIT,e.bitrate.retransmit),PB(n,_B.TARGET_ENCODED,e.bitrate.targetEncoded),PB(n,_B.ACTUAL_ENCODED,e.bitrate.actualEncoded),PB(n,_B.TRANSMIT,e.bitrate.transmit),PB(n,_B.BANDWIDTH,e.sendBandwidth)),n}(e,n);a=Object.assign({},o,i,s)}else s=function(e,t,n,r){const o=t.videoSend.find((t=>t.ssrc===e));if(!o)return;const i={};if(r){const t=o.sentFrame;if(t&&(PB(i,bB.HEIGHT,t.height),PB(i,bB.WIDTH,t.width),PB(i,bB.FRAME_RATE,t.frameRate)),n){const t=n.videoSend.find((t=>t.ssrc===e));if(t){let e=6e3;t.timestamp&&o.timestamp&&(e=o.timestamp-t.timestamp),null!=t.packets&&null!=o.packets&&PB(i,bB.PACKAGE_RATE,1e3*(o.packets-t.packets)/e),null!=o.packetsLost&&null!=t.packetsLost&&PB(i,bB.PACKAGE_LOST,o.packetsLost-t.packetsLost),null!=t.bytes&&null!=o.bytes&&PB(i,bB.BITRATE,8*(o.bytes-t.bytes)/e)}}}return i}(u[0].ssrcId,e,t,n);break;case hU.LocalAudioTrack:i=l&&function(e,t,n,r,o){const i=t.audioSend.find((t=>t.ssrc===e));if(!i)return;const a={};if(o){a[RB.DISABLED]=r._originMediaStreamTrack&&!r._originMediaStreamTrack.enabled||r._mediaStreamTrack&&!r._mediaStreamTrack.enabled?1:0;const t=100*r._source.getAccurateVolumeLevel(),o=i.inputLevel;if(null!=o){const e=Math.ceil(50*Math.log10(100*o+1));PB(a,RB.LEVEL,e)}PB(a,OB.PCM_LEVEL,t),PB(a,RB.AEC_RETURN_LOSS,i.aecReturnLoss),PB(a,RB.AEC_RETURN_LOSS_ENH,i.aecReturnLossEnhancement),PB(a,RB.BYTES_RETRANSMIT,i.retransmittedBytesSent),PB(a,RB.PACKAGES_RETRANSMIT,i.retransmittedPacketsSent),a[RB.FREEZE]=0;const s=n&&n.audioSend.find((t=>t.ssrc===e));if(s){let e=6e3;s.timestamp&&i.timestamp&&(e=i.timestamp-s.timestamp),null!=s.bytes&&null!=i.bytes&&PB(a,RB.BITRATE,8*(i.bytes-s.bytes)/e),null!=s.packets&&null!=i.packets&&PB(a,RB.PACKAGE_RATE,1e3*(i.packets-s.packets)/e)}}return a}(u[0].ssrcId,e,t,l,n)}})),{high:a,low:s,audio:i}}getInboundStats(e,t,n,r){if(!this.requestRemoteMedia)return;const o=this.requestRemoteMedia()||[],i=[];return o.forEach((o=>{let[a,s]=o;const c={peer:a.uid};if(s.has(lU.VIDEO)&&a.videoTrack){const o=a._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(a._videoSSRC)||!1,i=a.videoTrack?function(e,t,n,r,o,i,a,s){const c=t.videoRecv.find((t=>t.ssrc===e));if(!c)return;const l={},{receivedFrame:u,outputFrame:d,decodeFrameRate:p}=c,h=n&&n.videoRecv.find((t=>t.ssrc===e));if(PB(l,SB.FRAME_RATE_DECODE,p),c.framesRateFirefox&&PB(l,TB.FRAME_RATE,c.framesRateFirefox),u&&PB(l,TB.FRAME_RATE,u.frameRate),PB(l,TB.FRAMES_DROPPED,c.framesDroppedCount),PB(l,TB.BYTES_RETRANSMIT,c.retransmittedBytesReceived),PB(l,TB.PACKAGES_RETRANSMIT,c.retransmittedPacketsReceived),PB(l,TB.PACKAGES_DISCARDED,c.packetsDiscarded),PB(l,TB.AVG_DECODE,c.avgDecodeMs),PB(l,TB.AVG_PROCESSING_DELAY,c.avgProcessingDelayMs),PB(l,TB.AVG_ASSEMBLY_TIME,c.avgFramesAssembledFromMultiplePacketsMs),PB(l,TB.AVG_INTER_FRAME_DELAY,c.avgInterFrameDelayMs),PB(l,TB.KEY_FRAMES_DECODED,c.keyFramesDecoded),h){const e=t.timestamp-n.timestamp||NB*(s?6:a?3:1);null!=c.packetsLost&&null!=h.packetsLost&&PB(l,TB.PACKAGE_LOST,c.packetsLost-h.packetsLost),null!=h.bytes&&null!=c.bytes&&PB(l,TB.BITRATE,8*(c.bytes-h.bytes)/e),null!=h.packets&&null!=c.packets&&PB(l,TB.PACKAGE_RATE,1e3*(c.packets-h.packets)/e)}if(s&&(PB(l,TB.QP_SUM,c.qpSumPerFrame),l[TB.FREEZE]=o&&jF.isRemoteVideoFreeze(r,c,h)?1:0),a){var f;u?(PB(l,TB.HEIGHT,u.height),PB(l,TB.WIDTH,u.width)):r&&(PB(l,TB.HEIGHT,r._videoHeight||0),PB(l,TB.WIDTH,r._videoWidth||0)),d&&PB(l,SB.FRAME_RATE_OUTPUT,d.frameRate);const e=null===(f=r._player)||void 0===f?void 0:f.rendFrameRate.toFixed(0);if(e&&PB(l,SB.FRAME_RATE_RENDER,+e),PB(l,TB.JITTER_BUFFER,c.jitterBufferMs),PB(l,TB.CURRENT_DELAY,c.currentDelayMs),PB(l,TB.FIRS,c.firsCount),PB(l,TB.NACKS,c.nacksCount),PB(l,TB.PLIS,c.plisCount),r){l[TB.DISABLED]=r._originMediaStreamTrack.enabled&&r._mediaStreamTrack.enabled?0:1;const e=r._player;if(e){const{freezeTimeCounterList:t,renderFreezeAccTime:n,videoElementStatus:r}=e;if(t&&t.length>0&&PB(l,SB.FREEZE_TIME,t.splice(0,1)[0]),i&&"visible"===ZM.visibility&&r===aP.PLAYING&&Sk().supportRequestVideoFrameCallback){const t=Math.min(6e3,n);e.renderFreezeAccTime=Math.max(0,n-t),PB(l,SB.FREEZE_TIME_RENDER,t)}if("number"==typeof c.totalFreezesDuration){const e=h&&h.totalFreezesDuration?c.totalFreezesDuration-h.totalFreezesDuration:c.totalFreezesDuration;PB(l,SB.FREEZE_DURATION,1e3*e)}}}if(l[TB.PLAYER_STATUS]=cP[r._player?r._player.videoElementStatus:"uninit"],h&&void 0!==c.totalInterFrameDelay&&void 0!==c.totalSquaredInterFrameDelay&&void 0!==h.totalInterFrameDelay&&void 0!==h.totalSquaredInterFrameDelay){const e=c.totalInterFrameDelay-h.totalInterFrameDelay,t=c.totalSquaredInterFrameDelay-h.totalSquaredInterFrameDelay,n=c.framesDecodeCount-h.framesDecodeCount,r=e/n*1e3,o=Math.round(1e3*Math.sqrt((t-Math.pow(e,2)/n)/n));!isNaN(o)&&r+o>Math.max(3*r,r+150)&&(l[TB.I_FRAME_DELAY]=o)}}return l}(a._videoSSRC,e,t,a.videoTrack,!0===o,this.needUploadRenderFreezeTime,n,r):void 0;i&&(c.video=i)}if(s.has(lU.AUDIO)&&a.audioTrack){const o=a.audioTrack?function(e,t,n,r,o,i){const a=t.audioRecv.find((t=>t.ssrc===e));if(!a)return;const s={},c=n&&n.audioRecv.find((t=>t.ssrc===e));if(PB(s,CB.JITTER,a.jitterMs),PB(s,CB.BYTES_RETRANSMIT,a.retransmittedBytesReceived),PB(s,CB.PACKAGES_RETRANSMIT,a.retransmittedPacketsReceived),PB(s,CB.PACKAGES_DISCARDED,a.packetsDiscarded),PB(s,CB.AVG_PROCESSING_DELAY,a.avgProcessingDelayMs),c){const e=t.timestamp-n.timestamp||NB*(i?6:o?3:1);null!=a.packets&&null!=c.packets&&PB(s,CB.PACKAGE_RATE,1e3*(a.packets-c.packets)/e),o&&null!=c.bytes&&null!=a.bytes&&PB(s,CB.BITRATE,8*(a.bytes-c.bytes)/e),null!=a.packetsLost&&null!=c.packetsLost&&PB(s,CB.PACKAGE_LOST,a.packetsLost-c.packetsLost)}if(i){const{receivedFrames:e,droppedFrames:t}=a;null!=e&&null!=t&&(s[CB.FREEZE]=0===(l=e)||100*t/l>20?1:0)}var l;if(o){const e=100*r._source.getAccurateVolumeLevel(),t=a.outputLevel;if(null!=t){const e=Math.ceil(50*Math.log10(100*t+1));PB(s,wB.LEVEL,e)}if(PB(s,CB.PCM_LEVEL,e),r&&(s[CB.DISABLED]=r._originMediaStreamTrack.enabled&&r._mediaStreamTrack.enabled?0:1),PB(s,CB.JITTER_BUFFER,a.jitterBufferMs),PB(s,CB.CURRENT_DELAY,a.jitterBufferMs),s[CB.PLAYER_STATUS]=cP[HP.getPlayerState(r.getTrackId())],c){const e=a.concealedSamples-c.concealedSamples;e>0&&PB(s,CB.CONCEALED_SAMPLES,e)}}return s}(a._audioSSRC,e,t,a.audioTrack,n,r):void 0;o&&(c.audio=o)}(c.video||c.audio)&&i.push(c)})),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,i}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval((()=>{if(!this.requestAllTracks||!this.requestUpload)return;const e=(this.requestAllTracks()||[]).find((e=>e instanceof qD));if(e&&e._external.getDenoiserStats){const t=e._external.getDenoiserStats();t&&this.requestUpload(Px.DENOISER_STATS,t)}}),2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval((()=>{this.requestAllTracks&&this.requestUpload&&this.requestAllTracks().forEach((e=>{e.getProcessorStats().forEach((e=>{this.requestUpload&&this.requestUpload(e.type,e.stats)}))}))}),2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval((()=>{this.requestUpload&&this.requestRemoteMedia&&(this.requestRemoteMedia()||[]).forEach((e=>{let[t,n]=e;n.has(lU.VIDEO)&&t.videoTrack&&t.videoTrack.getProcessorStats().forEach((e=>{this.requestUpload&&this.requestUpload(e.type,e.stats)})),n.has(lU.AUDIO)&&t.audioTrack&&t.audioTrack.getProcessorStats().forEach((e=>{this.requestUpload&&this.requestUpload(e.type,e.stats)}))}))}),2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const e=new Map;this.uploadExtUsageStatsTimer=window.setInterval((async()=>{const t=Date.now(),n={connectionInterval:UN("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:t};let r=[];const o=this.requestAllTracks&&this.requestAllTracks()||[];for(const e of o)!e.muted&&e.enabled&&(r=r.concat(await e.getProcessorUsage()));const i=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[e,c]of i)c.has(lU.VIDEO)&&e.videoTrack&&(r=r.concat(await e.videoTrack.getProcessorUsage())),c.has(lU.AUDIO)&&e.audioTrack&&(r=r.concat(await e.audioTrack.getProcessorUsage()));if(0===r.length)return;n.details=function(e,t){const n={};for(const{id:a,value:s,level:c,direction:l}of e){var r;const e=null!==(r=t.get(a))&&void 0!==r?r:0,u=2===s?e+UN("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:e;var o,i;t.set(a,u),n[a]?(2===s&&(n[a].value=s),c>n[a].level&&(n[a].level=c),"remote"===l&&(n[a].remoteUidCount+=1),n[a].totalTs=null!==(o=t.get(a))&&void 0!==o?o:0):n[a]={value:s,level:c,remoteUidCount:"local"===l?0:1,totalTs:null!==(i=t.get(a))&&void 0!==i?i:0}}return Object.keys(n).map((e=>{const{level:t,value:r,totalTs:o}=n[e];return{id:e,level:t,value:r,totalTs:o}}))}(r,e);const a=Date.now(),s=a>t?a:t+1;this.requestUpload&&this.requestUpload(Px.EXTENSION_USAGE_STATS,{usageStats:n,sendTs:s})}),UN("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}stopUploadBaseStats(){this.uploadBaseStatsStarted=!1}}const xB=UN("ICE_RESTART_INTERVAL");let UB=new Map,jB=new Map,FB=[uU.UDP_TCP_RELAY,uU.TCP_RELAY,uU.RELAY],BB=UN("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&Sk().supportPCSetConfiguration;function VB(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=UB.get(e.id);n&&(window.clearTimeout(n),UB.delete(e.id));const r=jB.get(e.id);t&&r&&r.index===FB.length-1&&(pk.debug("[".concat(e.id,"] reset ICE restart policy")),jB.delete(e.id))}function HB(e,t,n){if(0===UB.size&&0===jB.size&&(Array.isArray(UN("RESTART_SEQUENCE"))&&UN("RESTART_SEQUENCE").length>0&&!function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1){const r=e[n];if(e.filter((e=>e===r)).length!==t.filter((e=>e===r)).length)return!1}return!0}(FB,UN("RESTART_SEQUENCE"))&&(FB=UN("RESTART_SEQUENCE").filter((e=>{var t;if(Ur(t=Object.values(uU)).call(t,e))return!0})),pk.debug("use reconnection policy from config distribution, queues: ".concat(FB.join(" => ")))),BB=UN("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&Sk().supportPCSetConfiguration),0===FB.length)return void n();let r,{index:o=0,type:i}=jB.get(e.id)||{};if(BB&&i===uU.RELAY)return void n();let a=i&&o>=FB.length-1;if(BB)i=uU.RELAY;else{if(a)return void n();i?(o++,i=FB[o]):(i=FB[0],o=0)}pk.debug("[".concat(e.id,"] choose ICE restart policy: ").concat(i,", index: ").concat(o)),t(i),jB.set(e.id,{index:o,type:i}),r=window.setTimeout((()=>HB(e,t,n)),xB),UB.set(e.id,r)}var GB;function WB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qB(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?WB(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WB(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function KB(e){var t,n,r,o=2;for("undefined"!=typeof Symbol&&(n=dw,r=Symbol.iterator);o--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new YB(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function YB(e){function t(e){if(Object(e)!==e)return ih.reject(new TypeError(e+" is not an object."));var t=e.done;return ih.resolve(e.value).then((function(e){return{value:e,done:t}}))}return YB=function(e){this.s=e,this.n=e.next},YB.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?ih.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?ih.reject(e):t(n.apply(this.s,arguments))}},new YB(e)}let zB=(GB=class extends eA{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(mU.StateChange,t,this._state)}constructor(e,t){super(),OR(this,"isPlanB",void 0),OR(this,"store",void 0),OR(this,"statsUploader",void 0),OR(this,"connection",void 0),OR(this,"localTrackMap",new Map),OR(this,"remoteUserMap",new Map),OR(this,"localDataChannels",[]),OR(this,"remoteDataChannelMap",new Map),OR(this,"pendingLocalTracks",[]),OR(this,"pendingRemoteTracks",[]),OR(this,"pendingLocalDataChannels",[]),OR(this,"pendingRemoteDataChannels",[]),OR(this,"statsCollector",void 0),OR(this,"shouldForwardP2PCreation",void 0),OR(this,"iceFailedCount",0),OR(this,"dtlsFailedCount",0),OR(this,"mutex",void 0),OR(this,"_state",fU.Disconnected),OR(this,"_pcStatsUploadType",UN("NEW_ICE_RESTART")?dU.FIRST_CONNECTION:dU.OLD_FIRST_CONNECTION),OR(this,"_isStartRestartIce",!1),OR(this,"_restartTimer",void 0),OR(this,"_isTryConnecting",!1),OR(this,"_iceError",null),OR(this,"_forceTurn",!1),OR(this,"_isWaitPcToRePub",!1),OR(this,"handleMuteLocalTrack",(async(e,t,n)=>{const r=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==fU.Connected)return void n(new FI(jI.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const r=this.filterTobeMutedTracks(e);if(0===r.length)return void t();const o=r.find((e=>"videoLowTrack"===e[0]));o&&o[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(r.map((e=>{let[,{id:t}]=e;return t})));const i=this.createMuteMessage(r);await vA(this,mU.RequestMuteLocal,i),t()}catch(e){n(e)}finally{r()}})),OR(this,"handleUnmuteLocalTrack",(async(e,t,n)=>{const r=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==fU.Connected)return void n(new FI(jI.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const r=this.filterTobeUnmutedTracks(e);if(0===r.length)return void t();const o=r.find((e=>"videoLowTrack"===e[0]));if(o){const t=o[1];if(t.track._originMediaStreamTrack.stop(),!UN("DISABLE_DUAL_STREAM_USE_ENCODING")&&Sk().supportDualStreamEncoding){const n=e._mediaStreamTrack.clone();t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n}else{const n=EB(e,EA(this,mU.RequestLowStreamParameter));t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n}await new ih(((e,n)=>{this.handleReplaceTrack(t.track,e,n,!0)}))}await this.connection.unmuteLocal(r.map((e=>{let[,{id:t}]=e;return t})));const i=this.createUnmuteMessage(r);await vA(this,mU.RequestUnmuteLocal,i),t()}catch(e){n(e)}finally{r()}})),OR(this,"handleUpdateVideoEncoder",(async(e,t,n,r)=>{let o;r||(o=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoEncoder"));try{const n=this.localTrackMap.get(hU.LocalVideoTrack);if(!this.connection||!n||n.track!==e||this.state!==fU.Connected)return void t();const{id:r,track:o}=n;await this.connection.updateSendParameters(r,o),await this.connection.updateEncoderConfig(r,o),this.emit(mU.UpdateVideoEncoder,o),t()}catch(e){n(e)}finally{var i;null===(i=o)||void 0===i||i()}})),OR(this,"handleUpdateVideoSendParameters",(async(e,t,n)=>{const r=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{const n=this.localTrackMap.get(hU.LocalVideoTrack);if(!this.connection||!n||n.track!==e||this.state!==fU.Connected)return void t();const{id:r,track:o}=n;await this.connection.updateSendParameters(r,o),t()}catch(e){n(e)}finally{r()}})),OR(this,"handleReplaceMixingTrack",(async(e,t,n,r)=>{if(!this.connection||this.state!==fU.Connected)return void t();const o=cB([e]);let i;pk.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(o.getTrackId(),"]")),"boolean"==typeof r&&r||(i=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(e,o),t()}catch(e){n(e)}finally{var a;null===(a=i)||void 0===a||a()}})),OR(this,"handleReplaceTrack",(async(e,t,n,r)=>{let o;pk.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(e.getTrackId(),"]")),"boolean"==typeof r&&r||(o=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var i;const n=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(!this.connection||!n||this.state!==fU.Connected)return void t();if(await(null===(i=this.connection)||void 0===i?void 0:i.replaceTrack(e,n[1].id)),this.isPlanB){const t=n[1];t.id=e._mediaStreamTrack.id,this.localTrackMap.set(n[0],t)}if(n[0]===hU.LocalVideoTrack&&!UN("DISABLE_DUAL_STREAM_USE_ENCODING")&&Sk().supportDualStreamEncoding){const t=this.localTrackMap.get(hU.LocalVideoLowTrack);if(t){const n=e._mediaStreamTrack.clone();t.track._originMediaStreamTrack.stop(),t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n,await new ih(((e,n)=>{this.handleReplaceTrack(t.track,e,n,!0)}))}}t()}catch(e){n(e)}finally{var a;null===(a=o)||void 0===a||a()}})),OR(this,"handleGetRTCStats",(e=>{e(this.statsCollector.getRTCStats())})),OR(this,"handleGetLocalVideoStats",(e=>{e(this.statsCollector.getLocalVideoTrackStats())})),OR(this,"handleGetLocalAudioStats",(e=>{e(this.statsCollector.getLocalAudioTrackStats())})),OR(this,"handleGetRemoteVideoStats",(e=>this.statsCollector.getRemoteVideoTrackStats(e.uid)[e.uid])),OR(this,"handleGetRemoteAudioStats",(e=>this.statsCollector.getRemoteAudioTrackStats(e.uid)[e.uid])),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new LB(this.store),this.bindStatsUploaderEvents(),this.mutex=new YA("P2PChannel-mutex",this.store.clientId),this.isPlanB=!Sk().supportUnifiedPlan||UN("CHROME_FORCE_PLAN_B")&&PI(),this.shouldForwardP2PCreation=UN("FORWARD_P2P_CREATION")&&Sk().supportPCSetConfiguration&&kI(),this.shouldForwardP2PCreation&&(this.connection=uB(this.store),this.emit(mU.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection))}async startP2PConnection(e){var t;this.state=fU.New,this._forceTurn=pB(e),pk.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] forceTurn: ").concat(this._forceTurn));const n=this.shouldForwardP2PCreation&&"closed"===(null===(t=this.connection)||void 0===t?void 0:t.peerConnectionState);if(this.shouldForwardP2PCreation&&!n||(n&&this.connection&&(pk.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.resetConnection(this.connection)),this.connection=uB(this.store,e),this.emit(mU.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),!this.connection)throw new FI(jI.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=UN("NEW_ICE_RESTART")?dU.FIRST_CONNECTION:dU.OLD_FIRST_CONNECTION,this._isTryConnecting=!0,this._isStartRestartIce=!1,this._iceError=null,this.connection.setConfiguration(e),this.connection.establishPromise}async connect(e){if(!this.connection)throw new FI(jI.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");UN("ENABLE_PREALLOC_PC")&&this.state===fU.Connected?await this.connection.updateRemoteConnect(e):(this.store.peerConnectionStart(),await this.connection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=fU.Connected)}updateRemoteRTPCapabilities(e){const t=Array.from(this.localTrackMap.entries()).filter((e=>{var t;let[n]=e;return Ur(t=[hU.LocalVideoLowTrack,hU.LocalVideoTrack]).call(t,n)})),n=t.map((e=>{let[,{id:t}]=e;return t})),r=t.map((e=>{let[t]=e;return t}));if(this.connection instanceof vB){if(_k.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(r),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(e)}),!Ur(e).call(e,this.store.codec)){const t=["vp9","vp8","h264"].find((t=>Ur(e).call(e,t)));t&&(this.store.codec=t,pk.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(t,".")))}this.connection.updateRemoteRTPCapabilities(n,e)}}async getEstablishParams(){var e;if(this.connection instanceof vB&&"closed"!==this.connection.peerConnectionState&&Ur(e=[fU.New,fU.Connected]).call(e,this.state))return this.connection.establishPromise}async publishDataChannel(e){if(!this.connection||this.state!==fU.Connected){if(this.state===fU.Disconnected)throw new FI(jI.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return e.forEach((e=>{var t;Ur(t=this.pendingLocalDataChannels).call(t,e)||this.pendingLocalDataChannels.push(e)})),[]}const t=this.filterTobePublishedDataChannels(e);return 0===t.length?[]:(t.forEach((e=>{const t=Date.now();this.store.publish(e.id.toString(),"datachannel",t)})),await this.connection.createDataChannels(this.store.uid,t),t.forEach((e=>{this.localDataChannels.push(e);const t=Date.now();this.store.publish(e.id+"","datachannel",void 0,t)})),e.map((e=>({streamId:e.id,ordered:e.ordered,maxRetransmits:e.maxRetransmits,metadata:e.metadata,channelId:e._originDataChannelId}))))}publish(e,t,n){var r=this;return cw((function*(){const o=yield lw(r.mutex.lock("From P2PChannel.publish"));try{var i;const o=r.connection&&Ur(i=["disconnected","failed"]).call(i,r.connection.peerConnectionState);if(!r.connection||r.state!==fU.Connected||o){if(r.state===fU.Disconnected)throw new FI(jI.UNEXPECTED_ERROR,"PeerConnection already disconnected.");r.throwIfTrackTypeNotMatch(e);const t=e.filter((e=>-1===r.pendingLocalTracks.indexOf(e)));return r.pendingLocalTracks=r.pendingLocalTracks.concat(t),void(o&&(r._isWaitPcToRePub=!0))}r.store.pubId=r.store.pubId+1,LF.markPublishStart(r.store.clientId,r.store.pubId);const a=r.filterTobePublishedTracks(e,t,n);if(0===a.length)return void(yield lw(r.tryToUnmuteAudio(e)));yield*uw(KB(r.doPublish(r.connection,a)))}finally{o()}}))()}doPublish(e,t){var n=this;return cw((function*(){t.forEach((e=>{let{track:t,type:r}=e;const o=Date.now();n.store.publish(t.getTrackId(),r===hU.LocalAudioTrack?"audio":"video",o)})),n.bindLocalTrackEvents(t);const r=t.map((e=>{let{track:t}=e;return t})),o=yield lw(e.send(r,n.store.codec,n.store.audioCodec)),i=(yield lw(o.next())).value,a=n.createGatewayPublishMessage(t,i);let s;try{s=yield a}catch(e){throw o.throw(e),(null==e?void 0:e.code)===jI.WS_ABORT&&t.forEach((e=>{let{track:t}=e;-1===n.pendingLocalTracks.indexOf(t)&&n.pendingLocalTracks.push(t)})),n.unbindLocalTrackEvents(t),e}const c=n.mapPubResToRemoteConfig(a,s,r),l=(yield lw(o.next(c))).value;if(n.state===fU.Disconnected)throw new FI(jI.UNEXPECTED_ERROR,"PeerConnection already disconnected.");UN("ENABLE_VIDEO_SEI");const u=UN("ENABLE_ENCODED_TRANSFORM"),d=UN("ENABLE_AUDIO_METADATA");r.forEach((async e=>{const t=e.getRTCRtpTransceiver();t&&u&&(e.trackMediaType===lU.VIDEO?await PL(t.sender,e):e.trackMediaType===lU.AUDIO&&await iL(t.sender,{metadata:d?()=>{const t=e.metadata.shift();return t&&t.value}:void 0}))})),t.forEach((e=>{let{type:t}=e;n.statsCollector.addLocalStats(t)})),n.assignLocalTracks(t,l),n.statsUploader.startUploadOutboundStats(),t.forEach((e=>{let{track:t,type:r}=e;const o=Date.now();n.store.publish(t.getTrackId(),r===hU.LocalAudioTrack?"audio":"video",void 0,o)}))}))()}async updateVideoStreamParameter(e,t){const n=this.localTrackMap.get(t);if(!n||!this.connection)return;if(!(n.track instanceof DM))return pk.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");const{track:r}=n,o=function(e,t){const n={};return e.height&&e.width&&(n.scaleResolutionDownBy=rj(e,t)),n.maxFramerate=e.framerate?QU(e.framerate):void 0,n.maxBitrate=e.bitrate?1e3*e.bitrate:void 0,n}(e,r);if(r._encoderConfig||(r._encoderConfig={}),t!==hU.LocalVideoLowTrack||!UN("DISABLE_DUAL_STREAM_USE_ENCODING")&&Sk().supportDualStreamEncoding)null!=o.scaleResolutionDownBy&&(r._encoderConfig.scaleResolutionDownBy=o.scaleResolutionDownBy);else{const t=r._originMediaStreamTrack;if(!t.canvas)return pk.warn("[".concat(r.getTrackId(),"] no canvas on track"));!function(e,t){const n=e.canvas;t.width&&(n.width=QU(t.width)),t.height&&(n.height=QU(t.height)),t.framerate&&(n.stopCapture&&n.stopCapture(),n.stopCapture=TP((()=>{!n.startCapture&&n.stopCapture&&n.stopCapture(),n.startCapture&&n.startCapture()}),QU(t.framerate)))}(t,e)}null!=o.maxBitrate&&(r._encoderConfig.bitrateMax=o.maxBitrate/1e3),null!=o.maxFramerate&&(r._encoderConfig.frameRate&&"object"==typeof r._encoderConfig.frameRate?r._encoderConfig.frameRate.max=o.maxFramerate:r._encoderConfig.frameRate={max:o.maxFramerate}),pk.debug("[".concat(r.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(r._encoderConfig))),await this.connection.updateRtpSenderEncodings(r)}publishLowStream(e){var t=this;return cw((function*(){if(!t.connection||t.state!==fU.Connected)return;const n=yield lw(t.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const n=t.localTrackMap.get(hU.LocalVideoTrack);if(!n)throw new FI(jI.UNEXPECTED_ERROR,"Could not find high stream");if(t.localTrackMap.has(hU.LocalVideoLowTrack))throw new FI(jI.UNEXPECTED_ERROR,"[".concat(t.store.clientId,"] Can't publish low stream when stream already publish"));const o=[{track:t.getLowVideoTrack(n.track,e),type:hU.LocalVideoLowTrack}];if(yield*uw(KB(t.doPublish(t.connection,o))),n.track.muted||!n.track.enabled){var r;const e=null===(r=t.localTrackMap.get(hU.LocalVideoLowTrack))||void 0===r?void 0:r.id;void 0!==e&&(yield lw(t.connection.muteLocal([e])))}}finally{n()}}))()}async republish(){this.pendingLocalTracks.length>0&&(pk.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await mA(this,mU.RequestRePublish,this.pendingLocalTracks),this.emit(mU.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(pk.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await mA(this,mU.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[]),this._isWaitPcToRePub=!1}async reSubscribe(e){for(let t=this.pendingRemoteTracks.length-1;t>=0;t--){const{user:e,kind:n}=this.pendingRemoteTracks[t];(n!==lU.AUDIO||e._audio_added_&&e._audioSSRC)&&(n!==lU.VIDEO||e._video_added_&&e._videoSSRC)||this.pendingRemoteTracks.splice(t,1)}if(e)await mA(this,mU.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:t,kind:n}of this.pendingRemoteTracks)await this.subscribe(t,n,n===lU.VIDEO?t._videoSSRC:t._audioSSRC);this.pendingRemoteTracks.forEach((e=>{let{user:t}=e;this.emit(mU.MediaReconnectEnd,t.uid)})),this.pendingRemoteTracks=[]}async unpublish(e){if(!this.connection||this.state!==fU.Connected)return void e.forEach((e=>{const t=this.pendingLocalTracks.indexOf(e);-1!==t&&this.pendingLocalTracks.splice(t,1)}));const t=this.filterTobeUnpublishedTracks(e);if(0===t.length)return;const n=t.find((e=>"videoLowTrack"===e[0]));return n&&n[1].track.close(),this.doUnpublish(this.connection,t)}async unpublishDataChannel(e){if(!this.connection||this.state!==fU.Connected)return void e.forEach((e=>{const t=this.pendingLocalDataChannels.indexOf(e);-1!==t&&this.pendingLocalDataChannels.splice(t,1)}));const t=this.filterTobeUnpublishedDataChannels(e);return 0!==t.length?(t.forEach((e=>{const t=this.localDataChannels.indexOf(e);-1!==t&&this.localDataChannels.splice(t,1)})),0===this.localDataChannels.length&&await this.connection.stopDataChannels(this.store.uid),t.map((e=>e.id))):void 0}async unpublishLowStream(){if(!this.connection||this.state!==fU.Connected)return;const e=this.localTrackMap.get(hU.LocalVideoLowTrack);if(!e)return;e.track.close();const t=[[hU.LocalVideoLowTrack,e]];return this.doUnpublish(this.connection,t)}async doUnpublish(e,t){const n=this.createGatewayUnpublishMessage(t);return await e.stopSending(t.map((e=>{let[,{id:t}]=e;return t}))),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map((e=>{let[t,{track:n}]=e;return{type:t,track:n}}))),t.forEach((e=>{let[t]=e;this.statsCollector.removeLocalStats(t)})),0===this.localTrackMap.size&&this.statsUploader.stopUploadOutboundStats(),n}async subscribeDataChannel(e,t){if(!this.connection||this.state!==fU.Connected)throw new FI(jI.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const n=t.filter((t=>{var n;return!(null!==(n=this.remoteDataChannelMap.get(e))&&void 0!==n&&n.get(t.id))}));if(0!==n.length)return await this.connection.createDataChannels(e.uid,n),n.forEach((t=>{var n;this.remoteDataChannelMap.has(e)?null===(n=this.remoteDataChannelMap.get(e))||void 0===n||n.set(t.id,t):this.remoteDataChannelMap.set(e,new Map([[t.id,t]]));const r=this.pendingRemoteDataChannels.findIndex((n=>{let{user:r,id:o}=n;return r.uid===e.uid&&o===t.id}));-1!==r&&this.pendingRemoteDataChannels.splice(r,1)})),n.map((e=>e.id))}async subscribe(e,t,n,r,o){var i;if(!this.connection||this.state!==fU.Connected)throw new FI(jI.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if(null!==(i=this.remoteUserMap.get(e))&&void 0!==i&&i.has(t))return;let a,s,c;const l=this.connection.getPreMedia(n);if(l)pk.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] preSSRCMap has ssrcId: ").concat(n,", no need to send sub to gateway.")),c=l.transceiver,a=l.track,s=l.id;else if(o){const n=o.find((e=>{let{stream_type:n}=e;return n===t}));if(!n)throw new FI(jI.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(t," for user: ").concat(e.uid," because subscribe answer from gateway does not contain stream_type: ").concat(t,"."));const r=await this.connection.receive(t,n.ssrcs,String(e._uintid),n.attributes);this.connection instanceof vB&&(c=r.transceiver),a=r.track,s=r.id}else{const o=await this.connection.receive(t,[{ssrcId:n,rtx:r}],String(e._uintid),void 0);this.connection instanceof vB&&(c=o.transceiver),a=o.track,s=o.id}t===lU.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(a):(e._audioTrack=new JM(a,e.uid,e._uintid,this.store),pk.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),c&&e._audioTrack._updateRtpTransceiver(c),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(a):(e._videoTrack=new XM(a,e.uid,e._uintid,this.store),pk.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),c&&e._videoTrack._updateRtpTransceiver(c),this.bindRemoteTrackEvents(e,e._videoTrack)),c&&UN("ENABLE_ENCODED_TRANSFORM")&&(t==lU.VIDEO?await ML(c.receiver,{onSei:UN("ENABLE_VIDEO_SEI")&&(t=>{var n;return null===(n=e._videoTrack)||void 0===n?void 0:n._onSei(t)})}):t==lU.AUDIO&&await AL(c.receiver,{enableTopn:!!UN("ENABLE_AUDIO_TOPN"),enableMetadata:!!UN("ENABLE_AUDIO_METADATA"),onMetadata:e=>{this.safeEmit(mU.AudioMetadata,e)}}));const u=this.remoteUserMap.get(e);u?u.set(t,s):this.remoteUserMap.set(e,new Map([[t,s]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats();const d=this.pendingRemoteTracks.findIndex((n=>{let{user:r,kind:o}=n;return r.uid===e.uid&&t===o}));-1!==d&&(this.pendingRemoteTracks.splice(d,1),this.emit(mU.MediaReconnectEnd,e.uid))}async massSubscribe(e){return this.massSubscribeNoLock(e)}async massSubscribeNoLock(e){if(!this.connection||this.state!==fU.Connected)throw new FI(jI.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");e=e.filter((e=>{var t;let{user:n,mediaType:r}=e;return!(null!==(t=this.remoteUserMap.get(n))&&void 0!==t&&t.has(r))}));const t=[],n=new Map;e.forEach((e=>{if(!this.connection)return;const r=this.connection.getPreMedia(e.ssrcId);r?n.set(e.ssrcId,r):t.push(e)}));const r=await this.connection.batchReceive(t.map((e=>{let{user:t,mediaType:n,ssrcId:r,rtxSsrcId:o}=e;return{kind:n,ssrcMsg:[{ssrcId:r,rtx:o}],mslabel:String(t._uintid)}})));t.forEach(((e,t)=>{n.set(e.ssrcId,r[t])}));for(const{user:o,mediaType:i,ssrcId:a}of e){const e=n.get(a);if(!e)return void pk.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] cannot find ").concat(o.uid," subscribe data,").concat(i,", ").concat(a));const{track:t,id:r,transceiver:s}=e;s&&UN("ENABLE_ENCODED_TRANSFORM")&&(i==lU.VIDEO?await ML(s.receiver,{onSei:UN("ENABLE_VIDEO_SEI")&&(e=>{var t;return null===(t=o._videoTrack)||void 0===t?void 0:t._onSei(e)})}):i==lU.AUDIO&&await AL(s.receiver,{enableTopn:!!UN("ENABLE_AUDIO_TOPN"),enableMetadata:!!UN("ENABLE_AUDIO_METADATA"),onMetadata:e=>{this.safeEmit(mU.AudioMetadata,e)}})),i===lU.AUDIO?(o._audioTrack?o._audioTrack._updateOriginMediaStreamTrack(t):(o._audioTrack=new JM(t,o.uid,o._uintid,this.store),pk.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(o._audioTrack.getTrackId()))),s&&o._audioTrack._updateRtpTransceiver(s),this.bindRemoteTrackEvents(o,o._audioTrack)):(o._videoTrack?o._videoTrack._updateOriginMediaStreamTrack(t):(o._videoTrack=new XM(t,o.uid,o._uintid,this.store),pk.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(o._videoTrack.getTrackId()))),s&&o._videoTrack._updateRtpTransceiver(s),this.bindRemoteTrackEvents(o,o._videoTrack)),UN("ENABLE_VIDEO_SEI")&&s&&(i==lU.VIDEO?await ML(s.receiver,{onSei:e=>{var t;null===(t=o._videoTrack)||void 0===t||t._onSei(e)}}):i==lU.AUDIO&&await AL(s.receiver));const c=this.remoteUserMap.get(o);c?c.set(i,r):this.remoteUserMap.set(o,new Map([[i,r]])),this.statsCollector.addRemoteStats(o.uid),this.statsUploader.startUploadInboundStats();const l=this.pendingRemoteTracks.findIndex((e=>{let{user:t,kind:n}=e;return t.uid===o.uid&&i===n}));-1!==l&&(this.pendingRemoteTracks.splice(l,1),this.emit(mU.MediaReconnectEnd,o.uid))}}async unsubscribe(e,t,n){const r=this.pendingRemoteTracks.filter((n=>{let{user:r,kind:o}=n;return void 0!==t?r.uid===e.uid&&t===o:r.uid===e.uid}));if(r.forEach((e=>{const t=this.pendingRemoteTracks.indexOf(e);this.pendingRemoteTracks.splice(t,1)})),this.connection&&this.state===fU.Connected||n||r.forEach((t=>{let{kind:n}=t;var r;if(n===lU.AUDIO)null===(r=e._audioTrack)||void 0===r||r._destroy(),e._audioTrack=void 0;else if(n===lU.VIDEO){var o;null===(o=e._videoTrack)||void 0===o||o._destroy(),e._videoTrack=void 0}})),!this.connection||this.state!==fU.Connected)return;const o=this.filterTobeUnSubscribedTracks(e,t);if(0===o.length)return;await this.connection.stopReceiving(o.map((e=>{let[,{id:t}]=e;return t})));const i=this.createUnsubscribeMessage(o);return this.withdrawRemoteTracks(o),0===this.remoteUserMap.size&&this.statsUploader.stopUploadInboundStats(),o.forEach((e=>{let[t,{kind:r}]=e;var o,i;if(r===lU.VIDEO&&t._videoSSRC&&(null===(o=this.connection)||void 0===o||o.setStatsRemoteVideoIsReady(t._videoSSRC,!1)),r===lU.VIDEO)this.unbindRemoteTrackEvents(t._videoTrack),n||(null===(i=t._videoTrack)||void 0===i||i._destroy(),t._videoTrack=void 0);else if(r===lU.AUDIO){var a;this.unbindRemoteTrackEvents(t._audioTrack),n||(null===(a=t._audioTrack)||void 0===a||a._destroy(),t._audioTrack=void 0)}})),i}async unsubscribeDataChannel(e,t){if(t.forEach((e=>{const t=this.pendingRemoteDataChannels.findIndex((t=>t.id===e.id));-1!==t&&this.pendingRemoteDataChannels.splice(t,1)})),!this.connection)return;const n=this.filterTobeUnSubscribedDataChannels(e,t);if(0===n.length)return;t.forEach((e=>{e._close()}));const r=this.remoteDataChannelMap.get(e);return n.forEach((e=>{r&&r.delete(e.id)})),r&&0===r.size&&(this.remoteDataChannelMap.delete(e),await this.connection.stopDataChannels(e.uid)),n.map((e=>e.id))}async massUnsubscribe(e){return this.massUnsubscribeNoLock(e)}async massUnsubscribeNoLock(e){let t=[];for(const{user:o,mediaType:i}of e){const e=this.pendingRemoteTracks.filter((e=>{let{user:t,kind:n}=e;return void 0!==i?t.uid===o.uid&&i===n:t.uid===o.uid}));e.forEach((e=>{const t=this.pendingRemoteTracks.indexOf(e);this.pendingRemoteTracks.splice(t,1)})),t=t.concat(e)}if(!this.connection||this.state!==fU.Connected)return void t.forEach((e=>{let{user:t,kind:n}=e;var r;if(n===lU.AUDIO)null===(r=t._audioTrack)||void 0===r||r._destroy(),t._audioTrack=void 0;else if(n===lU.VIDEO){var o;null===(o=t._videoTrack)||void 0===o||o._destroy(),t._videoTrack=void 0}}));const n=so(e).call(e,((e,t)=>{let{user:n,mediaType:r}=t;const o=this.filterTobeUnSubscribedTracks(n,r);return e.concat(o)}),[]);if(0===n.length)return;await this.connection.stopReceiving(n.map((e=>{let[,{id:t}]=e;return t})));const r=this.createUnsubscribeAllMessage(n);return this.withdrawRemoteTracks(n),0===this.remoteUserMap.size&&this.statsUploader.stopUploadInboundStats(),n.forEach((e=>{let[t,{kind:n}]=e;var r,o;if(n===lU.VIDEO&&t._videoSSRC&&(null===(r=this.connection)||void 0===r||r.setStatsRemoteVideoIsReady(t._videoSSRC,!1)),n===lU.VIDEO)this.unbindRemoteTrackEvents(t._videoTrack),null===(o=t._videoTrack)||void 0===o||o._destroy(),t._videoTrack=void 0;else if(n===lU.AUDIO){var i;this.unbindRemoteTrackEvents(t._audioTrack),null===(i=t._audioTrack)||void 0===i||i._destroy(),t._audioTrack=void 0}})),r}isPreSubScribe(e){return!(!this.connection||this.state!==fU.Connected)&&!!this.connection.getPreMedia(e)}async muteRemote(e,t){if(!this.connection)return;const n=this.remoteUserMap.get(e);if(!n)return void pk.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid,"."));if(!n.get(t))return void pk.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));const r=t===lU.VIDEO?e._videoSSRC:e._audioSSRC;void 0!==r&&this.connection.setStatsRemoteVideoIsReady(r,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.connection)return;const n=this.remoteUserMap.get(e);n?n.get(t)||pk.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,".")):pk.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid,"."))}addAudioMetadata(e){const t=this.localTrackMap.get(hU.LocalAudioTrack),n=t&&t.track;n&&n.metadata.push(e)}getAllTracks(e){const t=this.localTrackMap.get(hU.LocalAudioTrack);if((null==t?void 0:t.track)instanceof YD){const n=t.track;return Array.from(this.localTrackMap.entries()).filter((e=>{let[t]=e;return t!==hU.LocalAudioTrack})).filter((t=>{let[n]=t;return!(e&&n===hU.LocalVideoLowTrack)})).map((e=>{let[,{track:t}]=e;return t})).concat(n.trackList)}return Array.from(this.localTrackMap.entries()).filter((t=>{let[n]=t;return!(e&&n===hU.LocalVideoLowTrack)})).map((e=>{let[,{track:t}]=e;return t}))}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(e,t,n,r,o){if(e){const n=this.localTrackMap.get(hU.LocalAudioTrack),i=r?this.localTrackMap.get(hU.LocalVideoLowTrack):this.localTrackMap.get(hU.LocalVideoTrack);_k.publish(this.store.sessionId,{eventElapse:LF.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==n?void 0:n.track.getTrackLabel(),videoName:null==i?void 0:i.track.getTrackLabel(),screenshare:-1!==(null==i?void 0:i.track._hints.indexOf(Hk.SCREEN_TRACK)),audio:!!n,video:!!i,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:o})}else{var i;n||(n=[]);const a=n.find((e=>e instanceof WD)),s=r?null===(i=this.localTrackMap.get(hU.LocalVideoTrack))||void 0===i?void 0:i.track:n.find((e=>e instanceof DM));_k.publish(this.store.sessionId,{eventElapse:LF.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==a?void 0:a.getTrackLabel(),videoName:null==s?void 0:s.getTrackLabel(),screenshare:-1!==(null==s?void 0:s._hints.indexOf(Hk.SCREEN_TRACK)),audio:!!a,video:!!s,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:o})}}reportSubscribeEvent(e,t,n,r){const o=r===lU.VIDEO?n._videoSSRC:n._audioSSRC;o&&_k.subscribe(this.store.sessionId,{succ:e,ec:t,video:r===lU.VIDEO,audio:r===lU.AUDIO,peerid:n.uid,subscribeRequestid:o,p2pid:this.store.p2pId,eventElapse:LF.measureFromSubscribeStart(this.store.clientId,o),preSsrc:this.isPreSubScribe(o)})}reset(){pk.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new YA("P2PChannel-mutex",this.store.clientId),this.connection&&(this.resetConnection(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=uB(this.store),this.emit(mU.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.statsUploader.stopUploadBaseStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(hU.LocalAudioTrack);if((null==e?void 0:e.track)instanceof YD){if(e.track.trackList.length>0){const t=e.track;e.track.trackList.forEach((e=>{t.removeAudioTrack(e)}))}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=fU.Disconnected}getStats(){var e;return null===(e=this.connection)||void 0===e?void 0:e.getStats()}getRemoteVideoIsReady(e){var t;return(null===(t=this.connection)||void 0===t?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(hU.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(hU.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof DM||t&&t.track instanceof WD?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}getRemoteMedia(e){var t;const n=Array.from(tk(t=this.remoteUserMap).call(t)).find((t=>t.uid===e));return n?{audioTrack:n.audioTrack,audioSSRC:n._audioSSRC,videoTrack:n.videoTrack,videoSSRC:n._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map((e=>{let[t]=e;return{uid:t.uid,level:t.audioTrack?100*t.audioTrack._source.getAccurateVolumeLevel():0}}));const t=this.localTrackMap.get(hU.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=Xy(e).call(e,((e,t)=>e.level-t.level)),e}async disconnectForReconnect(){this.connection&&(pk.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=fU.Reconnecting,UN("KEEP_LAST_FRAME")&&0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t]=e;var n;t._videoTrack&&t._videoTrack._player&&(null===(n=t._videoTrack._player.getVideoElement())||void 0===n||n.pause(),t._videoTrack._player.isKeepLastFrame=!0,t._videoTrack._originMediaStreamTrack.stop())})),this.resetConnection(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=uB(this.store),this.emit(mU.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),0!==this.localTrackMap.size&&(Array.from(this.localTrackMap.entries()).forEach((e=>{var t;let[n,{track:r}]=e;switch(n){case hU.LocalVideoTrack:Ur(t=r._hints).call(t,Hk.LOW_STREAM)?r.close():this.pendingLocalTracks.push(r);break;case hU.LocalAudioTrack:r instanceof YD?this.pendingLocalTracks=this.pendingLocalTracks.concat(r.trackList):this.pendingLocalTracks.push(r);case hU.LocalVideoLowTrack:}})),this.emit(mU.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t,n]=e;Array.from(tk(n).call(n)).forEach((e=>{this.setPendingRemoteMedia(t,e)})),this.emit(mU.MediaReconnectStart,t.uid)})),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),0!==this.localDataChannels.length&&(this.localDataChannels.forEach((e=>{this.pendingLocalDataChannels.push(e)})),this.localDataChannels.length=0),0!==this.remoteDataChannelMap.size&&(Array.from(this.remoteDataChannelMap.entries()).forEach((e=>{let[t,n]=e;Array.from(tk(n).call(n)).forEach((e=>{this.setPendingRemoteDataChannel(t,e)}))})),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),pk.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(e,t){for(const n of this.pendingRemoteDataChannels){const{user:r,id:o}=n;if((e instanceof VF?e.uid:e)===r.uid&&o===t)return!0}return!1}setPendingRemoteDataChannel(e,t){this.hasPendingRemoteDataChannel(e,t)||this.pendingRemoteDataChannels.push({user:e,id:t})}hasPendingRemoteMedia(e,t){for(const n of this.pendingRemoteTracks){const{user:r,kind:o}=n;if((e instanceof VF?e.uid:e)===r.uid&&t===o)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}restartICE(e){var t=this;return cw((function*(){if(!t.connection||t.state!==fU.Connected)return;const n=yield lw(t.mutex.lock("From P2PChannel.restartICE"));let r;try{r=yield lw(t.connection.restartICE(e));const n=yield lw(r.next());if(n.done)return;const o=n.value,i=yield o;switch(dB(t.connection)&&t.reportPCStats(Date.now(),!1,t._pcStatsUploadType),e){case uU.UDP_TCP_RELAY:t._pcStatsUploadType=dU.UDP_TCP_RESTART;break;case uU.TCP_RELAY:t._pcStatsUploadType=dU.TCP_RESTART;break;case uU.RELAY:t._pcStatsUploadType=dU.RELAY_RESTART;break;default:t._pcStatsUploadType=dU.OLD_RESTART}t._isTryConnecting=!0,r.next(i)}catch(e){var o;null===(o=r)||void 0===o||o.throw(e)}finally{n()}}))()}getUplinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats(),t=this.localTrackMap.get(hU.LocalVideoTrack),n=this.localTrackMap.get(hU.LocalAudioTrack),r=e.videoSend.find((e=>e.ssrc===(null==t?void 0:t.ssrcs[0].ssrcId))),o=e.audioSend.find((e=>e.ssrc===(null==n?void 0:n.ssrcs[0].ssrcId)));if(!r||!o)return 1;const i=gA(this,mU.NeedSignalRTT),a=r?r.rttMs:void 0,s=o?o.rttMs:void 0,c=a&&s?(a+s)/2:a||s,l=(c&&i?(c+i)/2:c||i)||0,u=100*e.sendPacketLossRate*.7/50+.3*l/1500,d=u<.17?1:u<.36?2:u<.59?3:u<.1?4:5,p=null==t?void 0:t.track;if(p&&p._encoderConfig&&-1===p._hints.indexOf(Hk.SCREEN_TRACK)){const t=p._encoderConfig.bitrateMax,n=e.bitrate.actualEncoded;if(t&&n){const e=(1e3*t-n)/(1e3*t);return xL[e<.15?0:e<.3?1:e<.45?2:e<.6?3:4][d]}}return d}getDownlinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach((n=>{let[r]=n;const o=r._audioSSRC,i=r._videoSSRC,a=e.audioRecv.find((e=>e.ssrc===o)),s=e.videoRecv.find((e=>e.ssrc===i));if(!a&&!s)return void(t+=1);const c=gA(this,mU.NeedSignalRTT),l=e.rtt,u=(l&&c?(l+c)/2:l||c)||0,d=a?a.jitterMs:void 0,p=e.recvPacketLossRate;let h=.7*p*100/50+.3*u/1500;d&&(h=.6*p*100/50+.2*u/1500+.2*d/400),t+=h<.1?1:h<.17?2:h<.36?3:h<.59?4:5})),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new ih(((t,n)=>{this.handleMuteLocalTrack(e,t,n)}))}async replaceTrack(e,t){var n;if(pk.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(e.getTrackId(),"] to [").concat(t.getTrackId(),"]")),!this.connection||this.state!==fU.Connected)return;const r=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(!r)return;const o=r[0];if(e!==t&&(this.unbindLocalTrackEvents([{track:e,type:o}]),this.bindLocalTrackEvents([{track:t,type:o}]),r[1].track=t),await(null===(n=this.connection)||void 0===n?void 0:n.replaceTrack(t,r[1].id)),this.isPlanB){const e=r[1];e.id=t._mediaStreamTrack.id,this.localTrackMap.set(o,e)}if(o===hU.LocalVideoTrack&&!UN("DISABLE_DUAL_STREAM_USE_ENCODING")&&Sk().supportDualStreamEncoding){const t=this.localTrackMap.get(hU.LocalVideoLowTrack);if(t){const n=e._mediaStreamTrack.clone();t.track._originMediaStreamTrack.stop(),t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n,await new ih(((e,n)=>{this.handleReplaceTrack(t.track,e,n,!0)}))}}}filterTobePublishedTracks(e,t,n){const r=[],o=this.getAllTracks();e=bA(e=e.filter((e=>-1===o.indexOf(e))));let i,a=!1;const s=this.localTrackMap.get(hU.LocalAudioTrack);for(const c of e){if(c instanceof DM&&(this.localTrackMap.has(hU.LocalVideoTrack)||a?new FI(jI.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(r.push({track:c,type:hU.LocalVideoTrack}),a=!0),t)){const e=this.getLowVideoTrack(c,n);r.push({track:e,type:hU.LocalVideoLowTrack})}if(c instanceof WD)if(s){const e=s.track;if(e instanceof YD)sB([c]),e.addAudioTrack(c),this.bindLocalAudioTrackEvents(c,!0);else{const t=cB([e,c]);pk.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(t.getTrackId(),"]")),this.replaceTrack(e,t)}}else i instanceof YD?(sB([c]),i.addAudioTrack(c)):i=i||!c._useAudioElement&&Sk().webAudioMediaStreamDest&&!c._bypassWebAudio?cB(i?[c,i]:[c]):c}return i&&(pk.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(i.getTrackId(),"]")),r.push({track:i,type:hU.LocalAudioTrack})),r}filterTobeUnpublishedTracks(e){const t=[],n=this.getAllTracks();e=bA(e=e.filter((e=>-1!==n.indexOf(e))));for(const r of e){if(r instanceof WD){const e=this.localTrackMap.get(hU.LocalAudioTrack);if(!e)continue;e.track instanceof YD?(e.track.removeAudioTrack(r),this.unbindLocalAudioTrackEvents(r),0===e.track.trackList.length&&(t.push([hU.LocalAudioTrack,e]),e.track.close())):t.push([hU.LocalAudioTrack,e])}if(r instanceof DM){const e=this.localTrackMap.get(hU.LocalVideoTrack);if(!e)continue;t.push([hU.LocalVideoTrack,e]);const n=this.localTrackMap.get(hU.LocalVideoLowTrack);n&&t.push([hU.LocalVideoLowTrack,n])}}return t}filterTobePublishedDataChannels(e){return(e=bA(e)).filter((e=>-1===this.localDataChannels.findIndex((t=>t.id===e.id))))}filterTobeUnpublishedDataChannels(e){return(e=(e=bA(e)).filter((e=>-1!==this.localDataChannels.indexOf(e)))).filter((e=>e._originDataChannel))}bindLocalTrackEvents(e){e.forEach((e=>{let{track:t,type:n}=e;switch(n){case hU.LocalVideoTrack:t.addListener(Vk.GET_STATS,this.handleGetLocalVideoStats),t.addListener(Vk.GET_RTC_STATS,this.handleGetRTCStats),t.addListener(Vk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(Vk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(Vk.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.addListener(Vk.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),t.addListener(Vk.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.addListener(Vk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(Vk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case hU.LocalAudioTrack:this.bindLocalAudioTrackEvents(t);case hU.LocalVideoLowTrack:}}))}bindLocalAudioTrackEvents(e,t){e instanceof YD?e.trackList.forEach((e=>{e.addListener(Vk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(Vk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(Vk.GET_STATS,this.handleGetLocalAudioStats),e.addListener(Vk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(Vk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)})):(e.addListener(Vk.GET_STATS,this.handleGetLocalAudioStats),e.addListener(Vk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(Vk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(Vk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(Vk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||(e.addListener(Vk.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.addListener(Vk.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map((e=>{let[t,{track:n}]=e;return{track:n,type:t}}))),e.forEach((e=>{let{track:t,type:n}=e;switch(n){case hU.LocalVideoTrack:t.off(Vk.GET_STATS,this.handleGetLocalVideoStats),t.off(Vk.GET_RTC_STATS,this.handleGetRTCStats),t.off(Vk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(Vk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(Vk.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.off(Vk.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),t.off(Vk.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(Vk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(Vk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case hU.LocalAudioTrack:this.unbindLocalAudioTrackEvents(t);case hU.LocalVideoLowTrack:}}))}unbindLocalAudioTrackEvents(e){e instanceof YD?e.trackList.forEach((e=>{e.off(Vk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(Vk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(Vk.GET_STATS,this.handleGetLocalAudioStats),e.off(Vk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(Vk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)})):(e.off(Vk.GET_STATS,this.handleGetLocalAudioStats),e.off(Vk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(Vk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(Vk.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(Vk.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),e.off(Vk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(Vk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof XM&&t.addListener(Vk.GET_STATS,(t=>{t(this.handleGetRemoteVideoStats(e))})),t instanceof JM&&t.addListener(Vk.GET_STATS,(t=>{t(this.handleGetRemoteAudioStats(e))}))}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(Vk.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t,n]=e;n.has(lU.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),n.has(lU.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)}))}createGatewayPublishMessage(e,t){return e.map(((e,n)=>{var r;let o,i,{track:a,type:s}=e;switch(s){case hU.LocalAudioTrack:o=Zx.Audio,i={dtx:a instanceof qD&&a._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case hU.LocalVideoTrack:o=Ur(r=a._hints).call(r,Hk.SCREEN_TRACK)?Zx.Screen:Zx.High,i=qB(qB({},$U(a)),{},{codec:this.store.codec,svc_mode:ij()});break;case hU.LocalVideoLowTrack:o=Zx.Low,i=qB(qB({},$U(a)),{},{codec:this.store.codec,svc_mode:ij()})}return{stream_type:o,attributes:i,ssrcs:t[n]}}))}createGatewayUnpublishMessage(e){return e.map((e=>{var t;let n,[r,{track:o,ssrcs:i,id:a}]=e;switch(r){case hU.LocalVideoTrack:n=Ur(t=o._hints).call(t,Hk.SCREEN_TRACK)?Zx.Screen:Zx.High;break;case hU.LocalAudioTrack:n=Zx.Audio;break;case hU.LocalVideoLowTrack:n=Zx.Low}return{stream_type:n,ssrcs:i,mid:a}}))}assignLocalTracks(e,t){e.forEach(((e,n)=>{let{track:r,type:o}=e;this.localTrackMap.set(o,{track:r,id:t[n].id,ssrcs:t[n].localSSRC})}))}withdrawLocalTracks(e){e.forEach((e=>{let[t]=e;this.localTrackMap.delete(t)}))}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{if(pk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(t,")")),this.emit(mU.PeerConnectionStateChange,t),"connected"!==t||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),"connected"===t&&(this._restartTimer&&(window.clearTimeout(this._restartTimer),this._restartTimer=void 0),e instanceof vB&&VB(e,!0),this._isTryConnecting&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isTryConnecting=!1,this._isStartRestartIce=!1,this._pcStatsUploadType=dU.DISCONNECTED_OR_FAILED,"CONNECTED"===gA(this,mU.QueryClientConnectionState)&&this._isWaitPcToRePub)){const e=this.pendingLocalTracks.map((e=>e.getTrackId())),t=this.pendingLocalDataChannels.map((e=>"dc_".concat(e.id)));_k.reportApiInvoke(this.store.sessionId,{name:rA.REPUB_AFTER_PC_CONNECTED,options:e.concat(t),tag:oA.TRACER}).onSuccess(),this.republish()}if(UN("NEW_ICE_RESTART")&&e instanceof vB&&!fI()&&!this._forceTurn){if(Ur(pU).call(pU,t)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const t=t=>{dB(e)&&(pk.debug("[".concat(this.store.clientId,"] [P2PChannel] try to restartICE, type is ").concat(t)),"CONNECTED"===gA(this,mU.QueryClientConnectionState)&&this.emit(mU.RequestRestartICE,t))},n=()=>{dB(e)&&(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),pk.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout((()=>this.emit(mU.P2PLost)),0),this.iceFailedCount+=1,this.requestReconnect())};return void(this._restartTimer=window.setTimeout((()=>{HB(e,t,n)}),800))}}else{if("disconnected"===t&&"disconnected"===e.iceConnectionState)return setTimeout((()=>{"disconnected"===e.iceConnectionState&&UN("ICE_RESTART")&&"CONNECTED"===gA(this,mU.QueryClientConnectionState)&&this.emit(mU.RequestRestartICE)}),800),void setTimeout((()=>{"disconnected"===e.peerConnectionState&&(pk.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isTryConnecting=!1,setTimeout((()=>this.emit(mU.P2PLost)),0),this.iceFailedCount+=1,this.requestReconnect())}),4e3);"failed"===t&&(pk.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),setTimeout((()=>this.emit(mU.P2PLost)),0),this.iceFailedCount+=1,await this.requestReconnect())}},e.onICEConnectionStateChange=e=>{"connected"!==e||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),pk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(e,")")),_k.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:e,tag:oA.TRACER}).onSuccess(),this.emit(mU.IceConnectionStateChange,e)},e.onICETransportStateChange=e=>{pk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(e,")"))},e.onDTLSTransportStateChange=e=>{pk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(e,")"))},e.onDTLSTransportError=e=>{pk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(e,")"))},e.onFirstAudioDecoded=e=>{var t;const n=Array.from(tk(t=this.remoteUserMap).call(t)).find((t=>t._audioSSRC===e));var r;n&&(this.store.subscribe(n.uid,"audio",void 0,void 0,void 0,Date.now()),null===(r=n.audioTrack)||void 0===r||r.emit(zk.FIRST_FRAME_DECODED),_k.firstRemoteFrame(this.store.sessionId,vk.FIRST_AUDIO_DECODE,gk.FIRST_AUDIO_DECODE,{peer:n._uintid,subscribeElapse:LF.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=e=>{var t;const n=Array.from(tk(t=this.remoteUserMap).call(t)).find((t=>t._audioSSRC===e));n&&_k.firstRemoteFrame(this.store.sessionId,vk.FIRST_AUDIO_RECEIVED,gk.FIRST_AUDIO_RECEIVED,{peer:n._uintid,subscribeElapse:LF.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(e,t,n)=>{this.reportVideoFirstFrameDecoded(e,t,n)},e.onFirstVideoReceived=e=>{var t;const n=Array.from(tk(t=this.remoteUserMap).call(t)).find((t=>t._videoSSRC===e));n&&_k.firstRemoteFrame(this.store.sessionId,vk.FIRST_VIDEO_RECEIVED,gk.FIRST_VIDEO_RECEIVED,{peer:n._uintid,subscribeElapse:LF.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(e,t)=>{const n="relay"===e.candidateType,r="relay"===t.candidateType;"unknown"!==t.candidateType&&n===r||this.emit(mU.ConnectionTypeChange,n),pk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(oj(t))," -> ").concat(JSON.stringify(oj(e)),")"))},e.onSelectedRemoteCandidateChanged=(e,t)=>{pk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(oj(t))," -> ").concat(JSON.stringify(oj(e)),")"))},e.onFirstVideoDecodedTimeout=e=>{this.reportVideoFirstFrameDecoded(e,void 0,void 0,!0)},e.getLocalVideoStats=()=>{const e=this.statsCollector.getLocalVideoTrackStats(),t=this.statsCollector.getRTCStats();return qB(qB({},e),t)},e.onICECandidateError=e=>{this._iceError=e}}resetConnection(e){e instanceof vB&&function(e){jB.delete(e.id),VB(e)}(e),e.close(),this.emit(mU.PeerConnectionStateChange,"closed"),function(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.getLocalVideoStats=void 0}(e),this._isWaitPcToRePub=!1}filterTobeMutedTracks(e){const t=[];if(-1===this.getAllTracks().indexOf(e))return t;const n=this.localTrackMap.get(hU.LocalAudioTrack);if(e instanceof WD&&(null==n?void 0:n.track)instanceof YD)return n.track.isActive||t.push([hU.LocalAudioTrack,n]),t;const r=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(r&&(t.push(r),r[0]===hU.LocalVideoTrack)){const e=this.localTrackMap.get(hU.LocalVideoLowTrack);e&&t.push([hU.LocalVideoLowTrack,e])}return t}filterTobeUnmutedTracks(e){const t=[],n=this.localTrackMap.get(hU.LocalAudioTrack);if(e instanceof WD&&(null==n?void 0:n.track)instanceof YD)return n.track.isActive&&t.push([hU.LocalAudioTrack,n]),t;const r=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(r)if(r[0]===hU.LocalVideoTrack){t.push(r);const e=this.localTrackMap.get(hU.LocalVideoLowTrack);e&&t.push([hU.LocalVideoLowTrack,e])}else t.push(r);return t}createMuteMessage(e){return e.map((e=>{var t;let n,[r,{track:o,ssrcs:i,id:a}]=e;switch(r){case hU.LocalAudioTrack:n=Zx.Audio;break;case hU.LocalVideoTrack:n=Ur(t=o._hints).call(t,Hk.SCREEN_TRACK)?Zx.Screen:Zx.High;break;case hU.LocalVideoLowTrack:n=Zx.Low}return{stream_type:n,ssrcs:i,mid:a}}))}createUnmuteMessage(e){return e.map((e=>{var t;let n,[r,{track:o,ssrcs:i,id:a}]=e;switch(r){case hU.LocalAudioTrack:n=Zx.Audio;break;case hU.LocalVideoTrack:n=Ur(t=o._hints).call(t,Hk.SCREEN_TRACK)?Zx.Screen:Zx.High;break;case hU.LocalVideoLowTrack:n=Zx.Low}return{stream_type:n,ssrcs:i,mid:a}}))}filterTobeUnSubscribedTracks(e,t){const n=[],r=this.remoteUserMap.get(e);if(!r)return n;if(t){const o=r.get(t);if(!o)return n;n.push([e,{kind:t,id:o}])}else Array.from(r.entries()).forEach((t=>{let[r,o]=t;n.push([e,{kind:r,id:o}])}));return n}filterTobeUnSubscribedDataChannels(e,t){const n=[];return t.forEach((t=>{var r;null!==(r=this.remoteDataChannelMap.get(e))&&void 0!==r&&r.has(t.id)&&n.push(t)})),n}createUnsubscribeMessage(e){const t=[];return e.forEach((e=>{let[n,{kind:r,id:o}]=e;switch(r){case lU.VIDEO:return void(n._videoSSRC&&t.push({stream_type:lU.VIDEO,ssrcId:n._videoSSRC}));case lU.AUDIO:return void(n._audioSSRC&&t.push({stream_type:lU.AUDIO,ssrcId:n._audioSSRC}))}})),t}createUnsubscribeAllMessage(e){const t=new Map;return e.forEach((e=>{let[n,{kind:r}]=e;if(t.has(n)){let e=t.get(n);r===lU.VIDEO?e|=eU.Video:e|=eU.Audio,t.set(n,e)}else r===lU.VIDEO?t.set(n,eU.Video):t.set(n,eU.Audio)})),{users:Array.from(t.entries()).map((e=>{let[t,n]=e;return{stream_id:t.uid,stream_type:n}}))}}withdrawRemoteTracks(e){e.forEach((e=>{let[t,{kind:n}]=e;const r=this.remoteUserMap.get(t);r&&(r.delete(n),0===Array.from(r.entries()).length&&this.remoteUserMap.delete(t))}))}async updateBitrateLimit(e){const t=this.localTrackMap.get(hU.LocalVideoTrack),n=this.localTrackMap.get(hU.LocalVideoLowTrack);t&&(await t.track.setBitrateLimit(e.uplink),await new ih(((e,n)=>{this.handleUpdateVideoEncoder(t.track,e,n,!0)}))),n&&e.low_stream_uplink&&(await n.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0}),await new ih(((e,t)=>{this.handleUpdateVideoEncoder(n.track,e,t,!0)})))}isP2PDisconnected(){return!this.connection||"connected"!==this.connection.peerConnectionState}mapPubResToRemoteConfig(e,t,n){return e.map(((e,r)=>{var o;let{stream_type:i}=e;const a=null===(o=t.find((e=>{let{stream_type:t}=e;return i===t})))||void 0===o?void 0:o.attributes;if(a&&UN("DISABLE_SCREEN_SHARE_REMB")){const e=n[r]._hints;(Ur(e).call(e,Hk.SCREEN_TRACK)||Ur(e).call(e,Hk.SCREEN_LOW_TRACK))&&(a.remb=!1,pk.debug("disable remb for screen share, hints:",e))}return a}))}async tryToUnmuteAudio(e){for(let n=0;n<e.length;n++)if(e[n]instanceof WD){var t;const r=this.filterTobeUnmutedTracks(e[n]);if(0===r.length)continue;await(null===(t=this.connection)||void 0===t?void 0:t.unmuteLocal(r.map((e=>{let[,{id:t}]=e;return t}))));const o=this.createUnmuteMessage(r);return void await vA(this,mU.RequestUnmuteLocal,o)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!(null===(t=this.connection)||void 0===t||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(mU.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(mU.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks(),this.statsUploader.requestTransportStats=()=>{var e;return{connectState:(null===(e=this.connection)||void 0===e?void 0:e.peerConnectionState)||"closed"}}}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await MA(JA(this.dtlsFailedCount,XA)),this.emit(mU.RequestReconnect)}async reconnectP2P(){const e=Array.from(this.localTrackMap.entries()),t=this.createGatewayUnpublishMessage(e);Array.from(this.remoteUserMap.entries()),t.length>0&&await mA(this,mU.RequestUnpublishForReconnectPC,t),this.disconnectForReconnect(),this.emit(mU.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(hU.LocalVideoTrack)||this.pendingLocalTracks.some((e=>e instanceof DM))}throwIfTrackTypeNotMatch(e){if(e.filter((e=>e instanceof DM)).length>1)throw new FI(jI.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter((e=>e instanceof WD)).length>1&&(e.some((e=>e instanceof WD&&e._bypassWebAudio))||!Sk().webAudioMediaStreamDest))throw new FI(jI.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof DM&&this.pendingLocalTracks.some((e=>e instanceof DM)))throw new FI(jI.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof WD&&this.pendingLocalTracks.some((e=>e instanceof WD))&&(!Sk().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some((e=>e instanceof WD&&e._bypassWebAudio))))throw new FI(jI.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){var n;const r=!UN("DISABLE_DUAL_STREAM_USE_ENCODING")&&Sk().supportDualStreamEncoding,o=qB(qB({},{width:160,height:120,framerate:15,bitrate:50}),t);let i;i=r?e._mediaStreamTrack.clone():EB(e,o);const a=LA(8,"track-low-"),s=new DM(i,qB(qB({},r&&{scaleResolutionDownBy:rj(o,e)}),{},{frameRate:o.framerate,bitrateMax:o.bitrate,bitrateMin:o.bitrate}),void 0,void 0,a);return s.on(Kk.TRANSCEIVER_UPDATED,(t=>{e._updateRtpTransceiver(t,Gk.LOW_STREAM)})),s._hints.push(Hk.LOW_STREAM),Ur(n=e._hints).call(n,Hk.SCREEN_TRACK)&&s._hints.push(Hk.SCREEN_LOW_TRACK),e.on("sei-to-send",(e=>{s.emit("sei-to-send",e)})),e.addListener(Vk.NEED_CLOSE,(()=>{s.close()})),s}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.connection&&this.connection instanceof vB){var o,i,a,s;const c=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:l,dtlsTransportState:u,peerConnectionState:d}=this.connection,{local:p,remote:h}=await this.connection.getSelectedCandidatePair();_k.pcStats(this.store.sessionId,{startTime:c,eventElapse:e-c||0,iceconnectionsate:l,dtlsstate:u,connectionstate:d,intSucc:t?1:2,error:this._iceError||r||"",selectedLocalCandidateProtocol:null!==(o=null==p?void 0:p.protocol)&&void 0!==o?o:"",selectedLocalCandidateType:null!==(i=p.candidateType)&&void 0!==i?i:"",selectedLocalCandidateAddress:"".concat(p.address,":").concat(p.port),selectedRemoteCandidateProtocol:null!==(a=h.protocol)&&void 0!==a?a:"",selectedRemoteCandidateType:null!==(s=h.candidateType)&&void 0!==s?s:"",selectedRemoteCandidateAddress:"".concat(h.address,":").concat(h.port),restartCnt:n,preallocation:this.connection.isPreallocation}),this._iceError=null}}reportVideoFirstFrameDecoded(e,t,n,r){var o;const i=Array.from(tk(o=this.remoteUserMap).call(o)).find((t=>t._videoSSRC===e));if(i){r||this.store.subscribe(i.uid,"video",void 0,void 0,void 0,void 0,Date.now());const o=this.store.keyMetrics,a=o.subscribe.find((e=>e.userId===i.uid&&"video"===e.type));_k.firstRemoteVideoDecode(this.store.sessionId,vk.FIRST_VIDEO_DECODE,gk.FIRST_VIDEO_DECODE,{peer:i._uintid,videowidth:t,videoheight:n,subscribeElapse:LF.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:o.requestAPEnd||0,apStart:o.requestAPStart||0,joinGwEnd:o.joinGatewayEnd||0,joinGwStart:o.joinGatewayStart||0,pcEnd:o.peerConnectionEnd||0,pcStart:o.peerConnectionStart||0,subscriberEnd:(null==a?void 0:a.subscribeEnd)||0,subscriberStart:(null==a?void 0:a.subscribeStart)||0,videoAddNotify:(null==a?void 0:a.streamAdded)||0,state:r?1:0,firstFrame:(null==a?void 0:a.firstFrame)||0})}}async remoteMediaSsrcChanged(e,t,n){if(!this.connection)return!1;const r=this.remoteUserMap.get(e);if(!r)return!1;const o=r.get(t);if(!o)return!1;const i=await this.connection.getRemoteSSRC(o);return void 0!==i&&i!==n}unbindRtpTransceiver(){0!==this.localTrackMap.size&&Array.from(this.localTrackMap.entries()).forEach((e=>{let[t,{track:n}]=e;t===hU.LocalVideoLowTrack?n._updateRtpTransceiver(void 0,Gk.LOW_STREAM):n._updateRtpTransceiver(void 0)}))}},Sx(GB.prototype,"startP2PConnection",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"startP2PConnection"),GB.prototype),Sx(GB.prototype,"connect",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"connect"),GB.prototype),Sx(GB.prototype,"updateRemoteRTPCapabilities",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"updateRemoteRTPCapabilities"),GB.prototype),Sx(GB.prototype,"publishDataChannel",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"publishDataChannel"),GB.prototype),Sx(GB.prototype,"unpublish",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"unpublish"),GB.prototype),Sx(GB.prototype,"unpublishDataChannel",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"unpublishDataChannel"),GB.prototype),Sx(GB.prototype,"unpublishLowStream",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"unpublishLowStream"),GB.prototype),Sx(GB.prototype,"subscribeDataChannel",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"subscribeDataChannel"),GB.prototype),Sx(GB.prototype,"subscribe",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"subscribe"),GB.prototype),Sx(GB.prototype,"massSubscribe",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"massSubscribe"),GB.prototype),Sx(GB.prototype,"unsubscribe",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"unsubscribe"),GB.prototype),Sx(GB.prototype,"unsubscribeDataChannel",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"unsubscribeDataChannel"),GB.prototype),Sx(GB.prototype,"massUnsubscribe",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"massUnsubscribe"),GB.prototype),Sx(GB.prototype,"muteRemote",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"muteRemote"),GB.prototype),Sx(GB.prototype,"unmuteRemote",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"unmuteRemote"),GB.prototype),Sx(GB.prototype,"hasRemoteMediaWithLock",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"hasRemoteMediaWithLock"),GB.prototype),Sx(GB.prototype,"disconnectForReconnect",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"disconnectForReconnect"),GB.prototype),Sx(GB.prototype,"updateBitrateLimit",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"updateBitrateLimit"),GB.prototype),Sx(GB.prototype,"remoteMediaSsrcChanged",[XB],Object.getOwnPropertyDescriptor(GB.prototype,"remoteMediaSsrcChanged"),GB.prototype),GB);function XB(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("From P2PChannel.".concat(t));try{for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return await r.apply(this,i)}finally{n()}},n}function JB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ZB(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?JB(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JB(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const QB=Date.now(),$B=new Map,eV=new Map;async function tV(e){const t=$B.get(e),n=Array.isArray(t)&&t[t.length-1],r=eV.get(e);if(!n)return void(r.isSyncing=!1);const o={uid:n.uid,payload:n.payload};0===r.firstRecvTs&&(r.firstRecvTs=n.recvTs,r.firstSendTs=n.sendTs);const i=n.sendTs-r.firstSendTs,a=i-(Date.now()-r.firstRecvTs);a>0&&(r.firstRecvTs=Date.now()-i);let s=n.mediaDelay+a;s<=0?(t.pop(),nV(n.context,o),s=0):s=Math.min(s,20),setTimeout((()=>t.length&&tV(e)),s)}function nV(e,t){e.safeEmit(dA.STREAM_MESSAGE,t.uid,t.payload),e.onStreamMessage&&e.onStreamMessage(t)}function rV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(!e.syncWithAudio)return nV(n,{uid:e.uid,payload:e.payload});const r="".concat(n.id,"-").concat(e.uid),o=$B.get(r)||[],i=o.findIndex((t=>e.sendTs>=t.sendTs)),a=ZB(ZB({},e),{},{context:n,mediaDelay:t,recvTs:Date.now()});-1===i?o.push(a):o.splice(i,0,a),$B.set(r,o);let s=!1;var c;eV.has(r)?s=!(null===(c=eV.get(r))||void 0===c||!c.isSyncing):eV.set(r,{isSyncing:s,firstRecvTs:0,firstSendTs:0}),s||tV(r)}const oV=aI().name;function iV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function aV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iV(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iV(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const sV="websdk_ng_cache_parameter",cV=UN("MAX_PRELOAD_ASYNC_LENGTH"),lV=new Map,uV=[];let dV=null,pV=0,hV=0;const fV=new Map,mV=function(e,t){const n=[];let r=0;const o=async()=>{const e=n.shift();e&&await e(),n.length>0&&r<t?o():r--};return async function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return new ih((async(i,s)=>{n.push((async()=>{try{const t=await e(...a);i(t)}catch(e){s(e)}})),r<t&&(r++,o())}))}}(gV,cV),vV=Xw.CancelToken.source();async function gV(e,t,n,r,o,i){try{if(!UN("ENABLE_PRELOAD"))return;if(!Sk().supportWebCrypto)return void CA((()=>{pk.warn("Your browser does not support preloading, this feature  be run in a secure environment")}),"preload_webcrypto_not_supported");if(!n&&null!==n)throw new FI(jI.INVALID_PARAMS,"Invalid token: ".concat(n,". If you don not use token, set it to null"));n&&WI(n,"token",1,2047),WI(e,"appid",1,2047),xx(t),r&&Ux(r);const a=xA();pk.debug("preload channel ".concat(t,", uid is ").concat(r));const s={appId:e,cname:t,token:n||e,uid:"string"!=typeof r?r:null,sid:a,proxyServer:o};let c,l;"string"==typeof r?(s.stringUid=r,[l,c]=await ih.all([OF(r,{sid:a,appId:e},vV.token),CF(aV(aV({},s),{},{token:n||e,uid:0}),vV.token)]),s.uid=l.uid,c.gatewayInfo.uid=s.uid,c.gatewayInfo.res.uid=s.uid):(i&&(s.stringUid=i),c=await CF(s,vV.token));const u={sid:a,appId:e,cname:t,token:n||e,uid:s.stringUid||r,intUid:s.uid||c.gatewayInfo.uid,stringUid:s.stringUid,ts:Date.now(),sua:l,ap:c};await async function(e){let t;try{e.uid&&yV({appId:e.appId,cname:e.cname,token:e.token,uid:e.uid,stringUid:e.stringUid});const n=RV(e),r=await async function(e,t){try{const n=await window.crypto.subtle.importKey("raw",AA(t),"AES-GCM",!1,["encrypt"]),r=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(1)},n,wA(window.btoa(JSON.stringify(e))));return IA(new Uint8Array(r))}catch(e){return}}(e,e.token||e.appId);if(!r)return;t=SV(sV);const o=t?JSON.parse(t):[];o.push({[n]:r}),o.length>UN("AP_CACHE_NUM")&&o.shift(),OV(sV,JSON.stringify(o))}catch(e){pk.warn("Error caching server parameters:",e.message),OV(sV,"")}}(u),pV++}catch(e){throw hV++,function(e){dV||(dV=window.setTimeout((()=>{let t="";fV.forEach(((e,n)=>{t+="".concat(n,": ").concat(e," ;")})),_k.reportApiInvoke(null,{name:rA.PRELOAD,options:{success:pV,failed:hV,err:t}}).onError(e),pV=0,hV=0,fV.clear(),dV=null}),1e4));const t=fV.get(e.code)||0;fV.set(e.code,t+1)}(e),e}}async function EV(e){try{if(UN("AP_REQUEST_DETAIL")||UN("ENABLE_ROLE_SELECT_EDGE"))return;const t=yV(e);if(!t||"disabled"!==e.cloudProxyServer)return;const n=await async function(e,t){try{const n=await window.crypto.subtle.importKey("raw",AA(t),"AES-GCM",!1,["decrypt"]),r=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(1)},n,wA(e));return JSON.parse(window.atob(IA(new Uint8Array(r))))}catch(e){return}}(t,e.token||e.appId);if(!n)return;if(!function(e,t){return!(e.cname!==t.cname||e.appId!==t.appId||e.token!==t.token)&&(t.stringUid?e.stringUid===t.stringUid:"number"==typeof t.uid?e.uid===t.uid:e.uid==t.uid)}(n,e))return;if(n&&Date.now()-n.ts<UN("AP_CACHE_LIFETIME"))return n}catch(e){pk.warn("Error get preloadInfo",e.message)}}function yV(e){let t;try{if(t=SV(sV),!t)return;const n=JSON.parse(t),r=RV(e),o=function(e,t){for(let n=e.length-1;n>=0;n--)if(t(e[n]))return n;return-1}(n,(e=>r in e));if(-1===o)return;const i=n.splice(o,1)[0];return OV(sV,JSON.stringify(n)),i[r]}catch(e){pk.warn("Error delete preload info: ".concat(t),e.message),OV(sV,"")}}function _V(e){if(e){let t=lV.get(e);t&&(window.clearTimeout(t),t=null,lV.delete(e)),Ur(uV).call(uV,e)||"disabled"!==e.cloudProxyServer||uV.push(e)}if(lV.size<UN("AP_CACHE_NUM")&&uV.length>0){const e=uV.shift();lV.set(e,window.setTimeout((async()=>{const{appId:t,cname:n,token:r,stringUid:o,uid:i,proxyServer:a}=e;try{await mV(t,n,r,i,a,o),lV.has(e)&&_V(e)}catch(t){pk.warn("update preload failed",t.message),bV(e)}}),UN("AP_UPDATE_INTERVAL")))}}function bV(e){const t=uV.indexOf(e);-1!==t&&uV.splice(t,1);let n=lV.get(e);n&&(window.clearTimeout(n),n=null,lV.delete(e),_V())}function TV(e,t){const n=e.sua,r=e.ap;t&&n&&_k.reqUserAccount(e.sid,{lts:n.requestTime,elapse:n.elapse,success:!0,serverAddr:n.url,stringUid:t,uid:e.intUid,errorCode:null,extend:n.req}),_k.reportResourceTiming(e.ap.url,e.sid),_k.joinWebProxyAP(e.sid,{lts:r.requestTime,elapse:r.elapse,sucess:1,apServerAddr:r.url,turnServerAddrList:r.proxyInfo.addresses.map((e=>e.ip)).join(","),eventType:"disabled",unilbsServerIds:[YU.CHOOSE_SERVER,YU.CLOUD_PROXY_FALLBACK].toString()}),_k.joinChooseServer(e.sid,{lts:r.requestTime,elapse:r.elapse,succ:!0,csAddr:r.url,opid:r.opid,serverList:r.gatewayInfo.gatewayAddrs.map((e=>e.address)),ec:null,cid:r.gatewayInfo.cid.toString(),uid:r.gatewayInfo.uid.toString(),csIp:r.gatewayInfo.csIp,unilbsServerIds:[YU.CHOOSE_SERVER].toString(),isHttp3:r.isHttp3})}function SV(e){return window.atob(window.localStorage.getItem(e)||"")}function OV(e,t){window.localStorage.setItem(e,window.btoa(t))}function RV(e){let t="".concat(e.appId,"_").concat(e.cname);return"string"==typeof e.uid&&(t+="_s_".concat(e.uid)),"number"==typeof e.uid&&(t+="_".concat(e.uid)),e.token&&(t+="_".concat(e.token)),WA(t)}function CV(e){let t=function(){const e=NV.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(e,t){let n=e.appId;void 0!==n&&(VV(t,10),UV(t,n));let r=e.cid;void 0!==r&&(VV(t,16),VV(t,r));let o=e.cname;void 0!==o&&(VV(t,26),UV(t,o));let i=e.deviceId;void 0!==i&&(VV(t,34),UV(t,i));let a=e.elapse;void 0!==a&&(VV(t,40),GV(t,a));let s=e.fileSize;void 0!==s&&(VV(t,48),GV(t,AV(s)));let c=e.height;void 0!==c&&(VV(t,56),GV(t,AV(c)));let l=e.jpg;void 0!==l&&(VV(t,66),VV(t,l.length),LV(t,l));let u=e.networkType;void 0!==u&&(VV(t,72),GV(t,AV(u)));let d=e.osType;void 0!==d&&(VV(t,80),GV(t,AV(d)));let p=e.requestId;void 0!==p&&(VV(t,90),UV(t,p));let h=e.sdkVersion;void 0!==h&&(VV(t,98),UV(t,h));let f=e.sequence;void 0!==f&&(VV(t,104),GV(t,AV(f)));let m=e.sid;void 0!==m&&(VV(t,114),UV(t,m));let v=e.timestamp;void 0!==v&&(VV(t,120),GV(t,v));let g=e.uid;void 0!==g&&(VV(t,128),VV(t,g));let E=e.vid;void 0!==E&&(VV(t,136),VV(t,E));let y=e.width;void 0!==y&&(VV(t,144),GV(t,AV(y)));let _=e.service;void 0!==_&&(VV(t,152),VV(t,_));let b=e.callbackData;void 0!==b&&(VV(t,162),VV(t,b.length),LV(t,b));let T=e.ticket;void 0!==T&&(VV(t,170),UV(t,T));let S=e.vendorConfigs;void 0!==S&&(VV(t,178),UV(t,S))}(e,t),function(e){let t=e.bytes,n=e.limit;return t.length===n?t:t.subarray(0,n)}(t)}function wV(e){return function(e){let t={};e:for(;!PV(e);){let n=BV(e);switch(n>>>3){case 0:break e;case 1:t.code=BV(e);break;case 2:t.msg=xV(e,BV(e));break;case 3:t.requestId=xV(e,BV(e));break;case 4:t.timestamp=HV(e,!1);break;default:IV(e,7&n)}}return t}({bytes:t=e,offset:0,limit:t.length});var t}function IV(e,t){switch(t){case 0:for(;128&jV(e););break;case 2:kV(e,BV(e));break;case 5:kV(e,4);break;case 1:kV(e,8);break;default:throw new Error("Unimplemented type: "+t)}}function AV(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let NV=[];function kV(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function PV(e){return e.offset>=e.limit}function DV(e,t){let n=e.bytes,r=e.offset,o=e.limit,i=r+t;if(i>n.length){let t=new Uint8Array(2*i);t.set(n),e.bytes=t}return e.offset=i,i>o&&(e.limit=i),r}function MV(e,t){let n=e.offset;if(n+t>e.limit)throw new Error("Read past limit");return e.offset+=t,n}function LV(e,t){let n=DV(e,t.length);e.bytes.set(t,n)}function xV(e,t){let n=MV(e,t),r=String.fromCharCode,o=e.bytes,i="\ufffd",a="";for(let s=0;s<t;s++){let e,c,l,u,d=o[s+n];128&d?192==(224&d)?s+1>=t?a+=i:(e=o[s+n+1],128!=(192&e)?a+=i:(u=(31&d)<<6|63&e,u<128?a+=i:(a+=r(u),s++))):224==(240&d)?s+2>=t?a+=i:(e=o[s+n+1],c=o[s+n+2],32896!=(49344&(e|c<<8))?a+=i:(u=(15&d)<<12|(63&e)<<6|63&c,u<2048||u>=55296&&u<=57343?a+=i:(a+=r(u),s+=2))):240==(248&d)?s+3>=t?a+=i:(e=o[s+n+1],c=o[s+n+2],l=o[s+n+3],8421504!=(12632256&(e|c<<8|l<<16))?a+=i:(u=(7&d)<<18|(63&e)<<12|(63&c)<<6|63&l,u<65536||u>1114111?a+=i:(u-=65536,a+=r(55296+(u>>10),56320+(1023&u)),s+=3))):a+=i:a+=r(d)}return a}function UV(e,t){let n=t.length,r=0;for(let a=0;a<n;a++){let e=t.charCodeAt(a);e>=55296&&e<=56319&&a+1<n&&(e=(e<<10)+t.charCodeAt(++a)-56613888),r+=e<128?1:e<2048?2:e<65536?3:4}VV(e,r);let o=DV(e,r),i=e.bytes;for(let a=0;a<n;a++){let e=t.charCodeAt(a);e>=55296&&e<=56319&&a+1<n&&(e=(e<<10)+t.charCodeAt(++a)-56613888),e<128?i[o++]=e:(e<2048?i[o++]=e>>6&31|192:(e<65536?i[o++]=e>>12&15|224:(i[o++]=e>>18&7|240,i[o++]=e>>12&63|128),i[o++]=e>>6&63|128),i[o++]=63&e|128)}}function jV(e){return e.bytes[MV(e,1)]}function FV(e,t){let n=DV(e,1);e.bytes[n]=t}function BV(e){let t,n=0,r=0;do{t=jV(e),n<32&&(r|=(127&t)<<n),n+=7}while(128&t);return r}function VV(e,t){for(t>>>=0;t>=128;)FV(e,127&t|128),t>>>=7;FV(e,t)}function HV(e,t){let n,r=0,o=0,i=0;return n=jV(e),r=127&n,128&n&&(n=jV(e),r|=(127&n)<<7,128&n&&(n=jV(e),r|=(127&n)<<14,128&n&&(n=jV(e),r|=(127&n)<<21,128&n&&(n=jV(e),o=127&n,128&n&&(n=jV(e),o|=(127&n)<<7,128&n&&(n=jV(e),o|=(127&n)<<14,128&n&&(n=jV(e),o|=(127&n)<<21,128&n&&(n=jV(e),i=127&n,128&n&&(n=jV(e),i|=(127&n)<<7))))))))),{low:r|o<<28,high:o>>>4|i<<24,unsigned:t}}function GV(e,t){let n=t.low>>>0,r=(t.low>>>28|t.high<<4)>>>0,o=t.high>>>24,i=0===o?0===r?n<16384?n<128?1:2:n<1<<21?3:4:r<16384?r<128?5:6:r<1<<21?7:8:o<128?9:10,a=DV(e,i),s=e.bytes;switch(i){case 10:s[a+9]=o>>>7&1;case 9:s[a+8]=9!==i?128|o:127&o;case 8:s[a+7]=8!==i?r>>>21|128:r>>>21&127;case 7:s[a+6]=7!==i?r>>>14|128:r>>>14&127;case 6:s[a+5]=6!==i?r>>>7|128:r>>>7&127;case 5:s[a+4]=5!==i?128|r:127&r;case 4:s[a+3]=4!==i?n>>>21|128:n>>>21&127;case 3:s[a+2]=3!==i?n>>>14|128:n>>>14&127;case 2:s[a+1]=2!==i?n>>>7|128:n>>>7&127;case 1:s[a]=1!==i?128|n:127&n}}const WV={},qV={},KV=4294967296,YV=0x10000000000000000,zV=YV/2,XV=eH(0,!0),JV=eH(0),ZV=tH(0,-2147483648,!1),QV=tH(-1,2147483647,!1),$V=tH(-1,-1,!0);function eH(e,t){let n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=qV[e],r)?r:(n=tH(e,0,!0),o&&(qV[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=WV[e],r)?r:(n=tH(e,e<0?-1:0,!1),o&&(WV[e]=n),n)}function tH(e,t,n){return{low:0|e,high:0|t,unsigned:!!n}}function nH(e,t){if(isNaN(e))return t?XV:JV;if(t){if(e<0)return XV;if(e>=YV)return $V}else{if(e<=-zV)return ZV;if(e+1>=zV)return QV}return e<0?t?XV:JV:tH(e%KV|0,e/KV|0,t)}function rH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}class oH extends eA{get connectionState(){return this._connectionState}set connectionState(e){if(this._connectionState===e)return;const t=this._connectionState;this._connectionState=e,this.emit(TU.CONNECTION_STATE_CHANGE,e,t)}get quality(){return this._quality}set quality(e){this._quality=e>1?1:e<.1?.1:e,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout((()=>{this.quality=this._quality/this._qualityRatio}),6e4))}constructor(e){var t;super(),OR(this,"name","AgoraRTCImageModeration"),OR(this,"_connectionState",bU.CONNECTING),OR(this,"_sequence",0),OR(this,"_moderationStartTime",void 0),OR(this,"_workerConnection",void 0),OR(this,"_workerMessageLengthLimit",void 0),OR(this,"_qualityRatio",void 0),OR(this,"_connectInfo",void 0),OR(this,"_cancelTokenSource",Xw.CancelToken.source()),OR(this,"_retryConfig",void 0),OR(this,"_moderationInterval",void 0),OR(this,"_moderationTimer",null),OR(this,"_moderationMode",1),OR(this,"_quality",1),OR(this,"_qualityTimer",null),OR(this,"_ticket",void 0),OR(this,"_moderationIntervalMinimum",void 0),OR(this,"_uploadFailedNum",0),OR(this,"_uploadNum",0),OR(this,"_uploadTimer",null),OR(this,"_extraInfo",void 0),OR(this,"_vendor",""),OR(this,"_encoder",new TextEncoder),OR(this,"_moderationId",void 0),OR(this,"inspectImage",(()=>{if(this.connectionState!==bU.CONNECTED)throw new bk(jI.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval((()=>{this.connectionState===bU.CONNECTED?this.requestToInspectImage():pk.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)}),this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()})),this._moderationId=LA(5,"image-moderation-"),this._workerMessageLengthLimit=UN("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=UN("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=null!==(t=e.interval)&&void 0!==t?t:1e3,e.extraInfo&&(this._extraInfo=this._encoder.encode(e.extraInfo)),e.vendor&&(this._vendor=e.vendor),this._qualityRatio=UN("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new WU("worker-"+this._moderationId,XA),this.on(TU.STATE_CHANGE,((e,t)=>{pk.debug("[".concat(this._moderationId,"] Moderation operation :").concat(SU[e]," ").concat(t||""))})),this.handleWorkerEvents()}async init(e,t){this.emit(TU.STATE_CHANGE,SU.CONNECT_AP),this._connectInfo=e;const n=this._cancelTokenSource.token;return this._retryConfig=t,new ih(((r,o)=>{this.on(TU.CONNECTION_STATE_CHANGE,((e,t)=>{e===bU.CONNECTED&&r()})),this.requestAP(e,n,t).then((e=>{this.connectWorker(e)})).catch((e=>{o(e)}))}))}updateConfig(e){var t;this._moderationInterval=null!==(t=e.interval)&&void 0!==t?t:1e3,e.extraInfo&&(this._extraInfo=this._encoder.encode(e.extraInfo)),e.vendor&&(this._vendor=e.vendor),pk.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(e))),this.connectionState===bU.CONNECTED&&this.inspectImage()}async requestAP(e,t,n){const r=UN("WEBCS_DOMAIN").map((e=>"https://".concat(e,"/api/v1"))),o=await function(e,t,n,r){let{appId:o,areaCode:i,cname:a,sid:s,token:c,uid:l}=t;gF++;const u="moderation_plugin",d={service_name:u,json_body:JSON.stringify({appId:o,areaCode:i,cname:a,command:"allocateEdge",requestId:gF,seq:gF,sid:s,appToken:c,ts:Date.now(),uid:l+""})};let p,h,f=e[0];return ZA((async()=>{p=Date.now();const e=await Jj(f,{data:d,cancelToken:n,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(h=Date.now()-p,0!==e.code){const t=new bk(jI.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+e.code,{retry:!0,responseTime:h});throw pk.error(t.toString()),t}const t=JSON.parse(e.json_body);if(200!==t.code){const e=new bk(jI.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(t.code,", reason: ").concat(t.reason),{code:t.code,responseTime:h});throw pk.error(e.toString()),e}if(!t.servers||!Array.isArray(t.servers)||0===t.servers.length){const e=new bk(jI.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:t.code,responseTime:h});throw pk.error(e.toString()),e}if(!t.servers.some((e=>!!e.wss))){const e=new bk(jI.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:t.code,responseTime:h});throw pk.error(e.toString()),e}const r=UN("IMAGE_MODERATION_WORKER_HOST");return{addressList:t.servers.map((e=>{let{address:t,wss:n}=e;if(t&&n)return"wss://".concat(t.replace(/\./g,"-"),".").concat(r,":").concat(n,"/moderation")})).filter((e=>!!e)),workerToken:t.workerToken,vid:t.vid,ticket:t.appTicket,responseTime:h}}),((t,n)=>(_k.apworkerEvent(s,{success:!0,sc:200,serviceName:u,responseDetail:JSON.stringify(t.addressList),firstSuccess:0===n,responseTime:h,serverIp:e[n%e.length]}),!1)),((t,n)=>(_k.apworkerEvent(s,{success:!1,sc:t.data&&t.data.code||200,serviceName:u,responseTime:h,serverIp:e[n%e.length]}),!!(t.code!==jI.OPERATION_ABORTED&&t.code!==jI.UNEXPECTED_RESPONSE||t.data&&t.data.retry)&&(f=e[(n+1)%e.length],!0))),r)}(r,e,t,n);this.emit(TU.STATE_CHANGE,SU.AP_CONNECTED);const{addressList:i,ticket:a}=o;return this._ticket=a,i}async connectWorker(e){this.emit(TU.STATE_CHANGE,SU.CONNECT_WORKER),await this._workerConnection.init(e,1e4)}handleWorkerEvents(){this._workerConnection.on(Lx.CONNECTED,(async()=>{this.emit(TU.STATE_CHANGE,SU.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=bU.CONNECTED})),this._workerConnection.on(Lx.CLOSED,(()=>{this.connectionState=bU.CLOSED})),this._workerConnection.on(Lx.FAILED,(()=>{this.connectionState=bU.CLOSED})),this._workerConnection.on(Lx.RECONNECTING,(()=>{this.connectionState=this.connectionState===bU.CONNECTED?bU.RECONNECTING:bU.CONNECTING})),this._workerConnection.on(Lx.ON_MESSAGE,(async e=>{if(e.data instanceof ArrayBuffer){const t=wV(new Uint8Array(e.data));UN("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&pk.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(t)),this._uploadNum++,void 0===t.code||0===t.code||(this._uploadFailedNum++,pk.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(t.code,", msg is ").concat(t.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout((()=>{_k.reportApiInvoke(this._connectInfo.sid||null,{name:rA.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,t.code],tag:oA.TRACER}).onError(new bk(jI.IMAGE_MODERATION_UPLOAD_FAILED,t.msg)),this._uploadTimer=null}),UN("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else pk.error("[".concat(this._moderationId,"] Unexpected message type from worker"))})),this._workerConnection.on(Lx.WILL_RECONNECT,((e,t,n)=>{"recover"===e&&n(e),n("tryNext")})),this._workerConnection.on(Lx.REQUEST_NEW_URLS,((e,t)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(e).catch(t)}))}static intToLong(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}async requestToInspectImage(){const e=gA(this,TU.CLIENT_LOCAL_VIDEO_TRACK),t={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(e){if(!e.isPlaying)return void(UN("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&pk.debug("Only the track being played can be inspected"));this._sequence++;const n=await this.generateRequestData(e,t);this._workerConnection.sendMessage(n,!0,!0)}else UN("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&pk.debug("Only the track being published can be inspected")}async generateRequestData(e,t){let{appId:n,cname:r,cid:o,vid:i,sid:a,uid:s}=t;const c=Date.now(),l=await e.getCurrentFrameImage("image/jpeg",this.quality),u=await tD(l,n,r),d=this._sequence+"-"+o+"-"+s+"-"+c+"-"+LA(12,""),p={appId:n,cid:o,cname:r,deviceId:"",elapse:oH.intToLong(Number(c-this._moderationStartTime)),fileSize:l.buffer.byteLength,height:l.height,width:l.width,jpg:u,networkType:6,osType:7,requestId:d,sdkVersion:"4.23.1",sequence:this._sequence,sid:a,timestamp:nH(c),uid:s,vid:i,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};void 0===this._extraInfo&&delete p.callbackData;const h=CV(p);if(h.byteLength<this._workerMessageLengthLimit){if(UN("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rH(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rH(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},p);delete e.jpg,pk.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(e))}return h}{const t=this.quality*this._qualityRatio;return this.quality=t,await this.generateRequestData(e,{appId:n,cname:r,cid:o,vid:i,sid:a,uid:s})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Xw.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=bU.CLOSED,this.emit(TU.STATE_CHANGE,SU.CLOSED)}}function iH(e){if(HI(e.interval,"interval",1e3,1/0),e&&e.extraInfo&&e.extraInfo.length>1024)throw new bk(jI.INVALID_PARAMS,"config.extraInfo length cannot exceed 1024 bytes");if(e&&e.vendor&&e.vendor.length>1024)throw new bk(jI.INVALID_PARAMS,"config.vendor length cannot exceed 1024 bytes")}const aH={name:"ImageModeration",create:function(e){let{config:t}=e;return iH(t),new oH(t)}};var sH,cH,lH,uH,dH,pH,hH,fH,mH,vH,gH,EH,yH,_H,bH,TH,SH,OH,RH,CH,wH,IH,AH,NH,kH,PH,DH,MH,LH,xH,UH,jH,FH,BH,VH,HH,GH,WH,qH,KH,YH,zH;function XH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function JH(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?XH(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XH(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}YA.setLogger(pk);let ZH=(sH=yk(),cH=yk({argsMap:(e,t)=>{if(!Array.isArray(t)){if(!(t instanceof mP))return[t];t=[t]}return t.map((e=>e?Object(e).toString():"null"))}}),lH=yk({argsMap:(e,t)=>(t||(t=[]),Array.isArray(t)||t.trackMediaType!==Xk.DATA?(Array.isArray(t)||(t=[t]),t.map((e=>e.getTrackId()))):[t.getChannelId()])}),uH=yk({argsMap:(e,t,n,r)=>["object"==typeof t?t.uid:t,n,r]}),dH=yk({argsMap:(e,t,n)=>[t,n]}),pH=yk({argsMap:(e,t)=>t.map((e=>{let{user:t,mediaType:n}=e;return[null==t?void 0:t.uid,n]}))}),hH=yk({argsMap:(e,t,n,r)=>["object"==typeof t?t.uid:t,n,r]}),fH=yk({argsMap:(e,t)=>t.map((e=>{let{user:t,mediaType:n}=e;return{uid:null==t?void 0:t.uid,mediaType:n}}))}),mH=yk(),vH=yk(),gH=yk(),EH=yk(),yH=yk(),_H=yk(),bH=yk(),TH=yk(),SH=yk(),OH=yk(),RH=yk(),CH=yk(),wH=yk(),IH=yk(),AH=yk(),NH=yk({argsMap:(e,t)=>[t]}),kH=yk(),PH=yk(),DH=yk(),MH=yk(),LH=yk(),xH=yk(),UH=yk(),jH=yk(),FH=yk({argsMap:(e,t)=>(Array.isArray(t)||(t=[t]),[JSON.stringify(t)])}),BH=yk(),VH=yk(),HH=yk(),GH=yk(),WH=yk(),qH=yk(),KH=yk({reportResult:!0}),YH=yk(),zH=class extends eA{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var e;return(null===(e=this._config)||void 0===e?void 0:e.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(e,t){let n;if(super(),OR(this,"store",void 0),OR(this,"_uid",void 0),OR(this,"_channelName",void 0),OR(this,"_uintUid",void 0),OR(this,"_users",[]),OR(this,"_config",void 0),OR(this,"_clientId",void 0),OR(this,"_appId",void 0),OR(this,"_sessionId",null),OR(this,"_key",void 0),OR(this,"_rtmConfig",{}),OR(this,"_joinInfo",void 0),OR(this,"_gateway",void 0),OR(this,"_statsCollector",void 0),OR(this,"_configDistribute",void 0),OR(this,"_leaveMutex",void 0),OR(this,"_publishMutex",void 0),OR(this,"_renewTokenMutex",void 0),OR(this,"_subscribeMutex",void 0),OR(this,"_encryptionMode","none"),OR(this,"_encryptionSecret",null),OR(this,"_encryptionSalt",null),OR(this,"_encryptDataStream",!1),OR(this,"_encryptDataStreamKey",null),OR(this,"_encryptDataStreamIv",null),OR(this,"_proxyServer",void 0),OR(this,"_turnServer",{servers:[],mode:"auto"}),OR(this,"_cloudProxyServerMode","disabled"),OR(this,"_isDualStreamEnabled",!1),OR(this,"_defaultStreamFallbackType",void 0),OR(this,"_lowStreamParameter",void 0),OR(this,"_streamFallbackTypeCacheMap",new Map),OR(this,"_remoteStreamTypeCacheMap",new Map),OR(this,"_axiosCancelSource",Xw.CancelToken.source()),OR(this,"_audioVolumeIndicationInterval",void 0),OR(this,"_networkQualityInterval",void 0),OR(this,"_userOfflineTimeout",void 0),OR(this,"_streamRemovedTimeout",void 0),OR(this,"_liveTranscodeStreamingClient",void 0),OR(this,"_liveRawStreamingClient",void 0),OR(this,"_channelMediaRelayClient",void 0),OR(this,"_networkQualitySensitivity","normal"),OR(this,"_p2pChannel",void 0),OR(this,"_useLocalAccessPoint",!1),OR(this,"_setLocalAPVersion",void 0),OR(this,"_joinAndNotLeaveYet",!1),OR(this,"_numberOfJoinCount",0),OR(this,"_remoteDefaultVideoStreamType",void 0),OR(this,"_inspect",void 0),OR(this,"_moderation",void 0),OR(this,"_license",void 0),OR(this,"_pendingPublishedUsers",[]),OR(this,"ntpAlignErrorCount",0),OR(this,"remoteInboundOffset",0),OR(this,"_peerConnectionState",void 0),OR(this,"_handleLocalTrackEnable",((e,t,n)=>{this.publish(e,!1).then(t).catch(n)})),OR(this,"_handleLocalTrackDisable",((e,t,n)=>{this.unpublish(e).then(t).catch(n)})),OR(this,"_handleUserOnline",(e=>{if(UN("BLOCK_LOCAL_CLIENT")&&FL(e.uid,this.channelName))return void pk.debug("[".concat(e.uid,"] will be ignored in local"));this.isStringUID&&"string"!=typeof e.uid&&pk.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const t=this._users.find((t=>t.uid===e.uid));if(t)t._trust_in_room_=!0,t._is_pre_created&&(t._is_pre_created=!1,this.safeEmit(dA.USER_JOINED,t));else{const t=new VF(e.uid,e.uint_id||e.uid);this._users.push(t),pk.debug("[".concat(this._clientId,"] user online"),e.uid),this.safeEmit(dA.USER_JOINED,t)}})),OR(this,"_handleUserOffline",(e=>{if(UN("BLOCK_LOCAL_CLIENT")&&FL(e.uid,this.channelName))return;const t=this._users.find((t=>t.uid===e.uid));t&&(this._handleRemoveStream(e),this._handleRemoveDataChannels(e),t._audio_pre_subscribed||t._video_pre_subscribed?t._is_pre_created=!0:_A(this._users,t),this._remoteStreamTypeCacheMap.delete(t.uid),this._streamFallbackTypeCacheMap.delete(t.uid),pk.debug("[".concat(this._clientId,"] user offline"),e.uid,"reason:",e.reason),this.safeEmit(dA.USER_LEAVED,t,e.reason))})),OR(this,"_handleAddAudioOrVideoStream",((e,t,n,r,o,i,a)=>{if(UN("BLOCK_LOCAL_CLIENT")&&FL(t,this.channelName))return;const s=this._users.find((e=>e.uid===t));if(!s)return void pk.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));pk.debug("[".concat(this._clientId,"] stream added with uid ").concat(t,", type ").concat(e)),this.store.subscribe(s.uid,e,void 0,void 0,void 0,Date.now());const c="audio"===e?s.hasAudio:s.hasVideo;s._uintid||(s._uintid=o||t),"audio"===e?s._trust_audio_stream_added_state_=!0:s._trust_video_stream_added_state_=!0,"audio"===e?(s._audio_added_=!0,void 0!==n&&(s._audioSSRC=n),void 0!==r&&(s._cname=r),i&&(s._audioOrtc=i)):(s._video_added_=!0,void 0!==n&&(s._videoSSRC=n),void 0!==r&&(s._cname=r),void 0!==a&&(s._rtxSsrcId=a),i&&(s._videoOrtc=i)),("audio"===e?s.hasAudio:s.hasVideo)&&!c&&(pk.info("[".concat(this._clientId,"] remote user ").concat(s.uid," published ").concat(e)),this.safeEmit(dA.USER_PUBLISHED,s,e)),"video"===e?_k.onGatewayStream(this._sessionId,vk.ON_ADD_VIDEO_STREAM,gk.ON_ADD_VIDEO_STREAM,{peer:o||t,ssrc:s._videoSSRC}):_k.onGatewayStream(this._sessionId,vk.ON_ADD_AUDIO_STREAM,gk.ON_ADD_AUDIO_STREAM,{peer:o||t,ssrc:s._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(s,e,n).then((t=>{if(t&&(pk.debug("[".concat(this._clientId,"] resubscribe ").concat(e," for user ").concat(s.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof zB))return this._p2pChannel.unsubscribe(s,e,!0).then((()=>this._subscribe(s,e,!0).catch((e=>{pk.error("[".concat(this._clientId,"] resubscribe error"),e.toString())}))))})),this._p2pChannel.hasPendingRemoteMedia(s,e)&&(pk.debug("[".concat(this._clientId,"] resubscribe ").concat(e," for user ").concat(s.uid," after reconnect.")),this._subscribe(s,e,!0).catch((e=>{pk.error("[".concat(this._clientId,"] resubscribe error"),e.toString())})))})),OR(this,"_handleRemoveStream",(e=>{if(UN("BLOCK_LOCAL_CLIENT")&&FL(e.uid,this.channelName))return;const t=this._users.find((t=>t.uid===e.uid));if(!t)return void pk.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));pk.debug("[".concat(this._clientId,"] stream removed with uid ").concat(e.uid));let n=()=>{};t.hasAudio&&t.hasVideo?n=()=>{pk.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished audio track")),this.safeEmit(dA.USER_UNPUBLISHED,t,"audio"),pk.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished video track")),this.safeEmit(dA.USER_UNPUBLISHED,t,"video")}:t.hasVideo?n=()=>{pk.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished video track")),this.safeEmit(dA.USER_UNPUBLISHED,t,"video")}:t.hasAudio&&(n=()=>{pk.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished audio track")),this.safeEmit(dA.USER_UNPUBLISHED,t,"audio")}),t._video_pre_subscribed||t._audio_pre_subscribed||(t._trust_audio_stream_added_state_=!0,t._trust_video_stream_added_state_=!0,t._audio_added_=!1,t._video_added_=!1,this._p2pChannel instanceof zB&&this._p2pChannel.unsubscribe(t).then((e=>{if(e)return this._gateway.unsubscribe(e,t.uid)})),t._audioSSRC=void 0,t._videoSSRC=void 0,t._audioOrtc=void 0,t._videoOrtc=void 0,t._rtxSsrcId=void 0),_k.onGatewayStream(this._sessionId,vk.ON_REMOVE_STREAM,gk.ON_REMOVE_STREAM,{peer:e.uint_id||e.uid}),n()})),OR(this,"_handleSetStreamLocalEnable",((e,t,n)=>{if(UN("BLOCK_LOCAL_CLIENT")&&FL(t,this.channelName))return;const r=this._users.find((e=>e.uid===t));if(!r)return void pk.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));pk.debug("[".concat(this._clientId,"] local ").concat(e," ").concat(n?"enabled":"disabled"," with uid ").concat(t));const o="audio"===e?r.hasAudio:r.hasVideo;if("audio"===e){r._trust_audio_enabled_state_=!0;const e=r._audio_enabled_;if(r._audio_enabled_=n,r._audio_enabled_===e)return;{const e=r._audio_enabled_?"enable-local-audio":"disable-local-audio";pk.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(t,", msg: ").concat(e)),this.safeEmit(dA.USER_INFO_UPDATED,t,e)}}else{r._trust_video_enabled_state_=!0;const e=r._video_enabled_;if(r._video_enabled_=n,r._video_enabled_===e)return;{const e=r._video_enabled_?"enable-local-video":"disable-local-video";pk.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(t,", msg: ").concat(e)),this.safeEmit(dA.USER_INFO_UPDATED,t,e)}}const i="audio"===e?r.hasAudio:r.hasVideo;return o!==i?!o&&i?(pk.info("[".concat(this._clientId,"] remote user ").concat(t," published ").concat(e)),void this.safeEmit(dA.USER_PUBLISHED,r,e)):("video"===e&&r._videoTrack&&r._videoTrack._destroy(),"audio"===e&&r._audioTrack,this._p2pChannel.muteRemote(r,e),pk.info("[".concat(this._clientId,"] remote user ").concat(t," unpublished ").concat(e)),void this.safeEmit(dA.USER_UNPUBLISHED,r,e)):void 0})),OR(this,"_handleMuteStream",((e,t,n)=>{if(UN("BLOCK_LOCAL_CLIENT")&&FL(e,this.channelName))return;pk.debug("[".concat(this._clientId,"] receive mute message"),e,t,n);const r=this._users.find((t=>t.uid===e));if(!r)return void pk.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(e));const o="audio"===t?r.hasAudio:r.hasVideo;if("audio"===t){r._trust_audio_mute_state_=!0;const t=r._audio_muted_;if(r._audio_muted_=n,r._audio_muted_===t)return;{const t=r._audio_muted_?"mute-audio":"unmute-audio";pk.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(e,", msg: ").concat(t)),this.safeEmit(dA.USER_INFO_UPDATED,e,t)}}else{r._trust_video_mute_state_=!0;const t=r._video_muted_;if(r._video_muted_=n,r._video_muted_===t)return;{const t=r._video_muted_?"mute-video":"unmute-video";pk.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(e,", msg: ").concat(t)),this.safeEmit(dA.USER_INFO_UPDATED,e,t)}}const i="audio"===t?r.hasAudio:r.hasVideo;if(o!==i){if(!o&&i)return("audio"===t?r._audioSSRC:r._videoSSRC)?(pk.info("[".concat(this._clientId,"] remote user ").concat(e," published ").concat(t)),void this.safeEmit(dA.USER_PUBLISHED,r,t)):void pk.warning("[".concat(this._clientId,"] remote user ").concat(e," receive ").concat(t," unmute message  before add stream message, ").concat(t," SSRC doesn't exist yet."));"video"===t&&r._videoTrack&&!r._video_pre_subscribed&&r._videoTrack._destroy(),"audio"===t&&r._audioTrack,this._p2pChannel.muteRemote(r,t),pk.info("[".concat(this._clientId,"] remote user ").concat(e," unpublished ").concat(t)),this.safeEmit(dA.USER_UNPUBLISHED,r,t)}})),OR(this,"_handleP2PLost",(async e=>{pk.debug("[".concat(this._clientId,"] receive p2p lost"),e),parseInt(e.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():pk.warning("[".concat(this._clientId,"] P2PLost stream not found"),e)})),OR(this,"_handleTokenWillExpire",(()=>{pk.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(dA.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)})),OR(this,"_handleBeforeUnload",(e=>{"beforeunload"===e.type&&void 0!==e.returnValue&&""!==e.returnValue||(this.leave(),pk.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))})),OR(this,"_handleUpdateNetworkQuality",(()=>{if("normal"===this._networkQualitySensitivity)return;if(navigator&&void 0!==navigator.onLine&&!navigator.onLine)return void this.safeEmit(dA.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const e={downlinkNetworkQuality:0,uplinkNetworkQuality:0};e.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),e.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(dA.NETWORK_QUALITY,e)})),OR(this,"_handleP2PAddAudioOrVideoStream",((e,t,n,r)=>{const o=this._users.find((e=>e.uid===t));if(!o)return void pk.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));pk.debug("[".concat(this._clientId,"] stream added with uid ").concat(t,", type ").concat(e)),this.store.subscribe(o.uid,e,void 0,void 0,void 0,Date.now());const i="audio"===e?o.hasAudio:o.hasVideo;"audio"===e?o._trust_audio_stream_added_state_=!0:o._trust_video_stream_added_state_=!0,"audio"===e?(o._audio_added_=!0,void 0!==n&&(o._audioSSRC=n),void 0!==r&&(o._audioMid=r)):(o._video_added_=!0,void 0!==n&&(o._videoSSRC=n),void 0!==r&&(o._videoMid=r)),("audio"===e?o.hasAudio:o.hasVideo)&&!i&&(pk.info("[".concat(this._clientId,"] remote user ").concat(o.uid," published ").concat(e)),this.safeEmit(dA.USER_PUBLISHED,o,e)),this._p2pChannel.hasPendingRemoteMedia(o,e)&&(pk.debug("[".concat(this._clientId,"] resubscribe ").concat(e," for user ").concat(o.uid," after reconnect.")),this._subscribe(o,e,!0).catch((e=>{pk.error("[".concat(this._clientId,"] resubscribe error"),e.toString())})))})),this._config=e,this._clientId=t||LA(5,"client-"),this.store=new VN(e.codec,e.audioCodec,e.mode,this._clientId),this._leaveMutex=new YA("client-leave",this._clientId),this._publishMutex=new YA("client-publish",this._clientId),this._renewTokenMutex=new YA("client-renewtoken",this._clientId),this._subscribeMutex=new YA("client-subscribe",this._clientId),this.store.clientCreated(),e.proxyServer&&this.setProxyServer(e.proxyServer,!0),e.turnServer&&this.setTurnServer(e.turnServer,!0),pk.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(wN," build: ").concat(DN,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),e.clientRoleOptions)try{uA(e.clientRoleOptions),n=Object.assign({},e.clientRoleOptions)}catch(e){pk.warning("[".concat(this._clientId,"] ").concat(e.toString()))}var r;this._statsCollector=new jF(this.store),this._statsCollector.onStatsException=(e,t,n)=>{pk.warn("[".concat(this._clientId,"] receive exception msg, code: ").concat(e,", msg: ").concat(t,", uid: ").concat(n)),this.safeEmit(dA.EXCEPTION,{code:e,msg:t,uid:n})},this._statsCollector.onUploadPublishDuration=(e,t,n,r)=>{const o=this._users.find((t=>t.uid===e));o&&_k.peerPublishStatus(this._sessionId,{subscribeElapse:r,audioPublishDuration:t,videoPublishDuration:n,peer:o._uintid})},this.store.useP2P="p2p"===e.mode,this._gateway=new Yj(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:e.websocketRetryConfig||XA,httpRetryConfig:e.httpRetryConfig||XA,forceWaitGatewayResponse:void 0===e.forceWaitGatewayResponse||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:n}),this._configDistribute=new PF(this._clientId,this.store),this.store.useP2P?(this._p2pChannel=(r={store:this.store,statsCollector:this._statsCollector},Hj("P2PChannel").create(r)),this._handleP2PEvents()):this._p2pChannel=new zB(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(e,t,n,r,o){let i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];xN("JOIN_GATEWAY_USE_443PORT_ONLY",i),xN("JOIN_GATEWAY_USE_DUAL_DOMAIN",a);const s=this._gateway.signal.websocket;return s instanceof GU&&(s.use443PortOnly=i,s.tryDoubleDomain=a),async function(e,t,n){Qw.get(e)||Qw.set(e,[]),$w.get(e)||$w.set(e,t),eI.get(e)||eI.set(e,0);const r=Qw.get(e),o=$w.get(e);if(!r||!o)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(eI.get(e)===o){const e=Zw();r.push(e),await e.promise}eI.set(e,eI.get(e)+1);for(var i=arguments.length,a=new Array(i>3?i-3:0),s=3;s<i;s++)a[s-3]=arguments[s];const c=await n(...a);return eI.set(e,eI.get(e)-1),eI.get(e)===o-1&&r.length>0&&(r[0].resolve(),r.shift()),0===eI.get(e)&&(Qw.set(e,[]),$w.set(e,0),eI.set(e,0)),c}("client.join",UN("JOIN_MAX_CONCURRENCY"),this.join.bind(this),e,t,n,r,o)}async join(e,t,n,r,o){const i=++this._numberOfJoinCount;this.store.joinStart(),r&&(this.store.uid=r);const a="HTTPS"===(QA||QA||(QA=(window.location.protocol.split(":")[0]||"").toUpperCase(),QA)),s=oN()?window.isSecureContext:"Browser Not Support";if(!oN()&&!a||!window.isSecureContext){const e="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";pk.warning(e)}"DISCONNECTED"===this.connectionState&&(this.store.avoidJoinStart=Math.round(Date.now()),pk.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart))),_k.setAppId(e);try{if(!n&&null!==n)throw new bk(jI.INVALID_PARAMS,"Invalid token: ".concat(n,". If you don not use token, set it to null"));n&&WI(n,"token",1,2047),WI(e,"appid",1,2047),xx(t),r&&Ux(r),o&&WI(o,"optionalInfo",1,2047)}catch(o){throw _k.reportApiInvoke(xA(),{name:rA.JOIN,options:[e,t,n,r],states:{isHttps:a,isSecureContext:s},tag:oA.TRACER}).onError(o),o}if(this._leaveMutex.isLocked&&(pk.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),pk.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,"DISCONNECTED"!==this.connectionState){const o=new bk(jI.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw _k.reportApiInvoke(xA(),{name:rA.JOIN,options:[e,t,n,r],states:{isHttps:a,isSecureContext:s},tag:oA.TRACER}).onError(o),o}this._gateway.state="CONNECTING";const c=await EV({appId:e,cname:t,uid:r,stringUid:"string"==typeof r?r:void 0,token:n||e,cloudProxyServer:this._cloudProxyServerMode});if(!this._joinAndNotLeaveYet)throw new bk(jI.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));const l=(null==c?void 0:c.sid)||xA();pk.info("[".concat(this._clientId,"] start join channel ").concat(t,", join number: ").concat(i)),this._sessionId||(this._sessionId=l,this.store.sessionId=this._sessionId);const u=_k.reportApiInvoke(l,{id:this._clientId,name:rA.JOIN,options:[e,t,n,r],states:{isHttps:a,isSecureContext:s},tag:oA.TRACER}),d=JH(JH(JH({},this._rtmConfig),{},{role:this.role,clientId:this._clientId,appId:e,sid:this._sessionId,cname:t,uid:"string"!=typeof r?r:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:n||e,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:o,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint,preload:!!c},void 0!==this._remoteDefaultVideoStreamType&&{defaultVideoStream:this._remoteDefaultVideoStreamType}),{},{apRequestDetail:UN("AP_REQUEST_DETAIL")||void 0});if(this._useLocalAccessPoint&&(d.setLocalAPVersion=this._setLocalAPVersion),"string"==typeof r&&(d.stringUid=r,this._uintUid?(d.uid=this._uintUid,this._uintUid=void 0):d.uid=0),"none"!==this._encryptionMode&&this._encryptionSecret){if(d.aesmode=this._encryptionMode,d.aespassword=await(async e=>{const t=function(){const e=window.atob("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu\nSTM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+\nHvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy\nxQiYDz3vqa6bP29adwIDAQAB"),t=new Uint8Array(new ArrayBuffer(e.length));for(let n=0;n<e.length;n+=1)t[n]=e.charCodeAt(n);return t}(),n=await window.crypto.subtle.importKey("spki",t,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),r=ZI(e),o=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},n,r);return function(e){let t="";for(let n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return window.btoa(t)}(new Uint8Array(o))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new bk(jI.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(d.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&("aes-128-gcm2"===this._encryptionMode||"aes-256-gcm2"===this._encryptionMode))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){const e=new TextEncoder,t=UN("USE_PURE_ENCRYPTION_MASTER_KEY")?e.encode(d.appId+this._encryptionSecret+this._encryptionSecret):e.encode(d.appId+d.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(e,t,n){const r=await window.crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveBits","deriveKey"]),o="aes-128-gcm2"===e?128:256,i=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:1e3,hash:"SHA-256",salt:n},r,o+96);return new Uint8Array(i).subarray(o/8)}(this._encryptionMode,t,wA(this._encryptionSalt)),this._encryptDataStreamKey=await async function(e,t,n){const r=await window.crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveBits","deriveKey"]),o="aes-128-gcm2"===e?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:1e3,hash:"SHA-256",salt:n},r,{name:"AES-GCM",length:o},!0,["encrypt","decrypt"])}(this._encryptionMode,t,wA(this._encryptionSalt))}else s?pk.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):pk.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,pk.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:t,appId:e,stringUid:d.stringUid});const p=this._sessionId;setTimeout((()=>{"CONNECTING"===this.connectionState&&p===this._sessionId&&_k.joinChannelTimeout(this._sessionId,5)}),5e3);try{var h;let r;const o=d.cloudProxyServer;if(Ur(h=["proxy3","proxy4","proxy5"]).call(h,o)){const e=UN("PROXY_SERVER_TYPE3");Array.isArray(e)?d.proxyServer=e[0]:d.proxyServer=e}if(_k.setProxyServer(d.proxyServer),pk.setProxyServer(d.proxyServer),this.store.requestAPStart(),c){if(pk.debug("[".concat(this._clientId,"] get serverInfo Success from Preload Cache ").concat(d.stringUid?", ".concat(d.stringUid," => ").concat(c.intUid):""," ")),d.stringUid&&!d.uid&&(d.uid=c.intUid),r={gatewayInfo:c.ap.gatewayInfo},UN("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&"auto"===d.turnServer.mode)if(0===c.ap.proxyInfo.addresses.length)pk.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{const e=(await nj(c.ap.proxyInfo,c.ap.gatewayInfo.uid)).map((e=>({turnServerURL:e.address,tcpport:e.tcpport||NN.tcpport,udpport:e.udpport||NN.udpport,username:e.username||NN.username,password:e.password||NN.password,forceturn:!1,security:!0})));d.turnServer={mode:"manual",servers:e}}TV(c,d.stringUid)}else{if(d.stringUid&&!d.uid){let e;[e,r]=await ih.all([SF(d.stringUid,d,this._axiosCancelSource.token,this._config.httpRetryConfig||XA,this.store),TF(d,this._axiosCancelSource.token,this._config.httpRetryConfig||XA,!0,this.store)]),pk.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(d.stringUid," => ").concat(e)),d.uid=e,r.gatewayInfo.uid=e,r.gatewayInfo.res.uid=e}else r=await TF(d,this._axiosCancelSource.token,this._config.httpRetryConfig||XA,!0,this.store);if(!this._joinAndNotLeaveYet)throw new bk(jI.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"))}this.store.requestAPEnd(),setTimeout((()=>{this._configDistribute.startGetConfigDistribute(d,this._axiosCancelSource.token),this._configDistribute.on(iU.UPDATE_BITRATE_LIMIT,(e=>{this._p2pChannel.updateBitrateLimit(e)})),this._configDistribute.on(iU.UPDATE_CLIENT_ROLE_OPTIONS,(e=>{this._setClientRoleOptions(e)}))}),0),this._key=n||e;const i=r.gatewayInfo,a=d.uid?d.uid:i.uid;this._joinInfo=JH(JH({},d),{},{cid:i.cid,uid:a,vid:i.vid,apResponse:i.res,apGatewayAddress:i.apGatewayAddress,uni_lbs_ip:i.uni_lbs_ip,gatewayAddrs:i.gatewayAddrs}),this.store.intUid=a,this.store.cid=i.cid;const s=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new bk(jI.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));u.onSuccess(s),this._appId=e,this._channelName=d.cname,this._uid=s,this.store.uid=s,setTimeout((()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(pI()?"beforeunload":"pagehide",this._handleBeforeUnload),this._statsCollector.startUpdateStats()}),0);const l=d.stringUid?"string uid: ".concat(d.stringUid,",uid: ").concat(d.uid):"uid: ".concat(this._uid);return pk.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(t,",").concat(l)),setTimeout((()=>{pk.startUpload()}),5e3),this.store.joinEnd(),f=this,Ur(UL).call(UL,f)||UL.push(f),"disabled"===this._cloudProxyServerMode&&Sk().supportWebCrypto&&UN("ENABLE_PRELOAD")&&_V(this._joinInfo),s}catch(e){const t=Array.isArray(e)?e[0]:e;throw t&&t.code===jI.OPERATION_ABORTED?pk.warning("[".concat(this._clientId,"] join number: ").concat(i,", Joining channel failed, rollback"),t):pk.error("[".concat(this._clientId,"] join number: ").concat(i,", Joining channel failed, rollback"),t),t.code!==jI.OPERATION_ABORTED&&this._numberOfJoinCount===i&&(this._gateway.state="DISCONNECTED",this._reset()),u.onError(t),t}var f}_joinGateway(){if(!this._joinInfo||!this._key)throw new bk(jI.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!("disabled"!==this._joinInfo.cloudProxyServer||this._joinInfo.proxyServer||!UN("JOIN_WITH_FALLBACK_SIGNAL_PROXY")))}async leave(){pk.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(pI()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(e){const t=UL.indexOf(e);-1!==t&&UL.splice(t,1)}(this),this._statsCollector.stopUpdateStats();const e=await this._leaveMutex.lock();if("DISCONNECTED"===this.connectionState)return pk.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void e();await this._gateway.leave("CONNECTED"!==this.connectionState,sA.LEAVE),pk.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),e()}async publish(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!Array.isArray(e)){if(!(e instanceof mP))return this._publishDataChannel(e);e=[e]}if(0===e.length)throw new bk(jI.INVALID_PARAMS,"param list is empty");const n=e;if("audience"===this._gateway.role)throw new bk(jI.INVALID_OPERATION,"audience can not publish stream");for(const o of n){if(!(o instanceof mP))throw new bk(jI.INVALID_PARAMS,"parameter is not local track");if(!o._enabled&&t)throw new bk(jI.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(o.getTrackId()))}pk.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(n.map((e=>"".concat(e.getTrackId()," ")))));const r=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),t&&n.forEach((e=>{const t=this._configDistribute.getBitrateLimit();e instanceof DM&&t&&e.setBitrateLimit(t.uplink)}));try{await this._publishHighStream(n),pk.info("[".concat(this._clientId,"] Publish success, id ").concat(n.map((e=>"".concat(e.getTrackId()," ")))))}catch(e){throw pk.error("[".concat(this._clientId,"] publish error"),e.toString()),e}finally{r()}}async _publishDataChannel(e){HI(e.id,"id",0,65535,!0),BI(e.ordered,"ordered"),WI(e.metadata,"metadata",0,512),pk.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(e.id));const t=await this._publishMutex.lock();try{if(-1!==this._p2pChannel.getAllDataChannels().findIndex((t=>t.id===e.id)))throw new bk(jI.INVALID_PARAMS,"Invalid id: ".concat(e.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||void 0===this._uid)throw new bk(jI.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new bk(jI.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if("auto"===this._turnServer.mode&&UN("FORCE_TURN")&&!UN("TURN_ENABLE_TCP")&&!UN("TURN_ENABLE_UDP"))throw new bk(jI.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const t=function(e){return Gj(e,!1)}(e),n=await this._p2pChannel.publishDataChannel([t]);if(n.length>0){if("number"!=typeof t._originDataChannelId)throw pk.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new bk(jI.CREATE_DATACHANNEL_ERROR);try{await ih.all(n.map((e=>this._uid&&this._gateway.publishDataChannel(this._uid,e,!0)))),await t._waitTillOpen()}catch(e){if(e.code!==jI.DISCONNECT_P2P)throw e}}return pk.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(t.id)),t}catch(e){throw pk.error("[".concat(this._clientId,"] publish datachannels error"),e.toString()),e}finally{t()}}async unpublish(e){if(!this._joinInfo||void 0===this._uid)throw new bk(jI.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let t=[];if(e)if(Array.isArray(e))t=e;else{if(!(e instanceof mP))return this._unpublishDataChannel([e]);t=[e]}else this.store.useP2P||await this._unpublishDataChannel(),t=this._p2pChannel.getAllTracks(!0);pk.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(t.map((e=>"".concat(e.getTrackId()," ")))," "));const n=await this._publishMutex.lock();try{if(this.store.useP2P){const e=await this._p2pChannel.unpublish(t);e&&await this._gateway.sendExtensionMessage(OU.UNPUBLISH,{unpubMsg:e},!0)}else{const e=await this._p2pChannel.unpublish(t);e&&await this._gateway.unpublish(e,this._uid),pk.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(t.map((e=>"".concat(e.getTrackId())))))}}catch(e){throw pk.error("[".concat(this._clientId,"] unpublish error"),e.toString()),e}finally{n&&n()}}async _unpublishDataChannel(e){void 0!==e&&0!==e.length||(e=this._p2pChannel.getAllDataChannels()),pk.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(e.map((e=>"".concat(e.id," ")))," "));const t=await this._publishMutex.lock();try{const t=await this._p2pChannel.unpublishDataChannel(e);t&&await this._gateway.unpublishDataChannel(t),pk.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(e.map((e=>"".concat(e.id)))))}catch(e){throw pk.error("[".concat(this._clientId,"] unpublish dataChannel error"),e.toString()),e}finally{t&&t()}}async subscribe(e,t,n){if(!(e instanceof VF)){const t=this.remoteUsers.find((t=>t.uid===e));if(!t)throw new bk(jI.INVALID_REMOTE_USER,"user is not in the channel");e=t}return"datachannel"===t?this._subscribeDataChannel(e,n):this._subscribe(e,t)}async presubscribe(e,t){if(VI(t,"mediaType",["audio","video"]),this.store.useP2P)throw new bk(jI.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new bk(jI.INVALID_OPERATION,"can't presub when not join");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new bk(jI.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const n=t===lU.AUDIO,r=t===lU.VIDEO,o=await this._subscribeMutex.lock();try{const{ssrcId:o,ortc:i,rtxSsrcId:a,cname:s,uint_id:c}=await this._gateway.presubscribe(e,t,!0);if(null==o)throw new bk(jI.UNEXPECTED_RESPONSE,"no ssrc id");let l=this._users.find((t=>t.uid===e));l||(l=new VF(e,c||e),l._is_pre_created=!0,this._users.push(l)),s&&(l._cname=s),l._uintid||(l._uintid=c||e),n&&(l._audioSSRC=o,l._audio_pre_subscribed=!0,i&&(l._audioOrtc=i)),r&&(l._videoSSRC=o,l._video_pre_subscribed=!0,i&&(l._videoOrtc=i),null!=a&&(l._rtxSsrcId=a)),pk.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(o)),await this._p2pChannel.subscribe(l,t,o,a,i);const u=n?l._audioTrack:l._videoTrack;if(!u)throw new bk(jI.UNEXPECTED_ERROR,"can not find remote track in user");return n&&(l._trust_audio_stream_added_state_=!0,l._audio_added_=!0),r&&(l._trust_video_stream_added_state_=!0,l._video_added_=!0),u}catch(t){throw pk.error("[".concat(this._clientId,"] presub user ").concat(e," error"),t),t}finally{o()}}async _subscribeDataChannel(e,t){var n;if(HI(t,"channelId",0,65535,!0),!this._joinInfo)throw new bk(jI.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new bk(jI.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));const r=this._users.find((t=>t===e));if(!r)throw pk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),new bk(jI.INVALID_REMOTE_USER,"user is not in the channel");if(!e.hasAudio&&!e.hasVideo&&0===e._dataChannels.length)throw pk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),new bk(jI.INVALID_REMOTE_USER,"user is not published");const o=null===(n=e._dataChannels)||void 0===n?void 0:n.find((e=>e.id===t));if(!o)throw pk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, remote datachannel is not published")),new bk(jI.REMOTE_USER_IS_NOT_PUBLISHED);const i=await this._subscribeMutex.lock();pk.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: datachannel"));try{const n=await this._p2pChannel.subscribeDataChannel(e,[o]);if(n&&Ur(n).call(n,o.id))try{var a;if("number"!=typeof o._originDataChannelId)throw pk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, cannot get RTCDatachannel")),new bk(jI.CREATE_DATACHANNEL_ERROR);const t={id:o.id,datachannelId:o._originDataChannelId,ordered:o.ordered,maxRetransmits:o.maxRetransmits,metadata:null!==(a=o.metadata)&&void 0!==a?a:""};await this._gateway.subscribeDataChannel(e.uid,t,!0),await o._waitTillOpen()}catch(t){if((null==t?void 0:t.code)!==jI.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(e,[o]),t;await this._p2pChannel.unsubscribeDataChannel(e,[o]),this._p2pChannel.setPendingRemoteDataChannel(e,o.id)}return pk.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: datachannel")),o}finally{i()}}async _p2pSubscribe(e,t,n){if(VI(t,"mediaType",["audio","video"]),!this._joinInfo)throw new bk(jI.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new bk(jI.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const r=this._users.find((t=>t===e));if(!r){const t=new bk(jI.INVALID_REMOTE_USER,"user is not in the channel");throw pk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),t}if(!e.hasAudio&&!e.hasVideo){const t=new bk(jI.INVALID_REMOTE_USER,"user is not published");throw pk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),t}if(!n&&("audio"===t&&!e.hasAudio||"video"===t&&!e.hasVideo)){const n=new bk(jI.REMOTE_USER_IS_NOT_PUBLISHED);throw pk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),n}const o=await this._subscribeMutex.lock();pk.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{const n="audio"===t?e._audioSSRC:e._videoSSRC,r="audio"===t?e._audioMid:e._videoMid;this.store.subscribe(e.uid,t,Date.now()),this.store.useP2P&&await this._p2pChannel.subscribe(e,t,n,r)}catch(e){throw e}pk.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch((e=>{pk.warning("[".concat(this._clientId,"] auto set fallback failed"),e)}));const n="audio"===t?e._audioTrack:e._videoTrack;if(!n)throw new bk(jI.UNEXPECTED_ERROR,"can not find remote track in user object");return n}catch(t){throw pk.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),t),t}finally{o()}}async _subscribe(e,t,n){if(this.store.useP2P)return this._p2pSubscribe(e,t);if(VI(t,"mediaType",["audio","video"]),!this._joinInfo)throw new bk(jI.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new bk(jI.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const r=this._users.find((t=>t===e));if(!r){const t=new bk(jI.INVALID_REMOTE_USER,"user is not in the channel");throw pk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),t}if(!e.hasAudio&&!e.hasVideo){const t=new bk(jI.INVALID_REMOTE_USER,"user is not published");throw pk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),t}if(!(n||("audio"!==t||e.hasAudio&&void 0!==e._audioSSRC)&&("video"!==t||e.hasVideo&&void 0!==e._videoSSRC))){const n=new bk(jI.REMOTE_USER_IS_NOT_PUBLISHED);throw pk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),n}let o="audio"===t?e._audioSSRC:e._videoSSRC,i="audio"===t?e._audioOrtc:e._videoOrtc,a="video"===t?e._rtxSsrcId:void 0,s={stream_type:"audio"===t?lU.AUDIO:lU.VIDEO,ssrcId:o};const c=await this._subscribeMutex.lock();pk.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{const r="audio"===t?e._audioSSRC:e._videoSSRC;void 0!==r&&r!==o&&(o=r,i="audio"===t?e._audioOrtc:e._videoOrtc,a="video"===t?e._rtxSsrcId:void 0,s={stream_type:"audio"===t?lU.AUDIO:lU.VIDEO,ssrcId:o}),LF.markSubscribeStart(this.store.clientId,o),this.store.subscribe(e.uid,t,Date.now()),await this._p2pChannel.subscribe(e,t,o,a,i);try{this._p2pChannel.isPreSubScribe(o)||await this._gateway.subscribe(e.uid,s,!0)}catch(n){if((null==n?void 0:n.code)!==jI.WS_ABORT)throw await this._p2pChannel.unsubscribe(e,t),n;await this._p2pChannel.unsubscribe(e,t,!0),this._p2pChannel.setPendingRemoteMedia(e,t)}this.store.subscribe(e.uid,t,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,e,t)}catch(n){throw this._p2pChannel.reportSubscribeEvent(!1,null==n?void 0:n.code,e,t),n}pk.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch((e=>{pk.warning("[".concat(this._clientId,"] auto set fallback failed"),e)}));const r="audio"===t?e._audioTrack:e._videoTrack;if(!r)throw new bk(jI.UNEXPECTED_ERROR,"can not find remote track in user object");return r}catch(t){throw pk.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),t),t}finally{c()}}async massSubscribe(e){if(qI(e,"subscribeList"),!this._joinInfo)throw new bk(jI.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new bk(jI.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const t=Date.now(),n=new Map,r=await this._subscribeMutex.lock();pk.info("[".concat(this._clientId,"]start massSubscribe user ").concat(e.map((e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n)})).join("; ")));const o=(e=[...e]).map((e=>{let{user:t,mediaType:n}=e;return{user:t,mediaType:n}})),i=await this._p2pChannel.globalLock();try{var a;for(let t=e.length-1;t>=0;t--){const r=e[t],{user:i,mediaType:a}=r;if(VI(a,"mediaType",["audio","video"]),!i){const e=new bk(jI.INVALID_PARAMS,"user property does not exist in subscribeList item");throw pk.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),e}const s=this._users.find((e=>e===i));if(!s){const n=new bk(jI.INVALID_REMOTE_USER,"user is not in the channel");pk.error("[".concat(this._clientId,"] can not massSubscribe ").concat(i.uid,", this user is not in the channel")),o[t].error=n,e.splice(t,1);continue}if("audio"===a&&(!i.hasAudio||void 0===i._audioSSRC)||"video"===a&&(!i.hasVideo||void 0===i._videoSSRC)){const n=new bk(jI.REMOTE_USER_IS_NOT_PUBLISHED);pk.error("[".concat(this._clientId,"] can not subscribe ").concat(i.uid," with mediaType ").concat(a,", remote user is not published")),o[t].error=n,e.splice(t,1);continue}const c=eU.Video|eU.LwoVideo,l=n.get(i);if(l){if("video"===a?l&c:l&eU.Audio){e.splice(t,1),pk.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(i.uid,", mediaType:").concat(a," twice"));continue}n.set(i,l|("video"===a?c:eU.Audio))}else n.set(i,"video"===a?c:eU.Audio)}for(let t=e.length-1;t>=0;t--){const r=e[t],{user:o,mediaType:i}=r,a=eU.Video|eU.LwoVideo;if(this._p2pChannel.hasRemoteMedia(o,i)){await this._p2pChannel.unmuteRemoteNoLock(o,i);const r=n.get(o);n.set(o,"video"===i?r^a:r^eU.Audio),e.splice(t,1)}}this.store.massSubscribe(e.map((e=>({userId:e.user.uid,type:e.mediaType}))),t);let r=so(a=Array.from(n.entries())).call(a,((e,t)=>{let[n,r]=t;if(0===r)return e;const o={stream_id:n.uid,stream_type:r};return r&eU.Audio&&(o.audio_ssrc=n._audioSSRC),r&eU.Video&&(o.video_ssrc=n._videoSSRC),e.push(o),e}),[]);try{e.length>0&&await this._p2pChannel.massSubscribeNoLock(e.map((e=>{let{user:t,mediaType:n}=e;return{user:t,mediaType:n,ssrcId:n===lU.VIDEO?t._videoSSRC:t._audioSSRC,rtxSsrcId:n===lU.VIDEO?t._rtxSsrcId:void 0}})));const n=new Map;if(r=r.filter((e=>e.video_ssrc&&!this._p2pChannel.isPreSubScribe(e.video_ssrc)||e.audio_ssrc&&!this._p2pChannel.isPreSubScribe(e.audio_ssrc)||!e.video_ssrc&&!e.audio_ssrc)),r.length>0){const e=await this._gateway.subscribeAll(r,!0);((null==e?void 0:e.users)||[]).forEach((e=>{let{stream_id:t,video_error_code:r,audio_error_code:o,error_code:i}=e;(r||o||i)&&n.set(t,{video_error_code:r,audio_error_code:o,error_code:i})}))}if(Array.from(n.entries()).length>0){const e=[];Array.from(n.entries()).forEach((t=>{let[n,r]=t;const o=this.remoteUsers.find((e=>e.uid===n));if(o){let t;r.error_code||r.video_error_code&&r.audio_error_code?t=void 0:r.video_error_code?t=lU.VIDEO:r.audio_error_code&&(t=lU.AUDIO),e.push({user:o,mediaType:t})}})),e.length>0&&await this._p2pChannel.massUnsubscribeNoLock(e)}for(const e of o){const t=n.get(e.user.uid);if(t){const n=t.error_code||"audio"===e.mediaType&&t.audio_error_code||"video"===e.mediaType&&t.video_error_code;if(n){const t=kU(n);pk.error("user:".concat(e.user.uid," mediaType:").concat(e.mediaType," has massSubscribe error ").concat(t.desc)),e.error=new bk(jI.SUBSCRIBE_FAILED,"code ".concat(n,": ").concat(t.desc))}}e.error||("video"===e.mediaType?e.track=e.user.videoTrack:e.track=e.user.audioTrack)}return this.store.massSubscribe(o.filter((e=>!e.error)).map((e=>({userId:e.user.uid,type:e.mediaType}))),void 0,Date.now()),o.forEach((e=>{var n;_k.subscribe(this.store.sessionId,{succ:!!e.error,ec:(null===(n=e.error)||void 0===n?void 0:n.code)||null,video:e.mediaType===lU.VIDEO,audio:e.mediaType===lU.AUDIO,peerid:e.user.uid,subscribeRequestid:e.mediaType===lU.VIDEO?e.user._videoSSRC:e.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-t),preSsrc:this._p2pChannel.isPreSubScribe(e.user._videoSSRC)},!0)})),pk.info("[".concat(this._clientId,"] massSubscribe success ").concat(e.map((e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n)})).join("; "))),o}catch(t){throw await this._p2pChannel.massUnsubscribeNoLock(e),t}}finally{i(),r()}}async unsubscribe(e,t,n){if(!(e instanceof VF)){const t=this.remoteUsers.find((t=>t.uid===e));if(!t)throw new bk(jI.INVALID_REMOTE_USER,"user is not in the channel");e=t}if(t||this.store.useP2P){if("datachannel"===t)return this._unsubscribeDataChannel(e,n)}else await this._unsubscribeDataChannel(e,n);if(t&&VI(t,"mediaType",["audio","video"]),!this._joinInfo)throw new bk(jI.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");const r=this._users.find((t=>t===e));if(!r){const t=new bk(jI.INVALID_REMOTE_USER,"user is not in the channel");throw pk.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),t}pk.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: ").concat(t));const o=await this._subscribeMutex.lock();try{if(this.store.useP2P)await this._p2pChannel.unsubscribe(e,t);else{const n=await this._p2pChannel.unsubscribe(e,t);n&&await this._gateway.unsubscribe(n,e.uid),t&&"audio"!==t||(e._audio_pre_subscribed=!1),t&&"video"!==t||(e._video_pre_subscribed=!1),e._is_pre_created&&_A(this._users,e),pk.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(e.uid,", mediaType: ").concat(t))}}catch(t){if(t.code===jI.DISCONNECT_P2P)return void pk.warning("disconnecting p2p, abort unsubscribe request.");throw pk.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),t.toString()),t}finally{o()}}async _unsubscribeDataChannel(e,t){if(t&&HI(t,"id",0,65535,!0),!this._joinInfo)throw new bk(jI.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");const n=this._users.find((t=>t===e));if(!n){const t=new bk(jI.INVALID_REMOTE_USER,"user is not in the channel");throw pk.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),t}let r;if("number"==typeof t){const n=e._dataChannels.find((e=>e.id===t));n&&(r=[n])}else r=e._dataChannels;if(void 0===r){const n=new bk(jI.REMOTE_USER_IS_NOT_PUBLISHED);throw pk.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid," with channelId ").concat(t,", remote datachannel is not published")),n}pk.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(r.map((e=>e.id))));try{const t=await this._p2pChannel.unsubscribeDataChannel(e,r);t&&await this._gateway.unsubscribeDataChannel(t,e.uid),pk.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(t))}catch(t){if(t.code===jI.DISCONNECT_P2P)return void pk.warning("disconnecting p2p, abort unsubscribe request.");throw pk.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),t.toString()),t}}async massUnsubscribe(e){if(qI(e,"unsubscribeList"),!this._joinInfo)throw new bk(jI.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");pk.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(e.map((e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n,";")})).join())),e=[...e];const t=new Map;for(let n=e.length-1;n>=0;n--){const{user:r,mediaType:o}=e[n];if(!r){const e=new bk(jI.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw pk.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),e}VI(o,"mediaType",["video","audio",void 0]);const i=this._users.find((e=>e===r));if(!i){pk.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(r.uid,", user is not in the channel")),e.splice(n,1);continue}const a=eU.Video|eU.LwoVideo;if(t.has(r)){const i=t.get(r);let s;switch(o){case"video":s=i&a;break;case"audio":s=i&eU.Audio;break;default:s=i&(eU.Audio|a)}if(s){pk.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(r.uid,",mediaType:").concat(o," twice.")),e.splice(n,1);continue}o?"audio"===o?t.set(r,i|eU.Audio):"video"===o&&t.set(r,i|a):t.set(r,i|eU.Audio|a)}else o?"audio"===o?t.set(r,eU.Audio):"video"===o&&t.set(r,a):t.set(r,eU.Audio|a)}try{const t=await this._p2pChannel.massUnsubscribe(e);t&&await this._gateway.massUnsubscribe(t),pk.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(e.map((e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n,";")})).join()))}catch(e){if(e.code===jI.DISCONNECT_P2P)return void pk.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw pk.error("[".concat(this._clientId,"] massUnsubscribe error"),e.toString()),e}}async setLowStreamParameter(e){!function(e){if(!e)throw new FI(jI.INVALID_PARAMS);KI(e.width)||GI(e.width,"streamParameter.width"),KI(e.height)||GI(e.height,"streamParameter.height"),KI(e.framerate)||GI(e.framerate,"streamParameter.framerate"),KI(e.bitrate)||HI(e.bitrate,"streamParameter.bitrate")}(e),(!e.width&&e.height||e.width&&!e.height)&&pk.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),pk.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(e));const t=this._configDistribute.getLowStreamConfigDistribute();if(t&&t.bitrate&&e.bitrate&&t.bitrate<e.bitrate&&(e.bitrate=t.bitrate),this._lowStreamParameter=e,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(e,hU.LocalVideoLowTrack)}async enableDualStream(){if(!Sk().supportDualStream)throw _k.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new bk(jI.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new bk(jI.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(e){throw _k.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),e}this._isDualStreamEnabled=!0,_k.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),pk.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new bk(jI.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(hU.LocalVideoLowTrack))try{const e=await this._p2pChannel.unpublishLowStream();e&&await this._gateway.unpublish(e,this._joinInfo.stringUid||this._joinInfo.uid)}catch(e){throw _k.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),e}this._isDualStreamEnabled=!1,_k.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),pk.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(e,t){if(function(e){VI(e,"role",["audience","host"])}(e),t&&uA(t),"rtc"===this.mode||"p2p"===this.mode)throw pk.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new bk(jI.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(t&&t.level&&"host"===e)throw new bk(jI.INVALID_OPERATION,"host mode can not set audience latency level");if("audience"===e&&this._p2pChannel.hasLocalMedia())throw new bk(jI.INVALID_OPERATION,"can not set client role to audience when publishing stream");const n=this._config.role;this._joinInfo&&(this._joinInfo.role=e),e!==n&&UN("ENABLE_ROLE_SELECT_EDGE")?(this._gateway.updateClientRole(e,t),this._config.role=e,this._gateway.reconnect("recover",pA.REGIONAL_DISTRIBUTION)):(await this._gateway.setClientRole(e,t),this._config.role=e),pk.info("[".concat(this._clientId,"] set client role to ").concat(e,", level: ").concat(t&&t.level))}async _setClientRoleOptions(e){if("rtc"===this.mode||"p2p"===this.mode)return;if("audience"!==this._config.role||this._p2pChannel.hasLocalMedia())return;let t=!1;try{e&&uA(e),await this._gateway.setClientRole(this._config.role,e),t=!0}catch(e){}finally{pk.info("[".concat(this._clientId,"] set client role options ").concat(t?"succeed":"failed",", options is ").concat(e))}}getRemoteInboundOffset(){var e;const t=null===(e=this._p2pChannel.getStats())||void 0===e?void 0:e.audioSend[0];if(!t||!t.timestamp)return 0;const n=t.timestamp-Date.now();return Math.abs(n)>1e3+t.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?n:0}getNtpWallTimeInMs(){return"visible"===document.visibilityState&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(e,t){if(WI(e,"proxyServer"),!t){if("DISCONNECTED"!==this.connectionState)throw new bk(jI.INVALID_OPERATION,"Set proxy server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new bk(jI.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=e,_k.setProxyServer(this._proxyServer),pk.setProxyServer(this._proxyServer),pk.info("[".concat(this._clientId,"] Set proxy server ").concat(t?"by initialize call":""," success."))}setTurnServer(e,t){if(Array.isArray(e)||(e=[e]),!t){if("DISCONNECTED"!==this.connectionState)throw new bk(jI.INVALID_OPERATION,"Set turn server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new bk(jI.INVALID_OPERATION,"You have already set the proxy")}if(cA(e))return this._turnServer={servers:e,mode:"original-manual"},void pk.info("[".concat(this._clientId,"] Set original turnserver ").concat(t?"by initialize call":""," success: ").concat(e.map((e=>e.urls)).join(","),"."));e.forEach((e=>lA(e))),this._turnServer={servers:e,mode:"manual"},pk.info("[".concat(this._clientId,"] Set turnserver ").concat(t?"by initialize call":""," success."))}setLicense(e){if("DISCONNECTED"!==this.connectionState)throw new bk(jI.INVALID_OPERATION,"you should set license before join channel");if(WI(e,"license",32,32),!/^[A-Za-z\d]+$/.test(e))throw new bk(jI.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=e,pk.info("[".concat(this._clientId,"] set license success"),e)}startProxyServer(e){if("DISCONNECTED"!==this.connectionState)throw new bk(jI.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||"manual"===this._turnServer.mode||this._useLocalAccessPoint)throw new bk(jI.INVALID_OPERATION,"You have already set the proxy");const t=[3,4,5];let n;switch(void 0===e&&(e=3),e){case 1:case 2:throw new bk(jI.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:n="proxy3";break;case 4:n="proxy4";break;case 5:n="proxy5";break;default:throw new bk(jI.INVALID_PARAMS,"proxy server mode must be ".concat(t.join("|")))}this._cloudProxyServerMode=n,this.store.cloudProxyServerMode=n,pk.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if("DISCONNECTED"!==this.connectionState)throw new bk(jI.INVALID_OPERATION,"Stop proxy server after leave channel");_k.setProxyServer(),pk.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",pk.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(e){if(!e.accessPoints)throw new bk(jI.INVALID_PARAMS,"accessPoints is required.");qI(e.accessPoints.serverList,"accessPoints.serverList"),WI(e.accessPoints.domain,"accessPoints.domain");const t=(e,t)=>{HI(e,t,0,65535,!0)};let n=443;if(e.accessPoints.port&&(t(e.accessPoints.port,"accessPoints.port"),n=e.accessPoints.port),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new bk(jI.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");UN("CLOSE_AFB_FOR_LOCAL_AP")&&(xN("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),xN("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const r=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,o=e.accessPoints.domain,i=e.accessPoints.serverList.map((e=>r.test(e)?"".concat(e.replace(/\./g,"-"),".").concat(o):e)),a=i.map((e=>"".concat(e,":").concat(n)));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,xN("WEBCS_DOMAIN",a),xN("WEBCS_DOMAIN_BACKUP_LIST",a),xN("GATEWAY_DOMAINS",[o]),e.report&&e.report.hostname&&Array.isArray(e.report.hostname)&&e.report.hostname.length?(qI(e.report.hostname,"report.hostname"),xN("EVENT_REPORT_DOMAIN",e.report.hostname[0]),xN("EVENT_REPORT_BACKUP_DOMAIN",e.report.hostname[1]||e.report.hostname[0])):(xN("EVENT_REPORT_DOMAIN",i[0]),xN("EVENT_REPORT_BACKUP_DOMAIN",i[1]||i[0]));let s=6443;e.report&&e.report.port&&(t(e.report.port,"report.port"),s=e.report.port),xN("STATS_COLLECTOR_PORT",s),e.report?xN("ENABLE_EVENT_REPORT",!0):xN("ENABLE_EVENT_REPORT",!1);let c="";e.log&&e.log.hostname&&Array.isArray(e.log.hostname)&&e.log.hostname.length?(qI(e.log.hostname,"log.hostname"),c=e.log.hostname[0]):c=i[0];let l=6444;e.log&&e.log.port&&(t(e.log.port,"log.port"),l=e.log.port),xN("LOG_UPLOAD_SERVER","".concat(c,":").concat(l));let u=[];e.cds&&e.cds.hostname&&Array.isArray(e.cds.hostname)&&e.cds.hostname.length?(qI(e.cds.hostname,"cds.hostname"),u=e.cds.hostname):u=i;let d=443;e.cds&&e.cds.port&&(t(e.cds.port,"cds.port"),d=e.cds.port),xN("CDS_AP",u.map((e=>"".concat(e,":").concat(d)))),e.cds?xN("ENABLE_CONFIG_DISTRIBUTE",!0):xN("ENABLE_CONFIG_DISTRIBUTE",!1),pk.info("set local access point v2 success")}setLocalAccessPoints(e,t){if(qI(e,"serverList"),WI(t,"domain"),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new bk(jI.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const n=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=e.map((e=>n.test(e)?"".concat(e.replace(/\./g,"-"),".").concat(t):e)),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,xN("WEBCS_DOMAIN",e),xN("WEBCS_DOMAIN_BACKUP_LIST",e),xN("GATEWAY_DOMAINS",[t]),xN("EVENT_REPORT_DOMAIN",e[0]),xN("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),xN("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),pk.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(e){if(VI(e,"streamType",[0,1,4,5,6,7,8,9]),this._remoteDefaultVideoStreamType=e,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(e),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(e){throw pk.error("[".concat(this._clientId,"] set default remote video stream type error"),e.toString()),e}else pk.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(e))}async setRemoteVideoStreamType(e,t){VI(t,"streamType",[0,1,4,5,6,7,8,9]);try{await this._gateway.setRemoteVideoStreamType(e,t),setTimeout((()=>{const t=this._users.find((t=>t.uid===e));t&&t.videoTrack&&t.videoTrack.updateMediaStreamTrackResolution()}),2e3)}catch(e){throw pk.error("[".concat(this._clientId,"] set remote video stream type error"),e.toString()),e}pk.info("[".concat(this._clientId,"] set remote ").concat(e," video stream type to ").concat(t)),this._remoteStreamTypeCacheMap.set(e,t)}async setStreamFallbackOption(e,t){VI(t,"fallbackType",[0,1,2,3,4,5,6,7,8]);try{await this._gateway.setStreamFallbackOption(e,t)}catch(e){throw pk.error("[".concat(this._clientId,"] set stream fallback option"),e.toString()),e}pk.info("[".concat(this._clientId,"] set remote ").concat(e," stream fallback type to ").concat(t)),this._streamFallbackTypeCacheMap.set(e,t)}setEncryptionConfig(e,t,n,r){!function(e){VI(e,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])}(e),WI(t,"secret");const o=["aes-128-gcm2","aes-256-gcm2"];if(Ur(o).call(o,e)){if(!n||!(n instanceof Uint8Array&&32===n.length))throw new bk(jI.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(n)throw new bk(jI.INVALID_PARAMS,"current encrypt mode does not need salt");if(r){if(BI(r,"encryptDataStream"),!Ur(o).call(o,e))throw new bk(jI.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'\"|{}\\[\\]])(?=.{8,})").test(t)||pk.warning("The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer.\n      "),this._encryptionMode=e,this._encryptionSecret=t,n&&(this._encryptionSalt=IA(n))}async renewToken(e){if(WI(e,"token",1,2047),!this._key||!this._joinInfo)throw new bk(jI.INVALID_OPERATION,"renewToken should not be called before user join");const t=this._key;this._key=e,this._joinInfo&&(this._joinInfo.token=e);const n=await this._renewTokenMutex.lock();try{if(UN("USE_NEW_TOKEN")){pk.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const t=await AF(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||XA);pk.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:e,ticket:t})}else pk.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:e});pk.debug("[".concat(this._clientId,"] renewToken success"))}catch(e){throw this._key=t,this._joinInfo.token=t,pk.error("[".concat(this._clientId,"] renewToken failed"),e.toString()),e}finally{n()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?pk.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval((()=>{const e=this._p2pChannel.getAudioLevels();this.safeEmit(dA.VOLUME_INDICATOR,e)}),UN("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const e=this._statsCollector.getRTCStats(),t=this._gateway.getInChannelInfo();return e.Duration=Math.round(t.duration/1e3),e}async startLiveStreaming(e,t){if(!t){if("h264"!==this.codec)throw new bk(jI.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new bk(jI.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e))throw new bk(jI.LIVE_STREAMING_TASK_CONFLICT);const n=t?jx.TRANSCODE:jx.RAW;return this._createLiveStreamingClient(n).startLiveStreamingTask(e,n)}setLiveTranscoding(e){return this._createLiveStreamingClient(jx.TRANSCODE).setTranscodingConfig(e)}async stopLiveStreaming(e){const t=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter((t=>t&&t.hasUrl(e)));if(!t.length)throw new bk(jI.INVALID_PARAMS,"can not find live streaming url to stop");await ih.all(t.map((t=>t&&t.stopLiveStreamingTask(e))))}async startChannelMediaRelay(e){BF(e);const t=this._createChannelMediaRelayClient();await t.startChannelMediaRelay(e)}async updateChannelMediaRelay(e){BF(e);const t=this._createChannelMediaRelayClient();await t.updateChannelMediaRelay(e)}async stopChannelMediaRelay(){const e=this._createChannelMediaRelayClient();await e.stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendAudioMetadata(e){this._p2pChannel instanceof zB&&this._p2pChannel.addAudioMetadata(e)}async sendStreamMessage(e){var t;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this._joinInfo)throw new bk(jI.INVALID_OPERATION,"can not send data stream, not joined");if(("string"==typeof e||e instanceof Uint8Array)&&(e={payload:e}),"string"==typeof e.payload){const t=new TextEncoder;e.payload=t.encode(e.payload)}let r=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Ur(t=["aes-128-gcm2","aes-256-gcm2"]).call(t,this._encryptionMode)&&(r=!0,e.payload=await async function(e,t,n){var r;const o=so(r=Array.from(n)).call(r,((e,t)=>e+t),0),i={serverTs:0,seq:GN++,length:n.length,checkSum:o},a=new Uint8Array(HA(o,2)),s=new ArrayBuffer(10),c=new DataView(s);c.setUint32(0,i.serverTs),c.setUint16(4,i.seq),c.setUint16(6,i.length),c.setUint16(8,i.checkSum);const l=16-n.length%16;n=NA(n,new Uint8Array(l));const u=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:e,tagLength:128,additionalData:a},t,n);return NA(new Uint8Array(s),new Uint8Array(u))}(this._encryptDataStreamIv,this._encryptDataStreamKey,e.payload)),new Blob([e.payload]).size>1024)throw new bk(jI.INVALID_PARAMS,r?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(kx.DATA_STREAM,{payload:IA(e.payload),syncWithAudio:e.syncWithAudio,sendTs:Date.now()-QB},!n)}sendMetadata(e){if(!this._joinInfo)throw new bk(jI.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new bk(jI.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(kx.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:IA(e)})}async sendCustomReportMessage(e){if(Array.isArray(e)||(e=[e]),e.forEach(fk),!this._joinInfo)throw new bk(jI.INVALID_OPERATION,"can not send custom report, not joined");await _k.sendCustomReportMessage(this._joinInfo.sid,e)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(e,t){VI(t.spatialLayer,"spatialLayer",[0,1,2,3]),VI(t.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(e,t)}catch(e){throw pk.error("[".concat(this._clientId,"] pick SVC layer failed"),e.toString()),e}}async setRTMConfig(e){const{apRTM:t=!1,rtmFlag:n}=e;if(BI(t,"apRTM"),HI(n,"rtmFlag",0),this._rtmConfig.apRTM=t,this._rtmConfig.rtmFlag=n,pk.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(e)," in ").concat(this.connectionState," state")),("CONNECTED"===this.connectionState||"RECONNECTING"===this.connectionState)&&this._joinInfo)return this._joinInfo.apRTM=t,this._joinInfo.rtmFlag=n,this._gateway.setRTM2Flag(n)}_reset(){if(pk.debug("[".concat(this._clientId,"] reset client")),function(e){const t=jL.indexOf(e);-1!==t&&jL.splice(t,1)}(this._clientId),this.store.hasStartJoinChannel=!1,this.store.isABTestSuccess=!1,this._axiosCancelSource.cancel(),this._axiosCancelSource=Xw.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&bV(this._joinInfo),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId&&_k.removeSid(this._sessionId),this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach((e=>{e._audioTrack&&e._audioTrack._destroy(),e._videoTrack&&e._videoTrack._destroy(),e._dataChannels&&(e._dataChannels.forEach((e=>e._close())),e._dataChannels.length=0)})),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),"fallback"===this._cloudProxyServerMode&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new YA("client-publish",this._clientId),this._subscribeMutex=new YA("client-subscribe",this._clientId),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch(e){}if(this._moderation)try{this.setImageModeration(!1)}catch(e){}}_startSession(e,t){var n;const r=e||xA();e?pk.debug("[".concat(this._clientId,"] new Session ").concat(r)):pk.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(r));const o=e?"":this._sessionId||"";this._sessionId=r,this.store.sessionId=r,_k.addSid(r);const i={lts:(new Date).getTime(),mode:this.mode,buildFormat:1,stringUid:(null==t?void 0:t.stringUid)||(null===(n=this._joinInfo)||void 0===n?void 0:n.stringUid),channelProfile:"live"===this.mode?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:o,clientRole:"audience"===this.role?2:1};_k.sessionInit(this._sessionId,JH({cname:t.channel,appid:t.appId},i)),this._joinInfo&&(this._joinInfo.sid=r),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=r)}async _publishHighStream(e){if(!this._joinInfo||void 0===this._uid)throw new bk(jI.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new bk(jI.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if("auto"===this._turnServer.mode&&UN("FORCE_TURN")&&!UN("TURN_ENABLE_TCP")&&!UN("TURN_ENABLE_UDP"))throw new bk(jI.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");pk.debug("[".concat(this._clientId,"] publish high stream"));try{const n=await this._p2pChannel.publish(e,this._isDualStreamEnabled,this._lowStreamParameter);if(this.store.useP2P){const t=(await n.next()).value;if(t){try{await this._gateway.sendExtensionMessage(OU.PUBLISH,t,!0)}catch(e){throw n.throw(e),e}await n.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const r=(await n.next()).value;if(r){var t;let o;try{o=await this._gateway.publish(this._uid,r,!0)}catch(e){if(e.code!==jI.DISCONNECT_P2P)throw n.throw(e),e}await n.next((null===(t=o)||void 0===t?void 0:t.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const t of e)t instanceof DM&&t._encoderConfig&&this._gateway.setVideoProfile(t._encoderConfig).catch((e=>{pk.debug("[".concat(this._clientId,"] stop setVideoProfile, because websocket is closed"))})),!t.muted&&t.enabled||await this._p2pChannel.muteLocalTrack(t)}}catch(t){if(this._p2pChannel.reportPublishEvent(!1,null==t?void 0:t.code,e),(null==t?void 0:t.code)===jI.WS_ABORT)return;throw t}}async _publishLowStream(){if(!this._joinInfo||void 0===this._uid)throw new bk(jI.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new bk(jI.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));pk.debug("[".concat(this._clientId,"] publish low stream"));const e=this._configDistribute.getLowStreamConfigDistribute();e&&e.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&e.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=e.bitrate));try{const e=await this._p2pChannel.publishLowStream(this._lowStreamParameter),n=(await e.next()).value;if(n){var t;let r;try{r=await this._gateway.publish(this._uid,n,!0)}catch(t){if(t.code!==jI.DISCONNECT_P2P)throw e.throw(t),t}e.next((null===(t=r)||void 0===t?void 0:t.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(e){if(this._p2pChannel.reportPublishEvent(!1,null==e?void 0:e.code,void 0,!0),(null==e?void 0:e.code)===jI.WS_ABORT)return;throw e}}_createLiveStreamingClient(e){const t=()=>{if(!this._joinInfo||!this._appId)return new bk(jI.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const e=(t={joinInfo:this._joinInfo,appId:this._appId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig},Hj("LiveStreaming").create(t));var t;return e.onLiveStreamError=(e,t)=>{_k.reportApiInvoke(this._sessionId,{name:rA.ON_LIVE_STREAM_ERROR,options:[e,t],tag:oA.TRACER}).onSuccess(),this.safeEmit(dA.LIVE_STREAMING_ERROR,e,t)},e.onLiveStreamWarning=(e,t)=>{_k.reportApiInvoke(this._sessionId,{name:rA.ON_LIVE_STREAM_WARNING,options:[e,t],tag:oA.TRACER}).onSuccess(),this.safeEmit(dA.LIVE_STREAMING_WARNING,e,t)},e.on(Wx.REQUEST_WORKER_MANAGER_LIST,((e,t,n)=>{if(!this._joinInfo)return n(new bk(jI.INVALID_OPERATION,"can not find join info to get worker manager"));(async function(e,t,n,r){const o=UN("UAP_AP").slice(0,UN("AJAX_REQUEST_CONCURRENT")).map((e=>t.proxyServer?"https://".concat(t.proxyServer,"/ap/?url=").concat(e+"/api/v1?action=uap"):"https://".concat(e,"/api/v1?action=uap")));return await cF(o,e,t,n,r)})(e,this._joinInfo,this._axiosCancelSource.token,XA).then(t).catch(n)})),e};return e===jx.RAW?(this._liveRawStreamingClient=this._liveRawStreamingClient||t(),this._liveRawStreamingClient):(this._liveTranscodeStreamingClient=this._liveTranscodeStreamingClient||t(),this._liveTranscodeStreamingClient)}_createChannelMediaRelayClient(){if(!this._joinInfo)return new bk(jI.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:t,sendResolutionHeight:n}=this.getLocalVideoStats(),r=(e={joinInfo:this._joinInfo,clientId:this._clientId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig,resolution:{width:t,height:n}},Hj("ChannelMediaRelay").create(e));r.on("state",(e=>{e===Xx.RELAY_STATE_FAILURE&&r&&r.dispose(),this.safeEmit(dA.CHANNEL_MEDIA_RELAY_STATE,e)})),r.on("event",(e=>{this.safeEmit(dA.CHANNEL_MEDIA_RELAY_EVENT,e)})),this._channelMediaRelayClient=r,this._statsCollector.onStatsChanged=(e,t)=>{var n;"resolution"===e&&(null===(n=this._channelMediaRelayClient)||void 0===n||n.setVideoProfile(t))}}var e;return this._channelMediaRelayClient}_handleUpdateDataChannel(e,t){const{added:n,deleted:r}=e,o=[];if(t){const e=[];this._users.forEach((t=>{t._dataChannels.forEach((r=>{n.every((e=>e.uid!==t._uintid||e.stream_id!==r.id))&&e.push({uid:t._uintid,stream_id:r.id,ordered:r.ordered,max_retrans_times:r.maxRetransmits,metadata:r.metadata})}))})),e.length>0&&this._handleUpdateDataChannel({added:[],deleted:e})}Array.isArray(n)&&n.length>0&&n.forEach((e=>{const{uid:n,stream_id:r,ordered:i,max_retrans_times:a,metadata:s}=e,c=this._users.find((e=>e._uintid===n));if(c){if(pk.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(n)),Ur(o).call(o,c)||o.push(c),c._uintid||(c._uintid=n),-1===c._dataChannels.findIndex((t=>t.id===e.stream_id))){const e={id:r,ordered:!!i,maxRetransmits:a,metadata:s},n=function(e){return Gj(e,!0)}(e);c._dataChannels.push(n),pk.info("[".concat(this._clientId,"] remote user ").concat(c.uid," published datachannel")),t||this.safeEmit(dA.USER_PUBLISHED,c,"datachannel",e)}this._p2pChannel.hasPendingRemoteDataChannel(c,e.stream_id)&&(pk.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(c.uid," after reconnect.")),this._subscribeDataChannel(c,e.stream_id).catch((e=>{pk.error("[".concat(this._clientId,"] resubscribe datachannel error"),e.toString())})))}else pk.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"))})),t&&(this.safeEmit(dA.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(r)&&r.length>0&&r.forEach((e=>{const{uid:t,stream_id:n}=e,r=this._users.find((e=>e._uintid===t));if(!r)return void pk.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const o=r._dataChannels.find((t=>t.id===e.stream_id));o&&(pk.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(t)),this._p2pChannel.unsubscribeDataChannel(r,[o]).then((e=>{if(r._dataChannels=r._dataChannels.filter((e=>e!==o)),e)return this._gateway.unsubscribeDataChannel(e,r.uid)})),pk.info("[".concat(this._clientId,"] remote user ").concat(t," unpublished datachannel ,id:").concat(o.id)),this.safeEmit(dA.USER_UNPUBLISHED,r,"datachannel",o._config))}))}_handleRemoveDataChannels(e){const t=this._users.find((t=>t.uid===e.uid));if(t){if(void 0!==t._dataChannels&&t._dataChannels.length>0){pk.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(e.uid));const n=()=>{pk.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished datachannel")),t._dataChannels.forEach((e=>{this.safeEmit(dA.USER_UNPUBLISHED,t,"datachannel",e._config)}))};this._p2pChannel.unsubscribeDataChannel(t,t._dataChannels).then((e=>{if(e)return this._gateway.unsubscribeDataChannel(e,t.uid)})),n()}}else pk.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(Qx.UPDATE_GATEWAY_CONFIG,(()=>{!function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(e){return void pk.error("Error loading sdk config",e.message)}if(e)try{const t=JSON.parse(window.atob(e)),n=Date.now();Object.keys(t).forEach((e=>{const{value:r,type:o,expires:i}=t[e];i&&i<=n||o||BL()||!Object.prototype.hasOwnProperty.call(kN,e)||(FN[e]=r,LN[e]=r,pk.debug("Update gateway parameters from config distribute",e,r))}))}catch(e){pk.error("Error update config from local cache",e.message)}}()})),this._gateway.on(Qx.DISCONNECT_P2P,(async()=>{await this._p2pChannel.disconnectForReconnect()})),this._gateway.on(Qx.CONNECTION_STATE_CHANGE,((e,t,n)=>{var r;if(n===sA.FALLBACK)return;const o=()=>{this.safeEmit(dA.CONNECTION_STATE_CHANGE,e,t,n)};if(_k.reportApiInvoke(this._sessionId||(null===(r=this._gateway.joinInfo)||void 0===r?void 0:r.sid)||null,{name:rA.CONNECTION_STATE_CHANGE,options:[e,t,n],tag:oA.TRACER}).onSuccess(JSON.stringify({cur:e,prev:t,reason:n})),pk.info("[".concat(this._clientId,"] signal connection state change: ").concat(t," -> ").concat(e)),"DISCONNECTED"===e)return this._reset(),void o();if("RECONNECTING"===e)this._users.forEach((e=>{e._trust_in_room_=!1,e._trust_audio_enabled_state_=!1,e._trust_video_enabled_state_=!1,e._trust_audio_mute_state_=!1,e._trust_video_mute_state_=!1,e._trust_audio_stream_added_state_=!1,e._trust_video_stream_added_state_=!1,e._is_pre_created||(e._audio_pre_subscribed||(e._audioSSRC=void 0,e._audioOrtc=void 0),e._video_pre_subscribed||(e._videoSSRC=void 0,e._videoOrtc=void 0,e._rtxSsrcId=void 0),e._cname=void 0)})),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if("CONNECTED"===e){var i;this._streamFallbackTypeCacheMap.forEach(((e,t)=>{this._gateway.setStreamFallbackOption(t,e).catch((e=>{pk.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),e)}))})),this._remoteStreamTypeCacheMap.forEach(((e,t)=>{this._gateway.setRemoteVideoStreamType(t,e).catch((e=>{pk.warning("[".concat(this._clientId,"] auto set remote stream type failed"),e)}))})),void 0!==this._remoteDefaultVideoStreamType&&void 0===(null===(i=this._joinInfo)||void 0===i?void 0:i.defaultVideoStream)&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then((()=>{pk.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))})).catch((e=>{pk.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(e))})),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout((()=>{"CONNECTED"===this.connectionState&&(this._userOfflineTimeout=void 0,this._users.filter((e=>!e._trust_in_room_)).forEach((e=>{pk.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(e.uid)),this._handleUserOffline({uid:e.uid})})))}),3e3),this._streamRemovedTimeout=window.setTimeout((()=>{"CONNECTED"===this.connectionState&&(this._streamRemovedTimeout=void 0,this._users.forEach((e=>{e._trust_audio_mute_state_||(pk.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(e.uid)),this._handleMuteStream(e.uid,lU.AUDIO,!1)),e._trust_video_mute_state_||(pk.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(e.uid)),this._handleMuteStream(e.uid,lU.VIDEO,!1)),e._trust_audio_enabled_state_||(pk.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(e.uid)),this._handleSetStreamLocalEnable("audio",e.uid,!0)),e._trust_video_enabled_state_||(pk.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(e.uid)),this._handleSetStreamLocalEnable("video",e.uid,!0)),e._trust_video_stream_added_state_||(pk.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(e.uid)),this._handleResetAddStream(e,"video")),e._trust_audio_stream_added_state_||(pk.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(e.uid)),this._handleResetAddStream(e,"audio")),e._video_added_||e._audio_added_||(pk.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(e.uid)),this._handleRemoveStream({uid:e.uid,uint_id:e._uintid}))})))}),1e3))}o()})),this._gateway.on(Qx.REQUEST_NEW_GATEWAY_LIST,(async(e,t)=>{if(!this._joinInfo)return t(new bk(jI.UNEXPECTED_ERROR,"can not recover, no join info"));try{let t;const n=await EV(JH(JH({},this._joinInfo),{},{uid:this._joinInfo.uid,stringUid:void 0}));n?(t=n.ap,TV(n),this._joinInfo.preload=!0):(t=await bF(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||XA,this.store),this._joinInfo.preload=!1),this._joinInfo&&(this._joinInfo.apResponse=t.gatewayInfo.res,this._joinInfo.gatewayAddrs=t.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=t.gatewayInfo.uni_lbs_ip);const r=[];t.gatewayInfo.gatewayAddrs.forEach((e=>{let{address:t}=e;const[n,o]=t.split(":");this._joinInfo&&this._joinInfo.proxyServer?r.push({proxy:this._joinInfo.proxyServer,host:n,port:o}):r.push({host:n,port:o})})),e(r)}catch(e){t(e)}})),this._gateway.on(Qx.NETWORK_QUALITY,(e=>{"normal"===this._networkQualitySensitivity&&this.safeEmit(dA.NETWORK_QUALITY,e)})),this._gateway.on(Qx.STREAM_TYPE_CHANGE,((e,t)=>{this.safeEmit(dA.STREAM_TYPE_CHANGED,e,t),_k.reportApiInvoke(this._sessionId,{name:rA.STREAM_TYPE_CHANGE,options:[e,t],tag:oA.TRACER}).onSuccess(JSON.stringify({uid:e,streamType:t}))})),this._gateway.on(Qx.IS_P2P_DISCONNECTED,(e=>{this._p2pChannel.isP2PDisconnected()?e(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?e(!1):e(!0)})),this._gateway.on(Qx.REQUEST_P2P_CONNECTION_PARAMS,(async(e,t,n)=>{try{let n=await this._p2pChannel.getEstablishParams();UN("ENABLE_PREALLOC_PC")&&n||(n=await this._p2pChannel.startP2PConnection(e)),t(n)}catch(e){n(e)}})),this._gateway.on(Qx.JOIN_RESPONSE,((e,t)=>{if(this.store.useP2P)return;let n;e.attributes?n=e.attributes.userAttributes.preSubSsrcs:pk.debug("no attributes in joinResponse");const r=vj(e.ortc,t,n);this._p2pChannel.connect(r)})),this._gateway.on(Qx.PRE_CONNECT_PC,(async e=>{const{candidates:t,fingerprint:n}=e;if(this._joinInfo&&t.length>0&&!this._p2pChannel.isPlanB){var r;await this._p2pChannel.startP2PConnection({turnServer:this._joinInfo.turnServer});const{cert:e,cid:o}=this._joinInfo.apResponse;await this._p2pChannel.connect({iceParameters:{iceUfrag:"".concat(o,"_").concat(e),icePwd:"".concat(o,"_").concat(e)},dtlsParameters:{fingerprints:[{hashFunction:"sha-256",fingerprint:null!==(r=UN("FINGERPRINT"))&&void 0!==r?r:n}]},candidates:t,rtpCapabilities:{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},setup:"active",cname:"o/i14u9pJrxRKAsu",preallocation:!0})}}))}_handleGatewaySignalEvents(){this._gateway.signal.on(Dx.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(Dx.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(Dx.ON_ADD_AUDIO_STREAM,(e=>this._handleAddAudioOrVideoStream("audio",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc))),this._gateway.signal.on(Dx.ON_ADD_VIDEO_STREAM,(e=>this._handleAddAudioOrVideoStream("video",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc,e.rtxSsrcId))),this._gateway.signal.on(Dx.ON_REMOTE_DATASTREAM_UPDATE,(e=>{this._handleUpdateDataChannel(e)})),this._gateway.signal.on(Dx.ON_REMOTE_FULL_DATASTREAM_INFO,(e=>{this._handleUpdateDataChannel({added:e.datastreams||[],deleted:[]},!0)})),this._gateway.signal.on(Dx.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(Dx.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(Dx.MUTE_AUDIO,(e=>this._handleMuteStream(e.uid,lU.AUDIO,!0))),this._gateway.signal.on(Dx.UNMUTE_AUDIO,(e=>this._handleMuteStream(e.uid,lU.AUDIO,!1))),this._gateway.signal.on(Dx.MUTE_VIDEO,(e=>this._handleMuteStream(e.uid,lU.VIDEO,!0))),this._gateway.signal.on(Dx.UNMUTE_VIDEO,(e=>this._handleMuteStream(e.uid,lU.VIDEO,!1))),this._gateway.signal.on(Dx.RECEIVE_METADATA,(e=>{const t=wA(e.metadata);this.safeEmit(dA.RECEIVE_METADATA,e.uid,t)})),this._gateway.signal.on(Dx.ON_DATA_STREAM,(async e=>{var t;if(!e)return;let n=wA(e.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Ur(t=["aes-128-gcm2","aes-256-gcm2"]).call(t,this._encryptionMode)){if(e.payload.length<10)throw new bk(jI.UNEXPECTED_RESPONSE,"payload length ".concat(e.payload.length," is less than header length ").concat(10));const t=await async function(e,t,n){const r=n.subarray(0,10),o=r.slice(8,10),i=(o[0]<<8)+o[1],a=(r[6]<<8)+r[7],s=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:e,tagLength:128,additionalData:new Uint8Array(HA(i,2))},t,n.subarray(10));return new Uint8Array(s).subarray(0,a)}(this._encryptDataStreamIv,this._encryptDataStreamKey,n);n=t}let r=0;if(e.ordered||e.syncWithAudio){const t=this._p2pChannel.getStats(),n=this.remoteUsers.find((t=>t.uid===e.uid)),o=null==t?void 0:t.audioRecv.find((e=>e.ssrc===(null==n?void 0:n._audioSSRC)));r=null==o?void 0:o.jitterBufferMs}(null==r||Number.isNaN(r))&&(r=0),rV(JH(JH({},e),{},{payload:n}),r,{id:this._clientId,onStreamMessage:"function"==typeof this.onStreamMessage?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})})),this._gateway.signal.on(Dx.ON_CRYPT_ERROR,(()=>{CA((()=>{pk.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(dA.CRYPT_ERROR)}),this._sessionId)})),this._gateway.signal.on(Dx.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(Dx.ON_TOKEN_PRIVILEGE_DID_EXPIRE,(()=>{pk.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,sA.TOKEN_EXPIRE),this.safeEmit(dA.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()})),this._gateway.signal.on(Dx.ON_STREAM_FALLBACK_UPDATE,(e=>{pk.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(e.stream_id,", attr: ").concat(e.stream_type)),this.safeEmit(dA.STREAM_FALLBACK,e.stream_id,1===e.stream_type?"fallback":"recover")})),this._gateway.signal.on(Dx.ON_PUBLISH_STREAM,(e=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:e.proxy})),pk.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(e))))})),this._gateway.signal.on(Dx.ENABLE_LOCAL_VIDEO,(e=>{this._handleSetStreamLocalEnable("video",e.uid,!0)})),this._gateway.signal.on(Dx.DISABLE_LOCAL_VIDEO,(e=>{this._handleSetStreamLocalEnable("video",e.uid,!1)})),this._gateway.signal.on(Nx.REQUEST_TIMEOUT,((e,t)=>{if(this._joinInfo)switch(e){case kx.PUBLISH:{if(!t)return;const e=t.ortc;if(e){var n,r;const o=e.some((e=>{let{stream_type:t}=e;return t===Zx.Audio})),i=e.some((e=>{let{stream_type:t}=e;return t!==Zx.Audio})),a=e.some((e=>{let{stream_type:t}=e;return t===Zx.Screen||t===Zx.ScreenLow}));"offer"===t.state&&_k.publish(this._joinInfo.sid,{eventElapse:LF.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:jI.TIMEOUT,audio:o,video:i,p2pid:t.p2p_id,publishRequestid:this.store.pubId,screenshare:a,audioName:o?null===(n=e.find((e=>{let{stream_type:t}=e;return t===Zx.Audio})))||void 0===n||null===(n=n.ssrcs[0])||void 0===n?void 0:n.ssrcId.toString():void 0,videoName:i?null===(r=e.find((e=>{let{stream_type:t}=e;return t!==Zx.Audio})))||void 0===r||null===(r=r.ssrcs[0])||void 0===r?void 0:r.ssrcId.toString():void 0})}break}case kx.SUBSCRIBE:t&&_k.subscribe(this._joinInfo.sid,{succ:!1,ec:jI.TIMEOUT,audio:t.stream_type===lU.AUDIO,video:t.stream_type===lU.VIDEO,peerid:t.stream_id,subscribeRequestid:t.ssrcId,p2pid:this.store.p2pId,eventElapse:LF.measureFromSubscribeStart(this.store.clientId,t.ssrcId),preSsrc:this._p2pChannel.isPreSubScribe(t.ssrcId)})}})),this._gateway.signal.on(Dx.ON_P2P_OK,(e=>{this.uid,this._uid})),this._gateway.signal.on(Dx.ON_PUBLISHED_USER_LIST,(e=>{if(null==e||!e.users)return;UN("BLOCK_LOCAL_CLIENT")&&(e.users=e.users.filter((e=>!FL(e.string_id||e.stream_id,this.channelName))));const t=[],n=[];for(const r of e.users){let e=this._users.find((e=>e._uintid===r.stream_id));e?e._trust_in_room_=!0:(e=new VF(r.string_id||r.stream_id,r.stream_id),this._users.push(e),0===this.getListeners(dA.PUBLISHED_USER_LIST).length&&(pk.debug("[".concat(this._clientId,"] user online"),r.stream_id),this.safeEmit(dA.USER_JOINED,e)));const o=eU.Audio&r.stream_type,i=(eU.Video|eU.LwoVideo)&r.stream_type,a=!!(65280&r.stream_type),s=o&&e.hasAudio,c=i&&e.hasVideo;i&&(e._trust_video_stream_added_state_=!0,e._video_added_=!0,e._videoSSRC=r.video_ssrc,e._rtxSsrcId=r.video_rtx),o&&(e._trust_audio_stream_added_state_=!0,e._audio_added_=!0,e._audioSSRC=r.audio_ssrc),o&&!s&&0===this.getListeners(dA.PUBLISHED_USER_LIST).length&&(pk.info("[".concat(this._clientId,"] remote user ").concat(e.uid," published audio")),this.safeEmit(dA.USER_PUBLISHED,e,"audio")),i&&!c&&0===this.getListeners(dA.PUBLISHED_USER_LIST).length&&(pk.info("[".concat(this._clientId,"] remote user ").concat(e.uid," published video")),this.safeEmit(dA.USER_PUBLISHED,e,"video")),(o&&!s||i&&!c||a)&&t.push(e),i&&this._p2pChannel.hasPendingRemoteMedia(e,"video")&&n.push({user:e,mediaType:"video"}),o&&this._p2pChannel.hasPendingRemoteMedia(e,"audio")&&n.push({user:e,mediaType:"audio"})}n.length>0&&(pk.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(n.map((e=>"user: ".concat(e.user.uid,", mediaType: ").concat(e.mediaType))).join("; ")," ")),this.massSubscribe(n).catch((e=>{pk.error("[".concat(this._clientId,"] mass resubscribe error"),e.toString())}))),this.getListeners(dA.PUBLISHED_USER_LIST).length>0?UN("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=t:(pk.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(t.map((e=>e.uid)).join(", "))),this.safeEmit(dA.PUBLISHED_USER_LIST,t)):pk.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(t.map((e=>e.uid)).join(", ")))})),this._gateway.signal.on(Dx.ON_RTP_CAPABILITY_CHANGE,(e=>{const{video_codec:t}=e;this._p2pChannel instanceof zB&&this._p2pChannel.updateRemoteRTPCapabilities(t.map((e=>e.toLowerCase())).filter((e=>{var t;return Ur(t=Object.keys(HN)).call(t,e)})))}))}_handleP2PEvents(){this._gateway.signal.on(Dx.ON_USER_OFFLINE,(()=>{this._p2pChannel.disconnectForReconnect()})),this._gateway.signal.on(OU.PUBLISH,((e,t,n)=>{const{uid:r}=e;e.forEach((e=>{const{kind:o,ssrcs:i,mid:a,isMuted:s}=e;this._handleP2PAddAudioOrVideoStream(o,r,i[0].ssrcId,a);const c=this._users.find((e=>e.uid===r));return c&&this.store.useP2P?this._p2pChannel.mockSubscribe(c,o,i[0].ssrcId,a).then((()=>{t()})).catch(n):t(),this._handleMuteStream(r,o,!!s)}))})),this._gateway.signal.on(OU.CALL,(async(e,t,n)=>{if(this.store.useP2P)try{var r;t(await this._p2pChannel.startP2P({turnServer:null===(r=this._joinInfo)||void 0===r?void 0:r.turnServer},e))}catch(e){n(e)}})),this._gateway.signal.on(Nx.P2P_CONNECTION,(async e=>{this.store.useP2P&&(await this._p2pChannel).p2pConnect(e)})),this._gateway.signal.on(OU.UNPUBLISH,(async(e,t,n)=>{if(this.store.useP2P){const{unpubMsg:r,uid:o}=e,i=this._users.find((e=>e.uid===o));if(!i)return pk.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(o)),void t();try{r.forEach((async e=>{let{stream_type:t}=e;const n=t===Zx.Audio?lU.AUDIO:lU.VIDEO;await this._p2pChannel.unsubscribe(i,n),this._handleMuteStream(o,n,!0)})),t()}catch(e){n(e)}}})),this._gateway.signal.on(OU.CONTROL,(async(e,t)=>{const{action:n}=e;switch(n){case CU.MUTE_LOCAL_VIDEO:this._handleMuteStream(t,lU.VIDEO,!0);break;case CU.MUTE_LOCAL_AUDIO:this._handleMuteStream(t,lU.AUDIO,!0);break;case CU.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",t),this._handleMuteStream(t,lU.VIDEO,!1);break;case CU.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",t),this._handleMuteStream(t,lU.AUDIO,!1)}})),this._gateway.signal.on(OU.RESTART_ICE,(async(e,t,n)=>{if(this.store.useP2P)try{const{direction:n,iceParameter:r}=e;n!==Mx.SEND_ONLY||r?t(await this._p2pChannel.restartICE(n,r)):(this._p2pChannel.handleDisconnect(n),t())}catch(e){n(e)}})),this._gateway.signal.on(OU.CANDIDATE,(e=>{if(this.store.useP2P){const{candidate:t,direction:n}=e;this._p2pChannel.addRemoteCandidate(t,n)}})),this._p2pChannel.on(mU.RequestP2PRestartICE,(async(e,t,n)=>{try{const{direction:n}=e;t(await this._gateway.sendExtensionMessage(OU.RESTART_ICE,e,n===Mx.SEND_ONLY))}catch(e){n(e)}})),this._p2pChannel.on(mU.LocalCandidate,(e=>{this._gateway.sendExtensionMessage(OU.CANDIDATE,JSON.stringify(e),!0)})),this._p2pChannel.on(mU.RequestP2PMuteLocal,(async(e,t,n)=>{try{await this._gateway.sendExtensionMessage(OU.CONTROL,e,!0),t()}catch(e){n(e)}})),this._p2pChannel.on(mU.RequestP2PUnmuteRemote,(async(e,t,n)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===jI.DISCONNECT_P2P?t():n(e)}else t()})),this._p2pChannel.on(mU.RequestP2PMuteRemote,(async(e,t,n)=>{if(this._joinInfo)try{await this._gateway.muteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===jI.DISCONNECT_P2P?t():n(e)}else t()})),this._p2pChannel.on(mU.StateChange,((e,t)=>{t===fU.Connected&&this._p2pChannel.republish()}))}_handleP2PChannelEvents(){this._p2pChannel.on(mU.PeerConnectionStateChange,(e=>{const t=this._peerConnectionState;e!==t&&(this.safeEmit(dA.PEERCONNECTION_STATE_CHANGE,e,t),this._peerConnectionState=e)})),this._p2pChannel.on(mU.RequestMuteLocal,(async(e,t,n)=>{if(this._joinInfo)try{await this._gateway.muteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===jI.DISCONNECT_P2P?t():n(e)}else t()})),this._p2pChannel.on(mU.RequestUnmuteLocal,(async(e,t,n)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===jI.DISCONNECT_P2P?t():n(e)}else t()})),this._p2pChannel.on(mU.RequestRePublish,((e,t,n)=>{this.publish(e,!1).then(t).catch(n)})),this._p2pChannel.on(mU.RequestRePublishDataChannel,((e,t,n)=>{ih.all(e.map((async e=>{const t=await this._p2pChannel.publishDataChannel([e]);try{t.forEach((e=>{this._uid&&this._gateway.publishDataChannel(this._uid,e,!0)}))}catch(e){if(e.code!==jI.DISCONNECT_P2P)throw e}}))).then(t).catch(n)})),this._p2pChannel.on(mU.RequestReSubscribe,(async(e,t,n)=>{try{for(const{user:t,kind:n}of e)n===lU.VIDEO?await this.subscribe(t,"video"):await this.subscribe(t,"audio");t()}catch(e){n(e)}})),this._p2pChannel.on(mU.RequestUpload,((e,t)=>{this._gateway.upload(e,t)})),this._p2pChannel.on(mU.RequestUploadStats,(e=>{this._gateway.uploadWRTCStats(e)})),this._p2pChannel.on(mU.MediaReconnectStart,(e=>{this.safeEmit(dA.MEDIA_RECONNECT_START,e)})),this._p2pChannel.on(mU.MediaReconnectEnd,(e=>{this.safeEmit(dA.MEDIA_RECONNECT_END,e)})),this._p2pChannel.on(mU.NeedSignalRTT,(e=>{e(this._gateway.getSignalRTT())})),this._p2pChannel.on(mU.RequestRestartICE,(async e=>{if(this.store.useP2P)return;const t=await this._p2pChannel.restartICE(e),n=await t.next();if(n.done)return;const r=n.value;let o;try{o=await this._gateway.restartICE({iceParameters:r})}catch(e){return void t.throw(e)}const{iceParameters:i}=function(e){const t=e.iceParameters;return{iceParameters:{iceUfrag:t.iceUfrag,icePwd:t.icePwd}}}(o);await t.next({remoteIceParameters:i})})),this._p2pChannel.on(mU.RequestReconnect,(async()=>{this._gateway.reconnect()})),this._p2pChannel.on(mU.RequestReconnectPC,(async()=>{var e;const{iceParameters:t,dtlsParameters:n,rtpCapabilities:r}=await this._p2pChannel.startP2PConnection({turnServer:null===(e=this._joinInfo)||void 0===e?void 0:e.turnServer}),{gatewayEstablishParams:o,gatewayAddress:i}=await this._gateway.reconnectPC({iceParameters:t,dtlsParameters:n,rtpCapabilities:r}),a=vj(o,i);await this._p2pChannel.connect(a),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()})),this._p2pChannel.on(mU.RequestUnpublishForReconnectPC,(async(e,t,n)=>{this._joinInfo&&void 0!==this._uid?(await this._gateway.unpublish(e,this._uid),t()):n()})),this._p2pChannel.on(mU.P2PLost,(()=>{this.safeEmit(dA.P2P_LOST,this.store.uid)})),this._p2pChannel.on(mU.UpdateVideoEncoder,(e=>{e._encoderConfig&&this._gateway.setVideoProfile(e._encoderConfig)})),this._p2pChannel.on(mU.ConnectionTypeChange,(e=>{this.safeEmit(dA.IS_USING_CLOUD_PROXY,e)})),this._p2pChannel.on(mU.RequestLowStreamParameter,(e=>{e(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})})),this._p2pChannel.on(mU.QueryClientConnectionState,(e=>{e(this.connectionState)})),this._p2pChannel.on(mU.AudioMetadata,(e=>{this.safeEmit(dA.AUDIO_METADATA,e)}))}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(e){if(!this._joinInfo||"CONNECTED"!==this.connectionState)throw new bk(jI.INVALID_OPERATION,"[".concat(this._clientId,"] can not create content inspect, please join channel first"));if(this._inspect)throw new bk(jI.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));try{const n=(t={config:e},Hj("ContentInspect").create(t));this._inspect=n,this.handleVideoInspectEvents(n);const{appId:r,cname:o,sid:i,token:a,uid:s,cid:c,vid:l}=this._joinInfo;await n.init({appId:r,areaCode:"",cname:o,sid:i,token:a,uid:s,cid:c,vid:l?Number(l):0},XA)}catch(e){throw Array.isArray(e)?e[0]:e}var t}handleVideoInspectEvents(e){e.on(EU.CONNECTION_STATE_CHANGE,((t,n)=>{if(this.safeEmit(dA.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,t,n),n===vU.CONNECTED){if("CONNECTED"!==this.connectionState)return void this.safeEmit(dA.CONTENT_INSPECT_ERROR,new bk(jI.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));e.inspectImage()}})),e.on(EU.INSPECT_RESULT,((e,t)=>{var n;if((null==t?void 0:t.code)===jI.INVALID_OPERATION&&"DISCONNECTED"===this.connectionState)return pk.debug("Stop inspect content because that has left channel"),null==this||null===(n=this._inspect)||void 0===n||n.close(),void(this._inspect=void 0);this.safeEmit(dA.CONTENT_INSPECT_RESULT,e,t)})),e.on(EU.CLIENT_LOCAL_VIDEO_TRACK,(e=>{e(this.localTracks.filter((e=>"video"===e.trackMediaType))[0])}))}async disableContentInspect(){if(!this._inspect)throw new bk(jI.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(e){throw Array.isArray(e)?e[0]:e}}async setImageModeration(e,t){if(BI(e,"enabled"),e){if(!t)throw new bk(jI.INVALID_PARAMS,"config is required");if(iH(t),!this._joinInfo)throw new bk(jI.INVALID_OPERATION,"can not create image moderation, please join channel first");try{if(this._moderation)this._moderation.updateConfig(t);else{const e=(n={config:t},Hj("ImageModeration").create(n));this._moderation=e,this.handleImageModerationEvents(e);const{appId:r,cname:o,sid:i,token:a,uid:s,cid:c,vid:l}=this._joinInfo;await e.init({appId:r,areaCode:"",cname:o,sid:i,token:a,uid:s,cid:c,vid:l?Number(l):0},XA)}}catch(e){throw Array.isArray(e)?e[0]:e}}else{var n;if(!this._moderation)throw new bk(jI.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(e){throw Array.isArray(e)?e[0]:e}}}handleImageModerationEvents(e){e.on(TU.CONNECTION_STATE_CHANGE,((t,n)=>{if(this.safeEmit(dA.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,t,n),t===bU.CONNECTED){if("CONNECTED"!==this.connectionState)throw this.setImageModeration(!1),new bk(jI.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");e.inspectImage()}})),e.on(TU.CLIENT_LOCAL_VIDEO_TRACK,(e=>{e(this.localTracks.filter((e=>"video"===e.trackMediaType))[0])}))}setP2PTransport(e){if(function(e){VI(e,"transport",["default","auto","relay","sd-rtn"])}(e),"p2p"!==this.mode)throw new bk(jI.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=e,pk.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(e))}getJoinChannelServiceRecords(){return pk.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(e){BI(e,"enabled"),xN("ENABLE_PUBLISH_AUDIO_FILTER",e),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(e)}_handleResetAddStream(e,t){switch(t){case"audio":e._audio_added_=!1,e._trust_audio_stream_added_state_=!0;break;case"video":e._video_added_=!1,e._trust_video_stream_added_state_=!0}}},Sx(zH.prototype,"leave",[sH],Object.getOwnPropertyDescriptor(zH.prototype,"leave"),zH.prototype),Sx(zH.prototype,"publish",[cH],Object.getOwnPropertyDescriptor(zH.prototype,"publish"),zH.prototype),Sx(zH.prototype,"unpublish",[lH],Object.getOwnPropertyDescriptor(zH.prototype,"unpublish"),zH.prototype),Sx(zH.prototype,"subscribe",[uH],Object.getOwnPropertyDescriptor(zH.prototype,"subscribe"),zH.prototype),Sx(zH.prototype,"presubscribe",[dH],Object.getOwnPropertyDescriptor(zH.prototype,"presubscribe"),zH.prototype),Sx(zH.prototype,"massSubscribe",[pH],Object.getOwnPropertyDescriptor(zH.prototype,"massSubscribe"),zH.prototype),Sx(zH.prototype,"unsubscribe",[hH],Object.getOwnPropertyDescriptor(zH.prototype,"unsubscribe"),zH.prototype),Sx(zH.prototype,"massUnsubscribe",[fH],Object.getOwnPropertyDescriptor(zH.prototype,"massUnsubscribe"),zH.prototype),Sx(zH.prototype,"setLowStreamParameter",[mH],Object.getOwnPropertyDescriptor(zH.prototype,"setLowStreamParameter"),zH.prototype),Sx(zH.prototype,"enableDualStream",[vH],Object.getOwnPropertyDescriptor(zH.prototype,"enableDualStream"),zH.prototype),Sx(zH.prototype,"disableDualStream",[gH],Object.getOwnPropertyDescriptor(zH.prototype,"disableDualStream"),zH.prototype),Sx(zH.prototype,"setClientRole",[EH],Object.getOwnPropertyDescriptor(zH.prototype,"setClientRole"),zH.prototype),Sx(zH.prototype,"_setClientRoleOptions",[yH],Object.getOwnPropertyDescriptor(zH.prototype,"_setClientRoleOptions"),zH.prototype),Sx(zH.prototype,"setProxyServer",[_H],Object.getOwnPropertyDescriptor(zH.prototype,"setProxyServer"),zH.prototype),Sx(zH.prototype,"setTurnServer",[bH],Object.getOwnPropertyDescriptor(zH.prototype,"setTurnServer"),zH.prototype),Sx(zH.prototype,"setLicense",[TH],Object.getOwnPropertyDescriptor(zH.prototype,"setLicense"),zH.prototype),Sx(zH.prototype,"startProxyServer",[SH],Object.getOwnPropertyDescriptor(zH.prototype,"startProxyServer"),zH.prototype),Sx(zH.prototype,"stopProxyServer",[OH],Object.getOwnPropertyDescriptor(zH.prototype,"stopProxyServer"),zH.prototype),Sx(zH.prototype,"setLocalAccessPointsV2",[RH],Object.getOwnPropertyDescriptor(zH.prototype,"setLocalAccessPointsV2"),zH.prototype),Sx(zH.prototype,"setLocalAccessPoints",[CH],Object.getOwnPropertyDescriptor(zH.prototype,"setLocalAccessPoints"),zH.prototype),Sx(zH.prototype,"setRemoteDefaultVideoStreamType",[wH],Object.getOwnPropertyDescriptor(zH.prototype,"setRemoteDefaultVideoStreamType"),zH.prototype),Sx(zH.prototype,"setRemoteVideoStreamType",[IH],Object.getOwnPropertyDescriptor(zH.prototype,"setRemoteVideoStreamType"),zH.prototype),Sx(zH.prototype,"setStreamFallbackOption",[AH],Object.getOwnPropertyDescriptor(zH.prototype,"setStreamFallbackOption"),zH.prototype),Sx(zH.prototype,"setEncryptionConfig",[NH],Object.getOwnPropertyDescriptor(zH.prototype,"setEncryptionConfig"),zH.prototype),Sx(zH.prototype,"renewToken",[kH],Object.getOwnPropertyDescriptor(zH.prototype,"renewToken"),zH.prototype),Sx(zH.prototype,"enableAudioVolumeIndicator",[PH],Object.getOwnPropertyDescriptor(zH.prototype,"enableAudioVolumeIndicator"),zH.prototype),Sx(zH.prototype,"startLiveStreaming",[DH],Object.getOwnPropertyDescriptor(zH.prototype,"startLiveStreaming"),zH.prototype),Sx(zH.prototype,"setLiveTranscoding",[MH],Object.getOwnPropertyDescriptor(zH.prototype,"setLiveTranscoding"),zH.prototype),Sx(zH.prototype,"stopLiveStreaming",[LH],Object.getOwnPropertyDescriptor(zH.prototype,"stopLiveStreaming"),zH.prototype),Sx(zH.prototype,"startChannelMediaRelay",[xH],Object.getOwnPropertyDescriptor(zH.prototype,"startChannelMediaRelay"),zH.prototype),Sx(zH.prototype,"updateChannelMediaRelay",[UH],Object.getOwnPropertyDescriptor(zH.prototype,"updateChannelMediaRelay"),zH.prototype),Sx(zH.prototype,"stopChannelMediaRelay",[jH],Object.getOwnPropertyDescriptor(zH.prototype,"stopChannelMediaRelay"),zH.prototype),Sx(zH.prototype,"sendCustomReportMessage",[FH],Object.getOwnPropertyDescriptor(zH.prototype,"sendCustomReportMessage"),zH.prototype),Sx(zH.prototype,"pickSVCLayer",[BH],Object.getOwnPropertyDescriptor(zH.prototype,"pickSVCLayer"),zH.prototype),Sx(zH.prototype,"setRTMConfig",[VH],Object.getOwnPropertyDescriptor(zH.prototype,"setRTMConfig"),zH.prototype),Sx(zH.prototype,"enableContentInspect",[HH],Object.getOwnPropertyDescriptor(zH.prototype,"enableContentInspect"),zH.prototype),Sx(zH.prototype,"disableContentInspect",[GH],Object.getOwnPropertyDescriptor(zH.prototype,"disableContentInspect"),zH.prototype),Sx(zH.prototype,"setImageModeration",[WH],Object.getOwnPropertyDescriptor(zH.prototype,"setImageModeration"),zH.prototype),Sx(zH.prototype,"setP2PTransport",[qH],Object.getOwnPropertyDescriptor(zH.prototype,"setP2PTransport"),zH.prototype),Sx(zH.prototype,"getJoinChannelServiceRecords",[KH],Object.getOwnPropertyDescriptor(zH.prototype,"getJoinChannelServiceRecords"),zH.prototype),Sx(zH.prototype,"setPublishAudioFilterEnabled",[YH],Object.getOwnPropertyDescriptor(zH.prototype,"setPublishAudioFilterEnabled"),zH.prototype),zH);class QH{constructor(e,t){OR(this,"id",0),OR(this,"element",void 0),OR(this,"peerPair",void 0),OR(this,"context",void 0),OR(this,"audioPlayerElement",void 0),OR(this,"audioTrack",void 0),QH.count+=1,this.id=QH.count,this.element=e,this.context=t}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=e=>{const t=document.createElement("audio");t.srcObject=new MediaStream([e.track]),t.play(),this.audioPlayerElement=t}}async switchSdp(){if(!this.peerPair)return;const e=async(e,t)=>{const n="offer"===t?await e.createOffer():await e.createAnswer();return await e.setLocalDescription(n),"complete"===e.iceGatheringState?e.localDescription:new ih((t=>{e.onicegatheringstatechange=()=>{"complete"===e.iceGatheringState&&t(e.localDescription)}}))},t=async(e,t)=>await e.setRemoteDescription(t);try{const n=await e(this.peerPair[0],"offer");await t(this.peerPair[1],n);const r=await e(this.peerPair[1],"answer");await t(this.peerPair[0],r)}catch(e){throw new bk(jI.LOCAL_AEC_ERROR,e.toString()).print()}}async getTracksFromMediaElement(e){if(this.audioTrack)return this.audioTrack;let t;try{e instanceof HTMLVideoElement&&(e.captureStream?e.captureStream():e.mozCaptureStream()),t=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(e).connect(t)}catch(e){throw new bk(jI.LOCAL_AEC_ERROR,e.toString()).print()}if(!t)throw new bk(jI.LOCAL_AEC_ERROR,"no dest node when local aec").print();const n=t.stream.getAudioTracks()[0];return this.audioTrack=n,n}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const e=this.element,t=await this.getTracksFromMediaElement(e);this.peerPair&&this.peerPair[0].addTrack(t),await this.switchSdp()}close(){pk.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach((e=>{e.close()})),this.peerPair=void 0,this.audioPlayerElement=void 0}}var $H,eG;OR(QH,"count",0);const tG=window.AudioContext||window.webkitAudioContext,nG=new($H=yk({report:_k}),Sx((eG=class{constructor(){OR(this,"units",[]),OR(this,"context",void 0)}processExternalMediaAEC(e){if(!this._doesEnvironmentNeedAEC())return pk.debug("the system does not need to process local aec"),-1;this.context||(this.context=new tG);let t=this.units.find((t=>t&&t.getElement()===e));return t||(t=new QH(e,this.context),this.units.push(t)),t.startEchoCancellation(),pk.debug("start processing local audio echo cancellation, id is",t.id),t.id}_doesEnvironmentNeedAEC(){return aI().name!==nI.SAFARI}}).prototype,"processExternalMediaAEC",[$H],Object.getOwnPropertyDescriptor(eG.prototype,"processExternalMediaAEC"),eG.prototype),eG);function rG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oG(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rG(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rG(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const iG=window||document;function aG(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!iG)return;const n=Tz._cspEventHandlerPointer;if(n&&t)return void console.error(n,t);const r=e=>{if(!(e&&e.blockedURI&&(Tz.onSecurityPolicyViolation||Tz.getListeners(_U.SECURITY_POLICY_VIOLATION).length>0)))return;const t=e.blockedURI;UN("CSP_DETECTED_HOSTNAME_LIST").some((e=>Ur(t).call(t,e)))&&(Tz.onSecurityPolicyViolation&&"function"==typeof Tz.onSecurityPolicyViolation&&Tz.onSecurityPolicyViolation(e),Tz.getListeners(_U.SECURITY_POLICY_VIOLATION).length>0&&Tz.safeEmit(_U.SECURITY_POLICY_VIOLATION,e))};n&&iG.removeEventListener("securitypolicyviolation",n),(t||e&&"function"==typeof e||Tz.getListeners(_U.SECURITY_POLICY_VIOLATION).length>0)&&iG.addEventListener("securitypolicyviolation",r),Tz._cspEventHandlerPointer=r}var sG=h,cG=VR,lG=RegExp.prototype,uG=function(e){return e===lG||sG(lG,e)?cG(e):e.flags},dG=i(uG);function pG(e){let t=e.length;for(;--t>=0;)e[t]=0}const hG=256,fG=286,mG=30,vG=15,gG=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),EG=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),yG=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),_G=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),bG=new Array(576);pG(bG);const TG=new Array(60);pG(TG);const SG=new Array(512);pG(SG);const OG=new Array(256);pG(OG);const RG=new Array(29);pG(RG);const CG=new Array(mG);function wG(e,t,n,r,o){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=o,this.has_stree=e&&e.length}let IG,AG,NG;function kG(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}pG(CG);const PG=e=>e<256?SG[e]:SG[256+(e>>>7)],DG=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},MG=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,DG(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},LG=(e,t,n)=>{MG(e,n[2*t],n[2*t+1])},xG=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},UG=(e,t,n)=>{const r=new Array(16);let o,i,a=0;for(o=1;o<=vG;o++)a=a+n[o-1]<<1,r[o]=a;for(i=0;i<=t;i++){let t=e[2*i+1];0!==t&&(e[2*i]=xG(r[t]++,t))}},jG=e=>{let t;for(t=0;t<fG;t++)e.dyn_ltree[2*t]=0;for(t=0;t<mG;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},FG=e=>{e.bi_valid>8?DG(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},BG=(e,t,n,r)=>{const o=2*t,i=2*n;return e[o]<e[i]||e[o]===e[i]&&r[t]<=r[n]},VG=(e,t,n)=>{const r=e.heap[n];let o=n<<1;for(;o<=e.heap_len&&(o<e.heap_len&&BG(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!BG(t,r,e.heap[o],e.depth));)e.heap[n]=e.heap[o],n=o,o<<=1;e.heap[n]=r},HG=(e,t,n)=>{let r,o,i,a,s=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+s++],r+=(255&e.pending_buf[e.sym_buf+s++])<<8,o=e.pending_buf[e.sym_buf+s++],0===r?LG(e,o,t):(i=OG[o],LG(e,i+hG+1,t),a=gG[i],0!==a&&(o-=RG[i],MG(e,o,a)),r--,i=PG(r),LG(e,i,n),a=EG[i],0!==a&&(r-=CG[i],MG(e,r,a)))}while(s<e.sym_next);LG(e,256,t)},GG=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,o=t.stat_desc.has_stree,i=t.stat_desc.elems;let a,s,c,l=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<i;a++)0!==n[2*a]?(e.heap[++e.heap_len]=l=a,e.depth[a]=0):n[2*a+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,n[2*c]=1,e.depth[c]=0,e.opt_len--,o&&(e.static_len-=r[2*c+1]);for(t.max_code=l,a=e.heap_len>>1;a>=1;a--)VG(e,n,a);c=i;do{a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],VG(e,n,1),s=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=s,n[2*c]=n[2*a]+n[2*s],e.depth[c]=(e.depth[a]>=e.depth[s]?e.depth[a]:e.depth[s])+1,n[2*a+1]=n[2*s+1]=c,e.heap[1]=c++,VG(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,o=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,c=t.stat_desc.max_length;let l,u,d,p,h,f,m=0;for(p=0;p<=vG;p++)e.bl_count[p]=0;for(n[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<573;l++)u=e.heap[l],p=n[2*n[2*u+1]+1]+1,p>c&&(p=c,m++),n[2*u+1]=p,u>r||(e.bl_count[p]++,h=0,u>=s&&(h=a[u-s]),f=n[2*u],e.opt_len+=f*(p+h),i&&(e.static_len+=f*(o[2*u+1]+h)));if(0!==m){do{for(p=c-1;0===e.bl_count[p];)p--;e.bl_count[p]--,e.bl_count[p+1]+=2,e.bl_count[c]--,m-=2}while(m>0);for(p=c;0!==p;p--)for(u=e.bl_count[p];0!==u;)d=e.heap[--l],d>r||(n[2*d+1]!==p&&(e.opt_len+=(p-n[2*d+1])*n[2*d],n[2*d+1]=p),u--)}})(e,t),UG(n,l,e.bl_count)},WG=(e,t,n)=>{let r,o,i=-1,a=t[1],s=0,c=7,l=4;for(0===a&&(c=138,l=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)o=a,a=t[2*(r+1)+1],++s<c&&o===a||(s<l?e.bl_tree[2*o]+=s:0!==o?(o!==i&&e.bl_tree[2*o]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,i=o,0===a?(c=138,l=3):o===a?(c=6,l=3):(c=7,l=4))},qG=(e,t,n)=>{let r,o,i=-1,a=t[1],s=0,c=7,l=4;for(0===a&&(c=138,l=3),r=0;r<=n;r++)if(o=a,a=t[2*(r+1)+1],!(++s<c&&o===a)){if(s<l)do{LG(e,o,e.bl_tree)}while(0!=--s);else 0!==o?(o!==i&&(LG(e,o,e.bl_tree),s--),LG(e,16,e.bl_tree),MG(e,s-3,2)):s<=10?(LG(e,17,e.bl_tree),MG(e,s-3,3)):(LG(e,18,e.bl_tree),MG(e,s-11,7));s=0,i=o,0===a?(c=138,l=3):o===a?(c=6,l=3):(c=7,l=4)}};let KG=!1;const YG=(e,t,n,r)=>{MG(e,0+(r?1:0),3),FG(e),DG(e,n),DG(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var zG=e=>{KG||((()=>{let e,t,n,r,o;const i=new Array(16);for(n=0,r=0;r<28;r++)for(RG[r]=n,e=0;e<1<<gG[r];e++)OG[n++]=r;for(OG[n-1]=r,o=0,r=0;r<16;r++)for(CG[r]=o,e=0;e<1<<EG[r];e++)SG[o++]=r;for(o>>=7;r<mG;r++)for(CG[r]=o<<7,e=0;e<1<<EG[r]-7;e++)SG[256+o++]=r;for(t=0;t<=vG;t++)i[t]=0;for(e=0;e<=143;)bG[2*e+1]=8,e++,i[8]++;for(;e<=255;)bG[2*e+1]=9,e++,i[9]++;for(;e<=279;)bG[2*e+1]=7,e++,i[7]++;for(;e<=287;)bG[2*e+1]=8,e++,i[8]++;for(UG(bG,287,i),e=0;e<mG;e++)TG[2*e+1]=5,TG[2*e]=xG(e,5);IG=new wG(bG,gG,257,fG,vG),AG=new wG(TG,EG,0,mG,vG),NG=new wG(new Array(0),yG,0,19,7)})(),KG=!0),e.l_desc=new kG(e.dyn_ltree,IG),e.d_desc=new kG(e.dyn_dtree,AG),e.bl_desc=new kG(e.bl_tree,NG),e.bi_buf=0,e.bi_valid=0,jG(e)},XG=(e,t,n,r)=>{let o,i,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<hG;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),GG(e,e.l_desc),GG(e,e.d_desc),a=(e=>{let t;for(WG(e,e.dyn_ltree,e.l_desc.max_code),WG(e,e.dyn_dtree,e.d_desc.max_code),GG(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*_G[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),o=e.opt_len+3+7>>>3,i=e.static_len+3+7>>>3,i<=o&&(o=i)):o=i=n+5,n+4<=o&&-1!==t?YG(e,t,n,r):4===e.strategy||i===o?(MG(e,2+(r?1:0),3),HG(e,bG,TG)):(MG(e,4+(r?1:0),3),((e,t,n,r)=>{let o;for(MG(e,t-257,5),MG(e,n-1,5),MG(e,r-4,4),o=0;o<r;o++)MG(e,e.bl_tree[2*_G[o]+1],3);qG(e,e.dyn_ltree,t-1),qG(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),HG(e,e.dyn_ltree,e.dyn_dtree)),jG(e),r&&FG(e)},JG=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(OG[n]+hG+1)]++,e.dyn_dtree[2*PG(t)]++),e.sym_next===e.sym_end),ZG=e=>{MG(e,2,3),LG(e,256,bG),(e=>{16===e.bi_valid?(DG(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)},QG={_tr_init:zG,_tr_stored_block:YG,_tr_flush_block:XG,_tr_tally:JG,_tr_align:ZG},$G=(e,t,n,r)=>{let o=65535&e,i=e>>>16&65535,a=0;for(;0!==n;){a=n>2e3?2e3:n,n-=a;do{o=o+t[r++]|0,i=i+o|0}while(--a);o%=65521,i%=65521}return o|i<<16};const eW=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var tW=(e,t,n,r)=>{const o=eW,i=r+n;e^=-1;for(let a=r;a<i;a++)e=e>>>8^o[255&(e^t[a])];return~e},nW={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},rW={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:oW,_tr_stored_block:iW,_tr_flush_block:aW,_tr_tally:sW,_tr_align:cW}=QG,{Z_NO_FLUSH:lW,Z_PARTIAL_FLUSH:uW,Z_FULL_FLUSH:dW,Z_FINISH:pW,Z_BLOCK:hW,Z_OK:fW,Z_STREAM_END:mW,Z_STREAM_ERROR:vW,Z_DATA_ERROR:gW,Z_BUF_ERROR:EW,Z_DEFAULT_COMPRESSION:yW,Z_FILTERED:_W,Z_HUFFMAN_ONLY:bW,Z_RLE:TW,Z_FIXED:SW,Z_DEFAULT_STRATEGY:OW,Z_UNKNOWN:RW,Z_DEFLATED:CW}=rW,wW=258,IW=262,AW=42,NW=113,kW=666,PW=(e,t)=>(e.msg=nW[t],t),DW=e=>2*e-(e>4?9:0),MW=e=>{let t=e.length;for(;--t>=0;)e[t]=0},LW=e=>{let t,n,r,o=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=o?n-o:0}while(--t);t=o,r=t;do{n=e.prev[--r],e.prev[r]=n>=o?n-o:0}while(--t)};let xW=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const UW=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},jW=(e,t)=>{aW(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,UW(e.strm)},FW=(e,t)=>{e.pending_buf[e.pending++]=t},BW=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},VW=(e,t,n,r)=>{let o=e.avail_in;return o>r&&(o=r),0===o?0:(e.avail_in-=o,t.set(e.input.subarray(e.next_in,e.next_in+o),n),1===e.state.wrap?e.adler=$G(e.adler,t,o,n):2===e.state.wrap&&(e.adler=tW(e.adler,t,o,n)),e.next_in+=o,e.total_in+=o,o)},HW=(e,t)=>{let n,r,o=e.max_chain_length,i=e.strstart,a=e.prev_length,s=e.nice_match;const c=e.strstart>e.w_size-IW?e.strstart-(e.w_size-IW):0,l=e.window,u=e.w_mask,d=e.prev,p=e.strstart+wW;let h=l[i+a-1],f=l[i+a];e.prev_length>=e.good_match&&(o>>=2),s>e.lookahead&&(s=e.lookahead);do{if(n=t,l[n+a]===f&&l[n+a-1]===h&&l[n]===l[i]&&l[++n]===l[i+1]){i+=2,n++;do{}while(l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&i<p);if(r=wW-(p-i),i=p-wW,r>a){if(e.match_start=t,a=r,r>=s)break;h=l[i+a-1],f=l[i+a]}}}while((t=d[t&u])>c&&0!=--o);return a<=e.lookahead?a:e.lookahead},GW=e=>{const t=e.w_size;let n,r,o;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-IW)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),LW(e),r+=t),0===e.strm.avail_in)break;if(n=VW(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=xW(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=xW(e,e.ins_h,e.window[o+3-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<IW&&0!==e.strm.avail_in)},WW=(e,t)=>{let n,r,o,i=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,s=e.strm.avail_in;do{if(n=65535,o=e.bi_valid+42>>3,e.strm.avail_out<o)break;if(o=e.strm.avail_out-o,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>o&&(n=o),n<i&&(0===n&&t!==pW||t===lW||n!==r+e.strm.avail_in))break;a=t===pW&&n===r+e.strm.avail_in?1:0,iW(e,0,0,a),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,UW(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(VW(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===a);return s-=e.strm.avail_in,s&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==lW&&t!==pW&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(o=e.window_size-e.strstart,e.strm.avail_in>o&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,o+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),o>e.strm.avail_in&&(o=e.strm.avail_in),o&&(VW(e.strm,e.window,e.strstart,o),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.high_water<e.strstart&&(e.high_water=e.strstart),o=e.bi_valid+42>>3,o=e.pending_buf_size-o>65535?65535:e.pending_buf_size-o,i=o>e.w_size?e.w_size:o,r=e.strstart-e.block_start,(r>=i||(r||t===pW)&&t!==lW&&0===e.strm.avail_in&&r<=o)&&(n=r>o?o:r,a=t===pW&&0===e.strm.avail_in&&n===r?1:0,iW(e,e.block_start,n,a),e.block_start+=n,UW(e.strm)),a?3:1)},qW=(e,t)=>{let n,r;for(;;){if(e.lookahead<IW){if(GW(e),e.lookahead<IW&&t===lW)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=xW(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-IW&&(e.match_length=HW(e,n)),e.match_length>=3)if(r=sW(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=xW(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=xW(e,e.ins_h,e.window[e.strstart+1]);else r=sW(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(jW(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===pW?(jW(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(jW(e,!1),0===e.strm.avail_out)?1:2},KW=(e,t)=>{let n,r,o;for(;;){if(e.lookahead<IW){if(GW(e),e.lookahead<IW&&t===lW)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=xW(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-IW&&(e.match_length=HW(e,n),e.match_length<=5&&(e.strategy===_W||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-3,r=sW(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=o&&(e.ins_h=xW(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(jW(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=sW(e,0,e.window[e.strstart-1]),r&&jW(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=sW(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===pW?(jW(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(jW(e,!1),0===e.strm.avail_out)?1:2};function YW(e,t,n,r,o){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=o}const zW=[new YW(0,0,0,0,WW),new YW(4,4,8,4,qW),new YW(4,5,16,8,qW),new YW(4,6,32,32,qW),new YW(4,4,16,16,KW),new YW(8,16,32,32,KW),new YW(8,16,128,128,KW),new YW(8,32,128,256,KW),new YW(32,128,258,1024,KW),new YW(32,258,258,4096,KW)];function XW(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=CW,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),MW(this.dyn_ltree),MW(this.dyn_dtree),MW(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),MW(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),MW(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const JW=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==AW&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==NW&&t.status!==kW?1:0},ZW=e=>{if(JW(e))return PW(e,vW);e.total_in=e.total_out=0,e.data_type=RW;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?AW:NW,e.adler=2===t.wrap?0:1,t.last_flush=-2,oW(t),fW},QW=e=>{const t=ZW(e);return t===fW&&(e=>{e.window_size=2*e.w_size,MW(e.head),e.max_lazy_match=zW[e.level].max_lazy,e.good_match=zW[e.level].good_length,e.nice_match=zW[e.level].nice_length,e.max_chain_length=zW[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0})(e.state),t},$W=(e,t,n,r,o,i)=>{if(!e)return vW;let a=1;if(t===yW&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),o<1||o>9||n!==CW||r<8||r>15||t<0||t>9||i<0||i>SW||8===r&&1!==a)return PW(e,vW);8===r&&(r=9);const s=new XW;return e.state=s,s.strm=e,s.status=AW,s.wrap=a,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=o+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<o+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=t,s.strategy=i,s.method=n,QW(e)};var eq=(e,t)=>{if(JW(e)||t>hW||t<0)return e?PW(e,vW):vW;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===kW&&t!==pW)return PW(e,0===e.avail_out?EW:vW);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(UW(e),0===e.avail_out)return n.last_flush=-1,fW}else if(0===e.avail_in&&DW(t)<=DW(r)&&t!==pW)return PW(e,EW);if(n.status===kW&&0!==e.avail_in)return PW(e,EW);if(n.status===AW&&0===n.wrap&&(n.status=NW),n.status===AW){let t=CW+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=bW||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,BW(n,t),0!==n.strstart&&(BW(n,e.adler>>>16),BW(n,65535&e.adler)),e.adler=1,n.status=NW,UW(e),0!==n.pending)return n.last_flush=-1,fW}if(57===n.status)if(e.adler=0,FW(n,31),FW(n,139),FW(n,8),n.gzhead)FW(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),FW(n,255&n.gzhead.time),FW(n,n.gzhead.time>>8&255),FW(n,n.gzhead.time>>16&255),FW(n,n.gzhead.time>>24&255),FW(n,9===n.level?2:n.strategy>=bW||n.level<2?4:0),FW(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(FW(n,255&n.gzhead.extra.length),FW(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=tW(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(FW(n,0),FW(n,0),FW(n,0),FW(n,0),FW(n,0),FW(n,9===n.level?2:n.strategy>=bW||n.level<2?4:0),FW(n,3),n.status=NW,UW(e),0!==n.pending)return n.last_flush=-1,fW;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let o=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+o),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=tW(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=o,UW(e),0!==n.pending)return n.last_flush=-1,fW;t=0,r-=o}let o=new Uint8Array(n.gzhead.extra);n.pending_buf.set(o.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=tW(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=tW(e.adler,n.pending_buf,n.pending-r,r)),UW(e),0!==n.pending)return n.last_flush=-1,fW;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,FW(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=tW(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=tW(e.adler,n.pending_buf,n.pending-r,r)),UW(e),0!==n.pending)return n.last_flush=-1,fW;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,FW(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=tW(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(UW(e),0!==n.pending))return n.last_flush=-1,fW;FW(n,255&e.adler),FW(n,e.adler>>8&255),e.adler=0}if(n.status=NW,UW(e),0!==n.pending)return n.last_flush=-1,fW}if(0!==e.avail_in||0!==n.lookahead||t!==lW&&n.status!==kW){let r=0===n.level?WW(n,t):n.strategy===bW?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(GW(e),0===e.lookahead)){if(t===lW)return 1;break}if(e.match_length=0,n=sW(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(jW(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===pW?(jW(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(jW(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===TW?((e,t)=>{let n,r,o,i;const a=e.window;for(;;){if(e.lookahead<=wW){if(GW(e),e.lookahead<=wW&&t===lW)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(o=e.strstart-1,r=a[o],r===a[++o]&&r===a[++o]&&r===a[++o])){i=e.strstart+wW;do{}while(r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&o<i);e.match_length=wW-(i-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=sW(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=sW(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(jW(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===pW?(jW(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(jW(e,!1),0===e.strm.avail_out)?1:2})(n,t):zW[n.level].func(n,t);if(3!==r&&4!==r||(n.status=kW),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),fW;if(2===r&&(t===uW?cW(n):t!==hW&&(iW(n,0,0,!1),t===dW&&(MW(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),UW(e),0===e.avail_out))return n.last_flush=-1,fW}return t!==pW?fW:n.wrap<=0?mW:(2===n.wrap?(FW(n,255&e.adler),FW(n,e.adler>>8&255),FW(n,e.adler>>16&255),FW(n,e.adler>>24&255),FW(n,255&e.total_in),FW(n,e.total_in>>8&255),FW(n,e.total_in>>16&255),FW(n,e.total_in>>24&255)):(BW(n,e.adler>>>16),BW(n,65535&e.adler)),UW(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?fW:mW)},tq=(e,t)=>{let n=t.length;if(JW(e))return vW;const r=e.state,o=r.wrap;if(2===o||1===o&&r.status!==AW||r.lookahead)return vW;if(1===o&&(e.adler=$G(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===o&&(MW(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const i=e.avail_in,a=e.next_in,s=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,GW(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=xW(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,GW(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=a,e.input=s,e.avail_in=i,r.wrap=o,fW},nq={deflateInit:(e,t)=>$W(e,t,CW,15,8,OW),deflateInit2:$W,deflateReset:QW,deflateResetKeep:ZW,deflateSetHeader:(e,t)=>JW(e)||2!==e.state.wrap?vW:(e.state.gzhead=t,fW),deflate:eq,deflateEnd:e=>{if(JW(e))return vW;const t=e.state.status;return e.state=null,t===NW?PW(e,gW):fW},deflateSetDictionary:tq,deflateInfo:"pako deflate (from Nodeca project)"};const rq=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var oq=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)rq(n,t)&&(e[t]=n[t])}}return e},iq=e=>{let t=0;for(let r=0,o=e.length;r<o;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,o=0,i=e.length;r<i;r++){let t=e[r];n.set(t,o),o+=t.length}return n};let aq=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){aq=!1}const sq=new Uint8Array(256);for(let t=0;t<256;t++)sq[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;sq[254]=sq[254]=1;var cq=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,o,i,a=e.length,s=0;for(o=0;o<a;o++)n=e.charCodeAt(o),55296==(64512&n)&&o+1<a&&(r=e.charCodeAt(o+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(s),i=0,o=0;i<s;o++)n=e.charCodeAt(o),55296==(64512&n)&&o+1<a&&(r=e.charCodeAt(o+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),n<128?t[i++]=n:n<2048?(t[i++]=192|n>>>6,t[i++]=128|63&n):n<65536?(t[i++]=224|n>>>12,t[i++]=128|n>>>6&63,t[i++]=128|63&n):(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63,t[i++]=128|n>>>6&63,t[i++]=128|63&n);return t},lq=(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,o;const i=new Array(2*n);for(o=0,r=0;r<n;){let t=e[r++];if(t<128){i[o++]=t;continue}let a=sq[t];if(a>4)i[o++]=65533,r+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&r<n;)t=t<<6|63&e[r++],a--;a>1?i[o++]=65533:t<65536?i[o++]=t:(t-=65536,i[o++]=55296|t>>10&1023,i[o++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&aq)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(i,o)},uq=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+sq[e[n]]>t?n:t},dq=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const pq=Object.prototype.toString,{Z_NO_FLUSH:hq,Z_SYNC_FLUSH:fq,Z_FULL_FLUSH:mq,Z_FINISH:vq,Z_OK:gq,Z_STREAM_END:Eq,Z_DEFAULT_COMPRESSION:yq,Z_DEFAULT_STRATEGY:_q,Z_DEFLATED:bq}=rW;function Tq(e){this.options=oq({level:yq,method:bq,chunkSize:16384,windowBits:15,memLevel:8,strategy:_q},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new dq,this.strm.avail_out=0;let n=nq.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==gq)throw new Error(nW[n]);if(t.header&&nq.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?cq(t.dictionary):"[object ArrayBuffer]"===pq.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=nq.deflateSetDictionary(this.strm,e),n!==gq)throw new Error(nW[n]);this._dict_set=!0}}function Sq(e,t){const n=new Tq(t);if(n.push(e,!0),n.err)throw n.msg||nW[n.err];return n.result}Tq.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let o,i;if(this.ended)return!1;for(i=t===~~t?t:!0===t?vq:hq,"string"==typeof e?n.input=cq(e):"[object ArrayBuffer]"===pq.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(i===fq||i===mq)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(o=nq.deflate(n,i),o===Eq)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),o=nq.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===gq;if(0!==n.avail_out){if(i>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},Tq.prototype.onData=function(e){this.chunks.push(e)},Tq.prototype.onEnd=function(e){e===gq&&(this.result=iq(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Oq={Deflate:Tq,deflate:Sq,deflateRaw:function(e,t){return(t=t||{}).raw=!0,Sq(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,Sq(e,t)},constants:rW};const Rq=16209;var Cq=function(e,t){let n,r,o,i,a,s,c,l,u,d,p,h,f,m,v,g,E,y,_,b,T,S,O,R;const C=e.state;n=e.next_in,O=e.input,r=n+(e.avail_in-5),o=e.next_out,R=e.output,i=o-(t-e.avail_out),a=o+(e.avail_out-257),s=C.dmax,c=C.wsize,l=C.whave,u=C.wnext,d=C.window,p=C.hold,h=C.bits,f=C.lencode,m=C.distcode,v=(1<<C.lenbits)-1,g=(1<<C.distbits)-1;e:do{h<15&&(p+=O[n++]<<h,h+=8,p+=O[n++]<<h,h+=8),E=f[p&v];t:for(;;){if(y=E>>>24,p>>>=y,h-=y,y=E>>>16&255,0===y)R[o++]=65535&E;else{if(!(16&y)){if(64&y){if(32&y){C.mode=16191;break e}e.msg="invalid literal/length code",C.mode=Rq;break e}E=f[(65535&E)+(p&(1<<y)-1)];continue t}for(_=65535&E,y&=15,y&&(h<y&&(p+=O[n++]<<h,h+=8),_+=p&(1<<y)-1,p>>>=y,h-=y),h<15&&(p+=O[n++]<<h,h+=8,p+=O[n++]<<h,h+=8),E=m[p&g];;){if(y=E>>>24,p>>>=y,h-=y,y=E>>>16&255,16&y){if(b=65535&E,y&=15,h<y&&(p+=O[n++]<<h,h+=8,h<y&&(p+=O[n++]<<h,h+=8)),b+=p&(1<<y)-1,b>s){e.msg="invalid distance too far back",C.mode=Rq;break e}if(p>>>=y,h-=y,y=o-i,b>y){if(y=b-y,y>l&&C.sane){e.msg="invalid distance too far back",C.mode=Rq;break e}if(T=0,S=d,0===u){if(T+=c-y,y<_){_-=y;do{R[o++]=d[T++]}while(--y);T=o-b,S=R}}else if(u<y){if(T+=c+u-y,y-=u,y<_){_-=y;do{R[o++]=d[T++]}while(--y);if(T=0,u<_){y=u,_-=y;do{R[o++]=d[T++]}while(--y);T=o-b,S=R}}}else if(T+=u-y,y<_){_-=y;do{R[o++]=d[T++]}while(--y);T=o-b,S=R}for(;_>2;)R[o++]=S[T++],R[o++]=S[T++],R[o++]=S[T++],_-=3;_&&(R[o++]=S[T++],_>1&&(R[o++]=S[T++]))}else{T=o-b;do{R[o++]=R[T++],R[o++]=R[T++],R[o++]=R[T++],_-=3}while(_>2);_&&(R[o++]=R[T++],_>1&&(R[o++]=R[T++]))}break}if(64&y){e.msg="invalid distance code",C.mode=Rq;break e}E=m[(65535&E)+(p&(1<<y)-1)]}}break}}while(n<r&&o<a);_=h>>3,n-=_,h-=_<<3,p&=(1<<h)-1,e.next_in=n,e.next_out=o,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=o<a?a-o+257:257-(o-a),C.hold=p,C.bits=h};const wq=15,Iq=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Aq=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Nq=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),kq=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Pq=(e,t,n,r,o,i,a,s)=>{const c=s.bits;let l,u,d,p,h,f,m=0,v=0,g=0,E=0,y=0,_=0,b=0,T=0,S=0,O=0,R=null;const C=new Uint16Array(16),w=new Uint16Array(16);let I,A,N,k=null;for(m=0;m<=wq;m++)C[m]=0;for(v=0;v<r;v++)C[t[n+v]]++;for(y=c,E=wq;E>=1&&0===C[E];E--);if(y>E&&(y=E),0===E)return o[i++]=20971520,o[i++]=20971520,s.bits=1,0;for(g=1;g<E&&0===C[g];g++);for(y<g&&(y=g),T=1,m=1;m<=wq;m++)if(T<<=1,T-=C[m],T<0)return-1;if(T>0&&(0===e||1!==E))return-1;for(w[1]=0,m=1;m<wq;m++)w[m+1]=w[m]+C[m];for(v=0;v<r;v++)0!==t[n+v]&&(a[w[t[n+v]]++]=v);if(0===e?(R=k=a,f=20):1===e?(R=Iq,k=Aq,f=257):(R=Nq,k=kq,f=0),O=0,v=0,m=g,h=i,_=y,b=0,d=-1,S=1<<y,p=S-1,1===e&&S>852||2===e&&S>592)return 1;for(;;){I=m-b,a[v]+1<f?(A=0,N=a[v]):a[v]>=f?(A=k[a[v]-f],N=R[a[v]-f]):(A=96,N=0),l=1<<m-b,u=1<<_,g=u;do{u-=l,o[h+(O>>b)+u]=I<<24|A<<16|N}while(0!==u);for(l=1<<m-1;O&l;)l>>=1;if(0!==l?(O&=l-1,O+=l):O=0,v++,0==--C[m]){if(m===E)break;m=t[n+a[v]]}if(m>y&&(O&p)!==d){for(0===b&&(b=y),h+=g,_=m-b,T=1<<_;_+b<E&&(T-=C[_+b],!(T<=0));)_++,T<<=1;if(S+=1<<_,1===e&&S>852||2===e&&S>592)return 1;d=O&p,o[d]=y<<24|_<<16|h-i}}return 0!==O&&(o[h+O]=m-b<<24|64<<16),s.bits=y,0};const{Z_FINISH:Dq,Z_BLOCK:Mq,Z_TREES:Lq,Z_OK:xq,Z_STREAM_END:Uq,Z_NEED_DICT:jq,Z_STREAM_ERROR:Fq,Z_DATA_ERROR:Bq,Z_MEM_ERROR:Vq,Z_BUF_ERROR:Hq,Z_DEFLATED:Gq}=rW,Wq=16180,qq=16190,Kq=16191,Yq=16192,zq=16194,Xq=16199,Jq=16200,Zq=16206,Qq=16209,$q=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function eK(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const tK=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Wq||t.mode>16211?1:0},nK=e=>{if(tK(e))return Fq;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Wq,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,xq},rK=e=>{if(tK(e))return Fq;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,nK(e)},oK=(e,t)=>{let n;if(tK(e))return Fq;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Fq:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,rK(e))},iK=(e,t)=>{if(!e)return Fq;const n=new eK;e.state=n,n.strm=e,n.window=null,n.mode=Wq;const r=oK(e,t);return r!==xq&&(e.state=null),r};let aK,sK,cK=!0;const lK=e=>{if(cK){aK=new Int32Array(512),sK=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Pq(1,e.lens,0,288,aK,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Pq(2,e.lens,0,32,sK,0,e.work,{bits:5}),cK=!1}e.lencode=aK,e.lenbits=9,e.distcode=sK,e.distbits=5},uK=(e,t,n,r)=>{let o;const i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(t.subarray(n-i.wsize,n),0),i.wnext=0,i.whave=i.wsize):(o=i.wsize-i.wnext,o>r&&(o=r),i.window.set(t.subarray(n-r,n-r+o),i.wnext),(r-=o)?(i.window.set(t.subarray(n-r,n),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=o,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=o))),0};var dK=(e,t)=>{let n,r,o,i,a,s,c,l,u,d,p,h,f,m,v,g,E,y,_,b,T,S,O=0;const R=new Uint8Array(4);let C,w;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(tK(e)||!e.output||!e.input&&0!==e.avail_in)return Fq;n=e.state,n.mode===Kq&&(n.mode=Yq),a=e.next_out,o=e.output,c=e.avail_out,i=e.next_in,r=e.input,s=e.avail_in,l=n.hold,u=n.bits,d=s,p=c,S=xq;e:for(;;)switch(n.mode){case Wq:if(0===n.wrap){n.mode=Yq;break}for(;u<16;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(2&n.wrap&&35615===l){0===n.wbits&&(n.wbits=15),n.check=0,R[0]=255&l,R[1]=l>>>8&255,n.check=tW(n.check,R,2,0),l=0,u=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",n.mode=Qq;break}if((15&l)!==Gq){e.msg="unknown compression method",n.mode=Qq;break}if(l>>>=4,u-=4,T=8+(15&l),0===n.wbits&&(n.wbits=T),T>15||T>n.wbits){e.msg="invalid window size",n.mode=Qq;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&l?16189:Kq,l=0,u=0;break;case 16181:for(;u<16;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(n.flags=l,(255&dG(n))!==Gq){e.msg="unknown compression method",n.mode=Qq;break}if(57344&dG(n)){e.msg="unknown header flags set",n.mode=Qq;break}n.head&&(n.head.text=l>>8&1),512&dG(n)&&4&n.wrap&&(R[0]=255&l,R[1]=l>>>8&255,n.check=tW(n.check,R,2,0)),l=0,u=0,n.mode=16182;case 16182:for(;u<32;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}n.head&&(n.head.time=l),512&dG(n)&&4&n.wrap&&(R[0]=255&l,R[1]=l>>>8&255,R[2]=l>>>16&255,R[3]=l>>>24&255,n.check=tW(n.check,R,4,0)),l=0,u=0,n.mode=16183;case 16183:for(;u<16;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}n.head&&(n.head.xflags=255&l,n.head.os=l>>8),512&dG(n)&&4&n.wrap&&(R[0]=255&l,R[1]=l>>>8&255,n.check=tW(n.check,R,2,0)),l=0,u=0,n.mode=16184;case 16184:if(1024&dG(n)){for(;u<16;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}n.length=l,n.head&&(n.head.extra_len=l),512&dG(n)&&4&n.wrap&&(R[0]=255&l,R[1]=l>>>8&255,n.check=tW(n.check,R,2,0)),l=0,u=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&dG(n)&&(h=n.length,h>s&&(h=s),h&&(n.head&&(T=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(i,i+h),T)),512&dG(n)&&4&n.wrap&&(n.check=tW(n.check,r,h,i)),s-=h,i+=h,n.length-=h),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&dG(n)){if(0===s)break e;h=0;do{T=r[i+h++],n.head&&T&&n.length<65536&&(n.head.name+=String.fromCharCode(T))}while(T&&h<s);if(512&dG(n)&&4&n.wrap&&(n.check=tW(n.check,r,h,i)),s-=h,i+=h,T)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&dG(n)){if(0===s)break e;h=0;do{T=r[i+h++],n.head&&T&&n.length<65536&&(n.head.comment+=String.fromCharCode(T))}while(T&&h<s);if(512&dG(n)&&4&n.wrap&&(n.check=tW(n.check,r,h,i)),s-=h,i+=h,T)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&dG(n)){for(;u<16;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(4&n.wrap&&l!==(65535&n.check)){e.msg="header crc mismatch",n.mode=Qq;break}l=0,u=0}n.head&&(n.head.hcrc=dG(n)>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Kq;break;case 16189:for(;u<32;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}e.adler=n.check=$q(l),l=0,u=0,n.mode=qq;case qq:if(0===n.havedict)return e.next_out=a,e.avail_out=c,e.next_in=i,e.avail_in=s,n.hold=l,n.bits=u,jq;e.adler=n.check=1,n.mode=Kq;case Kq:if(t===Mq||t===Lq)break e;case Yq:if(n.last){l>>>=7&u,u-=7&u,n.mode=Zq;break}for(;u<3;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}switch(n.last=1&l,l>>>=1,u-=1,3&l){case 0:n.mode=16193;break;case 1:if(lK(n),n.mode=Xq,t===Lq){l>>>=2,u-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=Qq}l>>>=2,u-=2;break;case 16193:for(l>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",n.mode=Qq;break}if(n.length=65535&l,l=0,u=0,n.mode=zq,t===Lq)break e;case zq:n.mode=16195;case 16195:if(h=n.length,h){if(h>s&&(h=s),h>c&&(h=c),0===h)break e;o.set(r.subarray(i,i+h),a),s-=h,i+=h,c-=h,a+=h,n.length-=h;break}n.mode=Kq;break;case 16196:for(;u<14;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(n.nlen=257+(31&l),l>>>=5,u-=5,n.ndist=1+(31&l),l>>>=5,u-=5,n.ncode=4+(15&l),l>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=Qq;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;u<3;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}n.lens[I[n.have++]]=7&l,l>>>=3,u-=3}for(;n.have<19;)n.lens[I[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,C={bits:n.lenbits},S=Pq(0,n.lens,0,19,n.lencode,0,n.work,C),n.lenbits=C.bits,S){e.msg="invalid code lengths set",n.mode=Qq;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;O=n.lencode[l&(1<<n.lenbits)-1],v=O>>>24,g=O>>>16&255,E=65535&O,!(v<=u);){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(E<16)l>>>=v,u-=v,n.lens[n.have++]=E;else{if(16===E){for(w=v+2;u<w;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(l>>>=v,u-=v,0===n.have){e.msg="invalid bit length repeat",n.mode=Qq;break}T=n.lens[n.have-1],h=3+(3&l),l>>>=2,u-=2}else if(17===E){for(w=v+3;u<w;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}l>>>=v,u-=v,T=0,h=3+(7&l),l>>>=3,u-=3}else{for(w=v+7;u<w;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}l>>>=v,u-=v,T=0,h=11+(127&l),l>>>=7,u-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=Qq;break}for(;h--;)n.lens[n.have++]=T}}if(n.mode===Qq)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=Qq;break}if(n.lenbits=9,C={bits:n.lenbits},S=Pq(1,n.lens,0,n.nlen,n.lencode,0,n.work,C),n.lenbits=C.bits,S){e.msg="invalid literal/lengths set",n.mode=Qq;break}if(n.distbits=6,n.distcode=n.distdyn,C={bits:n.distbits},S=Pq(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,C),n.distbits=C.bits,S){e.msg="invalid distances set",n.mode=Qq;break}if(n.mode=Xq,t===Lq)break e;case Xq:n.mode=Jq;case Jq:if(s>=6&&c>=258){e.next_out=a,e.avail_out=c,e.next_in=i,e.avail_in=s,n.hold=l,n.bits=u,Cq(e,p),a=e.next_out,o=e.output,c=e.avail_out,i=e.next_in,r=e.input,s=e.avail_in,l=n.hold,u=n.bits,n.mode===Kq&&(n.back=-1);break}for(n.back=0;O=n.lencode[l&(1<<n.lenbits)-1],v=O>>>24,g=O>>>16&255,E=65535&O,!(v<=u);){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(g&&!(240&g)){for(y=v,_=g,b=E;O=n.lencode[b+((l&(1<<y+_)-1)>>y)],v=O>>>24,g=O>>>16&255,E=65535&O,!(y+v<=u);){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}l>>>=y,u-=y,n.back+=y}if(l>>>=v,u-=v,n.back+=v,n.length=E,0===g){n.mode=16205;break}if(32&g){n.back=-1,n.mode=Kq;break}if(64&g){e.msg="invalid literal/length code",n.mode=Qq;break}n.extra=15&g,n.mode=16201;case 16201:if(n.extra){for(w=n.extra;u<w;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;O=n.distcode[l&(1<<n.distbits)-1],v=O>>>24,g=O>>>16&255,E=65535&O,!(v<=u);){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(!(240&g)){for(y=v,_=g,b=E;O=n.distcode[b+((l&(1<<y+_)-1)>>y)],v=O>>>24,g=O>>>16&255,E=65535&O,!(y+v<=u);){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}l>>>=y,u-=y,n.back+=y}if(l>>>=v,u-=v,n.back+=v,64&g){e.msg="invalid distance code",n.mode=Qq;break}n.offset=E,n.extra=15&g,n.mode=16203;case 16203:if(n.extra){for(w=n.extra;u<w;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=Qq;break}n.mode=16204;case 16204:if(0===c)break e;if(h=p-c,n.offset>h){if(h=n.offset-h,h>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=Qq;break}h>n.wnext?(h-=n.wnext,f=n.wsize-h):f=n.wnext-h,h>n.length&&(h=n.length),m=n.window}else m=o,f=a-n.offset,h=n.length;h>c&&(h=c),c-=h,n.length-=h;do{o[a++]=m[f++]}while(--h);0===n.length&&(n.mode=Jq);break;case 16205:if(0===c)break e;o[a++]=n.length,c--,n.mode=Jq;break;case Zq:if(n.wrap){for(;u<32;){if(0===s)break e;s--,l|=r[i++]<<u,u+=8}if(p-=c,e.total_out+=p,n.total+=p,4&n.wrap&&p&&(e.adler=n.check=dG(n)?tW(n.check,o,p,a-p):$G(n.check,o,p,a-p)),p=c,4&n.wrap&&(dG(n)?l:$q(l))!==n.check){e.msg="incorrect data check",n.mode=Qq;break}l=0,u=0}n.mode=16207;case 16207:if(n.wrap&&dG(n)){for(;u<32;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(4&n.wrap&&l!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=Qq;break}l=0,u=0}n.mode=16208;case 16208:S=Uq;break e;case Qq:S=Bq;break e;case 16210:return Vq;default:return Fq}return e.next_out=a,e.avail_out=c,e.next_in=i,e.avail_in=s,n.hold=l,n.bits=u,(n.wsize||p!==e.avail_out&&n.mode<Qq&&(n.mode<Zq||t!==Dq))&&uK(e,e.output,e.next_out,p-e.avail_out),d-=e.avail_in,p-=e.avail_out,e.total_in+=d,e.total_out+=p,n.total+=p,4&n.wrap&&p&&(e.adler=n.check=dG(n)?tW(n.check,o,p,e.next_out-p):$G(n.check,o,p,e.next_out-p)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Kq?128:0)+(n.mode===Xq||n.mode===zq?256:0),(0===d&&0===p||t===Dq)&&S===xq&&(S=Hq),S},pK={inflateReset:rK,inflateReset2:oK,inflateResetKeep:nK,inflateInit:e=>iK(e,15),inflateInit2:iK,inflate:dK,inflateEnd:e=>{if(tK(e))return Fq;let t=e.state;return t.window&&(t.window=null),e.state=null,xq},inflateGetHeader:(e,t)=>{if(tK(e))return Fq;const n=e.state;return 2&n.wrap?(n.head=t,t.done=!1,xq):Fq},inflateSetDictionary:(e,t)=>{const n=t.length;let r,o,i;return tK(e)?Fq:(r=e.state,0!==r.wrap&&r.mode!==qq?Fq:r.mode===qq&&(o=1,o=$G(o,t,n,0),o!==r.check)?Bq:(i=uK(e,t,n,n),i?(r.mode=16210,Vq):(r.havedict=1,xq)))},inflateInfo:"pako inflate (from Nodeca project)"},hK=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const fK=Object.prototype.toString,{Z_NO_FLUSH:mK,Z_FINISH:vK,Z_OK:gK,Z_STREAM_END:EK,Z_NEED_DICT:yK,Z_STREAM_ERROR:_K,Z_DATA_ERROR:bK,Z_MEM_ERROR:TK}=rW;function SK(e){this.options=oq({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new dq,this.strm.avail_out=0;let n=pK.inflateInit2(this.strm,t.windowBits);if(n!==gK)throw new Error(nW[n]);if(this.header=new hK,pK.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=cq(t.dictionary):"[object ArrayBuffer]"===fK.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=pK.inflateSetDictionary(this.strm,t.dictionary),n!==gK)))throw new Error(nW[n])}function OK(e,t){const n=new SK(t);if(n.push(e),n.err)throw n.msg||nW[n.err];return n.result}SK.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,o=this.options.dictionary;let i,a,s;if(this.ended)return!1;for(a=t===~~t?t:!0===t?vK:mK,"[object ArrayBuffer]"===fK.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),i=pK.inflate(n,a),i===yK&&o&&(i=pK.inflateSetDictionary(n,o),i===gK?i=pK.inflate(n,a):i===bK&&(i=yK));n.avail_in>0&&i===EK&&n.state.wrap>0&&0!==e[n.next_in];)pK.inflateReset(n),i=pK.inflate(n,a);switch(i){case _K:case bK:case yK:case TK:return this.onEnd(i),this.ended=!0,!1}if(s=n.avail_out,n.next_out&&(0===n.avail_out||i===EK))if("string"===this.options.to){let e=uq(n.output,n.next_out),t=n.next_out-e,o=lq(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(o)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(i!==gK||0!==s){if(i===EK)return i=pK.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},SK.prototype.onData=function(e){this.chunks.push(e)},SK.prototype.onEnd=function(e){e===gK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=iq(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var RK={Inflate:SK,inflate:OK,inflateRaw:function(e,t){return(t=t||{}).raw=!0,OK(e,t)},ungzip:OK,constants:rW};const{Deflate:CK,deflate:wK,deflateRaw:IK,gzip:AK}=Oq,{Inflate:NK,inflate:kK,inflateRaw:PK,ungzip:DK}=RK;var MK=wK,LK=kK,xK=function(e){return e[e.ONE_BYTE=0]="ONE_BYTE",e[e.TWO_BYTE=1]="TWO_BYTE",e}(xK||{});class UK{constructor(){OR(this,"_sequence",0),OR(this,"_startTime",Date.now()),OR(this,"isUseOneByte",!0)}get startTime(){const e=Date.now()-this._startTime;return e<Math.pow(2,16)?e:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(e){const t={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:e};if(e.byteLength>128){const n=new Uint8Array(4);n.set([1,0,0,0]);const r={id:0,length:4,data:n.buffer},o={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[r]};t.commonPacketHeader.extension=1,t.extension=o,t.payload=this.compress(e),t.commonPacketHeader.length=8+(t.extension.length+2)+t.payload.byteLength}else t.commonPacketHeader.length=8+t.payload.byteLength;UN("SHOW_DATASTREAM2_LOG")&&pk.debug("send data header: ".concat(JSON.stringify(t.commonPacketHeader)));const n=new ArrayBuffer(t.commonPacketHeader.length),r=new Uint8Array(n),o=new DataView(n);let i=0;if(o.setUint16(i,t.commonPacketHeader.extension<<15|t.commonPacketHeader.reserved<<14|t.commonPacketHeader.length,!0),i+=2,o.setUint32(i,t.commonPacketHeader.sequence,!0),i+=4,o.setUint16(i,t.commonStreamHeader,!0),i+=2,t.extension){const e=this.serializeExtension(t.extension);r.set(new Uint8Array(e),i),i+=e.byteLength}if(r.set(new Uint8Array(t.payload),i),i+=t.payload.byteLength,i!==t.commonPacketHeader.length)throw Error("serialize error!");return n}deserialize(e){if(e.byteLength<4)return new ArrayBuffer(0);const t=new DataView(e);let n=0;const r=t.getUint16(n,!0);n+=2;const o={length:16383&r,reserved:(16384&r)>>14,extension:(32768&r)>>15,sequence:t.getUint16(n+2,!0)<<16|t.getUint16(n,!0)};let i,a;if(n+=4,UN("SHOW_DATASTREAM2_LOG")&&pk.debug("receive data header: ".concat(JSON.stringify(o))),t.getUint16(n,!0),n+=2,o.extension){a=this.deserializeExtension(e.slice(n)),n+=2+a.length,i=e.slice(n);let t=!1;if(a.datas.length>0){const e=a.datas.find((e=>0===e.id));e&&(t=!(1&~new DataView(e.data).getUint32(0,!0)))}i=t?this.decompress(i):i}else i=e.slice(8);return i}serializeExtension(e){const{profile:t,length:n,datas:r}=e,o=new ArrayBuffer(n+2),i=new Uint8Array(o),a=new DataView(o);let s=0;if(a.setUint8(s++,t),a.setUint8(s++,n),r.forEach((e=>{t?(a.setUint8(s++,e.id),a.setUint8(s++,e.length),i.set(new Uint8Array(e.data),s),s+=e.data.byteLength):(a.setUint8(s++,e.id|e.length<<4),i.set(new Uint8Array(e.data),s),s+=e.data.byteLength)})),s!==n+2)throw Error("serialize extension error, is ".concat(s,"!==").concat(n+2));return o}deserializeExtension(e){const t=new DataView(e);let n=0;const r=t.getUint8(n);n++;const o=t.getUint8(n);n++;const i=r===xK.TWO_BYTE,a=[],s=new DataView(e,2);let c=0;for(;c<o;){let e=0,t=0,n=new ArrayBuffer(0);i?(e=s.getUint8(c),c++,t=s.getUint8(c),c++):(e=15&s.getUint8(c),t=s.getUint8(c)>>4,c++),t>0&&(n=s.buffer.slice(c+2,c+2+t),c+=n.byteLength),a.push({id:e,length:t,data:n})}if(c!==o)throw Error("parse error");return{profile:r,length:o,datas:a}}decompress(e){return LK(new Uint8Array(e))}compress(e){return MK(new Uint8Array(e))}}const jK={name:"DataStream",create:(e,t)=>{const n=t?new $M(e):new eL(e);return n.useDataStream(new UK),n}};class FK extends eA{constructor(e,t,n){super(),OR(this,"ws",void 0),OR(this,"requestId",1),OR(this,"heartBeatTimer",void 0),OR(this,"joinInfo",void 0),OR(this,"clientId",void 0),OR(this,"onOpen",(()=>{this.emit("open"),this.startHeartBeatCheck()})),OR(this,"onClose",(e=>{this.emit("close"),this.dispose()})),OR(this,"onMessage",(e=>{const t=JSON.parse(e.data);if(!t||"serverResponse"!==t.command||!t.requestId)return t&&"serverStatus"===t.command&&t.serverStatus&&t.serverStatus.command?(this.emit("status",t.serverStatus),void this.emit(t.serverStatus.command,t.serverStatus)):void 0;this.emit("req_".concat(t.requestId),t)})),this.joinInfo=e,this.clientId=t,this.ws=new WU("cross-channel-".concat(this.clientId),n),this.ws.on(Lx.RECONNECTING,(()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")})),this.ws.on(Lx.CONNECTED,this.onOpen),this.ws.on(Lx.ON_MESSAGE,this.onMessage),this.ws.on(Lx.CLOSED,this.onClose)}isConnect(){return"connected"===this.ws.state}sendMessage(e){const t=this.requestId++;return e.requestId=t,e.seq=t,this.ws.sendMessage(e),t}waitStatus(e){return new ih(((t,n)=>{const r=window.setTimeout((()=>{n(new bk(jI.TIMEOUT,"wait status timeout, status: ".concat(e)))}),5e3);this.once(e,(o=>{window.clearTimeout(r),o.state&&0!==o.state?n(new bk(jI.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(e))):t(void 0)})),this.once("dispose",(()=>{window.clearTimeout(r),n(new bk(jI.WS_ABORT))}))}))}async request(e){if("closed"===this.ws.state)throw new bk(jI.WS_DISCONNECT);const t=()=>new ih(((e,t)=>{this.ws.once(Lx.CLOSED,(()=>t(new bk(jI.WS_ABORT)))),this.ws.once(Lx.CONNECTED,e)}));"connected"!==this.ws.state&&await t();const n=this.sendMessage(e),r=new ih(((e,t)=>{const r=()=>{t(new bk(jI.WS_ABORT))};this.ws.once(Lx.RECONNECTING,r),this.ws.once(Lx.CLOSED,r),this.once("req_".concat(n),e),MA(3e3).then((()=>{this.removeAllListeners("req_".concat(n)),this.ws.off(Lx.RECONNECTING,r),this.ws.off(Lx.CLOSED,r),t(new bk(jI.TIMEOUT,"cross channel ws request timeout"))}))})),o=await r;if(!o||200!==o.code)throw new bk(jI.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(o)));return o}async connect(e){this.ws.removeAllListeners(Lx.REQUEST_NEW_URLS),this.ws.on(Lx.REQUEST_NEW_URLS,(t=>{t(e)})),await this.ws.init(e)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(e){const t=this.requestId++;return e.requestId=t,this.ws.sendMessage(e),t}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval((()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})}),3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class BK extends eA{set state(e){e!==this._state&&(e!==Xx.RELAY_STATE_FAILURE&&(this.errorCode=Jx.RELAY_OK),this.emit("state",e,this.errorCode),this._state=e)}get state(){return this._state}constructor(e,t,n,r,o){super(),OR(this,"joinInfo",void 0),OR(this,"sid",void 0),OR(this,"clientId",void 0),OR(this,"cancelToken",Xw.CancelToken.source()),OR(this,"workerToken",void 0),OR(this,"requestId",0),OR(this,"signal",void 0),OR(this,"prevChannelMediaConfig",void 0),OR(this,"httpRetryConfig",void 0),OR(this,"_resolution",void 0),OR(this,"_state",Xx.RELAY_STATE_IDLE),OR(this,"errorCode",Jx.RELAY_OK),OR(this,"onStatus",(e=>{pk.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(e))),e&&e.command&&("onAudioPacketReceived"===e.command&&this.emit("event",zx.PACKET_RECEIVED_AUDIO_FROM_SRC),"onVideoPacketReceived"===e.command&&this.emit("event",zx.PACKET_RECEIVED_VIDEO_FROM_SRC),"onSrcTokenPrivilegeDidExpire"===e.command&&(this.errorCode=Jx.SRC_TOKEN_EXPIRED,this.state=Xx.RELAY_STATE_FAILURE),"onDestTokenPrivilegeDidExpire"===e.command&&(this.errorCode=Jx.DEST_TOKEN_EXPIRED,this.state=Xx.RELAY_STATE_FAILURE))})),OR(this,"onReconnect",(async()=>{pk.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",zx.NETWORK_DISCONNECTED),this.state=Xx.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch((e=>{this.state!==Xx.RELAY_STATE_IDLE&&(pk.error("auto restart channel media relay failed",e.toString()),this.errorCode=Jx.SERVER_CONNECTION_LOST,this.state=Xx.RELAY_STATE_FAILURE)}))})),this.joinInfo=e,this.clientId=t,this.sid=xA(),this.signal=new FK(this.joinInfo,this.clientId,n),this.httpRetryConfig=r,this._resolution=o}async startChannelMediaRelay(e){if(this.state!==Xx.RELAY_STATE_IDLE)throw new bk(jI.INVALID_OPERATION);this.state=Xx.RELAY_STATE_CONNECTING,await this.connect(),pk.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(e)}catch(e){if(e.data&&e.data.serverResponse&&"SetSourceChannel"===e.data.serverResponse.command)throw new bk(jI.CROSS_CHANNEL_FAILED_JOIN_SRC);if(e.data&&e.data.serverResponse&&"SetDestChannelStatus"===e.serverResponse.command)throw new bk(jI.CROSS_CHANNEL_FAILED_JOIN_DEST);if(e.data&&e.data.serverResponse&&"StartPacketTransfer"===e.serverResponse.command)throw new bk(jI.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST);throw e}this.prevChannelMediaConfig=e}async updateChannelMediaRelay(e){if(this.state!==Xx.RELAY_STATE_RUNNING)throw new bk(jI.INVALID_OPERATION);await this.sendUpdateMessage(e),this.prevChannelMediaConfig=e}async setVideoProfile(e){if(this._resolution=e,this.state!==Xx.RELAY_STATE_RUNNING)throw new bk(jI.INVALID_OPERATION);const t=this.genMessage(Yx.SetVideoProfile);await this.signal.request(t),pk.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),pk.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=Xx.RELAY_STATE_IDLE,this.dispose()}dispose(){pk.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=Xw.CancelToken.source(),this.state=Xx.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const e=await IF(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=e.workerToken,await this.signal.connect(e.addressList),this.emit("event",zx.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(e){const t=this.genMessage(Yx.StopPacketTransfer);await this.signal.request(t),await this.signal.waitStatus("Normal Quit"),pk.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const n=this.genMessage(Yx.SetSdkProfile,e);await this.signal.request(n),pk.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const r=this.genMessage(Yx.SetSourceChannel,e);await this.signal.request(r),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",zx.PACKET_JOINED_SRC_CHANNEL),pk.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const o=this.genMessage(Yx.SetSourceUserId,e);await this.signal.request(o),pk.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const i=this.genMessage(Yx.SetDestChannel,e);await this.signal.request(i),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",zx.PACKET_JOINED_DEST_CHANNEL),pk.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const a=this.genMessage(Yx.StartPacketTransfer,e);await this.signal.request(a),this.emit("event",zx.PACKET_SENT_TO_DEST_CHANNEL),this.state=Xx.RELAY_STATE_RUNNING,pk.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(e){const t=this.genMessage(Yx.UpdateDestChannel,e);await this.signal.request(t),this.emit("event",zx.PACKET_UPDATE_DEST_CHANNEL),pk.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const e=this.genMessage(Yx.StopPacketTransfer);await this.signal.request(e),pk.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(e,t){const n=[],r=[],o=[];this.requestId+=1;const i={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:wN,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};"4.23.1"===i.sdkVersion&&(i.sdkVersion="0.0.1");let a=null,s=null;switch(e){case Yx.SetSdkProfile:return i.clientRequest={command:"SetSdkProfile",type:"multi_channel"},i;case Yx.SetSourceChannel:if(s=t&&t.getSrcChannelMediaInfo(),!s)throw new bk(jI.UNEXPECTED_ERROR,"can not find source config");return i.clientRequest={command:"SetSourceChannel",uid:"0",channelName:s.channelName,token:s.token||this.joinInfo.appId},i;case Yx.SetSourceUserId:if(s=t&&t.getSrcChannelMediaInfo(),!s)throw new bk(jI.UNEXPECTED_ERROR,"can not find source config");return i.clientRequest={command:"SetSourceUserId",uid:s.uid+""},i;case Yx.SetDestChannel:if(a=t&&t.getDestChannelMediaInfo(),!a)throw new bk(jI.UNEXPECTED_ERROR,"can not find dest config");return a.forEach((e=>{n.push(e.channelName),r.push(e.uid+""),o.push(e.token||this.joinInfo.appId)})),i.clientRequest={command:"SetDestChannel",channelName:n,uid:r,token:o},i;case Yx.StartPacketTransfer:return i.clientRequest={command:"StartPacketTransfer"},i;case Yx.Reconnect:return i.clientRequest={command:"Reconnect"},i;case Yx.StopPacketTransfer:return i.clientRequest={command:"StopPacketTransfer"},i;case Yx.UpdateDestChannel:if(a=t&&t.getDestChannelMediaInfo(),!a)throw new bk(jI.UNEXPECTED_ERROR,"can not find dest config");return a.forEach((e=>{n.push(e.channelName),r.push(e.uid+""),o.push(e.token||this.joinInfo.appId)})),i.clientRequest={command:"UpdateDestChannel",channelName:n,uid:r,token:o},i;case Yx.SetVideoProfile:i.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return i}}const VK={name:"ChannelMediaRelay",create:function(e){return new BK(e.joinInfo,e.clientId,e.websocketRetryConfig||XA,e.httpRetryConfig||XA,e.resolution)}};function HK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function GK(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HK(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HK(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class WK extends eA{constructor(e,t,n,r){super(),OR(this,"spec",void 0),OR(this,"token",void 0),OR(this,"websocket",void 0),OR(this,"pingpongTimer",void 0),OR(this,"reconnectMode","retry"),OR(this,"serviceMode",void 0),OR(this,"reqId",0),OR(this,"commandReqId",0),OR(this,"handleWebSocketOpen",(()=>{this.reconnectMode="retry",this.startPingPong()})),OR(this,"handleWebSocketMessage",(e=>{if(!e.data)return;const t=JSON.parse(e.data);t.requestId?this.emit("@".concat(t.requestId,"-").concat(t.sid),t):(_k.workerEvent(this.spec.sid,{actionType:"status",serverCode:t.code,workerType:this.serviceMode===jx.TRANSCODE?1:2}),this.emit(Gx.PUBLISH_STREAM_STATUS,t))})),this.spec=t,this.token=e,this.serviceMode=r,this.websocket=new WU("live-streaming",n),this.websocket.on(Lx.CONNECTED,this.handleWebSocketOpen),this.websocket.on(Lx.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(Lx.REQUEST_NEW_URLS,((e,t)=>{mA(this,Gx.REQUEST_NEW_ADDRESS).then(e).catch(t)})),this.websocket.on(Lx.RECONNECTING,(()=>{this.websocket.reconnectMode=this.reconnectMode}))}init(e){return this.websocket.init(e)}async request(e,t,n,r){this.reqId+=1,"request"===e&&(this.commandReqId+=1);const o=this.commandReqId,i=this.reqId;if(!i||!this.websocket)throw new bk(jI.UNEXPECTED_ERROR);const a=GK({command:e,sdkVersion:"4.23.1"===wN?"0.0.1":wN,seq:i,requestId:i,allocate:n,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},t);if("closed"===this.websocket.state)throw new bk(jI.WS_DISCONNECT);const s=()=>new ih(((e,t)=>{this.websocket.once(Lx.CLOSED,(()=>t(new bk(jI.WS_ABORT)))),this.websocket.once(Lx.CONNECTED,e)}));"connected"!==this.websocket.state&&await s(),a.clientRequest&&(a.clientRequest.workerToken=this.token);const c=new ih(((e,t)=>{const n=()=>{t(new bk(jI.WS_ABORT))};this.websocket.once(Lx.RECONNECTING,n),this.websocket.once(Lx.CLOSED,n),this.once("@".concat(i,"-").concat(this.spec.sid),(t=>{e(t)}))}));r&&_k.workerEvent(this.spec.sid,GK(GK({},r),{},{requestId:o,actionType:"request",payload:JSON.stringify(t.clientRequest),serverCode:0,code:0}));const l=Date.now();this.websocket.sendMessage(a);let u=null;try{u=await c}catch(r){if("closed"===this.websocket.state)throw r;return await s(),await this.request(e,t,n)}return r&&_k.workerEvent(this.spec.sid,GK(GK({},r),{},{requestId:o,actionType:"response",payload:JSON.stringify(u.serverResponse),serverCode:u.code,success:200===u.code,responseTime:Date.now()-l})),200!==u.code&&this.handleResponseError(u),u}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const e="4.23.1"===wN?"0.0.1":wN;this.reqId+=1,"connected"===this.websocket.state?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:e,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(e){switch(e.code){case qx.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void pk.warning("live stream response already exists stream");case qx.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case qx.LIVE_STREAM_RESPONSE_BAD_STREAM:case qx.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new bk(jI.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:e.code}).throw();case qx.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if("UnpublishStream"===e.serverResponse.command)return;throw new bk(jI.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case qx.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new bk(jI.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:e.code}).throw();case qx.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const t=new bk(jI.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(Gx.WARNING,t,e.serverResponse.url)}case qx.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const t=new bk(jI.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(Gx.WARNING,t,e.serverResponse.url)}case qx.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new bk(jI.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case qx.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new bk(jI.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:e.code}).throw();case qx.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const t=new bk(jI.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(Gx.WARNING,t,e.serverResponse.url)}case qx.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new bk(jI.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code}).throw();case qx.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new bk(jI.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case qx.LIVE_STREAM_RESPONSE_WORKER_LOST:case qx.LIVE_STREAM_RESPONSE_WORKER_QUIT:if("UnpublishStream"===e.serverResponse.command)return;throw new bk(jI.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case qx.ERROR_FAIL_SEND_MESSAGE:if("UnpublishStream"===e.serverResponse.command)return;if("UpdateTranscoding"===e.serverResponse.command||"ControlStream"===e.serverResponse.command)return new bk(jI.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:e.code}).throw();throw new bk(jI.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case qx.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case qx.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case qx.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case qx.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new bk(jI.LIVE_STREAMING_CDN_ERROR,"",{code:e.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval((()=>{"connected"===this.websocket.state&&this.request("ping",{}).catch(UA)}),6e3)}}function qK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function KK(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qK(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qK(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class YK extends eA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:XA,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:XA;super(),OR(this,"onLiveStreamWarning",void 0),OR(this,"onLiveStreamError",void 0),OR(this,"spec",void 0),OR(this,"retryTimeout",1e4),OR(this,"connection",void 0),OR(this,"httpRetryConfig",void 0),OR(this,"wsRetryConfig",void 0),OR(this,"streamingTasks",new Map),OR(this,"isStartingStreamingTask",!1),OR(this,"taskMutex",new YA("live-streaming")),OR(this,"cancelToken",Xw.CancelToken.source()),OR(this,"transcodingConfig",void 0),OR(this,"uapResponse",void 0),OR(this,"lastTaskId",1),OR(this,"statusError",new Map),this.spec=e,this.httpRetryConfig=n,this.wsRetryConfig=t}async setTranscodingConfig(e){const t=KK(KK({},Hx),e);66!==t.videoCodecProfile&&77!==t.videoCodecProfile&&100!==t.videoCodecProfile&&(pk.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(t.videoCodecProfile," -> 100")),t.videoCodecProfile=100),t.transcodingUsers||(t.transcodingUsers=t.userConfigs),t.transcodingUsers&&(t.transcodingUsers=t.transcodingUsers.map((e=>KK(KK(KK({},Fx),e),{},{zOrder:e.zOrder?e.zOrder+1:1})))),function(e){KI(e.width)||HI(e.width,"config.width",0,1e4),KI(e.height)||HI(e.height,"config.height",0,1e4),KI(e.videoBitrate)||HI(e.videoBitrate,"config.videoBitrate",1,1e6),KI(e.videoFrameRate)||HI(e.videoFrameRate,"config.videoFrameRate"),KI(e.lowLatency)||BI(e.lowLatency,"config.lowLatency"),KI(e.audioSampleRate)||VI(e.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),KI(e.audioBitrate)||HI(e.audioBitrate,"config.audioBitrate",1,128),KI(e.audioChannels)||VI(e.audioChannels,"config.audioChannels",[1,2,3,4,5]),KI(e.videoGop)||HI(e.videoGop,"config.videoGop"),KI(e.videoCodecProfile)||VI(e.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),KI(e.userCount)||HI(e.userCount,"config.userCount",0,17),KI(e.backgroundColor)||HI(e.backgroundColor,"config.backgroundColor",0,16777215),KI(e.userConfigExtraInfo)||WI(e.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),e.transcodingUsers&&!KI(e.transcodingUsers)&&(qI(e.transcodingUsers,"config.transcodingUsers"),e.transcodingUsers.forEach(((e,t)=>{Ux(e.uid),KI(e.x)||HI(e.x,"transcodingUser[".concat(t,"].x"),0,1e4),KI(e.y)||HI(e.y,"transcodingUser[".concat(t,"].y"),0,1e4),KI(e.width)||HI(e.width,"transcodingUser[".concat(t,"].width"),0,1e4),KI(e.height)||HI(e.height,"transcodingUser[".concat(t,"].height"),0,1e4),KI(e.zOrder)||HI(e.zOrder-1,"transcodingUser[".concat(t,"].zOrder"),0,100),KI(e.alpha)||HI(e.alpha,"transcodingUser[".concat(t,"].alpha"),0,1,!1)}))),KI(e.watermark)||Vx(e.watermark,"watermark"),KI(e.backgroundImage)||Vx(e.backgroundImage,"backgroundImage"),e.images&&!KI(e.images)&&(qI(e.images,"config.images"),e.images.forEach(((e,t)=>{Vx(e,"images[".concat(t,"]"))})))}(t);const n=[];t.images&&n.push(...t.images.map((e=>KK(KK(KK({},Bx),e),{},{zOrder:255})))),t.backgroundImage&&(n.push(KK(KK(KK({},Bx),t.backgroundImage),{},{zOrder:0})),delete t.backgroundImage),t.watermark&&(n.push(KK(KK(KK({},Bx),t.watermark),{},{zOrder:255})),delete t.watermark),t.images=n,t.transcodingUsers&&(t.userConfigs=t.transcodingUsers.map((e=>KK({},e))),t.userCount=t.transcodingUsers.length,delete t.transcodingUsers);const r=(t.userConfigs||[]).map((e=>"number"==typeof e.uid?ih.resolve(e.uid):SF(e.uid,this.spec,this.cancelToken.token,this.httpRetryConfig)));if((await ih.all(r)).forEach(((e,n)=>{t.userConfigs&&t.userConfigs[n]&&(t.userConfigs[n].uid=e)})),this.transcodingConfig=t,this.connection)try{var o;const e=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(fh(o=this.streamingTasks).call(o)).map((e=>e.taskId)).join("#")});pk.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(e.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(e){if(!e.data||!e.data.retry)throw e;e.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach((t=>{pk.warning("[".concat(this.spec.clientId,"] live streaming receive error"),e.toString(),"try to republish",t.url),this.startLiveStreamingTask(t.url,t.mode,e).then((()=>{pk.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(t.url," success"))})).catch((e=>{pk.error("[".concat(this.spec.clientId,"] live streaming republish failed"),t.url,e.toString()),this.onLiveStreamError&&this.onLiveStreamError(t.url,e)}))}))}}async startLiveStreamingTask(e,t,n){if(!this.transcodingConfig&&t===jx.TRANSCODE)throw new bk(jI.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");const r={command:"PublishStream",ts:Date.now(),url:e,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};pk.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(e,", mode: ").concat(t));const o=await this.taskMutex.lock();if(!this.connection&&n)return void o();if(this.streamingTasks.get(e)&&!n)return o(),new bk(jI.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(t))}catch(e){throw o(),e}switch(t){case jx.TRANSCODE:r.transcodingConfig=KK({},this.transcodingConfig);case jx.RAW:}this.uapResponse&&this.uapResponse.vid&&(r.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const i=this.lastTaskId++;try{const a=new ih(((t,r)=>{MA(this.retryTimeout).then((()=>{if(n)return r(n);const t=this.statusError.get(e);return t?(this.statusError.delete(e),r(t)):void 0}))})),s=await ih.race([this.connection.request("request",{clientRequest:r},!0,{url:e,command:"PublishStream",workerType:t===jx.TRANSCODE?1:2,requestByUser:!n,tid:i.toString()}),a]);this.isStartingStreamingTask=!1,pk.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(s.code)),this.streamingTasks.set(e,{clientRequest:r,mode:t,url:e,taskId:i}),o()}catch(r){if(o(),this.isStartingStreamingTask=!1,!r.data||!r.data.retry||n)throw r;return r.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(e,t,r)):await this.startLiveStreamingTask(e,t,r)}}stopLiveStreamingTask(e){return new ih(((t,n)=>{const r=this.streamingTasks.get(e);if(!r||!this.connection)return new bk(jI.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const o=r.mode;r.abortTask=()=>{pk.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(e),t()},this.connection.request("request",{clientRequest:{command:"UnpublishStream",url:r.url}},!1,{url:e,command:"UnPublishStream",workerType:o===jx.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then((n=>{pk.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(n.code)),this.streamingTasks.delete(e),0===this.streamingTasks.size&&(this.connection&&this.connection.close(),this.connection=void 0),t()})).catch(n)}))}resetAllTask(){var e;const t=Array.from(fh(e=this.streamingTasks).call(e));this.terminate();for(const n of t)this.startLiveStreamingTask(n.url,n.mode).catch((e=>{this.onLiveStreamError&&this.onLiveStreamError(n.url,e)}))}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=Xw.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(e){if(this.connection)throw new bk(jI.UNEXPECTED_ERROR,"live streaming connection has already connected");const t=await mA(this,Wx.REQUEST_WORKER_MANAGER_LIST,e);return this.uapResponse=t,this.connection=new WK(t.workerToken,this.spec,this.wsRetryConfig,e),this.connection.on(Gx.WARNING,((e,t)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(t,e))),this.connection.on(Gx.PUBLISH_STREAM_STATUS,(e=>this.handlePublishStreamServer(e))),this.connection.on(Gx.REQUEST_NEW_ADDRESS,((t,n)=>{if(!this.connection)return n(new bk(jI.UNEXPECTED_ERROR,"can not get new live streaming address list"));mA(this,Wx.REQUEST_WORKER_MANAGER_LIST,e).then((e=>{this.uapResponse=e,t(e.addressList)})).catch(n)})),await this.connection.init(t.addressList),this.connection}handlePublishStreamServer(e){const t=e.serverStatus&&e.serverStatus.url||"empty_url",n=this.streamingTasks.get(t),r=e.reason;switch(e.code){case qx.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case qx.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case qx.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case qx.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const r=new bk(jI.LIVE_STREAMING_CDN_ERROR,"",{code:e.code});if(n)return pk.error(r.toString()),this.onLiveStreamError&&this.onLiveStreamError(t,r);if(!this.isStartingStreamingTask)return;this.statusError.set(t,r)}case qx.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const e=new bk(jI.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,r);return this.onLiveStreamWarning&&this.onLiveStreamWarning(t,e)}case qx.LIVE_STREAM_RESPONSE_WORKER_LOST:case qx.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var o;if(!this.connection)return;this.connection.tryNextAddress();const t=Array.from(fh(o=this.streamingTasks).call(o));for(const n of t)n.abortTask?n.abortTask():(pk.warning("[".concat(this.spec.clientId,"] publish stream status code"),e.code,"try to republish",n.url),this.startLiveStreamingTask(n.url,n.mode,new bk(jI.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code})).then((()=>{pk.debug("[".concat(this.spec.clientId,"] republish live stream success"),n.url)})).catch((e=>{pk.error(e.toString()),this.onLiveStreamError&&this.onLiveStreamError(n.url,e)})));return}}}hasUrl(e){return this.streamingTasks.has(e)}}const zK={name:"LiveStreaming",create:function(e){return new YK(e.joinInfo,e.websocketRetryConfig||XA,e.httpRetryConfig||XA)}};function XK(e){let t=aY();return function(e,t){let n=e.appId;void 0!==n&&(_Y(t,10),hY(t,n));let r=e.cid;void 0!==r&&(_Y(t,16),_Y(t,r));let o=e.cname;void 0!==o&&(_Y(t,26),hY(t,o));let i=e.deviceId;void 0!==i&&(_Y(t,34),hY(t,i));let a=e.elapse;void 0!==a&&(_Y(t,40),bY(t,a));let s=e.fileSize;void 0!==s&&(_Y(t,48),bY(t,oY(s)));let c=e.height;void 0!==c&&(_Y(t,56),bY(t,oY(c)));let l=e.jpg;void 0!==l&&(_Y(t,66),_Y(t,l.length),function(e,t){let n=uY(e,t.length);e.bytes.set(t,n)}(t,l));let u=e.networkType;void 0!==u&&(_Y(t,72),bY(t,oY(u)));let d=e.osType;void 0!==d&&(_Y(t,80),bY(t,oY(d)));let p=e.requestId;void 0!==p&&(_Y(t,90),hY(t,p));let h=e.sdkVersion;void 0!==h&&(_Y(t,98),hY(t,h));let f=e.sequence;void 0!==f&&(_Y(t,104),bY(t,oY(f)));let m=e.sid;void 0!==m&&(_Y(t,114),hY(t,m));let v=e.timestamp;void 0!==v&&(_Y(t,120),bY(t,v));let g=e.uid;void 0!==g&&(_Y(t,128),_Y(t,g));let E=e.vid;void 0!==E&&(_Y(t,136),_Y(t,E));let y=e.width;void 0!==y&&(_Y(t,144),bY(t,oY(y)));let _=e.service;void 0!==_&&(_Y(t,152),_Y(t,_));let b=e.callbackData;void 0!==b&&(_Y(t,162),hY(t,b));let T=e.jpgEncryption;void 0!==T&&(_Y(t,168),_Y(t,T));let S=e.requestType;void 0!==S&&(_Y(t,176),_Y(t,S));let O=e.scorePorn;void 0!==O&&(_Y(t,185),EY(t,O));let R=e.scoreSexy;void 0!==R&&(_Y(t,193),EY(t,R));let C=e.scoreNeutral;void 0!==C&&(_Y(t,201),EY(t,C));let w=e.scene;void 0!==w&&(_Y(t,208),_Y(t,w));let I=e.ossFilePrefix;void 0!==I&&(_Y(t,218),hY(t,I));let A=e.serviceVendor;if(void 0!==A)for(let N of A){_Y(t,226);let e=aY();QK(N,e),_Y(t,e.limit),fY(t,e),sY(e)}}(e,t),function(e){let t=e.bytes,n=e.limit;return t.length===n?t:t.subarray(0,n)}(t)}function JK(e){return function(e){let t={};e:for(;!lY(e);){let n=yY(e);switch(n>>>3){case 0:break e;case 1:t.code=yY(e);break;case 2:t.msg=pY(e,yY(e));break;case 3:{let n=$K(e);t.data=ZK(e),e.limit=n;break}default:eY(e,7&n)}}return t}({bytes:t=e,offset:0,limit:t.length});var t}function ZK(e){let t={};e:for(;!lY(e);){let n=yY(e);switch(n>>>3){case 0:break e;case 1:t.requestId=pY(e,yY(e));break;case 2:t.requestType=yY(e)>>>0;break;case 3:t.scorePorn=gY(e);break;case 4:t.scoreSexy=gY(e);break;case 5:t.scoreNeutral=gY(e);break;case 6:t.requestScene=yY(e)>>>0;break;case 7:t.scene=yY(e)>>>0;break;default:eY(e,7&n)}}return t}function QK(e,t){let n=e.service;void 0!==n&&(_Y(t,8),_Y(t,n));let r=e.vendor;void 0!==r&&(_Y(t,16),_Y(t,r));let o=e.token;void 0!==o&&(_Y(t,26),hY(t,o));let i=e.callbackUrl;void 0!==i&&(_Y(t,34),hY(t,i))}function $K(e){let t=yY(e),n=e.limit;return e.limit=e.offset+t,n}function eY(e,t){switch(t){case 0:for(;128&mY(e););break;case 2:cY(e,yY(e));break;case 5:cY(e,4);break;case 1:cY(e,8);break;default:throw new Error("Unimplemented type: "+t)}}let tY=new Float32Array(1);new Uint8Array(tY.buffer);let nY=new Float64Array(1),rY=new Uint8Array(nY.buffer);function oY(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let iY=[];function aY(){const e=iY.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}function sY(e){iY.push(e)}function cY(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function lY(e){return e.offset>=e.limit}function uY(e,t){let n=e.bytes,r=e.offset,o=e.limit,i=r+t;if(i>n.length){let t=new Uint8Array(2*i);t.set(n),e.bytes=t}return e.offset=i,i>o&&(e.limit=i),r}function dY(e,t){let n=e.offset;if(n+t>e.limit)throw new Error("Read past limit");return e.offset+=t,n}function pY(e,t){let n=dY(e,t),r=String.fromCharCode,o=e.bytes,i="\ufffd",a="";for(let s=0;s<t;s++){let e,c,l,u,d=o[s+n];128&d?192==(224&d)?s+1>=t?a+=i:(e=o[s+n+1],128!=(192&e)?a+=i:(u=(31&d)<<6|63&e,u<128?a+=i:(a+=r(u),s++))):224==(240&d)?s+2>=t?a+=i:(e=o[s+n+1],c=o[s+n+2],32896!=(49344&(e|c<<8))?a+=i:(u=(15&d)<<12|(63&e)<<6|63&c,u<2048||u>=55296&&u<=57343?a+=i:(a+=r(u),s+=2))):240==(248&d)?s+3>=t?a+=i:(e=o[s+n+1],c=o[s+n+2],l=o[s+n+3],8421504!=(12632256&(e|c<<8|l<<16))?a+=i:(u=(7&d)<<18|(63&e)<<12|(63&c)<<6|63&l,u<65536||u>1114111?a+=i:(u-=65536,a+=r(55296+(u>>10),56320+(1023&u)),s+=3))):a+=i:a+=r(d)}return a}function hY(e,t){let n=t.length,r=0;for(let a=0;a<n;a++){let e=t.charCodeAt(a);e>=55296&&e<=56319&&a+1<n&&(e=(e<<10)+t.charCodeAt(++a)-56613888),r+=e<128?1:e<2048?2:e<65536?3:4}_Y(e,r);let o=uY(e,r),i=e.bytes;for(let a=0;a<n;a++){let e=t.charCodeAt(a);e>=55296&&e<=56319&&a+1<n&&(e=(e<<10)+t.charCodeAt(++a)-56613888),e<128?i[o++]=e:(e<2048?i[o++]=e>>6&31|192:(e<65536?i[o++]=e>>12&15|224:(i[o++]=e>>18&7|240,i[o++]=e>>12&63|128),i[o++]=e>>6&63|128),i[o++]=63&e|128)}}function fY(e,t){let n=uY(e,t.limit),r=e.bytes,o=t.bytes;for(let i=0,a=t.limit;i<a;i++)r[i+n]=o[i]}function mY(e){return e.bytes[dY(e,1)]}function vY(e,t){let n=uY(e,1);e.bytes[n]=t}function gY(e){let t=dY(e,8),n=e.bytes;return rY[0]=n[t++],rY[1]=n[t++],rY[2]=n[t++],rY[3]=n[t++],rY[4]=n[t++],rY[5]=n[t++],rY[6]=n[t++],rY[7]=n[t++],nY[0]}function EY(e,t){let n=uY(e,8),r=e.bytes;nY[0]=t,r[n++]=rY[0],r[n++]=rY[1],r[n++]=rY[2],r[n++]=rY[3],r[n++]=rY[4],r[n++]=rY[5],r[n++]=rY[6],r[n++]=rY[7]}function yY(e){let t,n=0,r=0;do{t=mY(e),n<32&&(r|=(127&t)<<n),n+=7}while(128&t);return r}function _Y(e,t){for(t>>>=0;t>=128;)vY(e,127&t|128),t>>>=7;vY(e,t)}function bY(e,t){let n=t.low>>>0,r=(t.low>>>28|t.high<<4)>>>0,o=t.high>>>24,i=0===o?0===r?n<16384?n<128?1:2:n<1<<21?3:4:r<16384?r<128?5:6:r<1<<21?7:8:o<128?9:10,a=uY(e,i),s=e.bytes;switch(i){case 10:s[a+9]=o>>>7&1;case 9:s[a+8]=9!==i?128|o:127&o;case 8:s[a+7]=8!==i?r>>>21|128:r>>>21&127;case 7:s[a+6]=7!==i?r>>>14|128:r>>>14&127;case 6:s[a+5]=6!==i?r>>>7|128:r>>>7&127;case 5:s[a+4]=5!==i?128|r:127&r;case 4:s[a+3]=4!==i?n>>>21|128:n>>>21&127;case 3:s[a+2]=3!==i?n>>>14|128:n>>>14&127;case 2:s[a+1]=2!==i?n>>>7|128:n>>>7&127;case 1:s[a]=1!==i?128|n:127&n}}function TY(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const SY=new Map([["moderation",1],["supervise",2]]);class OY extends eA{get connectionState(){return this._connectionState}set connectionState(e){if(this._connectionState===e)return;const t=this._connectionState;this._connectionState=e,this.emit(EU.CONNECTION_STATE_CHANGE,t,e)}get inspectType(){return this._inspectType}set inspectType(e){var t;this._inspectMode=so(t=e.map((e=>SY.get(e)||0))).call(t,((e,t)=>e+t)),this._inspectType=e}get quality(){return this._quality}set quality(e){this._quality=e>1?1:e<.1?.1:e,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout((()=>{this.quality=this._quality/this.qualityRatio}),6e4))}constructor(e){super(),OR(this,"name","AgoraRTCVideoContentInspect"),OR(this,"_connectionState",vU.CONNECTING),OR(this,"_innerConnectionState",void 0),OR(this,"sequence",0),OR(this,"inspectStartTime",void 0),OR(this,"workerManagerConnection",void 0),OR(this,"workerConnection",void 0),OR(this,"workerMessageLengthLimit",void 0),OR(this,"inspectIntervalMinimum",void 0),OR(this,"qualityRatio",void 0),OR(this,"_connectInfo",void 0),OR(this,"_cancelTokenSource",Xw.CancelToken.source()),OR(this,"_retryConfig",void 0),OR(this,"wmSequence",0),OR(this,"inspectInterval",void 0),OR(this,"inspectTimer",null),OR(this,"ossFilePrefix",void 0),OR(this,"extraInfo",void 0),OR(this,"_inspectType",void 0),OR(this,"_inspectMode",void 0),OR(this,"_quality",1),OR(this,"qualityTimer",null),OR(this,"_inspectId",void 0),OR(this,"_needWorkUrlOnly",!1),OR(this,"inspectImage",(()=>{if(this.connectionState!==vU.CONNECTED)throw new bk(jI.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval((()=>{this.connectionState===vU.CONNECTED?this.requestToInspectImage():pk.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)}),this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()})),this._inspectId=LA(5,"inspect-"),this.workerMessageLengthLimit=UN("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=UN("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=UN("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=e.interval,this.ossFilePrefix=e.ossFilePrefix,this.extraInfo=e.extraInfo,this.inspectType=e.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new WU("worker-manager-"+this._inspectId,XA),this.on(EU.STATE_CHANGE,((e,t)=>{this._innerConnectionState=e,pk.debug("[".concat(this._inspectId,"] Inspect operation :").concat(gU[e]," ").concat(t||""))})),this.handleWorkerManagerEvents(),this.workerConnection=new WU("worker-"+this._inspectId,XA),this.handleWorkerEvents()}async init(e,t){this.emit(EU.STATE_CHANGE,gU.CONNECT_AP),this._connectInfo=e;const n=this._cancelTokenSource.token;return this._retryConfig=t,new ih(((r,o)=>{this.on(EU.CONNECTION_STATE_CHANGE,((e,t)=>{t===vU.CONNECTED&&r()})),this.requestAP(e,n,t).then((e=>{this.connectWorkerManager(e)})).catch((e=>{o(e)}))}))}async requestAP(e,t,n){const r=UN("WEBCS_DOMAIN").map((e=>"https://".concat(e,"/api/v1"))),o=await function(e,t,n,r){let{appId:o,areaCode:i,cname:a,sid:s,token:c,uid:l}=t;gF++;const u="image_moderation_api",d={service_name:u,json_body:JSON.stringify({appId:o,areaCode:i,cname:a,command:"allocateEdge",requestId:gF,seq:gF,sid:s,token:c,ts:Date.now(),uid:l+""})};let p,h,f=e[0];return ZA((async()=>{p=Date.now();const e=await Jj(f,{data:d,cancelToken:n,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(h=Date.now()-p,0!==e.code){const t=new bk(jI.UNEXPECTED_RESPONSE,"image inspect ap error, code"+e.code,{retry:!0,responseTime:h});throw pk.error(t.toString()),t}const t=JSON.parse(e.json_body);if(200!==t.code){const e=new bk(jI.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(t.code,", reason: ").concat(t.reason),{code:t.code,responseTime:h});throw pk.error(e.toString()),e}if(!t.servers||!Array.isArray(t.servers)||0===t.servers.length){const e=new bk(jI.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:t.code,responseTime:h});throw pk.error(e.toString()),e}const r=UN("VIDEO_INSPECT_WORKER_MANAGER_HOST"),o=UN("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:t.servers.map((e=>{let{address:t,wss:n}=e;if(t&&n)return"wss://".concat(t.replace(/\./g,"-"),".").concat(r,":").concat(o||n)})).filter((e=>!!e)),workerToken:t.workerToken,vid:t.vid,responseTime:h}}),((t,n)=>(_k.apworkerEvent(s,{success:!0,sc:200,serviceName:u,responseDetail:JSON.stringify(t.addressList),firstSuccess:0===n,responseTime:h,serverIp:e[n%e.length]}),!1)),((t,n)=>(_k.apworkerEvent(s,{success:!1,sc:t.data&&t.data.code||200,serviceName:u,responseTime:h,serverIp:e[n%e.length]}),!!(t.code!==jI.OPERATION_ABORTED&&t.code!==jI.UNEXPECTED_RESPONSE||t.data&&t.data.retry)&&(f=e[(n+1)%e.length],!0))),r)}(r,e,t,n);this.emit(EU.STATE_CHANGE,gU.AP_CONNECTED);const{addressList:i}=o;return this.wmSequence++,i}async connectWorkerManager(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._needWorkUrlOnly=t,this.emit(EU.STATE_CHANGE,gU.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(e,1e4)}async connectWorker(e){await this.workerConnection.init([e])}handleWorkerManagerEvents(){this.workerManagerConnection.on(Lx.CONNECTED,(async()=>{this.emit(EU.STATE_CHANGE,gU.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.23.1",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)})),this.workerManagerConnection.on(Lx.CLOSED,(()=>{this._innerConnectionState<gU.GET_WORKER_MANAGER_RESPONSE&&pk.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))})),this.workerManagerConnection.on(Lx.FAILED,(()=>{this._innerConnectionState<gU.GET_WORKER_MANAGER_RESPONSE&&pk.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))})),this.workerManagerConnection.on(Lx.RECONNECTING,(()=>{this._innerConnectionState<gU.GET_WORKER_MANAGER_RESPONSE&&pk.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))})),this.workerManagerConnection.on(Lx.ON_MESSAGE,(async e=>{this.emit(EU.STATE_CHANGE,gU.GET_WORKER_MANAGER_RESPONSE);const t=this.workerManagerConnection.url;this.workerManagerConnection.close();const n=JSON.parse(e.data);if(200!==n.code)throw pk.error("[".concat(this._inspectId,"] Unexpected code ").concat(n.code," from worker manager")),new bk(jI.UNEXPECTED_RESPONSE,"response code of worker is unexpected",n);if(!(n.serverResponse&&n.serverResponse.portWss&&t))throw pk.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(n))),new bk(jI.UNEXPECTED_RESPONSE,"response content of worker is unexpected",n);{const e=UN("VIDEO_INSPECT_WORKER_PORT")||n.serverResponse.portWss,r=t.replace(/:\d+\/?$/,":".concat(e));this.emit(EU.STATE_CHANGE,gU.CONNECT_WORKER,r),this._needWorkUrlOnly?this.emit(EU.REQUEST_NEW_WORKER_URL,r):await this.connectWorker(r)}})),this.workerManagerConnection.on(Lx.WILL_RECONNECT,((e,t,n)=>{n(e)})),this.workerManagerConnection.on(Lx.REQUEST_NEW_URLS,((e,t)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(e).catch(t)}))}handleWorkerEvents(){this.workerConnection.on(Lx.CONNECTED,(async()=>{this.emit(EU.STATE_CHANGE,gU.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=vU.CONNECTED})),this.workerConnection.on(Lx.ON_MESSAGE,(async e=>{if(e.data instanceof ArrayBuffer){const n=JK(new Uint8Array(e.data));if(UN("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&pk.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(n)),200===n.code){if(Array.isArray(this.inspectType)&&1===this.inspectType.length&&"supervise"===this.inspectType[0])return void this.emit(EU.INSPECT_RESULT,void 0,void 0);if(n.data&&n.data.scorePorn&&n.data.scoreSexy&&n.data.scoreNeutral){var t;const e={porn:n.data.scorePorn,sexy:n.data.scoreSexy,neutral:n.data.scoreNeutral},r=so(t=Object.keys(e)).call(t,((t,n)=>e[t]>e[n]?t:n),"porn"),o=Object.keys(e).find((e=>e===r));this.emit(EU.INSPECT_RESULT,o)}else this.emit(EU.INSPECT_RESULT,void 0,new bk(jI.UNEXPECTED_RESPONSE,n.code+"","There is an unexpected data on message"))}else this.emit(EU.INSPECT_RESULT,void 0,new bk(jI.UNEXPECTED_RESPONSE,n.code+"",n.msg))}else pk.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(EU.INSPECT_RESULT,void 0,new bk(jI.UNEXPECTED_RESPONSE,"invalid worker message type"))})),this.workerConnection.on(Lx.CLOSED,(()=>{this.connectionState=vU.CLOSED})),this.workerConnection.on(Lx.FAILED,(()=>{this.connectionState=vU.CLOSED})),this.workerConnection.on(Lx.RECONNECTING,(()=>{this.connectionState=this.connectionState===vU.CONNECTED?vU.RECONNECTING:vU.CONNECTING})),this.workerConnection.on(Lx.WILL_RECONNECT,((e,t,n)=>{"recover"===e&&n(e),n("tryNext")})),this.workerConnection.on(Lx.REQUEST_NEW_URLS,((e,t)=>{this.workerManagerConnection.close(),this.once(EU.REQUEST_NEW_WORKER_URL,(t=>{e([t])})),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then((e=>{this.connectWorkerManager(e,!0)})).catch((e=>{t(e)}))}))}async requestToInspectImage(){this.sequence++;const e=gA(this,EU.CLIENT_LOCAL_VIDEO_TRACK),t={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(e){if(!e.isPlaying)return void this.emit(EU.INSPECT_RESULT,void 0,new bk(jI.INVALID_OPERATION,"Only the track being played can be inspected"));const n=await this.generateRequestData(e,t);this.workerConnection.sendMessage(n,!0,!0)}else this.emit(EU.INSPECT_RESULT,void 0,new bk(jI.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(e,t){let{appId:n,cname:r,cid:o,vid:i,sid:a,uid:s}=t;const c=Date.now(),l=await e.getCurrentFrameImage("image/jpeg",this.quality),u=await tD(l,n,r),d=this.sequence+"-"+o+"-"+s+"-"+c+"-"+LA(12,""),p={appId:n,cid:o,cname:r,deviceId:"",elapse:(h=Number(c-this.inspectStartTime),{low:h|=0,high:h>>31,unsigned:h>=0}),fileSize:u.byteLength,jpgEncryption:2,height:l.height,width:l.width,jpg:u,networkType:6,osType:7,requestId:d,sdkVersion:"4.23.1",sequence:this.sequence,sid:a,timestamp:nH(c),uid:s,vid:i,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};var h;void 0===this.extraInfo&&delete p.callbackData,void 0===this.ossFilePrefix&&delete p.ossFilePrefix;const f=XK(p);if(f.byteLength<this.workerMessageLengthLimit){if(UN("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TY(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TY(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},p);delete e.jpg,pk.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(e))}return f}{const t=this.quality*this.qualityRatio;return this.quality=t,await this.generateRequestData(e,{appId:n,cname:r,cid:o,vid:i,sid:a,uid:s})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Xw.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=vU.CLOSED,this.emit(EU.STATE_CHANGE,gU.CLOSED)}}const RY={name:"ContentInspect",create:function(e){let{config:t}=e;return function(e){if(!e)throw new bk(jI.INVALID_PARAMS,"inspectConfig is necessary.");if(!e.inspectType||!Array.isArray(e.inspectType))throw new bk(jI.INVALID_PARAMS,"inspectConfig.inspectType is necessary and is an instance of Array.");{const t=[...new Set(e.inspectType)];t.forEach((e=>{var t;if(!Ur(t=["supervise","moderation"]).call(t,e))throw new bk(jI.INVALID_PARAMS,"".concat(e," is not a valid inspect type."))})),e.inspectType=t}if(e&&e.extraInfo&&e.extraInfo.length>1024)throw new bk(jI.INVALID_PARAMS,"inspectConfig.extraInfo length cannot exceed 1024 bytes")}(t),new OY(t)}};var CY=i(ne.Object.getOwnPropertySymbols),wY=Mn,IY=$n.indexOf,AY=Yr,NY=w([].indexOf),kY=!!NY&&1/NY([1],1,-0)<0;wY({target:"Array",proto:!0,forced:kY||!AY("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return kY?NY(this,e,t)||0:IY(this,e,t)}});var PY=rr("Array","indexOf"),DY=h,MY=PY,LY=Array.prototype,xY=function(e){var t=e.indexOf;return e===LY||DY(LY,e)&&t===LY.indexOf?MY:t},UY=i(xY);function jY(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=ex(e);for(r=0;r<i.length;r++)n=i[r],UY(t).call(t,n)>=0||(o[n]=e[n]);return o}(e,t);if(CY){var i=CY(e);for(r=0;r<i.length;r++)n=i[r],UY(t).call(t,n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}let FY=class{get localCapabilities(){return SA(this._localCapabilities)}get rtpCapabilities(){return SA(this._rtpCapabilities)}get candidates(){return SA(this._candidates)}get iceParameters(){return SA(this._iceParameters)}get dtlsParameters(){return SA(this._dtlsParameters)}constructor(e){OR(this,"sessionDesc",void 0),OR(this,"_localCapabilities",void 0),OR(this,"_rtpCapabilities",void 0),OR(this,"_candidates",void 0),OR(this,"_iceParameters",void 0),OR(this,"_dtlsParameters",void 0),OR(this,"setup",void 0),OR(this,"currentMidIndex",void 0),OR(this,"cname","o/i14u9pJrxRKAsu"),OR(this,"firefoxSsrcMidMap",new Map),e=SA(e);const{remoteIceParameters:t,remoteDtlsParameters:n,candidates:r,remoteRTPCapabilities:o,localCapabilities:i,direction:a,setup:s,videoCodec:c,audioCodec:l}=e;let u;this.setup=s,u=a===Mx.RECEIVE_ONLY?qN("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=extmap-allow-mixed\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n"):qN("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=extmap-allow-mixed\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=recvonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=recvonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n"),this._rtpCapabilities=o,this._candidates=r,this._iceParameters=t,this._dtlsParameters=n,this._localCapabilities=i;const d=a===Mx.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,p=a===Mx.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,h=a===Mx.RECEIVE_ONLY?o.send.videoCodecs:Nj(lU.VIDEO,d,p,c),f=a===Mx.RECEIVE_ONLY?o.send.audioCodecs:Nj(lU.AUDIO,d,p,l);for(const m of u.mediaDescriptions)m.attributes.iceUfrag=t.iceUfrag,m.attributes.icePwd=t.icePwd,m.attributes.fingerprints=n.fingerprints,m.attributes.candidates=r,m.attributes.setup=this.setup,"application"===m.media.mediaType&&(m.attributes.sctpPort="5000"),"video"===m.media.mediaType&&(m.media.fmts=h.map((e=>e.payloadType.toString(10))),m.attributes.payloads=h,m.attributes.extmaps=d.videoExtensions),"audio"===m.media.mediaType&&(m.media.fmts=f.map((e=>e.payloadType.toString(10))),m.attributes.payloads=f,m.attributes.extmaps=d.audioExtensions,Aj(m));this.sessionDesc=u,this.currentMidIndex=u.mediaDescriptions.length-1}toString(){return KN(this.sessionDesc)}hasMid(e){return Array.isArray(e)?e.every((e=>this.hasMid(e))):this.sessionDesc.mediaDescriptions.some((t=>t.attributes.mid===e))}send(e,t,n,r,o){n=n.replace(/ /g,"-");const{ssrcs:i,ssrcGroups:a}=Ej(t,this.cname,UN("SYNC_GROUP")?n:void 0),s=this.findPreloadMediaDesc(i);if(s){if(fI()&&this.firefoxSsrcMidMap.set(i[0].ssrcId,s.attributes.mid),o&&(o.twcc||o.remb)){const e=this.sessionDesc.mediaDescriptions.indexOf(s);return this.sessionDesc.mediaDescriptions[e]=this.mungSendMediaDesc(s,o),{mid:s.attributes.mid,needExchangeSDP:!0}}return{mid:s.attributes.mid,needExchangeSDP:!1}}{const t=this.findAvailableMediaIndex(e,i,r);let n;return-1===t?(n=this.createOrRecycleSendMedia(e,i,a,"sendonly",r,o),this.updateBundleMids()):(n=SA(this.sessionDesc.mediaDescriptions[t]),n.attributes.direction="sendonly",n.attributes.ssrcs=i,n.attributes.ssrcGroups=a,this.sessionDesc.mediaDescriptions[t]=this.mungSendMediaDesc(n,o)),fI()&&this.firefoxSsrcMidMap.set(i[0].ssrcId,n.attributes.mid),{needExchangeSDP:!0,mid:n.attributes.mid}}}stopSending(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>t.attributes.mid&&-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach((e=>{e.attributes.ssrcs=[]})),this.updateBundleMids()}receive(e,t,n){const r=[];return e.forEach((e=>{const o=e._mediaStreamTrack.kind,i=this.findAvailableRecvMediaIndex(o);let a,s=!1;-1===i?(s=!0,a=this.createOrRecycleRecvMedia(e,[],"recvonly",t,n),this.updateBundleMids()):(a=SA(this.sessionDesc.mediaDescriptions[i]),a.attributes.direction="recvonly"),r.push({mid:a.attributes.mid,needCreateTransceiver:s})})),r}stopReceiving(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach((e=>{e.media.port="0",e.attributes.direction="inactive"})),this.updateBundleMids()}addRemoteCandidate(e){const{foundation:t,protocol:n,address:r,port:o,type:i,relatedAddress:a,relatedPort:s,priority:c}=new RTCIceCandidate(e),l={foundation:null!=t?t:"",componentId:"1",transport:null!=n?n:"",priority:c?c+"":"",connectionAddress:null!=r?r:"",port:o?o+"":"",type:i?i+"":"",relAddr:null!=a?a:"",relPort:s?s+"":"",extension:{}};this.candidates.some((e=>e.priority===l.priority&&e.connectionAddress===l.connectionAddress&&e.port===l.port))||(this._candidates.push(l),this.sessionDesc.mediaDescriptions.forEach((e=>{e.attributes.candidates=this.candidates})))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(e,t,n,r,o){const i=e._mediaStreamTrack.kind,a=this.rtpCapabilities.recv,s=Nj(i,a,this.localCapabilities.send,i===lU.AUDIO?o:r),c=i===lU.VIDEO?a.videoExtensions:a.audioExtensions,l="".concat(++this.currentMidIndex);let u={media:{mediaType:i,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:s.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:c,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:s,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(l)}};u=this.mungRecvMediaDsec(u,e);const d=this.findFirstClosedMedia(i);if(d){const e=this.sessionDesc.mediaDescriptions.indexOf(d);this.sessionDesc.mediaDescriptions[e]=u}else this.sessionDesc.mediaDescriptions.push(u);return u}muteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>Ur(e).call(e,t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="inactive"}))}unmuteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>Ur(e).call(e,t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="recvonly"}))}findAvailableMediaIndex(e,t,n){return this.sessionDesc.mediaDescriptions.findIndex((r=>{const o=r.media.mediaType===e&&"0"!==r.media.port&&("sendonly"===r.attributes.direction||"sendrecv"===r.attributes.direction)&&0===r.attributes.ssrcs.length;if(fI()){if(o){const e=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(e||"0"!==r.attributes.mid&&"1"!==r.attributes.mid)||!(!e||e!==r.attributes.mid)}return!1}return o&&r.attributes.mid===n}))}findAvailableRecvMediaIndex(e){return this.sessionDesc.mediaDescriptions.findIndex((t=>{const n=t.media.mediaType===e&&"0"!==t.media.port&&("recvonly"===t.attributes.direction||"sendrecv"===t.attributes.direction);return"0"!==t.attributes.mid&&"1"!==t.attributes.mid&&n}))}predictReceivingMids(e){const t=[];for(let n=0;n<e;n++)t.push((this.currentMidIndex+n+1).toString(10));return t}restartICE(e){e=SA(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach((t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd}))}createOrRecycleSendMedia(e,t,n,r,o,i){const a=this.rtpCapabilities.send,s=e===lU.VIDEO?a.videoCodecs:a.audioCodecs,c=e===lU.VIDEO?a.videoExtensions:a.audioExtensions;fI()&&(o="".concat(++this.currentMidIndex));let l={media:{mediaType:e,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:s.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:c,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:n,rtcpFeedbackWildcards:[],payloads:s,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:o}};l=this.mungSendMediaDesc(l,i);const u=this.findFirstClosedMedia(e);if(u){const e=this.sessionDesc.mediaDescriptions.indexOf(u);this.sessionDesc.mediaDescriptions[e]=l}else this.sessionDesc.mediaDescriptions.push(l);return l}mungRecvMediaDsec(e,t,n){const r=SA(e);return _j(r),yj(r,t),bj(r,t),Tj(r),Sj(r,n,this.localCapabilities.send),r}mungSendMediaDesc(e,t){const n=SA(e);return Sj(n,t,this.localCapabilities.recv),Aj(n),n}updateRecvMedia(e,t){const n=this.sessionDesc.mediaDescriptions.findIndex((t=>t.attributes.mid===e));if(-1!==n){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],t);this.sessionDesc.mediaDescriptions[n]=e}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter((e=>"0"!==e.media.port)).map((e=>e.attributes.mid))}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find((t=>{var n;return(null===(n=t.attributes)||void 0===n||null===(n=n.ssrcs[0])||void 0===n?void 0:n.ssrcId)===e[0].ssrcId}))}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find((t=>fI()?"0"===t.media.port&&t.media.mediaType===e:"0"===t.media.port))}};const BY=["sdp"];var VY;function HY(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function GY(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HY(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HY(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let WY=(VY=class e extends sU{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var e,t;return null!==(e=null===(t=this.peerConnection.getReceivers()[0])||void 0===t||null===(t=t.transport)||void 0===t?void 0:t.state)&&void 0!==e?e:null}get localCodecs(){return[]}set isInRestartIce(e){this._isInRestartIce=e}get isInRestartIce(){return this._isInRestartIce}constructor(t,n,r){super(t,n),OR(this,"direction",void 0),OR(this,"name",void 0),OR(this,"store",void 0),OR(this,"spec",void 0),OR(this,"peerConnection",void 0),OR(this,"initialOffer",void 0),OR(this,"transport",void 0),OR(this,"statsFilter",void 0),OR(this,"localCandidateCount",0),OR(this,"_isInRestartIce",!1),OR(this,"mutex",void 0),OR(this,"onLocalCandidate",void 0),OR(this,"remoteSDP",void 0),OR(this,"pendingCandidates",[]),OR(this,"localCapabilities",void 0),OR(this,"isReady",!1),OR(this,"restartCnt",0),OR(this,"curTurnServerIndex",0),this.store=n,this.spec=t,this.mutex=new YA("P2PConnection-mutex",n.clientId),this.peerConnection=new RTCPeerConnection(e.resolvePCConfiguration(t,n.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=null!=r?r:Mx.SEND_ONLY,this.name=this.direction===Mx.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=ON(this.peerConnection,UN("STATS_UPDATE_INTERVAL"),void 0,fI()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(e){try{const t=await Rj();if(this.localCapabilities=Ij(t),e){const{sdp:t}=e,n=jY(e,BY),r=function(){const e={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},t=hj(arguments.length>2?arguments[2]:void 0,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"sendonly"),n={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},o={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(wj(t,e,"videoExtensions",n,r,o),wj(t,e,"videoCodecs",n,r,o),wj(t,e,"audioExtensions",n,r,o),wj(t,e,"audioCodecs",n,r,o),UN("RAISE_H264_BASELINE_PRIORITY")){const e=o.videoCodecs.findIndex((e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"===e.fmtp.parameters["profile-level-id"]));if(-1!==e){const t=o.videoCodecs.findIndex((e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()));if(t<e){pk.debug("raising H264 baseline profile priority");const n=o.videoCodecs[e];o.videoCodecs.splice(e,1),o.videoCodecs.splice(t,0,n)}-1!==t&&UN("FILTER_SEND_H264_BASELINE")&&(n.videoCodecs=n.videoCodecs.filter((e=>!(e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"!==e.fmtp.parameters["profile-level-id"]))))}}return{send:n,recv:r,sendrecv:o}}({},{},t);this.remoteSDP=new FY({remoteIceParameters:n.iceParameters,remoteDtlsParameters:n.dtlsParameters,candidates:[],remoteRTPCapabilities:r,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const o=await this.peerConnection.createAnswer();if(!o.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const i=fj(o.sdp);await this.peerConnection.setLocalDescription(o);const a=await Cj({},{},o.sdp);this.localCapabilities=Ij(a);const s=this.peerConnection.getTransceivers()[0];return null!=s&&s.receiver&&s.receiver.transport&&this.tryBindTransportEvents(s.receiver.transport),GY(GY({},i),{},{sdp:o.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const e=await this.peerConnection.createOffer();if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=fj(e.sdp);return this.initialOffer=e,GY(GY({},t),{},{sdp:e.sdp})}}catch(e){throw new FI(jI.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:t,iceParameters:n,dtlsParameters:r}=e,o=await Cj({},{},t);this.remoteSDP=new FY({remoteIceParameters:n,remoteDtlsParameters:r,candidates:[],remoteRTPCapabilities:o,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const i=this.peerConnection.getTransceivers()[0];null!=i&&i.sender&&i.sender.transport&&this.tryBindTransportEvents(i.sender.transport)}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}async addRemoteCandidate(e){try{e&&this.pendingCandidates.push(e),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach((e=>{this.peerConnection.addIceCandidate(e)})),this.pendingCandidates=[])}catch(e){throw new FI(jI.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(e.toString()))}}send(e,t,n){var r=this;return cw((function*(){const o=yield lw(r.mutex.lock("From P2PConnection.send"));try{if(!r.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const o=[],i=r.remoteSDP.receive(e,t,n);e.forEach(((e,t)=>{if(i[t].needCreateTransceiver){const t=r.peerConnection.addTransceiver(e._mediaStreamTrack,{direction:"sendonly"});o.push(t),e._updateRtpTransceiver(t)}else{const n=r.peerConnection.getTransceivers().find((e=>e.mid===i[t].mid));if(!n)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(i[t].mid));o.push(n),e._updateRtpTransceiver(n)}})),fI()&&!0===UN("SIMULCAST")&&(yield lw(r.applySimulcastForFirefox(o,e)));const a=i.map((e=>e.mid)),s=yield lw(r.peerConnection.createOffer()),c=r.mungSendOfferSDP(s.sdp,e,a),l=qN(c),u=a.map((e=>{const t=l.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("Cannot extract ssrc from mediaDescription.");return mj(t,UN("USE_PUB_RTX"))})),d=o.map(((e,t)=>{const n=a[t];return{localSSRC:u[t],id:n}}));yield lw(r.peerConnection.setLocalDescription({type:"offer",sdp:c}));try{yield d}catch(e){const n=r.remoteSDP.toString();throw yield lw(r.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield lw(r.peerConnection.setRemoteDescription({type:"answer",sdp:n})),yield lw(r.stopSending(a,!0)),e}yield lw(r.applySimulcastEncodings(o,e)),yield lw(r.applySendEncodings(o,e));const p=r.remoteSDP.toString(),h=r.logSDPExchange(c,"offer","local","send");return null==h||h(p),yield lw(r.setRemoteDescription({type:"answer",sdp:p})),o.map(((e,t)=>{const n=a[t];return{localSSRC:u[t],id:n}}))}catch(e){throw e instanceof FI?e:new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{o()}}))()}async stopSending(e,t){const n=t?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const t=this.peerConnection.getTransceivers().filter((t=>-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length (".concat(t.length,") doesn't match mids' length (").concat(e.length,") when trying to call P2PConnection.stopSending."));t.map((e=>{var t;e.direction="inactive",null===(t=e.stop)||void 0===t||t.call(e)}));const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(n),this.remoteSDP.stopReceiving(e);const o=this.remoteSDP.toString();null==r||r(o),await this.setRemoteDescription({type:"answer",sdp:o})}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}finally{n&&n()}}async receive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:o,needExchangeSDP:i}=this.remoteSDP.send(e,t,n,r);if(i){const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer(),i=this.mungReceiveAnswerSDP(r.sdp,o,e);null==n||n(i||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:i}),pk.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP."))}else pk.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," no need to exchange SDP."));const a=this.peerConnection.getTransceivers().find((e=>e.mid===o));if(!a||null===a.mid)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:a.receiver.track,mid:a.mid,transceiver:a}}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async mockReceive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:o,needExchangeSDP:i}=this.remoteSDP.send(e,t,n,r);if(i){const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer(),i=this.mungReceiveAnswerSDP(r.sdp,o,e);null==n||n(i||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:i}),pk.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP."))}else pk.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," no need to exchange SDP."))}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async restartICE(t){try{if(this.store.p2pTransport===AN.Auto&&(this.store.p2pTransport=AN.SdRtn,Sk().supportPCSetConfiguration&&this.peerConnection.setConfiguration(e.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,Sk().supportPCSetConfiguration&&this.peerConnection.setConfiguration(e.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!t){this.restartCnt++,this.isReady=!1;const e=await this.peerConnection.createOffer({iceRestart:!0});if(!e.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:t}=fj(e.sdp);return this.store.descriptionStart(),this.direction===Mx.SEND_ONLY&&await this.peerConnection.setLocalDescription(e),t}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(t),this.store.descriptionStart(),this.direction===Mx.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const e=await this.peerConnection.createAnswer();if(!e.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:t}=fj(e.sdp);return await this.peerConnection.setLocalDescription(e),t}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}close(){var e;this.peerConnection.close(),this.peerConnection.onicecandidate=null,null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const n=await this.peerConnection.createOffer(),r=this.mungSendOfferSDP(n.sdp,[t],[e]);this.remoteSDP.updateRecvMedia(e,t);const o=this.remoteSDP.toString(),i=this.logSDPExchange(r,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:r}),null==i||i(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const n=this.peerConnection.getTransceivers().filter((t=>t.mid===e));1===n.length&&(this.isVP8Simulcast(t)?fI()||await this.applySimulcastEncodings(n,[t]):await this.applySendEncodings(n,[t]))}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const n=this.peerConnection.getTransceivers().find((e=>e.mid===t));n&&await n.sender.replaceTrack(e._mediaStreamTrack)}async getSelectedCandidatePair(){const e=this.peerConnection.getReceivers();if(e.length>0&&e[0].transport&&e[0].transport.iceTransport&&e[0].transport.iceTransport.getSelectedCandidatePair&&e[0].transport.iceTransport.getSelectedCandidatePair()){const t=e[0].transport.iceTransport,{local:n,remote:r}=t.getSelectedCandidatePair();return{local:GY(GY({},cN),{},{candidateType:n.type,protocol:n.protocol,address:n.address,port:n.port}),remote:GY(GY({},cN),{},{candidateType:r.type,protocol:r.protocol,address:r.address,port:r.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e,t;Ur(e=["connected","completed"]).call(e,this.peerConnection.iceConnectionState)&&(this.isReady=!1),null===(t=this.onICEConnectionStateChange)||void 0===t||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;"connected"===this.peerConnection.connectionState&&(this.restartCnt=0),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=e=>{var t;e.candidate?(e.candidate.candidate&&(null===(t=this.onLocalCandidate)||void 0===t||t.call(this,e.candidate.toJSON())),this.localCandidateCount+=1):pk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o={iceServers:[]};var i;return t.iceServers?o.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(cA(t.turnServer.servers)?o.iceServers=t.turnServer.servers:(o.iceServers&&o.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.servers,n,r)),UN("USE_TURN_SERVER_OF_GATEWAY")&&o.iceServers&&t.turnServer.serversFromGateway&&o.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.serversFromGateway,n,r)),Ur(i=[AN.Relay,AN.SdRtn]).call(i,n)&&(o.iceTransportPolicy="relay"),UN("FORCE_TURN_TCP")?o.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach((e=>{e.forceturn&&(o.iceTransportPolicy="relay")})))),UN("ENABLE_ENCODED_TRANSFORM")&&Sk().supportWebRTCEncodedTransform&&(o.encodedInsertableStreams=!0),pk.debug("P2PConnection p2pTransport is ".concat(n)),o}static turnServerConfigToIceServers(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=[],o=e.filter((e=>e.tcpport));pk.debug("P2PConnection turnServers is ".concat(o,", current index is ").concat(n));const i=o.length>n?o[n]:o[0];switch(t){case AN.SdRtn:const t=e.filter((e=>{var t;return Ur(t=e.username).call(t,"glb:")&&e.turnServerURL==e.turnServerURL})),o=t.length>n?t[n]:t[0];o&&(r.push({username:o.username,credential:o.password,credentialType:"password",urls:"turn:".concat(JU(o.turnServerURL),":").concat(o.tcpport,"?transport=udp")}),r.push({username:o.username,credential:o.password,credentialType:"password",urls:"turns:".concat(JU(o.turnServerURL),":").concat(o.tcpport,"?transport=tcp")}));break;case AN.Relay:i&&(r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(i.turnServerURL,":").concat(i.tcpport,"?transport=udp")}),r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turns:".concat(JU(i.turnServerURL),":").concat(i.tcpport,"?transport=tcp")}));break;default:i&&(r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(i.turnServerURL,":").concat(i.tcpport,"?transport=udp")}),r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turns:".concat(JU(i.turnServerURL),":").concat(i.tcpport,"?transport=tcp")}),r.push({username:i.username,credential:i.password,credentialType:"password",urls:"stun:".concat(i.turnServerURL,":").concat(i.tcpport)}))}return r}tryBindTransportEvents(e){if(e){this.transport=e,e.onstatechange=()=>{var t;null!=e&&e.state&&(null===(t=this.onDTLSTransportStateChange)||void 0===t||t.call(this,e.state))},e.onerror=e=>{var t;null===(t=this.onDTLSTransportError)||void 0===t||t.call(this,"error"in e?e.error:e)};const t=e.iceTransport;t&&(t.onstatechange=()=>{const t=null==e?void 0:e.iceTransport.state;var n;t&&(null===(n=this.onICETransportStateChange)||void 0===n||n.call(this,t))},t.getSelectedCandidatePair&&(t.onselectedcandidatepairchange=()=>{if(t.getSelectedCandidatePair()){const{local:e,remote:n}=t.getSelectedCandidatePair();pk.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:e.type,protocol:e.protocol}),", remote ").concat(JSON.stringify({candidateType:n.type,protocol:n.protocol,address:n.address,port:n.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(e,t){var n;if(t||(t=this.peerConnection.getSenders().find((t=>t.track===e._mediaStreamTrack))),!t)return pk.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(e))return pk.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!Sk().supportSetRtpSenderParameters)return pk.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const r={},o={};switch(e._optimizationMode){case"motion":r.degradationPreference="maintain-framerate";break;case"detail":r.degradationPreference="maintain-resolution";break;default:r.degradationPreference="balanced"}if(e._encoderConfig){var i;const{bitrateMax:t,frameRate:n,scaleResolutionDownBy:r}=e._encoderConfig;t&&(o.maxBitrate=1e3*t),Ur(i=e._hints).call(i,Hk.LOW_STREAM)&&(n&&(o.maxFramerate=QU(n)),r&&r>=1&&(o.scaleResolutionDownBy=r))}if(UN("DSCP_TYPE")&&PI()){var a;const e=UN("DSCP_TYPE");Ur(a=["very-low","low","medium","high"]).call(a,e)&&(o.networkPriority=e)}const s=t.getParameters(),c=null===(n=s.encodings)||void 0===n?void 0:n[0];fI()&&!c&&(r.encodings=[o]),c&&Object.assign(c,o),Object.assign(s,r),pk.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(s.encodings))),await t.setParameters(s)}async applySendEncodings(e,t){try{if(!Sk().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let n=0;n<e.length;n++){const r=e[n],o=t[n];o instanceof DM&&!this.isVP8Simulcast(o)&&await this.updateRtpSenderEncodings(o,r.sender)}}catch(e){pk.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,t,n){const r=qN(e);return t.forEach(((e,t)=>{const o=n[t],i=r.mediaDescriptions.find((e=>e.attributes.mid===o));i&&(yj(i,e),Oj(i,e,this.store.codec))})),KN(r)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,n)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,e,t,n)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedLocalCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedRemoteCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onFirstVideoDecodedTimeout=e=>{var t;null===(t=this.onFirstVideoDecodedTimeout)||void 0===t||t.call(this,e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(e,t){if(e.length===t.length)for(let s=0;s<e.length;s++){var n,r,o,i,a;const c=e[s],l=t[s];if(l instanceof DM&&!Ur(n=l._hints).call(n,Hk.LOW_STREAM)&&null!==(r=l._encoderConfig)&&void 0!==r&&r.bitrateMax&&(null===(o=l._encoderConfig)||void 0===o?void 0:o.bitrateMax)>200&&null!==(i=l._scalabilityMode)&&void 0!==i&&i.numSpatialLayers&&(null===(a=l._scalabilityMode)||void 0===a?void 0:a.numSpatialLayers)>1&&"vp8"===this.store.codec){const e={},t={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};e.encodings=[{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:t.high}];const n=c.sender.getParameters();await c.sender.setParameters(Object.assign(n,e))}}}async applySimulcastEncodings(e,t){if(!fI()&&e.length===t.length)for(let n=0;n<e.length;n++){const r=t[n];if(r instanceof DM&&this.isVP8Simulcast(r)){const t=e[n],o={},i={high:1e3*(r._encoderConfig.bitrateMax-50),medium:5e4};o.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:i.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:i.medium,scaleResolutionDownBy:4}];const a=t.sender.getParameters();await t.sender.setParameters(Object.assign(a,o))}}}isVP8Simulcast(e){var t,n,r,o,i;return!!(e instanceof DM&&UN("SIMULCAST")&&"vp8"===this.store.codec&&!Ur(t=e._hints).call(t,Hk.LOW_STREAM)&&null!==(n=e._encoderConfig)&&void 0!==n&&n.bitrateMax&&(null===(r=e._encoderConfig)||void 0===r?void 0:r.bitrateMax)>200&&null!==(o=e._scalabilityMode)&&void 0!==o&&o.numSpatialLayers&&(null===(i=e._scalabilityMode)||void 0===i?void 0:i.numSpatialLayers)>1)}logSDPExchange(e,t,n,r){if(UN("SDP_LOGGING"))return pk.upload("[".concat(this.store.clientId,"] exchanging ").concat(n," ").concat(t," SDP during P2PConnection.").concat(r,"\n"),e),"offer"===t?e=>{this.logSDPExchange(e,"answer","local"===n?"remote":"local",r)}:void 0}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((e=>{e.direction="inactive"}));const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.muteRemote(e);const o=this.remoteSDP.toString();null==r||r(o),await this.setRemoteDescription({type:"answer",sdp:o})}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((async e=>{e.direction="sendonly"}));const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.unmuteRemote(e);const o=this.remoteSDP.toString();null==r||r(o),await this.setRemoteDescription({type:"answer",sdp:o})}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}async getRemoteSSRC(e,t){var n,r;if(t=null!==(n=t)&&void 0!==n?n:null===(r=this.currentRemoteDescription)||void 0===r?void 0:r.sdp){var o;const n=null===(o=qN(t).mediaDescriptions.find((t=>t.attributes.mid===e)))||void 0===o?void 0:o.attributes.ssrcs;return null==n?void 0:n[0].ssrcId}}async setRemoteDescription(e){var t;await this.peerConnection.setRemoteDescription(e),Ur(t=["connected","completed"]).call(t,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(e,t,n){const r=qN(e),o=r.mediaDescriptions.find((e=>e.attributes.mid===t));return o&&n===lU.AUDIO&&"audio"===o.media.mediaType&&Aj(o),KN(r)}},Sx(VY.prototype,"establish",[qY],Object.getOwnPropertyDescriptor(VY.prototype,"establish"),VY.prototype),Sx(VY.prototype,"connect",[qY],Object.getOwnPropertyDescriptor(VY.prototype,"connect"),VY.prototype),Sx(VY.prototype,"receive",[qY],Object.getOwnPropertyDescriptor(VY.prototype,"receive"),VY.prototype),Sx(VY.prototype,"mockReceive",[qY],Object.getOwnPropertyDescriptor(VY.prototype,"mockReceive"),VY.prototype),Sx(VY.prototype,"stopReceiving",[qY],Object.getOwnPropertyDescriptor(VY.prototype,"stopReceiving"),VY.prototype),Sx(VY.prototype,"restartICE",[qY],Object.getOwnPropertyDescriptor(VY.prototype,"restartICE"),VY.prototype),Sx(VY.prototype,"close",[qY],Object.getOwnPropertyDescriptor(VY.prototype,"close"),VY.prototype),Sx(VY.prototype,"updateEncoderConfig",[qY],Object.getOwnPropertyDescriptor(VY.prototype,"updateEncoderConfig"),VY.prototype),Sx(VY.prototype,"updateSendParameters",[qY],Object.getOwnPropertyDescriptor(VY.prototype,"updateSendParameters"),VY.prototype),Sx(VY.prototype,"replaceTrack",[qY],Object.getOwnPropertyDescriptor(VY.prototype,"replaceTrack"),VY.prototype),Sx(VY.prototype,"muteLocal",[qY],Object.getOwnPropertyDescriptor(VY.prototype,"muteLocal"),VY.prototype),Sx(VY.prototype,"unmuteLocal",[qY],Object.getOwnPropertyDescriptor(VY.prototype,"unmuteLocal"),VY.prototype),VY);function qY(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("From P2PConnection.".concat(t));try{for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return await r.apply(this,i)}finally{n()}},n}let KY=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({});var YY,zY,XY,JY,ZY,QY,$Y,ez,tz,nz,rz,oz;function iz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function az(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iz(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iz(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let sz=(YY=cz(KY.SEND_ONLY),zY=cz(KY.SEND_ONLY),XY=cz(),JY=cz(KY.RECEIVE_ONLY),ZY=cz(KY.RECEIVE_ONLY),QY=cz(KY.RECEIVE_ONLY),$Y=cz(KY.RECEIVE_ONLY),ez=cz(KY.RECEIVE_ONLY),tz=cz(KY.RECEIVE_ONLY),nz=cz(),rz=cz(KY.RECEIVE_ONLY),oz=class extends eA{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(mU.StateChange,t,this._state)}constructor(e,t){super(),OR(this,"isPlanB",!1),OR(this,"store",void 0),OR(this,"statsUploader",void 0),OR(this,"sendConnection",void 0),OR(this,"recvConnection",void 0),OR(this,"localTrackMap",new Map),OR(this,"remoteUserMap",new Map),OR(this,"localDataChannels",[]),OR(this,"pendingLocalTracks",[]),OR(this,"pendingRemoteTracks",[]),OR(this,"statsCollector",void 0),OR(this,"dtlsFailedCount",0),OR(this,"sendMutex",void 0),OR(this,"recvMutex",void 0),OR(this,"_state",fU.Disconnected),OR(this,"_restartStates",["disconnected","failed"]),OR(this,"reconnectInterval",void 0),OR(this,"uploadUnplinkStarted",!1),OR(this,"uploadDownlinkStarted",!1),OR(this,"uplinkStateUploadInterval",void 0),OR(this,"downlinkStatsUploadInterval",void 0),OR(this,"handleMuteLocalTrack",(async(e,t,n)=>{const r=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==fU.Connected)return void n(new FI(jI.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const r=this.filterTobeMutedTracks(e);if(0===r.length)return void t();const a=r.find((e=>"videoLowTrack"===e[0]));a&&a[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(r.map((e=>{let[,{id:t}]=e;return t})));let s=!1;var o,i;s="video"===e.trackMediaType?!(null===(o=this.localTrackMap.get(hU.LocalAudioTrack))||void 0===o||!o.track._muted):void 0===(null===(i=this.localTrackMap.get(hU.LocalVideoTrack))||void 0===i?void 0:i.id);const c=this.createMuteMessage(r);await vA(this,mU.RequestMuteLocal,c);const l="video"===e.trackMediaType?CU.MUTE_LOCAL_VIDEO:CU.MUTE_LOCAL_AUDIO;await vA(this,mU.RequestP2PMuteLocal,{action:l,message:c,isMuteAll:s}),t()}catch(e){n(e)}finally{r()}})),OR(this,"handleUnmuteLocalTrack",(async(e,t,n)=>{const r=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==fU.Connected)return void n(new FI(jI.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const r=this.filterTobeUnmutedTracks(e);if(0===r.length)return void t();await this.sendConnection.unmuteLocal(r.map((e=>{let[,{id:t}]=e;return t})));const o=this.createUnmuteMessage(r),i="video"===e.trackMediaType?CU.UNMUTE_LOCAL_VIDEO:CU.UNMUTE_LOCAL_AUDIO;await vA(this,mU.RequestP2PMuteLocal,{action:i,message:o}),t()}catch(e){n(e)}finally{r()}})),OR(this,"handleUpdateVideoEncoder",(async(e,t,n,r)=>{let o;"boolean"==typeof r&&r||(o=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoEncoder"));try{const n=this.localTrackMap.get(hU.LocalVideoTrack);if(!this.sendConnection||!n||n.track!==e||this.state!==fU.Connected)return void t();const{id:r,track:o}=n;r&&(await this.sendConnection.updateSendParameters(r,o),await this.sendConnection.updateEncoderConfig(r,o),this.emit(mU.UpdateVideoEncoder,o)),t()}catch(e){n(e)}finally{var i;null===(i=o)||void 0===i||i()}})),OR(this,"handleUpdateVideoSendParameters",(async(e,t,n)=>{const r=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{const n=this.localTrackMap.get(hU.LocalVideoTrack);if(!this.sendConnection||!n||n.track!==e||this.state!==fU.Connected)return void t();const{id:r,track:o}=n;r&&await this.sendConnection.updateSendParameters(r,o),t()}catch(e){n(e)}finally{r()}})),OR(this,"handleReplaceTrack",(async(e,t,n,r)=>{let o;pk.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(e.getTrackId(),"]")),"boolean"==typeof r&&r||(o=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var i;const n=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(!this.sendConnection||!n||void 0===n[1].id||this.state!==fU.Connected)return void t();if(await(null===(i=this.sendConnection)||void 0===i?void 0:i.replaceTrack(e,n[1].id)),n[0]===hU.LocalVideoTrack&&Sk().supportDualStreamEncoding){const t=this.localTrackMap.get(hU.LocalVideoLowTrack);if(t){const n=e._mediaStreamTrack.clone();t.track._originMediaStreamTrack.stop(),t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n,await new ih(((e,n)=>{this.handleReplaceTrack(t.track,e,n,!0)}))}}t()}catch(e){n(e)}finally{var a;null===(a=o)||void 0===a||a()}})),OR(this,"handleGetLocalVideoStats",(e=>{e(this.statsCollector.getLocalVideoTrackStats())})),OR(this,"handleGetLocalAudioStats",(e=>{e(this.statsCollector.getLocalAudioTrackStats())})),OR(this,"handleGetRemoteVideoStats",(e=>this.statsCollector.getRemoteVideoTrackStats(e.uid)[e.uid])),OR(this,"handleGetRemoteAudioStats",(e=>this.statsCollector.getRemoteAudioTrackStats(e.uid)[e.uid])),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new LB(e),this.bindStatsUploaderEvents(),this.sendMutex=new YA("P2PChannel2-send-mutex",e.clientId),this.recvMutex=new YA("P2PChannel2-recv-mutex",e.clientId),this.reconnectInterval=window.setInterval((()=>{[this.sendConnection,this.recvConnection].forEach((e=>{e&&("disconnected"!==e.iceConnectionState&&"failed"!==e.iceConnectionState||this.handleDisconnect(e.direction))}))}),UN("ICE_RESTART_INTERVAL"))}async startP2PConnection(e,t){throw new FI(jI.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(e){throw new FI(jI.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(e,t){let n;try{if(t){this.recvConnection&&(pk.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),n=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new WY(e,this.store,Mx.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const r=await this.recvConnection.establish(t);return{iceParameters:r.iceParameters,dtlsParameters:r.dtlsParameters,sdp:r.sdp}}{this.state=fU.New,this.sendConnection&&(pk.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),n=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new WY(e,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const t=await this.sendConnection.establish();return{iceParameters:t.iceParameters,dtlsParameters:t.dtlsParameters,sdp:t.sdp}}}finally{n&&n()}}async p2pConnect(e){if(!this.sendConnection)throw new FI(jI.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=fU.Connected}async addRemoteCandidate(e,t){if(t===Mx.RECEIVE_ONLY){if(!this.sendConnection)throw new FI(jI.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(e)}else{if(!this.recvConnection)throw new FI(jI.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(e)}}publish(e,t,n){var r=this;return cw((function*(){const o=yield lw(r.sendMutex.lock("From P2PChannel.publish"));try{if(!r.sendConnection||r.state!==fU.Connected){r.throwIfTrackTypeNotMatch(e);const t=e.filter((e=>-1===r.pendingLocalTracks.indexOf(e)));return void(r.pendingLocalTracks=r.pendingLocalTracks.concat(t))}r.store.pubId=r.store.pubId+1,LF.markPublishStart(r.store.clientId,r.store.pubId);const o=r.filterTobePublishedTracks(e,t,n);if(0===o.length)return void(yield lw(r.tryToUnmuteAudio(e)));o.forEach((e=>{let{track:t,type:n}=e;const o=Date.now();r.store.publish(t.getTrackId(),n===hU.LocalAudioTrack?"audio":"video",o)})),r.bindLocalTrackEvents(o);const i=yield lw(r.sendConnection.send(o.map((e=>{let{track:t}=e;return t})),r.store.codec,r.store.audioCodec)),a=(yield lw(i.next())).value,s=r.createGatewayPublishMessage(o,a);try{yield s}catch(e){throw i.throw(e),(null==e?void 0:e.code)===jI.WS_ABORT&&o.forEach((e=>{let{track:t}=e;-1===r.pendingLocalTracks.indexOf(t)&&r.pendingLocalTracks.push(t)})),r.unbindLocalTrackEvents(o),e}yield lw(i.next()),o.forEach((e=>{let{type:t}=e;r.statsCollector.addLocalStats(t)})),r.statsUploader.startUploadOutboundStats(),r.assignLocalTracks(o,a),o.forEach((e=>{let{track:t,type:n}=e;const o=Date.now();r.store.publish(t.getTrackId(),n===hU.LocalAudioTrack?"audio":"video",void 0,o)})),r.startUploadUplinkState()}finally{o()}}))()}async unpublish(e){if(!this.sendConnection||this.state!==fU.Connected)return void(0===e.length?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter((t=>!Ur(e).call(e,t))));const t=this.filterTobeUnpublishedTracks(e);if(0===t.length)return;const n=t.find((e=>"videoLowTrack"===e[0]));n&&n[1].track.close();const r=this.createGatewayUnpublishMessage(t);if(await this.sendConnection.stopSending(t.map((e=>{let[,{id:t}]=e;return t}))),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map((e=>{let[t,{track:n}]=e;return{type:t,track:n}}))),t.forEach((e=>{let[t]=e;this.statsCollector.removeLocalStats(t)})),0===this.localTrackMap.size&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===fU.Connected)return n&&n[1].track.close(),r;e.forEach((e=>{const t=this.pendingLocalTracks.indexOf(e);-1!==t&&this.pendingLocalTracks.splice(t,1)}))}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const e=()=>{const e=[],t=[];Array.from(this.localTrackMap.entries()).forEach((n=>{let[r,{track:o,ssrcs:i}]=n;const a={stream_type:aB(o,r),ssrcs:i};o._muted||!o._enabled?e.push(a):t.push(a)})),e.length>0&&e.forEach((e=>{vA(this,mU.RequestMuteLocal,[e])})),t.length>0&&t.forEach((e=>{vA(this,mU.RequestUnmuteLocal,[e])}))};e(),this.uplinkStateUploadInterval=window.setInterval((()=>{e()}),3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(e){return cw((function*(){throw new FI(jI.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")}))()}async republish(){this.pendingLocalTracks.length>0&&(pk.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await mA(this,mU.RequestRePublish,this.pendingLocalTracks),this.emit(mU.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new FI(jI.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(e,t,n,r){var o;if(!this.recvConnection)throw new FI(jI.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if(null!==(o=this.remoteUserMap.get(e))&&void 0!==o&&o.has(t))return;const{track:i,mid:a,transceiver:s}=await this.recvConnection.receive(t,[{ssrcId:n}],String(e.uid),r);t===lU.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(i):(e._audioTrack=new JM(i,e.uid,e._uintid,this.store),pk.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),s&&e._audioTrack._updateRtpTransceiver(s),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoSSRC=n,e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(i):(e._videoTrack=new XM(i,e.uid,e._uintid,this.store),pk.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),s&&e._videoTrack._updateRtpTransceiver(s),this.bindRemoteTrackEvents(e,e._videoTrack));const c=this.remoteUserMap.get(e);c?c.set(t,a):this.remoteUserMap.set(e,new Map([[t,a]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const l=this.pendingRemoteTracks.findIndex((n=>{let{user:r,kind:o}=n;return r.uid===e.uid&&t===o}));-1!==l&&(this.pendingRemoteTracks.splice(l,1),this.emit(mU.MediaReconnectEnd,e.uid))}async mockSubscribe(e,t,n,r){if(!this.recvConnection)throw new FI(jI.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(t,[{ssrcId:n}],String(e.uid),r)}async unsubscribe(e,t,n){const r=this.pendingRemoteTracks.filter((n=>{let{user:r,kind:o}=n;return void 0!==t?r.uid===e.uid&&t===o:r.uid===e.uid}));if(r.forEach((e=>{const t=this.pendingRemoteTracks.indexOf(e);this.pendingRemoteTracks.splice(t,1)})),this.recvConnection||n||r.forEach((t=>{let{kind:n}=t;var r;if(n===lU.AUDIO)null===(r=e._audioTrack)||void 0===r||r._destroy(),e._audioTrack=void 0;else if(n===lU.VIDEO){var o;null===(o=e._videoTrack)||void 0===o||o._destroy(),e._videoTrack=void 0}})),!this.recvConnection)return;const o=this.filterTobeUnSubscribedTracks(e,t);0!==o.length&&(await this.recvConnection.stopReceiving(o.map((e=>{let[,{id:t}]=e;return t}))),this.withdrawRemoteTracks(o),0===this.remoteUserMap.size&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),o.forEach((e=>{let[t,{kind:r}]=e;var o,i;if(r===lU.VIDEO&&t._videoSSRC&&(null===(o=this.recvConnection)||void 0===o||o.setStatsRemoteVideoIsReady(t._videoSSRC,!1)),r===lU.VIDEO)this.unbindRemoteTrackEvents(t._videoTrack),n||(null===(i=t._videoTrack)||void 0===i||i._destroy(),t._videoTrack=void 0);else if(r===lU.AUDIO){var a;this.unbindRemoteTrackEvents(t._audioTrack),n||(null===(a=t._audioTrack)||void 0===a||a._destroy(),t._audioTrack=void 0)}})),o.forEach((e=>{let[,{kind:t}]=e;vA(this,mU.RequestP2PMuteRemote,t)})))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const e=()=>Array.from(this.remoteUserMap.entries()).forEach((e=>{let[,t]=e;[lU.VIDEO,lU.AUDIO].forEach((e=>{t.has(e)?vA(this,mU.RequestP2PUnmuteRemote,e):vA(this,mU.RequestP2PMuteRemote,e)}))}));e(),this.downlinkStatsUploadInterval=window.setInterval((()=>{e()}),3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(e){throw new FI(jI.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(e){throw new FI(jI.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(e){throw new FI(jI.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(e){throw new FI(jI.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(e,t){if(!this.recvConnection)return;const n=this.remoteUserMap.get(e);if(!n)return void pk.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid,"."));if(!n.get(t))return void pk.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));const r=t===lU.VIDEO?e._videoSSRC:e._audioSSRC;void 0!==r&&this.recvConnection.setStatsRemoteVideoIsReady(r,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.recvConnection)return;const n=this.remoteUserMap.get(e);n?n.get(t)||pk.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,".")):pk.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid,"."))}getAllTracks(e){const t=this.localTrackMap.get(hU.LocalAudioTrack);if((null==t?void 0:t.track)instanceof YD){const n=t.track;return Array.from(this.localTrackMap.entries()).filter((e=>{let[t]=e;return t!==hU.LocalAudioTrack})).filter((t=>{let[n]=t;return!(e&&n===hU.LocalVideoLowTrack)})).map((e=>{let[,{track:t}]=e;return t})).concat(n.trackList)}return Array.from(this.localTrackMap.entries()).filter((t=>{let[n]=t;return!(e&&n===hU.LocalVideoLowTrack)})).map((e=>{let[,{track:t}]=e;return t}))}reportPublishEvent(e,t,n,r,o){if(e){const n=this.localTrackMap.get(hU.LocalAudioTrack),i=r?this.localTrackMap.get(hU.LocalVideoLowTrack):this.localTrackMap.get(hU.LocalVideoTrack);_k.publish(this.store.sessionId,{eventElapse:LF.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==n?void 0:n.track.getTrackLabel(),videoName:null==i?void 0:i.track.getTrackLabel(),screenshare:-1!==(null==i?void 0:i.track._hints.indexOf(Hk.SCREEN_TRACK)),audio:!!n,video:!!i,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:o})}else{var i;n||(n=[]);const a=n.find((e=>e instanceof WD)),s=r?null===(i=this.localTrackMap.get(hU.LocalVideoTrack))||void 0===i?void 0:i.track:n.find((e=>e instanceof DM));_k.publish(this.store.sessionId,{eventElapse:LF.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==a?void 0:a.getTrackLabel(),videoName:null==s?void 0:s.getTrackLabel(),screenshare:-1!==(null==s?void 0:s._hints.indexOf(Hk.SCREEN_TRACK)),audio:!!a,video:!!s,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:o})}}reportSubscribeEvent(e,t,n,r){const o=r===lU.VIDEO?n._videoSSRC:n._audioSSRC;o&&_k.subscribe(this.store.sessionId,{succ:e,ec:t,video:r===lU.VIDEO,audio:r===lU.AUDIO,peerid:n.uid,subscribeRequestid:r===lU.VIDEO?n._videoSSRC:n._audioSSRC,p2pid:this.store.p2pId,eventElapse:LF.measureFromSubscribeStart(this.store.clientId,o)})}reset(){pk.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new YA("P2PChannel2-send-mutex",this.store.clientId),this.sendMutex=new YA("P2PChannel2-recv-mutex",this.store.clientId),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(hU.LocalAudioTrack);if((null==e?void 0:e.track)instanceof YD){if(e.track.trackList.length>0){const t=e.track;e.track.trackList.forEach((e=>{t.removeAudioTrack(e)}))}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=fU.Disconnected}getStats(e){var t,n;return e?null===(n=this.recvConnection)||void 0===n?void 0:n.getStats():null===(t=this.sendConnection)||void 0===t?void 0:t.getStats()}getRemoteVideoIsReady(e){var t;return(null===(t=this.recvConnection)||void 0===t?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(hU.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(hU.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof DM||t&&t.track instanceof WD?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}getRemoteMedia(e){var t;const n=Array.from(tk(t=this.remoteUserMap).call(t)).find((t=>t.uid===e));return n?{audioTrack:n.audioTrack,audioSSRC:n._audioSSRC,videoTrack:n.videoTrack,videoSSRC:n._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map((e=>{let[t]=e;return{uid:t.uid,level:t.audioTrack?100*t.audioTrack._source.getAccurateVolumeLevel():0}}));const t=this.localTrackMap.get(hU.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=Xy(e).call(e,((e,t)=>e.level-t.level)),e}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(pk.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=fU.Reconnecting,UN("KEEP_LAST_FRAME")&&0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t]=e;var n;t._videoTrack&&t._videoTrack._player&&(null===(n=t._videoTrack._player.getVideoElement())||void 0===n||n.pause(),t._videoTrack._player.isKeepLastFrame=!0,t._videoTrack._originMediaStreamTrack.stop())})),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,0!==this.localTrackMap.size&&(Array.from(this.localTrackMap.entries()).forEach((e=>{var t;let[n,{track:r}]=e;switch(n){case hU.LocalVideoTrack:Ur(t=r._hints).call(t,Hk.LOW_STREAM)?r.close():this.pendingLocalTracks.push(r);break;case hU.LocalAudioTrack:r instanceof YD?this.pendingLocalTracks=this.pendingLocalTracks.concat(r.trackList):this.pendingLocalTracks.push(r);case hU.LocalVideoLowTrack:}})),this.emit(mU.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t,n]=e;Array.from(tk(n).call(n)).forEach((e=>{this.setPendingRemoteMedia(t,e)})),this.emit(mU.MediaReconnectStart,t.uid)})),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),pk.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(e,t){for(const n of this.pendingRemoteTracks){const{user:r,kind:o}=n;if((e instanceof VF?e.uid:e)===r.uid&&t===o)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}async restartICE(e,t){let n,r;if(e===Mx.SEND_ONLY){if(!this.sendConnection)throw new FI(jI.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");n=await this.sendMutex.lock("From P2PChannel.restartICE"),r=this.sendConnection}else{if(!this.recvConnection)throw new FI(jI.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");n=await this.recvMutex.lock("From P2PChannel.restartICE"),r=this.recvConnection}try{if(t){const e=await r.restartICE(t);return r.isInRestartIce=!1,e}{const e=await r.restartICE();if(e){const t=await mA(this,mU.RequestP2PRestartICE,{direction:Mx.RECEIVE_ONLY,iceParameter:e});await r.restartICE(t),r.isInRestartIce=!1}}}finally{n()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const e=this.sendConnection.getStats(),t=this.localTrackMap.get(hU.LocalVideoTrack),n=this.localTrackMap.get(hU.LocalAudioTrack),r=e.videoSend.find((e=>{var n;return e.ssrc===(null==t||null===(n=t.ssrcs)||void 0===n?void 0:n[0].ssrcId)})),o=e.audioSend.find((e=>{var t;return e.ssrc===(null==n||null===(t=n.ssrcs)||void 0===t?void 0:t[0].ssrcId)}));if(!r||!o)return 1;const i=gA(this,mU.NeedSignalRTT),a=r?r.rttMs:void 0,s=o?o.rttMs:void 0,c=a&&s?(a+s)/2:a||s,l=(c&&i?(c+i)/2:c||i)||0,u=100*e.sendPacketLossRate*.7/50+.3*l/1500,d=u<.17?1:u<.36?2:u<.59?3:u<.1?4:5,p=null==t?void 0:t.track;if(p&&p._encoderConfig&&-1===p._hints.indexOf(Hk.SCREEN_TRACK)){const t=p._encoderConfig.bitrateMax,n=e.bitrate.actualEncoded;if(t&&n){const e=(1e3*t-n)/(1e3*t);return xL[e<.15?0:e<.3?1:e<.45?2:e<.6?3:4][d]}}return d}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const e=this.recvConnection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach((n=>{let[r]=n;const o=r._audioSSRC,i=r._videoSSRC,a=e.audioRecv.find((e=>e.ssrc===o)),s=e.videoRecv.find((e=>e.ssrc===i));if(!a&&!s)return void(t+=1);const c=gA(this,mU.NeedSignalRTT),l=e.rtt,u=(l&&c?(l+c)/2:l||c)||0,d=a?a.jitterMs:void 0,p=e.recvPacketLossRate;let h=.7*p*100/50+.3*u/1500;d&&(h=.6*p*100/50+.2*u/1500+.2*d/400),t+=h<.1?1:h<.17?2:h<.36?3:h<.59?4:5})),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new ih(((t,n)=>{this.handleMuteLocalTrack(e,t,n)}))}filterTobePublishedTracks(e,t,n){const r=[],o=Sk(),i=this.getAllTracks();e=bA(e=e.filter((e=>-1===i.indexOf(e))));let a=!1,s=!1;for(const c of e){if(c instanceof DM&&(this.localTrackMap.has(hU.LocalVideoTrack)||a?new FI(jI.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(r.push({track:c,type:hU.LocalVideoTrack}),a=!0),t)){const e=this.getLowVideoTrack(c,n);r.push({track:e,type:hU.LocalVideoLowTrack})}if(c instanceof WD){const e=this.localTrackMap.get(hU.LocalAudioTrack);if(e){if(!(e.track instanceof YD))throw new FI(jI.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(c._bypassWebAudio)throw new FI(jI.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(c),this.bindLocalAudioTrackEvents(c,!0)}else if(s){const e=r.find((e=>{let{type:t}=e;return t===hU.LocalAudioTrack}));if(!(e.track instanceof YD))throw new FI(jI.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(c._bypassWebAudio)throw new FI(jI.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(c)}else{if(!o.webAudioMediaStreamDest||c instanceof YD||c._bypassWebAudio)r.push({track:c,type:hU.LocalAudioTrack});else{const e=new YD;e.addAudioTrack(c),r.push({track:e,type:hU.LocalAudioTrack})}s=!0}}}return r}filterTobeUnpublishedTracks(e){const t=[],n=this.getAllTracks();e=bA(e=e.filter((e=>-1!==n.indexOf(e))));for(const r of e){if(r instanceof WD){const e=this.localTrackMap.get(hU.LocalAudioTrack);if(!e)continue;e.track instanceof YD?(e.track.removeAudioTrack(r),this.unbindLocalAudioTrackEvents(r),0===e.track.trackList.length&&(t.push([hU.LocalAudioTrack,e]),e.track.close())):t.push([hU.LocalAudioTrack,e])}if(r instanceof DM){const e=this.localTrackMap.get(hU.LocalVideoTrack);if(!e)continue;t.push([hU.LocalVideoTrack,e]);const n=this.localTrackMap.get(hU.LocalVideoLowTrack);n&&t.push([hU.LocalVideoLowTrack,n])}}return t}bindLocalTrackEvents(e){e.forEach((e=>{let{track:t,type:n}=e;switch(n){case hU.LocalVideoTrack:t.addListener(Vk.GET_STATS,this.handleGetLocalVideoStats),t.addListener(Vk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(Vk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(Vk.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.addListener(Vk.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),t.addListener(Vk.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.addListener(Vk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(Vk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case hU.LocalAudioTrack:this.bindLocalAudioTrackEvents(t);case hU.LocalVideoLowTrack:}}))}bindLocalAudioTrackEvents(e,t){e instanceof YD?e.trackList.forEach((e=>{e.addListener(Vk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(Vk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(Vk.GET_STATS,this.handleGetLocalAudioStats),e.addListener(Vk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(Vk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)})):(e.addListener(Vk.GET_STATS,this.handleGetLocalAudioStats),e.addListener(Vk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(Vk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(Vk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(Vk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||e.addListener(Vk.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map((e=>{let[t,{track:n}]=e;return{track:n,type:t}}))),e.forEach((e=>{let{track:t,type:n}=e;switch(n){case hU.LocalVideoTrack:t.off(Vk.GET_STATS,this.handleGetLocalVideoStats),t.off(Vk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(Vk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(Vk.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.off(Vk.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),t.off(Vk.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(Vk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(Vk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case hU.LocalAudioTrack:this.unbindLocalAudioTrackEvents(t);case hU.LocalVideoLowTrack:}}))}unbindLocalAudioTrackEvents(e){e instanceof YD?e.trackList.forEach((e=>{e.off(Vk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(Vk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(Vk.GET_STATS,this.handleGetLocalAudioStats),e.off(Vk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(Vk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)})):(e.off(Vk.GET_STATS,this.handleGetLocalAudioStats),e.off(Vk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(Vk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(Vk.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(Vk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(Vk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof XM&&t.addListener(Vk.GET_STATS,(t=>{t(this.handleGetRemoteVideoStats(e))})),t instanceof JM&&t.addListener(Vk.GET_STATS,(t=>{t(this.handleGetRemoteAudioStats(e))}))}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(Vk.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t,n]=e;n.has(lU.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),n.has(lU.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)}))}createGatewayPublishMessage(e,t){return e.map(((e,n)=>{var r;let o,{track:i,type:a}=e;switch(a){case hU.LocalAudioTrack:o=Zx.Audio;break;case hU.LocalVideoTrack:o=Ur(r=i._hints).call(r,Hk.SCREEN_TRACK)?Zx.Screen:Zx.High;break;case hU.LocalVideoLowTrack:o=Zx.Low}return{kind:a===hU.LocalAudioTrack?lU.AUDIO:lU.VIDEO,stream_type:o,mid:t[n].id,ssrcs:t[n].localSSRC,isMuted:i.muted||!i.enabled}}))}createGatewayUnpublishMessage(e){return e.map((e=>{var t;let n,[r,{track:o,ssrcs:i,id:a}]=e;switch(r){case hU.LocalVideoTrack:n=Ur(t=o._hints).call(t,Hk.SCREEN_TRACK)?Zx.Screen:Zx.High;break;case hU.LocalAudioTrack:n=Zx.Audio;break;case hU.LocalVideoLowTrack:n=Zx.Low}return{stream_type:n,ssrcs:i,mid:a}}))}assignLocalTracks(e,t){e.forEach(((e,n)=>{let{track:r,type:o}=e;this.localTrackMap.set(o,{track:r,id:t[n].id,ssrcs:t[n].localSSRC})}))}withdrawLocalTracks(e){e.forEach((e=>{let[t]=e;this.localTrackMap.delete(t)}))}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{var n;pk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(e.name,".onConnectionStateChange(").concat(t,")")),this.emit(mU.PeerConnectionStateChange,t),"connected"!==t||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),"connected"===t&&(e.isInRestartIce=!1),Ur(n=this._restartStates).call(n,t)&&!e.isInRestartIce&&("disconnected"===t&&await MA(800),"disconnected"!==e.iceConnectionState&&"failed"!==e.iceConnectionState||this.handleDisconnect(e.direction))},e.onICEConnectionStateChange=e=>{"connected"!==e||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),pk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(e,")")),_k.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:e,tag:oA.TRACER}).onSuccess(),this.emit(mU.IceConnectionStateChange,e)},e.onICETransportStateChange=e=>{pk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(e,")"))},e.onDTLSTransportStateChange=e=>{pk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(e,")"))},e.onDTLSTransportError=e=>{pk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(e,")"))},e.onFirstAudioDecoded=e=>{var t;const n=Array.from(tk(t=this.remoteUserMap).call(t)).find((t=>t._audioSSRC===e));var r;n&&(this.store.subscribe(n.uid,"audio",void 0,void 0,void 0,Date.now()),null===(r=n.audioTrack)||void 0===r||r.emit(zk.FIRST_FRAME_DECODED),_k.firstRemoteFrame(this.store.sessionId,vk.FIRST_AUDIO_DECODE,gk.FIRST_AUDIO_DECODE,{peer:n._uintid,subscribeElapse:LF.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=e=>{var t;const n=Array.from(tk(t=this.remoteUserMap).call(t)).find((t=>t._audioSSRC===e));n&&_k.firstRemoteFrame(this.store.sessionId,vk.FIRST_AUDIO_RECEIVED,gk.FIRST_AUDIO_RECEIVED,{peer:n._uintid,subscribeElapse:LF.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(e,t,n)=>{this.reportVideoFirstFrameDecoded(e,t,n)},e.onFirstVideoReceived=e=>{var t;const n=Array.from(tk(t=this.remoteUserMap).call(t)).find((t=>t._videoSSRC===e));n&&_k.firstRemoteFrame(this.store.sessionId,vk.FIRST_VIDEO_RECEIVED,gk.FIRST_VIDEO_RECEIVED,{peer:n._uintid,subscribeElapse:LF.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(e,t)=>{const n="relay"===e.candidateType,r="relay"===t.candidateType;"unknown"!==t.candidateType&&n===r||this.emit(mU.ConnectionTypeChange,n),pk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(oj(t))," -> ").concat(JSON.stringify(oj(e)),")"))},e.onSelectedRemoteCandidateChanged=(e,t)=>{pk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(oj(t))," -> ").concat(JSON.stringify(oj(e)),")"))},e.onFirstVideoDecodedTimeout=e=>{this.reportVideoFirstFrameDecoded(e,void 0,void 0,!0)},e.onLocalCandidate=t=>{this.emit(mU.LocalCandidate,{candidate:t,direction:e.direction})}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.onLocalCandidate=void 0}async handleDisconnect(e){const t=e===Mx.SEND_ONLY?this.sendConnection:this.recvConnection;t&&!t.isInRestartIce&&(t.isInRestartIce=!0,pk.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(t.name,"] start use restartICE")),e===Mx.SEND_ONLY?this.restartICE(e):mA(this,mU.RequestP2PRestartICE,{direction:Mx.SEND_ONLY}))}filterTobeMutedTracks(e){const t=[];if(-1===this.getAllTracks().indexOf(e))return t;const n=this.localTrackMap.get(hU.LocalAudioTrack);if(e instanceof WD&&(null==n?void 0:n.track)instanceof YD)return n.track.isActive||t.push([hU.LocalAudioTrack,n]),t;const r=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(r&&(t.push(r),r[0]===hU.LocalVideoTrack)){const e=this.localTrackMap.get(hU.LocalVideoLowTrack);e&&t.push([hU.LocalVideoLowTrack,e])}return t}filterTobeUnmutedTracks(e){const t=[],n=this.localTrackMap.get(hU.LocalAudioTrack);if(e instanceof WD&&(null==n?void 0:n.track)instanceof YD)return n.track.isActive&&t.push([hU.LocalAudioTrack,n]),t;const r=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(r)if(r[0]===hU.LocalVideoTrack){t.push(r);const e=this.localTrackMap.get(hU.LocalVideoLowTrack);e&&t.push([hU.LocalVideoLowTrack,e])}else t.push(r);return t}createMuteMessage(e){return e.map((e=>{var t;let n,[r,{track:o,ssrcs:i,id:a}]=e;switch(r){case hU.LocalAudioTrack:n=Zx.Audio;break;case hU.LocalVideoTrack:n=Ur(t=o._hints).call(t,Hk.SCREEN_TRACK)?Zx.Screen:Zx.High;break;case hU.LocalVideoLowTrack:n=Zx.Low}return{stream_type:n,ssrcs:i,mid:a}}))}createUnmuteMessage(e){return e.map((e=>{var t;let n,[r,{track:o,ssrcs:i,id:a}]=e;switch(r){case hU.LocalAudioTrack:n=Zx.Audio;break;case hU.LocalVideoTrack:n=Ur(t=o._hints).call(t,Hk.SCREEN_TRACK)?Zx.Screen:Zx.High;break;case hU.LocalVideoLowTrack:n=Zx.Low}return{stream_type:n,ssrcs:i,mid:a}}))}filterTobeUnSubscribedTracks(e,t){const n=[],r=this.remoteUserMap.get(e);if(!r)return n;if(t){const o=r.get(t);if(!o)return n;n.push([e,{kind:t,id:o}])}else Array.from(r.entries()).forEach((t=>{let[r,o]=t;n.push([e,{kind:r,id:o}])}));return n}createUnsubscribeMessage(e){const t=[];return e.forEach((e=>{let[n,{kind:r,id:o}]=e;switch(r){case lU.VIDEO:return void(n._videoSSRC&&t.push({stream_type:lU.VIDEO,ssrcId:n._videoSSRC}));case lU.AUDIO:return void(n._audioSSRC&&t.push({stream_type:lU.AUDIO,ssrcId:n._audioSSRC}))}})),t}withdrawRemoteTracks(e){e.forEach((e=>{let[t,{kind:n}]=e;const r=this.remoteUserMap.get(t);r&&(r.delete(n),0===Array.from(r.entries()).length&&this.remoteUserMap.delete(t))}))}async updateBitrateLimit(e){const t=this.localTrackMap.get(hU.LocalVideoTrack),n=this.localTrackMap.get(hU.LocalVideoLowTrack);t&&(await t.track.setBitrateLimit(e.uplink),await new ih(((e,n)=>{this.handleUpdateVideoEncoder(t.track,e,n,!0)}))),n&&e.low_stream_uplink&&(await n.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0}),await new ih(((e,t)=>{this.handleUpdateVideoEncoder(n.track,e,t,!0)})))}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const e=this.sendConnection.peerConnectionState,t=this.recvConnection.peerConnectionState;return"connected"!==e&&"connected"!==t}return!0}async tryToUnmuteAudio(e){for(let t=0;t<e.length;t++)if(e[t]instanceof WD){const n=this.filterTobeUnmutedTracks(e[t]);if(0===n.length)continue;const r=this.createUnmuteMessage(n);return void await vA(this,mU.RequestUnmuteLocal,r)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=e=>this.getStats(e),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter((e=>{let[,{ssrcs:t}]=e;return!!t})),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!(null===(t=this.recvConnection)||void 0===t||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(mU.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(mU.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await MA(JA(this.dtlsFailedCount,XA)),this.emit(mU.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(hU.LocalVideoTrack)||this.pendingLocalTracks.some((e=>e instanceof DM))}throwIfTrackTypeNotMatch(e){if(e.filter((e=>e instanceof DM)).length>1)throw new FI(jI.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter((e=>e instanceof WD)).length>1&&(e.some((e=>e instanceof WD&&e._bypassWebAudio))||!Sk().webAudioMediaStreamDest))throw new FI(jI.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof DM&&this.pendingLocalTracks.some((e=>e instanceof DM)))throw new FI(jI.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof WD&&this.pendingLocalTracks.some((e=>e instanceof WD))&&(!Sk().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some((e=>e instanceof WD&&e._bypassWebAudio))))throw new FI(jI.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){const n=!UN("DISABLE_DUAL_STREAM_USE_ENCODING")&&Sk().supportDualStreamEncoding,r=az(az({},{width:160,height:120,framerate:15,bitrate:50}),t);let o;o=n?e._mediaStreamTrack.clone():EB(e,r);const i=LA(8,"track-low-"),a=new DM(o,az(az({},n&&{scaleResolutionDownBy:rj(r,e)}),{},{frameRate:r.framerate,bitrateMax:r.bitrate,bitrateMin:r.bitrate}),void 0,void 0,i);return a.on(Kk.TRANSCEIVER_UPDATED,(t=>{e._updateRtpTransceiver(t,Gk.LOW_STREAM)})),a._hints.push(Hk.LOW_STREAM),e.addListener(Vk.NEED_CLOSE,(()=>{a.close()})),a}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(e,t,n,r){var o;const i=Array.from(tk(o=this.remoteUserMap).call(o)).find((t=>t._videoSSRC===e));if(i){r||this.store.subscribe(i.uid,"video",void 0,void 0,void 0,void 0,Date.now());const o=this.store.keyMetrics,a=o.subscribe.find((e=>e.userId===i.uid&&"video"===e.type));_k.firstRemoteVideoDecode(this.store.sessionId,vk.FIRST_VIDEO_DECODE,gk.FIRST_VIDEO_DECODE,{peer:i._uintid,videowidth:t,videoheight:n,subscribeElapse:LF.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:o.requestAPEnd||0,apStart:o.requestAPStart||0,joinGwEnd:o.joinGatewayEnd||0,joinGwStart:o.joinGatewayStart||0,pcEnd:o.peerConnectionEnd||0,pcStart:o.peerConnectionStart||0,subscriberEnd:(null==a?void 0:a.subscribeEnd)||0,subscriberStart:(null==a?void 0:a.subscribeStart)||0,videoAddNotify:(null==a?void 0:a.streamAdded)||0,state:r?1:0})}}async remoteMediaSsrcChanged(e,t,n){if(!this.recvConnection)return!1;const r=this.remoteUserMap.get(e);if(!r)return!1;const o=r.get(t);if(!o)return!1;const i=await this.recvConnection.getRemoteSSRC(o);return void 0!==i&&i!==n}isPreSubScribe(e){return!1}async publishDataChannel(e){throw new FI(jI.NOT_SUPPORTED)}async unpublishDataChannel(e){throw new FI(jI.NOT_SUPPORTED)}async subscribeDataChannel(e,t){throw new FI(jI.NOT_SUPPORTED)}async unsubscribeDataChannel(e,t){throw new FI(jI.NOT_SUPPORTED)}hasPendingRemoteDataChannel(e,t){throw new FI(jI.NOT_SUPPORTED)}setPendingRemoteDataChannel(e,t){throw new FI(jI.NOT_SUPPORTED)}async preConnect(e){throw new FI(jI.NOT_SUPPORTED)}getEstablishParams(){throw new FI(jI.NOT_SUPPORTED)}async reSubscribe(e){throw new FI(jI.NOT_SUPPORTED)}async updateVideoStreamParameter(e,t){throw new FI(jI.NOT_SUPPORTED)}unbindRtpTransceiver(){0!==this.localTrackMap.size&&Array.from(this.localTrackMap.entries()).forEach((e=>{let[t,{track:n}]=e;t===hU.LocalVideoLowTrack?n._updateRtpTransceiver(void 0,Gk.LOW_STREAM):n._updateRtpTransceiver(void 0)}))}},Sx(oz.prototype,"p2pConnect",[YY],Object.getOwnPropertyDescriptor(oz.prototype,"p2pConnect"),oz.prototype),Sx(oz.prototype,"unpublish",[zY],Object.getOwnPropertyDescriptor(oz.prototype,"unpublish"),oz.prototype),Sx(oz.prototype,"unpublishLowStream",[XY],Object.getOwnPropertyDescriptor(oz.prototype,"unpublishLowStream"),oz.prototype),Sx(oz.prototype,"subscribe",[JY],Object.getOwnPropertyDescriptor(oz.prototype,"subscribe"),oz.prototype),Sx(oz.prototype,"mockSubscribe",[ZY],Object.getOwnPropertyDescriptor(oz.prototype,"mockSubscribe"),oz.prototype),Sx(oz.prototype,"unsubscribe",[QY],Object.getOwnPropertyDescriptor(oz.prototype,"unsubscribe"),oz.prototype),Sx(oz.prototype,"muteRemote",[$Y],Object.getOwnPropertyDescriptor(oz.prototype,"muteRemote"),oz.prototype),Sx(oz.prototype,"unmuteRemote",[ez],Object.getOwnPropertyDescriptor(oz.prototype,"unmuteRemote"),oz.prototype),Sx(oz.prototype,"hasRemoteMediaWithLock",[tz],Object.getOwnPropertyDescriptor(oz.prototype,"hasRemoteMediaWithLock"),oz.prototype),Sx(oz.prototype,"disconnectForReconnect",[nz],Object.getOwnPropertyDescriptor(oz.prototype,"disconnectForReconnect"),oz.prototype),Sx(oz.prototype,"remoteMediaSsrcChanged",[rz],Object.getOwnPropertyDescriptor(oz.prototype,"remoteMediaSsrcChanged"),oz.prototype),oz);function cz(e){return function(t,n,r){const o=t[n];if("function"!=typeof o)throw new Error("Cannot use mutex on object property.");return r.value=async function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];switch(e){case KY.SEND_ONLY:{const e=await this.sendMutex.lock("From P2PChannel2.".concat(n));try{return await o.apply(this,r)}finally{e()}}case KY.RECEIVE_ONLY:{const e=await this.recvMutex.lock("From P2PChannel2.".concat(n));try{return await o.apply(this,r)}finally{e()}}default:{const e=await this.sendMutex.lock("From P2PChannel2.".concat(n)),t=await this.recvMutex.lock("From P2PChannel2.".concat(n));try{return await o.apply(this,r)}finally{e(),t()}}}},r}}class lz extends eA{constructor(e,t){super(),OR(this,"signal",void 0),OR(this,"token",void 0),OR(this,"tokenTimeout",void 0),OR(this,"tokenInterval",void 0),OR(this,"_sequence",0),OR(this,"userMap",new Map),OR(this,"encoder",new TextEncoder),this.signal=e,this.token=t;const n=()=>{this.signal.connectionState===Ax.CONNECTED&&this.check(),0===this.userMap.size?this.tokenInterval=window.setTimeout(n,1e3):this.tokenInterval=window.setTimeout(n,3*UN("P2P_TOKEN_INTERVAL"))};n()}async send(e,t,n,r,o){var i,a,s;if(0===this.userMap.size)return;const c=Array.from(fh(i=this.userMap).call(i))[0].token;"string"!=typeof t&&(t=JSON.stringify(t)),r=null!==(a=r)&&void 0!==a?a:LA(6,""),o=null!==(s=o)&&void 0!==s?s:this._sequence++;const l={_id:r,_type:e,_seq:o,_message:t,token:"".concat(this.token,"_").concat(c)};UN("SHOW_P2P_LOG")&&pk.debug("send message",l,"noNeedResponse : ".concat(n)),this.splitMessage(JSON.stringify(l)).forEach((e=>{this.signal.request(kx.DATA_STREAM,{payload:IA(this.encoder.encode(e))})}));const u=new ih(((t,o)=>{const i=window.setTimeout((()=>{this.off("res-@".concat(r,"_ack"),a),this.off("res-@".concat(r),c),this.off(RU.ABORT,s),pk.debug("[external-signal] request timeout, type: ".concat(e,", requestId: ").concat(r)),0===this.userMap.size?o(new FI(jI.INVALID_REMOTE_USER)):o(new FI(jI.TIMEOUT))}),UN("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),a=()=>{i&&window.clearTimeout(i),this.off(RU.ABORT,s),n&&t()},s=()=>{i&&window.clearTimeout(i),this.off("res-@".concat(r,"_ack"),a),this.off("res-@".concat(r),c),o(new FI(jI.EXTERNAL_SIGNAL_ABORT,"type: ".concat(e,", requestId: ").concat(r)))};this.once(RU.ABORT,s),this.once("res-@".concat(r,"_ack"),a);const c=(n,c)=>{u=!0,i&&window.clearTimeout(i),this.off("res-@".concat(r,"_ack"),a),this.off(RU.ABORT,s),"success"===n?t(c):o(new FI(jI.P2P_MESSAGE_FAILED,"request ".concat(e," failed, requestId: ").concat(r)))};let u=!1;n||(this.once("res-@".concat(r),c),MA(UN("SIGNAL_REQUEST_TIMEOUT")).then((()=>{u||pk.warning("external_signal request timeout, type: ".concat(e,", requestId: ").concat(r,", ").concat(l))})))}));try{return await u}catch(i){if(i.code===jI.TIMEOUT)return await this.send(e,t,n,r,o);throw i}}onMessage(e){var t;const{_uid:n}=e;let r,o=this.userMap.get(n);if(o)r=o.splitMessageMap;else{if(this.userMap.size>0||!("_type"in e)||e._type!==OU.CHECK)return;const{token:t}=e;r=new Map,o={uid:n,isStart:!0,token:t,splitMessageMap:r,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(n,o),this.signal.emit(Dx.ON_USER_ONLINE,{uid:n}),this.handleUserOnline()}if("id"in e&&"total"in e){var i;const{id:t,total:o}=e,a=null!==(i=r.get(t))&&void 0!==i?i:[];if(a.push(e),r.has(t)||r.set(t,a),a.length!==o)return;{const o=Xy(a).call(a,((e,t)=>e.index-t.index)).map((e=>e.payload)).join("");r.delete(t),(e=JSON.parse(o))._uid=n}}const{_type:a,token:s}=e;if(Ur(t=[OU.ACK,OU.CHECK]).call(t,a))return a===OU.CHECK&&this.handleCheckToken(o,s),void this.receiveMessage(e);s==="".concat(o.token,"_").concat(this.token)?this.handleReceivedMessage(e):pk.debug('Receive unexpected message", '.concat(s,", cur_token: ").concat(o.token,"_").concat(this.token),e)}check(){const e={_id:LA(6,""),token:this.token,_type:OU.CHECK};UN("SHOW_P2P_LOG")&&pk.debug("send message",e),this.signal.request(kx.DATA_STREAM,{payload:IA(this.encoder.encode(JSON.stringify(e)))})}ack(e){const t={_id:e,_type:OU.ACK,token:this.token};UN("SHOW_P2P_LOG")&&pk.debug("send message",t),this.signal.request(kx.DATA_STREAM,{payload:IA(this.encoder.encode(JSON.stringify(t)))})}response(e,t,n){this.send(OU.RESPONSE,JSON.stringify({success:!n,message:t}),!0,e)}handleReceivedMessage(e){const t=()=>{this.userMap.forEach((e=>{const{receivedMessagesMap:t,nextExpectedSequenceNumber:n}=e;for(;t.has(n);){const r=t.get(n);t.delete(n),this.receiveMessage(r),e.nextExpectedSequenceNumber++}}))};if(!e)return void t();const{_uid:n,_seq:r}=e,o=this.userMap.get(n),{receivedMessagesMap:i,isStart:a,nextExpectedSequenceNumber:s}=o;if(r<s)return this.ack(e._id),void pk.debug("[external-signal] receive old message, seq: ".concat(r,", ").concat(e._message));i.set(r,e),a&&r===s&&(this.receiveMessage(e),i.delete(s),o.nextExpectedSequenceNumber++,t())}receiveMessage(e){const{_id:t,_type:n,_message:r,_uid:o}=e;if(UN("SHOW_P2P_LOG")&&pk.debug("receive message",e),t){let i;switch(e._type!==OU.ACK&&(r&&(i=JSON.parse(r)),this.ack(e._id)),e._type){case OU.CANDIDATE:case OU.CONTROL:this.signal.emit(n,i,o);break;case OU.PUBLISH:case OU.UNPUBLISH:case OU.RESTART_ICE:case OU.CALL:i.uid=o,mA(this.signal,n,i).then((t=>{this.response(e._id,t)})).catch((()=>{this.response(e._id,void 0,!0)}));break;case OU.ACK:this.getListeners("res-@".concat(t,"_ack")).length>0&&this.emit("res-@".concat(t,"_ack"));break;case OU.RESPONSE:{const{success:e,message:n}=i;this.emit("res-@".concat(t),e?"success":"failed",n);break}}}}splitMessage(e){if(e.length<lz.MAX_MESSAGE_SIZE)return[e];const t=[],{remoteToken:n}=JSON.parse(e),r=LA(6,"");let o=0,i=800;const a=Math.ceil(e.length/i);for(;e.length>0;){o++;const s={id:r,index:o,total:a,payload:e.slice(0,i),token:"".concat(this.token,"_").concat(n)};JSON.stringify(s).length>lz.MAX_MESSAGE_SIZE?i-=50:(t.push(s),e=e.slice(i))}return t.map((e=>JSON.stringify(e)))}handleCheckToken(e,t){return e.token!==t?(pk.debug("token changed, from ".concat(e.token," to ").concat(t)),this.reset(e.uid,t),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout((()=>{pk.debug("token timeout, ".concat(t)),this.reset(e.uid)}),UN("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const e=await mA(this.signal,OU.CALL,void 0),t=await this.send(OU.CALL,e);this.signal.emit(Nx.P2P_CONNECTION,t,!0)}async reset(e,t){const n=this.userMap.get(e);n&&(this.emit(RU.ABORT),this.signal.emit(Dx.ON_USER_OFFLINE,{uid:n.uid,reason:wU.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),t||(pk.debug("change local token from ".concat(t," to ").concat(t)),this.token=LA(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(RU.ABORT)}}OR(lz,"MAX_SIZE",1),OR(lz,"MAX_MESSAGE_SIZE",1024);class uz extends eA{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===Ax.CONNECTED?this.emit(Nx.WS_CONNECTED):e===Ax.RECONNECTING?this.emit(Nx.WS_RECONNECTING,this._websocketReconnectReason):e===Ax.CLOSED&&this.emit(Nx.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(e,t){super(),OR(this,"_disconnectedReason",void 0),OR(this,"_websocketReconnectReason",void 0),OR(this,"_connectionState",Ax.CLOSED),OR(this,"reconnectToken",void 0),OR(this,"p2pToken",void 0),OR(this,"websocket",void 0),OR(this,"openConnectionTime",void 0),OR(this,"clientId",void 0),OR(this,"lastMsgTime",Date.now()),OR(this,"uploadCache",[]),OR(this,"uploadCacheInterval",void 0),OR(this,"rttRolling",new $A(5)),OR(this,"pingpongTimer",void 0),OR(this,"pingpongTimeoutCount",0),OR(this,"joinResponse",void 0),OR(this,"multiIpOption",void 0),OR(this,"initError",void 0),OR(this,"spec",void 0),OR(this,"store",void 0),OR(this,"_external_signal",void 0),OR(this,"onWebsocketMessage",(e=>{if(e.data instanceof ArrayBuffer)return void this.emit(Nx.ON_BINARY_DATA,e.data);const t=JSON.parse(e.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(t,"_id")){const e="res-@".concat(t._id);this.emit(e,t._result,t._message)}else if(Object.prototype.hasOwnProperty.call(t,"_type")){switch(t._type){case Dx.ON_DATA_STREAM:return void this.handleDataStream(t._message);case Dx.MUTE_AUDIO:case Dx.MUTE_VIDEO:case Dx.ON_P2P_LOST:case Dx.ON_USER_ONLINE:return;case Dx.ON_USER_OFFLINE:const{uid:e}=t._message;return pk.debug("[".concat(this.clientId,"] user-offline uid: ").concat(e)),void this._external_signal.reset(e)}if(this.emit(t._type,t._message),t._type===Dx.ON_NOTIFICATION&&this.handleNotification(t._message),t._type===Dx.ON_USER_BANNED)switch(t._message.error_code){case 14:this.close(sA.UID_BANNED);break;case 15:this.close(sA.IP_BANNED);break;case 16:this.close(sA.CHANNEL_BANNED)}if(t._type===Dx.ON_USER_LICENSE_BANNED)switch(t._message.error_code){case Ix.ERR_LICENSE_MISSING:this.close(sA.LICENSE_MISSING);break;case Ix.ERR_LICENSE_EXPIRED:this.close(sA.LICENSE_EXPIRED);break;case Ix.ERR_LICENSE_MINUTES_EXCEEDED:this.close(sA.LICENSE_MINUTES_EXCEEDED);break;case Ix.ERR_LICENSE_PERIOD_INVALID:this.close(sA.LICENSE_PERIOD_INVALID);break;case Ix.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(sA.LICENSE_MULTIPLE_SDK_SERVICE);break;case Ix.ERR_LICENSE_ILLEGAL:this.close(sA.LICENSE_ILLEGAL);break;default:this.close()}}})),this.clientId=e.clientId,this.spec=e,this.store=t,this.websocket=new GU("gateway-".concat(this.clientId),this.spec.retryConfig,!0,UN("JOIN_GATEWAY_USE_DUAL_DOMAIN"),UN("JOIN_GATEWAY_USE_443PORT_ONLY"),t),this.handleWebsocketEvents(),window.addEventListener("offline",(()=>{this.connectionState===Ax.CONNECTED&&this.reconnect("retry",pA.OFFLINE)})),this.p2pToken=LA(6,""),this._external_signal=new lz(this,this.p2pToken)}async request(e,t,n,r){const o=LA(6,""),i={_id:o,_type:e,_message:t},a=this.websocket.connectionID,s=()=>new ih(((e,t)=>{if(this.connectionState===Ax.CONNECTED)return e();const n=()=>{this.off(Nx.WS_CLOSED,r),e()},r=()=>{this.off(Nx.WS_CONNECTED,n),t(new FI(jI.WS_ABORT))};this.once(Nx.WS_CONNECTED,n),this.once(Nx.WS_CLOSED,r)}));if(this.connectionState!==Ax.CONNECTING&&this.connectionState!==Ax.RECONNECTING||e===kx.JOIN||e===kx.REJOIN||await s(),this.websocket.sendMessage(i,!0),r)return;const c=new ih(((n,r)=>{let i=!1;const s=(r,o)=>{i=!0,n({isSuccess:"success"===r,message:o||{}}),this.off(Nx.WS_CLOSED,c),this.off(Nx.WS_RECONNECTING,c),this.emit(Nx.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(o),s);const c=()=>{r(new FI(jI.WS_ABORT,"type: ".concat(e))),this.off(Nx.WS_CLOSED,c),this.off(Nx.WS_RECONNECTING,c),this.off("res-@".concat(o),s)};this.once(Nx.WS_CLOSED,c),this.once(Nx.WS_RECONNECTING,c),MA(UN("SIGNAL_REQUEST_TIMEOUT")).then((()=>{this.websocket.connectionID!==a||i||(pk.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(e)),this.emit(Nx.REQUEST_TIMEOUT,e,t))}))}));let l=null;try{l=await c}catch(r){if(this.connectionState===Ax.CLOSED||e===kx.LEAVE)throw new FI(jI.WS_ABORT);return!this.spec.forceWaitGatewayResponse||n?r.throw():e===kx.JOIN||e===kx.REJOIN?null:(await s(),await this.request(e,t))}if(l.isSuccess)return l.message;const u=Number(l.message.error_code||l.message.code),d=kU(u),p=new FI(jI.UNEXPECTED_RESPONSE,"".concat(d.desc,": ").concat(l.message.error_str),{code:u,data:l.message,desc:d.desc});return"success"===d.action?l.message:(pk.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(u,", message: ").concat(d.desc,", action: ").concat(d.action)),u===Ix.ERR_TOO_MANY_BROADCASTERS?e===kx.JOIN||e===kx.REJOIN?(this.initError=p,this.close(),p.throw()):p.throw():"failed"===d.action?p.throw():"quit"===d.action?(this.initError=p,this.close(),p.throw()):(u===Ix.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=l.message.option,pk.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",pA.MULTI_IP)):this.reconnect(d.action,pA.SERVER_ERROR),e===kx.JOIN||e===kx.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new ih((n=>{const r=o=>{(!t||t(o))&&(this.off(e,r),n(o))};this.on(e,r)}))}uploadWRTCStats(e){if(!this.store.sessionId)return void pk.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(Px.WRTC_STATS,t)}upload(e,t){const n={_type:e,_message:t};try{this.websocket.sendMessage(n)}catch(e){const t=UN("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(n),this.uploadCache.length>t&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval((()=>{if(this.connectionState!==Ax.CONNECTED)return;const e=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(e._type,e._message)}),UN("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,t){const n={_type:e,_message:t};this.websocket.sendMessage(n)}async sendExtensionMessage(e,t,n){return await this._external_signal.send(e,t,n)}init(e){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new ih(((t,n)=>{this.once(Nx.WS_CONNECTED,(()=>t(this.joinResponse))),this.once(Nx.WS_CLOSED,(()=>n(this.initError||new FI(jI.WS_ABORT)))),this.connectionState=Ax.CONNECTING,this.websocket.init(e).catch(n)}))}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=e||sA.LEAVE,this.connectionState=Ax.CLOSED,pk.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),this.p2pToken=LA(6,""),this._external_signal.clear(),this._external_signal=new lz(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(Nx.ABORT_P2P_EXECUTION);const e=await mA(this,Nx.REQUEST_JOIN_INFO),t=await this.request(kx.JOIN,e);if(!t)return this.emit(Nx.REPORT_JOIN_GATEWAY,jI.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.emit(Nx.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Ax.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}handleDataStream(e){try{var t;const n=wA(e.payload),r=(new TextDecoder).decode(n),o=JSON.parse(r);"total"in o&&"id"in o||Ur(t=Object.values(OU)).call(t,o._type)?(o._uid=e.uid,this._external_signal.onMessage(o)):this.emit(Dx.ON_DATA_STREAM,e)}catch(t){this.emit(Dx.ON_DATA_STREAM,e)}}handleNotification(e){pk.debug("[".concat(this.clientId,"] receive notification: "),e);const t=kU(e.code);if("success"!==t.action){if("failed"!==t.action)return"quit"===t.action?("ERR_REPEAT_JOIN_CHANNEL"===t.desc&&this.close(sA.UID_BANNED),void this.close()):void this.reconnect(t.action,pA.SERVER_ERROR);pk.error("[".concat(this.clientId,"] ignore error: "),t.desc)}}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=UN("PING_PONG_TIME_OUT"),t=Date.now();this.pingpongTimeoutCount>=e&&(pk.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>UN("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",pA.TIMEOUT):this.request(kx.PING,void 0,!0).then((()=>{this.pingpongTimeoutCount=0;const e=Date.now()-t;this.rttRolling.add(e),UN("REPORT_STATS")&&this.send(kx.PING_BACK,{pingpongElapse:e})})).catch((e=>{}))}handleWebsocketEvents(){this.websocket.on(Lx.RECONNECT_CREATE_CONNECTION,(e=>{this.emit(Nx.WS_RECONNECT_CREATE_CONNECTION,e)})),this.websocket.on(Lx.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(Lx.CLOSED,(()=>{this.connectionState=Ax.CLOSED})),this.websocket.on(Lx.FAILED,(()=>{this._disconnectedReason=sA.NETWORK_ERROR,this.connectionState=Ax.CLOSED})),this.websocket.on(Lx.RECONNECTING,(e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===Ax.CONNECTED?this.connectionState=Ax.RECONNECTING:this.connectionState=Ax.CONNECTING})),this.websocket.on(Lx.WILL_RECONNECT,((e,t,n)=>{"retry"!==e?(pk.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(e)),this.reconnectToken=void 0):pk.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),n(e)})),this.websocket.on(Lx.CONNECTED,(()=>{this.openConnectionTime=Date.now(),this.join().catch((e=>{if(this.emit(Nx.REPORT_JOIN_GATEWAY,e,this.url||""),e instanceof FI&&e.code===jI.UNEXPECTED_RESPONSE&&e.data.code===Ix.ERR_NO_AUTHORIZED)return pk.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",pA.SERVER_ERROR);pk.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",pA.SERVER_ERROR):(this.initError=e,this.close())}))})),this.websocket.on(Lx.REQUEST_NEW_URLS,((e,t)=>{mA(this,Nx.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)})),this.websocket.on(Lx.ON_TOKEN_PRIVILEGE_DID_EXPIRE,(()=>{this.emit(Dx.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}))}}const dz={name:"P2PChannel",create:function(e){let{store:t,statsCollector:n}=e;return new sz(t,n)},createSubmodule:function(e){let{store:t,spec:n}=e;return new uz(n,t)}};function pz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hz(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pz(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pz(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class fz{constructor(e){OR(this,"sessionDesc",void 0),OR(this,"localCapabilities",void 0),OR(this,"rtpCapabilities",void 0),OR(this,"candidates",void 0),OR(this,"_originCandidates",void 0),OR(this,"iceParameters",void 0),OR(this,"dtlsParameters",void 0),OR(this,"setup",void 0),OR(this,"currentMidIndex",void 0),OR(this,"cname",void 0),e=SA(e);const{iceParameters:t,dtlsParameters:n,candidates:r,rtpCapabilities:o,setup:i,localCapabilities:a,sdkCodec:s,cname:c}=e,l=qN("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE audio video\na=msid-semantic: WMS\na=ice-lite\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:audio\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:video\n");this.rtpCapabilities=o,this.candidates=r,this._originCandidates=SA(r),this.iceParameters=t,this.dtlsParameters=n,this.setup=i,this.localCapabilities=a,this.cname=c;for(let u=0;u<l.mediaDescriptions.length;u++){const e=l.mediaDescriptions[u];if(e.attributes.iceUfrag=t.iceUfrag,e.attributes.icePwd=t.icePwd,e.attributes.fingerprints=n.fingerprints,e.attributes.candidates=r,e.attributes.setup=i,"video"===e.media.mediaType){e.media.fmts=o.videoCodecs.map((e=>e.payloadType.toString(10)));let t=o.videoCodecs.filter((e=>{var t,n;return null===(t=e.rtpMap)||void 0===t?void 0:Ur(n=t.encodingName.toLowerCase()).call(n,s)}));0===t.length&&(t=o.videoCodecs),e.attributes.payloads=t,e.attributes.extmaps=o.videoExtensions}"audio"===e.media.mediaType&&(e.media.fmts=o.audioCodecs.map((e=>e.payloadType.toString(10))),e.attributes.payloads=o.audioCodecs,e.attributes.extmaps=o.audioExtensions),l.mediaDescriptions[u]=this.mungMediaDesc(e)}this.sessionDesc=l,this.currentMidIndex=l.mediaDescriptions.length-1}toString(){return KN(this.sessionDesc)}send(e,t,n){const{ssrcs:r,ssrcGroups:o}=Ej(t,this.cname),i=this.sessionDesc.mediaDescriptions.find((t=>e===lU.VIDEO?"video"===t.media.mediaType:"audio"===t.media.mediaType)),a=r[0].attributes.label,s=r[0].attributes.mslabel;return i.attributes.ssrcs=i.attributes.ssrcs.concat(r),i.attributes.ssrcGroups=i.attributes.ssrcGroups.concat(o),{id:a,mslabel:s}}batchSend(e){return e.map((e=>{let{kind:t,ssrcMsg:n}=e;return this.send(t,n,void 0)}))}stopSending(e){this.sessionDesc.mediaDescriptions.forEach((t=>{const n=[],r=[],o=[];t.attributes.ssrcs.forEach((t=>{Ur(e).call(e,t.attributes.label||"")?o.push(t):n.push(t)})),t.attributes.ssrcGroups.forEach((e=>{var t;Ur(t=o.map((e=>e.ssrcId))).call(t,e.ssrcIds[0])||r.push(e)})),t.attributes.ssrcs=n,t.attributes.ssrcGroups=r}))}mute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));t.attributes.direction="inactive"}unmute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));t.attributes.direction="sendonly"}receive(e,t,n){e.forEach(((e,t)=>{const n=e._mediaStreamTrack,r=this.sessionDesc.mediaDescriptions.findIndex((e=>e.attributes.mid===n.kind)),o=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[r],e);this.sessionDesc.mediaDescriptions[r]=o}))}stopReceiving(e){}updateCandidates(e){const t=this._originCandidates.filter((e=>"udp"===e.transport)),n=[];if(t.forEach((e=>{n.push(hz(hz({},e),{},{foundation:"tcpcandidate",priority:Number(e.priority)-1+"",transport:"tcp",port:Number(e.port)+90+""}))})),0!==t.length){switch(e){case uU.TCP_RELAY:this.candidates=n;break;case uU.UDP_TCP_RELAY:case uU.RELAY:this.candidates=[...t,...n];break;default:this.candidates=t}for(const e of this.sessionDesc.mediaDescriptions)e.attributes.candidates=this.candidates}}restartICE(e){e=SA(e),this.iceParameters=e,this.sessionDesc.mediaDescriptions.forEach((t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd}))}predictReceivingMids(e){const t=[];for(let n=0;n<e;n++)t.push((this.currentMidIndex+n+1).toString(10));return t}mungRecvMediaDsec(e,t){const n=SA(e);return yj(n,t),bj(n,t),n}updateRecvMedia(e,t){const n=this.sessionDesc.mediaDescriptions.findIndex((t=>t.attributes.mid===e));if(-1!==n){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],t);this.sessionDesc.mediaDescriptions[n]=e}}bumpMid(e){this.currentMidIndex+=e}updateTrackLabel(e,t,n){const r=this.sessionDesc.mediaDescriptions.find((t=>e===lU.VIDEO?"video"===t.attributes.mid:"audio"===t.attributes.mid));if(r){const e=r.attributes.ssrcs.find((e=>e.attributes.label===t));var o;e&&(e.attributes.label=n,null===(o=e.attributes.msid)||void 0===o||o.replace(t,n))}}mungMediaDesc(e){const t=SA(e);return _j(t),function(e){const t=e.attributes.extmaps.find((e=>uj(e.extensionName)));t&&e.attributes.extmaps.splice(e.attributes.extmaps.indexOf(t),1),e.attributes.payloads.forEach((e=>{const t=e.rtcpFeedbacks.findIndex((e=>"transport-cc"===e.type));-1!==t&&e.rtcpFeedbacks.splice(t,1)}))}(t),t}getSSRC(e){for(const t of this.sessionDesc.mediaDescriptions)for(const n of t.attributes.ssrcs)if(n.attributes.label===e)return[n]}}var mz;function vz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gz(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vz(Object(n),!0).forEach((function(t){OR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vz(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let Ez=(mz=class e extends cU{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")).filter((e=>{var t;return Ur(t=Object.keys(HN)).call(t,e)})))]}constructor(t,n){super(t,n),OR(this,"store",void 0),OR(this,"peerConnection",void 0),OR(this,"remoteSDP",void 0),OR(this,"initialOffer",void 0),OR(this,"statsFilter",void 0),OR(this,"useRTX",!1),OR(this,"localCapabilities",void 0),OR(this,"localCandidateCount",0),OR(this,"allCandidatesReceived",!1),OR(this,"establishPromise",void 0),OR(this,"mutex",void 0),this.store=n,this.mutex=new YA("P2PConnection-mutex",n.clientId),this.peerConnection=new RTCPeerConnection(e.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=ON(this.peerConnection,UN("STATS_UPDATE_INTERVAL"),void 0,fI()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const e=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=fj(e.sdp),n=hj(e.sdp,{filterRTX:!this.useRTX,filterVideoFec:UN("FILTER_VIDEO_FEC"),filterAudioFec:UN("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=n,this.initialOffer=e,gz(gz({},t),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:n},offerSDP:e.sdp})}catch(e){throw new FI(jI.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async updateRemoteConnect(){}async connect(e){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new fz(gz(gz({},e),{},{rtpCapabilities:e.rtpCapabilities.send,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec}));const t=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:t})}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}async updateRemoteRTPCapabilities(e,t){throw new FI(jI.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}getPreMedia(e){}send(e,t){var n=this;return cw((function*(){const r=yield lw(n.mutex.lock());try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const r=e.map((e=>n.peerConnection.addTrack(e._mediaStreamTrack))),o=yield lw(n.peerConnection.createOffer()),i=qN(o.sdp),a=e.map((e=>{const t=e._mediaStreamTrack,r=i.mediaDescriptions.find((e=>e.attributes.mid===t.kind));if(!r)throw new Error("Cannot extract ssrc from mediaDescription.");return function(e,t,n){const r=e.attributes.ssrcs.filter((e=>e.attributes.label===t)),o=e.attributes.ssrcGroups;if(0===r.length)throw new Error("Cannot extract ssrc from plan-b SDP.");if(o&&r.length>1){const e=o.find((e=>-1!==e.ssrcIds.indexOf(r[0].ssrcId)));return e?[{ssrcId:e.ssrcIds[0],rtx:n?e.ssrcIds[1]:void 0}]:[{ssrcId:r[0].ssrcId}]}return[{ssrcId:r[0].ssrcId}]}(r,t.id,n.useRTX)}));let s;try{s=yield a}catch(e){throw r.forEach((e=>{pI()&&e.replaceTrack(null),n.peerConnection.removeTrack(e)})),e}const c=n.mungSendOfferSDP(o.sdp,e);n.remoteSDP.receive(e,t,s);const l=n.remoteSDP.toString();return yield lw(n.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield lw(n.applySendEncodings(r,e)),yield lw(n.peerConnection.setRemoteDescription({type:"answer",sdp:l})),e.map(((e,t)=>{const n=e._mediaStreamTrack.id;return{localSSRC:a[t],id:n}}))}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{r()}}))()}async stopSending(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const t=this.peerConnection.getSenders().filter((t=>{var n;return-1!==e.indexOf((null===(n=t.track)||void 0===n?void 0:n.id)||"")}));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");t.map((e=>{pI()&&e.replaceTrack(null),this.peerConnection.removeTrack(e)}));const n=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(n),this.remoteSDP.stopReceiving(e);const r=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}}async receive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{id:n,mslabel:o}=this.remoteSDP.send(e,t,r),i=new ih(((t,r)=>{const i=setTimeout((()=>{r(new Error("Cannot receive track, id: ".concat(n)))}),1e4),a=r=>{const s=aI();if(("Safari"===s.name&&11===Number(s.version)||mI())&&r.track.id!==n&&r.streams[0].id===o){var c;const o=r.streams[0].getTracks()[0];return null===(c=this.remoteSDP)||void 0===c||c.updateTrackLabel(e,n,r.track.id),this.peerConnection.removeEventListener("track",a),clearTimeout(i),void t(o)}if(r.track.id===n)return this.peerConnection.removeEventListener("track",a),clearTimeout(i),void t(r.track)};this.peerConnection.addEventListener("track",a)})),a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:a});const s=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(s),{track:await i,id:n}}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(n)}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async muteRemote(e){}async unmuteRemote(e){}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getSenders().filter((t=>{var n;return-1!==e.indexOf((null===(n=t.track)||void 0===n?void 0:n.id)||"")}));if(t.length!==e.length)throw new Error("sender' length doesn't match mids' length.");t.map((e=>{if(pI()&&e.track)e.track.enabled=!1;else{const t=e.getParameters();t.encodings.forEach((e=>e.active=!1)),e.setParameters(t)}}))}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getSenders().filter((t=>{var n;return-1!==e.indexOf((null===(n=t.track)||void 0===n?void 0:n.id)||"")}));if(t.length!==e.length)throw new Error("Senders' length doesn't match mids' length.");t.map((async e=>{if(pI()&&e.track)e.track.enabled=!0;else{const t=e.getParameters();t.encodings.forEach((e=>e.active=!0)),await e.setParameters(t)}}));const n=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(n);const r=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}restartICE(e){var t=this;return cw((function*(){const n=yield lw(t.mutex.lock("From P2PConnection.restartICE"));try{if(!t.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const n=Sk().supportPCSetConfiguration;if(e===uU.RELAY&&!n)return;if(n){const n=t.peerConnection.getConfiguration(),r=e===uU.RELAY?"relay":"all";n.iceTransportPolicy!==r&&(pk.debug("[".concat(t.store.clientId,"] restartICE change iceTransportPolicy from [").concat(n.iceTransportPolicy,"] to [").concat(r,"]")),n.iceTransportPolicy=r,t.peerConnection.setConfiguration(n))}e!==uU.RELAY&&t.remoteSDP.updateCandidates(e);const r=yield lw(t.peerConnection.createOffer({iceRestart:!0}));if(!r.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const o=fj(r.sdp),{remoteIceParameters:i}=yield o.iceParameters;t.remoteSDP.restartICE(i);const a=t.remoteSDP.toString();yield lw(t.peerConnection.setLocalDescription(r)),yield lw(t.peerConnection.setRemoteDescription({type:"answer",sdp:a}))}catch(e){pk.warning("[".concat(t.store.clientId,"] restart ICE failed, abort operation"),e)}finally{n()}}))()}close(){var e;this.peerConnection.close(),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const e=await this.peerConnection.createOffer(),n=this.mungSendOfferSDP(e.sdp,[t]);this.remoteSDP.updateRecvMedia(t._mediaStreamTrack.kind,t);const r=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:n}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const n=this.peerConnection.getSenders().filter((t=>{var n;return(null===(n=t.track)||void 0===n?void 0:n.id)===e}));1===n.length&&await this.applySendEncodings(n,[t])}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const n=this.peerConnection.getSenders().find((e=>{var n;return(null===(n=e.track)||void 0===n?void 0:n.id)===t}));n&&await n.replaceTrack(e._mediaStreamTrack)}createDataChannels(e,t){throw new FI(jI.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(e){throw new FI(jI.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;null===(e=this.onICEConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,pk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout((()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,pk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))}),UN("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const n={iceServers:[],sdpSemantics:"plan-b"};return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(cA(t.turnServer.servers)?n.iceServers=t.turnServer.servers:(n.iceServers&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.servers)),UN("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach((e=>{e.forceturn&&(n.iceTransportPolicy="relay")})))),n}static turnServerConfigToIceServers(e){const t=[];return e.forEach((e=>{e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}):(e.udpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}))})),t}async updateRtpSenderEncodings(e,t){var n;if(t||(t=this.peerConnection.getSenders().find((t=>{var n;return(null===(n=t.track)||void 0===n?void 0:n.id)===e._mediaStreamTrack.id}))),!t)return pk.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(!Sk().supportSetRtpSenderParameters)return pk.warn("Browser not support set rtp-sender parameters");const r={},o={};if(e instanceof DM)switch(e._optimizationMode){case"motion":r.degradationPreference="maintain-framerate";break;case"detail":r.degradationPreference="maintain-resolution";break;default:r.degradationPreference="balanced"}if(UN("DSCP_TYPE")&&PI()){var i;const e=UN("DSCP_TYPE");Ur(i=["very-low","low","medium","high"]).call(i,e)&&(o.networkPriority=e)}const a=t.getParameters(),s=null===(n=a.encodings)||void 0===n?void 0:n[0];s&&Object.assign(s,o),Object.assign(a,r),pk.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(a.encodings))),await t.setParameters(a)}async applySendEncodings(e,t){try{if(!Sk().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let n=0;n<e.length;n++){const r=e[n],o=t[n];r&&o&&await this.updateRtpSenderEncodings(o,r)}}catch(e){pk.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,t){const n=qN(e);return t.forEach(((e,t)=>{const r=e._mediaStreamTrack,o=n.mediaDescriptions.find((e=>e.attributes.mid===r.kind));o&&yj(o,e)})),KN(n)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,n)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,e,t,n)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedLocalCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedRemoteCandidateChanged)||void 0===n||n.call(this,e,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const t=this.remoteSDP.batchSend(e).map(((t,n)=>{let{id:r,mslabel:o}=t;const{kind:i}=e[n];return new ih(((e,t)=>{const n=setTimeout((()=>{t(new Error("Cannot receive track, id: ".concat(r)))}),1e4),a=t=>{const s=aI();if("Safari"===s.name&&11===Number(s.version)&&t.track.id!==r&&t.streams[0].id===o){var c;const o=t.streams[0].getTracks()[0];return null===(c=this.remoteSDP)||void 0===c||c.updateTrackLabel(i,r,t.track.id),this.peerConnection.removeEventListener("track",a),clearTimeout(n),void e({track:o,id:r})}if(t.track.id===r)return this.peerConnection.removeEventListener("track",a),clearTimeout(n),void e({track:t.track,id:r})};this.peerConnection.addEventListener("track",a)}))})),n=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const r=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(r),await ih.all(t)}catch(e){throw new FI(jI.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async getRemoteSSRC(e){if(!this.remoteSDP)return;const t=this.remoteSDP.getSSRC(e);return null==t?void 0:t[0].ssrcId}setConfiguration(t){if(Sk().supportPCSetConfiguration){const n=e.resolvePCConfiguration(t);this.peerConnection.setConfiguration(n)}}},Sx(mz.prototype,"connect",[yz],Object.getOwnPropertyDescriptor(mz.prototype,"connect"),mz.prototype),Sx(mz.prototype,"stopSending",[yz],Object.getOwnPropertyDescriptor(mz.prototype,"stopSending"),mz.prototype),Sx(mz.prototype,"receive",[yz],Object.getOwnPropertyDescriptor(mz.prototype,"receive"),mz.prototype),Sx(mz.prototype,"stopReceiving",[yz],Object.getOwnPropertyDescriptor(mz.prototype,"stopReceiving"),mz.prototype),Sx(mz.prototype,"muteRemote",[yz],Object.getOwnPropertyDescriptor(mz.prototype,"muteRemote"),mz.prototype),Sx(mz.prototype,"unmuteRemote",[yz],Object.getOwnPropertyDescriptor(mz.prototype,"unmuteRemote"),mz.prototype),Sx(mz.prototype,"muteLocal",[yz],Object.getOwnPropertyDescriptor(mz.prototype,"muteLocal"),mz.prototype),Sx(mz.prototype,"unmuteLocal",[yz],Object.getOwnPropertyDescriptor(mz.prototype,"unmuteLocal"),mz.prototype),Sx(mz.prototype,"close",[yz],Object.getOwnPropertyDescriptor(mz.prototype,"close"),mz.prototype),Sx(mz.prototype,"updateEncoderConfig",[yz],Object.getOwnPropertyDescriptor(mz.prototype,"updateEncoderConfig"),mz.prototype),Sx(mz.prototype,"updateSendParameters",[yz],Object.getOwnPropertyDescriptor(mz.prototype,"updateSendParameters"),mz.prototype),Sx(mz.prototype,"replaceTrack",[yz],Object.getOwnPropertyDescriptor(mz.prototype,"replaceTrack"),mz.prototype),Sx(mz.prototype,"getRemoteSSRC",[yz],Object.getOwnPropertyDescriptor(mz.prototype,"getRemoteSSRC"),mz.prototype),mz);function yz(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("Locking from P2PConnection.".concat(t));try{for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return await r.apply(this,i)}finally{n()}},n}const _z={name:"PlanBConnection",create:function(e){let{store:t,spec:n}=e;return new Ez(n,t)}};CN(),xN("PROCESS_ID","process-".concat(LA(8,""),"-").concat(LA(4,""),"-").concat(LA(4,""),"-").concat(LA(4,""),"-").concat(LA(12,""))),function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(e){return void pk.error("Error loading sdk config",e.message)}if(e)try{const t=JSON.parse(window.atob(e)),n=Date.now();pk.debug("Loading global parameters from cache",t),Object.keys(t).forEach((e=>{if(Object.prototype.hasOwnProperty.call(LN,e)){const{value:r,expires:o}=t[e];if(o&&o<=n)return;FN[e]=r,LN[e]=r}}))}catch(o){pk.error("Error loading mutableParamsCache: ".concat(e),o.message)}}(),Array.isArray(FN.AREAS)&&FN.AREAS.length>0&&oF(FN.AREAS,!0);const bz=(e,t,n)=>{pk.debug("setParameter key:".concat(e,", value:").concat(JSON.stringify(t))),xN(e,t,n)};Vj(VK,!1),Vj(zK,!1),Vj(aH,!1),Vj(RY,!1),Vj(jK,!1),Vj(dz,!1),Vj(_z,!1);const Tz=function(e){const t=new eA,n=e,r={getListeners:t.getListeners.bind(t),on:(e,n)=>(function(e,t){e===_U.SECURITY_POLICY_VIOLATION&&aG(t,!0)}(e,n),t.on.bind(t)(e,n)),addListener:t.addListener.bind(t),once:t.once.bind(t),off:t.off.bind(t),removeAllListeners:t.removeAllListeners.bind(t),emit:t.emit.bind(t),safeEmit:t.safeEmit.bind(t)};return oG(oG({},n),r)}({__TRACK_LIST__:Fk,VERSION:wN,BUILD:DN,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:bz,getParameter:UN,getSupportedCodec:async function(){let e={audio:[],video:[]};try{let t=new RTCPeerConnection;const n=await async function(e){let t;return Sk().supportUnifiedPlan?(e.addTransceiver("video",{direction:"recvonly"}),e.addTransceiver("audio",{direction:"recvonly"}),t=(await e.createOffer()).sdp):t=(await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,t}(t);if(!n)return e;t.close(),t=null,e=function(e){const t={video:[],audio:[]};return e.match(/ VP8/i)&&t.video.push("VP8"),e.match(/ VP9/i)&&t.video.push("VP9"),e.match(/ AV1/i)&&t.video.push("AV1"),e.match(/ H264/i)&&t.video.push("H264"),e.match(/ H265/i)&&t.video.push("H265"),e.match(/ opus/i)&&t.audio.push("OPUS"),e.match(/ PCMU/i)&&t.audio.push("PCMU"),e.match(/ PCMA/i)&&t.audio.push("PCMA"),e.match(/ G722/i)&&t.audio.push("G722"),t}(n)}catch(e){throw new bk(jI.CREATE_OFFER_FAILED,e.toString&&e.toString()).print()}return e},checkSystemRequirements:function(){const e=_k.reportApiInvoke(null,{name:rA.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:oA.TRACER});let t=!1;try{const e=window.RTCPeerConnection,n=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,r=window.WebSocket;t=!!(e&&n&&r),t&&kI()&&gI(75)&&(new e).close()}catch(e){return pk.error("check system requirement failed: ",e),!1}let n=!1;const r=aI();r.name===nI.CHROME&&Number(r.version)>=58&&("WebKit"!==oI.engine.name||function(){const e=aI();if(uI()){if(e.os===tI.MAC_OS)return!0;if(e.os===tI.IOS){const e=oI.os.version&&oI.os.version.split(".");if(e&&14===Number(e[0])&&e[1]&&Number(e[1])>=3)return!0;if(e&&Number(e[0])>14)return!0}}return!1}())&&(n=!0),(r.name===nI.FIREFOX&&Number(r.version)>=56||r.name===nI.OPERA&&Number(r.version)>=45||r.name===nI.SAFARI&&Number(r.version)>=11||"WebKit"===r.name&&(mI()||II())&&r.osVersion&&Number(r.osVersion.split(".")[0])>=11||AI()||aI().name===nI.QQ)&&(n=!0),pk.debug("checkSystemRequirements, api:",t,"browser",n);const o=t&&n;return e.onSuccess(o),o},getDevices:function(e){return xP.enumerateDevices(!0,!0,e)},getMicrophones:function(e){return xP.getRecordingDevices(e)},getCameras:function(e){return xP.getCamerasDevices(e)},getElectronScreenSources:IP,getPlaybackDevices:function(e){return xP.getSpeakers(e)},createClient:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const n=LA(5,"client-"),r=_k.reportApiInvoke(null,{id:n,name:rA.CREATE_CLIENT,options:[t],tag:oA.TRACER});try{!function(e){VI(e.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),VI(e.mode,"config.mode",["rtc","live","p2p"]),void 0!==e.audioCodec&&VI(e.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),void 0!==e.proxyServer&&WI(e.proxyServer,"config.proxyServer",1,1e4),void 0!==e.turnServer&&lA(e.turnServer),void 0!==e.httpRetryConfig&&iA(e.httpRetryConfig),void 0!==e.websocketRetryConfig&&iA(e.websocketRetryConfig)}(t)}catch(e){throw r.onError(e),e}return(bI(16,0,!0)||TI(16,0,!0))&&("vp9"===t.codec&&(t.codec="vp8",pk.debug("browser not support vp9, force use vp8")),xN("UNSUPPORTED_VIDEO_CODEC",["vp9"])),void 0===t.audioCodec&&(t.audioCodec="opus"),r.onSuccess(),new ZH(JH(JH({forceWaitGatewayResponse:!0},t),{},{role:Ur(e=["rtc","p2p"]).call(e,t.mode)?"host":t.role||"audience"}),n)},createCameraVideoTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=UN("CAMERA_CAPTURE_CONFIG"),n=LA(8,"track-cam-"),r=_k.reportApiInvoke(null,{id:n,tag:oA.TRACER,name:rA.CREATE_CAM_VIDEO_TRACK,options:[hP({},e),t]});t&&(e.encoderConfig=t);const o=ZP(e);let i=null;pk.info("start create camera video track with config",JSON.stringify(e),"trackId",n);try{i=(await PP({video:o},n)).getVideoTracks()[0]||null}catch(e){throw r.onError(e),e}if(!i){const e=new FI(jI.UNEXPECTED_ERROR,"can not find track in media stream");return r.onError(e),e.throw(pk)}e.optimizationMode&&LM(n,i,e,Mk(e.encoderConfig));const a=new MM(i,e,o,e.scalabiltyMode?xk(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,n);return r.onSuccess(a.getTrackId()),pk.info("create camera video success, trackId:",n),a},createCustomVideoTrack:function(e){const t=LA(8,"track-cus-"),n=_k.reportApiInvoke(null,{id:t,tag:oA.TRACER,name:rA.CREATE_CUSTOM_VIDEO_TRACK,options:[e]}),r=new DM(e.mediaStreamTrack,{width:e.width,height:e.height,frameRate:e.frameRate,bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?xk(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,t,[Hk.CUSTOM_TRACK]);return n.onSuccess(r.getTrackId()),pk.info("create custom video track success with config",e,"trackId",r.getTrackId()),r},createScreenVideoTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"disable";const n="object"==typeof t?function(e){return QP(e)}(t):void 0;n&&(t="auto");const r=LA(8,"track-scr-v-"),o=_k.reportApiInvoke(null,{id:r,tag:oA.TRACER,name:rA.CREATE_SCREEN_VIDEO_TRACK,options:[hP({},e),t]});e.encoderConfig?"string"==typeof e.encoderConfig||e.encoderConfig.width&&e.encoderConfig.height||(e.encoderConfig.width={max:1920},e.encoderConfig.height={max:1080}):e.encoderConfig="1080p_2";const i=function(e){const t={};e.screenSourceType&&(t.mediaSource=e.screenSourceType),e.extensionId&&dI()&&(t.extensionId=e.extensionId);const{displaySurface:n,selfBrowserSurface:r,surfaceSwitching:o,systemAudio:i,preferCurrentTab:a}=e;(vI(107)||yI(107)||SI(93))&&(n&&(VI(n,"displaySurface",["browser","window","monitor"]),t.displaySurface=n),r?(VI(r,"selfBrowserSurface",["exclude","include"]),t.selfBrowserSurface=r):t.selfBrowserSurface="include",o&&(VI(o,"surfaceSwitching",["exclude","include"]),t.surfaceSwitching=o)),(vI(105)||yI(105)||SI(91))&&i&&(VI(i,"systemAudio",["exclude","include"]),t.systemAudio=i),(vI(94)||yI(94)||SI(80))&&a&&(t.preferCurrentTab=!0),e.electronScreenSourceId&&(t.sourceId=e.electronScreenSourceId);const s=e.encoderConfig?Lk(e.encoderConfig):null;return t.mandatory={chromeMediaSource:"desktop",maxWidth:s?s.width:void 0,maxHeight:s?s.height:void 0},s&&(s.frameRate&&("number"==typeof s.frameRate?(t.mandatory.maxFrameRate=s.frameRate,t.mandatory.minFrameRate=s.frameRate):(t.mandatory.maxFrameRate=s.frameRate.max||s.frameRate.ideal||s.frameRate.exact||void 0,t.mandatory.minFrameRate=s.frameRate.min||s.frameRate.ideal||s.frameRate.exact||void 0),t.frameRate=s.frameRate),s.width&&(t.width=s.width),s.height&&(t.height=s.height)),t}(e);let a=null,s=null;const c=Sk();if(!c.supportShareAudio&&"enable"===t){const e=new FI(jI.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return o.onError(e),e.throw(pk)}pk.info("start create screen video track with config",e,"withAudio",t,"trackId",r);const l=c.supportShareAudio&&"disable"!==t;try{const e=await PP({screen:i,screenAudio:l?n||!0:void 0},r);a=e.getVideoTracks()[0]||null,s=e.getAudioTracks()[0]||null}catch(e){throw o.onError(e),e}if(!a){const e=new FI(jI.UNEXPECTED_ERROR,"can not find track in media stream");return o.onError(e),e.throw(pk)}if(!s&&"enable"===t){a&&a.stop();const e=new FI(jI.SHARE_AUDIO_NOT_ALLOWED);return o.onError(e),e.throw(pk)}e.optimizationMode||(e.optimizationMode="detail"),e.optimizationMode&&(LM(r,a,e,e.encoderConfig&&Lk(e.encoderConfig)||void 0),e.encoderConfig&&"string"!=typeof e.encoderConfig&&(e.encoderConfig.bitrateMin=e.encoderConfig.bitrateMax));const u=new DM(a,e.encoderConfig?Lk(e.encoderConfig):{},e.scalabiltyMode?xk(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,r,[Hk.SCREEN_TRACK]);if(!s)return o.onSuccess(u.getTrackId()),pk.info("create screen video track success","video:",u.getTrackId()),u;const d=new WD(s,void 0,LA(8,"track-scr-a-"),!1);return o.onSuccess([u.getTrackId(),d.getTrackId()]),pk.info("create screen video track success","video:",u.getTrackId(),"audio:",d.getTrackId()),[u,d]},createMicrophoneAndCameraTracks:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=UN("CAMERA_CAPTURE_CONFIG"),r=LA(8,"track-mic-"),o=LA(8,"track-cam-"),i=_k.reportApiInvoke(null,{id:"".concat(r,"-").concat(o),tag:oA.TRACER,name:rA.CREATE_MIC_AND_CAM_TRACKS,options:[e,t,n]});n&&(t.encoderConfig=n);const a=ZP(t),s=$P(e);let c=null,l=null;pk.info("start create camera video track(".concat(o,") and microphone audio track(").concat(r,") with config, audio: ").concat(JSON.stringify(e),", video: ").concat(JSON.stringify(t)));try{const e=await PP({audio:s,video:a},"".concat(r,"-").concat(o));c=e.getAudioTracks()[0],l=e.getVideoTracks()[0]}catch(e){throw i.onError(e),e}if(!c||!l){const e=new FI(jI.UNEXPECTED_ERROR,"can not find tracks in media stream");return i.onError(e),e.throw(pk)}t.optimizationMode&&LM(o,l,t,Mk(t.encoderConfig));const u=new qD(c,e,s,r),d=new MM(l,t,a,t.scalabiltyMode?xk(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,o);return i.onSuccess([u.getTrackId(),d.getTrackId()]),pk.info("create camera video track(".concat(o,") and microphone audio track(").concat(r,") success")),[u,d]},createMicrophoneAudioTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=LA(8,"track-mic-"),n=_k.reportApiInvoke(null,{id:t,tag:oA.TRACER,name:rA.CREATE_MIC_AUDIO_TRACK,options:[e]}),r=$P(e);let o=null;pk.info("start create microphone audio track with config",JSON.stringify(e),"trackId",t);try{o=(await PP({audio:r},t)).getAudioTracks()[0]||null}catch(e){throw n.onError(e),e}if(!o){const e=new FI(jI.UNEXPECTED_ERROR,"can not find track in media stream");return n.onError(e),e.throw(pk)}const i=new qD(o,e,r,t);return n.onSuccess(i.getTrackId()),pk.info("create microphone audio track success, trackId:",t),i},createCustomAudioTrack:function(e){const t=LA(8,"track-cus-"),n=_k.reportApiInvoke(null,{id:t,tag:oA.TRACER,name:rA.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),r=new WD(e.mediaStreamTrack,e.encoderConfig?jk(e.encoderConfig):{},t,!1);return pk.info("create custom audio track success with config",e,"trackId",r.getTrackId()),n.onSuccess(r.getTrackId()),r},createBufferSourceAudioTrack:async function(e){var t;const{cacheOnlineFile:n,encoderConfig:r}=e;let{source:o}=e;const i={source:o instanceof AudioBuffer?"AudioBuffer":o instanceof File?null!==(t=File.name)&&void 0!==t?t:"File":o,cacheOnlineFile:n,encoderConfig:r},a=LA(8,"track-buf-"),s=_k.reportApiInvoke(null,{id:a,tag:oA.TRACER,name:rA.CREATE_BUFFER_AUDIO_TRACK,options:[i]});if(UN("DISABLE_WEBAUDIO"))throw new FI(jI.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");pk.info("start create buffer source audio track with config",JSON.stringify(i),"trackId",a);const c=o;if(!(o instanceof AudioBuffer))try{o=await async function(e,t){let n=null;if("string"==typeof e){const t=XD.get(e);if(t)return pk.debug("use cached audio resource: ",e),t;try{n=(await ZA((()=>Xw.get(e,{responseType:"arraybuffer"})),void 0,void 0,{maxRetryCount:3})).data}catch(e){throw new FI(jI.FETCH_AUDIO_FILE_FAILED,e.toString())}}else{const t=new ih(((t,n)=>{const r=new FileReader;r.onload=e=>{e.target?t(e.target.result):n(new FI(jI.READ_LOCAL_AUDIO_FILE_ERROR))},r.onerror=()=>{n(new FI(jI.READ_LOCAL_AUDIO_FILE_ERROR))},r.readAsArrayBuffer(e)}));n=await t}const r=await function(e){const t=yP();return new ih(((n,r)=>{t.decodeAudioData(e,(e=>{n(e)}),(e=>{r(new FI(jI.DECODE_AUDIO_FILE_FAILED,e.toString()))}))}))}(n);return"string"==typeof e&&t&&XD.set(e,r),r}(o,n)}catch(e){return s.onError(e),e.throw(pk)}const l=new zD(o),u=new KD(c,l,r?jk(r):{},a);return pk.info("create buffer source audio track success, trackId:",a),s.onSuccess(u.getTrackId()),u},setAppType:function(e){if(pk.debug("setAppType: ".concat(e)),!(Number.isInteger(e)&&e>=0))throw pk.debug("Invalid appType"),new bk(jI.INVALID_PARAMS,"invalid app type",e);xN("APP_TYPE",Math.floor(e))},setLogLevel:function(e){pk.setLogLevel(e)},enableLogUpload:function(){UN("USE_NEW_LOG")?xN("UPLOAD_LOG",!0):pk.enableLogUpload()},disableLogUpload:function(){UN("USE_NEW_LOG")?xN("UPLOAD_LOG",!1):pk.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new FF},checkAudioTrackIsActive:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const n=_k.reportApiInvoke(null,{tag:oA.TRACER,name:rA.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof WD||e instanceof JM)){const e=new bk(jI.INVALID_TRACK,"the parameter is not a audio track");return n.onError(e),e.throw()}t&&t<1e3&&(t=1e3);const r=e instanceof WD?e.getTrackLabel():"remote_track",o=e.getVolumeLevel();let i=o,a=o;const s=Date.now();return new ih((o=>{const c=setInterval((()=>{const l=e.getVolumeLevel();i=l>i?l:i,a=l<a?l:a;const u=i-a>1e-4,d=Date.now()-s;if(u||d>t){clearInterval(c);const t=u,a={duration:d,deviceLabel:r,maxVolumeLevel:i,result:t};pk.info("[track-".concat(e.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(a))),n.onSuccess(a),o(t)}}),200)}))},checkVideoTrackIsActive:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const n=_k.reportApiInvoke(null,{tag:oA.TRACER,name:rA.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof DM||e instanceof XM)){const e=new bk(jI.INVALID_TRACK,"the parameter is not a video track");return n.onError(e),e.throw()}t&&t<1e3&&(t=1e3);const r=e instanceof DM?e.getTrackLabel():"remote_track",o=e.getMediaStreamTrack(!0),i=document.createElement("video");i.style.width="1px",i.style.height="1px",i.setAttribute("muted",""),i.muted=!0,i.setAttribute("playsinline",""),i.controls=!1,(pI()||uI())&&(i.style.opacity="0.01",i.style.position="fixed",i.style.left="0",i.style.top="0",document.body.appendChild(i)),i.srcObject=new MediaStream([o]),i.play();const a=document.createElement("canvas");a.width=160,a.height=120;let s=0,c=0;try{const e=Date.now();s=await function(e,t,n,r){let o,i=0,a=null;return new ih(((s,c)=>{function l(){i>r&&o&&(o(),s(i));const t=n.getContext("2d");if(!t){const e=new bk(jI.UNEXPECTED_ERROR,"can not get canvas 2d context.");return pk.error(e.toString()),void c(e)}t.drawImage(e,0,0,160,120);const l=t.getImageData(0,0,n.width,n.height),u=Math.floor(l.data.length/3);if(a){for(let e=0;e<u;e+=3)if(l.data[e]!==a[e])return i+=1,void(a=l.data);a=l.data}else a=l.data}setTimeout((()=>{o&&(o(),s(i))}),t),o=TP((()=>{l()}),30)}))}(i,t,a,4),c=Date.now()-e}catch(e){throw n.onError(e),e}oV===nI.SAFARI&&(i.pause(),i.remove()),i.srcObject=null;const l=s>4,u={duration:c,changedPicNum:s,deviceLabel:r,result:l};return pk.info("[track-".concat(e.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(u))),n.onSuccess(u),l},setArea:oF,audioElementPlayCenter:HP,resumeAudioContext:function(){HP.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(e){nG.processExternalMediaAEC(e)},registerExtensions:function(e){const t=UN("PLUGIN_INFO")||[];e.forEach((e=>{"name"in e&&!Ur(t).call(t,e.name)&&t.push(e.name);const n=e;n.__registered__=!0,n.logger.hookLog=pk.extLog,n.reporter.hookApiInvoke=_k.extApiInvoke,n.parameters&&Object.keys(n.parameters).forEach((e=>{n.parameters[e]=UN(e)}))})),bz("PLUGIN_INFO",t)},ChannelMediaRelayError:Jx,ChannelMediaRelayEvent:zx,ChannelMediaRelayState:Xx,RemoteStreamFallbackType:qk,RemoteStreamType:Wk,ConnectionDisconnectedReason:sA,AudienceLatencyLevelType:aA,AREAS:tU,preload:async function(e,t,n,r){return gV(e,t,n,r)}});return Object.defineProperties(Tz,{onAudioAutoplayFailed:{get:()=>jP.onAudioAutoplayFailed,set:e=>{jP.onAudioAutoplayFailed=e}},onAutoplayFailed:{get:()=>jP.onAutoplayFailed,set:e=>{jP.onAutoplayFailed=e}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>Tz._onSecurityPolicyViolation,set(e){Tz._onSecurityPolicyViolation=e,aG(e)}},__CLIENT_LIST__:{get:()=>UN("SHOW_GLOBAL_CLIENT_LIST")?UL:[]}}),xP.on(iP.CAMERA_DEVICE_CHANGED,(e=>{pk.info("camera device changed",JSON.stringify(e)),Tz.onCameraChanged&&Tz.onCameraChanged(e),Tz.safeEmit(_U.CAMERA_CHANGED,e)})),xP.on(iP.RECORDING_DEVICE_CHANGED,(e=>{pk.info("microphone device changed",JSON.stringify(e)),Tz.onMicrophoneChanged&&Tz.onMicrophoneChanged(e),Tz.safeEmit(_U.MICROPHONE_CHANGED,e)})),xP.on(iP.PLAYOUT_DEVICE_CHANGED,(e=>{pk.debug("playout device changed",JSON.stringify(e)),Tz.onPlaybackDeviceChanged&&Tz.onPlaybackDeviceChanged(e),Tz.safeEmit(_U.PLAYBACK_DEVICE_CHANGED,e)})),HP.onAutoplayFailed=()=>{pk.info("detect audio element autoplay failed"),jP.onAudioAutoplayFailed&&jP.onAudioAutoplayFailed()},EP.on("autoplay-failed",(()=>{pk.info("detect webaudio autoplay failed"),jP.onAudioAutoplayFailed&&jP.onAudioAutoplayFailed(),Tz.safeEmit(_U.AUTOPLAY_FAILED)})),EP.on(Ck.STATE_CHANGE,((e,t)=>{pk.info("audio context state changed: ".concat(t," => ").concat(e)),Tz.onAudioContextStateChanged&&Tz.onAudioContextStateChanged(e,t),Tz.safeEmit(_U.AUDIO_CONTEXT_STATE_CHANGED,e,t)})),yA.on(fA.NETWORK_STATE_CHANGE,((e,t)=>{pk.info("[network-indicator] network state changed, ".concat(t," => ").concat(e))})),window&&(window.__ARTC__=Tz),Tz}()}).call(this,n(36),n(39),n(400).Buffer)},,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return pe}));var r=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(o){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)})),this.tags=[],this.ctr=0},e}(),o="-ms-",i="-moz-",a="-webkit-",s="comm",c="rule",l="decl",u="@keyframes",d=Math.abs,p=String.fromCharCode,h=Object.assign;function f(e,t){return 45^y(e,0)?(((t<<2^y(e,0))<<2^y(e,1))<<2^y(e,2))<<2^y(e,3):0}function m(e){return e.trim()}function v(e,t){return(e=t.exec(e))?e[0]:e}function g(e,t,n){return e.replace(t,n)}function E(e,t){return e.indexOf(t)}function y(e,t){return 0|e.charCodeAt(t)}function _(e,t,n){return e.slice(t,n)}function b(e){return e.length}function T(e){return e.length}function S(e,t){return t.push(e),e}function O(e,t){return e.map(t).join("")}var R=1,C=1,w=0,I=0,A=0,N="";function k(e,t,n,r,o,i,a){return{value:e,root:t,parent:n,type:r,props:o,children:i,line:R,column:C,length:a,return:""}}function P(e,t){return h(k("",null,null,"",null,null,0),e,{length:-e.length},t)}function D(){return A=I<w?y(N,I++):0,C++,10===A&&(C=1,R++),A}function M(){return y(N,I)}function L(){return I}function x(e,t){return _(N,e,t)}function U(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function j(e){return R=C=1,w=b(N=e),I=0,[]}function F(e){return N="",e}function B(e){return m(x(I-1,G(91===e?e+2:40===e?e+1:e)))}function V(e){for(;(A=M())&&A<33;)D();return U(e)>2||U(A)>3?"":" "}function H(e,t){for(;--t&&D()&&!(A<48||A>102||A>57&&A<65||A>70&&A<97););return x(e,L()+(t<6&&32==M()&&32==D()))}function G(e){for(;D();)switch(A){case e:return I;case 34:case 39:34!==e&&39!==e&&G(A);break;case 40:41===e&&G(e);break;case 92:D()}return I}function W(e,t){for(;D()&&e+A!==57&&(e+A!==84||47!==M()););return"/*"+x(t,I-1)+"*"+p(47===e?e:D())}function q(e){for(;!U(M());)D();return x(e,I)}function K(e){return F(Y("",null,null,null,[""],e=j(e),0,[0],e))}function Y(e,t,n,r,o,i,a,s,c){for(var l=0,u=0,d=a,h=0,f=0,m=0,v=1,_=1,T=1,O=0,w="",k=o,P=i,x=r,U=w;_;)switch(m=O,O=D()){case 40:if(108!=m&&58==y(U,d-1)){-1!=E(U+=g(B(O),"&","&\f"),"&\f")&&(T=-1);break}case 34:case 39:case 91:U+=B(O);break;case 9:case 10:case 13:case 32:U+=V(m);break;case 92:U+=H(L()-1,7);continue;case 47:switch(M()){case 42:case 47:S(X(W(D(),L()),t,n),c);break;default:U+="/"}break;case 123*v:s[l++]=b(U)*T;case 125*v:case 59:case 0:switch(O){case 0:case 125:_=0;case 59+u:-1==T&&(U=g(U,/\f/g,"")),f>0&&b(U)-d&&S(f>32?J(U+";",r,n,d-1):J(g(U," ","")+";",r,n,d-2),c);break;case 59:U+=";";default:if(S(x=z(U,t,n,l,u,o,s,w,k=[],P=[],d),i),123===O)if(0===u)Y(U,t,x,x,k,i,d,s,P);else switch(99===h&&110===y(U,3)?100:h){case 100:case 108:case 109:case 115:Y(e,x,x,r&&S(z(e,x,x,0,0,o,s,w,o,k=[],d),P),o,P,d,s,r?k:P);break;default:Y(U,x,x,x,[""],P,0,s,P)}}l=u=f=0,v=T=1,w=U="",d=a;break;case 58:d=1+b(U),f=m;default:if(v<1)if(123==O)--v;else if(125==O&&0==v++&&125==(A=I>0?y(N,--I):0,C--,10===A&&(C=1,R--),A))continue;switch(U+=p(O),O*v){case 38:T=u>0?1:(U+="\f",-1);break;case 44:s[l++]=(b(U)-1)*T,T=1;break;case 64:45===M()&&(U+=B(D())),h=M(),u=d=b(w=U+=q(L())),O++;break;case 45:45===m&&2==b(U)&&(v=0)}}return i}function z(e,t,n,r,o,i,a,s,l,u,p){for(var h=o-1,f=0===o?i:[""],v=T(f),E=0,y=0,b=0;E<r;++E)for(var S=0,O=_(e,h+1,h=d(y=a[E])),R=e;S<v;++S)(R=m(y>0?f[S]+" "+O:g(O,/&\f/g,f[S])))&&(l[b++]=R);return k(e,t,n,0===o?c:s,l,u,p)}function X(e,t,n){return k(e,t,n,s,p(A),_(e,2,-2),0)}function J(e,t,n,r){return k(e,t,n,l,_(e,0,r),_(e,r+1,-1),r)}function Z(e,t){for(var n="",r=T(e),o=0;o<r;o++)n+=t(e[o],o,e,t)||"";return n}function Q(e,t,n,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case l:return e.return=e.return||e.value;case s:return"";case u:return e.return=e.value+"{"+Z(e.children,r)+"}";case c:e.value=e.props.join(",")}return b(n=Z(e.children,r))?e.return=e.value+"{"+n+"}":""}function $(e){var t=T(e);return function(n,r,o,i){for(var a="",s=0;s<t;s++)a+=e[s](n,r,o,i)||"";return a}}function ee(e){return function(t){t.root||(t=t.return)&&e(t)}}var te=n(290),ne=n(385),re="undefined"!==typeof document,oe=function(e,t,n){for(var r=0,o=0;r=o,o=M(),38===r&&12===o&&(t[n]=1),!U(o);)D();return x(e,I)},ie=function(e,t){return F(function(e,t){var n=-1,r=44;do{switch(U(r)){case 0:38===r&&12===M()&&(t[n]=1),e[n]+=oe(I-1,t,n);break;case 2:e[n]+=B(r);break;case 4:if(44===r){e[++n]=58===M()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=p(r)}}while(r=D());return e}(j(e),t))},ae=new WeakMap,se=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||ae.get(n))&&!r){ae.set(e,!0);for(var o=[],i=ie(t,o),a=n.props,s=0,c=0;s<i.length;s++)for(var l=0;l<a.length;l++,c++)e.props[c]=o[s]?i[s].replace(/&\f/g,a[l]):a[l]+" "+i[s]}}},ce=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function le(e,t){switch(f(e,t)){case 5103:return a+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return a+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return a+e+i+e+o+e+e;case 6828:case 4268:return a+e+o+e+e;case 6165:return a+e+o+"flex-"+e+e;case 5187:return a+e+g(e,/(\w+).+(:[^]+)/,a+"box-$1$2"+o+"flex-$1$2")+e;case 5443:return a+e+o+"flex-item-"+g(e,/flex-|-self/,"")+e;case 4675:return a+e+o+"flex-line-pack"+g(e,/align-content|flex-|-self/,"")+e;case 5548:return a+e+o+g(e,"shrink","negative")+e;case 5292:return a+e+o+g(e,"basis","preferred-size")+e;case 6060:return a+"box-"+g(e,"-grow","")+a+e+o+g(e,"grow","positive")+e;case 4554:return a+g(e,/([^-])(transform)/g,"$1"+a+"$2")+e;case 6187:return g(g(g(e,/(zoom-|grab)/,a+"$1"),/(image-set)/,a+"$1"),e,"")+e;case 5495:case 3959:return g(e,/(image-set\([^]*)/,a+"$1$`$1");case 4968:return g(g(e,/(.+:)(flex-)?(.*)/,a+"box-pack:$3"+o+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+a+e+e;case 4095:case 3583:case 4068:case 2532:return g(e,/(.+)-inline(.+)/,a+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(b(e)-1-t>6)switch(y(e,t+1)){case 109:if(45!==y(e,t+4))break;case 102:return g(e,/(.+:)(.+)-([^]+)/,"$1"+a+"$2-$3$1"+i+(108==y(e,t+3)?"$3":"$2-$3"))+e;case 115:return~E(e,"stretch")?le(g(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==y(e,t+1))break;case 6444:switch(y(e,b(e)-3-(~E(e,"!important")&&10))){case 107:return g(e,":",":"+a)+e;case 101:return g(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+a+(45===y(e,14)?"inline-":"")+"box$3$1"+a+"$2$3$1"+o+"$2box$3")+e}break;case 5936:switch(y(e,t+11)){case 114:return a+e+o+g(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return a+e+o+g(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return a+e+o+g(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return a+e+o+e+e}return e}var ue=re?void 0:Object(te.a)((function(){return Object(ne.a)((function(){return{}}))})),de=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case l:e.return=le(e.value,e.length);break;case u:return Z([P(e,{value:g(e.value,"@","@"+a)})],r);case c:if(e.length)return O(e.props,(function(t){switch(v(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Z([P(e,{props:[g(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return Z([P(e,{props:[g(t,/:(plac\w+)/,":"+a+"input-$1")]}),P(e,{props:[g(t,/:(plac\w+)/,":-moz-$1")]}),P(e,{props:[g(t,/:(plac\w+)/,o+"input-$1")]})],r)}return""}))}}],pe=function(e){var t=e.key;if(re&&"css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var o,i,a=e.stylisPlugins||de,s={},c=[];re&&(o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)s[t[n]]=!0;c.push(e)})));var l=[se,ce];if(ue){var u=[Q],d=$(l.concat(a,u)),p=ue(a)(t),h=function(e,t){var n=t.name;return void 0===p[n]&&(p[n]=Z(K(e?e+"{"+t.styles+"}":t.styles),d)),p[n]};i=function(e,t,n,r){var o=t.name,i=h(e,t);return void 0===g.compat?(r&&(g.inserted[o]=!0),i):r?void(g.inserted[o]=i):i}}else{var f,m=[Q,ee((function(e){f.insert(e)}))],v=$(l.concat(a,m));i=function(e,t,n,r){f=n,Z(K(e?e+"{"+t.styles+"}":t.styles),v),r&&(g.inserted[t.name]=!0)}}var g={key:t,sheet:new r({key:t,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:i};return g.sheet.hydrate(c),g}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(132),o=n(126),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=Object(o.default)(e),a=Object(r.a)(t),s=n.getFullYear(),c=n.getDate(),l=new Date(0);l.setFullYear(s,a,15),l.setHours(0,0,0,0);var u=function(e){Object(i.a)(1,arguments);var t=Object(o.default)(e),n=t.getFullYear(),r=t.getMonth(),a=new Date(0);return a.setFullYear(n,r+1,0),a.setHours(0,0,0,0),a.getDate()}(l);return n.setMonth(a,Math.min(c,u)),n}},,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";var r={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var t=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||t>=r.F1&&t<=r.F12)return!1;switch(t){case r.ALT:case r.CAPS_LOCK:case r.CONTEXT_MENU:case r.CTRL:case r.DOWN:case r.END:case r.ESC:case r.HOME:case r.INSERT:case r.LEFT:case r.MAC_FF_META:case r.META:case r.NUMLOCK:case r.NUM_CENTER:case r.PAGE_DOWN:case r.PAGE_UP:case r.PAUSE:case r.PRINT_SCREEN:case r.RIGHT:case r.SHIFT:case r.UP:case r.WIN_KEY:case r.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=r.ZERO&&e<=r.NINE)return!0;if(e>=r.NUM_ZERO&&e<=r.NUM_MULTIPLY)return!0;if(e>=r.A&&e<=r.Z)return!0;if(-1!==window.navigator.userAgent.indexOf("WebKit")&&0===e)return!0;switch(e){case r.SPACE:case r.QUESTION_MARK:case r.NUM_PLUS:case r.NUM_MINUS:case r.NUM_PERIOD:case r.NUM_DIVISION:case r.SEMICOLON:case r.DASH:case r.EQUALS:case r.COMMA:case r.PERIOD:case r.SLASH:case r.APOSTROPHE:case r.SINGLE_QUOTE:case r.OPEN_SQUARE_BRACKET:case r.BACKSLASH:case r.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}};t.a=r},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=c(i),s=c(n(31));function c(e){return e&&e.__esModule?e:{default:e}}var l={position:"absolute",top:0,left:0,visibility:"hidden",height:0,overflow:"scroll",whiteSpace:"pre"},u=["extraWidth","injectStyles","inputClassName","inputRef","inputStyle","minWidth","onAutosize","placeholderIsMinWidth"],d=function(e,t){t.style.fontSize=e.fontSize,t.style.fontFamily=e.fontFamily,t.style.fontWeight=e.fontWeight,t.style.fontStyle=e.fontStyle,t.style.letterSpacing=e.letterSpacing,t.style.textTransform=e.textTransform},p=!("undefined"===typeof window||!window.navigator)&&/MSIE |Trident\/|Edge\//.test(window.navigator.userAgent),h=function(){return p?"_"+Math.random().toString(36).substr(2,12):void 0},f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.inputRef=function(e){n.input=e,"function"===typeof n.props.inputRef&&n.props.inputRef(e)},n.placeHolderSizerRef=function(e){n.placeHolderSizer=e},n.sizerRef=function(e){n.sizer=e},n.state={inputWidth:e.minWidth,inputId:e.id||h(),prevId:e.id},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.id;return n!==t.prevId?{inputId:n||h(),prevId:n}:null}}]),o(t,[{key:"componentDidMount",value:function(){this.mounted=!0,this.copyInputStyles(),this.updateInputWidth()}},{key:"componentDidUpdate",value:function(e,t){t.inputWidth!==this.state.inputWidth&&"function"===typeof this.props.onAutosize&&this.props.onAutosize(this.state.inputWidth),this.updateInputWidth()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"copyInputStyles",value:function(){if(this.mounted&&window.getComputedStyle){var e=this.input&&window.getComputedStyle(this.input);e&&(d(e,this.sizer),this.placeHolderSizer&&d(e,this.placeHolderSizer))}}},{key:"updateInputWidth",value:function(){if(this.mounted&&this.sizer&&"undefined"!==typeof this.sizer.scrollWidth){var e=void 0;e=this.props.placeholder&&(!this.props.value||this.props.value&&this.props.placeholderIsMinWidth)?Math.max(this.sizer.scrollWidth,this.placeHolderSizer.scrollWidth)+2:this.sizer.scrollWidth+2,(e+="number"===this.props.type&&void 0===this.props.extraWidth?16:parseInt(this.props.extraWidth)||0)<this.props.minWidth&&(e=this.props.minWidth),e!==this.state.inputWidth&&this.setState({inputWidth:e})}}},{key:"getInput",value:function(){return this.input}},{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"select",value:function(){this.input.select()}},{key:"renderStyles",value:function(){var e=this.props.injectStyles;return p&&e?a.default.createElement("style",{dangerouslySetInnerHTML:{__html:"input#"+this.state.inputId+"::-ms-clear {display: none;}"}}):null}},{key:"render",value:function(){var e=[this.props.defaultValue,this.props.value,""].reduce((function(e,t){return null!==e&&void 0!==e?e:t})),t=r({},this.props.style);t.display||(t.display="inline-block");var n=r({boxSizing:"content-box",width:this.state.inputWidth+"px"},this.props.inputStyle),o=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(this.props,[]);return function(e){u.forEach((function(t){return delete e[t]}))}(o),o.className=this.props.inputClassName,o.id=this.state.inputId,o.style=n,a.default.createElement("div",{className:this.props.className,style:t},this.renderStyles(),a.default.createElement("input",r({},o,{ref:this.inputRef})),a.default.createElement("div",{ref:this.sizerRef,style:l},e),this.props.placeholder?a.default.createElement("div",{ref:this.placeHolderSizerRef,style:l},this.props.placeholder):null)}}]),t}(i.Component);f.propTypes={className:s.default.string,defaultValue:s.default.any,extraWidth:s.default.oneOfType([s.default.number,s.default.string]),id:s.default.string,injectStyles:s.default.bool,inputClassName:s.default.string,inputRef:s.default.func,inputStyle:s.default.object,minWidth:s.default.oneOfType([s.default.number,s.default.string]),onAutosize:s.default.func,onChange:s.default.func,placeholder:s.default.string,placeholderIsMinWidth:s.default.bool,style:s.default.object,value:s.default.any},f.defaultProps={minWidth:1,injectStyles:!0},t.default=f},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));var r="undefined"!==typeof document;function o(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):n&&(r+=n+" ")})),r}var i=function(e,t,n){var o=e.key+"-"+t.name;(!1===n||!1===r&&void 0!==e.compat)&&void 0===e.registered[o]&&(e.registered[o]=t.styles)},a=function(e,t,n){i(e,t,n);var o=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var a="",s=t;do{var c=e.insert(t===s?"."+o:"",s,e.sheet,!0);r||void 0===c||(a+=c),s=s.next}while(void 0!==s);if(!r&&0!==a.length)return a}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(2),o="undefined"!==typeof document,i=function(e){return e()},a=!!r.useInsertionEffect&&r.useInsertionEffect,s=o&&a||i,c=a||r.useLayoutEffect},function(e,t,n){"use strict";function r(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(32),o=n.n(r),i=function(e,t){return o()(e,t)}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(349);e.exports=function(e,t){if(null==e)return{};var n,o,i=r(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";function r(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,"a",(function(){return r}))},,,,,,,,,,function(e,t,n){(function(t){var n;"undefined"!==typeof self&&self,n=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=109)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(18),i=n(19),a=n(45),s=n(46),c=n(47),l=n(48),u=n(49),d=n(12),p=n(32),h=n(33),f=n(31),m=n(1),v={Scope:m.Scope,create:m.create,find:m.find,query:m.query,register:m.register,Container:r.default,Format:o.default,Leaf:i.default,Embed:l.default,Scroll:a.default,Block:c.default,Inline:s.default,Text:u.default,Attributor:{Attribute:d.default,Class:p.default,Style:h.default,Store:f.default}};t.default=v},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var n=this;return t="[Parchment] "+t,(n=e.call(this,t)||this).message=t,n.name=n.constructor.name,n}return r(t,e),t}(Error);t.ParchmentError=o;var i,a={},s={},c={},l={};function u(e,t){var n;if(void 0===t&&(t=i.ANY),"string"===typeof e)n=l[e]||a[e];else if(e instanceof Text||e.nodeType===Node.TEXT_NODE)n=l.text;else if("number"===typeof e)e&i.LEVEL&i.BLOCK?n=l.block:e&i.LEVEL&i.INLINE&&(n=l.inline);else if(e instanceof HTMLElement){var r=(e.getAttribute("class")||"").split(/\s+/);for(var o in r)if(n=s[r[o]])break;n=n||c[e.tagName]}return null==n?null:t&i.LEVEL&n.scope&&t&i.TYPE&n.scope?n:null}t.DATA_KEY="__blot",function(e){e[e.TYPE=3]="TYPE",e[e.LEVEL=12]="LEVEL",e[e.ATTRIBUTE=13]="ATTRIBUTE",e[e.BLOT=14]="BLOT",e[e.INLINE=7]="INLINE",e[e.BLOCK=11]="BLOCK",e[e.BLOCK_BLOT=10]="BLOCK_BLOT",e[e.INLINE_BLOT=6]="INLINE_BLOT",e[e.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",e[e.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",e[e.ANY=15]="ANY"}(i=t.Scope||(t.Scope={})),t.create=function(e,t){var n=u(e);if(null==n)throw new o("Unable to create "+e+" blot");var r=n,i=e instanceof Node||e.nodeType===Node.TEXT_NODE?e:r.create(t);return new r(i,t)},t.find=function e(n,r){return void 0===r&&(r=!1),null==n?null:null!=n[t.DATA_KEY]?n[t.DATA_KEY].blot:r?e(n.parentNode,r):null},t.query=u,t.register=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(t.length>1)return t.map((function(t){return e(t)}));var r=t[0];if("string"!==typeof r.blotName&&"string"!==typeof r.attrName)throw new o("Invalid definition");if("abstract"===r.blotName)throw new o("Cannot register abstract class");return l[r.blotName||r.attrName]=r,"string"===typeof r.keyName?a[r.keyName]=r:(null!=r.className&&(s[r.className]=r),null!=r.tagName&&(Array.isArray(r.tagName)?r.tagName=r.tagName.map((function(e){return e.toUpperCase()})):r.tagName=r.tagName.toUpperCase(),(Array.isArray(r.tagName)?r.tagName:[r.tagName]).forEach((function(e){null!=c[e]&&null!=r.className||(c[e]=r)})))),r}},function(e,t,n){var r=n(51),o=n(11),i=n(3),a=n(20),s=String.fromCharCode(0),c=function(e){Array.isArray(e)?this.ops=e:null!=e&&Array.isArray(e.ops)?this.ops=e.ops:this.ops=[]};c.prototype.insert=function(e,t){var n={};return 0===e.length?this:(n.insert=e,null!=t&&"object"===typeof t&&Object.keys(t).length>0&&(n.attributes=t),this.push(n))},c.prototype.delete=function(e){return e<=0?this:this.push({delete:e})},c.prototype.retain=function(e,t){if(e<=0)return this;var n={retain:e};return null!=t&&"object"===typeof t&&Object.keys(t).length>0&&(n.attributes=t),this.push(n)},c.prototype.push=function(e){var t=this.ops.length,n=this.ops[t-1];if(e=i(!0,{},e),"object"===typeof n){if("number"===typeof e.delete&&"number"===typeof n.delete)return this.ops[t-1]={delete:n.delete+e.delete},this;if("number"===typeof n.delete&&null!=e.insert&&(t-=1,"object"!==typeof(n=this.ops[t-1])))return this.ops.unshift(e),this;if(o(e.attributes,n.attributes)){if("string"===typeof e.insert&&"string"===typeof n.insert)return this.ops[t-1]={insert:n.insert+e.insert},"object"===typeof e.attributes&&(this.ops[t-1].attributes=e.attributes),this;if("number"===typeof e.retain&&"number"===typeof n.retain)return this.ops[t-1]={retain:n.retain+e.retain},"object"===typeof e.attributes&&(this.ops[t-1].attributes=e.attributes),this}}return t===this.ops.length?this.ops.push(e):this.ops.splice(t,0,e),this},c.prototype.chop=function(){var e=this.ops[this.ops.length-1];return e&&e.retain&&!e.attributes&&this.ops.pop(),this},c.prototype.filter=function(e){return this.ops.filter(e)},c.prototype.forEach=function(e){this.ops.forEach(e)},c.prototype.map=function(e){return this.ops.map(e)},c.prototype.partition=function(e){var t=[],n=[];return this.forEach((function(r){(e(r)?t:n).push(r)})),[t,n]},c.prototype.reduce=function(e,t){return this.ops.reduce(e,t)},c.prototype.changeLength=function(){return this.reduce((function(e,t){return t.insert?e+a.length(t):t.delete?e-t.delete:e}),0)},c.prototype.length=function(){return this.reduce((function(e,t){return e+a.length(t)}),0)},c.prototype.slice=function(e,t){e=e||0,"number"!==typeof t&&(t=1/0);for(var n=[],r=a.iterator(this.ops),o=0;o<t&&r.hasNext();){var i;o<e?i=r.next(e-o):(i=r.next(t-o),n.push(i)),o+=a.length(i)}return new c(n)},c.prototype.compose=function(e){var t=a.iterator(this.ops),n=a.iterator(e.ops),r=[],i=n.peek();if(null!=i&&"number"===typeof i.retain&&null==i.attributes){for(var s=i.retain;"insert"===t.peekType()&&t.peekLength()<=s;)s-=t.peekLength(),r.push(t.next());i.retain-s>0&&n.next(i.retain-s)}for(var l=new c(r);t.hasNext()||n.hasNext();)if("insert"===n.peekType())l.push(n.next());else if("delete"===t.peekType())l.push(t.next());else{var u=Math.min(t.peekLength(),n.peekLength()),d=t.next(u),p=n.next(u);if("number"===typeof p.retain){var h={};"number"===typeof d.retain?h.retain=u:h.insert=d.insert;var f=a.attributes.compose(d.attributes,p.attributes,"number"===typeof d.retain);if(f&&(h.attributes=f),l.push(h),!n.hasNext()&&o(l.ops[l.ops.length-1],h)){var m=new c(t.rest());return l.concat(m).chop()}}else"number"===typeof p.delete&&"number"===typeof d.retain&&l.push(p)}return l.chop()},c.prototype.concat=function(e){var t=new c(this.ops.slice());return e.ops.length>0&&(t.push(e.ops[0]),t.ops=t.ops.concat(e.ops.slice(1))),t},c.prototype.diff=function(e,t){if(this.ops===e.ops)return new c;var n=[this,e].map((function(t){return t.map((function(n){if(null!=n.insert)return"string"===typeof n.insert?n.insert:s;throw new Error("diff() called "+(t===e?"on":"with")+" non-document")})).join("")})),i=new c,l=r(n[0],n[1],t),u=a.iterator(this.ops),d=a.iterator(e.ops);return l.forEach((function(e){for(var t=e[1].length;t>0;){var n=0;switch(e[0]){case r.INSERT:n=Math.min(d.peekLength(),t),i.push(d.next(n));break;case r.DELETE:n=Math.min(t,u.peekLength()),u.next(n),i.delete(n);break;case r.EQUAL:n=Math.min(u.peekLength(),d.peekLength(),t);var s=u.next(n),c=d.next(n);o(s.insert,c.insert)?i.retain(n,a.attributes.diff(s.attributes,c.attributes)):i.push(c).delete(n)}t-=n}})),i.chop()},c.prototype.eachLine=function(e,t){t=t||"\n";for(var n=a.iterator(this.ops),r=new c,o=0;n.hasNext();){if("insert"!==n.peekType())return;var i=n.peek(),s=a.length(i)-n.peekLength(),l="string"===typeof i.insert?i.insert.indexOf(t,s)-s:-1;if(l<0)r.push(n.next());else if(l>0)r.push(n.next(l));else{if(!1===e(r,n.next(1).attributes||{},o))return;o+=1,r=new c}}r.length()>0&&e(r,{},o)},c.prototype.transform=function(e,t){if(t=!!t,"number"===typeof e)return this.transformPosition(e,t);for(var n=a.iterator(this.ops),r=a.iterator(e.ops),o=new c;n.hasNext()||r.hasNext();)if("insert"!==n.peekType()||!t&&"insert"===r.peekType())if("insert"===r.peekType())o.push(r.next());else{var i=Math.min(n.peekLength(),r.peekLength()),s=n.next(i),l=r.next(i);if(s.delete)continue;l.delete?o.push(l):o.retain(i,a.attributes.transform(s.attributes,l.attributes,t))}else o.retain(a.length(n.next()));return o.chop()},c.prototype.transformPosition=function(e,t){t=!!t;for(var n=a.iterator(this.ops),r=0;n.hasNext()&&r<=e;){var o=n.peekLength(),i=n.peekType();n.next(),"delete"!==i?("insert"===i&&(r<e||!t)&&(e+=o),r+=o):e-=Math.min(o,e-r)}return e},e.exports=c},function(e,t){"use strict";var n=Object.prototype.hasOwnProperty,r=Object.prototype.toString,o=Object.defineProperty,i=Object.getOwnPropertyDescriptor,a=function(e){return"function"===typeof Array.isArray?Array.isArray(e):"[object Array]"===r.call(e)},s=function(e){if(!e||"[object Object]"!==r.call(e))return!1;var t,o=n.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&n.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!o&&!i)return!1;for(t in e);return"undefined"===typeof t||n.call(e,t)},c=function(e,t){o&&"__proto__"===t.name?o(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},l=function(e,t){if("__proto__"===t){if(!n.call(e,t))return;if(i)return i(e,t).value}return e[t]};e.exports=function e(){var t,n,r,o,i,u,d=arguments[0],p=1,h=arguments.length,f=!1;for("boolean"===typeof d&&(f=d,d=arguments[1]||{},p=2),(null==d||"object"!==typeof d&&"function"!==typeof d)&&(d={});p<h;++p)if(null!=(t=arguments[p]))for(n in t)r=l(d,n),d!==(o=l(t,n))&&(f&&o&&(s(o)||(i=a(o)))?(i?(i=!1,u=r&&a(r)?r:[]):u=r&&s(r)?r:{},c(d,{name:n,newValue:e(f,u,o)})):"undefined"!==typeof o&&c(d,{name:n,newValue:o}));return d}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BlockEmbed=t.bubbleFormats=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=d(n(3)),a=d(n(2)),s=d(n(0)),c=d(n(16)),l=d(n(6)),u=d(n(7));function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function f(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var m=function(e){function t(){return p(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f(t,e),r(t,[{key:"attach",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"attach",this).call(this),this.attributes=new s.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return(new a.default).insert(this.value(),(0,i.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(e,t){var n=s.default.query(e,s.default.Scope.BLOCK_ATTRIBUTE);null!=n&&this.attributes.attribute(n,t)}},{key:"formatAt",value:function(e,t,n,r){this.format(n,r)}},{key:"insertAt",value:function(e,n,r){if("string"===typeof n&&n.endsWith("\n")){var i=s.default.create(v.blotName);this.parent.insertBefore(i,0===e?this:this.next),i.insertAt(0,n.slice(0,-1))}else o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"insertAt",this).call(this,e,n,r)}}]),t}(s.default.Embed);m.scope=s.default.Scope.BLOCK_BLOT;var v=function(e){function t(e){p(this,t);var n=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.cache={},n}return f(t,e),r(t,[{key:"delta",value:function(){return null==this.cache.delta&&(this.cache.delta=this.descendants(s.default.Leaf).reduce((function(e,t){return 0===t.length()?e:e.insert(t.value(),g(t))}),new a.default).insert("\n",g(this))),this.cache.delta}},{key:"deleteAt",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deleteAt",this).call(this,e,n),this.cache={}}},{key:"formatAt",value:function(e,n,r,i){n<=0||(s.default.query(r,s.default.Scope.BLOCK)?e+n===this.length()&&this.format(r,i):o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"formatAt",this).call(this,e,Math.min(n,this.length()-e-1),r,i),this.cache={})}},{key:"insertAt",value:function(e,n,r){if(null!=r)return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"insertAt",this).call(this,e,n,r);if(0!==n.length){var i=n.split("\n"),a=i.shift();a.length>0&&(e<this.length()-1||null==this.children.tail?o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"insertAt",this).call(this,Math.min(e,this.length()-1),a):this.children.tail.insertAt(this.children.tail.length(),a),this.cache={});var s=this;i.reduce((function(e,t){return(s=s.split(e,!0)).insertAt(0,t),t.length}),e+a.length)}}},{key:"insertBefore",value:function(e,n){var r=this.children.head;o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"insertBefore",this).call(this,e,n),r instanceof c.default&&r.remove(),this.cache={}}},{key:"length",value:function(){return null==this.cache.length&&(this.cache.length=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"length",this).call(this)+1),this.cache.length}},{key:"moveChildren",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"moveChildren",this).call(this,e,n),this.cache={}}},{key:"optimize",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"optimize",this).call(this,e),this.cache={}}},{key:"path",value:function(e){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"path",this).call(this,e,!0)}},{key:"removeChild",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"removeChild",this).call(this,e),this.cache={}}},{key:"split",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(n&&(0===e||e>=this.length()-1)){var r=this.clone();return 0===e?(this.parent.insertBefore(r,this),this):(this.parent.insertBefore(r,this.next),r)}var i=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"split",this).call(this,e,n);return this.cache={},i}}]),t}(s.default.Block);function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==e?t:("function"===typeof e.formats&&(t=(0,i.default)(t,e.formats())),null==e.parent||"scroll"==e.parent.blotName||e.parent.statics.scope!==e.statics.scope?t:g(e.parent,t))}v.blotName="block",v.tagName="P",v.defaultChild="break",v.allowedChildren=[l.default,s.default.Embed,u.default],t.bubbleFormats=g,t.BlockEmbed=m,t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.overload=t.expandConfig=void 0;var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(50);var a=v(n(2)),s=v(n(14)),c=v(n(8)),l=v(n(9)),u=v(n(0)),d=n(15),p=v(d),h=v(n(3)),f=v(n(10)),m=v(n(34));function v(e){return e&&e.__esModule?e:{default:e}}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=(0,f.default)("quill"),y=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=_(t,r),this.container=this.options.container,null==this.container)return E.error("Invalid Quill container",t);this.options.debug&&e.debug(this.options.debug);var o=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new c.default,this.scroll=u.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new s.default(this.scroll),this.selection=new p.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(c.default.events.EDITOR_CHANGE,(function(e){e===c.default.events.TEXT_CHANGE&&n.root.classList.toggle("ql-blank",n.editor.isBlank())})),this.emitter.on(c.default.events.SCROLL_UPDATE,(function(e,t){var r=n.selection.lastRange,o=r&&0===r.length?r.index:void 0;b.call(n,(function(){return n.editor.update(null,t,o)}),e)}));var i=this.clipboard.convert("<div class='ql-editor' style=\"white-space: normal;\">"+o+"<p><br></p></div>");this.setContents(i),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return i(e,null,[{key:"debug",value:function(e){!0===e&&(e="log"),f.default.level(e)}},{key:"find",value:function(e){return e.__quill||u.default.find(e)}},{key:"import",value:function(e){return null==this.imports[e]&&E.error("Cannot import "+e+". Are you sure it was registered?"),this.imports[e]}},{key:"register",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"!==typeof e){var o=e.attrName||e.blotName;"string"===typeof o?this.register("formats/"+o,e,t):Object.keys(e).forEach((function(r){n.register(r,e[r],t)}))}else null==this.imports[e]||r||E.warn("Overwriting "+e+" with",t),this.imports[e]=t,(e.startsWith("blots/")||e.startsWith("formats/"))&&"abstract"!==t.blotName?u.default.register(t):e.startsWith("modules")&&"function"===typeof t.register&&t.register()}}]),i(e,[{key:"addContainer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"===typeof e){var n=e;(e=document.createElement("div")).classList.add(n)}return this.container.insertBefore(e,t),e}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(e,t,n){var r=this,i=T(e,t,n),a=o(i,4);return e=a[0],t=a[1],n=a[3],b.call(this,(function(){return r.editor.deleteText(e,t)}),n,e,-1*t)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.scroll.enable(e),this.container.classList.toggle("ql-disabled",!e)}},{key:"focus",value:function(){var e=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=e,this.scrollIntoView()}},{key:"format",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.default.sources.API;return b.call(this,(function(){var r=n.getSelection(!0),o=new a.default;if(null==r)return o;if(u.default.query(e,u.default.Scope.BLOCK))o=n.editor.formatLine(r.index,r.length,g({},e,t));else{if(0===r.length)return n.selection.format(e,t),o;o=n.editor.formatText(r.index,r.length,g({},e,t))}return n.setSelection(r,c.default.sources.SILENT),o}),r)}},{key:"formatLine",value:function(e,t,n,r,i){var a,s=this,c=T(e,t,n,r,i),l=o(c,4);return e=l[0],t=l[1],a=l[2],i=l[3],b.call(this,(function(){return s.editor.formatLine(e,t,a)}),i,e,0)}},{key:"formatText",value:function(e,t,n,r,i){var a,s=this,c=T(e,t,n,r,i),l=o(c,4);return e=l[0],t=l[1],a=l[2],i=l[3],b.call(this,(function(){return s.editor.formatText(e,t,a)}),i,e,0)}},{key:"getBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=void 0;n="number"===typeof e?this.selection.getBounds(e,t):this.selection.getBounds(e.index,e.length);var r=this.container.getBoundingClientRect();return{bottom:n.bottom-r.top,height:n.height,left:n.left-r.left,right:n.right-r.left,top:n.top-r.top,width:n.width}}},{key:"getContents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLength()-e,n=T(e,t),r=o(n,2);return e=r[0],t=r[1],this.editor.getContents(e,t)}},{key:"getFormat",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection(!0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"number"===typeof e?this.editor.getFormat(e,t):this.editor.getFormat(e.index,e.length)}},{key:"getIndex",value:function(e){return e.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(e){return this.scroll.leaf(e)}},{key:"getLine",value:function(e){return this.scroll.line(e)}},{key:"getLines",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;return"number"!==typeof e?this.scroll.lines(e.index,e.length):this.scroll.lines(e,t)}},{key:"getModule",value:function(e){return this.theme.modules[e]}},{key:"getSelection",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLength()-e,n=T(e,t),r=o(n,2);return e=r[0],t=r[1],this.editor.getText(e,t)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(t,n,r){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.sources.API;return b.call(this,(function(){return o.editor.insertEmbed(t,n,r)}),i,t)}},{key:"insertText",value:function(e,t,n,r,i){var a,s=this,c=T(e,0,n,r,i),l=o(c,4);return e=l[0],a=l[2],i=l[3],b.call(this,(function(){return s.editor.insertText(e,t,a)}),i,e,t.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(e,t,n){this.clipboard.dangerouslyPasteHTML(e,t,n)}},{key:"removeFormat",value:function(e,t,n){var r=this,i=T(e,t,n),a=o(i,4);return e=a[0],t=a[1],n=a[3],b.call(this,(function(){return r.editor.removeFormat(e,t)}),n,e)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.default.sources.API;return b.call(this,(function(){e=new a.default(e);var n=t.getLength(),r=t.editor.deleteText(0,n),o=t.editor.applyDelta(e),i=o.ops[o.ops.length-1];return null!=i&&"string"===typeof i.insert&&"\n"===i.insert[i.insert.length-1]&&(t.editor.deleteText(t.getLength()-1,1),o.delete(1)),r.compose(o)}),n)}},{key:"setSelection",value:function(t,n,r){if(null==t)this.selection.setRange(null,n||e.sources.API);else{var i=T(t,n,r),a=o(i,4);t=a[0],n=a[1],r=a[3],this.selection.setRange(new d.Range(t,n),r),r!==c.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.default.sources.API,n=(new a.default).insert(e);return this.setContents(n,t)}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.default.sources.USER,t=this.scroll.update(e);return this.selection.update(e),t}},{key:"updateContents",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.default.sources.API;return b.call(this,(function(){return e=new a.default(e),t.editor.applyDelta(e,n)}),n,!0)}}]),e}();function _(e,t){if((t=(0,h.default)(!0,{container:e,modules:{clipboard:!0,keyboard:!0,history:!0}},t)).theme&&t.theme!==y.DEFAULTS.theme){if(t.theme=y.import("themes/"+t.theme),null==t.theme)throw new Error("Invalid theme "+t.theme+". Did you register it?")}else t.theme=m.default;var n=(0,h.default)(!0,{},t.theme.DEFAULTS);[n,t].forEach((function(e){e.modules=e.modules||{},Object.keys(e.modules).forEach((function(t){!0===e.modules[t]&&(e.modules[t]={})}))}));var r=Object.keys(n.modules).concat(Object.keys(t.modules)).reduce((function(e,t){var n=y.import("modules/"+t);return null==n?E.error("Cannot load "+t+" module. Are you sure you registered it?"):e[t]=n.DEFAULTS||{},e}),{});return null!=t.modules&&t.modules.toolbar&&t.modules.toolbar.constructor!==Object&&(t.modules.toolbar={container:t.modules.toolbar}),t=(0,h.default)(!0,{},y.DEFAULTS,{modules:r},n,t),["bounds","container","scrollingContainer"].forEach((function(e){"string"===typeof t[e]&&(t[e]=document.querySelector(t[e]))})),t.modules=Object.keys(t.modules).reduce((function(e,n){return t.modules[n]&&(e[n]=t.modules[n]),e}),{}),t}function b(e,t,n,r){if(this.options.strict&&!this.isEnabled()&&t===c.default.sources.USER)return new a.default;var o=null==n?null:this.getSelection(),i=this.editor.delta,s=e();if(null!=o&&(!0===n&&(n=o.index),null==r?o=S(o,s,t):0!==r&&(o=S(o,n,r,t)),this.setSelection(o,c.default.sources.SILENT)),s.length()>0){var l,u,d=[c.default.events.TEXT_CHANGE,s,i,t];(l=this.emitter).emit.apply(l,[c.default.events.EDITOR_CHANGE].concat(d)),t!==c.default.sources.SILENT&&(u=this.emitter).emit.apply(u,d)}return s}function T(e,t,n,o,i){var a={};return"number"===typeof e.index&&"number"===typeof e.length?"number"!==typeof t?(i=o,o=n,n=t,t=e.length,e=e.index):(t=e.length,e=e.index):"number"!==typeof t&&(i=o,o=n,n=t,t=0),"object"===("undefined"===typeof n?"undefined":r(n))?(a=n,i=o):"string"===typeof n&&(null!=o?a[n]=o:i=n),[e,t,a,i=i||c.default.sources.API]}function S(e,t,n,r){if(null==e)return null;var i=void 0,s=void 0;if(t instanceof a.default){var l=[e.index,e.index+e.length].map((function(e){return t.transformPosition(e,r!==c.default.sources.USER)})),u=o(l,2);i=u[0],s=u[1]}else{var p=[e.index,e.index+e.length].map((function(e){return e<t||e===t&&r===c.default.sources.USER?e:n>=0?e+n:Math.max(t,e+n)})),h=o(p,2);i=h[0],s=h[1]}return new d.Range(i,s-i)}y.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},y.events=c.default.events,y.sources=c.default.sources,y.version="1.3.7",y.imports={delta:a.default,parchment:u.default,"core/module":l.default,"core/theme":m.default},t.expandConfig=_,t.overload=T,t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=s(n(7)),a=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"formatAt",value:function(e,n,r,i){if(t.compare(this.statics.blotName,r)<0&&a.default.query(r,a.default.Scope.BLOT)){var s=this.isolate(e,n);i&&s.wrap(r,i)}else o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"formatAt",this).call(this,e,n,r,i)}},{key:"optimize",value:function(e){if(o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"optimize",this).call(this,e),this.parent instanceof t&&t.compare(this.statics.blotName,this.parent.statics.blotName)>0){var n=this.parent.isolate(this.offset(),this.length());this.moveChildren(n),n.wrap(this)}}}],[{key:"compare",value:function(e,n){var r=t.order.indexOf(e),o=t.order.indexOf(n);return r>=0||o>=0?r-o:e===n?0:e<n?-1:1}}]),t}(a.default.Inline);c.allowedChildren=[c,a.default.Embed,i.default],c.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=o)&&r.__esModule?r:{default:r}).default.Text);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=a(n(54));function a(e){return e&&e.__esModule?e:{default:e}}var s=(0,a(n(10)).default)("quill:events");["selectionchange","mousedown","mouseup","click"].forEach((function(e){document.addEventListener(e,(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];[].slice.call(document.querySelectorAll(".ql-container")).forEach((function(e){var n;e.__quill&&e.__quill.emitter&&(n=e.__quill.emitter).handleDOM.apply(n,t)}))}))}));var c=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.listeners={},e.on("error",s.error),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"emit",value:function(){s.log.apply(s,arguments),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];(this.listeners[e.type]||[]).forEach((function(t){var r=t.node,o=t.handler;(e.target===r||r.contains(e.target))&&o.apply(void 0,[e].concat(n))}))}},{key:"listenDOM",value:function(e,t,n){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push({node:t,handler:n})}}]),t}(i.default);c.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},c.sources={API:"api",SILENT:"silent",USER:"user"},t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.quill=t,this.options=n};r.DEFAULTS={},t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["error","warn","log","info"],o="warn";function i(e){if(r.indexOf(e)<=r.indexOf(o)){for(var t,n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];(t=console)[e].apply(t,i)}}function a(e){return r.reduce((function(t,n){return t[n]=i.bind(console,n,e),t}),{})}i.level=a.level=function(e){o=e},t.default=a},function(e,t,n){var r=Array.prototype.slice,o=n(52),i=n(53),a=e.exports=function(e,t,n){return n||(n={}),e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||"object"!=typeof e&&"object"!=typeof t?n.strict?e===t:e==t:function(e,t,n){var l,u;if(s(e)||s(t))return!1;if(e.prototype!==t.prototype)return!1;if(i(e))return!!i(t)&&(e=r.call(e),t=r.call(t),a(e,t,n));if(c(e)){if(!c(t))return!1;if(e.length!==t.length)return!1;for(l=0;l<e.length;l++)if(e[l]!==t[l])return!1;return!0}try{var d=o(e),p=o(t)}catch(h){return!1}if(d.length!=p.length)return!1;for(d.sort(),p.sort(),l=d.length-1;l>=0;l--)if(d[l]!=p[l])return!1;for(l=d.length-1;l>=0;l--)if(u=d[l],!a(e[u],t[u],n))return!1;return typeof e===typeof t}(e,t,n))};function s(e){return null===e||void 0===e}function c(e){return!(!e||"object"!==typeof e||"number"!==typeof e.length)&&"function"===typeof e.copy&&"function"===typeof e.slice&&!(e.length>0&&"number"!==typeof e[0])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(){function e(e,t,n){void 0===n&&(n={}),this.attrName=e,this.keyName=t;var o=r.Scope.TYPE&r.Scope.ATTRIBUTE;null!=n.scope?this.scope=n.scope&r.Scope.LEVEL|o:this.scope=r.Scope.ATTRIBUTE,null!=n.whitelist&&(this.whitelist=n.whitelist)}return e.keys=function(e){return[].map.call(e.attributes,(function(e){return e.name}))},e.prototype.add=function(e,t){return!!this.canAdd(e,t)&&(e.setAttribute(this.keyName,t),!0)},e.prototype.canAdd=function(e,t){return null!=r.query(e,r.Scope.BLOT&(this.scope|r.Scope.TYPE))&&(null==this.whitelist||("string"===typeof t?this.whitelist.indexOf(t.replace(/["']/g,""))>-1:this.whitelist.indexOf(t)>-1))},e.prototype.remove=function(e){e.removeAttribute(this.keyName)},e.prototype.value=function(e){var t=e.getAttribute(this.keyName);return this.canAdd(e,t)&&t?t:""},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Code=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=d(n(2)),s=d(n(0)),c=d(n(4)),l=d(n(6)),u=d(n(7));function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function f(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var m=function(e){function t(){return p(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f(t,e),t}(l.default);m.blotName="code",m.tagName="CODE";var v=function(e){function t(){return p(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f(t,e),o(t,[{key:"delta",value:function(){var e=this,t=this.domNode.textContent;return t.endsWith("\n")&&(t=t.slice(0,-1)),t.split("\n").reduce((function(t,n){return t.insert(n).insert("\n",e.formats())}),new a.default)}},{key:"format",value:function(e,n){if(e!==this.statics.blotName||!n){var o=this.descendant(u.default,this.length()-1),a=r(o,1)[0];null!=a&&a.deleteAt(a.length()-1,1),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"format",this).call(this,e,n)}}},{key:"formatAt",value:function(e,n,r,o){if(0!==n&&null!=s.default.query(r,s.default.Scope.BLOCK)&&(r!==this.statics.blotName||o!==this.statics.formats(this.domNode))){var i=this.newlineIndex(e);if(!(i<0||i>=e+n)){var a=this.newlineIndex(e,!0)+1,c=i-a+1,l=this.isolate(a,c),u=l.next;l.format(r,o),u instanceof t&&u.formatAt(0,e-a+n-c,r,o)}}}},{key:"insertAt",value:function(e,t,n){if(null==n){var o=this.descendant(u.default,e),i=r(o,2),a=i[0],s=i[1];a.insertAt(s,t)}}},{key:"length",value:function(){var e=this.domNode.textContent.length;return this.domNode.textContent.endsWith("\n")?e:e+1}},{key:"newlineIndex",value:function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return this.domNode.textContent.slice(0,e).lastIndexOf("\n");var t=this.domNode.textContent.slice(e).indexOf("\n");return t>-1?e+t:-1}},{key:"optimize",value:function(e){this.domNode.textContent.endsWith("\n")||this.appendChild(s.default.create("text","\n")),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"optimize",this).call(this,e);var n=this.next;null!=n&&n.prev===this&&n.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===n.statics.formats(n.domNode)&&(n.optimize(e),n.moveChildren(this),n.remove())}},{key:"replace",value:function(e){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"replace",this).call(this,e),[].slice.call(this.domNode.querySelectorAll("*")).forEach((function(e){var t=s.default.find(e);null==t?e.parentNode.removeChild(e):t instanceof s.default.Embed?t.remove():t.unwrap()}))}}],[{key:"create",value:function(e){var n=i(t.__proto__||Object.getPrototypeOf(t),"create",this).call(this,e);return n.setAttribute("spellcheck",!1),n}},{key:"formats",value:function(){return!0}}]),t}(c.default);v.blotName="code-block",v.tagName="PRE",v.TAB="  ",t.Code=m,t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=g(n(2)),s=g(n(20)),c=g(n(0)),l=g(n(13)),u=g(n(24)),d=n(4),p=g(d),h=g(n(16)),f=g(n(21)),m=g(n(11)),v=g(n(3));function g(e){return e&&e.__esModule?e:{default:e}}var E=/^[ -~]*$/,y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scroll=t,this.delta=this.getDelta()}return i(e,[{key:"applyDelta",value:function(e){var t=this,n=!1;this.scroll.update();var i=this.scroll.length();return this.scroll.batchStart(),(e=function(e){return e.reduce((function(e,t){if(1===t.insert){var n=(0,f.default)(t.attributes);return delete n.image,e.insert({image:t.attributes.image},n)}if(null==t.attributes||!0!==t.attributes.list&&!0!==t.attributes.bullet||((t=(0,f.default)(t)).attributes.list?t.attributes.list="ordered":(t.attributes.list="bullet",delete t.attributes.bullet)),"string"===typeof t.insert){var r=t.insert.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return e.insert(r,t.attributes)}return e.push(t)}),new a.default)}(e)).reduce((function(e,a){var l=a.retain||a.delete||a.insert.length||1,u=a.attributes||{};if(null!=a.insert){if("string"===typeof a.insert){var h=a.insert;h.endsWith("\n")&&n&&(n=!1,h=h.slice(0,-1)),e>=i&&!h.endsWith("\n")&&(n=!0),t.scroll.insertAt(e,h);var f=t.scroll.line(e),m=o(f,2),g=m[0],E=m[1],y=(0,v.default)({},(0,d.bubbleFormats)(g));if(g instanceof p.default){var _=g.descendant(c.default.Leaf,E),b=o(_,1)[0];y=(0,v.default)(y,(0,d.bubbleFormats)(b))}u=s.default.attributes.diff(y,u)||{}}else if("object"===r(a.insert)){var T=Object.keys(a.insert)[0];if(null==T)return e;t.scroll.insertAt(e,T,a.insert[T])}i+=l}return Object.keys(u).forEach((function(n){t.scroll.formatAt(e,l,n,u[n])})),e+l}),0),e.reduce((function(e,n){return"number"===typeof n.delete?(t.scroll.deleteAt(e,n.delete),e):e+(n.retain||n.insert.length||1)}),0),this.scroll.batchEnd(),this.update(e)}},{key:"deleteText",value:function(e,t){return this.scroll.deleteAt(e,t),this.update((new a.default).retain(e).delete(t))}},{key:"formatLine",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.scroll.update(),Object.keys(r).forEach((function(o){if(null==n.scroll.whitelist||n.scroll.whitelist[o]){var i=n.scroll.lines(e,Math.max(t,1)),a=t;i.forEach((function(t){var i=t.length();if(t instanceof l.default){var s=e-t.offset(n.scroll),c=t.newlineIndex(s+a)-s+1;t.formatAt(s,c,o,r[o])}else t.format(o,r[o]);a-=i}))}})),this.scroll.optimize(),this.update((new a.default).retain(e).retain(t,(0,f.default)(r)))}},{key:"formatText",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object.keys(r).forEach((function(o){n.scroll.formatAt(e,t,o,r[o])})),this.update((new a.default).retain(e).retain(t,(0,f.default)(r)))}},{key:"getContents",value:function(e,t){return this.delta.slice(e,e+t)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce((function(e,t){return e.concat(t.delta())}),new a.default)}},{key:"getFormat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],r=[];0===t?this.scroll.path(e).forEach((function(e){var t=o(e,1)[0];t instanceof p.default?n.push(t):t instanceof c.default.Leaf&&r.push(t)})):(n=this.scroll.lines(e,t),r=this.scroll.descendants(c.default.Leaf,e,t));var i=[n,r].map((function(e){if(0===e.length)return{};for(var t=(0,d.bubbleFormats)(e.shift());Object.keys(t).length>0;){var n=e.shift();if(null==n)return t;t=_((0,d.bubbleFormats)(n),t)}return t}));return v.default.apply(v.default,i)}},{key:"getText",value:function(e,t){return this.getContents(e,t).filter((function(e){return"string"===typeof e.insert})).map((function(e){return e.insert})).join("")}},{key:"insertEmbed",value:function(e,t,n){return this.scroll.insertAt(e,t,n),this.update((new a.default).retain(e).insert(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,n)))}},{key:"insertText",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),this.scroll.insertAt(e,t),Object.keys(r).forEach((function(o){n.scroll.formatAt(e,t.length,o,r[o])})),this.update((new a.default).retain(e).insert(t,(0,f.default)(r)))}},{key:"isBlank",value:function(){if(0==this.scroll.children.length)return!0;if(this.scroll.children.length>1)return!1;var e=this.scroll.children.head;return e.statics.blotName===p.default.blotName&&!(e.children.length>1)&&e.children.head instanceof h.default}},{key:"removeFormat",value:function(e,t){var n=this.getText(e,t),r=this.scroll.line(e+t),i=o(r,2),s=i[0],c=i[1],u=0,d=new a.default;null!=s&&(u=s instanceof l.default?s.newlineIndex(c)-c+1:s.length()-c,d=s.delta().slice(c,c+u-1).insert("\n"));var p=this.getContents(e,t+u).diff((new a.default).insert(n).concat(d)),h=(new a.default).retain(e).concat(p);return this.applyDelta(h)}},{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=this.delta;if(1===t.length&&"characterData"===t[0].type&&t[0].target.data.match(E)&&c.default.find(t[0].target)){var o=c.default.find(t[0].target),i=(0,d.bubbleFormats)(o),s=o.offset(this.scroll),l=t[0].oldValue.replace(u.default.CONTENTS,""),p=(new a.default).insert(l),h=(new a.default).insert(o.value());e=(new a.default).retain(s).concat(p.diff(h,n)).reduce((function(e,t){return t.insert?e.insert(t.insert,i):e.push(t)}),new a.default),this.delta=r.compose(e)}else this.delta=this.getDelta(),e&&(0,m.default)(r.compose(e),this.delta)||(e=r.diff(this.delta,n));return e}}]),e}();function _(e,t){return Object.keys(t).reduce((function(n,r){return null==e[r]||(t[r]===e[r]?n[r]=t[r]:Array.isArray(t[r])?t[r].indexOf(e[r])<0&&(n[r]=t[r].concat([e[r]])):n[r]=[t[r],e[r]]),n}),{})}t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Range=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(0)),a=l(n(21)),s=l(n(11)),c=l(n(8));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var p=(0,l(n(10)).default)("quill:selection"),h=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;d(this,e),this.index=t,this.length=n},f=function(){function e(t,n){var r=this;d(this,e),this.emitter=n,this.scroll=t,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=i.default.create("cursor",this),this.lastRange=this.savedRange=new h(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,(function(){r.mouseDown||setTimeout(r.update.bind(r,c.default.sources.USER),1)})),this.emitter.on(c.default.events.EDITOR_CHANGE,(function(e,t){e===c.default.events.TEXT_CHANGE&&t.length()>0&&r.update(c.default.sources.SILENT)})),this.emitter.on(c.default.events.SCROLL_BEFORE_UPDATE,(function(){if(r.hasFocus()){var e=r.getNativeRange();null!=e&&e.start.node!==r.cursor.textNode&&r.emitter.once(c.default.events.SCROLL_UPDATE,(function(){try{r.setNativeRange(e.start.node,e.start.offset,e.end.node,e.end.offset)}catch(t){}}))}})),this.emitter.on(c.default.events.SCROLL_OPTIMIZE,(function(e,t){if(t.range){var n=t.range,o=n.startNode,i=n.startOffset,a=n.endNode,s=n.endOffset;r.setNativeRange(o,i,a,s)}})),this.update(c.default.sources.SILENT)}return o(e,[{key:"handleComposition",value:function(){var e=this;this.root.addEventListener("compositionstart",(function(){e.composing=!0})),this.root.addEventListener("compositionend",(function(){if(e.composing=!1,e.cursor.parent){var t=e.cursor.restore();if(!t)return;setTimeout((function(){e.setNativeRange(t.startNode,t.startOffset,t.endNode,t.endOffset)}),1)}}))}},{key:"handleDragging",value:function(){var e=this;this.emitter.listenDOM("mousedown",document.body,(function(){e.mouseDown=!0})),this.emitter.listenDOM("mouseup",document.body,(function(){e.mouseDown=!1,e.update(c.default.sources.USER)}))}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(e,t){if(null==this.scroll.whitelist||this.scroll.whitelist[e]){this.scroll.update();var n=this.getNativeRange();if(null!=n&&n.native.collapsed&&!i.default.query(e,i.default.Scope.BLOCK)){if(n.start.node!==this.cursor.textNode){var r=i.default.find(n.start.node,!1);if(null==r)return;if(r instanceof i.default.Leaf){var o=r.split(n.start.offset);r.parent.insertBefore(this.cursor,o)}else r.insertBefore(this.cursor,n.start.node);this.cursor.attach()}this.cursor.format(e,t),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.scroll.length();e=Math.min(e,n-1),t=Math.min(e+t,n-1)-e;var o=void 0,i=this.scroll.leaf(e),a=r(i,2),s=a[0],c=a[1];if(null==s)return null;var l=s.position(c,!0),u=r(l,2);o=u[0],c=u[1];var d=document.createRange();if(t>0){d.setStart(o,c);var p=this.scroll.leaf(e+t),h=r(p,2);if(s=h[0],c=h[1],null==s)return null;var f=s.position(c,!0),m=r(f,2);return o=m[0],c=m[1],d.setEnd(o,c),d.getBoundingClientRect()}var v="left",g=void 0;return o instanceof Text?(c<o.data.length?(d.setStart(o,c),d.setEnd(o,c+1)):(d.setStart(o,c-1),d.setEnd(o,c),v="right"),g=d.getBoundingClientRect()):(g=s.domNode.getBoundingClientRect(),c>0&&(v="right")),{bottom:g.top+g.height,height:g.height,left:g[v],right:g[v],top:g.top,width:0}}},{key:"getNativeRange",value:function(){var e=document.getSelection();if(null==e||e.rangeCount<=0)return null;var t=e.getRangeAt(0);if(null==t)return null;var n=this.normalizeNative(t);return p.info("getNativeRange",n),n}},{key:"getRange",value:function(){var e=this.getNativeRange();return null==e?[null,null]:[this.normalizedToRange(e),e]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(e){var t=this,n=[[e.start.node,e.start.offset]];e.native.collapsed||n.push([e.end.node,e.end.offset]);var o=n.map((function(e){var n=r(e,2),o=n[0],a=n[1],s=i.default.find(o,!0),c=s.offset(t.scroll);return 0===a?c:s instanceof i.default.Container?c+s.length():c+s.index(o,a)})),a=Math.min(Math.max.apply(Math,u(o)),this.scroll.length()-1),s=Math.min.apply(Math,[a].concat(u(o)));return new h(s,a-s)}},{key:"normalizeNative",value:function(e){if(!m(this.root,e.startContainer)||!e.collapsed&&!m(this.root,e.endContainer))return null;var t={start:{node:e.startContainer,offset:e.startOffset},end:{node:e.endContainer,offset:e.endOffset},native:e};return[t.start,t.end].forEach((function(e){for(var t=e.node,n=e.offset;!(t instanceof Text)&&t.childNodes.length>0;)if(t.childNodes.length>n)t=t.childNodes[n],n=0;else{if(t.childNodes.length!==n)break;n=(t=t.lastChild)instanceof Text?t.data.length:t.childNodes.length+1}e.node=t,e.offset=n})),t}},{key:"rangeToNative",value:function(e){var t=this,n=e.collapsed?[e.index]:[e.index,e.index+e.length],o=[],i=this.scroll.length();return n.forEach((function(e,n){e=Math.min(i-1,e);var a,s=t.scroll.leaf(e),c=r(s,2),l=c[0],u=c[1],d=l.position(u,0!==n),p=r(d,2);a=p[0],u=p[1],o.push(a,u)})),o.length<2&&(o=o.concat(o)),o}},{key:"scrollIntoView",value:function(e){var t=this.lastRange;if(null!=t){var n=this.getBounds(t.index,t.length);if(null!=n){var o=this.scroll.length()-1,i=this.scroll.line(Math.min(t.index,o)),a=r(i,1)[0],s=a;if(t.length>0){var c=this.scroll.line(Math.min(t.index+t.length,o));s=r(c,1)[0]}if(null!=a&&null!=s){var l=e.getBoundingClientRect();n.top<l.top?e.scrollTop-=l.top-n.top:n.bottom>l.bottom&&(e.scrollTop+=n.bottom-l.bottom)}}}}},{key:"setNativeRange",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(p.info("setNativeRange",e,t,n,r),null==e||null!=this.root.parentNode&&null!=e.parentNode&&null!=n.parentNode){var i=document.getSelection();if(null!=i)if(null!=e){this.hasFocus()||this.root.focus();var a=(this.getNativeRange()||{}).native;if(null==a||o||e!==a.startContainer||t!==a.startOffset||n!==a.endContainer||r!==a.endOffset){"BR"==e.tagName&&(t=[].indexOf.call(e.parentNode.childNodes,e),e=e.parentNode),"BR"==n.tagName&&(r=[].indexOf.call(n.parentNode.childNodes,n),n=n.parentNode);var s=document.createRange();s.setStart(e,t),s.setEnd(n,r),i.removeAllRanges(),i.addRange(s)}}else i.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.default.sources.API;if("string"===typeof t&&(n=t,t=!1),p.info("setRange",e),null!=e){var r=this.rangeToNative(e);this.setNativeRange.apply(this,u(r).concat([t]))}else this.setNativeRange(null);this.update(n)}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.default.sources.USER,t=this.lastRange,n=this.getRange(),o=r(n,2),i=o[0],l=o[1];if(this.lastRange=i,null!=this.lastRange&&(this.savedRange=this.lastRange),!(0,s.default)(t,this.lastRange)){var u;!this.composing&&null!=l&&l.native.collapsed&&l.start.node!==this.cursor.textNode&&this.cursor.restore();var d,p=[c.default.events.SELECTION_CHANGE,(0,a.default)(this.lastRange),(0,a.default)(t),e];(u=this.emitter).emit.apply(u,[c.default.events.EDITOR_CHANGE].concat(p)),e!==c.default.sources.SILENT&&(d=this.emitter).emit.apply(d,p)}}}]),e}();function m(e,t){try{t.parentNode}catch(n){return!1}return t instanceof Text&&(t=t.parentNode),e.contains(t)}t.Range=h,t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(0),s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"insertInto",value:function(e,n){0===e.children.length?i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"insertInto",this).call(this,e,n):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),t}(((r=a)&&r.__esModule?r:{default:r}).default.Embed);s.blotName="break",s.tagName="BR",t.default=s},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(44),i=n(30),a=n(1),s=function(e){function t(t){var n=e.call(this,t)||this;return n.build(),n}return r(t,e),t.prototype.appendChild=function(e){this.insertBefore(e)},t.prototype.attach=function(){e.prototype.attach.call(this),this.children.forEach((function(e){e.attach()}))},t.prototype.build=function(){var e=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach((function(t){try{var n=c(t);e.insertBefore(n,e.children.head||void 0)}catch(r){if(r instanceof a.ParchmentError)return;throw r}}))},t.prototype.deleteAt=function(e,t){if(0===e&&t===this.length())return this.remove();this.children.forEachAt(e,t,(function(e,t,n){e.deleteAt(t,n)}))},t.prototype.descendant=function(e,n){var r=this.children.find(n),o=r[0],i=r[1];return null==e.blotName&&e(o)||null!=e.blotName&&o instanceof e?[o,i]:o instanceof t?o.descendant(e,i):[null,-1]},t.prototype.descendants=function(e,n,r){void 0===n&&(n=0),void 0===r&&(r=Number.MAX_VALUE);var o=[],i=r;return this.children.forEachAt(n,r,(function(n,r,a){(null==e.blotName&&e(n)||null!=e.blotName&&n instanceof e)&&o.push(n),n instanceof t&&(o=o.concat(n.descendants(e,r,i))),i-=a})),o},t.prototype.detach=function(){this.children.forEach((function(e){e.detach()})),e.prototype.detach.call(this)},t.prototype.formatAt=function(e,t,n,r){this.children.forEachAt(e,t,(function(e,t,o){e.formatAt(t,o,n,r)}))},t.prototype.insertAt=function(e,t,n){var r=this.children.find(e),o=r[0],i=r[1];if(o)o.insertAt(i,t,n);else{var s=null==n?a.create("text",t):a.create(t,n);this.appendChild(s)}},t.prototype.insertBefore=function(e,t){if(null!=this.statics.allowedChildren&&!this.statics.allowedChildren.some((function(t){return e instanceof t})))throw new a.ParchmentError("Cannot insert "+e.statics.blotName+" into "+this.statics.blotName);e.insertInto(this,t)},t.prototype.length=function(){return this.children.reduce((function(e,t){return e+t.length()}),0)},t.prototype.moveChildren=function(e,t){this.children.forEach((function(n){e.insertBefore(n,t)}))},t.prototype.optimize=function(t){if(e.prototype.optimize.call(this,t),0===this.children.length)if(null!=this.statics.defaultChild){var n=a.create(this.statics.defaultChild);this.appendChild(n),n.optimize(t)}else this.remove()},t.prototype.path=function(e,n){void 0===n&&(n=!1);var r=this.children.find(e,n),o=r[0],i=r[1],a=[[this,e]];return o instanceof t?a.concat(o.path(i,n)):(null!=o&&a.push([o,i]),a)},t.prototype.removeChild=function(e){this.children.remove(e)},t.prototype.replace=function(n){n instanceof t&&n.moveChildren(this),e.prototype.replace.call(this,n)},t.prototype.split=function(e,t){if(void 0===t&&(t=!1),!t){if(0===e)return this;if(e===this.length())return this.next}var n=this.clone();return this.parent.insertBefore(n,this.next),this.children.forEachAt(e,this.length(),(function(e,r,o){e=e.split(r,t),n.appendChild(e)})),n},t.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},t.prototype.update=function(e,t){var n=this,r=[],o=[];e.forEach((function(e){e.target===n.domNode&&"childList"===e.type&&(r.push.apply(r,e.addedNodes),o.push.apply(o,e.removedNodes))})),o.forEach((function(e){if(!(null!=e.parentNode&&"IFRAME"!==e.tagName&&document.body.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var t=a.find(e);null!=t&&(null!=t.domNode.parentNode&&t.domNode.parentNode!==n.domNode||t.detach())}})),r.filter((function(e){return e.parentNode==n.domNode})).sort((function(e,t){return e===t?0:e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1})).forEach((function(e){var t=null;null!=e.nextSibling&&(t=a.find(e.nextSibling));var r=c(e);r.next==t&&null!=r.next||(null!=r.parent&&r.parent.removeChild(n),n.insertBefore(r,t||void 0))}))},t}(i.default);function c(e){var t=a.find(e);if(null==t)try{t=a.create(e)}catch(n){t=a.create(a.Scope.INLINE),[].slice.call(e.childNodes).forEach((function(e){t.domNode.appendChild(e)})),e.parentNode&&e.parentNode.replaceChild(t.domNode,e),t.attach()}return t}t.default=s},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),i=n(31),a=n(17),s=n(1),c=function(e){function t(t){var n=e.call(this,t)||this;return n.attributes=new i.default(n.domNode),n}return r(t,e),t.formats=function(e){return"string"===typeof this.tagName||(Array.isArray(this.tagName)?e.tagName.toLowerCase():void 0)},t.prototype.format=function(e,t){var n=s.query(e);n instanceof o.default?this.attributes.attribute(n,t):t&&(null==n||e===this.statics.blotName&&this.formats()[e]===t||this.replaceWith(e,t))},t.prototype.formats=function(){var e=this.attributes.values(),t=this.statics.formats(this.domNode);return null!=t&&(e[this.statics.blotName]=t),e},t.prototype.replaceWith=function(t,n){var r=e.prototype.replaceWith.call(this,t,n);return this.attributes.copy(r),r},t.prototype.update=function(t,n){var r=this;e.prototype.update.call(this,t,n),t.some((function(e){return e.target===r.domNode&&"attributes"===e.type}))&&this.attributes.build()},t.prototype.wrap=function(n,r){var o=e.prototype.wrap.call(this,n,r);return o instanceof t&&o.statics.scope===this.statics.scope&&this.attributes.move(o),o},t}(a.default);t.default=c},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(30),i=n(1),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.value=function(e){return!0},t.prototype.index=function(e,t){return this.domNode===e||this.domNode.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(t,1):-1},t.prototype.position=function(e,t){var n=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return e>0&&(n+=1),[this.parent.domNode,n]},t.prototype.value=function(){var e;return(e={})[this.statics.blotName]=this.statics.value(this.domNode)||!0,e},t.scope=i.Scope.INLINE_BLOT,t}(o.default);t.default=a},function(e,t,n){var r=n(11),o=n(3),i={attributes:{compose:function(e,t,n){"object"!==typeof e&&(e={}),"object"!==typeof t&&(t={});var r=o(!0,{},t);for(var i in n||(r=Object.keys(r).reduce((function(e,t){return null!=r[t]&&(e[t]=r[t]),e}),{})),e)void 0!==e[i]&&void 0===t[i]&&(r[i]=e[i]);return Object.keys(r).length>0?r:void 0},diff:function(e,t){"object"!==typeof e&&(e={}),"object"!==typeof t&&(t={});var n=Object.keys(e).concat(Object.keys(t)).reduce((function(n,o){return r(e[o],t[o])||(n[o]=void 0===t[o]?null:t[o]),n}),{});return Object.keys(n).length>0?n:void 0},transform:function(e,t,n){if("object"!==typeof e)return t;if("object"===typeof t){if(!n)return t;var r=Object.keys(t).reduce((function(n,r){return void 0===e[r]&&(n[r]=t[r]),n}),{});return Object.keys(r).length>0?r:void 0}}},iterator:function(e){return new a(e)},length:function(e){return"number"===typeof e.delete?e.delete:"number"===typeof e.retain?e.retain:"string"===typeof e.insert?e.insert.length:1}};function a(e){this.ops=e,this.index=0,this.offset=0}a.prototype.hasNext=function(){return this.peekLength()<1/0},a.prototype.next=function(e){e||(e=1/0);var t=this.ops[this.index];if(t){var n=this.offset,r=i.length(t);if(e>=r-n?(e=r-n,this.index+=1,this.offset=0):this.offset+=e,"number"===typeof t.delete)return{delete:e};var o={};return t.attributes&&(o.attributes=t.attributes),"number"===typeof t.retain?o.retain=e:"string"===typeof t.insert?o.insert=t.insert.substr(n,e):o.insert=t.insert,o}return{retain:1/0}},a.prototype.peek=function(){return this.ops[this.index]},a.prototype.peekLength=function(){return this.ops[this.index]?i.length(this.ops[this.index])-this.offset:1/0},a.prototype.peekType=function(){return this.ops[this.index]?"number"===typeof this.ops[this.index].delete?"delete":"number"===typeof this.ops[this.index].retain?"retain":"insert":"retain"},a.prototype.rest=function(){if(this.hasNext()){if(0===this.offset)return this.ops.slice(this.index);var e=this.offset,t=this.index,n=this.next(),r=this.ops.slice(this.index);return this.offset=e,this.index=t,[n].concat(r)}return[]},e.exports=i},function(e,n){var r=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var n,r,o;try{n=Map}catch(c){n=function(){}}try{r=Set}catch(c){r=function(){}}try{o=Promise}catch(c){o=function(){}}function i(a,c,l,u,d){"object"===typeof c&&(l=c.depth,u=c.prototype,d=c.includeNonEnumerable,c=c.circular);var p=[],h=[],f="undefined"!=typeof t;return"undefined"==typeof c&&(c=!0),"undefined"==typeof l&&(l=1/0),function a(l,m){if(null===l)return null;if(0===m)return l;var v,g;if("object"!=typeof l)return l;if(e(l,n))v=new n;else if(e(l,r))v=new r;else if(e(l,o))v=new o((function(e,t){l.then((function(t){e(a(t,m-1))}),(function(e){t(a(e,m-1))}))}));else if(i.__isArray(l))v=[];else if(i.__isRegExp(l))v=new RegExp(l.source,s(l)),l.lastIndex&&(v.lastIndex=l.lastIndex);else if(i.__isDate(l))v=new Date(l.getTime());else{if(f&&t.isBuffer(l))return v=t.allocUnsafe?t.allocUnsafe(l.length):new t(l.length),l.copy(v),v;e(l,Error)?v=Object.create(l):"undefined"==typeof u?(g=Object.getPrototypeOf(l),v=Object.create(g)):(v=Object.create(u),g=u)}if(c){var E=p.indexOf(l);if(-1!=E)return h[E];p.push(l),h.push(v)}for(var y in e(l,n)&&l.forEach((function(e,t){var n=a(t,m-1),r=a(e,m-1);v.set(n,r)})),e(l,r)&&l.forEach((function(e){var t=a(e,m-1);v.add(t)})),l){var _;g&&(_=Object.getOwnPropertyDescriptor(g,y)),_&&null==_.set||(v[y]=a(l[y],m-1))}if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(l);for(y=0;y<b.length;y++){var T=b[y];(!(O=Object.getOwnPropertyDescriptor(l,T))||O.enumerable||d)&&(v[T]=a(l[T],m-1),O.enumerable||Object.defineProperty(v,T,{enumerable:!1}))}}if(d){var S=Object.getOwnPropertyNames(l);for(y=0;y<S.length;y++){var O,R=S[y];(O=Object.getOwnPropertyDescriptor(l,R))&&O.enumerable||(v[R]=a(l[R],m-1),Object.defineProperty(v,R,{enumerable:!1}))}}return v}(a,l)}function a(e){return Object.prototype.toString.call(e)}function s(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return i.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},i.__objToStr=a,i.__isDate=function(e){return"object"===typeof e&&"[object Date]"===a(e)},i.__isArray=function(e){return"object"===typeof e&&"[object Array]"===a(e)},i.__isRegExp=function(e){return"object"===typeof e&&"[object RegExp]"===a(e)},i.__getRegExpFlags=s,i}();"object"===typeof e&&e.exports&&(e.exports=r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=h(n(0)),s=h(n(8)),c=n(4),l=h(c),u=h(n(16)),d=h(n(13)),p=h(n(25));function h(e){return e&&e.__esModule?e:{default:e}}function f(e){return e instanceof l.default||e instanceof c.BlockEmbed}var m=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.emitter=n.emitter,Array.isArray(n.whitelist)&&(r.whitelist=n.whitelist.reduce((function(e,t){return e[t]=!0,e}),{})),r.domNode.addEventListener("DOMNodeInserted",(function(){})),r.optimize(),r.enable(),r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(e,n){var o=this.line(e),a=r(o,2),s=a[0],l=a[1],p=this.line(e+n),h=r(p,1)[0];if(i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deleteAt",this).call(this,e,n),null!=h&&s!==h&&l>0){if(s instanceof c.BlockEmbed||h instanceof c.BlockEmbed)return void this.optimize();if(s instanceof d.default){var f=s.newlineIndex(s.length(),!0);if(f>-1&&(s=s.split(f+1))===h)return void this.optimize()}else if(h instanceof d.default){var m=h.newlineIndex(0);m>-1&&h.split(m+1)}var v=h.children.head instanceof u.default?null:h.children.head;s.moveChildren(h,v),s.remove()}this.optimize()}},{key:"enable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.domNode.setAttribute("contenteditable",e)}},{key:"formatAt",value:function(e,n,r,o){(null==this.whitelist||this.whitelist[r])&&(i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"formatAt",this).call(this,e,n,r,o),this.optimize())}},{key:"insertAt",value:function(e,n,r){if(null==r||null==this.whitelist||this.whitelist[n]){if(e>=this.length())if(null==r||null==a.default.query(n,a.default.Scope.BLOCK)){var o=a.default.create(this.statics.defaultChild);this.appendChild(o),null==r&&n.endsWith("\n")&&(n=n.slice(0,-1)),o.insertAt(0,n,r)}else{var s=a.default.create(n,r);this.appendChild(s)}else i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"insertAt",this).call(this,e,n,r);this.optimize()}}},{key:"insertBefore",value:function(e,n){if(e.statics.scope===a.default.Scope.INLINE_BLOT){var r=a.default.create(this.statics.defaultChild);r.appendChild(e),e=r}i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"insertBefore",this).call(this,e,n)}},{key:"leaf",value:function(e){return this.path(e).pop()||[null,-1]}},{key:"line",value:function(e){return e===this.length()?this.line(e-1):this.descendant(f,e)}},{key:"lines",value:function(){return function e(t,n,r){var o=[],i=r;return t.children.forEachAt(n,r,(function(t,n,r){f(t)?o.push(t):t instanceof a.default.Container&&(o=o.concat(e(t,n,i))),i-=r})),o}(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE)}},{key:"optimize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!0!==this.batch&&(i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"optimize",this).call(this,e,n),e.length>0&&this.emitter.emit(s.default.events.SCROLL_OPTIMIZE,e,n))}},{key:"path",value:function(e){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"path",this).call(this,e).slice(1)}},{key:"update",value:function(e){if(!0!==this.batch){var n=s.default.sources.USER;"string"===typeof e&&(n=e),Array.isArray(e)||(e=this.observer.takeRecords()),e.length>0&&this.emitter.emit(s.default.events.SCROLL_BEFORE_UPDATE,n,e),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e.concat([])),e.length>0&&this.emitter.emit(s.default.events.SCROLL_UPDATE,n,e)}}}]),t}(a.default.Scroll);m.blotName="scroll",m.className="ql-editor",m.tagName="DIV",m.defaultChild="block",m.allowedChildren=[l.default,c.BlockEmbed,p.default],t.default=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SHORTKEY=t.default=void 0;var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=m(n(21)),s=m(n(11)),c=m(n(3)),l=m(n(2)),u=m(n(20)),d=m(n(0)),p=m(n(5)),h=m(n(10)),f=m(n(9));function m(e){return e&&e.__esModule?e:{default:e}}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=(0,h.default)("quill:keyboard"),E=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",y=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.bindings={},Object.keys(r.options.bindings).forEach((function(t){("list autofill"!==t||null==e.scroll.whitelist||e.scroll.whitelist.list)&&r.options.bindings[t]&&r.addBinding(r.options.bindings[t])})),r.addBinding({key:t.keys.ENTER,shiftKey:null},O),r.addBinding({key:t.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},(function(){})),/Firefox/i.test(navigator.userAgent)?(r.addBinding({key:t.keys.BACKSPACE},{collapsed:!0},b),r.addBinding({key:t.keys.DELETE},{collapsed:!0},T)):(r.addBinding({key:t.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},b),r.addBinding({key:t.keys.DELETE},{collapsed:!0,suffix:/^.?$/},T)),r.addBinding({key:t.keys.BACKSPACE},{collapsed:!1},S),r.addBinding({key:t.keys.DELETE},{collapsed:!1},S),r.addBinding({key:t.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},b),r.listen(),r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,null,[{key:"match",value:function(e,t){return t=w(t),!["altKey","ctrlKey","metaKey","shiftKey"].some((function(n){return!!t[n]!==e[n]&&null!==t[n]}))&&t.key===(e.which||e.keyCode)}}]),i(t,[{key:"addBinding",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=w(e);if(null==r||null==r.key)return g.warn("Attempted to add invalid keyboard binding",r);"function"===typeof t&&(t={handler:t}),"function"===typeof n&&(n={handler:n}),r=(0,c.default)(r,t,n),this.bindings[r.key]=this.bindings[r.key]||[],this.bindings[r.key].push(r)}},{key:"listen",value:function(){var e=this;this.quill.root.addEventListener("keydown",(function(n){if(!n.defaultPrevented){var i=n.which||n.keyCode,a=(e.bindings[i]||[]).filter((function(e){return t.match(n,e)}));if(0!==a.length){var c=e.quill.getSelection();if(null!=c&&e.quill.hasFocus()){var l=e.quill.getLine(c.index),u=o(l,2),p=u[0],h=u[1],f=e.quill.getLeaf(c.index),m=o(f,2),v=m[0],g=m[1],E=0===c.length?[v,g]:e.quill.getLeaf(c.index+c.length),y=o(E,2),_=y[0],b=y[1],T=v instanceof d.default.Text?v.value().slice(0,g):"",S=_ instanceof d.default.Text?_.value().slice(b):"",O={collapsed:0===c.length,empty:0===c.length&&p.length()<=1,format:e.quill.getFormat(c),offset:h,prefix:T,suffix:S};a.some((function(t){if(null!=t.collapsed&&t.collapsed!==O.collapsed)return!1;if(null!=t.empty&&t.empty!==O.empty)return!1;if(null!=t.offset&&t.offset!==O.offset)return!1;if(Array.isArray(t.format)){if(t.format.every((function(e){return null==O.format[e]})))return!1}else if("object"===r(t.format)&&!Object.keys(t.format).every((function(e){return!0===t.format[e]?null!=O.format[e]:!1===t.format[e]?null==O.format[e]:(0,s.default)(t.format[e],O.format[e])})))return!1;return!(null!=t.prefix&&!t.prefix.test(O.prefix))&&!(null!=t.suffix&&!t.suffix.test(O.suffix))&&!0!==t.handler.call(e,c,O)}))&&n.preventDefault()}}}}))}}]),t}(f.default);function _(e,t){var n,r=e===y.keys.LEFT?"prefix":"suffix";return v(n={key:e,shiftKey:t,altKey:null},r,/^$/),v(n,"handler",(function(n){var r=n.index;e===y.keys.RIGHT&&(r+=n.length+1);var i=this.quill.getLeaf(r);return!(o(i,1)[0]instanceof d.default.Embed)||(e===y.keys.LEFT?t?this.quill.setSelection(n.index-1,n.length+1,p.default.sources.USER):this.quill.setSelection(n.index-1,p.default.sources.USER):t?this.quill.setSelection(n.index,n.length+1,p.default.sources.USER):this.quill.setSelection(n.index+n.length+1,p.default.sources.USER),!1)})),n}function b(e,t){if(!(0===e.index||this.quill.getLength()<=1)){var n=this.quill.getLine(e.index),r=o(n,1)[0],i={};if(0===t.offset){var a=this.quill.getLine(e.index-1),s=o(a,1)[0];if(null!=s&&s.length()>1){var c=r.formats(),l=this.quill.getFormat(e.index-1,1);i=u.default.attributes.diff(c,l)||{}}}var d=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(t.prefix)?2:1;this.quill.deleteText(e.index-d,d,p.default.sources.USER),Object.keys(i).length>0&&this.quill.formatLine(e.index-d,d,i,p.default.sources.USER),this.quill.focus()}}function T(e,t){var n=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(t.suffix)?2:1;if(!(e.index>=this.quill.getLength()-n)){var r={},i=0,a=this.quill.getLine(e.index),s=o(a,1)[0];if(t.offset>=s.length()-1){var c=this.quill.getLine(e.index+1),l=o(c,1)[0];if(l){var d=s.formats(),h=this.quill.getFormat(e.index,1);r=u.default.attributes.diff(d,h)||{},i=l.length()}}this.quill.deleteText(e.index,n,p.default.sources.USER),Object.keys(r).length>0&&this.quill.formatLine(e.index+i-1,n,r,p.default.sources.USER)}}function S(e){var t=this.quill.getLines(e),n={};if(t.length>1){var r=t[0].formats(),o=t[t.length-1].formats();n=u.default.attributes.diff(o,r)||{}}this.quill.deleteText(e,p.default.sources.USER),Object.keys(n).length>0&&this.quill.formatLine(e.index,1,n,p.default.sources.USER),this.quill.setSelection(e.index,p.default.sources.SILENT),this.quill.focus()}function O(e,t){var n=this;e.length>0&&this.quill.scroll.deleteAt(e.index,e.length);var r=Object.keys(t.format).reduce((function(e,n){return d.default.query(n,d.default.Scope.BLOCK)&&!Array.isArray(t.format[n])&&(e[n]=t.format[n]),e}),{});this.quill.insertText(e.index,"\n",r,p.default.sources.USER),this.quill.setSelection(e.index+1,p.default.sources.SILENT),this.quill.focus(),Object.keys(t.format).forEach((function(e){null==r[e]&&(Array.isArray(t.format[e])||"link"!==e&&n.quill.format(e,t.format[e],p.default.sources.USER))}))}function R(e){return{key:y.keys.TAB,shiftKey:!e,format:{"code-block":!0},handler:function(t){var n=d.default.query("code-block"),r=t.index,i=t.length,a=this.quill.scroll.descendant(n,r),s=o(a,2),c=s[0],l=s[1];if(null!=c){var u=this.quill.getIndex(c),h=c.newlineIndex(l,!0)+1,f=c.newlineIndex(u+l+i),m=c.domNode.textContent.slice(h,f).split("\n");l=0,m.forEach((function(t,o){e?(c.insertAt(h+l,n.TAB),l+=n.TAB.length,0===o?r+=n.TAB.length:i+=n.TAB.length):t.startsWith(n.TAB)&&(c.deleteAt(h+l,n.TAB.length),l-=n.TAB.length,0===o?r-=n.TAB.length:i-=n.TAB.length),l+=t.length+1})),this.quill.update(p.default.sources.USER),this.quill.setSelection(r,i,p.default.sources.SILENT)}}}}function C(e){return{key:e[0].toUpperCase(),shortKey:!0,handler:function(t,n){this.quill.format(e,!n.format[e],p.default.sources.USER)}}}function w(e){if("string"===typeof e||"number"===typeof e)return w({key:e});if("object"===("undefined"===typeof e?"undefined":r(e))&&(e=(0,a.default)(e,!1)),"string"===typeof e.key)if(null!=y.keys[e.key.toUpperCase()])e.key=y.keys[e.key.toUpperCase()];else{if(1!==e.key.length)return null;e.key=e.key.toUpperCase().charCodeAt(0)}return e.shortKey&&(e[E]=e.shortKey,delete e.shortKey),e}y.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},y.DEFAULTS={bindings:{bold:C("bold"),italic:C("italic"),underline:C("underline"),indent:{key:y.keys.TAB,format:["blockquote","indent","list"],handler:function(e,t){if(t.collapsed&&0!==t.offset)return!0;this.quill.format("indent","+1",p.default.sources.USER)}},outdent:{key:y.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(e,t){if(t.collapsed&&0!==t.offset)return!0;this.quill.format("indent","-1",p.default.sources.USER)}},"outdent backspace":{key:y.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(e,t){null!=t.format.indent?this.quill.format("indent","-1",p.default.sources.USER):null!=t.format.list&&this.quill.format("list",!1,p.default.sources.USER)}},"indent code-block":R(!0),"outdent code-block":R(!1),"remove tab":{key:y.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(e){this.quill.deleteText(e.index-1,1,p.default.sources.USER)}},tab:{key:y.keys.TAB,handler:function(e){this.quill.history.cutoff();var t=(new l.default).retain(e.index).delete(e.length).insert("\t");this.quill.updateContents(t,p.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index+1,p.default.sources.SILENT)}},"list empty enter":{key:y.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(e,t){this.quill.format("list",!1,p.default.sources.USER),t.format.indent&&this.quill.format("indent",!1,p.default.sources.USER)}},"checklist enter":{key:y.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(e){var t=this.quill.getLine(e.index),n=o(t,2),r=n[0],i=n[1],a=(0,c.default)({},r.formats(),{list:"checked"}),s=(new l.default).retain(e.index).insert("\n",a).retain(r.length()-i-1).retain(1,{list:"unchecked"});this.quill.updateContents(s,p.default.sources.USER),this.quill.setSelection(e.index+1,p.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:y.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(e,t){var n=this.quill.getLine(e.index),r=o(n,2),i=r[0],a=r[1],s=(new l.default).retain(e.index).insert("\n",t.format).retain(i.length()-a-1).retain(1,{header:null});this.quill.updateContents(s,p.default.sources.USER),this.quill.setSelection(e.index+1,p.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(e,t){var n=t.prefix.length,r=this.quill.getLine(e.index),i=o(r,2),a=i[0],s=i[1];if(s>n)return!0;var c=void 0;switch(t.prefix.trim()){case"[]":case"[ ]":c="unchecked";break;case"[x]":c="checked";break;case"-":case"*":c="bullet";break;default:c="ordered"}this.quill.insertText(e.index," ",p.default.sources.USER),this.quill.history.cutoff();var u=(new l.default).retain(e.index-s).delete(n+1).retain(a.length()-2-s).retain(1,{list:c});this.quill.updateContents(u,p.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index-n,p.default.sources.SILENT)}},"code exit":{key:y.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(e){var t=this.quill.getLine(e.index),n=o(t,2),r=n[0],i=n[1],a=(new l.default).retain(e.index+r.length()-i-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(a,p.default.sources.USER)}},"embed left":_(y.keys.LEFT,!1),"embed left shift":_(y.keys.LEFT,!0),"embed right":_(y.keys.RIGHT,!1),"embed right shift":_(y.keys.RIGHT,!0)}},t.default=y,t.SHORTKEY=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=c(n(0)),s=c(n(7));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.selection=n,r.textNode=document.createTextNode(t.CONTENTS),r.domNode.appendChild(r.textNode),r._length=0,r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,null,[{key:"value",value:function(){}}]),i(t,[{key:"detach",value:function(){null!=this.parent&&this.parent.removeChild(this)}},{key:"format",value:function(e,n){if(0!==this._length)return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"format",this).call(this,e,n);for(var r=this,i=0;null!=r&&r.statics.scope!==a.default.Scope.BLOCK_BLOT;)i+=r.offset(r.parent),r=r.parent;null!=r&&(this._length=t.CONTENTS.length,r.optimize(),r.formatAt(i,t.CONTENTS.length,e,n),this._length=0)}},{key:"index",value:function(e,n){return e===this.textNode?0:o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"index",this).call(this,e,n)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!this.selection.composing&&null!=this.parent){var e=this.textNode,n=this.selection.getNativeRange(),o=void 0,i=void 0,c=void 0;if(null!=n&&n.start.node===e&&n.end.node===e){var l=[e,n.start.offset,n.end.offset];o=l[0],i=l[1],c=l[2]}for(;null!=this.domNode.lastChild&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==t.CONTENTS){var u=this.textNode.data.split(t.CONTENTS).join("");this.next instanceof s.default?(o=this.next.domNode,this.next.insertAt(0,u),this.textNode.data=t.CONTENTS):(this.textNode.data=u,this.parent.insertBefore(a.default.create(this.textNode),this),this.textNode=document.createTextNode(t.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),null!=i){var d=[i,c].map((function(e){return Math.max(0,Math.min(o.data.length,e-1))})),p=r(d,2);return i=p[0],c=p[1],{startNode:o,startOffset:i,endNode:o,endOffset:c}}}}},{key:"update",value:function(e,t){var n=this;if(e.some((function(e){return"characterData"===e.type&&e.target===n.textNode}))){var r=this.restore();r&&(t.range=r)}}},{key:"value",value:function(){return""}}]),t}(a.default.Embed);l.blotName="cursor",l.className="ql-cursor",l.tagName="span",l.CONTENTS="\ufeff",t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),o=n(4),i=a(o);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r.default.Container);s.allowedChildren=[i.default,o.BlockEmbed,s],t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorStyle=t.ColorClass=t.ColorAttributor=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(0),s=(r=a)&&r.__esModule?r:{default:r},c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"value",value:function(e){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"value",this).call(this,e);return n.startsWith("rgb(")?(n=n.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+n.split(",").map((function(e){return("00"+parseInt(e).toString(16)).slice(-2)})).join("")):n}}]),t}(s.default.Attributor.Style),l=new s.default.Attributor.Class("color","ql-color",{scope:s.default.Scope.INLINE}),u=new c("color","color",{scope:s.default.Scope.INLINE});t.ColorAttributor=c,t.ColorClass=l,t.ColorStyle=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sanitize=t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(6),s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"format",value:function(e,n){if(e!==this.statics.blotName||!n)return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"format",this).call(this,e,n);n=this.constructor.sanitize(n),this.domNode.setAttribute("href",n)}}],[{key:"create",value:function(e){var n=i(t.__proto__||Object.getPrototypeOf(t),"create",this).call(this,e);return e=this.sanitize(e),n.setAttribute("href",e),n.setAttribute("rel","noopener noreferrer"),n.setAttribute("target","_blank"),n}},{key:"formats",value:function(e){return e.getAttribute("href")}},{key:"sanitize",value:function(e){return c(e,this.PROTOCOL_WHITELIST)?e:this.SANITIZED_URL}}]),t}(((r=a)&&r.__esModule?r:{default:r}).default);function c(e,t){var n=document.createElement("a");n.href=e;var r=n.href.slice(0,n.href.indexOf(":"));return t.indexOf(r)>-1}s.blotName="link",s.tagName="A",s.SANITIZED_URL="about:blank",s.PROTOCOL_WHITELIST=["http","https","mailto","tel"],t.default=s,t.sanitize=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(23)),a=s(n(107));function s(e){return e&&e.__esModule?e:{default:e}}var c=0;function l(e,t){e.setAttribute(t,!("true"===e.getAttribute(t)))}var u=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.select=t,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",(function(){n.togglePicker()})),this.label.addEventListener("keydown",(function(e){switch(e.keyCode){case i.default.keys.ENTER:n.togglePicker();break;case i.default.keys.ESCAPE:n.escape(),e.preventDefault()}})),this.select.addEventListener("change",this.update.bind(this))}return o(e,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),l(this.label,"aria-expanded"),l(this.options,"aria-hidden")}},{key:"buildItem",value:function(e){var t=this,n=document.createElement("span");return n.tabIndex="0",n.setAttribute("role","button"),n.classList.add("ql-picker-item"),e.hasAttribute("value")&&n.setAttribute("data-value",e.getAttribute("value")),e.textContent&&n.setAttribute("data-label",e.textContent),n.addEventListener("click",(function(){t.selectItem(n,!0)})),n.addEventListener("keydown",(function(e){switch(e.keyCode){case i.default.keys.ENTER:t.selectItem(n,!0),e.preventDefault();break;case i.default.keys.ESCAPE:t.escape(),e.preventDefault()}})),n}},{key:"buildLabel",value:function(){var e=document.createElement("span");return e.classList.add("ql-picker-label"),e.innerHTML=a.default,e.tabIndex="0",e.setAttribute("role","button"),e.setAttribute("aria-expanded","false"),this.container.appendChild(e),e}},{key:"buildOptions",value:function(){var e=this,t=document.createElement("span");t.classList.add("ql-picker-options"),t.setAttribute("aria-hidden","true"),t.tabIndex="-1",t.id="ql-picker-options-"+c,c+=1,this.label.setAttribute("aria-controls",t.id),this.options=t,[].slice.call(this.select.options).forEach((function(n){var r=e.buildItem(n);t.appendChild(r),!0===n.selected&&e.selectItem(r)})),this.container.appendChild(t)}},{key:"buildPicker",value:function(){var e=this;[].slice.call(this.select.attributes).forEach((function(t){e.container.setAttribute(t.name,t.value)})),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var e=this;this.close(),setTimeout((function(){return e.label.focus()}),1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.container.querySelector(".ql-selected");if(e!==n&&(null!=n&&n.classList.remove("ql-selected"),null!=e&&(e.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(e.parentNode.children,e),e.hasAttribute("data-value")?this.label.setAttribute("data-value",e.getAttribute("data-value")):this.label.removeAttribute("data-value"),e.hasAttribute("data-label")?this.label.setAttribute("data-label",e.getAttribute("data-label")):this.label.removeAttribute("data-label"),t))){if("function"===typeof Event)this.select.dispatchEvent(new Event("change"));else if("object"===("undefined"===typeof Event?"undefined":r(Event))){var o=document.createEvent("Event");o.initEvent("change",!0,!0),this.select.dispatchEvent(o)}this.close()}}},{key:"update",value:function(){var e=void 0;if(this.select.selectedIndex>-1){var t=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];e=this.select.options[this.select.selectedIndex],this.selectItem(t)}else this.selectItem(null);var n=null!=e&&e!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",n)}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=g(n(0)),o=g(n(5)),i=n(4),a=g(i),s=g(n(16)),c=g(n(25)),l=g(n(24)),u=g(n(35)),d=g(n(6)),p=g(n(22)),h=g(n(7)),f=g(n(55)),m=g(n(42)),v=g(n(23));function g(e){return e&&e.__esModule?e:{default:e}}o.default.register({"blots/block":a.default,"blots/block/embed":i.BlockEmbed,"blots/break":s.default,"blots/container":c.default,"blots/cursor":l.default,"blots/embed":u.default,"blots/inline":d.default,"blots/scroll":p.default,"blots/text":h.default,"modules/clipboard":f.default,"modules/history":m.default,"modules/keyboard":v.default}),r.default.register(a.default,s.default,l.default,d.default,p.default,h.default),t.default=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(){function e(e){this.domNode=e,this.domNode[r.DATA_KEY]={blot:this}}return Object.defineProperty(e.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),e.create=function(e){if(null==this.tagName)throw new r.ParchmentError("Blot definition missing tagName");var t;return Array.isArray(this.tagName)?("string"===typeof e&&(e=e.toUpperCase(),parseInt(e).toString()===e&&(e=parseInt(e))),t="number"===typeof e?document.createElement(this.tagName[e-1]):this.tagName.indexOf(e)>-1?document.createElement(e):document.createElement(this.tagName[0])):t=document.createElement(this.tagName),this.className&&t.classList.add(this.className),t},e.prototype.attach=function(){null!=this.parent&&(this.scroll=this.parent.scroll)},e.prototype.clone=function(){var e=this.domNode.cloneNode(!1);return r.create(e)},e.prototype.detach=function(){null!=this.parent&&this.parent.removeChild(this),delete this.domNode[r.DATA_KEY]},e.prototype.deleteAt=function(e,t){this.isolate(e,t).remove()},e.prototype.formatAt=function(e,t,n,o){var i=this.isolate(e,t);if(null!=r.query(n,r.Scope.BLOT)&&o)i.wrap(n,o);else if(null!=r.query(n,r.Scope.ATTRIBUTE)){var a=r.create(this.statics.scope);i.wrap(a),a.format(n,o)}},e.prototype.insertAt=function(e,t,n){var o=null==n?r.create("text",t):r.create(t,n),i=this.split(e);this.parent.insertBefore(o,i)},e.prototype.insertInto=function(e,t){void 0===t&&(t=null),null!=this.parent&&this.parent.children.remove(this);var n=null;e.children.insertBefore(this,t),null!=t&&(n=t.domNode),this.domNode.parentNode==e.domNode&&this.domNode.nextSibling==n||e.domNode.insertBefore(this.domNode,n),this.parent=e,this.attach()},e.prototype.isolate=function(e,t){var n=this.split(e);return n.split(t),n},e.prototype.length=function(){return 1},e.prototype.offset=function(e){return void 0===e&&(e=this.parent),null==this.parent||this==e?0:this.parent.children.offset(this)+this.parent.offset(e)},e.prototype.optimize=function(e){null!=this.domNode[r.DATA_KEY]&&delete this.domNode[r.DATA_KEY].mutations},e.prototype.remove=function(){null!=this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},e.prototype.replace=function(e){null!=e.parent&&(e.parent.insertBefore(this,e.next),e.remove())},e.prototype.replaceWith=function(e,t){var n="string"===typeof e?r.create(e,t):e;return n.replace(this),n},e.prototype.split=function(e,t){return 0===e?this:this.next},e.prototype.update=function(e,t){},e.prototype.wrap=function(e,t){var n="string"===typeof e?r.create(e,t):e;return null!=this.parent&&this.parent.insertBefore(n,this.next),n.appendChild(this),n},e.blotName="abstract",e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=n(32),i=n(33),a=n(1),s=function(){function e(e){this.attributes={},this.domNode=e,this.build()}return e.prototype.attribute=function(e,t){t?e.add(this.domNode,t)&&(null!=e.value(this.domNode)?this.attributes[e.attrName]=e:delete this.attributes[e.attrName]):(e.remove(this.domNode),delete this.attributes[e.attrName])},e.prototype.build=function(){var e=this;this.attributes={};var t=r.default.keys(this.domNode),n=o.default.keys(this.domNode),s=i.default.keys(this.domNode);t.concat(n).concat(s).forEach((function(t){var n=a.query(t,a.Scope.ATTRIBUTE);n instanceof r.default&&(e.attributes[n.attrName]=n)}))},e.prototype.copy=function(e){var t=this;Object.keys(this.attributes).forEach((function(n){var r=t.attributes[n].value(t.domNode);e.format(n,r)}))},e.prototype.move=function(e){var t=this;this.copy(e),Object.keys(this.attributes).forEach((function(e){t.attributes[e].remove(t.domNode)})),this.attributes={}},e.prototype.values=function(){var e=this;return Object.keys(this.attributes).reduce((function(t,n){return t[n]=e.attributes[n].value(e.domNode),t}),{})},e}();t.default=s},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function o(e,t){return(e.getAttribute("class")||"").split(/\s+/).filter((function(e){return 0===e.indexOf(t+"-")}))}Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.keys=function(e){return(e.getAttribute("class")||"").split(/\s+/).map((function(e){return e.split("-").slice(0,-1).join("-")}))},t.prototype.add=function(e,t){return!!this.canAdd(e,t)&&(this.remove(e),e.classList.add(this.keyName+"-"+t),!0)},t.prototype.remove=function(e){o(e,this.keyName).forEach((function(t){e.classList.remove(t)})),0===e.classList.length&&e.removeAttribute("class")},t.prototype.value=function(e){var t=(o(e,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(e,t)?t:""},t}(n(12).default);t.default=i},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function o(e){var t=e.split("-"),n=t.slice(1).map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("");return t[0]+n}Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.keys=function(e){return(e.getAttribute("style")||"").split(";").map((function(e){return e.split(":")[0].trim()}))},t.prototype.add=function(e,t){return!!this.canAdd(e,t)&&(e.style[o(this.keyName)]=t,!0)},t.prototype.remove=function(e){e.style[o(this.keyName)]="",e.getAttribute("style")||e.removeAttribute("style")},t.prototype.value=function(e){var t=e.style[o(this.keyName)];return this.canAdd(e,t)?t:""},t}(n(12).default);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.quill=t,this.options=n,this.modules={}}return r(e,[{key:"init",value:function(){var e=this;Object.keys(this.options.modules).forEach((function(t){null==e.modules[t]&&e.addModule(t)}))}},{key:"addModule",value:function(e){var t=this.quill.constructor.import("modules/"+e);return this.modules[e]=new t(this.quill,this.options.modules[e]||{}),this.modules[e]}}]),e}();o.DEFAULTS={modules:{}},o.themes={default:o},t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=s(n(0)),a=s(n(7));function s(e){return e&&e.__esModule?e:{default:e}}var c="\ufeff",l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.contentNode=document.createElement("span"),n.contentNode.setAttribute("contenteditable",!1),[].slice.call(n.domNode.childNodes).forEach((function(e){n.contentNode.appendChild(e)})),n.leftGuard=document.createTextNode(c),n.rightGuard=document.createTextNode(c),n.domNode.appendChild(n.leftGuard),n.domNode.appendChild(n.contentNode),n.domNode.appendChild(n.rightGuard),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"index",value:function(e,n){return e===this.leftGuard?0:e===this.rightGuard?1:o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"index",this).call(this,e,n)}},{key:"restore",value:function(e){var t=void 0,n=void 0,r=e.data.split(c).join("");if(e===this.leftGuard)if(this.prev instanceof a.default){var o=this.prev.length();this.prev.insertAt(o,r),t={startNode:this.prev.domNode,startOffset:o+r.length}}else n=document.createTextNode(r),this.parent.insertBefore(i.default.create(n),this),t={startNode:n,startOffset:r.length};else e===this.rightGuard&&(this.next instanceof a.default?(this.next.insertAt(0,r),t={startNode:this.next.domNode,startOffset:r.length}):(n=document.createTextNode(r),this.parent.insertBefore(i.default.create(n),this.next),t={startNode:n,startOffset:r.length}));return e.data=c,t}},{key:"update",value:function(e,t){var n=this;e.forEach((function(e){if("characterData"===e.type&&(e.target===n.leftGuard||e.target===n.rightGuard)){var r=n.restore(e.target);r&&(t.range=r)}}))}}]),t}(i.default.Embed);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AlignStyle=t.AlignClass=t.AlignAttribute=void 0;var r,o=n(0),i=(r=o)&&r.__esModule?r:{default:r},a={scope:i.default.Scope.BLOCK,whitelist:["right","center","justify"]},s=new i.default.Attributor.Attribute("align","align",a),c=new i.default.Attributor.Class("align","ql-align",a),l=new i.default.Attributor.Style("align","text-align",a);t.AlignAttribute=s,t.AlignClass=c,t.AlignStyle=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundStyle=t.BackgroundClass=void 0;var r,o=n(0),i=(r=o)&&r.__esModule?r:{default:r},a=n(26),s=new i.default.Attributor.Class("background","ql-bg",{scope:i.default.Scope.INLINE}),c=new a.ColorAttributor("background","background-color",{scope:i.default.Scope.INLINE});t.BackgroundClass=s,t.BackgroundStyle=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DirectionStyle=t.DirectionClass=t.DirectionAttribute=void 0;var r,o=n(0),i=(r=o)&&r.__esModule?r:{default:r},a={scope:i.default.Scope.BLOCK,whitelist:["rtl"]},s=new i.default.Attributor.Attribute("direction","dir",a),c=new i.default.Attributor.Class("direction","ql-direction",a),l=new i.default.Attributor.Style("direction","direction",a);t.DirectionAttribute=s,t.DirectionClass=c,t.DirectionStyle=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontClass=t.FontStyle=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(0),s=(r=a)&&r.__esModule?r:{default:r},c={scope:s.default.Scope.INLINE,whitelist:["serif","monospace"]},l=new s.default.Attributor.Class("font","ql-font",c),u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"value",value:function(e){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"value",this).call(this,e).replace(/["']/g,"")}}]),t}(s.default.Attributor.Style),d=new u("font","font-family",c);t.FontStyle=d,t.FontClass=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SizeStyle=t.SizeClass=void 0;var r,o=n(0),i=(r=o)&&r.__esModule?r:{default:r},a=new i.default.Attributor.Class("size","ql-size",{scope:i.default.Scope.INLINE,whitelist:["small","large","huge"]}),s=new i.default.Attributor.Style("size","font-size",{scope:i.default.Scope.INLINE,whitelist:["10px","18px","32px"]});t.SizeClass=a,t.SizeStyle=s},function(e,t,n){"use strict";e.exports={align:{"":n(76),center:n(77),right:n(78),justify:n(79)},background:n(80),blockquote:n(81),bold:n(82),clean:n(83),code:n(58),"code-block":n(58),color:n(84),direction:{"":n(85),rtl:n(86)},float:{center:n(87),full:n(88),left:n(89),right:n(90)},formula:n(91),header:{1:n(92),2:n(93)},italic:n(94),image:n(95),indent:{"+1":n(96),"-1":n(97)},link:n(98),list:{ordered:n(99),bullet:n(100),check:n(101)},script:{sub:n(102),super:n(103)},strike:n(104),underline:n(105),video:n(106)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLastChangeIndex=t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(0)),i=a(n(5));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.lastRecorded=0,r.ignoreChange=!1,r.clear(),r.quill.on(i.default.events.EDITOR_CHANGE,(function(e,t,n,o){e!==i.default.events.TEXT_CHANGE||r.ignoreChange||(r.options.userOnly&&o!==i.default.sources.USER?r.transform(t):r.record(t,n))})),r.quill.keyboard.addBinding({key:"Z",shortKey:!0},r.undo.bind(r)),r.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},r.redo.bind(r)),/Win/i.test(navigator.platform)&&r.quill.keyboard.addBinding({key:"Y",shortKey:!0},r.redo.bind(r)),r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"change",value:function(e,t){if(0!==this.stack[e].length){var n=this.stack[e].pop();this.stack[t].push(n),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(n[e],i.default.sources.USER),this.ignoreChange=!1;var r=c(n[e]);this.quill.setSelection(r)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(e,t){if(0!==e.ops.length){this.stack.redo=[];var n=this.quill.getContents().diff(t),r=Date.now();if(this.lastRecorded+this.options.delay>r&&this.stack.undo.length>0){var o=this.stack.undo.pop();n=n.compose(o.undo),e=o.redo.compose(e)}else this.lastRecorded=r;this.stack.undo.push({redo:e,undo:n}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(e){this.stack.undo.forEach((function(t){t.undo=e.transform(t.undo,!0),t.redo=e.transform(t.redo,!0)})),this.stack.redo.forEach((function(t){t.undo=e.transform(t.undo,!0),t.redo=e.transform(t.redo,!0)}))}},{key:"undo",value:function(){this.change("undo","redo")}}]),t}(a(n(9)).default);function c(e){var t=e.reduce((function(e,t){return e+=t.delete||0}),0),n=e.length()-t;return function(e){var t=e.ops[e.ops.length-1];return null!=t&&(null!=t.insert?"string"===typeof t.insert&&t.insert.endsWith("\n"):null!=t.attributes&&Object.keys(t.attributes).some((function(e){return null!=o.default.query(e,o.default.Scope.BLOCK)})))}(e)&&(n-=1),n}s.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1},t.default=s,t.getLastChangeIndex=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BaseTooltip=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=f(n(3)),a=f(n(2)),s=f(n(8)),c=f(n(23)),l=f(n(34)),u=f(n(59)),d=f(n(60)),p=f(n(28)),h=f(n(61));function f(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function g(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var E=[!1,"center","right","justify"],y=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],_=[!1,"serif","monospace"],b=["1","2","3",!1],T=["small",!1,"large","huge"],S=function(e){function t(e,n){m(this,t);var r=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return e.emitter.listenDOM("click",document.body,(function t(n){if(!document.body.contains(e.root))return document.body.removeEventListener("click",t);null==r.tooltip||r.tooltip.root.contains(n.target)||document.activeElement===r.tooltip.textbox||r.quill.hasFocus()||r.tooltip.hide(),null!=r.pickers&&r.pickers.forEach((function(e){e.container.contains(n.target)||e.close()}))})),r}return g(t,e),r(t,[{key:"addModule",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"addModule",this).call(this,e);return"toolbar"===e&&this.extendToolbar(n),n}},{key:"buildButtons",value:function(e,t){e.forEach((function(e){(e.getAttribute("class")||"").split(/\s+/).forEach((function(n){if(n.startsWith("ql-")&&(n=n.slice(3),null!=t[n]))if("direction"===n)e.innerHTML=t[n][""]+t[n].rtl;else if("string"===typeof t[n])e.innerHTML=t[n];else{var r=e.value||"";null!=r&&t[n][r]&&(e.innerHTML=t[n][r])}}))}))}},{key:"buildPickers",value:function(e,t){var n=this;this.pickers=e.map((function(e){if(e.classList.contains("ql-align"))return null==e.querySelector("option")&&R(e,E),new d.default(e,t.align);if(e.classList.contains("ql-background")||e.classList.contains("ql-color")){var n=e.classList.contains("ql-background")?"background":"color";return null==e.querySelector("option")&&R(e,y,"background"===n?"#ffffff":"#000000"),new u.default(e,t[n])}return null==e.querySelector("option")&&(e.classList.contains("ql-font")?R(e,_):e.classList.contains("ql-header")?R(e,b):e.classList.contains("ql-size")&&R(e,T)),new p.default(e)})),this.quill.on(s.default.events.EDITOR_CHANGE,(function(){n.pickers.forEach((function(e){e.update()}))}))}}]),t}(l.default);S.DEFAULTS=(0,i.default)(!0,{},l.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var e=this,t=this.container.querySelector("input.ql-image[type=file]");null==t&&((t=document.createElement("input")).setAttribute("type","file"),t.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),t.classList.add("ql-image"),t.addEventListener("change",(function(){if(null!=t.files&&null!=t.files[0]){var n=new FileReader;n.onload=function(n){var r=e.quill.getSelection(!0);e.quill.updateContents((new a.default).retain(r.index).delete(r.length).insert({image:n.target.result}),s.default.sources.USER),e.quill.setSelection(r.index+1,s.default.sources.SILENT),t.value=""},n.readAsDataURL(t.files[0])}})),this.container.appendChild(t)),t.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var O=function(e){function t(e,n){m(this,t);var r=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.textbox=r.root.querySelector('input[type="text"]'),r.listen(),r}return g(t,e),r(t,[{key:"listen",value:function(){var e=this;this.textbox.addEventListener("keydown",(function(t){c.default.match(t,"enter")?(e.save(),t.preventDefault()):c.default.match(t,"escape")&&(e.cancel(),t.preventDefault())}))}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"link",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),null!=t?this.textbox.value=t:e!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+e)||""),this.root.setAttribute("data-mode",e)}},{key:"restoreFocus",value:function(){var e=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=e}},{key:"save",value:function(){var e=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":var t=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",e,s.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",e,s.default.sources.USER)),this.quill.root.scrollTop=t;break;case"video":e=function(e){var t=e.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||e.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return t?(t[1]||"https")+"://www.youtube.com/embed/"+t[2]+"?showinfo=0":(t=e.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(t[1]||"https")+"://player.vimeo.com/video/"+t[2]+"/":e}(e);case"formula":if(!e)break;var n=this.quill.getSelection(!0);if(null!=n){var r=n.index+n.length;this.quill.insertEmbed(r,this.root.getAttribute("data-mode"),e,s.default.sources.USER),"formula"===this.root.getAttribute("data-mode")&&this.quill.insertText(r+1," ",s.default.sources.USER),this.quill.setSelection(r+2,s.default.sources.USER)}}this.textbox.value="",this.hide()}}]),t}(h.default);function R(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.forEach((function(t){var r=document.createElement("option");t===n?r.setAttribute("selected","selected"):r.setAttribute("value",t),e.appendChild(r)}))}t.BaseTooltip=O,t.default=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.head=this.tail=null,this.length=0}return e.prototype.append=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.insertBefore(e[0],null),e.length>1&&this.append.apply(this,e.slice(1))},e.prototype.contains=function(e){for(var t,n=this.iterator();t=n();)if(t===e)return!0;return!1},e.prototype.insertBefore=function(e,t){e&&(e.next=t,null!=t?(e.prev=t.prev,null!=t.prev&&(t.prev.next=e),t.prev=e,t===this.head&&(this.head=e)):null!=this.tail?(this.tail.next=e,e.prev=this.tail,this.tail=e):(e.prev=null,this.head=this.tail=e),this.length+=1)},e.prototype.offset=function(e){for(var t=0,n=this.head;null!=n;){if(n===e)return t;t+=n.length(),n=n.next}return-1},e.prototype.remove=function(e){this.contains(e)&&(null!=e.prev&&(e.prev.next=e.next),null!=e.next&&(e.next.prev=e.prev),e===this.head&&(this.head=e.next),e===this.tail&&(this.tail=e.prev),this.length-=1)},e.prototype.iterator=function(e){return void 0===e&&(e=this.head),function(){var t=e;return null!=e&&(e=e.next),t}},e.prototype.find=function(e,t){void 0===t&&(t=!1);for(var n,r=this.iterator();n=r();){var o=n.length();if(e<o||t&&e===o&&(null==n.next||0!==n.next.length()))return[n,e];e-=o}return[null,0]},e.prototype.forEach=function(e){for(var t,n=this.iterator();t=n();)e(t)},e.prototype.forEachAt=function(e,t,n){if(!(t<=0))for(var r,o=this.find(e),i=o[0],a=e-o[1],s=this.iterator(i);(r=s())&&a<e+t;){var c=r.length();e>a?n(r,e-a,Math.min(t,a+c-e)):n(r,0,Math.min(c,e+t-a)),a+=c}},e.prototype.map=function(e){return this.reduce((function(t,n){return t.push(e(n)),t}),[])},e.prototype.reduce=function(e,t){for(var n,r=this.iterator();n=r();)t=e(t,n);return t},e}();t.default=r},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),i=n(1),a={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},s=function(e){function t(t){var n=e.call(this,t)||this;return n.scroll=n,n.observer=new MutationObserver((function(e){n.update(e)})),n.observer.observe(n.domNode,a),n.attach(),n}return r(t,e),t.prototype.detach=function(){e.prototype.detach.call(this),this.observer.disconnect()},t.prototype.deleteAt=function(t,n){this.update(),0===t&&n===this.length()?this.children.forEach((function(e){e.remove()})):e.prototype.deleteAt.call(this,t,n)},t.prototype.formatAt=function(t,n,r,o){this.update(),e.prototype.formatAt.call(this,t,n,r,o)},t.prototype.insertAt=function(t,n,r){this.update(),e.prototype.insertAt.call(this,t,n,r)},t.prototype.optimize=function(t,n){var r=this;void 0===t&&(t=[]),void 0===n&&(n={}),e.prototype.optimize.call(this,n);for(var a=[].slice.call(this.observer.takeRecords());a.length>0;)t.push(a.pop());for(var s=function(e,t){void 0===t&&(t=!0),null!=e&&e!==r&&null!=e.domNode.parentNode&&(null==e.domNode[i.DATA_KEY].mutations&&(e.domNode[i.DATA_KEY].mutations=[]),t&&s(e.parent))},c=function(e){null!=e.domNode[i.DATA_KEY]&&null!=e.domNode[i.DATA_KEY].mutations&&(e instanceof o.default&&e.children.forEach(c),e.optimize(n))},l=t,u=0;l.length>0;u+=1){if(u>=100)throw new Error("[Parchment] Maximum optimize iterations reached");for(l.forEach((function(e){var t=i.find(e.target,!0);null!=t&&(t.domNode===e.target&&("childList"===e.type?(s(i.find(e.previousSibling,!1)),[].forEach.call(e.addedNodes,(function(e){var t=i.find(e,!1);s(t,!1),t instanceof o.default&&t.children.forEach((function(e){s(e,!1)}))}))):"attributes"===e.type&&s(t.prev)),s(t))})),this.children.forEach(c),a=(l=[].slice.call(this.observer.takeRecords())).slice();a.length>0;)t.push(a.pop())}},t.prototype.update=function(t,n){var r=this;void 0===n&&(n={}),(t=t||this.observer.takeRecords()).map((function(e){var t=i.find(e.target,!0);return null==t?null:null==t.domNode[i.DATA_KEY].mutations?(t.domNode[i.DATA_KEY].mutations=[e],t):(t.domNode[i.DATA_KEY].mutations.push(e),null)})).forEach((function(e){null!=e&&e!==r&&null!=e.domNode[i.DATA_KEY]&&e.update(e.domNode[i.DATA_KEY].mutations||[],n)})),null!=this.domNode[i.DATA_KEY].mutations&&e.prototype.update.call(this,this.domNode[i.DATA_KEY].mutations,n),this.optimize(t,n)},t.blotName="scroll",t.defaultChild="block",t.scope=i.Scope.BLOCK_BLOT,t.tagName="DIV",t}(o.default);t.default=s},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(18),i=n(1),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.formats=function(n){if(n.tagName!==t.tagName)return e.formats.call(this,n)},t.prototype.format=function(n,r){var i=this;n!==this.statics.blotName||r?e.prototype.format.call(this,n,r):(this.children.forEach((function(e){e instanceof o.default||(e=e.wrap(t.blotName,!0)),i.attributes.copy(e)})),this.unwrap())},t.prototype.formatAt=function(t,n,r,o){null!=this.formats()[r]||i.query(r,i.Scope.ATTRIBUTE)?this.isolate(t,n).format(r,o):e.prototype.formatAt.call(this,t,n,r,o)},t.prototype.optimize=function(n){e.prototype.optimize.call(this,n);var r=this.formats();if(0===Object.keys(r).length)return this.unwrap();var o=this.next;o instanceof t&&o.prev===this&&function(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e)if(e[n]!==t[n])return!1;return!0}(r,o.formats())&&(o.moveChildren(this),o.remove())},t.blotName="inline",t.scope=i.Scope.INLINE_BLOT,t.tagName="SPAN",t}(o.default);t.default=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(18),i=n(1),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.formats=function(n){var r=i.query(t.blotName).tagName;if(n.tagName!==r)return e.formats.call(this,n)},t.prototype.format=function(n,r){null!=i.query(n,i.Scope.BLOCK)&&(n!==this.statics.blotName||r?e.prototype.format.call(this,n,r):this.replaceWith(t.blotName))},t.prototype.formatAt=function(t,n,r,o){null!=i.query(r,i.Scope.BLOCK)?this.format(r,o):e.prototype.formatAt.call(this,t,n,r,o)},t.prototype.insertAt=function(t,n,r){if(null==r||null!=i.query(n,i.Scope.INLINE))e.prototype.insertAt.call(this,t,n,r);else{var o=this.split(t),a=i.create(n,r);o.parent.insertBefore(a,o)}},t.prototype.update=function(t,n){navigator.userAgent.match(/Trident/)?this.build():e.prototype.update.call(this,t,n)},t.blotName="block",t.scope=i.Scope.BLOCK_BLOT,t.tagName="P",t}(o.default);t.default=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.formats=function(e){},t.prototype.format=function(t,n){e.prototype.formatAt.call(this,0,this.length(),t,n)},t.prototype.formatAt=function(t,n,r,o){0===t&&n===this.length()?this.format(r,o):e.prototype.formatAt.call(this,t,n,r,o)},t.prototype.formats=function(){return this.statics.formats(this.domNode)},t}(n(19).default);t.default=o},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(19),i=n(1),a=function(e){function t(t){var n=e.call(this,t)||this;return n.text=n.statics.value(n.domNode),n}return r(t,e),t.create=function(e){return document.createTextNode(e)},t.value=function(e){var t=e.data;return t.normalize&&(t=t.normalize()),t},t.prototype.deleteAt=function(e,t){this.domNode.data=this.text=this.text.slice(0,e)+this.text.slice(e+t)},t.prototype.index=function(e,t){return this.domNode===e?t:-1},t.prototype.insertAt=function(t,n,r){null==r?(this.text=this.text.slice(0,t)+n+this.text.slice(t),this.domNode.data=this.text):e.prototype.insertAt.call(this,t,n,r)},t.prototype.length=function(){return this.text.length},t.prototype.optimize=function(n){e.prototype.optimize.call(this,n),this.text=this.statics.value(this.domNode),0===this.text.length?this.remove():this.next instanceof t&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},t.prototype.position=function(e,t){return void 0===t&&(t=!1),[this.domNode,e]},t.prototype.split=function(e,t){if(void 0===t&&(t=!1),!t){if(0===e)return this;if(e===this.length())return this.next}var n=i.create(this.domNode.splitText(e));return this.parent.insertBefore(n,this.next),this.text=this.statics.value(this.domNode),n},t.prototype.update=function(e,t){var n=this;e.some((function(e){return"characterData"===e.type&&e.target===n.domNode}))&&(this.text=this.statics.value(this.domNode))},t.prototype.value=function(){return this.text},t.blotName="text",t.scope=i.Scope.INLINE_BLOT,t}(o.default);t.default=a},function(e,t,n){"use strict";var r=document.createElement("div");if(r.classList.toggle("test-class",!1),r.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return arguments.length>1&&!this.contains(e)===!t?t:o.call(this,e)}}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!==typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var r=n.indexOf(e,t);return-1!==r&&r===t}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!==typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,o=arguments[1],i=0;i<r;i++)if(t=n[i],e.call(o,t,i,n))return t}}),document.addEventListener("DOMContentLoaded",(function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)}))},function(e,t){var n=-1;function r(e,t,c){if(e==t)return e?[[0,e]]:[];(c<0||e.length<c)&&(c=null);var u=i(e,t),d=e.substring(0,u);u=a(e=e.substring(u),t=t.substring(u));var p=e.substring(e.length-u),h=function(e,t){var s;if(!e)return[[1,t]];if(!t)return[[n,e]];var c=e.length>t.length?e:t,l=e.length>t.length?t:e,u=c.indexOf(l);if(-1!=u)return s=[[1,c.substring(0,u)],[0,l],[1,c.substring(u+l.length)]],e.length>t.length&&(s[0][0]=s[2][0]=n),s;if(1==l.length)return[[n,e],[1,t]];var d=function(e,t){var n=e.length>t.length?e:t,r=e.length>t.length?t:e;if(n.length<4||2*r.length<n.length)return null;function o(e,t,n){for(var r,o,s,c,l=e.substring(n,n+Math.floor(e.length/4)),u=-1,d="";-1!=(u=t.indexOf(l,u+1));){var p=i(e.substring(n),t.substring(u)),h=a(e.substring(0,n),t.substring(0,u));d.length<h+p&&(d=t.substring(u-h,u)+t.substring(u,u+p),r=e.substring(0,n-h),o=e.substring(n+p),s=t.substring(0,u-h),c=t.substring(u+p))}return 2*d.length>=e.length?[r,o,s,c,d]:null}var s,c,l,u,d,p=o(n,r,Math.ceil(n.length/4)),h=o(n,r,Math.ceil(n.length/2));if(!p&&!h)return null;s=h?p&&p[4].length>h[4].length?p:h:p,e.length>t.length?(c=s[0],l=s[1],u=s[2],d=s[3]):(u=s[0],d=s[1],c=s[2],l=s[3]);var f=s[4];return[c,l,u,d,f]}(e,t);if(d){var p=d[0],h=d[1],f=d[2],m=d[3],v=d[4],g=r(p,f),E=r(h,m);return g.concat([[0,v]],E)}return function(e,t){for(var r=e.length,i=t.length,a=Math.ceil((r+i)/2),s=a,c=2*a,l=new Array(c),u=new Array(c),d=0;d<c;d++)l[d]=-1,u[d]=-1;l[s+1]=0,u[s+1]=0;for(var p=r-i,h=p%2!=0,f=0,m=0,v=0,g=0,E=0;E<a;E++){for(var y=-E+f;y<=E-m;y+=2){for(var _=s+y,b=(C=y==-E||y!=E&&l[_-1]<l[_+1]?l[_+1]:l[_-1]+1)-y;C<r&&b<i&&e.charAt(C)==t.charAt(b);)C++,b++;if(l[_]=C,C>r)m+=2;else if(b>i)f+=2;else if(h&&(O=s+p-y)>=0&&O<c&&-1!=u[O]&&C>=(S=r-u[O]))return o(e,t,C,b)}for(var T=-E+v;T<=E-g;T+=2){for(var S,O=s+T,R=(S=T==-E||T!=E&&u[O-1]<u[O+1]?u[O+1]:u[O-1]+1)-T;S<r&&R<i&&e.charAt(r-S-1)==t.charAt(i-R-1);)S++,R++;if(u[O]=S,S>r)g+=2;else if(R>i)v+=2;else if(!h){var C;if((_=s+p-T)>=0&&_<c&&-1!=l[_])if(b=s+(C=l[_])-_,C>=(S=r-S))return o(e,t,C,b)}}}return[[n,e],[1,t]]}(e,t)}(e=e.substring(0,e.length-u),t=t.substring(0,t.length-u));return d&&h.unshift([0,d]),p&&h.push([0,p]),s(h),null!=c&&(h=function(e,t){var r=function(e,t){if(0===t)return[0,e];for(var r=0,o=0;o<e.length;o++){var i=e[o];if(i[0]===n||0===i[0]){var a=r+i[1].length;if(t===a)return[o+1,e];if(t<a){e=e.slice();var s=t-r,c=[i[0],i[1].slice(0,s)],l=[i[0],i[1].slice(s)];return e.splice(o,1,c,l),[o+1,e]}r=a}}throw new Error("cursor_pos is out of bounds!")}(e,t),o=r[1],i=r[0],a=o[i],s=o[i+1];if(null==a)return e;if(0!==a[0])return e;if(null!=s&&a[1]+s[1]===s[1]+a[1])return o.splice(i,2,s,a),l(o,i,2);if(null!=s&&0===s[1].indexOf(a[1])){o.splice(i,2,[s[0],a[1]],[0,a[1]]);var c=s[1].slice(a[1].length);return c.length>0&&o.splice(i+2,0,[s[0],c]),l(o,i,3)}return e}(h,c)),h=function(e){for(var t=!1,r=function(e){return e.charCodeAt(0)>=56320&&e.charCodeAt(0)<=57343},o=function(e){return e.charCodeAt(e.length-1)>=55296&&e.charCodeAt(e.length-1)<=56319},i=2;i<e.length;i+=1)0===e[i-2][0]&&o(e[i-2][1])&&e[i-1][0]===n&&r(e[i-1][1])&&1===e[i][0]&&r(e[i][1])&&(t=!0,e[i-1][1]=e[i-2][1].slice(-1)+e[i-1][1],e[i][1]=e[i-2][1].slice(-1)+e[i][1],e[i-2][1]=e[i-2][1].slice(0,-1));if(!t)return e;var a=[];for(i=0;i<e.length;i+=1)e[i][1].length>0&&a.push(e[i]);return a}(h)}function o(e,t,n,o){var i=e.substring(0,n),a=t.substring(0,o),s=e.substring(n),c=t.substring(o),l=r(i,a),u=r(s,c);return l.concat(u)}function i(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),o=r,i=0;n<o;)e.substring(i,o)==t.substring(i,o)?i=n=o:r=o,o=Math.floor((r-n)/2+n);return o}function a(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,r=Math.min(e.length,t.length),o=r,i=0;n<o;)e.substring(e.length-o,e.length-i)==t.substring(t.length-o,t.length-i)?i=n=o:r=o,o=Math.floor((r-n)/2+n);return o}function s(e){e.push([0,""]);for(var t,r=0,o=0,c=0,l="",u="";r<e.length;)switch(e[r][0]){case 1:c++,u+=e[r][1],r++;break;case n:o++,l+=e[r][1],r++;break;case 0:o+c>1?(0!==o&&0!==c&&(0!==(t=i(u,l))&&(r-o-c>0&&0==e[r-o-c-1][0]?e[r-o-c-1][1]+=u.substring(0,t):(e.splice(0,0,[0,u.substring(0,t)]),r++),u=u.substring(t),l=l.substring(t)),0!==(t=a(u,l))&&(e[r][1]=u.substring(u.length-t)+e[r][1],u=u.substring(0,u.length-t),l=l.substring(0,l.length-t))),0===o?e.splice(r-c,o+c,[1,u]):0===c?e.splice(r-o,o+c,[n,l]):e.splice(r-o-c,o+c,[n,l],[1,u]),r=r-o-c+(o?1:0)+(c?1:0)+1):0!==r&&0==e[r-1][0]?(e[r-1][1]+=e[r][1],e.splice(r,1)):r++,c=0,o=0,l="",u=""}""===e[e.length-1][1]&&e.pop();var d=!1;for(r=1;r<e.length-1;)0==e[r-1][0]&&0==e[r+1][0]&&(e[r][1].substring(e[r][1].length-e[r-1][1].length)==e[r-1][1]?(e[r][1]=e[r-1][1]+e[r][1].substring(0,e[r][1].length-e[r-1][1].length),e[r+1][1]=e[r-1][1]+e[r+1][1],e.splice(r-1,1),d=!0):e[r][1].substring(0,e[r+1][1].length)==e[r+1][1]&&(e[r-1][1]+=e[r+1][1],e[r][1]=e[r][1].substring(e[r+1][1].length)+e[r+1][1],e.splice(r+1,1),d=!0)),r++;d&&s(e)}var c=r;function l(e,t,n){for(var r=t+n-1;r>=0&&r>=t-1;r--)if(r+1<e.length){var o=e[r],i=e[r+1];o[0]===i[1]&&e.splice(r,2,[o[0],o[1]+i[1]])}return e}c.INSERT=1,c.DELETE=n,c.EQUAL=0,e.exports=c},function(e,t){function n(e){var t=[];for(var n in e)t.push(n);return t}(e.exports="function"===typeof Object.keys?Object.keys:n).shim=n},function(e,t){var n="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function r(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function o(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}(t=e.exports=n?r:o).supported=r,t.unsupported=o},function(e,t){"use strict";var n=Object.prototype.hasOwnProperty,r="~";function o(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,t,o=[];if(0===this._eventsCount)return o;for(t in e=this._events)n.call(e,t)&&o.push(r?t.slice(1):t);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e,t){var n=r?r+e:e,o=this._events[n];if(t)return!!o;if(!o)return[];if(o.fn)return[o.fn];for(var i=0,a=o.length,s=new Array(a);i<a;i++)s[i]=o[i].fn;return s},a.prototype.emit=function(e,t,n,o,i,a){var s=r?r+e:e;if(!this._events[s])return!1;var c,l,u=this._events[s],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,o),!0;case 5:return u.fn.call(u.context,t,n,o,i),!0;case 6:return u.fn.call(u.context,t,n,o,i,a),!0}for(l=1,c=new Array(d-1);l<d;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var p,h=u.length;for(l=0;l<h;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,n);break;case 4:u[l].fn.call(u[l].context,t,n,o);break;default:if(!c)for(p=1,c=new Array(d-1);p<d;p++)c[p-1]=arguments[p];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(e,t,n){var o=new i(t,n||this),a=r?r+e:e;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],o]:this._events[a].push(o):(this._events[a]=o,this._eventsCount++),this},a.prototype.once=function(e,t,n){var o=new i(t,n||this,!0),a=r?r+e:e;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],o]:this._events[a].push(o):(this._events[a]=o,this._eventsCount++),this},a.prototype.removeListener=function(e,t,n,i){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return 0===--this._eventsCount?this._events=new o:delete this._events[a],this;var s=this._events[a];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||(0===--this._eventsCount?this._events=new o:delete this._events[a]);else{for(var c=0,l=[],u=s.length;c<u;c++)(s[c].fn!==t||i&&!s[c].once||n&&s[c].context!==n)&&l.push(s[c]);l.length?this._events[a]=1===l.length?l[0]:l:0===--this._eventsCount?this._events=new o:delete this._events[a]}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&(0===--this._eventsCount?this._events=new o:delete this._events[t])):(this._events=new o,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prototype.setMaxListeners=function(){return this},a.prefixed=r,a.EventEmitter=a,"undefined"!==typeof e&&(e.exports=a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.matchText=t.matchSpacing=t.matchNewline=t.matchBlot=t.matchAttributor=t.default=void 0;var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=y(n(3)),s=y(n(2)),c=y(n(0)),l=y(n(5)),u=y(n(10)),d=y(n(9)),p=n(36),h=n(37),f=y(n(13)),m=n(26),v=n(38),g=n(39),E=n(40);function y(e){return e&&e.__esModule?e:{default:e}}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=(0,u.default)("quill:clipboard"),T="__ql-matcher",S=[[Node.TEXT_NODE,U],[Node.TEXT_NODE,L],["br",function(e,t){return A(t,"\n")||t.insert("\n"),t}],[Node.ELEMENT_NODE,L],[Node.ELEMENT_NODE,M],[Node.ELEMENT_NODE,x],[Node.ELEMENT_NODE,D],[Node.ELEMENT_NODE,function(e,t){var n={},r=e.style||{};return r.fontStyle&&"italic"===I(e).fontStyle&&(n.italic=!0),r.fontWeight&&(I(e).fontWeight.startsWith("bold")||parseInt(I(e).fontWeight)>=700)&&(n.bold=!0),Object.keys(n).length>0&&(t=w(t,n)),parseFloat(r.textIndent||0)>0&&(t=(new s.default).insert("\t").concat(t)),t}],["li",function(e,t){var n=c.default.query(e);if(null==n||"list-item"!==n.blotName||!A(t,"\n"))return t;for(var r=-1,o=e.parentNode;!o.classList.contains("ql-clipboard");)"list"===(c.default.query(o)||{}).blotName&&(r+=1),o=o.parentNode;return r<=0?t:t.compose((new s.default).retain(t.length()-1).retain(1,{indent:r}))}],["b",P.bind(P,"bold")],["i",P.bind(P,"italic")],["style",function(){return new s.default}]],O=[p.AlignAttribute,v.DirectionAttribute].reduce((function(e,t){return e[t.keyName]=t,e}),{}),R=[p.AlignStyle,h.BackgroundStyle,m.ColorStyle,v.DirectionStyle,g.FontStyle,E.SizeStyle].reduce((function(e,t){return e[t.keyName]=t,e}),{}),C=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.quill.root.addEventListener("paste",r.onPaste.bind(r)),r.container=r.quill.addContainer("ql-clipboard"),r.container.setAttribute("contenteditable",!0),r.container.setAttribute("tabindex",-1),r.matchers=[],S.concat(r.options.matchers).forEach((function(e){var t=o(e,2),i=t[0],a=t[1];(n.matchVisual||a!==x)&&r.addMatcher(i,a)})),r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"addMatcher",value:function(e,t){this.matchers.push([e,t])}},{key:"convert",value:function(e){if("string"===typeof e)return this.container.innerHTML=e.replace(/\>\r?\n +\</g,"><"),this.convert();var t=this.quill.getFormat(this.quill.selection.savedRange.index);if(t[f.default.blotName]){var n=this.container.innerText;return this.container.innerHTML="",(new s.default).insert(n,_({},f.default.blotName,t[f.default.blotName]))}var r=this.prepareMatching(),i=o(r,2),a=i[0],c=i[1],l=k(this.container,a,c);return A(l,"\n")&&null==l.ops[l.ops.length-1].attributes&&(l=l.compose((new s.default).retain(l.length()-1).delete(1))),b.log("convert",this.container.innerHTML,l),this.container.innerHTML="",l}},{key:"dangerouslyPasteHTML",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.default.sources.API;if("string"===typeof e)this.quill.setContents(this.convert(e),t),this.quill.setSelection(0,l.default.sources.SILENT);else{var r=this.convert(t);this.quill.updateContents((new s.default).retain(e).concat(r),n),this.quill.setSelection(e+r.length(),l.default.sources.SILENT)}}},{key:"onPaste",value:function(e){var t=this;if(!e.defaultPrevented&&this.quill.isEnabled()){var n=this.quill.getSelection(),r=(new s.default).retain(n.index),o=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(l.default.sources.SILENT),setTimeout((function(){r=r.concat(t.convert()).delete(n.length),t.quill.updateContents(r,l.default.sources.USER),t.quill.setSelection(r.length()-n.length,l.default.sources.SILENT),t.quill.scrollingContainer.scrollTop=o,t.quill.focus()}),1)}}},{key:"prepareMatching",value:function(){var e=this,t=[],n=[];return this.matchers.forEach((function(r){var i=o(r,2),a=i[0],s=i[1];switch(a){case Node.TEXT_NODE:n.push(s);break;case Node.ELEMENT_NODE:t.push(s);break;default:[].forEach.call(e.container.querySelectorAll(a),(function(e){e[T]=e[T]||[],e[T].push(s)}))}})),[t,n]}}]),t}(d.default);function w(e,t,n){return"object"===("undefined"===typeof t?"undefined":r(t))?Object.keys(t).reduce((function(e,n){return w(e,n,t[n])}),e):e.reduce((function(e,r){return r.attributes&&r.attributes[t]?e.push(r):e.insert(r.insert,(0,a.default)({},_({},t,n),r.attributes))}),new s.default)}function I(e){if(e.nodeType!==Node.ELEMENT_NODE)return{};var t="__ql-computed-style";return e[t]||(e[t]=window.getComputedStyle(e))}function A(e,t){for(var n="",r=e.ops.length-1;r>=0&&n.length<t.length;--r){var o=e.ops[r];if("string"!==typeof o.insert)break;n=o.insert+n}return n.slice(-1*t.length)===t}function N(e){if(0===e.childNodes.length)return!1;var t=I(e);return["block","list-item"].indexOf(t.display)>-1}function k(e,t,n){return e.nodeType===e.TEXT_NODE?n.reduce((function(t,n){return n(e,t)}),new s.default):e.nodeType===e.ELEMENT_NODE?[].reduce.call(e.childNodes||[],(function(r,o){var i=k(o,t,n);return o.nodeType===e.ELEMENT_NODE&&(i=t.reduce((function(e,t){return t(o,e)}),i),i=(o[T]||[]).reduce((function(e,t){return t(o,e)}),i)),r.concat(i)}),new s.default):new s.default}function P(e,t,n){return w(n,e,!0)}function D(e,t){var n=c.default.Attributor.Attribute.keys(e),r=c.default.Attributor.Class.keys(e),o=c.default.Attributor.Style.keys(e),i={};return n.concat(r).concat(o).forEach((function(t){var n=c.default.query(t,c.default.Scope.ATTRIBUTE);null!=n&&(i[n.attrName]=n.value(e),i[n.attrName])||(null==(n=O[t])||n.attrName!==t&&n.keyName!==t||(i[n.attrName]=n.value(e)||void 0),null==(n=R[t])||n.attrName!==t&&n.keyName!==t||(n=R[t],i[n.attrName]=n.value(e)||void 0))})),Object.keys(i).length>0&&(t=w(t,i)),t}function M(e,t){var n=c.default.query(e);if(null==n)return t;if(n.prototype instanceof c.default.Embed){var r={},o=n.value(e);null!=o&&(r[n.blotName]=o,t=(new s.default).insert(r,n.formats(e)))}else"function"===typeof n.formats&&(t=w(t,n.blotName,n.formats(e)));return t}function L(e,t){return A(t,"\n")||(N(e)||t.length()>0&&e.nextSibling&&N(e.nextSibling))&&t.insert("\n"),t}function x(e,t){if(N(e)&&null!=e.nextElementSibling&&!A(t,"\n\n")){var n=e.offsetHeight+parseFloat(I(e).marginTop)+parseFloat(I(e).marginBottom);e.nextElementSibling.offsetTop>e.offsetTop+1.5*n&&t.insert("\n")}return t}function U(e,t){var n=e.data;if("O:P"===e.parentNode.tagName)return t.insert(n.trim());if(0===n.trim().length&&e.parentNode.classList.contains("ql-clipboard"))return t;if(!I(e.parentNode).whiteSpace.startsWith("pre")){var r=function(e,t){return(t=t.replace(/[^\u00a0]/g,"")).length<1&&e?" ":t};n=(n=n.replace(/\r\n/g," ").replace(/\n/g," ")).replace(/\s\s+/g,r.bind(r,!0)),(null==e.previousSibling&&N(e.parentNode)||null!=e.previousSibling&&N(e.previousSibling))&&(n=n.replace(/^\s+/,r.bind(r,!1))),(null==e.nextSibling&&N(e.parentNode)||null!=e.nextSibling&&N(e.nextSibling))&&(n=n.replace(/\s+$/,r.bind(r,!1)))}return t.insert(n)}C.DEFAULTS={matchers:[],matchVisual:!0},t.default=C,t.matchAttributor=D,t.matchBlot=M,t.matchNewline=L,t.matchSpacing=x,t.matchText=U},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(6),s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"optimize",value:function(e){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"optimize",this).call(this,e),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return i(t.__proto__||Object.getPrototypeOf(t),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),t}(((r=a)&&r.__esModule?r:{default:r}).default);s.blotName="bold",s.tagName=["STRONG","B"],t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addControls=t.default=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(2)),a=u(n(0)),s=u(n(5)),c=u(n(10)),l=u(n(9));function u(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var p=(0,c.default)("quill:toolbar"),h=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o,i=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));if(Array.isArray(i.options.container)){var a=document.createElement("div");m(a,i.options.container),e.container.parentNode.insertBefore(a,e.container),i.container=a}else"string"===typeof i.options.container?i.container=document.querySelector(i.options.container):i.container=i.options.container;return i.container instanceof HTMLElement?(i.container.classList.add("ql-toolbar"),i.controls=[],i.handlers={},Object.keys(i.options.handlers).forEach((function(e){i.addHandler(e,i.options.handlers[e])})),[].forEach.call(i.container.querySelectorAll("button, select"),(function(e){i.attach(e)})),i.quill.on(s.default.events.EDITOR_CHANGE,(function(e,t){e===s.default.events.SELECTION_CHANGE&&i.update(t)})),i.quill.on(s.default.events.SCROLL_OPTIMIZE,(function(){var e=i.quill.selection.getRange(),t=r(e,1)[0];i.update(t)})),i):(o=p.error("Container required for toolbar",i.options),d(i,o))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"addHandler",value:function(e,t){this.handlers[e]=t}},{key:"attach",value:function(e){var t=this,n=[].find.call(e.classList,(function(e){return 0===e.indexOf("ql-")}));if(n){if(n=n.slice(3),"BUTTON"===e.tagName&&e.setAttribute("type","button"),null==this.handlers[n]){if(null!=this.quill.scroll.whitelist&&null==this.quill.scroll.whitelist[n])return void p.warn("ignoring attaching to disabled format",n,e);if(null==a.default.query(n))return void p.warn("ignoring attaching to nonexistent format",n,e)}var o="SELECT"===e.tagName?"change":"click";e.addEventListener(o,(function(o){var c=void 0;if("SELECT"===e.tagName){if(e.selectedIndex<0)return;var l=e.options[e.selectedIndex];c=!l.hasAttribute("selected")&&(l.value||!1)}else c=!e.classList.contains("ql-active")&&(e.value||!e.hasAttribute("value")),o.preventDefault();t.quill.focus();var u=t.quill.selection.getRange(),d=r(u,1)[0];if(null!=t.handlers[n])t.handlers[n].call(t,c);else if(a.default.query(n).prototype instanceof a.default.Embed){if(!(c=prompt("Enter "+n)))return;t.quill.updateContents((new i.default).retain(d.index).delete(d.length).insert(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},n,c)),s.default.sources.USER)}else t.quill.format(n,c,s.default.sources.USER);t.update(d)})),this.controls.push([n,e])}}},{key:"update",value:function(e){var t=null==e?{}:this.quill.getFormat(e);this.controls.forEach((function(n){var o=r(n,2),i=o[0],a=o[1];if("SELECT"===a.tagName){var s=void 0;if(null==e)s=null;else if(null==t[i])s=a.querySelector("option[selected]");else if(!Array.isArray(t[i])){var c=t[i];"string"===typeof c&&(c=c.replace(/\"/g,'\\"')),s=a.querySelector('option[value="'+c+'"]')}null==s?(a.value="",a.selectedIndex=-1):s.selected=!0}else if(null==e)a.classList.remove("ql-active");else if(a.hasAttribute("value")){var l=t[i]===a.getAttribute("value")||null!=t[i]&&t[i].toString()===a.getAttribute("value")||null==t[i]&&!a.getAttribute("value");a.classList.toggle("ql-active",l)}else a.classList.toggle("ql-active",null!=t[i])}))}}]),t}(l.default);function f(e,t,n){var r=document.createElement("button");r.setAttribute("type","button"),r.classList.add("ql-"+t),null!=n&&(r.value=n),e.appendChild(r)}function m(e,t){Array.isArray(t[0])||(t=[t]),t.forEach((function(t){var n=document.createElement("span");n.classList.add("ql-formats"),t.forEach((function(e){if("string"===typeof e)f(n,e);else{var t=Object.keys(e)[0],r=e[t];Array.isArray(r)?function(e,t,n){var r=document.createElement("select");r.classList.add("ql-"+t),n.forEach((function(e){var t=document.createElement("option");!1!==e?t.setAttribute("value",e):t.setAttribute("selected","selected"),r.appendChild(t)})),e.appendChild(r)}(n,t,r):f(n,t,r)}})),e.appendChild(n)}))}h.DEFAULTS={},h.DEFAULTS={container:null,handlers:{clean:function(){var e=this,t=this.quill.getSelection();if(null!=t)if(0==t.length){var n=this.quill.getFormat();Object.keys(n).forEach((function(t){null!=a.default.query(t,a.default.Scope.INLINE)&&e.quill.format(t,!1)}))}else this.quill.removeFormat(t,s.default.sources.USER)},direction:function(e){var t=this.quill.getFormat().align;"rtl"===e&&null==t?this.quill.format("align","right",s.default.sources.USER):e||"right"!==t||this.quill.format("align",!1,s.default.sources.USER),this.quill.format("direction",e,s.default.sources.USER)},indent:function(e){var t=this.quill.getSelection(),n=this.quill.getFormat(t),r=parseInt(n.indent||0);if("+1"===e||"-1"===e){var o="+1"===e?1:-1;"rtl"===n.direction&&(o*=-1),this.quill.format("indent",r+o,s.default.sources.USER)}},link:function(e){!0===e&&(e=prompt("Enter link URL:")),this.quill.format("link",e,s.default.sources.USER)},list:function(e){var t=this.quill.getSelection(),n=this.quill.getFormat(t);"check"===e?"checked"===n.list||"unchecked"===n.list?this.quill.format("list",!1,s.default.sources.USER):this.quill.format("list","unchecked",s.default.sources.USER):this.quill.format("list",e,s.default.sources.USER)}}},t.default=h,t.addControls=m},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(28),s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.label.innerHTML=n,r.container.classList.add("ql-color-picker"),[].slice.call(r.container.querySelectorAll(".ql-picker-item"),0,7).forEach((function(e){e.classList.add("ql-primary")})),r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"buildItem",value:function(e){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"buildItem",this).call(this,e);return n.style.backgroundColor=e.getAttribute("value")||"",n}},{key:"selectItem",value:function(e,n){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"selectItem",this).call(this,e,n);var r=this.label.querySelector(".ql-color-label"),o=e&&e.getAttribute("data-value")||"";r&&("line"===r.tagName?r.style.stroke=o:r.style.fill=o)}}]),t}(((r=a)&&r.__esModule?r:{default:r}).default);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(28),s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.container.classList.add("ql-icon-picker"),[].forEach.call(r.container.querySelectorAll(".ql-picker-item"),(function(e){e.innerHTML=n[e.getAttribute("data-value")||""]})),r.defaultItem=r.container.querySelector(".ql-selected"),r.selectItem(r.defaultItem),r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"selectItem",value:function(e,n){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"selectItem",this).call(this,e,n),e=e||this.defaultItem,this.label.innerHTML=e.innerHTML}}]),t}(((r=a)&&r.__esModule?r:{default:r}).default);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.quill=t,this.boundsContainer=n||document.body,this.root=t.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",(function(){r.root.style.marginTop=-1*r.quill.root.scrollTop+"px"})),this.hide()}return r(e,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(e){var t=e.left+e.width/2-this.root.offsetWidth/2,n=e.bottom+this.quill.root.scrollTop;this.root.style.left=t+"px",this.root.style.top=n+"px",this.root.classList.remove("ql-flip");var r=this.boundsContainer.getBoundingClientRect(),o=this.root.getBoundingClientRect(),i=0;if(o.right>r.right&&(i=r.right-o.right,this.root.style.left=t+i+"px"),o.left<r.left&&(i=r.left-o.left,this.root.style.left=t+i+"px"),o.bottom>r.bottom){var a=o.bottom-o.top,s=e.bottom-e.top+a;this.root.style.top=n-s+"px",this.root.classList.add("ql-flip")}return i}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=h(n(3)),s=h(n(8)),c=n(43),l=h(c),u=h(n(27)),d=n(15),p=h(n(41));function h(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function v(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],E=function(e){function t(e,n){f(this,t),null!=n.modules.toolbar&&null==n.modules.toolbar.container&&(n.modules.toolbar.container=g);var r=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.quill.container.classList.add("ql-snow"),r}return v(t,e),i(t,[{key:"extendToolbar",value:function(e){e.container.classList.add("ql-snow"),this.buildButtons([].slice.call(e.container.querySelectorAll("button")),p.default),this.buildPickers([].slice.call(e.container.querySelectorAll("select")),p.default),this.tooltip=new y(this.quill,this.options.bounds),e.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},(function(t,n){e.handlers.link.call(e,!n.format.link)}))}}]),t}(l.default);E.DEFAULTS=(0,a.default)(!0,{},l.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(e){if(e){var t=this.quill.getSelection();if(null==t||0==t.length)return;var n=this.quill.getText(t);/^\S+@\S+\.\S+$/.test(n)&&0!==n.indexOf("mailto:")&&(n="mailto:"+n),this.quill.theme.tooltip.edit("link",n)}else this.quill.format("link",!1)}}}}});var y=function(e){function t(e,n){f(this,t);var r=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.preview=r.root.querySelector("a.ql-preview"),r}return v(t,e),i(t,[{key:"listen",value:function(){var e=this;o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",(function(t){e.root.classList.contains("ql-editing")?e.save():e.edit("link",e.preview.textContent),t.preventDefault()})),this.root.querySelector("a.ql-remove").addEventListener("click",(function(t){if(null!=e.linkRange){var n=e.linkRange;e.restoreFocus(),e.quill.formatText(n,"link",!1,s.default.sources.USER),delete e.linkRange}t.preventDefault(),e.hide()})),this.quill.on(s.default.events.SELECTION_CHANGE,(function(t,n,o){if(null!=t){if(0===t.length&&o===s.default.sources.USER){var i=e.quill.scroll.descendant(u.default,t.index),a=r(i,2),c=a[0],l=a[1];if(null!=c){e.linkRange=new d.Range(t.index-l,c.length());var p=u.default.formats(c.domNode);return e.preview.textContent=p,e.preview.setAttribute("href",p),e.show(),void e.position(e.quill.getBounds(e.linkRange))}}else delete e.linkRange;e.hide()}}))}},{key:"show",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),t}(c.BaseTooltip);y.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),t.default=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=L(n(29)),o=n(36),i=n(38),a=n(64),s=L(n(65)),c=L(n(66)),l=n(67),u=L(l),d=n(37),p=n(26),h=n(39),f=n(40),m=L(n(56)),v=L(n(68)),g=L(n(27)),E=L(n(69)),y=L(n(70)),_=L(n(71)),b=L(n(72)),T=L(n(73)),S=n(13),O=L(S),R=L(n(74)),C=L(n(75)),w=L(n(57)),I=L(n(41)),A=L(n(28)),N=L(n(59)),k=L(n(60)),P=L(n(61)),D=L(n(108)),M=L(n(62));function L(e){return e&&e.__esModule?e:{default:e}}r.default.register({"attributors/attribute/direction":i.DirectionAttribute,"attributors/class/align":o.AlignClass,"attributors/class/background":d.BackgroundClass,"attributors/class/color":p.ColorClass,"attributors/class/direction":i.DirectionClass,"attributors/class/font":h.FontClass,"attributors/class/size":f.SizeClass,"attributors/style/align":o.AlignStyle,"attributors/style/background":d.BackgroundStyle,"attributors/style/color":p.ColorStyle,"attributors/style/direction":i.DirectionStyle,"attributors/style/font":h.FontStyle,"attributors/style/size":f.SizeStyle},!0),r.default.register({"formats/align":o.AlignClass,"formats/direction":i.DirectionClass,"formats/indent":a.IndentClass,"formats/background":d.BackgroundStyle,"formats/color":p.ColorStyle,"formats/font":h.FontClass,"formats/size":f.SizeClass,"formats/blockquote":s.default,"formats/code-block":O.default,"formats/header":c.default,"formats/list":u.default,"formats/bold":m.default,"formats/code":S.Code,"formats/italic":v.default,"formats/link":g.default,"formats/script":E.default,"formats/strike":y.default,"formats/underline":_.default,"formats/image":b.default,"formats/video":T.default,"formats/list/item":l.ListItem,"modules/formula":R.default,"modules/syntax":C.default,"modules/toolbar":w.default,"themes/bubble":D.default,"themes/snow":M.default,"ui/icons":I.default,"ui/picker":A.default,"ui/icon-picker":k.default,"ui/color-picker":N.default,"ui/tooltip":P.default},!0),t.default=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IndentClass=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(0),s=(r=a)&&r.__esModule?r:{default:r},c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"add",value:function(e,n){if("+1"===n||"-1"===n){var r=this.value(e)||0;n="+1"===n?r+1:r-1}return 0===n?(this.remove(e),!0):i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",this).call(this,e,n)}},{key:"canAdd",value:function(e,n){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"canAdd",this).call(this,e,n)||i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"canAdd",this).call(this,e,parseInt(n))}},{key:"value",value:function(e){return parseInt(i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"value",this).call(this,e))||void 0}}]),t}(s.default.Attributor.Class),l=new c("indent","ql-indent",{scope:s.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});t.IndentClass=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(4),i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=o)&&r.__esModule?r:{default:r}).default);i.blotName="blockquote",i.tagName="blockquote",t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(4),a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,null,[{key:"formats",value:function(e){return this.tagName.indexOf(e.tagName)+1}}]),t}(((r=i)&&r.__esModule?r:{default:r}).default);a.blotName="header",a.tagName=["H1","H2","H3","H4","H5","H6"],t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ListItem=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=c(n(0)),a=c(n(4)),s=c(n(25));function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(e){function t(){return l(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d(t,e),r(t,[{key:"format",value:function(e,n){e!==h.blotName||n?o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"format",this).call(this,e,n):this.replaceWith(i.default.create(this.statics.scope))}},{key:"remove",value:function(){null==this.prev&&null==this.next?this.parent.remove():o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(e,n){return this.parent.isolate(this.offset(this.parent),this.length()),e===this.parent.statics.blotName?(this.parent.replaceWith(e,n),this):(this.parent.unwrap(),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"replaceWith",this).call(this,e,n))}}],[{key:"formats",value:function(e){return e.tagName===this.tagName?void 0:o(t.__proto__||Object.getPrototypeOf(t),"formats",this).call(this,e)}}]),t}(a.default);p.blotName="list-item",p.tagName="LI";var h=function(e){function t(e){l(this,t);var n=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=function(t){if(t.target.parentNode===e){var r=n.statics.formats(e),o=i.default.find(t.target);"checked"===r?o.format("list","unchecked"):"unchecked"===r&&o.format("list","checked")}};return e.addEventListener("touchstart",r),e.addEventListener("mousedown",r),n}return d(t,e),r(t,null,[{key:"create",value:function(e){var n="ordered"===e?"OL":"UL",r=o(t.__proto__||Object.getPrototypeOf(t),"create",this).call(this,n);return"checked"!==e&&"unchecked"!==e||r.setAttribute("data-checked","checked"===e),r}},{key:"formats",value:function(e){return"OL"===e.tagName?"ordered":"UL"===e.tagName?e.hasAttribute("data-checked")?"true"===e.getAttribute("data-checked")?"checked":"unchecked":"bullet":void 0}}]),r(t,[{key:"format",value:function(e,t){this.children.length>0&&this.children.tail.format(e,t)}},{key:"formats",value:function(){return e={},t=this.statics.blotName,n=this.statics.formats(this.domNode),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;var e,t,n}},{key:"insertBefore",value:function(e,n){if(e instanceof p)o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"insertBefore",this).call(this,e,n);else{var r=null==n?this.length():n.offset(this),i=this.split(r);i.parent.insertBefore(e,i)}}},{key:"optimize",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"optimize",this).call(this,e);var n=this.next;null!=n&&n.prev===this&&n.statics.blotName===this.statics.blotName&&n.domNode.tagName===this.domNode.tagName&&n.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(n.moveChildren(this),n.remove())}},{key:"replace",value:function(e){if(e.statics.blotName!==this.statics.blotName){var n=i.default.create(this.statics.defaultChild);e.moveChildren(n),this.appendChild(n)}o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"replace",this).call(this,e)}}]),t}(s.default);h.blotName="list",h.scope=i.default.Scope.BLOCK_BLOT,h.tagName=["OL","UL"],h.defaultChild="list-item",h.allowedChildren=[p],t.ListItem=p,t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(56),i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=o)&&r.__esModule?r:{default:r}).default);i.blotName="italic",i.tagName=["EM","I"],t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(6),s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,null,[{key:"create",value:function(e){return"super"===e?document.createElement("sup"):"sub"===e?document.createElement("sub"):i(t.__proto__||Object.getPrototypeOf(t),"create",this).call(this,e)}},{key:"formats",value:function(e){return"SUB"===e.tagName?"sub":"SUP"===e.tagName?"super":void 0}}]),t}(((r=a)&&r.__esModule?r:{default:r}).default);s.blotName="script",s.tagName=["SUB","SUP"],t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(6),i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=o)&&r.__esModule?r:{default:r}).default);i.blotName="strike",i.tagName="S",t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(6),i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=o)&&r.__esModule?r:{default:r}).default);i.blotName="underline",i.tagName="U",t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(0),s=(r=a)&&r.__esModule?r:{default:r},c=n(27),l=["alt","height","width"],u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"format",value:function(e,n){l.indexOf(e)>-1?n?this.domNode.setAttribute(e,n):this.domNode.removeAttribute(e):i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"format",this).call(this,e,n)}}],[{key:"create",value:function(e){var n=i(t.__proto__||Object.getPrototypeOf(t),"create",this).call(this,e);return"string"===typeof e&&n.setAttribute("src",this.sanitize(e)),n}},{key:"formats",value:function(e){return l.reduce((function(t,n){return e.hasAttribute(n)&&(t[n]=e.getAttribute(n)),t}),{})}},{key:"match",value:function(e){return/\.(jpe?g|gif|png)$/.test(e)||/^data:image\/.+;base64/.test(e)}},{key:"sanitize",value:function(e){return(0,c.sanitize)(e,["http","https","data"])?e:"//:0"}},{key:"value",value:function(e){return e.getAttribute("src")}}]),t}(s.default.Embed);u.blotName="image",u.tagName="IMG",t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(4),s=n(27),c=(r=s)&&r.__esModule?r:{default:r},l=["height","width"],u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"format",value:function(e,n){l.indexOf(e)>-1?n?this.domNode.setAttribute(e,n):this.domNode.removeAttribute(e):i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"format",this).call(this,e,n)}}],[{key:"create",value:function(e){var n=i(t.__proto__||Object.getPrototypeOf(t),"create",this).call(this,e);return n.setAttribute("frameborder","0"),n.setAttribute("allowfullscreen",!0),n.setAttribute("src",this.sanitize(e)),n}},{key:"formats",value:function(e){return l.reduce((function(t,n){return e.hasAttribute(n)&&(t[n]=e.getAttribute(n)),t}),{})}},{key:"sanitize",value:function(e){return c.default.sanitize(e)}},{key:"value",value:function(e){return e.getAttribute("src")}}]),t}(a.BlockEmbed);u.blotName="video",u.className="ql-video",u.tagName="IFRAME",t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.FormulaBlot=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=c(n(35)),a=c(n(5)),s=c(n(9));function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(e){function t(){return l(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d(t,e),r(t,null,[{key:"create",value:function(e){var n=o(t.__proto__||Object.getPrototypeOf(t),"create",this).call(this,e);return"string"===typeof e&&(window.katex.render(e,n,{throwOnError:!1,errorColor:"#f00"}),n.setAttribute("data-value",e)),n}},{key:"value",value:function(e){return e.getAttribute("data-value")}}]),t}(i.default);p.blotName="formula",p.className="ql-formula",p.tagName="SPAN";var h=function(e){function t(){l(this,t);var e=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(null==window.katex)throw new Error("Formula module requires KaTeX.");return e}return d(t,e),r(t,null,[{key:"register",value:function(){a.default.register(p,!0)}}]),t}(s.default);t.FormulaBlot=p,t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CodeToken=t.CodeBlock=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=c(n(0)),a=c(n(5)),s=c(n(9));function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(e){function t(){return l(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d(t,e),r(t,[{key:"replaceWith",value:function(e){this.domNode.textContent=this.domNode.textContent,this.attach(),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"replaceWith",this).call(this,e)}},{key:"highlight",value:function(e){var t=this.domNode.textContent;this.cachedText!==t&&((t.trim().length>0||null==this.cachedText)&&(this.domNode.innerHTML=e(t),this.domNode.normalize(),this.attach()),this.cachedText=t)}}]),t}(c(n(13)).default);p.className="ql-syntax";var h=new i.default.Attributor.Class("token","hljs",{scope:i.default.Scope.INLINE}),f=function(e){function t(e,n){l(this,t);var r=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));if("function"!==typeof r.options.highlight)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var o=null;return r.quill.on(a.default.events.SCROLL_OPTIMIZE,(function(){clearTimeout(o),o=setTimeout((function(){r.highlight(),o=null}),r.options.interval)})),r.highlight(),r}return d(t,e),r(t,null,[{key:"register",value:function(){a.default.register(h,!0),a.default.register(p,!0)}}]),r(t,[{key:"highlight",value:function(){var e=this;if(!this.quill.selection.composing){this.quill.update(a.default.sources.USER);var t=this.quill.getSelection();this.quill.scroll.descendants(p).forEach((function(t){t.highlight(e.options.highlight)})),this.quill.update(a.default.sources.SILENT),null!=t&&this.quill.setSelection(t,a.default.sources.SILENT)}}}]),t}(s.default);f.DEFAULTS={highlight:null==window.hljs?null:function(e){return window.hljs.highlightAuto(e).value},interval:1e3},t.CodeBlock=p,t.CodeToken=h,t.default=f},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(e,t){e.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(e,t){e.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(e,t){e.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(e,t){e.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(e,t){e.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BubbleTooltip=void 0;var r=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=d(n(3)),a=d(n(8)),s=n(43),c=d(s),l=n(15),u=d(n(41));function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function f(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var m=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],v=function(e){function t(e,n){p(this,t),null!=n.modules.toolbar&&null==n.modules.toolbar.container&&(n.modules.toolbar.container=m);var r=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.quill.container.classList.add("ql-bubble"),r}return f(t,e),o(t,[{key:"extendToolbar",value:function(e){this.tooltip=new g(this.quill,this.options.bounds),this.tooltip.root.appendChild(e.container),this.buildButtons([].slice.call(e.container.querySelectorAll("button")),u.default),this.buildPickers([].slice.call(e.container.querySelectorAll("select")),u.default)}}]),t}(c.default);v.DEFAULTS=(0,i.default)(!0,{},c.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(e){e?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var g=function(e){function t(e,n){p(this,t);var r=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.quill.on(a.default.events.EDITOR_CHANGE,(function(e,t,n,o){if(e===a.default.events.SELECTION_CHANGE)if(null!=t&&t.length>0&&o===a.default.sources.USER){r.show(),r.root.style.left="0px",r.root.style.width="",r.root.style.width=r.root.offsetWidth+"px";var i=r.quill.getLines(t.index,t.length);if(1===i.length)r.position(r.quill.getBounds(t));else{var s=i[i.length-1],c=r.quill.getIndex(s),u=Math.min(s.length()-1,t.index+t.length-c),d=r.quill.getBounds(new l.Range(c,u));r.position(d)}}else document.activeElement!==r.textbox&&r.quill.hasFocus()&&r.hide()})),r}return f(t,e),o(t,[{key:"listen",value:function(){var e=this;r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",(function(){e.root.classList.remove("ql-editing")})),this.quill.on(a.default.events.SCROLL_OPTIMIZE,(function(){setTimeout((function(){if(!e.root.classList.contains("ql-hidden")){var t=e.quill.getSelection();null!=t&&e.position(e.quill.getBounds(t))}}),1)}))}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(e){var n=r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"position",this).call(this,e),o=this.root.querySelector(".ql-tooltip-arrow");if(o.style.marginLeft="",0===n)return n;o.style.marginLeft=-1*n-o.offsetWidth/2+"px"}}]),t}(s.BaseTooltip);g.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),t.BubbleTooltip=g,t.default=v},function(e,t,n){e.exports=n(63)}]).default},e.exports=n()}).call(this,n(400).Buffer)},function(e,t,n){"use strict";(function(e){var r=n(576),o=n(577),i=n(578);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!c.TYPED_ARRAY_SUPPORT&&!(this instanceof c))return new c(e,t,n);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=p(e,t);return e}(e,t,n,r):"string"===typeof t?function(e,t,n){"string"===typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(t,n);e=s(e,r);var o=e.write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|h(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||(r=t.length)!==r?s(e,0):p(e,t);if("Buffer"===t.type&&i(t.data))return p(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(u(t),e=s(e,t<0?0:0|h(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t){var n=t.length<0?0:0|h(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function h(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function f(e,t){if(c.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(r)return V(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,n);case"utf8":case"utf-8":return C(this,t,n);case"ascii":return I(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return R(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,o){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"===typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:E(e,t,n,r,o);if("number"===typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):E(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function E(e,t,n,r,o){var i,a=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,n/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var u=-1;for(i=n;i<s;i++)if(l(e,i)===l(t,-1===u?0:i-u)){if(-1===u&&(u=i),i-u+1===c)return u*a}else-1!==u&&(i-=i-u),u=-1}else for(n+c>s&&(n=s-c),i=n;i>=0;i--){for(var d=!0,p=0;p<c;p++)if(l(e,i+p)!==l(t,p)){d=!1;break}if(d)return i}return-1}function y(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!==0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function _(e,t,n,r){return G(V(t,e.length-n),e,n,r)}function b(e,t,n,r){return G(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function T(e,t,n,r){return b(e,t,n,r)}function S(e,t,n,r){return G(H(t),e,n,r)}function O(e,t,n,r){return G(function(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function R(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,s,c,l=e[o],u=null,d=l>239?4:l>223?3:l>191?2:1;if(o+d<=n)switch(d){case 1:l<128&&(u=l);break;case 2:128===(192&(i=e[o+1]))&&(c=(31&l)<<6|63&i)>127&&(u=c);break;case 3:i=e[o+1],a=e[o+2],128===(192&i)&&128===(192&a)&&(c=(15&l)<<12|(63&i)<<6|63&a)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128===(192&i)&&128===(192&a)&&128===(192&s)&&(c=(15&l)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(u=c)}null===u?(u=65533,d=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),o+=d}return function(e){var t=e.length;if(t<=w)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=w));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),t.kMaxLength=a(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return l(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return u(t),t<=0?s(e,t):void 0!==n?"string"===typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return d(null,e)},c.allocUnsafeSlow=function(e){return d(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},c.byteLength=f,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,o){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(i,a),l=this.slice(r,o),u=e.slice(t,n),d=0;d<s;++d)if(l[d]!==u[d]){i=l[d],a=u[d];break}return i<a?-1:a<i?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return b(this,e,t,n);case"latin1":case"binary":return T(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var w=4096;function I(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function N(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=B(e[i]);return o}function k(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function P(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,r,o,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function M(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function L(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function x(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function U(e,t,n,r,i){return i||x(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function j(e,t,n,r,i){return i||x(e,0,n,8),o.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var o=t-e;n=new c(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},c.prototype.readUInt8=function(e,t){return t||P(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||P(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||P(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||P(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||P(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||P(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||P(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||P(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||P(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);D(this,e,t,n,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a|0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);D(this,e,t,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a|0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return U(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return U(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return j(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return j(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},c.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=c.isBuffer(e)?e:V(new c(e,r).toString()),s=a.length;for(i=0;i<n-t;++i)this[i+t]=a[i%s]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function V(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function H(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function G(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(36))},function(e,t,n){"use strict";var r=n(2),o=n(580);if("undefined"===typeof r)throw Error("create-react-class could not find the React object. If you are using script tags, make sure that React is being loaded before create-react-class.");var i=(new r.Component).updater;e.exports=o(r.Component,r.isValidElement,i)},function(e,t,n){"use strict";var r=n(399),o={createEditor:function(e,t){var n=new r(e,t);return void 0!==t.tabIndex&&this.setEditorTabIndex(n,t.tabIndex),this.hookEditor(n),n},hookEditor:function(e){var t=this.makeUnprivilegedEditor(e);this.handleTextChange=function(n,r,o){this.onEditorChangeText&&(this.onEditorChangeText(e.root.innerHTML,n,o,t),this.onEditorChangeSelection(e.getSelection(),o,t))}.bind(this),this.handleSelectionChange=function(e,n,r){this.onEditorChangeSelection&&this.onEditorChangeSelection(e,r,t)}.bind(this),e.on("editor-change",function(e,t,n,o){e===r.events.SELECTION_CHANGE&&this.handleSelectionChange(t,n,o),e===r.events.TEXT_CHANGE&&this.handleTextChange(t,n,o)}.bind(this))},unhookEditor:function(e){e.off("selection-change"),e.off("text-change")},setEditorReadOnly:function(e,t){t?e.disable():e.enable()},setEditorContents:function(e,t){var n=e.getSelection();"string"===typeof t?e.setContents(e.clipboard.convert(t)):e.setContents(t),n&&e.hasFocus()&&this.setEditorSelection(e,n)},setEditorSelection:function(e,t){if(t){var n=e.getLength();t.index=Math.max(0,Math.min(t.index,n-1)),t.length=Math.max(0,Math.min(t.length,n-1-t.index))}e.setSelection(t)},setEditorTabIndex:function(e,t){e.editor&&e.editor.scroll&&e.editor.scroll.domNode&&(e.editor.scroll.domNode.tabIndex=t)},makeUnprivilegedEditor:function(e){var t=e;return{getLength:function(){return t.getLength.apply(t,arguments)},getText:function(){return t.getText.apply(t,arguments)},getHTML:function(){return t.root.innerHTML},getContents:function(){return t.getContents.apply(t,arguments)},getSelection:function(){return t.getSelection.apply(t,arguments)},getBounds:function(){return t.getBounds.apply(t,arguments)}}}};e.exports=o},,,,,,,,,,,,,,,function(e,t,n){"use strict";e.exports=function(e){function t(t){var n=e.createElement.bind(null,t);return n.type=t,n}return{a:t("a"),abbr:t("abbr"),address:t("address"),area:t("area"),article:t("article"),aside:t("aside"),audio:t("audio"),b:t("b"),base:t("base"),bdi:t("bdi"),bdo:t("bdo"),big:t("big"),blockquote:t("blockquote"),body:t("body"),br:t("br"),button:t("button"),canvas:t("canvas"),caption:t("caption"),cite:t("cite"),code:t("code"),col:t("col"),colgroup:t("colgroup"),data:t("data"),datalist:t("datalist"),dd:t("dd"),del:t("del"),details:t("details"),dfn:t("dfn"),dialog:t("dialog"),div:t("div"),dl:t("dl"),dt:t("dt"),em:t("em"),embed:t("embed"),fieldset:t("fieldset"),figcaption:t("figcaption"),figure:t("figure"),footer:t("footer"),form:t("form"),h1:t("h1"),h2:t("h2"),h3:t("h3"),h4:t("h4"),h5:t("h5"),h6:t("h6"),head:t("head"),header:t("header"),hgroup:t("hgroup"),hr:t("hr"),html:t("html"),i:t("i"),iframe:t("iframe"),img:t("img"),input:t("input"),ins:t("ins"),kbd:t("kbd"),keygen:t("keygen"),label:t("label"),legend:t("legend"),li:t("li"),link:t("link"),main:t("main"),map:t("map"),mark:t("mark"),menu:t("menu"),menuitem:t("menuitem"),meta:t("meta"),meter:t("meter"),nav:t("nav"),noscript:t("noscript"),object:t("object"),ol:t("ol"),optgroup:t("optgroup"),option:t("option"),output:t("output"),p:t("p"),param:t("param"),picture:t("picture"),pre:t("pre"),progress:t("progress"),q:t("q"),rp:t("rp"),rt:t("rt"),ruby:t("ruby"),s:t("s"),samp:t("samp"),script:t("script"),section:t("section"),select:t("select"),small:t("small"),source:t("source"),span:t("span"),strong:t("strong"),style:t("style"),sub:t("sub"),summary:t("summary"),sup:t("sup"),table:t("table"),tbody:t("tbody"),td:t("td"),textarea:t("textarea"),tfoot:t("tfoot"),th:t("th"),thead:t("thead"),time:t("time"),title:t("title"),tr:t("tr"),track:t("track"),u:t("u"),ul:t("ul"),var:t("var"),video:t("video"),wbr:t("wbr"),circle:t("circle"),clipPath:t("clipPath"),defs:t("defs"),ellipse:t("ellipse"),g:t("g"),image:t("image"),line:t("line"),linearGradient:t("linearGradient"),mask:t("mask"),path:t("path"),pattern:t("pattern"),polygon:t("polygon"),polyline:t("polyline"),radialGradient:t("radialGradient"),rect:t("rect"),stop:t("stop"),svg:t("svg"),text:t("text"),tspan:t("tspan")}}(n(2))},function(e,t,n){"use strict";e.exports=n(672)},,function(e,t,n){},function(e,t,n){!function(e,t,n,r,o,i,a,s,c,l,u,d,p,h,f,m,v,g,E,y,_,b,T,S,O,R,C,w,I,A,N,k,P,D,M,L,x,U,j,F,B,V,H,G,W,q,K,Y,z,X,J,Z,Q,$,ee,te,ne,re,oe,ie,ae,se,ce,le){"use strict";function ue(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var de=ue(t),pe=ue(r),he=ue(o),fe=ue(i),me=ue(a),ve=ue(s),ge=ue(c),Ee=ue(l),ye=ue(u),_e=ue(d),be=ue(p),Te=ue(h),Se=ue(f),Oe=ue(m),Re=ue(v),Ce=ue(g),we=ue(E),Ie=ue(y),Ae=ue(_),Ne=ue(b),ke=ue(T),Pe=ue(S),De=ue(O),Me=ue(R),Le=ue(C),xe=ue(w),Ue=ue(I),je=ue(A),Fe=ue(N),Be=ue(k),Ve=ue(P),He=ue(D),Ge=ue(M),We=ue(L),qe=ue(x),Ke=ue(U),Ye=ue(j),ze=ue(F),Xe=ue(B),Je=ue(V),Ze=ue(H),Qe=ue(G),$e=ue(W),et=ue(q),tt=ue(Y),nt=ue(z),rt=ue(X),ot=ue(J),it=ue(Z),at=ue(Q),st=ue($),ct=ue(ee),lt=ue(te),ut=ue(ne),dt=ue(re),pt=ue(oe),ht=ue(ie),ft=ue(ae),mt=ue(se),vt=ue(le);function gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(n),!0).forEach((function(t){St(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yt(e){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yt(e)}function _t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pt(r.key),r)}}function Tt(e,t,n){return t&&bt(e.prototype,t),n&&bt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function St(e,t,n){return(t=Pt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ot(){return Ot=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ot.apply(this,arguments)}function Rt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wt(e,t)}function Ct(e){return Ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ct(e)}function wt(e,t){return wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},wt(e,t)}function It(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function At(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ct(e);if(t){var o=Ct(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return It(e)}(this,n)}}function Nt(e){return function(e){if(Array.isArray(e))return kt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return kt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pt(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var Dt=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},Mt=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},Lt={p:Mt,P:function(e,t){var n,r=e.match(/(P+)(p+)?/)||[],o=r[1],i=r[2];if(!i)return Dt(e,t);switch(o){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",Dt(o,t)).replace("{{time}}",Mt(i,t))}},xt=12,Ut=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;function jt(e){var t=e?"string"==typeof e||e instanceof String?ht.default(e):dt.default(e):new Date;return Ft(t)?t:null}function Ft(e,t){return t=t||new Date("1/1/1000"),fe.default(e)&&!lt.default(e,t)}function Bt(e,t,n){if("en"===n)return me.default(e,t,{awareOfUnicodeTokens:!0});var r=tn(n);return n&&!r&&console.warn('A locale object was not found for the provided string ["'.concat(n,'"].')),!r&&en()&&tn(en())&&(r=tn(en())),me.default(e,t,{locale:r||null,awareOfUnicodeTokens:!0})}function Vt(e,t){var n=t.dateFormat,r=t.locale;return e&&Bt(e,Array.isArray(n)?n[0]:n,r)||""}function Ht(e,t){var n=t.hour,r=void 0===n?0:n,o=t.minute,i=void 0===o?0:o,a=t.second,s=void 0===a?0:a;return Be.default(Fe.default(je.default(e,s),i),r)}function Gt(e,t,n){var r=tn(t||en());return Je.default(e,{locale:r,weekStartsOn:n})}function Wt(e){return Ze.default(e)}function qt(e){return $e.default(e)}function Kt(e){return Qe.default(e)}function Yt(){return Xe.default(jt())}function zt(e,t){return e&&t?at.default(e,t):!e&&!t}function Xt(e,t){return e&&t?it.default(e,t):!e&&!t}function Jt(e,t){return e&&t?st.default(e,t):!e&&!t}function Zt(e,t){return e&&t?ot.default(e,t):!e&&!t}function Qt(e,t){return e&&t?rt.default(e,t):!e&&!t}function $t(e,t,n){var r,o=Xe.default(t),i=et.default(n);try{r=ut.default(e,{start:o,end:i})}catch(e){r=!1}return r}function en(){return("undefined"!=typeof window?window:globalThis).__localeId__}function tn(e){if("string"==typeof e){var t="undefined"!=typeof window?window:globalThis;return t.__localeData__?t.__localeData__[e]:null}return e}function nn(e,t){return Bt(Ve.default(jt(),e),"LLLL",t)}function rn(e,t){return Bt(Ve.default(jt(),e),"LLL",t)}function on(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.maxDate,o=t.excludeDates,i=t.excludeDateIntervals,a=t.includeDates,s=t.includeDateIntervals,c=t.filterDate;return hn(e,{minDate:n,maxDate:r})||o&&o.some((function(t){return Zt(e,t)}))||i&&i.some((function(t){var n=t.start,r=t.end;return ut.default(e,{start:n,end:r})}))||a&&!a.some((function(t){return Zt(e,t)}))||s&&!s.some((function(t){var n=t.start,r=t.end;return ut.default(e,{start:n,end:r})}))||c&&!c(jt(e))||!1}function an(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.excludeDates,r=t.excludeDateIntervals;return r&&r.length>0?r.some((function(t){var n=t.start,r=t.end;return ut.default(e,{start:n,end:r})})):n&&n.some((function(t){return Zt(e,t)}))||!1}function sn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.maxDate,o=t.excludeDates,i=t.includeDates,a=t.filterDate;return hn(e,{minDate:Ze.default(n),maxDate:tt.default(r)})||o&&o.some((function(t){return Xt(e,t)}))||i&&!i.some((function(t){return Xt(e,t)}))||a&&!a(jt(e))||!1}function cn(e,t,n,r){var o=xe.default(e),i=Me.default(e),a=xe.default(t),s=Me.default(t),c=xe.default(r);return o===a&&o===c?i<=n&&n<=s:o<a?c===o&&i<=n||c===a&&s>=n||c<a&&c>o:void 0}function ln(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.maxDate,o=t.excludeDates,i=t.includeDates,a=t.filterDate;return hn(e,{minDate:n,maxDate:r})||o&&o.some((function(t){return Jt(e,t)}))||i&&!i.some((function(t){return Jt(e,t)}))||a&&!a(jt(e))||!1}function un(e,t,n){if(!fe.default(t)||!fe.default(n))return!1;var r=xe.default(t),o=xe.default(n);return r<=e&&o>=e}function dn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.maxDate,o=t.excludeDates,i=t.includeDates,a=t.filterDate,s=new Date(e,0,1);return hn(s,{minDate:$e.default(n),maxDate:nt.default(r)})||o&&o.some((function(e){return zt(s,e)}))||i&&!i.some((function(e){return zt(s,e)}))||a&&!a(jt(s))||!1}function pn(e,t,n,r){var o=xe.default(e),i=Le.default(e),a=xe.default(t),s=Le.default(t),c=xe.default(r);return o===a&&o===c?i<=n&&n<=s:o<a?c===o&&i<=n||c===a&&s>=n||c<a&&c>o:void 0}function hn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.maxDate;return n&&Ke.default(e,n)<0||r&&Ke.default(e,r)>0}function fn(e,t){return t.some((function(t){return Ne.default(t)===Ne.default(e)&&Ae.default(t)===Ae.default(e)}))}function mn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.excludeTimes,r=t.includeTimes,o=t.filterTime;return n&&fn(e,n)||r&&!fn(e,r)||o&&!o(e)||!1}function vn(e,t){var n=t.minTime,r=t.maxTime;if(!n||!r)throw new Error("Both minTime and maxTime props required");var o,i=jt(),a=Be.default(Fe.default(i,Ae.default(e)),Ne.default(e)),s=Be.default(Fe.default(i,Ae.default(n)),Ne.default(n)),c=Be.default(Fe.default(i,Ae.default(r)),Ne.default(r));try{o=!ut.default(a,{start:s,end:c})}catch(e){o=!1}return o}function gn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.includeDates,o=Re.default(e,1);return n&&Ye.default(n,o)>0||r&&r.every((function(e){return Ye.default(e,o)>0}))||!1}function En(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.maxDate,r=t.includeDates,o=_e.default(e,1);return n&&Ye.default(o,n)>0||r&&r.every((function(e){return Ye.default(o,e)>0}))||!1}function yn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.includeDates,o=we.default(e,1);return n&&ze.default(n,o)>0||r&&r.every((function(e){return ze.default(e,o)>0}))||!1}function _n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.maxDate,r=t.includeDates,o=Te.default(e,1);return n&&ze.default(o,n)>0||r&&r.every((function(e){return ze.default(o,e)>0}))||!1}function bn(e){var t=e.minDate,n=e.includeDates;if(n&&t){var r=n.filter((function(e){return Ke.default(e,t)>=0}));return We.default(r)}return n?We.default(n):t}function Tn(e){var t=e.maxDate,n=e.includeDates;if(n&&t){var r=n.filter((function(e){return Ke.default(e,t)<=0}));return qe.default(r)}return n?qe.default(n):t}function Sn(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"react-datepicker__day--highlighted",n=new Map,r=0,o=e.length;r<o;r++){var i=e[r];if(he.default(i)){var a=Bt(i,"MM.dd.yyyy"),s=n.get(a)||[];s.includes(t)||(s.push(t),n.set(a,s))}else if("object"===yt(i)){var c=Object.keys(i),l=c[0],u=i[c[0]];if("string"==typeof l&&u.constructor===Array)for(var d=0,p=u.length;d<p;d++){var h=Bt(u[d],"MM.dd.yyyy"),f=n.get(h)||[];f.includes(l)||(f.push(l),n.set(h,f))}}}return n}function On(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"react-datepicker__day--holidays",n=new Map;return e.forEach((function(e){var r=e.date,o=e.holidayName;if(he.default(r)){var i=Bt(r,"MM.dd.yyyy"),a=n.get(i)||{};if(!("className"in a)||a.className!==t||(s=a.holidayNames,c=[o],s.length!==c.length||!s.every((function(e,t){return e===c[t]})))){var s,c;a.className=t;var l=a.holidayNames;a.holidayNames=l?[].concat(Nt(l),[o]):[o],n.set(i,a)}}})),n}function Rn(e,t,n,r,o){for(var i=o.length,a=[],s=0;s<i;s++){var c=ve.default(ge.default(e,Ne.default(o[s])),Ae.default(o[s])),l=ve.default(e,(n+1)*r);ct.default(c,t)&&lt.default(c,l)&&a.push(o[s])}return a}function Cn(e){return e<10?"0".concat(e):"".concat(e)}function wn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xt,n=Math.ceil(xe.default(e)/t)*t;return{startPeriod:n-(t-1),endPeriod:n}}function In(e){var t=e.getSeconds(),n=e.getMilliseconds();return dt.default(e.getTime()-1e3*t-n)}function An(e,t,n,r){for(var o=[],i=0;i<2*t+1;i++){var a=e+t-i,s=!0;n&&(s=xe.default(n)<=a),r&&s&&(s=xe.default(r)>=a),s&&o.push(a)}return o}var Nn=function(e){Rt(r,e);var n=At(r);function r(e){var o;_t(this,r),St(It(o=n.call(this,e)),"renderOptions",(function(){var e=o.props.year,t=o.state.yearsList.map((function(t){return de.default.createElement("div",{className:e===t?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:t,onClick:o.onChange.bind(It(o),t),"aria-selected":e===t?"true":void 0},e===t?de.default.createElement("span",{className:"react-datepicker__year-option--selected"},"\u2713"):"",t)})),n=o.props.minDate?xe.default(o.props.minDate):null,r=o.props.maxDate?xe.default(o.props.maxDate):null;return r&&o.state.yearsList.find((function(e){return e===r}))||t.unshift(de.default.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:o.incrementYears},de.default.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),n&&o.state.yearsList.find((function(e){return e===n}))||t.push(de.default.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:o.decrementYears},de.default.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),t})),St(It(o),"onChange",(function(e){o.props.onChange(e)})),St(It(o),"handleClickOutside",(function(){o.props.onCancel()})),St(It(o),"shiftYears",(function(e){var t=o.state.yearsList.map((function(t){return t+e}));o.setState({yearsList:t})})),St(It(o),"incrementYears",(function(){return o.shiftYears(1)})),St(It(o),"decrementYears",(function(){return o.shiftYears(-1)}));var i=e.yearDropdownItemNumber,a=e.scrollableYearDropdown,s=i||(a?10:5);return o.state={yearsList:An(o.props.year,s,o.props.minDate,o.props.maxDate)},o.dropdownRef=t.createRef(),o}return Tt(r,[{key:"componentDidMount",value:function(){var e=this.dropdownRef.current;if(e){var t=e.children?Array.from(e.children):null,n=t?t.find((function(e){return e.ariaSelected})):null;e.scrollTop=n?n.offsetTop+(n.clientHeight-e.clientHeight)/2:(e.scrollHeight-e.clientHeight)/2}}},{key:"render",value:function(){var e=pe.default({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return de.default.createElement("div",{className:e,ref:this.dropdownRef},this.renderOptions())}}]),r}(de.default.Component),kn=ft.default(Nn),Pn=function(e){Rt(n,e);var t=At(n);function n(){var e;_t(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return St(It(e=t.call.apply(t,[this].concat(o))),"state",{dropdownVisible:!1}),St(It(e),"renderSelectOptions",(function(){for(var t=e.props.minDate?xe.default(e.props.minDate):1900,n=e.props.maxDate?xe.default(e.props.maxDate):2100,r=[],o=t;o<=n;o++)r.push(de.default.createElement("option",{key:o,value:o},o));return r})),St(It(e),"onSelectChange",(function(t){e.onChange(t.target.value)})),St(It(e),"renderSelectMode",(function(){return de.default.createElement("select",{value:e.props.year,className:"react-datepicker__year-select",onChange:e.onSelectChange},e.renderSelectOptions())})),St(It(e),"renderReadView",(function(t){return de.default.createElement("div",{key:"read",style:{visibility:t?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(t){return e.toggleDropdown(t)}},de.default.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),de.default.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},e.props.year))})),St(It(e),"renderDropdown",(function(){return de.default.createElement(kn,{key:"dropdown",year:e.props.year,onChange:e.onChange,onCancel:e.toggleDropdown,minDate:e.props.minDate,maxDate:e.props.maxDate,scrollableYearDropdown:e.props.scrollableYearDropdown,yearDropdownItemNumber:e.props.yearDropdownItemNumber})})),St(It(e),"renderScrollMode",(function(){var t=e.state.dropdownVisible,n=[e.renderReadView(!t)];return t&&n.unshift(e.renderDropdown()),n})),St(It(e),"onChange",(function(t){e.toggleDropdown(),t!==e.props.year&&e.props.onChange(t)})),St(It(e),"toggleDropdown",(function(t){e.setState({dropdownVisible:!e.state.dropdownVisible},(function(){e.props.adjustDateOnChange&&e.handleYearChange(e.props.date,t)}))})),St(It(e),"handleYearChange",(function(t,n){e.onSelect(t,n),e.setOpen()})),St(It(e),"onSelect",(function(t,n){e.props.onSelect&&e.props.onSelect(t,n)})),St(It(e),"setOpen",(function(){e.props.setOpen&&e.props.setOpen(!0)})),e}return Tt(n,[{key:"render",value:function(){var e;switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode();break;case"select":e=this.renderSelectMode()}return de.default.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},e)}}]),n}(de.default.Component),Dn=function(e){Rt(n,e);var t=At(n);function n(){var e;_t(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return St(It(e=t.call.apply(t,[this].concat(o))),"isSelectedMonth",(function(t){return e.props.month===t})),St(It(e),"renderOptions",(function(){return e.props.monthNames.map((function(t,n){return de.default.createElement("div",{className:e.isSelectedMonth(n)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:t,onClick:e.onChange.bind(It(e),n),"aria-selected":e.isSelectedMonth(n)?"true":void 0},e.isSelectedMonth(n)?de.default.createElement("span",{className:"react-datepicker__month-option--selected"},"\u2713"):"",t)}))})),St(It(e),"onChange",(function(t){return e.props.onChange(t)})),St(It(e),"handleClickOutside",(function(){return e.props.onCancel()})),e}return Tt(n,[{key:"render",value:function(){return de.default.createElement("div",{className:"react-datepicker__month-dropdown"},this.renderOptions())}}]),n}(de.default.Component),Mn=ft.default(Dn),Ln=function(e){Rt(n,e);var t=At(n);function n(){var e;_t(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return St(It(e=t.call.apply(t,[this].concat(o))),"state",{dropdownVisible:!1}),St(It(e),"renderSelectOptions",(function(e){return e.map((function(e,t){return de.default.createElement("option",{key:t,value:t},e)}))})),St(It(e),"renderSelectMode",(function(t){return de.default.createElement("select",{value:e.props.month,className:"react-datepicker__month-select",onChange:function(t){return e.onChange(t.target.value)}},e.renderSelectOptions(t))})),St(It(e),"renderReadView",(function(t,n){return de.default.createElement("div",{key:"read",style:{visibility:t?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:e.toggleDropdown},de.default.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),de.default.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},n[e.props.month]))})),St(It(e),"renderDropdown",(function(t){return de.default.createElement(Mn,{key:"dropdown",month:e.props.month,monthNames:t,onChange:e.onChange,onCancel:e.toggleDropdown})})),St(It(e),"renderScrollMode",(function(t){var n=e.state.dropdownVisible,r=[e.renderReadView(!n,t)];return n&&r.unshift(e.renderDropdown(t)),r})),St(It(e),"onChange",(function(t){e.toggleDropdown(),t!==e.props.month&&e.props.onChange(t)})),St(It(e),"toggleDropdown",(function(){return e.setState({dropdownVisible:!e.state.dropdownVisible})})),e}return Tt(n,[{key:"render",value:function(){var e,t=this,n=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(e){return rn(e,t.props.locale)}:function(e){return nn(e,t.props.locale)});switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode(n);break;case"select":e=this.renderSelectMode(n)}return de.default.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},e)}}]),n}(de.default.Component);function xn(e,t){for(var n=[],r=Wt(e),o=Wt(t);!ct.default(r,o);)n.push(jt(r)),r=_e.default(r,1);return n}var Un=function(e){Rt(n,e);var t=At(n);function n(e){var r;return _t(this,n),St(It(r=t.call(this,e)),"renderOptions",(function(){return r.state.monthYearsList.map((function(e){var t=Ue.default(e),n=zt(r.props.date,e)&&Xt(r.props.date,e);return de.default.createElement("div",{className:n?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:t,onClick:r.onChange.bind(It(r),t),"aria-selected":n?"true":void 0},n?de.default.createElement("span",{className:"react-datepicker__month-year-option--selected"},"\u2713"):"",Bt(e,r.props.dateFormat,r.props.locale))}))})),St(It(r),"onChange",(function(e){return r.props.onChange(e)})),St(It(r),"handleClickOutside",(function(){r.props.onCancel()})),r.state={monthYearsList:xn(r.props.minDate,r.props.maxDate)},r}return Tt(n,[{key:"render",value:function(){var e=pe.default({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return de.default.createElement("div",{className:e},this.renderOptions())}}]),n}(de.default.Component),jn=ft.default(Un),Fn=function(e){Rt(n,e);var t=At(n);function n(){var e;_t(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return St(It(e=t.call.apply(t,[this].concat(o))),"state",{dropdownVisible:!1}),St(It(e),"renderSelectOptions",(function(){for(var t=Wt(e.props.minDate),n=Wt(e.props.maxDate),r=[];!ct.default(t,n);){var o=Ue.default(t);r.push(de.default.createElement("option",{key:o,value:o},Bt(t,e.props.dateFormat,e.props.locale))),t=_e.default(t,1)}return r})),St(It(e),"onSelectChange",(function(t){e.onChange(t.target.value)})),St(It(e),"renderSelectMode",(function(){return de.default.createElement("select",{value:Ue.default(Wt(e.props.date)),className:"react-datepicker__month-year-select",onChange:e.onSelectChange},e.renderSelectOptions())})),St(It(e),"renderReadView",(function(t){var n=Bt(e.props.date,e.props.dateFormat,e.props.locale);return de.default.createElement("div",{key:"read",style:{visibility:t?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:function(t){return e.toggleDropdown(t)}},de.default.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),de.default.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},n))})),St(It(e),"renderDropdown",(function(){return de.default.createElement(jn,{key:"dropdown",date:e.props.date,dateFormat:e.props.dateFormat,onChange:e.onChange,onCancel:e.toggleDropdown,minDate:e.props.minDate,maxDate:e.props.maxDate,scrollableMonthYearDropdown:e.props.scrollableMonthYearDropdown,locale:e.props.locale})})),St(It(e),"renderScrollMode",(function(){var t=e.state.dropdownVisible,n=[e.renderReadView(!t)];return t&&n.unshift(e.renderDropdown()),n})),St(It(e),"onChange",(function(t){e.toggleDropdown();var n=jt(parseInt(t));zt(e.props.date,n)&&Xt(e.props.date,n)||e.props.onChange(n)})),St(It(e),"toggleDropdown",(function(){return e.setState({dropdownVisible:!e.state.dropdownVisible})})),e}return Tt(n,[{key:"render",value:function(){var e;switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode();break;case"select":e=this.renderSelectMode()}return de.default.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},e)}}]),n}(de.default.Component),Bn=function(e){Rt(n,e);var t=At(n);function n(){var e;_t(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return St(It(e=t.call.apply(t,[this].concat(o))),"dayEl",de.default.createRef()),St(It(e),"handleClick",(function(t){!e.isDisabled()&&e.props.onClick&&e.props.onClick(t)})),St(It(e),"handleMouseEnter",(function(t){!e.isDisabled()&&e.props.onMouseEnter&&e.props.onMouseEnter(t)})),St(It(e),"handleOnKeyDown",(function(t){" "===t.key&&(t.preventDefault(),t.key="Enter"),e.props.handleOnKeyDown(t)})),St(It(e),"isSameDay",(function(t){return Zt(e.props.day,t)})),St(It(e),"isKeyboardSelected",(function(){return!e.props.disabledKeyboardNavigation&&!(e.isSameDay(e.props.selected)||e.isSameWeek(e.props.selected))&&(e.isSameDay(e.props.preSelection)||e.isSameWeek(e.props.preSelection))})),St(It(e),"isDisabled",(function(){return on(e.props.day,e.props)})),St(It(e),"isExcluded",(function(){return an(e.props.day,e.props)})),St(It(e),"isStartOfWeek",(function(){return Zt(e.props.day,Gt(e.props.day,e.props.locale,e.props.calendarStartDay))})),St(It(e),"isSameWeek",(function(t){return e.props.showWeekPicker&&Zt(t,Gt(e.props.day,e.props.locale,e.props.calendarStartDay))})),St(It(e),"getHighLightedClass",(function(){var t=e.props,n=t.day,r=t.highlightDates;if(!r)return!1;var o=Bt(n,"MM.dd.yyyy");return r.get(o)})),St(It(e),"getHolidaysClass",(function(){var t=e.props,n=t.day,r=t.holidays;if(!r)return!1;var o=Bt(n,"MM.dd.yyyy");return r.has(o)?[r.get(o).className]:void 0})),St(It(e),"isInRange",(function(){var t=e.props,n=t.day,r=t.startDate,o=t.endDate;return!(!r||!o)&&$t(n,r,o)})),St(It(e),"isInSelectingRange",(function(){var t,n=e.props,r=n.day,o=n.selectsStart,i=n.selectsEnd,a=n.selectsRange,s=n.selectsDisabledDaysInRange,c=n.startDate,l=n.endDate,u=null!==(t=e.props.selectingDate)&&void 0!==t?t:e.props.preSelection;return!(!(o||i||a)||!u||!s&&e.isDisabled())&&(o&&l&&(lt.default(u,l)||Qt(u,l))?$t(r,u,l):(i&&c&&(ct.default(u,c)||Qt(u,c))||!(!a||!c||l||!ct.default(u,c)&&!Qt(u,c)))&&$t(r,c,u))})),St(It(e),"isSelectingRangeStart",(function(){var t;if(!e.isInSelectingRange())return!1;var n=e.props,r=n.day,o=n.startDate,i=n.selectsStart,a=null!==(t=e.props.selectingDate)&&void 0!==t?t:e.props.preSelection;return Zt(r,i?a:o)})),St(It(e),"isSelectingRangeEnd",(function(){var t;if(!e.isInSelectingRange())return!1;var n=e.props,r=n.day,o=n.endDate,i=n.selectsEnd,a=n.selectsRange,s=null!==(t=e.props.selectingDate)&&void 0!==t?t:e.props.preSelection;return Zt(r,i||a?s:o)})),St(It(e),"isRangeStart",(function(){var t=e.props,n=t.day,r=t.startDate,o=t.endDate;return!(!r||!o)&&Zt(r,n)})),St(It(e),"isRangeEnd",(function(){var t=e.props,n=t.day,r=t.startDate,o=t.endDate;return!(!r||!o)&&Zt(o,n)})),St(It(e),"isWeekend",(function(){var t=ke.default(e.props.day);return 0===t||6===t})),St(It(e),"isAfterMonth",(function(){return void 0!==e.props.month&&(e.props.month+1)%12===Me.default(e.props.day)})),St(It(e),"isBeforeMonth",(function(){return void 0!==e.props.month&&(Me.default(e.props.day)+1)%12===e.props.month})),St(It(e),"isCurrentDay",(function(){return e.isSameDay(jt())})),St(It(e),"isSelected",(function(){return e.isSameDay(e.props.selected)||e.isSameWeek(e.props.selected)})),St(It(e),"getClassNames",(function(t){var n,r=e.props.dayClassName?e.props.dayClassName(t):void 0;return pe.default("react-datepicker__day",r,"react-datepicker__day--"+Bt(e.props.day,"ddd",n),{"react-datepicker__day--disabled":e.isDisabled(),"react-datepicker__day--excluded":e.isExcluded(),"react-datepicker__day--selected":e.isSelected(),"react-datepicker__day--keyboard-selected":e.isKeyboardSelected(),"react-datepicker__day--range-start":e.isRangeStart(),"react-datepicker__day--range-end":e.isRangeEnd(),"react-datepicker__day--in-range":e.isInRange(),"react-datepicker__day--in-selecting-range":e.isInSelectingRange(),"react-datepicker__day--selecting-range-start":e.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":e.isSelectingRangeEnd(),"react-datepicker__day--today":e.isCurrentDay(),"react-datepicker__day--weekend":e.isWeekend(),"react-datepicker__day--outside-month":e.isAfterMonth()||e.isBeforeMonth()},e.getHighLightedClass("react-datepicker__day--highlighted"),e.getHolidaysClass())})),St(It(e),"getAriaLabel",(function(){var t=e.props,n=t.day,r=t.ariaLabelPrefixWhenEnabled,o=void 0===r?"Choose":r,i=t.ariaLabelPrefixWhenDisabled,a=void 0===i?"Not available":i,s=e.isDisabled()||e.isExcluded()?a:o;return"".concat(s," ").concat(Bt(n,"PPPP",e.props.locale))})),St(It(e),"getTitle",(function(){var t=e.props,n=t.day,r=t.holidays,o=void 0===r?new Map:r,i=Bt(n,"MM.dd.yyyy");return o.has(i)&&o.get(i).holidayNames.length>0?o.get(i).holidayNames.join(", "):""})),St(It(e),"getTabIndex",(function(t,n){var r=t||e.props.selected,o=n||e.props.preSelection;return(!e.props.showWeekPicker||!e.props.showWeekNumber&&e.isStartOfWeek())&&(e.isKeyboardSelected()||e.isSameDay(r)&&Zt(o,r))?0:-1})),St(It(e),"handleFocusDay",(function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=!1;0===e.getTabIndex()&&!n.isInputFocused&&e.isSameDay(e.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(r=!0),e.props.inline&&!e.props.shouldFocusDayInline&&(r=!1),e.props.containerRef&&e.props.containerRef.current&&e.props.containerRef.current.contains(document.activeElement)&&document.activeElement.classList.contains("react-datepicker__day")&&(r=!0),e.props.monthShowsDuplicateDaysEnd&&e.isAfterMonth()&&(r=!1),e.props.monthShowsDuplicateDaysStart&&e.isBeforeMonth()&&(r=!1)),r&&(null===(t=e.dayEl.current)||void 0===t||t.focus({preventScroll:!0}))})),St(It(e),"renderDayContents",(function(){return e.props.monthShowsDuplicateDaysEnd&&e.isAfterMonth()||e.props.monthShowsDuplicateDaysStart&&e.isBeforeMonth()?null:e.props.renderDayContents?e.props.renderDayContents(Pe.default(e.props.day),e.props.day):Pe.default(e.props.day)})),St(It(e),"render",(function(){return de.default.createElement("div",{ref:e.dayEl,className:e.getClassNames(e.props.day),onKeyDown:e.handleOnKeyDown,onClick:e.handleClick,onMouseEnter:e.handleMouseEnter,tabIndex:e.getTabIndex(),"aria-label":e.getAriaLabel(),role:"option",title:e.getTitle(),"aria-disabled":e.isDisabled(),"aria-current":e.isCurrentDay()?"date":void 0,"aria-selected":e.isSelected()||e.isInRange()},e.renderDayContents(),""!==e.getTitle()&&de.default.createElement("span",{className:"holiday-overlay"},e.getTitle()))})),e}return Tt(n,[{key:"componentDidMount",value:function(){this.handleFocusDay()}},{key:"componentDidUpdate",value:function(e){this.handleFocusDay(e)}}]),n}(de.default.Component),Vn=function(e){Rt(n,e);var t=At(n);function n(){var e;_t(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return St(It(e=t.call.apply(t,[this].concat(o))),"weekNumberEl",de.default.createRef()),St(It(e),"handleClick",(function(t){e.props.onClick&&e.props.onClick(t)})),St(It(e),"handleOnKeyDown",(function(t){" "===t.key&&(t.preventDefault(),t.key="Enter"),e.props.handleOnKeyDown(t)})),St(It(e),"isKeyboardSelected",(function(){return!e.props.disabledKeyboardNavigation&&!Zt(e.props.date,e.props.selected)&&Zt(e.props.date,e.props.preSelection)})),St(It(e),"getTabIndex",(function(){return e.props.showWeekPicker&&e.props.showWeekNumber&&(e.isKeyboardSelected()||Zt(e.props.date,e.props.selected)&&Zt(e.props.preSelection,e.props.selected))?0:-1})),St(It(e),"handleFocusWeekNumber",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=!1;0===e.getTabIndex()&&!t.isInputFocused&&Zt(e.props.date,e.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(n=!0),e.props.inline&&!e.props.shouldFocusDayInline&&(n=!1),e.props.containerRef&&e.props.containerRef.current&&e.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(n=!0)),n&&e.weekNumberEl.current&&e.weekNumberEl.current.focus({preventScroll:!0})})),e}return Tt(n,[{key:"componentDidMount",value:function(){this.handleFocusWeekNumber()}},{key:"componentDidUpdate",value:function(e){this.handleFocusWeekNumber(e)}},{key:"render",value:function(){var e=this.props,t=e.weekNumber,n=e.ariaLabelPrefix,r=void 0===n?"week ":n,o={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!e.onClick,"react-datepicker__week-number--selected":Zt(this.props.date,this.props.selected),"react-datepicker__week-number--keyboard-selected":this.isKeyboardSelected()};return de.default.createElement("div",{ref:this.weekNumberEl,className:pe.default(o),"aria-label":"".concat(r," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},t)}}],[{key:"defaultProps",get:function(){return{ariaLabelPrefix:"week "}}}]),n}(de.default.Component),Hn=function(e){Rt(n,e);var t=At(n);function n(){var e;_t(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return St(It(e=t.call.apply(t,[this].concat(o))),"handleDayClick",(function(t,n){e.props.onDayClick&&e.props.onDayClick(t,n)})),St(It(e),"handleDayMouseEnter",(function(t){e.props.onDayMouseEnter&&e.props.onDayMouseEnter(t)})),St(It(e),"handleWeekClick",(function(t,n,r){if("function"==typeof e.props.onWeekSelect&&e.props.onWeekSelect(t,n,r),e.props.showWeekPicker){var o=Gt(t,e.props.locale,e.props.calendarStartDay);e.handleDayClick(o,r)}e.props.shouldCloseOnSelect&&e.props.setOpen(!1)})),St(It(e),"formatWeekNumber",(function(t){return e.props.formatWeekNumber?e.props.formatWeekNumber(t):function(e,t){var n=t&&tn(t)||en()&&tn(en());return De.default(e,n?{locale:n}:null)}(t)})),St(It(e),"renderDays",(function(){var t=Gt(e.props.day,e.props.locale,e.props.calendarStartDay),n=[],r=e.formatWeekNumber(t);if(e.props.showWeekNumber){var o=e.props.onWeekSelect||e.props.showWeekPicker?e.handleWeekClick.bind(It(e),t,r):void 0;n.push(de.default.createElement(Vn,{key:"W",weekNumber:r,date:t,onClick:o,selected:e.props.selected,preSelection:e.props.preSelection,ariaLabelPrefix:e.props.ariaLabelPrefix,showWeekPicker:e.props.showWeekPicker,showWeekNumber:e.props.showWeekNumber,disabledKeyboardNavigation:e.props.disabledKeyboardNavigation,handleOnKeyDown:e.props.handleOnKeyDown,isInputFocused:e.props.isInputFocused,containerRef:e.props.containerRef}))}return n.concat([0,1,2,3,4,5,6].map((function(n){var r=Ee.default(t,n);return de.default.createElement(Bn,{ariaLabelPrefixWhenEnabled:e.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:e.props.disabledDayAriaLabelPrefix,key:r.valueOf(),day:r,month:e.props.month,onClick:e.handleDayClick.bind(It(e),r),onMouseEnter:e.handleDayMouseEnter.bind(It(e),r),minDate:e.props.minDate,maxDate:e.props.maxDate,excludeDates:e.props.excludeDates,excludeDateIntervals:e.props.excludeDateIntervals,includeDates:e.props.includeDates,includeDateIntervals:e.props.includeDateIntervals,highlightDates:e.props.highlightDates,holidays:e.props.holidays,selectingDate:e.props.selectingDate,filterDate:e.props.filterDate,preSelection:e.props.preSelection,selected:e.props.selected,selectsStart:e.props.selectsStart,selectsEnd:e.props.selectsEnd,selectsRange:e.props.selectsRange,showWeekPicker:e.props.showWeekPicker,showWeekNumber:e.props.showWeekNumber,selectsDisabledDaysInRange:e.props.selectsDisabledDaysInRange,startDate:e.props.startDate,endDate:e.props.endDate,dayClassName:e.props.dayClassName,renderDayContents:e.props.renderDayContents,disabledKeyboardNavigation:e.props.disabledKeyboardNavigation,handleOnKeyDown:e.props.handleOnKeyDown,isInputFocused:e.props.isInputFocused,containerRef:e.props.containerRef,inline:e.props.inline,shouldFocusDayInline:e.props.shouldFocusDayInline,monthShowsDuplicateDaysEnd:e.props.monthShowsDuplicateDaysEnd,monthShowsDuplicateDaysStart:e.props.monthShowsDuplicateDaysStart,locale:e.props.locale})})))})),St(It(e),"startOfWeek",(function(){return Gt(e.props.day,e.props.locale,e.props.calendarStartDay)})),St(It(e),"isKeyboardSelected",(function(){return!e.props.disabledKeyboardNavigation&&!Zt(e.startOfWeek(),e.props.selected)&&Zt(e.startOfWeek(),e.props.preSelection)})),e}return Tt(n,[{key:"render",value:function(){var e={"react-datepicker__week":!0,"react-datepicker__week--selected":Zt(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return de.default.createElement("div",{className:pe.default(e)},this.renderDays())}}],[{key:"defaultProps",get:function(){return{shouldCloseOnSelect:!0}}}]),n}(de.default.Component),Gn="two_columns",Wn="three_columns",qn="four_columns",Kn=St(St(St({},Gn,{grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2}),Wn,{grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3}),qn,{grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4});function Yn(e,t){return e?qn:t?Gn:Wn}var zn=function(e){Rt(n,e);var t=At(n);function n(){var e;_t(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return St(It(e=t.call.apply(t,[this].concat(o))),"MONTH_REFS",Nt(Array(12)).map((function(){return de.default.createRef()}))),St(It(e),"QUARTER_REFS",Nt(Array(4)).map((function(){return de.default.createRef()}))),St(It(e),"isDisabled",(function(t){return on(t,e.props)})),St(It(e),"isExcluded",(function(t){return an(t,e.props)})),St(It(e),"handleDayClick",(function(t,n){e.props.onDayClick&&e.props.onDayClick(t,n,e.props.orderInDisplay)})),St(It(e),"handleDayMouseEnter",(function(t){e.props.onDayMouseEnter&&e.props.onDayMouseEnter(t)})),St(It(e),"handleMouseLeave",(function(){e.props.onMouseLeave&&e.props.onMouseLeave()})),St(It(e),"isRangeStartMonth",(function(t){var n=e.props,r=n.day,o=n.startDate,i=n.endDate;return!(!o||!i)&&Xt(Ve.default(r,t),o)})),St(It(e),"isRangeStartQuarter",(function(t){var n=e.props,r=n.day,o=n.startDate,i=n.endDate;return!(!o||!i)&&Jt(He.default(r,t),o)})),St(It(e),"isRangeEndMonth",(function(t){var n=e.props,r=n.day,o=n.startDate,i=n.endDate;return!(!o||!i)&&Xt(Ve.default(r,t),i)})),St(It(e),"isRangeEndQuarter",(function(t){var n=e.props,r=n.day,o=n.startDate,i=n.endDate;return!(!o||!i)&&Jt(He.default(r,t),i)})),St(It(e),"isInSelectingRangeMonth",(function(t){var n,r=e.props,o=r.day,i=r.selectsStart,a=r.selectsEnd,s=r.selectsRange,c=r.startDate,l=r.endDate,u=null!==(n=e.props.selectingDate)&&void 0!==n?n:e.props.preSelection;return!(!(i||a||s)||!u)&&(i&&l?cn(u,l,t,o):(a&&c||!(!s||!c||l))&&cn(c,u,t,o))})),St(It(e),"isSelectingMonthRangeStart",(function(t){var n;if(!e.isInSelectingRangeMonth(t))return!1;var r=e.props,o=r.day,i=r.startDate,a=r.selectsStart,s=Ve.default(o,t),c=null!==(n=e.props.selectingDate)&&void 0!==n?n:e.props.preSelection;return Xt(s,a?c:i)})),St(It(e),"isSelectingMonthRangeEnd",(function(t){var n;if(!e.isInSelectingRangeMonth(t))return!1;var r=e.props,o=r.day,i=r.endDate,a=r.selectsEnd,s=r.selectsRange,c=Ve.default(o,t),l=null!==(n=e.props.selectingDate)&&void 0!==n?n:e.props.preSelection;return Xt(c,a||s?l:i)})),St(It(e),"isInSelectingRangeQuarter",(function(t){var n,r=e.props,o=r.day,i=r.selectsStart,a=r.selectsEnd,s=r.selectsRange,c=r.startDate,l=r.endDate,u=null!==(n=e.props.selectingDate)&&void 0!==n?n:e.props.preSelection;return!(!(i||a||s)||!u)&&(i&&l?pn(u,l,t,o):(a&&c||!(!s||!c||l))&&pn(c,u,t,o))})),St(It(e),"isWeekInMonth",(function(t){var n=e.props.day,r=Ee.default(t,6);return Xt(t,n)||Xt(r,n)})),St(It(e),"isCurrentMonth",(function(e,t){return xe.default(e)===xe.default(jt())&&t===Me.default(jt())})),St(It(e),"isCurrentQuarter",(function(e,t){return xe.default(e)===xe.default(jt())&&t===Le.default(jt())})),St(It(e),"isSelectedMonth",(function(e,t,n){return Me.default(n)===t&&xe.default(e)===xe.default(n)})),St(It(e),"isSelectedQuarter",(function(e,t,n){return Le.default(e)===t&&xe.default(e)===xe.default(n)})),St(It(e),"renderWeeks",(function(){for(var t=[],n=e.props.fixedHeight,r=0,o=!1,i=Gt(Wt(e.props.day),e.props.locale,e.props.calendarStartDay);t.push(de.default.createElement(Hn,{ariaLabelPrefix:e.props.weekAriaLabelPrefix,chooseDayAriaLabelPrefix:e.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:e.props.disabledDayAriaLabelPrefix,key:r,day:i,month:Me.default(e.props.day),onDayClick:e.handleDayClick,onDayMouseEnter:e.handleDayMouseEnter,onWeekSelect:e.props.onWeekSelect,formatWeekNumber:e.props.formatWeekNumber,locale:e.props.locale,minDate:e.props.minDate,maxDate:e.props.maxDate,excludeDates:e.props.excludeDates,excludeDateIntervals:e.props.excludeDateIntervals,includeDates:e.props.includeDates,includeDateIntervals:e.props.includeDateIntervals,inline:e.props.inline,shouldFocusDayInline:e.props.shouldFocusDayInline,highlightDates:e.props.highlightDates,holidays:e.props.holidays,selectingDate:e.props.selectingDate,filterDate:e.props.filterDate,preSelection:e.props.preSelection,selected:e.props.selected,selectsStart:e.props.selectsStart,selectsEnd:e.props.selectsEnd,selectsRange:e.props.selectsRange,selectsDisabledDaysInRange:e.props.selectsDisabledDaysInRange,showWeekNumber:e.props.showWeekNumbers,showWeekPicker:e.props.showWeekPicker,startDate:e.props.startDate,endDate:e.props.endDate,dayClassName:e.props.dayClassName,setOpen:e.props.setOpen,shouldCloseOnSelect:e.props.shouldCloseOnSelect,disabledKeyboardNavigation:e.props.disabledKeyboardNavigation,renderDayContents:e.props.renderDayContents,handleOnKeyDown:e.props.handleOnKeyDown,isInputFocused:e.props.isInputFocused,containerRef:e.props.containerRef,calendarStartDay:e.props.calendarStartDay,monthShowsDuplicateDaysEnd:e.props.monthShowsDuplicateDaysEnd,monthShowsDuplicateDaysStart:e.props.monthShowsDuplicateDaysStart})),!o;){r++,i=ye.default(i,1);var a=n&&r>=6,s=!n&&!e.isWeekInMonth(i);if(a||s){if(!e.props.peekNextMonth)break;o=!0}}return t})),St(It(e),"onMonthClick",(function(t,n){e.handleDayClick(Wt(Ve.default(e.props.day,n)),t)})),St(It(e),"onMonthMouseEnter",(function(t){e.handleDayMouseEnter(Wt(Ve.default(e.props.day,t)))})),St(It(e),"handleMonthNavigation",(function(t,n){e.isDisabled(n)||e.isExcluded(n)||(e.props.setPreSelection(n),e.MONTH_REFS[t].current&&e.MONTH_REFS[t].current.focus())})),St(It(e),"onMonthKeyDown",(function(t,n){var r=e.props,o=r.selected,i=r.preSelection,a=r.disabledKeyboardNavigation,s=r.showTwoColumnMonthYearPicker,c=r.showFourColumnMonthYearPicker,l=r.setPreSelection,u=t.key;if("Tab"!==u&&t.preventDefault(),!a){var d=Yn(c,s),p=Kn[d].verticalNavigationOffset,h=Kn[d].grid;switch(u){case"Enter":e.onMonthClick(t,n),l(o);break;case"ArrowRight":e.handleMonthNavigation(11===n?0:n+1,_e.default(i,1));break;case"ArrowLeft":e.handleMonthNavigation(0===n?11:n-1,Re.default(i,1));break;case"ArrowUp":e.handleMonthNavigation(h[0].includes(n)?n+12-p:n-p,Re.default(i,p));break;case"ArrowDown":e.handleMonthNavigation(h[h.length-1].includes(n)?n-12+p:n+p,_e.default(i,p))}}})),St(It(e),"onQuarterClick",(function(t,n){e.handleDayClick(Kt(He.default(e.props.day,n)),t)})),St(It(e),"onQuarterMouseEnter",(function(t){e.handleDayMouseEnter(Kt(He.default(e.props.day,t)))})),St(It(e),"handleQuarterNavigation",(function(t,n){e.isDisabled(n)||e.isExcluded(n)||(e.props.setPreSelection(n),e.QUARTER_REFS[t-1].current&&e.QUARTER_REFS[t-1].current.focus())})),St(It(e),"onQuarterKeyDown",(function(t,n){var r=t.key;if(!e.props.disabledKeyboardNavigation)switch(r){case"Enter":e.onQuarterClick(t,n),e.props.setPreSelection(e.props.selected);break;case"ArrowRight":e.handleQuarterNavigation(4===n?1:n+1,be.default(e.props.preSelection,1));break;case"ArrowLeft":e.handleQuarterNavigation(1===n?4:n-1,Ce.default(e.props.preSelection,1))}})),St(It(e),"getMonthClassNames",(function(t){var n=e.props,r=n.day,o=n.startDate,i=n.endDate,a=n.selected,s=n.minDate,c=n.maxDate,l=n.preSelection,u=n.monthClassName,d=n.excludeDates,p=n.includeDates,h=u?u(Ve.default(r,t)):void 0,f=Ve.default(r,t);return pe.default("react-datepicker__month-text","react-datepicker__month-".concat(t),h,{"react-datepicker__month-text--disabled":(s||c||d||p)&&sn(f,e.props),"react-datepicker__month-text--selected":e.isSelectedMonth(r,t,a),"react-datepicker__month-text--keyboard-selected":!e.props.disabledKeyboardNavigation&&Me.default(l)===t,"react-datepicker__month-text--in-selecting-range":e.isInSelectingRangeMonth(t),"react-datepicker__month-text--in-range":cn(o,i,t,r),"react-datepicker__month-text--range-start":e.isRangeStartMonth(t),"react-datepicker__month-text--range-end":e.isRangeEndMonth(t),"react-datepicker__month-text--selecting-range-start":e.isSelectingMonthRangeStart(t),"react-datepicker__month-text--selecting-range-end":e.isSelectingMonthRangeEnd(t),"react-datepicker__month-text--today":e.isCurrentMonth(r,t)})})),St(It(e),"getTabIndex",(function(t){var n=Me.default(e.props.preSelection);return e.props.disabledKeyboardNavigation||t!==n?"-1":"0"})),St(It(e),"getQuarterTabIndex",(function(t){var n=Le.default(e.props.preSelection);return e.props.disabledKeyboardNavigation||t!==n?"-1":"0"})),St(It(e),"getAriaLabel",(function(t){var n=e.props,r=n.chooseDayAriaLabelPrefix,o=void 0===r?"Choose":r,i=n.disabledDayAriaLabelPrefix,a=void 0===i?"Not available":i,s=n.day,c=Ve.default(s,t),l=e.isDisabled(c)||e.isExcluded(c)?a:o;return"".concat(l," ").concat(Bt(c,"MMMM yyyy"))})),St(It(e),"getQuarterClassNames",(function(t){var n=e.props,r=n.day,o=n.startDate,i=n.endDate,a=n.selected,s=n.minDate,c=n.maxDate,l=n.preSelection,u=n.disabledKeyboardNavigation;return pe.default("react-datepicker__quarter-text","react-datepicker__quarter-".concat(t),{"react-datepicker__quarter-text--disabled":(s||c)&&ln(He.default(r,t),e.props),"react-datepicker__quarter-text--selected":e.isSelectedQuarter(r,t,a),"react-datepicker__quarter-text--keyboard-selected":!u&&Le.default(l)===t,"react-datepicker__quarter-text--in-selecting-range":e.isInSelectingRangeQuarter(t),"react-datepicker__quarter-text--in-range":pn(o,i,t,r),"react-datepicker__quarter-text--range-start":e.isRangeStartQuarter(t),"react-datepicker__quarter-text--range-end":e.isRangeEndQuarter(t)})})),St(It(e),"getMonthContent",(function(t){var n=e.props,r=n.showFullMonthYearPicker,o=n.renderMonthContent,i=n.locale,a=n.day,s=rn(t,i),c=nn(t,i);return o?o(t,s,c,a):r?c:s})),St(It(e),"getQuarterContent",(function(t){var n=e.props,r=n.renderQuarterContent,o=function(e,t){return Bt(He.default(jt(),e),"QQQ",t)}(t,n.locale);return r?r(t,o):o})),St(It(e),"renderMonths",(function(){var t=e.props,n=t.showTwoColumnMonthYearPicker,r=t.showFourColumnMonthYearPicker,o=t.day,i=t.selected;return Kn[Yn(r,n)].grid.map((function(t,n){return de.default.createElement("div",{className:"react-datepicker__month-wrapper",key:n},t.map((function(t,n){return de.default.createElement("div",{ref:e.MONTH_REFS[t],key:n,onClick:function(n){e.onMonthClick(n,t)},onKeyDown:function(n){e.onMonthKeyDown(n,t)},onMouseEnter:function(){return e.onMonthMouseEnter(t)},tabIndex:e.getTabIndex(t),className:e.getMonthClassNames(t),role:"option","aria-label":e.getAriaLabel(t),"aria-current":e.isCurrentMonth(o,t)?"date":void 0,"aria-selected":e.isSelectedMonth(o,t,i)},e.getMonthContent(t))})))}))})),St(It(e),"renderQuarters",(function(){var t=e.props,n=t.day,r=t.selected;return de.default.createElement("div",{className:"react-datepicker__quarter-wrapper"},[1,2,3,4].map((function(t,o){return de.default.createElement("div",{key:o,ref:e.QUARTER_REFS[o],role:"option",onClick:function(n){e.onQuarterClick(n,t)},onKeyDown:function(n){e.onQuarterKeyDown(n,t)},onMouseEnter:function(){return e.onQuarterMouseEnter(t)},className:e.getQuarterClassNames(t),"aria-selected":e.isSelectedQuarter(n,t,r),tabIndex:e.getQuarterTabIndex(t),"aria-current":e.isCurrentQuarter(n,t)?"date":void 0},e.getQuarterContent(t))})))})),St(It(e),"getClassNames",(function(){var t=e.props,n=t.selectingDate,r=t.selectsStart,o=t.selectsEnd,i=t.showMonthYearPicker,a=t.showQuarterYearPicker,s=t.showWeekPicker;return pe.default("react-datepicker__month",{"react-datepicker__month--selecting-range":n&&(r||o)},{"react-datepicker__monthPicker":i},{"react-datepicker__quarterPicker":a},{"react-datepicker__weekPicker":s})})),e}return Tt(n,[{key:"render",value:function(){var e=this.props,t=e.showMonthYearPicker,n=e.showQuarterYearPicker,r=e.day,o=e.ariaLabelPrefix,i=void 0===o?"month ":o;return de.default.createElement("div",{className:this.getClassNames(),onMouseLeave:this.handleMouseLeave,"aria-label":"".concat(i," ").concat(Bt(r,"yyyy-MM")),role:"listbox"},t?this.renderMonths():n?this.renderQuarters():this.renderWeeks())}}]),n}(de.default.Component),Xn=function(e){Rt(n,e);var t=At(n);function n(){var e;_t(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return St(It(e=t.call.apply(t,[this].concat(o))),"state",{height:null}),St(It(e),"scrollToTheSelectedTime",(function(){requestAnimationFrame((function(){e.list&&(e.list.scrollTop=e.centerLi&&n.calcCenterPosition(e.props.monthRef?e.props.monthRef.clientHeight-e.header.clientHeight:e.list.clientHeight,e.centerLi))}))})),St(It(e),"handleClick",(function(t){(e.props.minTime||e.props.maxTime)&&vn(t,e.props)||(e.props.excludeTimes||e.props.includeTimes||e.props.filterTime)&&mn(t,e.props)||e.props.onChange(t)})),St(It(e),"isSelectedTime",(function(t){return e.props.selected&&(n=t,In(e.props.selected).getTime()===In(n).getTime());var n})),St(It(e),"isDisabledTime",(function(t){return(e.props.minTime||e.props.maxTime)&&vn(t,e.props)||(e.props.excludeTimes||e.props.includeTimes||e.props.filterTime)&&mn(t,e.props)})),St(It(e),"liClasses",(function(t){var n=["react-datepicker__time-list-item",e.props.timeClassName?e.props.timeClassName(t):void 0];return e.isSelectedTime(t)&&n.push("react-datepicker__time-list-item--selected"),e.isDisabledTime(t)&&n.push("react-datepicker__time-list-item--disabled"),e.props.injectTimes&&(60*Ne.default(t)+Ae.default(t))%e.props.intervals!=0&&n.push("react-datepicker__time-list-item--injected"),n.join(" ")})),St(It(e),"handleOnKeyDown",(function(t,n){" "===t.key&&(t.preventDefault(),t.key="Enter"),"ArrowUp"!==t.key&&"ArrowLeft"!==t.key||!t.target.previousSibling||(t.preventDefault(),t.target.previousSibling.focus()),"ArrowDown"!==t.key&&"ArrowRight"!==t.key||!t.target.nextSibling||(t.preventDefault(),t.target.nextSibling.focus()),"Enter"===t.key&&e.handleClick(n),e.props.handleOnKeyDown(t)})),St(It(e),"renderTimes",(function(){for(var t,n=[],r=e.props.format?e.props.format:"p",o=e.props.intervals,i=e.props.selected||e.props.openToDate||jt(),a=(t=i,Xe.default(t)),s=e.props.injectTimes&&e.props.injectTimes.sort((function(e,t){return e-t})),c=60*function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+n-+t)/36e5)}(i),l=c/o,u=0;u<l;u++){var d=ve.default(a,u*o);if(n.push(d),s){var p=Rn(a,d,u,o,s);n=n.concat(p)}}var h=n.reduce((function(e,t){return t.getTime()<=i.getTime()?t:e}),n[0]);return n.map((function(t,n){return de.default.createElement("li",{key:n,onClick:e.handleClick.bind(It(e),t),className:e.liClasses(t),ref:function(n){t===h&&(e.centerLi=n)},onKeyDown:function(n){e.handleOnKeyDown(n,t)},tabIndex:t===h?0:-1,role:"option","aria-selected":e.isSelectedTime(t)?"true":void 0,"aria-disabled":e.isDisabledTime(t)?"true":void 0},Bt(t,r,e.props.locale))}))})),e}return Tt(n,[{key:"componentDidMount",value:function(){this.scrollToTheSelectedTime(),this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})}},{key:"render",value:function(){var e=this,t=this.state.height;return de.default.createElement("div",{className:"react-datepicker__time-container ".concat(this.props.todayButton?"react-datepicker__time-container--with-today-button":"")},de.default.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(this.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(t){e.header=t}},de.default.createElement("div",{className:"react-datepicker-time__header"},this.props.timeCaption)),de.default.createElement("div",{className:"react-datepicker__time"},de.default.createElement("div",{className:"react-datepicker__time-box"},de.default.createElement("ul",{className:"react-datepicker__time-list",ref:function(t){e.list=t},style:t?{height:t}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))}}],[{key:"defaultProps",get:function(){return{intervals:30,onTimeChange:function(){},todayButton:null,timeCaption:"Time"}}}]),n}(de.default.Component);St(Xn,"calcCenterPosition",(function(e,t){return t.offsetTop-(e/2-t.clientHeight/2)}));var Jn=function(e){Rt(n,e);var t=At(n);function n(e){var r;return _t(this,n),St(It(r=t.call(this,e)),"YEAR_REFS",Nt(Array(r.props.yearItemNumber)).map((function(){return de.default.createRef()}))),St(It(r),"isDisabled",(function(e){return on(e,r.props)})),St(It(r),"isExcluded",(function(e){return an(e,r.props)})),St(It(r),"selectingDate",(function(){var e;return null!==(e=r.props.selectingDate)&&void 0!==e?e:r.props.preSelection})),St(It(r),"updateFocusOnPaginate",(function(e){var t=function(){this.YEAR_REFS[e].current.focus()}.bind(It(r));window.requestAnimationFrame(t)})),St(It(r),"handleYearClick",(function(e,t){r.props.onDayClick&&r.props.onDayClick(e,t)})),St(It(r),"handleYearNavigation",(function(e,t){var n=r.props,o=n.date,i=n.yearItemNumber,a=wn(o,i).startPeriod;r.isDisabled(t)||r.isExcluded(t)||(r.props.setPreSelection(t),e-a==-1?r.updateFocusOnPaginate(i-1):e-a===i?r.updateFocusOnPaginate(0):r.YEAR_REFS[e-a].current.focus())})),St(It(r),"isSameDay",(function(e,t){return Zt(e,t)})),St(It(r),"isCurrentYear",(function(e){return e===xe.default(jt())})),St(It(r),"isRangeStart",(function(e){return r.props.startDate&&r.props.endDate&&zt(Ge.default(jt(),e),r.props.startDate)})),St(It(r),"isRangeEnd",(function(e){return r.props.startDate&&r.props.endDate&&zt(Ge.default(jt(),e),r.props.endDate)})),St(It(r),"isInRange",(function(e){return un(e,r.props.startDate,r.props.endDate)})),St(It(r),"isInSelectingRange",(function(e){var t=r.props,n=t.selectsStart,o=t.selectsEnd,i=t.selectsRange,a=t.startDate,s=t.endDate;return!(!(n||o||i)||!r.selectingDate())&&(n&&s?un(e,r.selectingDate(),s):(o&&a||!(!i||!a||s))&&un(e,a,r.selectingDate()))})),St(It(r),"isSelectingRangeStart",(function(e){if(!r.isInSelectingRange(e))return!1;var t=r.props,n=t.startDate,o=t.selectsStart;return zt(Ge.default(jt(),e),o?r.selectingDate():n)})),St(It(r),"isSelectingRangeEnd",(function(e){if(!r.isInSelectingRange(e))return!1;var t=r.props,n=t.endDate,o=t.selectsEnd,i=t.selectsRange;return zt(Ge.default(jt(),e),o||i?r.selectingDate():n)})),St(It(r),"isKeyboardSelected",(function(e){var t=qt(Ge.default(r.props.date,e));return!r.props.disabledKeyboardNavigation&&!r.props.inline&&!Zt(t,qt(r.props.selected))&&Zt(t,qt(r.props.preSelection))})),St(It(r),"onYearClick",(function(e,t){var n=r.props.date;r.handleYearClick(qt(Ge.default(n,t)),e)})),St(It(r),"onYearKeyDown",(function(e,t){var n=e.key;if(!r.props.disabledKeyboardNavigation)switch(n){case"Enter":r.onYearClick(e,t),r.props.setPreSelection(r.props.selected);break;case"ArrowRight":r.handleYearNavigation(t+1,Te.default(r.props.preSelection,1));break;case"ArrowLeft":r.handleYearNavigation(t-1,we.default(r.props.preSelection,1))}})),St(It(r),"getYearClassNames",(function(e){var t=r.props,n=t.minDate,o=t.maxDate,i=t.selected,a=t.excludeDates,s=t.includeDates,c=t.filterDate;return pe.default("react-datepicker__year-text",{"react-datepicker__year-text--selected":e===xe.default(i),"react-datepicker__year-text--disabled":(n||o||a||s||c)&&dn(e,r.props),"react-datepicker__year-text--keyboard-selected":r.isKeyboardSelected(e),"react-datepicker__year-text--range-start":r.isRangeStart(e),"react-datepicker__year-text--range-end":r.isRangeEnd(e),"react-datepicker__year-text--in-range":r.isInRange(e),"react-datepicker__year-text--in-selecting-range":r.isInSelectingRange(e),"react-datepicker__year-text--selecting-range-start":r.isSelectingRangeStart(e),"react-datepicker__year-text--selecting-range-end":r.isSelectingRangeEnd(e),"react-datepicker__year-text--today":r.isCurrentYear(e)})})),St(It(r),"getYearTabIndex",(function(e){return r.props.disabledKeyboardNavigation?"-1":e===xe.default(r.props.preSelection)?"0":"-1"})),St(It(r),"getYearContainerClassNames",(function(){var e=r.props,t=e.selectingDate,n=e.selectsStart,o=e.selectsEnd,i=e.selectsRange;return pe.default("react-datepicker__year",{"react-datepicker__year--selecting-range":t&&(n||o||i)})})),St(It(r),"getYearContent",(function(e){return r.props.renderYearContent?r.props.renderYearContent(e):e})),r}return Tt(n,[{key:"render",value:function(){for(var e=this,t=[],n=this.props,r=n.date,o=n.yearItemNumber,i=n.onYearMouseEnter,a=n.onYearMouseLeave,s=wn(r,o),c=s.startPeriod,l=s.endPeriod,u=function(n){t.push(de.default.createElement("div",{ref:e.YEAR_REFS[n-c],onClick:function(t){e.onYearClick(t,n)},onKeyDown:function(t){e.onYearKeyDown(t,n)},tabIndex:e.getYearTabIndex(n),className:e.getYearClassNames(n),onMouseEnter:function(e){return i(e,n)},onMouseLeave:function(e){return a(e,n)},key:n,"aria-current":e.isCurrentYear(n)?"date":void 0},e.getYearContent(n)))},d=c;d<=l;d++)u(d);return de.default.createElement("div",{className:this.getYearContainerClassNames()},de.default.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.clearSelectingDate},t))}}]),n}(de.default.Component),Zn=function(e){Rt(n,e);var t=At(n);function n(e){var r;return _t(this,n),St(It(r=t.call(this,e)),"onTimeChange",(function(e){r.setState({time:e});var t=r.props.date,n=t instanceof Date&&!isNaN(t)?t:new Date;n.setHours(e.split(":")[0]),n.setMinutes(e.split(":")[1]),r.props.onChange(n)})),St(It(r),"renderTimeInput",(function(){var e=r.state.time,t=r.props,n=t.date,o=t.timeString,i=t.customTimeInput;return i?de.default.cloneElement(i,{date:n,value:e,onChange:r.onTimeChange}):de.default.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",required:!0,value:e,onChange:function(e){r.onTimeChange(e.target.value||o)}})})),r.state={time:r.props.timeString},r}return Tt(n,[{key:"render",value:function(){return de.default.createElement("div",{className:"react-datepicker__input-time-container"},de.default.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),de.default.createElement("div",{className:"react-datepicker-time__input-container"},de.default.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.timeString!==t.time?{time:e.timeString}:null}}]),n}(de.default.Component);function Qn(e){var t=e.className,n=e.children,r=e.showPopperArrow,o=e.arrowProps,i=void 0===o?{}:o;return de.default.createElement("div",{className:t},r&&de.default.createElement("div",Ot({className:"react-datepicker__triangle"},i)),n)}var $n=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],er=function(e){Rt(n,e);var t=At(n);function n(e){var r;return _t(this,n),St(It(r=t.call(this,e)),"handleClickOutside",(function(e){r.props.onClickOutside(e)})),St(It(r),"setClickOutsideRef",(function(){return r.containerRef.current})),St(It(r),"handleDropdownFocus",(function(e){(function(){var e=((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).className||"").split(/\s+/);return $n.some((function(t){return e.indexOf(t)>=0}))})(e.target)&&r.props.onDropdownFocus()})),St(It(r),"getDateInView",(function(){var e=r.props,t=e.preSelection,n=e.selected,o=e.openToDate,i=bn(r.props),a=Tn(r.props),s=jt();return o||n||t||(i&&lt.default(s,i)?i:a&&ct.default(s,a)?a:s)})),St(It(r),"increaseMonth",(function(){r.setState((function(e){var t=e.date;return{date:_e.default(t,1)}}),(function(){return r.handleMonthChange(r.state.date)}))})),St(It(r),"decreaseMonth",(function(){r.setState((function(e){var t=e.date;return{date:Re.default(t,1)}}),(function(){return r.handleMonthChange(r.state.date)}))})),St(It(r),"handleDayClick",(function(e,t,n){r.props.onSelect(e,t,n),r.props.setPreSelection&&r.props.setPreSelection(e)})),St(It(r),"handleDayMouseEnter",(function(e){r.setState({selectingDate:e}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(e)})),St(It(r),"handleMonthMouseLeave",(function(){r.setState({selectingDate:null}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()})),St(It(r),"handleYearMouseEnter",(function(e,t){r.setState({selectingDate:Ge.default(jt(),t)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(e,t)})),St(It(r),"handleYearMouseLeave",(function(e,t){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(e,t)})),St(It(r),"handleYearChange",(function(e){r.props.onYearChange&&(r.props.onYearChange(e),r.setState({isRenderAriaLiveMessage:!0})),r.props.adjustDateOnChange&&(r.props.onSelect&&r.props.onSelect(e),r.props.setOpen&&r.props.setOpen(!0)),r.props.setPreSelection&&r.props.setPreSelection(e)})),St(It(r),"handleMonthChange",(function(e){r.handleCustomMonthChange(e),r.props.adjustDateOnChange&&(r.props.onSelect&&r.props.onSelect(e),r.props.setOpen&&r.props.setOpen(!0)),r.props.setPreSelection&&r.props.setPreSelection(e)})),St(It(r),"handleCustomMonthChange",(function(e){r.props.onMonthChange&&(r.props.onMonthChange(e),r.setState({isRenderAriaLiveMessage:!0}))})),St(It(r),"handleMonthYearChange",(function(e){r.handleYearChange(e),r.handleMonthChange(e)})),St(It(r),"changeYear",(function(e){r.setState((function(t){var n=t.date;return{date:Ge.default(n,e)}}),(function(){return r.handleYearChange(r.state.date)}))})),St(It(r),"changeMonth",(function(e){r.setState((function(t){var n=t.date;return{date:Ve.default(n,e)}}),(function(){return r.handleMonthChange(r.state.date)}))})),St(It(r),"changeMonthYear",(function(e){r.setState((function(t){var n=t.date;return{date:Ge.default(Ve.default(n,Me.default(e)),xe.default(e))}}),(function(){return r.handleMonthYearChange(r.state.date)}))})),St(It(r),"header",(function(){var e=Gt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.state.date,r.props.locale,r.props.calendarStartDay),t=[];return r.props.showWeekNumbers&&t.push(de.default.createElement("div",{key:"W",className:"react-datepicker__day-name"},r.props.weekLabel||"#")),t.concat([0,1,2,3,4,5,6].map((function(t){var n=Ee.default(e,t),o=r.formatWeekday(n,r.props.locale),i=r.props.weekDayClassName?r.props.weekDayClassName(n):void 0;return de.default.createElement("div",{key:t,className:pe.default("react-datepicker__day-name",i)},o)})))})),St(It(r),"formatWeekday",(function(e,t){return r.props.formatWeekDay?function(e,t,n){return t(Bt(e,"EEEE",n))}(e,r.props.formatWeekDay,t):r.props.useWeekdaysShort?function(e,t){return Bt(e,"EEE",t)}(e,t):function(e,t){return Bt(e,"EEEEEE",t)}(e,t)})),St(It(r),"decreaseYear",(function(){r.setState((function(e){var t=e.date;return{date:we.default(t,r.props.showYearPicker?r.props.yearItemNumber:1)}}),(function(){return r.handleYearChange(r.state.date)}))})),St(It(r),"clearSelectingDate",(function(){r.setState({selectingDate:null})})),St(It(r),"renderPreviousButton",(function(){if(!r.props.renderCustomHeader){var e;switch(!0){case r.props.showMonthYearPicker:e=yn(r.state.date,r.props);break;case r.props.showYearPicker:e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.yearItemNumber,o=void 0===r?xt:r,i=wn(qt(we.default(e,o)),o).endPeriod,a=n&&xe.default(n);return a&&a>i||!1}(r.state.date,r.props);break;default:e=gn(r.state.date,r.props)}if((r.props.forceShowMonthNavigation||r.props.showDisabledMonthNavigation||!e)&&!r.props.showTimeSelectOnly){var t=["react-datepicker__navigation","react-datepicker__navigation--previous"],n=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(n=r.decreaseYear),e&&r.props.showDisabledMonthNavigation&&(t.push("react-datepicker__navigation--previous--disabled"),n=null);var o=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,i=r.props,a=i.previousMonthButtonLabel,s=i.previousYearButtonLabel,c=r.props,l=c.previousMonthAriaLabel,u=void 0===l?"string"==typeof a?a:"Previous Month":l,d=c.previousYearAriaLabel,p=void 0===d?"string"==typeof s?s:"Previous Year":d;return de.default.createElement("button",{type:"button",className:t.join(" "),onClick:n,onKeyDown:r.props.handleOnKeyDown,"aria-label":o?p:u},de.default.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"].join(" ")},o?r.props.previousYearButtonLabel:r.props.previousMonthButtonLabel))}}})),St(It(r),"increaseYear",(function(){r.setState((function(e){var t=e.date;return{date:Te.default(t,r.props.showYearPicker?r.props.yearItemNumber:1)}}),(function(){return r.handleYearChange(r.state.date)}))})),St(It(r),"renderNextButton",(function(){if(!r.props.renderCustomHeader){var e;switch(!0){case r.props.showMonthYearPicker:e=_n(r.state.date,r.props);break;case r.props.showYearPicker:e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.maxDate,r=t.yearItemNumber,o=void 0===r?xt:r,i=wn(Te.default(e,o),o).startPeriod,a=n&&xe.default(n);return a&&a<i||!1}(r.state.date,r.props);break;default:e=En(r.state.date,r.props)}if((r.props.forceShowMonthNavigation||r.props.showDisabledMonthNavigation||!e)&&!r.props.showTimeSelectOnly){var t=["react-datepicker__navigation","react-datepicker__navigation--next"];r.props.showTimeSelect&&t.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&t.push("react-datepicker__navigation--next--with-today-button");var n=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(n=r.increaseYear),e&&r.props.showDisabledMonthNavigation&&(t.push("react-datepicker__navigation--next--disabled"),n=null);var o=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,i=r.props,a=i.nextMonthButtonLabel,s=i.nextYearButtonLabel,c=r.props,l=c.nextMonthAriaLabel,u=void 0===l?"string"==typeof a?a:"Next Month":l,d=c.nextYearAriaLabel,p=void 0===d?"string"==typeof s?s:"Next Year":d;return de.default.createElement("button",{type:"button",className:t.join(" "),onClick:n,onKeyDown:r.props.handleOnKeyDown,"aria-label":o?p:u},de.default.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"].join(" ")},o?r.props.nextYearButtonLabel:r.props.nextMonthButtonLabel))}}})),St(It(r),"renderCurrentMonth",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.state.date,t=["react-datepicker__current-month"];return r.props.showYearDropdown&&t.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&t.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&t.push("react-datepicker__current-month--hasMonthYearDropdown"),de.default.createElement("div",{className:t.join(" ")},Bt(e,r.props.dateFormat,r.props.locale))})),St(It(r),"renderYearDropdown",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(r.props.showYearDropdown&&!e)return de.default.createElement(Pn,{adjustDateOnChange:r.props.adjustDateOnChange,date:r.state.date,onSelect:r.props.onSelect,setOpen:r.props.setOpen,dropdownMode:r.props.dropdownMode,onChange:r.changeYear,minDate:r.props.minDate,maxDate:r.props.maxDate,year:xe.default(r.state.date),scrollableYearDropdown:r.props.scrollableYearDropdown,yearDropdownItemNumber:r.props.yearDropdownItemNumber})})),St(It(r),"renderMonthDropdown",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(r.props.showMonthDropdown&&!e)return de.default.createElement(Ln,{dropdownMode:r.props.dropdownMode,locale:r.props.locale,onChange:r.changeMonth,month:Me.default(r.state.date),useShortMonthInDropdown:r.props.useShortMonthInDropdown})})),St(It(r),"renderMonthYearDropdown",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(r.props.showMonthYearDropdown&&!e)return de.default.createElement(Fn,{dropdownMode:r.props.dropdownMode,locale:r.props.locale,dateFormat:r.props.dateFormat,onChange:r.changeMonthYear,minDate:r.props.minDate,maxDate:r.props.maxDate,date:r.state.date,scrollableMonthYearDropdown:r.props.scrollableMonthYearDropdown})})),St(It(r),"handleTodayButtonClick",(function(e){r.props.onSelect(Yt(),e),r.props.setPreSelection&&r.props.setPreSelection(Yt())})),St(It(r),"renderTodayButton",(function(){if(r.props.todayButton&&!r.props.showTimeSelectOnly)return de.default.createElement("div",{className:"react-datepicker__today-button",onClick:function(e){return r.handleTodayButtonClick(e)}},r.props.todayButton)})),St(It(r),"renderDefaultHeader",(function(e){var t=e.monthDate,n=e.i;return de.default.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(t),de.default.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(0!==n),r.renderMonthYearDropdown(0!==n),r.renderYearDropdown(0!==n)),de.default.createElement("div",{className:"react-datepicker__day-names"},r.header(t)))})),St(It(r),"renderCustomHeader",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.monthDate,n=e.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var o=gn(r.state.date,r.props),i=En(r.state.date,r.props),a=yn(r.state.date,r.props),s=_n(r.state.date,r.props),c=!r.props.showMonthYearPicker&&!r.props.showQuarterYearPicker&&!r.props.showYearPicker;return de.default.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},r.props.renderCustomHeader(Et(Et({},r.state),{},{customHeaderCount:n,monthDate:t,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:o,nextMonthButtonDisabled:i,prevYearButtonDisabled:a,nextYearButtonDisabled:s})),c&&de.default.createElement("div",{className:"react-datepicker__day-names"},r.header(t)))})),St(It(r),"renderYearHeader",(function(){var e=r.state.date,t=r.props,n=t.showYearPicker,o=wn(e,t.yearItemNumber),i=o.startPeriod,a=o.endPeriod;return de.default.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},n?"".concat(i," - ").concat(a):xe.default(e))})),St(It(r),"renderHeader",(function(e){switch(!0){case void 0!==r.props.renderCustomHeader:return r.renderCustomHeader(e);case r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker:return r.renderYearHeader(e);default:return r.renderDefaultHeader(e)}})),St(It(r),"renderMonths",(function(){var e;if(!r.props.showTimeSelectOnly&&!r.props.showYearPicker){for(var t=[],n=r.props.showPreviousMonths?r.props.monthsShown-1:0,o=Re.default(r.state.date,n),i=null!==(e=r.props.monthSelectedIn)&&void 0!==e?e:n,a=0;a<r.props.monthsShown;++a){var s=a-i+n,c=_e.default(o,s),l="month-".concat(a),u=a<r.props.monthsShown-1,d=a>0;t.push(de.default.createElement("div",{key:l,ref:function(e){r.monthContainer=e},className:"react-datepicker__month-container"},r.renderHeader({monthDate:c,i:a}),de.default.createElement(zn,{chooseDayAriaLabelPrefix:r.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:r.props.disabledDayAriaLabelPrefix,weekAriaLabelPrefix:r.props.weekAriaLabelPrefix,ariaLabelPrefix:r.props.monthAriaLabelPrefix,onChange:r.changeMonthYear,day:c,dayClassName:r.props.dayClassName,calendarStartDay:r.props.calendarStartDay,monthClassName:r.props.monthClassName,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,onWeekSelect:r.props.onWeekSelect,orderInDisplay:a,formatWeekNumber:r.props.formatWeekNumber,locale:r.props.locale,minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,highlightDates:r.props.highlightDates,holidays:r.props.holidays,selectingDate:r.state.selectingDate,includeDates:r.props.includeDates,includeDateIntervals:r.props.includeDateIntervals,inline:r.props.inline,shouldFocusDayInline:r.props.shouldFocusDayInline,fixedHeight:r.props.fixedHeight,filterDate:r.props.filterDate,preSelection:r.props.preSelection,setPreSelection:r.props.setPreSelection,selected:r.props.selected,selectsStart:r.props.selectsStart,selectsEnd:r.props.selectsEnd,selectsRange:r.props.selectsRange,selectsDisabledDaysInRange:r.props.selectsDisabledDaysInRange,showWeekNumbers:r.props.showWeekNumbers,startDate:r.props.startDate,endDate:r.props.endDate,peekNextMonth:r.props.peekNextMonth,setOpen:r.props.setOpen,shouldCloseOnSelect:r.props.shouldCloseOnSelect,renderDayContents:r.props.renderDayContents,renderMonthContent:r.props.renderMonthContent,renderQuarterContent:r.props.renderQuarterContent,renderYearContent:r.props.renderYearContent,disabledKeyboardNavigation:r.props.disabledKeyboardNavigation,showMonthYearPicker:r.props.showMonthYearPicker,showFullMonthYearPicker:r.props.showFullMonthYearPicker,showTwoColumnMonthYearPicker:r.props.showTwoColumnMonthYearPicker,showFourColumnMonthYearPicker:r.props.showFourColumnMonthYearPicker,showYearPicker:r.props.showYearPicker,showQuarterYearPicker:r.props.showQuarterYearPicker,showWeekPicker:r.props.showWeekPicker,isInputFocused:r.props.isInputFocused,containerRef:r.containerRef,monthShowsDuplicateDaysEnd:u,monthShowsDuplicateDaysStart:d})))}return t}})),St(It(r),"renderYears",(function(){if(!r.props.showTimeSelectOnly)return r.props.showYearPicker?de.default.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader(),de.default.createElement(Jn,Ot({onDayClick:r.handleDayClick,selectingDate:r.state.selectingDate,clearSelectingDate:r.clearSelectingDate,date:r.state.date},r.props,{onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave}))):void 0})),St(It(r),"renderTimeSection",(function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return de.default.createElement(Xn,{selected:r.props.selected,openToDate:r.props.openToDate,onChange:r.props.onTimeChange,timeClassName:r.props.timeClassName,format:r.props.timeFormat,includeTimes:r.props.includeTimes,intervals:r.props.timeIntervals,minTime:r.props.minTime,maxTime:r.props.maxTime,excludeTimes:r.props.excludeTimes,filterTime:r.props.filterTime,timeCaption:r.props.timeCaption,todayButton:r.props.todayButton,showMonthDropdown:r.props.showMonthDropdown,showMonthYearDropdown:r.props.showMonthYearDropdown,showYearDropdown:r.props.showYearDropdown,withPortal:r.props.withPortal,monthRef:r.state.monthContainer,injectTimes:r.props.injectTimes,locale:r.props.locale,handleOnKeyDown:r.props.handleOnKeyDown,showTimeSelectOnly:r.props.showTimeSelectOnly})})),St(It(r),"renderInputTimeSection",(function(){var e=new Date(r.props.selected),t=Ft(e)&&Boolean(r.props.selected)?"".concat(Cn(e.getHours()),":").concat(Cn(e.getMinutes())):"";if(r.props.showTimeInput)return de.default.createElement(Zn,{date:e,timeString:t,timeInputLabel:r.props.timeInputLabel,onChange:r.props.onTimeChange,customTimeInput:r.props.customTimeInput})})),St(It(r),"renderAriaLiveRegion",(function(){var e,t=wn(r.state.date,r.props.yearItemNumber),n=t.startPeriod,o=t.endPeriod;return e=r.props.showYearPicker?"".concat(n," - ").concat(o):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?xe.default(r.state.date):"".concat(nn(Me.default(r.state.date),r.props.locale)," ").concat(xe.default(r.state.date)),de.default.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&e)})),St(It(r),"renderChildren",(function(){if(r.props.children)return de.default.createElement("div",{className:"react-datepicker__children-container"},r.props.children)})),r.containerRef=de.default.createRef(),r.state={date:r.getDateInView(),selectingDate:null,monthContainer:null,isRenderAriaLiveMessage:!1},r}return Tt(n,[{key:"componentDidMount",value:function(){var e=this;this.props.showTimeSelect&&(this.assignMonthContainer=void e.setState({monthContainer:e.monthContainer}))}},{key:"componentDidUpdate",value:function(e){var t=this;if(!this.props.preSelection||Zt(this.props.preSelection,e.preSelection)&&this.props.monthSelectedIn===e.monthSelectedIn)this.props.openToDate&&!Zt(this.props.openToDate,e.openToDate)&&this.setState({date:this.props.openToDate});else{var n=!Xt(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},(function(){return n&&t.handleCustomMonthChange(t.state.date)}))}}},{key:"render",value:function(){var e=this.props.container||Qn;return de.default.createElement("div",{style:{display:"contents"},ref:this.containerRef},de.default.createElement(e,{className:pe.default("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showPopperArrow:this.props.showPopperArrow,arrowProps:this.props.arrowProps},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren()))}}],[{key:"defaultProps",get:function(){return{onDropdownFocus:function(){},monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",customTimeInput:null,yearItemNumber:xt}}}]),n}(de.default.Component),tr=function(e){var t=e.icon,n=e.className,r=void 0===n?"":n,o=e.onClick,i="react-datepicker__calendar-icon";return de.default.isValidElement(t)?de.default.cloneElement(t,{className:"".concat(t.props.className||""," ").concat(i," ").concat(r),onClick:function(e){"function"==typeof t.props.onClick&&t.props.onClick(e),"function"==typeof o&&o(e)}}):"string"==typeof t?de.default.createElement("i",{className:"".concat(i," ").concat(t," ").concat(r),"aria-hidden":"true",onClick:o}):de.default.createElement("svg",{className:"".concat(i," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:o},de.default.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},nr=function(e){Rt(n,e);var t=At(n);function n(e){var r;return _t(this,n),(r=t.call(this,e)).el=document.createElement("div"),r}return Tt(n,[{key:"componentDidMount",value:function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){this.portalRoot.removeChild(this.el)}},{key:"render",value:function(){return mt.default.createPortal(this.props.children,this.el)}}]),n}(de.default.Component),rr=function(e){return!e.disabled&&-1!==e.tabIndex},or=function(e){Rt(n,e);var t=At(n);function n(e){var r;return _t(this,n),St(It(r=t.call(this,e)),"getTabChildren",(function(){return Array.prototype.slice.call(r.tabLoopRef.current.querySelectorAll("[tabindex], a, button, input, select, textarea"),1,-1).filter(rr)})),St(It(r),"handleFocusStart",(function(){var e=r.getTabChildren();e&&e.length>1&&e[e.length-1].focus()})),St(It(r),"handleFocusEnd",(function(){var e=r.getTabChildren();e&&e.length>1&&e[0].focus()})),r.tabLoopRef=de.default.createRef(),r}return Tt(n,[{key:"render",value:function(){return this.props.enableTabLoop?de.default.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},de.default.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:"0",onFocus:this.handleFocusStart}),this.props.children,de.default.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:"0",onFocus:this.handleFocusEnd})):this.props.children}}],[{key:"defaultProps",get:function(){return{enableTabLoop:!0}}}]),n}(de.default.Component),ir=function(e){Rt(n,e);var t=At(n);function n(){return _t(this,n),t.apply(this,arguments)}return Tt(n,[{key:"render",value:function(){var e,t=this.props,n=t.className,r=t.wrapperClassName,o=t.hidePopper,i=t.popperComponent,a=t.popperModifiers,s=t.popperPlacement,c=t.popperProps,l=t.targetComponent,u=t.enableTabLoop,d=t.popperOnKeyDown,p=t.portalId,h=t.portalHost;if(!o){var f=pe.default("react-datepicker-popper",n);e=de.default.createElement(ce.Popper,Ot({modifiers:a,placement:s},c),(function(e){var t=e.ref,n=e.style,r=e.placement,o=e.arrowProps;return de.default.createElement(or,{enableTabLoop:u},de.default.createElement("div",{ref:t,style:n,className:f,"data-placement":r,onKeyDown:d},de.default.cloneElement(i,{arrowProps:o})))}))}this.props.popperContainer&&(e=de.default.createElement(this.props.popperContainer,{},e)),p&&!o&&(e=de.default.createElement(nr,{portalId:p,portalHost:h},e));var m=pe.default("react-datepicker-wrapper",r);return de.default.createElement(ce.Manager,{className:"react-datepicker-manager"},de.default.createElement(ce.Reference,null,(function(e){var t=e.ref;return de.default.createElement("div",{ref:t,className:m},l)})),e)}}],[{key:"defaultProps",get:function(){return{hidePopper:!0,popperModifiers:[],popperProps:{},popperPlacement:"bottom-start"}}}]),n}(de.default.Component),ar="react-datepicker-ignore-onclickoutside",sr=ft.default(er),cr="Date input not valid.",lr=function(e){Rt(n,e);var t=At(n);function n(e){var r;return _t(this,n),St(It(r=t.call(this,e)),"getPreSelection",(function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:jt()})),St(It(r),"modifyHolidays",(function(){var e;return null===(e=r.props.holidays)||void 0===e?void 0:e.reduce((function(e,t){var n=new Date(t.date);return fe.default(n)?[].concat(Nt(e),[Et(Et({},t),{},{date:n})]):e}),[])})),St(It(r),"calcInitialState",(function(){var e,t=r.getPreSelection(),n=bn(r.props),o=Tn(r.props),i=n&&lt.default(t,Xe.default(n))?n:o&&ct.default(t,et.default(o))?o:t;return{open:r.props.startOpen||!1,preventFocus:!1,preSelection:null!==(e=r.props.selectsRange?r.props.startDate:r.props.selected)&&void 0!==e?e:i,highlightDates:Sn(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1}})),St(It(r),"clearPreventFocusTimeout",(function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)})),St(It(r),"setFocus",(function(){r.input&&r.input.focus&&r.input.focus({preventScroll:!0})})),St(It(r),"setBlur",(function(){r.input&&r.input.blur&&r.input.blur(),r.cancelFocusInput()})),St(It(r),"setOpen",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r.setState({open:e,preSelection:e&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:dr},(function(){e||r.setState((function(e){return{focused:!!t&&e.focused}}),(function(){!t&&r.setBlur(),r.setState({inputValue:null})}))}))})),St(It(r),"inputOk",(function(){return he.default(r.state.preSelection)})),St(It(r),"isCalendarOpen",(function(){return void 0===r.props.open?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open})),St(It(r),"handleFocus",(function(e){r.state.preventFocus||(r.props.onFocus(e),r.props.preventOpenOnFocus||r.props.readOnly||r.setOpen(!0)),r.setState({focused:!0})})),St(It(r),"sendFocusBackToInput",(function(){r.preventFocusTimeout&&r.clearPreventFocusTimeout(),r.setState({preventFocus:!0},(function(){r.preventFocusTimeout=setTimeout((function(){r.setFocus(),r.setState({preventFocus:!1})}))}))})),St(It(r),"cancelFocusInput",(function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=null})),St(It(r),"deferFocusInput",(function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout((function(){return r.setFocus()}),1)})),St(It(r),"handleDropdownFocus",(function(){r.cancelFocusInput()})),St(It(r),"handleBlur",(function(e){(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&r.props.onBlur(e),r.setState({focused:!1})})),St(It(r),"handleCalendarClickOutside",(function(e){r.props.inline||r.setOpen(!1),r.props.onClickOutside(e),r.props.withPortal&&e.preventDefault()})),St(It(r),"handleChange",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=t[0];if(!r.props.onChangeRaw||(r.props.onChangeRaw.apply(It(r),t),"function"==typeof o.isDefaultPrevented&&!o.isDefaultPrevented())){r.setState({inputValue:o.target.value,lastPreSelectChange:ur});var i,a,s,c,l,u,d,p,h=(i=o.target.value,a=r.props.dateFormat,s=r.props.locale,c=r.props.strictParsing,l=r.props.minDate,u=null,d=tn(s)||tn(en()),p=!0,Array.isArray(a)?(a.forEach((function(e){var t=pt.default(i,e,new Date,{locale:d});c&&(p=Ft(t,l)&&i===Bt(t,e,s)),Ft(t,l)&&p&&(u=t)})),u):(u=pt.default(i,a,new Date,{locale:d}),c?p=Ft(u)&&i===Bt(u,a,s):Ft(u)||(a=a.match(Ut).map((function(e){var t=e[0];return"p"===t||"P"===t?d?(0,Lt[t])(e,d.formatLong):t:e})).join(""),i.length>0&&(u=pt.default(i,a.slice(0,i.length),new Date)),Ft(u)||(u=new Date(i))),Ft(u)&&p?u:null));r.props.showTimeSelectOnly&&r.props.selected&&h&&!Zt(h,r.props.selected)&&(h=vt.default(r.props.selected,{hours:Ne.default(h),minutes:Ae.default(h),seconds:Ie.default(h)})),!h&&o.target.value||(r.props.showWeekPicker&&(h=Gt(h,r.props.locale,r.props.calendarStartDay)),r.setSelected(h,o,!0))}})),St(It(r),"handleSelect",(function(e,t,n){if(r.props.shouldCloseOnSelect&&!r.props.showTimeSelect&&r.sendFocusBackToInput(),r.props.onChangeRaw&&r.props.onChangeRaw(t),r.props.showWeekPicker&&(e=Gt(e,r.props.locale,r.props.calendarStartDay)),r.setSelected(e,t,!1,n),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect)r.setPreSelection(e);else if(!r.props.inline){r.props.selectsRange||r.setOpen(!1);var o=r.props,i=o.startDate,a=o.endDate;!i||a||lt.default(e,i)||r.setOpen(!1)}})),St(It(r),"setSelected",(function(e,t,n,o){var i=e;if(r.props.showYearPicker){if(null!==i&&dn(xe.default(i),r.props))return}else if(r.props.showMonthYearPicker){if(null!==i&&sn(i,r.props))return}else if(null!==i&&on(i,r.props))return;var a=r.props,s=a.onChange,c=a.selectsRange,l=a.startDate,u=a.endDate;if(!Qt(r.props.selected,i)||r.props.allowSameDay||c)if(null!==i&&(!r.props.selected||n&&(r.props.showTimeSelect||r.props.showTimeSelectOnly||r.props.showTimeInput)||(i=Ht(i,{hour:Ne.default(r.props.selected),minute:Ae.default(r.props.selected),second:Ie.default(r.props.selected)})),r.props.inline||r.setState({preSelection:i}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:o})),c){var d=l&&u;l||u?l&&!u&&(lt.default(i,l)?s([i,null],t):s([l,i],t)):s([i,null],t),d&&s([i,null],t)}else s(i,t);n||(r.props.onSelect(i,t),r.setState({inputValue:null}))})),St(It(r),"setPreSelection",(function(e){var t=void 0!==r.props.minDate,n=void 0!==r.props.maxDate,o=!0;if(e){r.props.showWeekPicker&&(e=Gt(e,r.props.locale,r.props.calendarStartDay));var i=Xe.default(e);if(t&&n)o=$t(e,r.props.minDate,r.props.maxDate);else if(t){var a=Xe.default(r.props.minDate);o=ct.default(e,a)||Qt(i,a)}else if(n){var s=et.default(r.props.maxDate);o=lt.default(e,s)||Qt(i,s)}}o&&r.setState({preSelection:e})})),St(It(r),"toggleCalendar",(function(){r.setOpen(!r.state.open)})),St(It(r),"handleTimeChange",(function(e){var t=r.props.selected?r.props.selected:r.getPreSelection(),n=r.props.selected?e:Ht(t,{hour:Ne.default(e),minute:Ae.default(e)});r.setState({preSelection:n}),r.props.onChange(n),r.props.shouldCloseOnSelect&&(r.sendFocusBackToInput(),r.setOpen(!1)),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})})),St(It(r),"onInputClick",(function(){r.props.disabled||r.props.readOnly||r.setOpen(!0),r.props.onInputClick()})),St(It(r),"onInputKeyDown",(function(e){r.props.onKeyDown(e);var t=e.key;if(r.state.open||r.props.inline||r.props.preventOpenOnFocus){if(r.state.open){if("ArrowDown"===t||"ArrowUp"===t){e.preventDefault();var n=r.props.showWeekPicker&&r.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',o=r.calendar.componentNode&&r.calendar.componentNode.querySelector(n);return void(o&&o.focus({preventScroll:!0}))}var i=jt(r.state.preSelection);"Enter"===t?(e.preventDefault(),r.inputOk()&&r.state.lastPreSelectChange===dr?(r.handleSelect(i,e),!r.props.shouldCloseOnSelect&&r.setPreSelection(i)):r.setOpen(!1)):"Escape"===t?(e.preventDefault(),r.sendFocusBackToInput(),r.setOpen(!1)):"Tab"===t&&r.setOpen(!1),r.inputOk()||r.props.onInputError({code:1,msg:cr})}}else"ArrowDown"!==t&&"ArrowUp"!==t&&"Enter"!==t||r.onInputClick()})),St(It(r),"onPortalKeyDown",(function(e){"Escape"===e.key&&(e.preventDefault(),r.setState({preventFocus:!0},(function(){r.setOpen(!1),setTimeout((function(){r.setFocus(),r.setState({preventFocus:!1})}))})))})),St(It(r),"onDayKeyDown",(function(e){r.props.onKeyDown(e);var t=e.key,n=jt(r.state.preSelection);if("Enter"===t)e.preventDefault(),r.handleSelect(n,e),!r.props.shouldCloseOnSelect&&r.setPreSelection(n);else if("Escape"===t)e.preventDefault(),r.setOpen(!1),r.inputOk()||r.props.onInputError({code:1,msg:cr});else if(!r.props.disabledKeyboardNavigation){var o;switch(t){case"ArrowLeft":o=r.props.showWeekPicker?Oe.default(n,1):Se.default(n,1);break;case"ArrowRight":o=r.props.showWeekPicker?ye.default(n,1):Ee.default(n,1);break;case"ArrowUp":o=Oe.default(n,1);break;case"ArrowDown":o=ye.default(n,1);break;case"PageUp":o=Re.default(n,1);break;case"PageDown":o=_e.default(n,1);break;case"Home":o=we.default(n,1);break;case"End":o=Te.default(n,1);break;default:o=null}if(!o)return void(r.props.onInputError&&r.props.onInputError({code:1,msg:cr}));if(e.preventDefault(),r.setState({lastPreSelectChange:dr}),r.props.adjustDateOnChange&&r.setSelected(o),r.setPreSelection(o),r.props.inline){var i=Me.default(n),a=Me.default(o),s=xe.default(n),c=xe.default(o);i!==a||s!==c?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}})),St(It(r),"onPopperKeyDown",(function(e){"Escape"===e.key&&(e.preventDefault(),r.sendFocusBackToInput())})),St(It(r),"onClearClick",(function(e){e&&e.preventDefault&&e.preventDefault(),r.sendFocusBackToInput(),r.props.selectsRange?r.props.onChange([null,null],e):r.props.onChange(null,e),r.setState({inputValue:null})})),St(It(r),"clear",(function(){r.onClearClick()})),St(It(r),"onScroll",(function(e){"boolean"==typeof r.props.closeOnScroll&&r.props.closeOnScroll?e.target!==document&&e.target!==document.documentElement&&e.target!==document.body||r.setOpen(!1):"function"==typeof r.props.closeOnScroll&&r.props.closeOnScroll(e)&&r.setOpen(!1)})),St(It(r),"renderCalendar",(function(){return r.props.inline||r.isCalendarOpen()?de.default.createElement(sr,{ref:function(e){r.calendar=e},locale:r.props.locale,calendarStartDay:r.props.calendarStartDay,chooseDayAriaLabelPrefix:r.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:r.props.disabledDayAriaLabelPrefix,weekAriaLabelPrefix:r.props.weekAriaLabelPrefix,monthAriaLabelPrefix:r.props.monthAriaLabelPrefix,adjustDateOnChange:r.props.adjustDateOnChange,setOpen:r.setOpen,shouldCloseOnSelect:r.props.shouldCloseOnSelect,dateFormat:r.props.dateFormatCalendar,useWeekdaysShort:r.props.useWeekdaysShort,formatWeekDay:r.props.formatWeekDay,dropdownMode:r.props.dropdownMode,selected:r.props.selected,preSelection:r.state.preSelection,onSelect:r.handleSelect,onWeekSelect:r.props.onWeekSelect,openToDate:r.props.openToDate,minDate:r.props.minDate,maxDate:r.props.maxDate,selectsStart:r.props.selectsStart,selectsEnd:r.props.selectsEnd,selectsRange:r.props.selectsRange,startDate:r.props.startDate,endDate:r.props.endDate,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,filterDate:r.props.filterDate,onClickOutside:r.handleCalendarClickOutside,formatWeekNumber:r.props.formatWeekNumber,highlightDates:r.state.highlightDates,holidays:On(r.modifyHolidays()),includeDates:r.props.includeDates,includeDateIntervals:r.props.includeDateIntervals,includeTimes:r.props.includeTimes,injectTimes:r.props.injectTimes,inline:r.props.inline,shouldFocusDayInline:r.state.shouldFocusDayInline,peekNextMonth:r.props.peekNextMonth,showMonthDropdown:r.props.showMonthDropdown,showPreviousMonths:r.props.showPreviousMonths,useShortMonthInDropdown:r.props.useShortMonthInDropdown,showMonthYearDropdown:r.props.showMonthYearDropdown,showWeekNumbers:r.props.showWeekNumbers,showYearDropdown:r.props.showYearDropdown,withPortal:r.props.withPortal,forceShowMonthNavigation:r.props.forceShowMonthNavigation,showDisabledMonthNavigation:r.props.showDisabledMonthNavigation,scrollableYearDropdown:r.props.scrollableYearDropdown,scrollableMonthYearDropdown:r.props.scrollableMonthYearDropdown,todayButton:r.props.todayButton,weekLabel:r.props.weekLabel,outsideClickIgnoreClass:ar,fixedHeight:r.props.fixedHeight,monthsShown:r.props.monthsShown,monthSelectedIn:r.state.monthSelectedIn,onDropdownFocus:r.handleDropdownFocus,onMonthChange:r.props.onMonthChange,onYearChange:r.props.onYearChange,dayClassName:r.props.dayClassName,weekDayClassName:r.props.weekDayClassName,monthClassName:r.props.monthClassName,timeClassName:r.props.timeClassName,showDateSelect:r.props.showDateSelect,showTimeSelect:r.props.showTimeSelect,showTimeSelectOnly:r.props.showTimeSelectOnly,onTimeChange:r.handleTimeChange,timeFormat:r.props.timeFormat,timeIntervals:r.props.timeIntervals,minTime:r.props.minTime,maxTime:r.props.maxTime,excludeTimes:r.props.excludeTimes,filterTime:r.props.filterTime,timeCaption:r.props.timeCaption,className:r.props.calendarClassName,container:r.props.calendarContainer,yearItemNumber:r.props.yearItemNumber,yearDropdownItemNumber:r.props.yearDropdownItemNumber,previousMonthAriaLabel:r.props.previousMonthAriaLabel,previousMonthButtonLabel:r.props.previousMonthButtonLabel,nextMonthAriaLabel:r.props.nextMonthAriaLabel,nextMonthButtonLabel:r.props.nextMonthButtonLabel,previousYearAriaLabel:r.props.previousYearAriaLabel,previousYearButtonLabel:r.props.previousYearButtonLabel,nextYearAriaLabel:r.props.nextYearAriaLabel,nextYearButtonLabel:r.props.nextYearButtonLabel,timeInputLabel:r.props.timeInputLabel,disabledKeyboardNavigation:r.props.disabledKeyboardNavigation,renderCustomHeader:r.props.renderCustomHeader,popperProps:r.props.popperProps,renderDayContents:r.props.renderDayContents,renderMonthContent:r.props.renderMonthContent,renderQuarterContent:r.props.renderQuarterContent,renderYearContent:r.props.renderYearContent,onDayMouseEnter:r.props.onDayMouseEnter,onMonthMouseLeave:r.props.onMonthMouseLeave,onYearMouseEnter:r.props.onYearMouseEnter,onYearMouseLeave:r.props.onYearMouseLeave,selectsDisabledDaysInRange:r.props.selectsDisabledDaysInRange,showTimeInput:r.props.showTimeInput,showMonthYearPicker:r.props.showMonthYearPicker,showFullMonthYearPicker:r.props.showFullMonthYearPicker,showTwoColumnMonthYearPicker:r.props.showTwoColumnMonthYearPicker,showFourColumnMonthYearPicker:r.props.showFourColumnMonthYearPicker,showYearPicker:r.props.showYearPicker,showQuarterYearPicker:r.props.showQuarterYearPicker,showWeekPicker:r.props.showWeekPicker,showPopperArrow:r.props.showPopperArrow,excludeScrollbar:r.props.excludeScrollbar,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,isInputFocused:r.state.focused,customTimeInput:r.props.customTimeInput,setPreSelection:r.setPreSelection},r.props.children):null})),St(It(r),"renderAriaLiveRegion",(function(){var e,t=r.props,n=t.dateFormat,o=t.locale,i=r.props.showTimeInput||r.props.showTimeSelect?"PPPPp":"PPPP";return e=r.props.selectsRange?"Selected start date: ".concat(Vt(r.props.startDate,{dateFormat:i,locale:o}),". ").concat(r.props.endDate?"End date: "+Vt(r.props.endDate,{dateFormat:i,locale:o}):""):r.props.showTimeSelectOnly?"Selected time: ".concat(Vt(r.props.selected,{dateFormat:n,locale:o})):r.props.showYearPicker?"Selected year: ".concat(Vt(r.props.selected,{dateFormat:"yyyy",locale:o})):r.props.showMonthYearPicker?"Selected month: ".concat(Vt(r.props.selected,{dateFormat:"MMMM yyyy",locale:o})):r.props.showQuarterYearPicker?"Selected quarter: ".concat(Vt(r.props.selected,{dateFormat:"yyyy, QQQ",locale:o})):"Selected date: ".concat(Vt(r.props.selected,{dateFormat:i,locale:o})),de.default.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},e)})),St(It(r),"renderDateInput",(function(){var e,t=pe.default(r.props.className,St({},ar,r.state.open)),n=r.props.customInput||de.default.createElement("input",{type:"text"}),o=r.props.customInputRef||"ref",i="string"==typeof r.props.value?r.props.value:"string"==typeof r.state.inputValue?r.state.inputValue:r.props.selectsRange?function(e,t,n){if(!e)return"";var r=Vt(e,n),o=t?Vt(t,n):"";return"".concat(r," - ").concat(o)}(r.props.startDate,r.props.endDate,r.props):Vt(r.props.selected,r.props);return de.default.cloneElement(n,(St(St(St(St(St(St(St(St(St(St(e={},o,(function(e){r.input=e})),"value",i),"onBlur",r.handleBlur),"onChange",r.handleChange),"onClick",r.onInputClick),"onFocus",r.handleFocus),"onKeyDown",r.onInputKeyDown),"id",r.props.id),"name",r.props.name),"form",r.props.form),St(St(St(St(St(St(St(St(St(St(e,"autoFocus",r.props.autoFocus),"placeholder",r.props.placeholderText),"disabled",r.props.disabled),"autoComplete",r.props.autoComplete),"className",pe.default(n.props.className,t)),"title",r.props.title),"readOnly",r.props.readOnly),"required",r.props.required),"tabIndex",r.props.tabIndex),"aria-describedby",r.props.ariaDescribedBy),St(St(St(e,"aria-invalid",r.props.ariaInvalid),"aria-labelledby",r.props.ariaLabelledBy),"aria-required",r.props.ariaRequired)))})),St(It(r),"renderClearButton",(function(){var e=r.props,t=e.isClearable,n=e.disabled,o=e.selected,i=e.startDate,a=e.endDate,s=e.clearButtonTitle,c=e.clearButtonClassName,l=void 0===c?"":c,u=e.ariaLabelClose,d=void 0===u?"Close":u;return!t||null==o&&null==i&&null==a?null:de.default.createElement("button",{type:"button",className:pe.default("react-datepicker__close-icon",l,{"react-datepicker__close-icon--disabled":n}),disabled:n,"aria-label":d,onClick:r.onClearClick,title:s,tabIndex:-1})})),r.state=r.calcInitialState(),r.preventFocusTimeout=null,r}return Tt(n,[{key:"componentDidMount",value:function(){window.addEventListener("scroll",this.onScroll,!0)}},{key:"componentDidUpdate",value:function(e,t){var n,r;e.inline&&(n=e.selected,r=this.props.selected,n&&r?Me.default(n)!==Me.default(r)||xe.default(n)!==xe.default(r):n!==r)&&this.setPreSelection(this.props.selected),void 0!==this.state.monthSelectedIn&&e.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),e.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:Sn(this.props.highlightDates)}),t.focused||Qt(e.selected,this.props.selected)||this.setState({inputValue:null}),t.open!==this.state.open&&(!1===t.open&&!0===this.state.open&&this.props.onCalendarOpen(),!0===t.open&&!1===this.state.open&&this.props.onCalendarClose())}},{key:"componentWillUnmount",value:function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0)}},{key:"renderInputContainer",value:function(){var e=this.props,t=e.showIcon,n=e.icon,r=e.calendarIconClassname,o=e.toggleCalendarOnIconClick,i=this.state.open;return de.default.createElement("div",{className:"react-datepicker__input-container".concat(t?" react-datepicker__view-calendar-icon":"")},t&&de.default.createElement(tr,Ot({icon:n,className:"".concat(r," ").concat(i&&"react-datepicker-ignore-onclickoutside")},o?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())}},{key:"render",value:function(){var e=this.renderCalendar();if(this.props.inline)return e;if(this.props.withPortal){var t=this.state.open?de.default.createElement(or,{enableTabLoop:this.props.enableTabLoop},de.default.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},e)):null;return this.state.open&&this.props.portalId&&(t=de.default.createElement(nr,{portalId:this.props.portalId,portalHost:this.props.portalHost},t)),de.default.createElement("div",null,this.renderInputContainer(),t)}return de.default.createElement(ir,{className:this.props.popperClassName,wrapperClassName:this.props.wrapperClassName,hidePopper:!this.isCalendarOpen(),portalId:this.props.portalId,portalHost:this.props.portalHost,popperModifiers:this.props.popperModifiers,targetComponent:this.renderInputContainer(),popperContainer:this.props.popperContainer,popperComponent:e,popperPlacement:this.props.popperPlacement,popperProps:this.props.popperProps,popperOnKeyDown:this.onPopperKeyDown,enableTabLoop:this.props.enableTabLoop})}}],[{key:"defaultProps",get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",onChange:function(){},disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",onFocus:function(){},onBlur:function(){},onKeyDown:function(){},onInputClick:function(){},onSelect:function(){},onClickOutside:function(){},onMonthChange:function(){},onCalendarOpen:function(){},onCalendarClose:function(){},preventOpenOnFocus:!1,onYearChange:function(){},onInputError:function(){},monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:xt,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1}}}]),n}(de.default.Component),ur="input",dr="navigate";e.CalendarContainer=Qn,e.default=lr,e.getDefaultLocale=en,e.registerLocale=function(e,t){var n="undefined"!=typeof window?window:globalThis;n.__localeData__||(n.__localeData__={}),n.__localeData__[e]=t},e.setDefaultLocale=function(e){("undefined"!=typeof window?window:globalThis).__localeId__=e},Object.defineProperty(e,"__esModule",{value:!0})}(t,n(2),n(31),n(27),n(422),n(423),n(821),n(673),n(674),n(306),n(428),n(244),n(429),n(430),n(675),n(676),n(677),n(678),n(679),n(680),n(681),n(682),n(683),n(684),n(823),n(685),n(686),n(687),n(688),n(689),n(690),n(691),n(329),n(692),n(693),n(694),n(695),n(696),n(697),n(698),n(307),n(431),n(699),n(432),n(700),n(701),n(702),n(703),n(704),n(705),n(706),n(707),n(708),n(709),n(710),n(711),n(712),n(126),n(818),n(713),n(714),n(19),n(817),n(717))},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(25),o=n(124);function i(e){return Object(o.a)(1,arguments),e instanceof Date||"object"===Object(r.a)(e)&&"[object Date]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(422),o=n(126),i=n(124);function a(e){if(Object(i.a)(1,arguments),!Object(r.default)(e)&&"number"!==typeof e)return!1;var t=Object(o.default)(e);return!isNaN(Number(t))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(304),o=n(124),i=n(132);function a(e,t){Object(o.a)(2,arguments);var n=Object(i.a)(t);return Object(r.a)(e,-n)}},function(e,t,n){"use strict";var r=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},o=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},i={p:o,P:function(e,t){var n,i=e.match(/(P+)(p+)?/)||[],a=i[1],s=i[2];if(!s)return r(e,t);switch(a){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",r(a,t)).replace("{{time}}",o(s,t))}};t.a=i},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(126),o=n(124),i=n(207);function a(e){Object(o.a)(1,arguments);var t=Object(r.default)(e),n=t.getUTCFullYear(),a=new Date(0);a.setUTCFullYear(n+1,0,4),a.setUTCHours(0,0,0,0);var s=Object(i.a)(a),c=new Date(0);c.setUTCFullYear(n,0,4),c.setUTCHours(0,0,0,0);var l=Object(i.a)(c);return t.getTime()>=s.getTime()?n+1:t.getTime()>=l.getTime()?n:n-1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s}));var r=["D","DD"],o=["YY","YYYY"];function i(e){return-1!==r.indexOf(e)}function a(e){return-1!==o.indexOf(e)}function s(e,t,n){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(132),o=n(306),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=7*Object(r.a)(t);return Object(o.default)(e,n)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(132),o=n(244),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=3*Object(r.a)(t);return Object(o.default)(e,n)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(132),o=n(244),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=Object(r.a)(t);return Object(o.default)(e,12*n)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(126),o=n(132),i=n(124),a=n(169);function s(e,t){var n,s,c,l,u,d,p,h;Object(i.a)(1,arguments);var f=Object(a.a)(),m=Object(o.a)(null!==(n=null!==(s=null!==(c=null!==(l=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==l?l:null===t||void 0===t||null===(u=t.locale)||void 0===u||null===(d=u.options)||void 0===d?void 0:d.weekStartsOn)&&void 0!==c?c:f.weekStartsOn)&&void 0!==s?s:null===(p=f.locale)||void 0===p||null===(h=p.options)||void 0===h?void 0:h.weekStartsOn)&&void 0!==n?n:0);if(!(m>=0&&m<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var v=Object(r.default)(e),g=v.getDay(),E=(g<m?7:0)+g-m;return v.setDate(v.getDate()-E),v.setHours(0,0,0,0),v}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){Object(o.a)(1,arguments);var t=Object(r.default)(e),n=t.getMonth(),i=n-n%3;return t.setMonth(i,1),t.setHours(0,0,0,0),t}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i}));Math.pow(10,8);var r=6e4,o=36e5,i=1e3},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var n=e.render,r=e.children;return n?n(t):"function"===typeof r?r(t):r}},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"AgoraVideoPlayer",(function(){return l})),n.d(t,"createClient",(function(){return s})),n.d(t,"createMicrophoneAndCameraTracks",(function(){return c}));var r=n(2),o=n.n(r),i=n(311),a=n.n(i);var s=function(e){var t;return function(){return t||(t=a.a.createClient(e)),t}};function c(e,t){var n=null;return function(){var o=Object(r.useState)(!1),i=o[0],s=o[1],c=Object(r.useRef)(n);return Object(r.useEffect)((function(){return null===c.current?function(){try{return Promise.resolve(a.a.createMicrophoneAndCameraTracks(e,t)).then((function(e){return n=e}))}catch(r){return Promise.reject(r)}}().then((function(e){c.current=e,s(!0)})):s(!0),function(){n=null}}),[]),{ready:i,tracks:c.current}}}var l=function(e){var t=Object(r.useRef)(null),n=e.videoTrack,i=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,["videoTrack"]);return Object(r.useEffect)((function(){return null!==t.current&&n.play(t.current),function(){n.stop()}}),[n]),o.a.createElement("div",Object.assign({},i,{ref:t}))};a.a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},o=function(e,t,n){var o,i=r[e];return o="string"===typeof i?i:1===t?i.one:i.other.replace("{{count}}",t.toString()),null!==n&&void 0!==n&&n.addSuffix?n.comparison&&n.comparison>0?"in "+o:o+" ago":o};function i(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}var a={date:i({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:i({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:i({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},s={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},c=function(e,t,n,r){return s[e]};function l(e){return function(t,n){var r;if("formatting"===(null!==n&&void 0!==n&&n.context?String(n.context):"standalone")&&e.formattingValues){var o=e.defaultFormattingWidth||e.defaultWidth,i=null!==n&&void 0!==n&&n.width?String(n.width):o;r=e.formattingValues[i]||e.formattingValues[o]}else{var a=e.defaultWidth,s=null!==n&&void 0!==n&&n.width?String(n.width):e.defaultWidth;r=e.values[s]||e.values[a]}return r[e.argumentCallback?e.argumentCallback(t):t]}}var u={ordinalNumber:function(e,t){var n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:l({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:l({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:l({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:l({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:l({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function d(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.width,o=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(o);if(!i)return null;var a,s=i[0],c=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(c)?function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n;return}(c,(function(e){return e.test(s)})):function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n]))return n;return}(c,(function(e){return e.test(s)}));return a=e.valueCallback?e.valueCallback(l):l,{value:a=n.valueCallback?n.valueCallback(a):a,rest:t.slice(s.length)}}}var p,h={ordinalNumber:(p={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.match(p.matchPattern);if(!n)return null;var r=n[0],o=e.match(p.parsePattern);if(!o)return null;var i=p.valueCallback?p.valueCallback(o[0]):o[0];return{value:i=t.valueCallback?t.valueCallback(i):i,rest:e.slice(r.length)}}),era:d({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:d({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:d({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:d({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:d({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},f={code:"en-US",formatDistance:o,formatLong:a,formatRelative:c,localize:u,match:h,options:{weekStartsOn:0,firstWeekContainsDate:1}};t.a=f},,function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},o=n(385),i=!1,a=/[A-Z]|^ms/g,s=/_EMO_([^_]+?)_([^]*?)_EMO_/g,c=function(e){return 45===e.charCodeAt(1)},l=function(e){return null!=e&&"boolean"!==typeof e},u=Object(o.a)((function(e){return c(e)?e:e.replace(a,"-$&").toLowerCase()})),d=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(s,(function(e,t,n){return f={name:t,styles:n,next:f},t}))}return 1===r[e]||c(e)||"number"!==typeof t||0===t?t:t+"px"},p="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function h(e,t,n){if(null==n)return"";var r=n;if(void 0!==r.__emotion_styles)return r;switch(typeof n){case"boolean":return"";case"object":var o=n;if(1===o.anim)return f={name:o.name,styles:o.styles,next:f},o.name;var a=n;if(void 0!==a.styles){var s=a.next;if(void 0!==s)for(;void 0!==s;)f={name:s.name,styles:s.styles,next:f},s=s.next;return a.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var o=0;o<n.length;o++)r+=h(e,t,n[o])+";";else for(var a in n){var s=n[a];if("object"!==typeof s){var c=s;null!=t&&void 0!==t[c]?r+=a+"{"+t[c]+"}":l(c)&&(r+=u(a)+":"+d(a,c)+";")}else{if("NO_COMPONENT_SELECTOR"===a&&i)throw new Error(p);if(!Array.isArray(s)||"string"!==typeof s[0]||null!=t&&void 0!==t[s[0]]){var f=h(e,t,s);switch(a){case"animation":case"animationName":r+=u(a)+":"+f+";";break;default:r+=a+"{"+f+"}"}}else for(var m=0;m<s.length;m++)l(s[m])&&(r+=u(a)+":"+d(a,s[m])+";")}}return r}(e,t,n);case"function":if(void 0!==e){var c=f,m=n(e);return f=c,h(e,t,m)}}var v=n;if(null==t)return v;var g=t[v];return void 0!==g?g:v}var f,m=/label:\s*([^\s;{]+)\s*(;|$)/g;function v(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,o="";f=void 0;var i=e[0];null==i||void 0===i.raw?(r=!1,o+=h(n,t,i)):o+=i[0];for(var a=1;a<e.length;a++){if(o+=h(n,t,e[a]),r)o+=i[a]}m.lastIndex=0;for(var s,c="";null!==(s=m.exec(o));)c+="-"+s[1];var l=function(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(o)+c;return{name:l,styles:o,next:f}}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(126),o=n(206),i=n(305),a=n(124),s=n(132),c=n(169);var l=6048e5;function u(e,t){Object(a.a)(1,arguments);var n=Object(r.default)(e),u=Object(o.a)(n,t).getTime()-function(e,t){var n,r,l,u,d,p,h,f;Object(a.a)(1,arguments);var m=Object(c.a)(),v=Object(s.a)(null!==(n=null!==(r=null!==(l=null!==(u=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==u?u:null===t||void 0===t||null===(d=t.locale)||void 0===d||null===(p=d.options)||void 0===p?void 0:p.firstWeekContainsDate)&&void 0!==l?l:m.firstWeekContainsDate)&&void 0!==r?r:null===(h=m.locale)||void 0===h||null===(f=h.options)||void 0===f?void 0:f.firstWeekContainsDate)&&void 0!==n?n:1),g=Object(i.a)(e,t),E=new Date(0);return E.setUTCFullYear(g,0,v),E.setUTCHours(0,0,0,0),Object(o.a)(E,t)}(n,t).getTime();return Math.round(u/l)+1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(126),o=n(207),i=n(426),a=n(124);var s=6048e5;function c(e){Object(a.a)(1,arguments);var t=Object(r.default)(e),n=Object(o.a)(t).getTime()-function(e){Object(a.a)(1,arguments);var t=Object(i.a)(e),n=new Date(0);return n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0),Object(o.a)(n)}(t).getTime();return Math.round(n/s)+1}},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=l(i),s=n(31),c=l(n(513));function l(e){return e&&e.__esModule?e:{default:e}}var u={"ps-scroll-y":"onScrollY","ps-scroll-x":"onScrollX","ps-scroll-up":"onScrollUp","ps-scroll-down":"onScrollDown","ps-scroll-left":"onScrollLeft","ps-scroll-right":"onScrollRight","ps-y-reach-start":"onYReachStart","ps-y-reach-end":"onYReachEnd","ps-x-reach-start":"onXReachStart","ps-x-reach-end":"onXReachEnd"};Object.freeze(u);var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleRef=n.handleRef.bind(n),n._handlerByEvent={},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidMount",value:function(){this.props.option&&console.warn('react-perfect-scrollbar: the "option" prop has been deprecated in favor of "options"'),this._ps=new c.default(this._container,this.props.options||this.props.option),this._updateEventHook(),this._updateClassName()}},{key:"componentDidUpdate",value:function(e){this._updateEventHook(e),this.updateScroll(),e.className!==this.props.className&&this._updateClassName()}},{key:"componentWillUnmount",value:function(){var e=this;Object.keys(this._handlerByEvent).forEach((function(t){var n=e._handlerByEvent[t];n&&e._container.removeEventListener(t,n,!1)})),this._handlerByEvent={},this._ps.destroy(),this._ps=null}},{key:"_updateEventHook",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(u).forEach((function(n){var r=e.props[u[n]],o=t[u[n]];if(r!==o){if(o){var i=e._handlerByEvent[n];e._container.removeEventListener(n,i,!1),e._handlerByEvent[n]=null}if(r){var a=function(){return r(e._container)};e._container.addEventListener(n,a,!1),e._handlerByEvent[n]=a}}}))}},{key:"_updateClassName",value:function(){var e=this.props.className,t=this._container.className.split(" ").filter((function(e){return e.match(/^ps([-_].+|)$/)})).join(" ");this._container&&(this._container.className="scrollbar-container"+(e?" "+e:"")+(t?" "+t:""))}},{key:"updateScroll",value:function(){this.props.onSync(this._ps)}},{key:"handleRef",value:function(e){this._container=e,this.props.containerRef(e)}},{key:"render",value:function(){var e=this.props,t=(e.className,e.style),n=(e.option,e.options,e.containerRef,e.onScrollY,e.onScrollX,e.onScrollUp,e.onScrollDown,e.onScrollLeft,e.onScrollRight,e.onYReachStart,e.onYReachEnd,e.onXReachStart,e.onXReachEnd,e.component),o=(e.onSync,e.children),i=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["className","style","option","options","containerRef","onScrollY","onScrollX","onScrollUp","onScrollDown","onScrollLeft","onScrollRight","onYReachStart","onYReachEnd","onXReachStart","onXReachEnd","component","onSync","children"]),s=n;return a.default.createElement(s,r({style:t,ref:this.handleRef},i),o)}}]),t}(i.Component);t.default=d,d.defaultProps={className:"",style:void 0,option:void 0,options:void 0,containerRef:function(){},onScrollY:void 0,onScrollX:void 0,onScrollUp:void 0,onScrollDown:void 0,onScrollLeft:void 0,onScrollRight:void 0,onYReachStart:void 0,onYReachEnd:void 0,onXReachStart:void 0,onXReachEnd:void 0,onSync:function(e){return e.update()},component:"div"},d.propTypes={children:s.PropTypes.node.isRequired,className:s.PropTypes.string,style:s.PropTypes.object,option:s.PropTypes.object,options:s.PropTypes.object,containerRef:s.PropTypes.func,onScrollY:s.PropTypes.func,onScrollX:s.PropTypes.func,onScrollUp:s.PropTypes.func,onScrollDown:s.PropTypes.func,onScrollLeft:s.PropTypes.func,onScrollRight:s.PropTypes.func,onYReachStart:s.PropTypes.func,onYReachEnd:s.PropTypes.func,onXReachStart:s.PropTypes.func,onXReachEnd:s.PropTypes.func,onSync:s.PropTypes.func,component:s.PropTypes.string},e.exports=t.default},function(e,t,n){"use strict";function r(e){return getComputedStyle(e)}function o(e,t){for(var n in t){var r=t[n];"number"===typeof r&&(r+="px"),e.style[n]=r}return e}function i(e){var t=document.createElement("div");return t.className=e,t}n.r(t);var a="undefined"!==typeof Element&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);function s(e,t){if(!a)throw new Error("No element matching method supported");return a.call(e,t)}function c(e){e.remove?e.remove():e.parentNode&&e.parentNode.removeChild(e)}function l(e,t){return Array.prototype.filter.call(e.children,(function(e){return s(e,t)}))}var u="ps",d="ps__rtl",p={thumb:function(e){return"ps__thumb-"+e},rail:function(e){return"ps__rail-"+e},consuming:"ps__child--consume"},h={focus:"ps--focus",clicking:"ps--clicking",active:function(e){return"ps--active-"+e},scrolling:function(e){return"ps--scrolling-"+e}},f={x:null,y:null};function m(e,t){var n=e.element.classList,r=h.scrolling(t);n.contains(r)?clearTimeout(f[t]):n.add(r)}function v(e,t){f[t]=setTimeout((function(){return e.isAlive&&e.element.classList.remove(h.scrolling(t))}),e.settings.scrollingThreshold)}var g=function(e){this.element=e,this.handlers={}},E={isEmpty:{configurable:!0}};g.prototype.bind=function(e,t){"undefined"===typeof this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e].push(t),this.element.addEventListener(e,t,!1)},g.prototype.unbind=function(e,t){var n=this;this.handlers[e]=this.handlers[e].filter((function(r){return!(!t||r===t)||(n.element.removeEventListener(e,r,!1),!1)}))},g.prototype.unbindAll=function(){for(var e in this.handlers)this.unbind(e)},E.isEmpty.get=function(){var e=this;return Object.keys(this.handlers).every((function(t){return 0===e.handlers[t].length}))},Object.defineProperties(g.prototype,E);var y=function(){this.eventElements=[]};function _(e){if("function"===typeof window.CustomEvent)return new CustomEvent(e);var t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!1,!1,void 0),t}function b(e,t,n,r,o){var i;if(void 0===r&&(r=!0),void 0===o&&(o=!1),"top"===t)i=["contentHeight","containerHeight","scrollTop","y","up","down"];else{if("left"!==t)throw new Error("A proper axis should be provided");i=["contentWidth","containerWidth","scrollLeft","x","left","right"]}!function(e,t,n,r,o){var i=n[0],a=n[1],s=n[2],c=n[3],l=n[4],u=n[5];void 0===r&&(r=!0);void 0===o&&(o=!1);var d=e.element;e.reach[c]=null,d[s]<1&&(e.reach[c]="start");d[s]>e[i]-e[a]-1&&(e.reach[c]="end");t&&(d.dispatchEvent(_("ps-scroll-"+c)),t<0?d.dispatchEvent(_("ps-scroll-"+l)):t>0&&d.dispatchEvent(_("ps-scroll-"+u)),r&&function(e,t){m(e,t),v(e,t)}(e,c));e.reach[c]&&(t||o)&&d.dispatchEvent(_("ps-"+c+"-reach-"+e.reach[c]))}(e,n,i,r,o)}function T(e){return parseInt(e,10)||0}y.prototype.eventElement=function(e){var t=this.eventElements.filter((function(t){return t.element===e}))[0];return t||(t=new g(e),this.eventElements.push(t)),t},y.prototype.bind=function(e,t,n){this.eventElement(e).bind(t,n)},y.prototype.unbind=function(e,t,n){var r=this.eventElement(e);r.unbind(t,n),r.isEmpty&&this.eventElements.splice(this.eventElements.indexOf(r),1)},y.prototype.unbindAll=function(){this.eventElements.forEach((function(e){return e.unbindAll()})),this.eventElements=[]},y.prototype.once=function(e,t,n){var r=this.eventElement(e),o=function(e){r.unbind(t,o),n(e)};r.bind(t,o)};var S={isWebKit:"undefined"!==typeof document&&"WebkitAppearance"in document.documentElement.style,supportsTouch:"undefined"!==typeof window&&("ontouchstart"in window||"maxTouchPoints"in window.navigator&&window.navigator.maxTouchPoints>0||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:"undefined"!==typeof navigator&&navigator.msMaxTouchPoints,isChrome:"undefined"!==typeof navigator&&/Chrome/i.test(navigator&&navigator.userAgent)};function O(e){var t=e.element,n=Math.floor(t.scrollTop),r=t.getBoundingClientRect();e.containerWidth=Math.floor(r.width),e.containerHeight=Math.floor(r.height),e.contentWidth=t.scrollWidth,e.contentHeight=t.scrollHeight,t.contains(e.scrollbarXRail)||(l(t,p.rail("x")).forEach((function(e){return c(e)})),t.appendChild(e.scrollbarXRail)),t.contains(e.scrollbarYRail)||(l(t,p.rail("y")).forEach((function(e){return c(e)})),t.appendChild(e.scrollbarYRail)),!e.settings.suppressScrollX&&e.containerWidth+e.settings.scrollXMarginOffset<e.contentWidth?(e.scrollbarXActive=!0,e.railXWidth=e.containerWidth-e.railXMarginWidth,e.railXRatio=e.containerWidth/e.railXWidth,e.scrollbarXWidth=R(e,T(e.railXWidth*e.containerWidth/e.contentWidth)),e.scrollbarXLeft=T((e.negativeScrollAdjustment+t.scrollLeft)*(e.railXWidth-e.scrollbarXWidth)/(e.contentWidth-e.containerWidth))):e.scrollbarXActive=!1,!e.settings.suppressScrollY&&e.containerHeight+e.settings.scrollYMarginOffset<e.contentHeight?(e.scrollbarYActive=!0,e.railYHeight=e.containerHeight-e.railYMarginHeight,e.railYRatio=e.containerHeight/e.railYHeight,e.scrollbarYHeight=R(e,T(e.railYHeight*e.containerHeight/e.contentHeight)),e.scrollbarYTop=T(n*(e.railYHeight-e.scrollbarYHeight)/(e.contentHeight-e.containerHeight))):e.scrollbarYActive=!1,e.scrollbarXLeft>=e.railXWidth-e.scrollbarXWidth&&(e.scrollbarXLeft=e.railXWidth-e.scrollbarXWidth),e.scrollbarYTop>=e.railYHeight-e.scrollbarYHeight&&(e.scrollbarYTop=e.railYHeight-e.scrollbarYHeight),function(e,t){var n={width:t.railXWidth},r=Math.floor(e.scrollTop);t.isRtl?n.left=t.negativeScrollAdjustment+e.scrollLeft+t.containerWidth-t.contentWidth:n.left=e.scrollLeft;t.isScrollbarXUsingBottom?n.bottom=t.scrollbarXBottom-r:n.top=t.scrollbarXTop+r;o(t.scrollbarXRail,n);var i={top:r,height:t.railYHeight};t.isScrollbarYUsingRight?t.isRtl?i.right=t.contentWidth-(t.negativeScrollAdjustment+e.scrollLeft)-t.scrollbarYRight-t.scrollbarYOuterWidth-9:i.right=t.scrollbarYRight-e.scrollLeft:t.isRtl?i.left=t.negativeScrollAdjustment+e.scrollLeft+2*t.containerWidth-t.contentWidth-t.scrollbarYLeft-t.scrollbarYOuterWidth:i.left=t.scrollbarYLeft+e.scrollLeft;o(t.scrollbarYRail,i),o(t.scrollbarX,{left:t.scrollbarXLeft,width:t.scrollbarXWidth-t.railBorderXWidth}),o(t.scrollbarY,{top:t.scrollbarYTop,height:t.scrollbarYHeight-t.railBorderYWidth})}(t,e),e.scrollbarXActive?t.classList.add(h.active("x")):(t.classList.remove(h.active("x")),e.scrollbarXWidth=0,e.scrollbarXLeft=0,t.scrollLeft=!0===e.isRtl?e.contentWidth:0),e.scrollbarYActive?t.classList.add(h.active("y")):(t.classList.remove(h.active("y")),e.scrollbarYHeight=0,e.scrollbarYTop=0,t.scrollTop=0)}function R(e,t){return e.settings.minScrollbarLength&&(t=Math.max(t,e.settings.minScrollbarLength)),e.settings.maxScrollbarLength&&(t=Math.min(t,e.settings.maxScrollbarLength)),t}var C=null;function w(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],s=t[5],c=t[6],l=t[7],u=t[8],d=e.element,p=null,f=null,g=null;function E(t){t.touches&&t.touches[0]&&(t[o]=t.touches[0]["page"+l.toUpperCase()]),C===a&&(d[c]=p+g*(t[o]-f),m(e,l),O(e),t.stopPropagation(),t.preventDefault())}function y(){v(e,l),e[u].classList.remove(h.clicking),document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",E),document.removeEventListener("touchend",y),C=null}function _(t){null===C&&(C=a,p=d[c],t.touches&&(t[o]=t.touches[0]["page"+l.toUpperCase()]),f=t[o],g=(e[r]-e[n])/(e[i]-e[s]),t.touches?(document.addEventListener("touchmove",E,{passive:!1}),document.addEventListener("touchend",y)):(document.addEventListener("mousemove",E),document.addEventListener("mouseup",y)),e[u].classList.add(h.clicking)),t.stopPropagation(),t.cancelable&&t.preventDefault()}e[a].addEventListener("mousedown",_),e[a].addEventListener("touchstart",_)}var I={"click-rail":function(e){e.event.bind(e.scrollbarY,"mousedown",(function(e){return e.stopPropagation()})),e.event.bind(e.scrollbarYRail,"mousedown",(function(t){var n=t.pageY-window.pageYOffset-e.scrollbarYRail.getBoundingClientRect().top>e.scrollbarYTop?1:-1;e.element.scrollTop+=n*e.containerHeight,O(e),t.stopPropagation()})),e.event.bind(e.scrollbarX,"mousedown",(function(e){return e.stopPropagation()})),e.event.bind(e.scrollbarXRail,"mousedown",(function(t){var n=t.pageX-window.pageXOffset-e.scrollbarXRail.getBoundingClientRect().left>e.scrollbarXLeft?1:-1;e.element.scrollLeft+=n*e.containerWidth,O(e),t.stopPropagation()}))},"drag-thumb":function(e){w(e,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y","scrollbarYRail"]),w(e,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x","scrollbarXRail"])},keyboard:function(e){var t=e.element;e.event.bind(e.ownerDocument,"keydown",(function(n){if(!(n.isDefaultPrevented&&n.isDefaultPrevented()||n.defaultPrevented)&&(s(t,":hover")||s(e.scrollbarX,":focus")||s(e.scrollbarY,":focus"))){var r,o=document.activeElement?document.activeElement:e.ownerDocument.activeElement;if(o){if("IFRAME"===o.tagName)o=o.contentDocument.activeElement;else for(;o.shadowRoot;)o=o.shadowRoot.activeElement;if(s(r=o,"input,[contenteditable]")||s(r,"select,[contenteditable]")||s(r,"textarea,[contenteditable]")||s(r,"button,[contenteditable]"))return}var i=0,a=0;switch(n.which){case 37:i=n.metaKey?-e.contentWidth:n.altKey?-e.containerWidth:-30;break;case 38:a=n.metaKey?e.contentHeight:n.altKey?e.containerHeight:30;break;case 39:i=n.metaKey?e.contentWidth:n.altKey?e.containerWidth:30;break;case 40:a=n.metaKey?-e.contentHeight:n.altKey?-e.containerHeight:-30;break;case 32:a=n.shiftKey?e.containerHeight:-e.containerHeight;break;case 33:a=e.containerHeight;break;case 34:a=-e.containerHeight;break;case 36:a=e.contentHeight;break;case 35:a=-e.contentHeight;break;default:return}e.settings.suppressScrollX&&0!==i||e.settings.suppressScrollY&&0!==a||(t.scrollTop-=a,t.scrollLeft+=i,O(e),function(n,r){var o=Math.floor(t.scrollTop);if(0===n){if(!e.scrollbarYActive)return!1;if(0===o&&r>0||o>=e.contentHeight-e.containerHeight&&r<0)return!e.settings.wheelPropagation}var i=t.scrollLeft;if(0===r){if(!e.scrollbarXActive)return!1;if(0===i&&n<0||i>=e.contentWidth-e.containerWidth&&n>0)return!e.settings.wheelPropagation}return!0}(i,a)&&n.preventDefault())}}))},wheel:function(e){var t=e.element;function n(n){var o=function(e){var t=e.deltaX,n=-1*e.deltaY;return"undefined"!==typeof t&&"undefined"!==typeof n||(t=-1*e.wheelDeltaX/6,n=e.wheelDeltaY/6),e.deltaMode&&1===e.deltaMode&&(t*=10,n*=10),t!==t&&n!==n&&(t=0,n=e.wheelDelta),e.shiftKey?[-n,-t]:[t,n]}(n),i=o[0],a=o[1];if(!function(e,n,o){if(!S.isWebKit&&t.querySelector("select:focus"))return!0;if(!t.contains(e))return!1;for(var i=e;i&&i!==t;){if(i.classList.contains(p.consuming))return!0;var a=r(i);if(o&&a.overflowY.match(/(scroll|auto)/)){var s=i.scrollHeight-i.clientHeight;if(s>0&&(i.scrollTop>0&&o<0||i.scrollTop<s&&o>0))return!0}if(n&&a.overflowX.match(/(scroll|auto)/)){var c=i.scrollWidth-i.clientWidth;if(c>0&&(i.scrollLeft>0&&n<0||i.scrollLeft<c&&n>0))return!0}i=i.parentNode}return!1}(n.target,i,a)){var s=!1;e.settings.useBothWheelAxes?e.scrollbarYActive&&!e.scrollbarXActive?(a?t.scrollTop-=a*e.settings.wheelSpeed:t.scrollTop+=i*e.settings.wheelSpeed,s=!0):e.scrollbarXActive&&!e.scrollbarYActive&&(i?t.scrollLeft+=i*e.settings.wheelSpeed:t.scrollLeft-=a*e.settings.wheelSpeed,s=!0):(t.scrollTop-=a*e.settings.wheelSpeed,t.scrollLeft+=i*e.settings.wheelSpeed),O(e),s=s||function(n,r){var o=Math.floor(t.scrollTop),i=0===t.scrollTop,a=o+t.offsetHeight===t.scrollHeight,s=0===t.scrollLeft,c=t.scrollLeft+t.offsetWidth===t.scrollWidth;return!(Math.abs(r)>Math.abs(n)?i||a:s||c)||!e.settings.wheelPropagation}(i,a),s&&!n.ctrlKey&&(n.stopPropagation(),n.preventDefault())}}"undefined"!==typeof window.onwheel?e.event.bind(t,"wheel",n):"undefined"!==typeof window.onmousewheel&&e.event.bind(t,"mousewheel",n)},touch:function(e){if(S.supportsTouch||S.supportsIePointer){var t=e.element,n={startOffset:{},startTime:0,speed:{},easingLoop:null};S.supportsTouch?(e.event.bind(t,"touchstart",s),e.event.bind(t,"touchmove",c),e.event.bind(t,"touchend",l)):S.supportsIePointer&&(window.PointerEvent?(e.event.bind(t,"pointerdown",s),e.event.bind(t,"pointermove",c),e.event.bind(t,"pointerup",l)):window.MSPointerEvent&&(e.event.bind(t,"MSPointerDown",s),e.event.bind(t,"MSPointerMove",c),e.event.bind(t,"MSPointerUp",l)))}function o(n,r){t.scrollTop-=r,t.scrollLeft-=n,O(e)}function i(e){return e.targetTouches?e.targetTouches[0]:e}function a(t){return t.target!==e.scrollbarX&&t.target!==e.scrollbarY&&((!t.pointerType||"pen"!==t.pointerType||0!==t.buttons)&&(!(!t.targetTouches||1!==t.targetTouches.length)||!(!t.pointerType||"mouse"===t.pointerType||t.pointerType===t.MSPOINTER_TYPE_MOUSE)))}function s(e){if(a(e)){var t=i(e);n.startOffset.pageX=t.pageX,n.startOffset.pageY=t.pageY,n.startTime=(new Date).getTime(),null!==n.easingLoop&&clearInterval(n.easingLoop)}}function c(s){if(a(s)){var c=i(s),l={pageX:c.pageX,pageY:c.pageY},u=l.pageX-n.startOffset.pageX,d=l.pageY-n.startOffset.pageY;if(function(e,n,o){if(!t.contains(e))return!1;for(var i=e;i&&i!==t;){if(i.classList.contains(p.consuming))return!0;var a=r(i);if(o&&a.overflowY.match(/(scroll|auto)/)){var s=i.scrollHeight-i.clientHeight;if(s>0&&(i.scrollTop>0&&o<0||i.scrollTop<s&&o>0))return!0}if(n&&a.overflowX.match(/(scroll|auto)/)){var c=i.scrollWidth-i.clientWidth;if(c>0&&(i.scrollLeft>0&&n<0||i.scrollLeft<c&&n>0))return!0}i=i.parentNode}return!1}(s.target,u,d))return;o(u,d),n.startOffset=l;var h=(new Date).getTime(),f=h-n.startTime;f>0&&(n.speed.x=u/f,n.speed.y=d/f,n.startTime=h),function(n,r){var o=Math.floor(t.scrollTop),i=t.scrollLeft,a=Math.abs(n),s=Math.abs(r);if(s>a){if(r<0&&o===e.contentHeight-e.containerHeight||r>0&&0===o)return 0===window.scrollY&&r>0&&S.isChrome}else if(a>s&&(n<0&&i===e.contentWidth-e.containerWidth||n>0&&0===i))return!0;return!0}(u,d)&&s.cancelable&&s.preventDefault()}}function l(){e.settings.swipeEasing&&(clearInterval(n.easingLoop),n.easingLoop=setInterval((function(){e.isInitialized?clearInterval(n.easingLoop):n.speed.x||n.speed.y?Math.abs(n.speed.x)<.01&&Math.abs(n.speed.y)<.01?clearInterval(n.easingLoop):(o(30*n.speed.x,30*n.speed.y),n.speed.x*=.8,n.speed.y*=.8):clearInterval(n.easingLoop)}),10))}}},A=function(e,t){var n=this;if(void 0===t&&(t={}),"string"===typeof e&&(e=document.querySelector(e)),!e||!e.nodeName)throw new Error("no element is specified to initialize PerfectScrollbar");for(var a in this.element=e,e.classList.add(u),this.settings={handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!0,wheelSpeed:1},t)this.settings[a]=t[a];this.containerWidth=null,this.containerHeight=null,this.contentWidth=null,this.contentHeight=null;var s=function(){return e.classList.add(h.focus)},c=function(){return e.classList.remove(h.focus)};this.isRtl="rtl"===r(e).direction,!0===this.isRtl&&e.classList.add(d),this.isNegativeScroll=function(){var t,n=e.scrollLeft;return e.scrollLeft=-1,t=e.scrollLeft<0,e.scrollLeft=n,t}(),this.negativeScrollAdjustment=this.isNegativeScroll?e.scrollWidth-e.clientWidth:0,this.event=new y,this.ownerDocument=e.ownerDocument||document,this.scrollbarXRail=i(p.rail("x")),e.appendChild(this.scrollbarXRail),this.scrollbarX=i(p.thumb("x")),this.scrollbarXRail.appendChild(this.scrollbarX),this.scrollbarX.setAttribute("tabindex",0),this.event.bind(this.scrollbarX,"focus",s),this.event.bind(this.scrollbarX,"blur",c),this.scrollbarXActive=null,this.scrollbarXWidth=null,this.scrollbarXLeft=null;var l=r(this.scrollbarXRail);this.scrollbarXBottom=parseInt(l.bottom,10),isNaN(this.scrollbarXBottom)?(this.isScrollbarXUsingBottom=!1,this.scrollbarXTop=T(l.top)):this.isScrollbarXUsingBottom=!0,this.railBorderXWidth=T(l.borderLeftWidth)+T(l.borderRightWidth),o(this.scrollbarXRail,{display:"block"}),this.railXMarginWidth=T(l.marginLeft)+T(l.marginRight),o(this.scrollbarXRail,{display:""}),this.railXWidth=null,this.railXRatio=null,this.scrollbarYRail=i(p.rail("y")),e.appendChild(this.scrollbarYRail),this.scrollbarY=i(p.thumb("y")),this.scrollbarYRail.appendChild(this.scrollbarY),this.scrollbarY.setAttribute("tabindex",0),this.event.bind(this.scrollbarY,"focus",s),this.event.bind(this.scrollbarY,"blur",c),this.scrollbarYActive=null,this.scrollbarYHeight=null,this.scrollbarYTop=null;var f=r(this.scrollbarYRail);this.scrollbarYRight=parseInt(f.right,10),isNaN(this.scrollbarYRight)?(this.isScrollbarYUsingRight=!1,this.scrollbarYLeft=T(f.left)):this.isScrollbarYUsingRight=!0,this.scrollbarYOuterWidth=this.isRtl?function(e){var t=r(e);return T(t.width)+T(t.paddingLeft)+T(t.paddingRight)+T(t.borderLeftWidth)+T(t.borderRightWidth)}(this.scrollbarY):null,this.railBorderYWidth=T(f.borderTopWidth)+T(f.borderBottomWidth),o(this.scrollbarYRail,{display:"block"}),this.railYMarginHeight=T(f.marginTop)+T(f.marginBottom),o(this.scrollbarYRail,{display:""}),this.railYHeight=null,this.railYRatio=null,this.reach={x:e.scrollLeft<=0?"start":e.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:e.scrollTop<=0?"start":e.scrollTop>=this.contentHeight-this.containerHeight?"end":null},this.isAlive=!0,this.settings.handlers.forEach((function(e){return I[e](n)})),this.lastScrollTop=Math.floor(e.scrollTop),this.lastScrollLeft=e.scrollLeft,this.event.bind(this.element,"scroll",(function(e){return n.onScroll(e)})),O(this)};A.prototype.update=function(){this.isAlive&&(this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0,o(this.scrollbarXRail,{display:"block"}),o(this.scrollbarYRail,{display:"block"}),this.railXMarginWidth=T(r(this.scrollbarXRail).marginLeft)+T(r(this.scrollbarXRail).marginRight),this.railYMarginHeight=T(r(this.scrollbarYRail).marginTop)+T(r(this.scrollbarYRail).marginBottom),o(this.scrollbarXRail,{display:"none"}),o(this.scrollbarYRail,{display:"none"}),O(this),b(this,"top",0,!1,!0),b(this,"left",0,!1,!0),o(this.scrollbarXRail,{display:""}),o(this.scrollbarYRail,{display:""}))},A.prototype.onScroll=function(e){this.isAlive&&(O(this),b(this,"top",this.element.scrollTop-this.lastScrollTop),b(this,"left",this.element.scrollLeft-this.lastScrollLeft),this.lastScrollTop=Math.floor(this.element.scrollTop),this.lastScrollLeft=this.element.scrollLeft)},A.prototype.destroy=function(){this.isAlive&&(this.event.unbindAll(),c(this.scrollbarX),c(this.scrollbarY),c(this.scrollbarXRail),c(this.scrollbarYRail),this.removePsClasses(),this.element=null,this.scrollbarX=null,this.scrollbarY=null,this.scrollbarXRail=null,this.scrollbarYRail=null,this.isAlive=!1)},A.prototype.removePsClasses=function(){this.element.className=this.element.className.split(" ").filter((function(e){return!e.match(/^ps([-_].+|)$/)})).join(" ")},t.default=A},,,,,,,,function(e,t,n){"use strict";var r=n(34),o=n(148),i=n(137),a=n(2),s=n(27),c=n.n(s),l=n(272),u=n(347),d=a.forwardRef((function(e,t){var n,s=e.prefixCls,d=void 0===s?"rc-switch":s,p=e.className,h=e.checked,f=e.defaultChecked,m=e.disabled,v=e.loadingIcon,g=e.checkedChildren,E=e.unCheckedChildren,y=e.onClick,_=e.onChange,b=e.onKeyDown,T=Object(i.a)(e,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),S=Object(l.a)(!1,{value:h,defaultValue:f}),O=Object(o.a)(S,2),R=O[0],C=O[1];function w(e,t){var n=R;return m||(C(n=e),null===_||void 0===_||_(n,t)),n}var I=c()(d,p,(n={},Object(r.a)(n,"".concat(d,"-checked"),R),Object(r.a)(n,"".concat(d,"-disabled"),m),n));return a.createElement("button",Object.assign({},T,{type:"button",role:"switch","aria-checked":R,disabled:m,className:I,ref:t,onKeyDown:function(e){e.which===u.a.LEFT?w(!1,e):e.which===u.a.RIGHT&&w(!0,e),null===b||void 0===b||b(e)},onClick:function(e){var t=w(!R,e);null===y||void 0===y||y(t,e)}}),v,a.createElement("span",{className:"".concat(d,"-inner")},R?g:E))}));d.displayName="Switch",t.a=d},function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";(function(module){Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Star",{enumerable:!0,get:function(){return _star.default}}),exports.default=void 0;var _react=_interopRequireWildcard(__webpack_require__(2)),_propTypes=_interopRequireDefault(__webpack_require__(31)),_star=_interopRequireDefault(__webpack_require__(563));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t=_getRequireWildcardCache();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}}return n.default=e,t&&t.set(e,n),n}function _typeof(e){return _typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _extends(){return _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_extends.apply(this,arguments)}function _objectWithoutProperties(e,t){if(null==e)return{};var n,r,o=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(n,!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!==typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _inherits(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}!function(){var e="undefined"!==typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0;e&&e(module)}();var __signature__="undefined"!==typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},Rater=function(_Component){function Rater(e){var t;return _classCallCheck(this,Rater),(t=_possibleConstructorReturn(this,_getPrototypeOf(Rater).call(this,e))).state={rating:e.rating,lastRating:e.rating,isRating:!1},t}return _inherits(Rater,_Component),_createClass(Rater,[{key:"willRate",value:function(e,t){this.setState({rating:e,isRating:!0});var n=this.props.onRating;n&&n(_objectSpread({},t,{rating:e}))}},{key:"onRate",value:function(e,t){this.setState({rating:e,lastRating:e,isRating:!1});var n=this.props.onRate;n&&n(_objectSpread({},t,{rating:e}))}},{key:"onCancelRate",value:function(){var e=this.state.lastRating;this.setState({rating:e,isRating:!1});var t=this.props.onCancelRate;t&&t({rating:e})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e,t){var n=e.rating;n!==t.rating&&this.setState({rating:n,lastRating:n})}},{key:"render",value:function(){var e=this,t=this.props,n=t.total,r=t.interactive,o=t.children,i=_objectWithoutProperties(t,["total","interactive","children"]),a=this.state,s=a.rating,c=a.isRating;o=_react.Children.toArray(o),delete i.rating,delete i.onRate,delete i.onRating,delete i.onCancelRate;var l=Array.apply(null,Array(n)).map((function(t,n){var i={isActive:!c&&s-n>=1,willBeActive:c&&n<s,isActiveHalf:!c&&s-n>=.5&&s-n<1,isDisabled:!r};return _react.default.createElement("div",{key:"star-".concat(n),onClick:r?e.onRate.bind(e,n+1):null,onMouseOver:r?e.willRate.bind(e,n+1):null},o.length?_react.default.cloneElement(o[n%o.length],i):_react.default.createElement(_star.default,i))}));return r?_react.default.createElement("div",_extends({className:"react-rater",onMouseOut:this.onCancelRate.bind(this)},i),l):_react.default.createElement("div",_extends({className:"react-rater"},i),l)}},{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}]),Rater}(_react.Component);exports.default=Rater,Rater.propTypes={total:_propTypes.default.number,rating:_propTypes.default.number,interactive:_propTypes.default.bool,children:_propTypes.default.any,onRate:_propTypes.default.func,onRating:_propTypes.default.func,onCancelRate:_propTypes.default.func},Rater.defaultProps={total:5,rating:0,interactive:!0},function(){var e="undefined"!==typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;e&&e.register(Rater,"Rater","/Users/simon/Individual/react-rater/src/index.js")}(),function(){var e="undefined"!==typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0;e&&e(module)}()}).call(this,__webpack_require__(203)(module))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(2)),o=i(n(31));function i(e){return e&&e.__esModule?e:{default:e}}function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}!function(){var t="undefined"!==typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0;t&&t(e)}();"undefined"!==typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var s=function(e){var t=Object.assign({},e),n={isDisabled:"is-disabled",isActive:"is-active",isActiveHalf:"is-active-half",willBeActive:"will-be-active"},o=Object.keys(n).filter((function(n){return delete t[n],e[n]})).map((function(e){return n[e]})).join(" ");return r.default.createElement("div",a({className:"react-rater-star ".concat(o)},t),"\u2605")};s.defaultProps={willBeActive:!1,isActive:!1,isActiveHalf:!1,isDisabled:!1},s.propTypes={isActive:o.default.bool,isActiveHalf:o.default.bool,willBeActive:o.default.bool,isDisabled:o.default.bool};var c=s,l=c;t.default=l,function(){var e="undefined"!==typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;e&&(e.register(s,"Star","/Users/simon/Individual/react-rater/src/star.js"),e.register(c,"default","/Users/simon/Individual/react-rater/src/star.js"))}(),function(){var t="undefined"!==typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0;t&&t(e)}()}).call(this,n(203)(e))},function(e,t,n){},function(e,t,n){var r=n(566),o=n(567),i=n(568),a=n(569);e.exports=function(e){return r(e)||o(e)||i(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(387);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(387);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";e.exports=n(572)},function(e,t,n){"use strict";var r,o=Symbol.for("react.element"),i=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),u=Symbol.for("react.context"),d=Symbol.for("react.server_context"),p=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen");function E(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case a:case c:case s:case h:case f:return e;default:switch(e=e&&e.$$typeof){case d:case u:case p:case v:case m:case l:return e;default:return t}}case i:return t}}}r=Symbol.for("react.module.reference"),t.ContextConsumer=u,t.ContextProvider=l,t.Element=o,t.ForwardRef=p,t.Fragment=a,t.Lazy=v,t.Memo=m,t.Portal=i,t.Profiler=c,t.StrictMode=s,t.Suspense=h,t.SuspenseList=f,t.isAsyncMode=function(){return!1},t.isConcurrentMode=function(){return!1},t.isContextConsumer=function(e){return E(e)===u},t.isContextProvider=function(e){return E(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===o},t.isForwardRef=function(e){return E(e)===p},t.isFragment=function(e){return E(e)===a},t.isLazy=function(e){return E(e)===v},t.isMemo=function(e){return E(e)===m},t.isPortal=function(e){return E(e)===i},t.isProfiler=function(e){return E(e)===c},t.isStrictMode=function(e){return E(e)===s},t.isSuspense=function(e){return E(e)===h},t.isSuspenseList=function(e){return E(e)===f},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===c||e===s||e===h||e===f||e===g||"object"===typeof e&&null!==e&&(e.$$typeof===v||e.$$typeof===m||e.$$typeof===l||e.$$typeof===u||e.$$typeof===p||e.$$typeof===r||void 0!==e.getModuleId)},t.typeOf=E},function(e,t,n){"use strict";(function(e){var n=function(){if("undefined"!==typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,r){return e[0]===t&&(n=r,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n++){var o=r[n];e.call(t,o[1],o[0])}},t}()}(),r="undefined"!==typeof window&&"undefined"!==typeof document&&window.document===document,o="undefined"!==typeof e&&e.Math===Math?e:"undefined"!==typeof self&&self.Math===Math?self:"undefined"!==typeof window&&window.Math===Math?window:Function("return this")(),i="function"===typeof requestAnimationFrame?requestAnimationFrame.bind(o):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var a=["top","right","bottom","left","width","height","size","weight"],s="undefined"!==typeof MutationObserver,c=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,r=!1,o=0;function a(){n&&(n=!1,e()),r&&c()}function s(){i(a)}function c(){var e=Date.now();if(n){if(e-o<2)return;r=!0}else n=!0,r=!1,setTimeout(s,t);o=e}return c}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){r&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),s?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){r&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;a.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),l=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];Object.defineProperty(e,o,{value:t[o],enumerable:!1,writable:!1,configurable:!0})}return e},u=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||o},d=g(0,0,0,0);function p(e){return parseFloat(e)||0}function h(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+p(e["border-"+n+"-width"])}),0)}function f(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return d;var r=u(e).getComputedStyle(e),o=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var o=r[n],i=e["padding-"+o];t[o]=p(i)}return t}(r),i=o.left+o.right,a=o.top+o.bottom,s=p(r.width),c=p(r.height);if("border-box"===r.boxSizing&&(Math.round(s+i)!==t&&(s-=h(r,"left","right")+i),Math.round(c+a)!==n&&(c-=h(r,"top","bottom")+a)),!function(e){return e===u(e).document.documentElement}(e)){var l=Math.round(s+i)-t,f=Math.round(c+a)-n;1!==Math.abs(l)&&(s-=l),1!==Math.abs(f)&&(c-=f)}return g(o.left,o.top,s,c)}var m="undefined"!==typeof SVGGraphicsElement?function(e){return e instanceof u(e).SVGGraphicsElement}:function(e){return e instanceof u(e).SVGElement&&"function"===typeof e.getBBox};function v(e){return r?m(e)?function(e){var t=e.getBBox();return g(0,0,t.width,t.height)}(e):f(e):d}function g(e,t,n,r){return{x:e,y:t,width:n,height:r}}var E=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=g(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=v(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),y=function(e,t){var n=function(e){var t=e.x,n=e.y,r=e.width,o=e.height,i="undefined"!==typeof DOMRectReadOnly?DOMRectReadOnly:Object,a=Object.create(i.prototype);return l(a,{x:t,y:n,width:r,height:o,top:n,right:t+r,bottom:o+n,left:t}),a}(t);l(this,{target:e,contentRect:n})},_=function(){function e(e,t,r){if(this.activeObservations_=[],this.observations_=new n,"function"!==typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=r}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(e instanceof u(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new E(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(e instanceof u(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new y(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),b="undefined"!==typeof WeakMap?new WeakMap:new n,T=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=c.getInstance(),r=new _(t,n,this);b.set(this,r)};["observe","unobserve","disconnect"].forEach((function(e){T.prototype[e]=function(){var t;return(t=b.get(this))[e].apply(t,arguments)}}));var S="undefined"!==typeof o.ResizeObserver?o.ResizeObserver:T;t.a=S}).call(this,n(36))},function(e,t,n){},function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var o=n(134),i=r(n(2)),a=n(196);n(31),n(176);var s=r(n(187));function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){e.prototype=Object.create(t.prototype),u(e.prototype.constructor=e,t)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],0<=t.indexOf(n)||(o[n]=e[n]);return o}var p=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).history=a.createBrowserHistory(t.props),t}return l(t,e),t.prototype.render=function(){return i.createElement(o.Router,{history:this.history,children:this.props.children})},t}(i.Component),h=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).history=a.createHashHistory(t.props),t}return l(t,e),t.prototype.render=function(){return i.createElement(o.Router,{history:this.history,children:this.props.children})},t}(i.Component),f=function(e,t){return"function"==typeof e?e(t):e},m=function(e,t){return"string"==typeof e?a.createLocation(e,null,null,t):e},v=function(e){return e},g=i.forwardRef;void 0===g&&(g=v);var E=g((function(e,t){var n=e.innerRef,r=e.navigate,o=e.onClick,a=d(e,["innerRef","navigate","onClick"]),s=a.target,l=c({},a,{onClick:function(t){try{o&&o(t)}catch(e){throw t.preventDefault(),e}t.defaultPrevented||0!==t.button||s&&"_self"!==s||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(t)||(t.preventDefault(),r())}});return l.ref=v!==g&&t||n,i.createElement("a",l)})),y=g((function(e,t){var n=e.component,r=void 0===n?E:n,l=e.replace,u=e.to,p=e.innerRef,h=d(e,["component","replace","to","innerRef"]);return i.createElement(o.__RouterContext.Consumer,null,(function(e){e||s(!1);var n=e.history,o=m(f(u,e.location),e.location),d=o?n.createHref(o):"",E=c({},h,{href:d,navigate:function(){var t=f(u,e.location),r=a.createPath(e.location)===a.createPath(m(t));(l||r?n.replace:n.push)(t)}});return v!==g?E.ref=t||p:E.innerRef=p,i.createElement(r,E)}))})),_=function(e){return e},b=i.forwardRef;void 0===b&&(b=_);var T=b((function(e,t){var n=e["aria-current"],r=void 0===n?"page":n,a=e.activeClassName,l=void 0===a?"active":a,u=e.activeStyle,p=e.className,h=e.exact,v=e.isActive,g=e.location,E=e.sensitive,T=e.strict,S=e.style,O=e.to,R=e.innerRef,C=d(e,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return i.createElement(o.__RouterContext.Consumer,null,(function(e){e||s(!1);var n=g||e.location,a=m(f(O,n),n),d=a.pathname,w=d&&d.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),I=w?o.matchPath(n.pathname,{path:w,exact:h,sensitive:E,strict:T}):null,A=!!(v?v(I,n):I),N="function"==typeof p?p(A):p,k="function"==typeof S?S(A):S;A&&(N=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return e})).join(" ")}(N,l),k=c({},k,u));var P=c({"aria-current":A&&r||null,className:N,style:k,to:a},C);return _!==b?P.ref=t||R:P.innerRef=R,i.createElement(y,P)}))}));Object.defineProperty(t,"MemoryRouter",{enumerable:!0,get:function(){return o.MemoryRouter}}),Object.defineProperty(t,"Prompt",{enumerable:!0,get:function(){return o.Prompt}}),Object.defineProperty(t,"Redirect",{enumerable:!0,get:function(){return o.Redirect}}),Object.defineProperty(t,"Route",{enumerable:!0,get:function(){return o.Route}}),Object.defineProperty(t,"Router",{enumerable:!0,get:function(){return o.Router}}),Object.defineProperty(t,"StaticRouter",{enumerable:!0,get:function(){return o.StaticRouter}}),Object.defineProperty(t,"Switch",{enumerable:!0,get:function(){return o.Switch}}),Object.defineProperty(t,"generatePath",{enumerable:!0,get:function(){return o.generatePath}}),Object.defineProperty(t,"matchPath",{enumerable:!0,get:function(){return o.matchPath}}),Object.defineProperty(t,"useHistory",{enumerable:!0,get:function(){return o.useHistory}}),Object.defineProperty(t,"useLocation",{enumerable:!0,get:function(){return o.useLocation}}),Object.defineProperty(t,"useParams",{enumerable:!0,get:function(){return o.useParams}}),Object.defineProperty(t,"useRouteMatch",{enumerable:!0,get:function(){return o.useRouteMatch}}),Object.defineProperty(t,"withRouter",{enumerable:!0,get:function(){return o.withRouter}}),t.BrowserRouter=p,t.HashRouter=h,t.Link=y,t.NavLink=T},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=c(e),a=r[0],s=r[1],l=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),u=0,d=s>0?a-4:a;for(n=0;n<d;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;2===s&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,l[u++]=255&t);1===s&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t);return l},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],a=16383,s=0,c=n-o;s<c;s+=a)i.push(l(e,s,s+a>c?c:s+a));1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=a[s],o[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var o,i,a=[],s=t;s<n;s+=3)o=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,a,s=8*o-r-1,c=(1<<s)-1,l=c>>1,u=-7,d=n?o-1:0,p=n?-1:1,h=e[t+d];for(d+=p,i=h&(1<<-u)-1,h>>=-u,u+=s;u>0;i=256*i+e[t+d],d+=p,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=r;u>0;a=256*a+e[t+d],d+=p,u-=8);if(0===i)i=1-l;else{if(i===c)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),i-=l}return(h?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,s,c,l=8*i-o-1,u=(1<<l)-1,d=u>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+d>=1?p/c:p*Math.pow(2,1-d))*c>=2&&(a++,c/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*c-1)*Math.pow(2,o),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,o),a=0));o>=8;e[n+h]=255&s,h+=f,s/=256,o-=8);for(a=a<<o|s,l+=o;l>0;e[n+h]=255&a,h+=f,a/=256,l-=8);e[n+h-f]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";var r=n(2),o=n(19),i=n(401),a=n(402),s=(n(294),n(663)),c=n(205),l=n(31),u=n(417),d=i({displayName:"Quill",mixins:[a],propTypes:{id:l.string,className:l.string,theme:l.string,style:l.object,readOnly:l.bool,value:l.oneOfType([l.string,l.shape({ops:l.array})]),defaultValue:l.oneOfType([l.string,l.shape({ops:l.array})]),placeholder:l.string,tabIndex:l.number,bounds:l.oneOfType([l.string,l.element]),onChange:l.func,onChangeSelection:l.func,onFocus:l.func,onBlur:l.func,onKeyPress:l.func,onKeyDown:l.func,onKeyUp:l.func,preserveWhitespace:l.bool,modules:function(e){var t=l.object.apply(this,arguments);return t||(e.modules&&e.modules.toolbar&&e.modules.toolbar[0]&&e.modules.toolbar[0].type?new Error("Since v1.0.0, React Quill will not create a custom toolbar for you anymore. Create a toolbar explictly, or let Quill create one. See: https://github.com/zenoamaro/react-quill#upgrading-to-react-quill-v100"):void 0)},toolbar:function(e){if("toolbar"in e)return new Error("The `toolbar` prop has been deprecated. Use `modules.toolbar` instead. See: https://github.com/zenoamaro/react-quill#upgrading-to-react-quill-v100")},formats:function(e){if(l.arrayOf(l.string).apply(this,arguments))return new Error("You cannot specify custom `formats` anymore. Use Parchment instead.  See: https://github.com/zenoamaro/react-quill#upgrading-to-react-quill-v100.")},styles:function(e){if("styles"in e)return new Error("The `styles` prop has been deprecated. Use custom stylesheets instead. See: https://github.com/zenoamaro/react-quill#upgrading-to-react-quill-v100.")},pollInterval:function(e){if("pollInterval"in e)return new Error("The `pollInterval` property does not have any effect anymore. You can safely remove it from your props.See: https://github.com/zenoamaro/react-quill#upgrading-to-react-quill-v100.")},children:function(e){if(l.element.apply(this,arguments))return new Error("The Quill editing area can only be composed of a single React element.");if(r.Children.count(e.children)&&"textarea"===r.Children.only(e.children).type)return new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}},dirtyProps:["modules","formats","bounds","theme","children"],cleanProps:["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],getDefaultProps:function(){return{theme:"snow",modules:{}}},isControlled:function(){return"value"in this.props},getInitialState:function(){return{generation:0,value:this.isControlled()?this.props.value:this.props.defaultValue}},componentWillReceiveProps:function(e,t){var n=this.editor;if(n){if("value"in e){var r=this.getEditorContents(),o=e.value;if(o===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas");this.isEqualValue(o,r)||this.setEditorContents(n,o)}return"readOnly"in e&&e.readOnly!==this.props.readOnly&&this.setEditorReadOnly(n,e.readOnly),this.shouldComponentRegenerate(e,t)?this.regenerate():void 0}},componentDidMount:function(){if(this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig()),this.quillDelta)return this.editor.setContents(this.quillDelta),this.editor.setSelection(this.quillSelection),this.editor.focus(),void(this.quillDelta=this.quillSelection=null);this.state.value&&this.setEditorContents(this.editor,this.state.value)},componentWillUnmount:function(){var e;(e=this.getEditor())&&(this.unhookEditor(e),this.editor=null)},shouldComponentUpdate:function(e,t){var n=this;return this.state.generation!==t.generation||s(this.cleanProps,(function(t){return!c(e[t],n.props[t])}))},shouldComponentRegenerate:function(e,t){var n=this;return s(this.dirtyProps,(function(t){return!c(e[t],n.props[t])}))},componentWillUpdate:function(e,t){this.state.generation!==t.generation&&this.componentWillUnmount()},componentDidUpdate:function(e,t){this.state.generation!==t.generation&&this.componentDidMount()},getEditorConfig:function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},getEditor:function(){return this.editor},getEditingArea:function(){return o.findDOMNode(this.editingArea)},getEditorContents:function(){return this.state.value},getEditorSelection:function(){return this.state.selection},isDelta:function(e){return e&&e.ops},isEqualValue:function(e,t){return this.isDelta(e)&&this.isDelta(t)?c(e.ops,t.ops):c(e,t)},regenerate:function(){this.quillDelta=this.editor.getContents(),this.quillSelection=this.editor.getSelection(),this.setState({generation:this.state.generation+1})},renderEditingArea:function(){var e=this,t=this.props.children,n=this.props.preserveWhitespace,o={key:this.state.generation,tabIndex:this.props.tabIndex,ref:function(t){e.editingArea=t}},i=r.Children.count(t)?r.Children.only(t):null,a=n?u.pre:u.div;return i?r.cloneElement(i,o):a(o)},render:function(){return u.div({id:this.props.id,style:this.props.style,key:this.state.generation,className:["quill"].concat(this.props.className).join(" "),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},onEditorChangeText:function(e,t,n,r){var o=this.getEditorContents(),i=this.isDelta(o)?r.getContents():r.getHTML();this.isEqualValue(i,o)||(this.lastDeltaChangeSet=t,this.setState({value:i}),this.props.onChange&&this.props.onChange(e,t,n,r))},onEditorChangeSelection:function(e,t,n){var r=this.getEditorSelection(),o=!r&&e,i=r&&!e;c(e,r)||(this.setState({selection:e}),this.props.onChangeSelection&&this.props.onChangeSelection(e,t,n),o&&this.props.onFocus?this.props.onFocus(e,t,n):i&&this.props.onBlur&&this.props.onBlur(r,t,n))},focus:function(){this.editor.focus()},blur:function(){this.setEditorSelection(this.editor,null)}});e.exports=d},function(e,t,n){"use strict";var r=n(38),o={};function i(e,t,n,r,o,i,a,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,o,i,a,s],u=0;(c=new Error(t.replace(/%s/g,(function(){return l[u++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}var a="mixins";e.exports=function(e,t,n){var s=[],c={mixins:"DEFINE_MANY",statics:"DEFINE_MANY",propTypes:"DEFINE_MANY",contextTypes:"DEFINE_MANY",childContextTypes:"DEFINE_MANY",getDefaultProps:"DEFINE_MANY_MERGED",getInitialState:"DEFINE_MANY_MERGED",getChildContext:"DEFINE_MANY_MERGED",render:"DEFINE_ONCE",componentWillMount:"DEFINE_MANY",componentDidMount:"DEFINE_MANY",componentWillReceiveProps:"DEFINE_MANY",shouldComponentUpdate:"DEFINE_ONCE",componentWillUpdate:"DEFINE_MANY",componentDidUpdate:"DEFINE_MANY",componentWillUnmount:"DEFINE_MANY",UNSAFE_componentWillMount:"DEFINE_MANY",UNSAFE_componentWillReceiveProps:"DEFINE_MANY",UNSAFE_componentWillUpdate:"DEFINE_MANY",updateComponent:"OVERRIDE_BASE"},l={getDerivedStateFromProps:"DEFINE_MANY_MERGED"},u={displayName:function(e,t){e.displayName=t},mixins:function(e,t){if(t)for(var n=0;n<t.length;n++)p(e,t[n])},childContextTypes:function(e,t){e.childContextTypes=r({},e.childContextTypes,t)},contextTypes:function(e,t){e.contextTypes=r({},e.contextTypes,t)},getDefaultProps:function(e,t){e.getDefaultProps?e.getDefaultProps=f(e.getDefaultProps,t):e.getDefaultProps=t},propTypes:function(e,t){e.propTypes=r({},e.propTypes,t)},statics:function(e,t){!function(e,t){if(!t)return;for(var n in t){var r=t[n];if(t.hasOwnProperty(n)){if(i(!(n in u),'ReactClass: You are attempting to define a reserved property, `%s`, that shouldn\'t be on the "statics" key. Define it as an instance property instead; it will still be accessible on the constructor.',n),n in e)return i("DEFINE_MANY_MERGED"===(l.hasOwnProperty(n)?l[n]:null),"ReactClass: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",n),void(e[n]=f(e[n],r));e[n]=r}}}(e,t)},autobind:function(){}};function d(e,t){var n=c.hasOwnProperty(t)?c[t]:null;y.hasOwnProperty(t)&&i("OVERRIDE_BASE"===n,"ReactClassInterface: You are attempting to override `%s` from your class specification. Ensure that your method names do not overlap with React methods.",t),e&&i("DEFINE_MANY"===n||"DEFINE_MANY_MERGED"===n,"ReactClassInterface: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",t)}function p(e,n){if(n){i("function"!==typeof n,"ReactClass: You're attempting to use a component class or function as a mixin. Instead, just use a regular object."),i(!t(n),"ReactClass: You're attempting to use a component as a mixin. Instead, just use a regular object.");var r=e.prototype,o=r.__reactAutoBindPairs;for(var s in n.hasOwnProperty(a)&&u.mixins(e,n.mixins),n)if(n.hasOwnProperty(s)&&s!==a){var l=n[s],p=r.hasOwnProperty(s);if(d(p,s),u.hasOwnProperty(s))u[s](e,l);else{var h=c.hasOwnProperty(s);if("function"===typeof l&&!h&&!p&&!1!==n.autobind)o.push(s,l),r[s]=l;else if(p){var v=c[s];i(h&&("DEFINE_MANY_MERGED"===v||"DEFINE_MANY"===v),"ReactClass: Unexpected spec policy %s for key %s when mixing in component specs.",v,s),"DEFINE_MANY_MERGED"===v?r[s]=f(r[s],l):"DEFINE_MANY"===v&&(r[s]=m(r[s],l))}else r[s]=l}}}else;}function h(e,t){for(var n in i(e&&t&&"object"===typeof e&&"object"===typeof t,"mergeIntoWithNoDuplicateKeys(): Cannot merge non-objects."),t)t.hasOwnProperty(n)&&(i(void 0===e[n],"mergeIntoWithNoDuplicateKeys(): Tried to merge two objects with the same key: `%s`. This conflict may be due to a mixin; in particular, this may be caused by two getInitialState() or getDefaultProps() methods returning objects with clashing keys.",n),e[n]=t[n]);return e}function f(e,t){return function(){var n=e.apply(this,arguments),r=t.apply(this,arguments);if(null==n)return r;if(null==r)return n;var o={};return h(o,n),h(o,r),o}}function m(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function v(e,t){return t.bind(e)}var g={componentDidMount:function(){this.__isMounted=!0}},E={componentWillUnmount:function(){this.__isMounted=!1}},y={replaceState:function(e,t){this.updater.enqueueReplaceState(this,e,t)},isMounted:function(){return!!this.__isMounted}},_=function(){};return r(_.prototype,e.prototype,y),function(e){var t=function(e,r,a){this.__reactAutoBindPairs.length&&function(e){for(var t=e.__reactAutoBindPairs,n=0;n<t.length;n+=2){var r=t[n],o=t[n+1];e[r]=v(e,o)}}(this),this.props=e,this.context=r,this.refs=o,this.updater=a||n,this.state=null;var s=this.getInitialState?this.getInitialState():null;i("object"===typeof s&&!Array.isArray(s),"%s.getInitialState(): must return an object or null",t.displayName||"ReactCompositeComponent"),this.state=s};for(var r in t.prototype=new _,t.prototype.constructor=t,t.prototype.__reactAutoBindPairs=[],s.forEach(p.bind(null,t)),p(t,g),p(t,e),p(t,E),t.getDefaultProps&&(t.defaultProps=t.getDefaultProps()),i(t.prototype.render,"createClass(...): Class specification must implement a `render` method."),c)t.prototype[r]||(t.prototype[r]=null);return t}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(408),o=n(295),i=n(664),a=n(154),s=n(670);e.exports=function(e,t,n){var c=a(e)?r:i;return n&&s(e,t,n)&&(t=void 0),c(e,o(t,3))}},function(e,t,n){var r=n(665);e.exports=function(e,t){var n;return r(e,(function(e,r,o){return!(n=t(e,r,o))})),!!n}},function(e,t,n){var r=n(666),o=n(669)(r);e.exports=o},function(e,t,n){var r=n(667),o=n(239);e.exports=function(e,t){return e&&r(e,t,o)}},function(e,t,n){var r=n(668)();e.exports=r},function(e,t){e.exports=function(e){return function(t,n,r){for(var o=-1,i=Object(t),a=r(t),s=a.length;s--;){var c=a[e?s:++o];if(!1===n(i[c],c,i))break}return t}}},function(e,t,n){var r=n(241);e.exports=function(e,t){return function(n,o){if(null==n)return n;if(!r(n))return e(n,o);for(var i=n.length,a=t?i:-1,s=Object(n);(t?a--:++a<i)&&!1!==o(s[a],a,s););return n}}},function(e,t,n){var r=n(235),o=n(241),i=n(240),a=n(167);e.exports=function(e,t,n){if(!a(n))return!1;var s=typeof t;return!!("number"==s?o(n)&&i(t,n.length):"string"==s&&t in n)&&r(n[t],e)}},function(e,t,n){"use strict";n(2);var r=n(418),o=n(401),i=n(294),a=n(205),s=n(31),c=n(417),l=["rgb(  0,   0,   0)","rgb(230,   0,   0)","rgb(255, 153,   0)","rgb(255, 255,   0)","rgb(  0, 138,   0)","rgb(  0, 102, 204)","rgb(153,  51, 255)","rgb(255, 255, 255)","rgb(250, 204, 204)","rgb(255, 235, 204)","rgb(255, 255, 204)","rgb(204, 232, 204)","rgb(204, 224, 245)","rgb(235, 214, 255)","rgb(187, 187, 187)","rgb(240, 102, 102)","rgb(255, 194, 102)","rgb(255, 255, 102)","rgb(102, 185, 102)","rgb(102, 163, 224)","rgb(194, 133, 255)","rgb(136, 136, 136)","rgb(161,   0,   0)","rgb(178, 107,   0)","rgb(178, 178,   0)","rgb(  0,  97,   0)","rgb(  0,  71, 178)","rgb(107,  36, 178)","rgb( 68,  68,  68)","rgb( 92,   0,   0)","rgb(102,  61,   0)","rgb(102, 102,   0)","rgb(  0,  55,   0)","rgb(  0,  41, 102)","rgb( 61,  20,  10)"].map((function(e){return{value:e}})),u=[{label:"Formats",type:"group",items:[{label:"Font",type:"font",items:[{label:"Sans Serif",value:"sans-serif",selected:!0},{label:"Serif",value:"serif"},{label:"Monospace",value:"monospace"}]},{label:"Size",type:"size",items:[{label:"Small",value:"10px"},{label:"Normal",value:"13px",selected:!0},{label:"Large",value:"18px"},{label:"Huge",value:"32px"}]},{label:"Alignment",type:"align",items:[{label:"",value:"",selected:!0},{label:"",value:"center"},{label:"",value:"right"},{label:"",value:"justify"}]}]},{label:"Text",type:"group",items:[{type:"bold",label:"Bold"},{type:"italic",label:"Italic"},{type:"strike",label:"Strike"},{type:"underline",label:"Underline"},{type:"color",label:"Color",items:l},{type:"background",label:"Background color",items:l},{type:"link",label:"Link"}]},{label:"Blocks",type:"group",items:[{type:"list",value:"bullet"},{type:"list",value:"ordered"}]},{label:"Blocks",type:"group",items:[{type:"image",label:"Image"}]}],d=o({displayName:"Quill Toolbar",propTypes:{id:s.string,className:s.string,style:s.object,items:s.array},getDefaultProps:function(){return{items:u}},componentDidMount:function(){console.warn("QuillToolbar is deprecated. Consider switching to the official Quill toolbar format, or providing your own toolbar instead. See: https://github.com/zenoamaro/react-quill#upgrading-to-react-quill-v1-0-0")},shouldComponentUpdate:function(e,t){return!a(e,this.props)},renderGroup:function(e,t){return c.span({key:e.label||t,className:"ql-formats"},e.items.map(this.renderItem))},renderChoiceItem:function(e,t){return c.option({key:e.label||e.value||t,value:e.value},e.label)},renderChoices:function(e,t){var n=e.items.map(this.renderChoiceItem),r=i(e.items,(function(e){return e.selected})),o={key:e.label||t,title:e.label,className:"ql-"+e.type,value:r.value};return c.select(o,n)},renderButton:function(e,t){return c.button({type:"button",key:e.label||e.value||t,value:e.value,className:"ql-"+e.type,title:e.label},e.children)},renderAction:function(e,t){return c.button({key:e.label||e.value||t,className:"ql-"+e.type,title:e.label},e.children)},renderItem:function(e,t){switch(e.type){case"group":return this.renderGroup(e,t);case"font":case"header":case"align":case"size":case"color":case"background":return this.renderChoices(e,t);case"bold":case"italic":case"underline":case"strike":case"link":case"list":case"bullet":case"ordered":case"indent":case"image":case"video":return this.renderButton(e,t);default:return this.renderAction(e,t)}},getClassName:function(){return"quill-toolbar "+(this.props.className||"")},render:function(){var e=this.props.items.map(this.renderItem).map(r.renderToStaticMarkup).join("");return c.div({id:this.props.id,className:this.getClassName(),style:this.props.style,dangerouslySetInnerHTML:{__html:e}})}});e.exports=d,d.defaultItems=u,d.defaultColors=l},function(e,t,n){"use strict";var r=n(38),o=n(2);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a="function"===typeof Symbol&&Symbol.for,s=a?Symbol.for("react.portal"):60106,c=a?Symbol.for("react.fragment"):60107,l=a?Symbol.for("react.strict_mode"):60108,u=a?Symbol.for("react.profiler"):60114,d=a?Symbol.for("react.provider"):60109,p=a?Symbol.for("react.context"):60110,h=a?Symbol.for("react.concurrent_mode"):60111,f=a?Symbol.for("react.forward_ref"):60112,m=a?Symbol.for("react.suspense"):60113,v=a?Symbol.for("react.suspense_list"):60120,g=a?Symbol.for("react.memo"):60115,E=a?Symbol.for("react.lazy"):60116,y=a?Symbol.for("react.block"):60121,_=a?Symbol.for("react.fundamental"):60117,b=a?Symbol.for("react.scope"):60119;function T(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case c:return"Fragment";case s:return"Portal";case u:return"Profiler";case l:return"StrictMode";case m:return"Suspense";case v:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case p:return"Context.Consumer";case d:return"Context.Provider";case f:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case g:return T(e.type);case y:return T(e.render);case E:if(e=1===e._status?e._result:null)return T(e)}return null}var S=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;S.hasOwnProperty("ReactCurrentDispatcher")||(S.ReactCurrentDispatcher={current:null}),S.hasOwnProperty("ReactCurrentBatchConfig")||(S.ReactCurrentBatchConfig={suspense:null});var O={};function R(e,t){for(var n=0|e._threadCount;n<=t;n++)e[n]=e._currentValue2,e._threadCount=n+1}for(var C=new Uint16Array(16),w=0;15>w;w++)C[w]=w+1;C[15]=0;var I=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,A=Object.prototype.hasOwnProperty,N={},k={};function P(e){return!!A.call(k,e)||!A.call(N,e)&&(I.test(e)?k[e]=!0:(N[e]=!0,!1))}function D(e,t,n,r,o,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i}var M={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){M[e]=new D(e,0,!1,e,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];M[t]=new D(t,1,!1,e[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){M[e]=new D(e,2,!1,e.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){M[e]=new D(e,2,!1,e,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){M[e]=new D(e,3,!1,e.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(e){M[e]=new D(e,3,!0,e,null,!1)})),["capture","download"].forEach((function(e){M[e]=new D(e,4,!1,e,null,!1)})),["cols","rows","size","span"].forEach((function(e){M[e]=new D(e,6,!1,e,null,!1)})),["rowSpan","start"].forEach((function(e){M[e]=new D(e,5,!1,e.toLowerCase(),null,!1)}));var L=/[\-:]([a-z])/g;function x(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(L,x);M[t]=new D(t,1,!1,e,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(L,x);M[t]=new D(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(L,x);M[t]=new D(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(e){M[e]=new D(e,1,!1,e.toLowerCase(),null,!1)})),M.xlinkHref=new D("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(e){M[e]=new D(e,1,!1,e.toLowerCase(),null,!0)}));var U=/["'&<>]/;function j(e){if("boolean"===typeof e||"number"===typeof e)return""+e;e=""+e;var t=U.exec(e);if(t){var n,r="",o=0;for(n=t.index;n<e.length;n++){switch(e.charCodeAt(n)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}o!==n&&(r+=e.substring(o,n)),o=n+1,r+=t}e=o!==n?r+e.substring(o,n):r}return e}function F(e,t){var n,r=M.hasOwnProperty(e)?M[e]:null;return(n="style"!==e)&&(n=null!==r?0===r.type:2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])),n||function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(e,t,r,!1)?"":null!==r?(e=r.attributeName,3===(n=r.type)||4===n&&!0===t?e+'=""':(r.sanitizeURL&&(t=""+t),e+'="'+j(t)+'"')):P(e)?e+'="'+j(t)+'"':""}var B="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},V=null,H=null,G=null,W=!1,q=!1,K=null,Y=0;function z(){if(null===V)throw Error(i(321));return V}function X(){if(0<Y)throw Error(i(312));return{memoizedState:null,queue:null,next:null}}function J(){return null===G?null===H?(W=!1,H=G=X()):(W=!0,G=H):null===G.next?(W=!1,G=G.next=X()):(W=!0,G=G.next),G}function Z(e,t,n,r){for(;q;)q=!1,Y+=1,G=null,n=e(t,r);return H=V=null,Y=0,G=K=null,n}function Q(e,t){return"function"===typeof t?t(e):t}function $(e,t,n){if(V=z(),G=J(),W){var r=G.queue;if(t=r.dispatch,null!==K&&void 0!==(n=K.get(r))){K.delete(r),r=G.memoizedState;do{r=e(r,n.action),n=n.next}while(null!==n);return G.memoizedState=r,[r,t]}return[G.memoizedState,t]}return e=e===Q?"function"===typeof t?t():t:void 0!==n?n(t):t,G.memoizedState=e,e=(e=G.queue={last:null,dispatch:null}).dispatch=ee.bind(null,V,e),[G.memoizedState,e]}function ee(e,t,n){if(!(25>Y))throw Error(i(301));if(e===V)if(q=!0,e={action:n,next:null},null===K&&(K=new Map),void 0===(n=K.get(t)))K.set(t,e);else{for(t=n;null!==t.next;)t=t.next;t.next=e}}function te(){}var ne=0,re={readContext:function(e){var t=ne;return R(e,t),e[t]},useContext:function(e){z();var t=ne;return R(e,t),e[t]},useMemo:function(e,t){if(V=z(),t=void 0===t?null:t,null!==(G=J())){var n=G.memoizedState;if(null!==n&&null!==t){e:{var r=n[1];if(null===r)r=!1;else{for(var o=0;o<r.length&&o<t.length;o++)if(!B(t[o],r[o])){r=!1;break e}r=!0}}if(r)return n[0]}}return e=e(),G.memoizedState=[e,t],e},useReducer:$,useRef:function(e){V=z();var t=(G=J()).memoizedState;return null===t?(e={current:e},G.memoizedState=e):t},useState:function(e){return $(Q,e)},useLayoutEffect:function(){},useCallback:function(e){return e},useImperativeHandle:te,useEffect:te,useDebugValue:te,useResponder:function(e,t){return{props:t,responder:e}},useDeferredValue:function(e){return z(),e},useTransition:function(){return z(),[function(e){e()},!1]}},oe="http://www.w3.org/1999/xhtml";function ie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}var ae={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},se=r({menuitem:!0},ae),ce={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},le=["Webkit","ms","Moz","O"];Object.keys(ce).forEach((function(e){le.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ce[t]=ce[e]}))}));var ue=/([A-Z])/g,de=/^ms-/,pe=o.Children.toArray,he=S.ReactCurrentDispatcher,fe={listing:!0,pre:!0,textarea:!0},me=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,ve={},ge={};var Ee=Object.prototype.hasOwnProperty,ye={children:null,dangerouslySetInnerHTML:null,suppressContentEditableWarning:null,suppressHydrationWarning:null};function _e(e,t){if(void 0===e)throw Error(i(152,T(t)||"Component"))}function be(e,t,n){function a(o,a){var s=a.prototype&&a.prototype.isReactComponent,c=function(e,t,n,r){if(r&&"object"===typeof(r=e.contextType)&&null!==r)return R(r,n),r[n];if(e=e.contextTypes){for(var o in n={},e)n[o]=t[o];t=n}else t=O;return t}(a,t,n,s),l=[],u=!1,d={isMounted:function(){return!1},enqueueForceUpdate:function(){if(null===l)return null},enqueueReplaceState:function(e,t){u=!0,l=[t]},enqueueSetState:function(e,t){if(null===l)return null;l.push(t)}};if(s){if(s=new a(o.props,c,d),"function"===typeof a.getDerivedStateFromProps){var p=a.getDerivedStateFromProps.call(null,o.props,s.state);null!=p&&(s.state=r({},s.state,p))}}else if(V={},s=a(o.props,c,d),null==(s=Z(a,o.props,s,c))||null==s.render)return void _e(e=s,a);if(s.props=o.props,s.context=c,s.updater=d,void 0===(d=s.state)&&(s.state=d=null),"function"===typeof s.UNSAFE_componentWillMount||"function"===typeof s.componentWillMount)if("function"===typeof s.componentWillMount&&"function"!==typeof a.getDerivedStateFromProps&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&"function"!==typeof a.getDerivedStateFromProps&&s.UNSAFE_componentWillMount(),l.length){d=l;var h=u;if(l=null,u=!1,h&&1===d.length)s.state=d[0];else{p=h?d[0]:s.state;var f=!0;for(h=h?1:0;h<d.length;h++){var m=d[h];null!=(m="function"===typeof m?m.call(s,p,o.props,c):m)&&(f?(f=!1,p=r({},p,m)):r(p,m))}s.state=p}}else l=null;if(_e(e=s.render(),a),"function"===typeof s.getChildContext&&"object"===typeof(o=a.childContextTypes)){var v=s.getChildContext();for(var g in v)if(!(g in o))throw Error(i(108,T(a)||"Unknown",g))}v&&(t=r({},t,v))}for(;o.isValidElement(e);){var s=e,c=s.type;if("function"!==typeof c)break;a(s,c)}return{child:e,context:t}}var Te=function(){function e(e,t){o.isValidElement(e)?e.type!==c?e=[e]:(e=e.props.children,e=o.isValidElement(e)?[e]:pe(e)):e=pe(e),e={type:null,domNamespace:oe,children:e,childIndex:0,context:O,footer:""};var n=C[0];if(0===n){var r=C,a=2*(n=r.length);if(!(65536>=a))throw Error(i(304));var s=new Uint16Array(a);for(s.set(r),(C=s)[0]=n+1,r=n;r<a-1;r++)C[r]=r+1;C[a-1]=0}else C[0]=C[n];this.threadID=n,this.stack=[e],this.exhausted=!1,this.currentSelectValue=null,this.previousWasTextNode=!1,this.makeStaticMarkup=t,this.suspenseDepth=0,this.contextIndex=-1,this.contextStack=[],this.contextValueStack=[]}var t=e.prototype;return t.destroy=function(){if(!this.exhausted){this.exhausted=!0,this.clearProviders();var e=this.threadID;C[e]=C[0],C[0]=e}},t.pushProvider=function(e){var t=++this.contextIndex,n=e.type._context,r=this.threadID;R(n,r);var o=n[r];this.contextStack[t]=n,this.contextValueStack[t]=o,n[r]=e.props.value},t.popProvider=function(){var e=this.contextIndex,t=this.contextStack[e],n=this.contextValueStack[e];this.contextStack[e]=null,this.contextValueStack[e]=null,this.contextIndex--,t[this.threadID]=n},t.clearProviders=function(){for(var e=this.contextIndex;0<=e;e--)this.contextStack[e][this.threadID]=this.contextValueStack[e]},t.read=function(e){if(this.exhausted)return null;var t=ne;ne=this.threadID;var n=he.current;he.current=re;try{for(var r=[""],o=!1;r[0].length<e;){if(0===this.stack.length){this.exhausted=!0;var a=this.threadID;C[a]=C[0],C[0]=a;break}var s=this.stack[this.stack.length-1];if(o||s.childIndex>=s.children.length){var c=s.footer;if(""!==c&&(this.previousWasTextNode=!1),this.stack.pop(),"select"===s.type)this.currentSelectValue=null;else if(null!=s.type&&null!=s.type.type&&s.type.type.$$typeof===d)this.popProvider(s.type);else if(s.type===m){this.suspenseDepth--;var l=r.pop();if(o){o=!1;var u=s.fallbackFrame;if(!u)throw Error(i(303));this.stack.push(u),r[this.suspenseDepth]+="\x3c!--$!--\x3e";continue}r[this.suspenseDepth]+=l}r[this.suspenseDepth]+=c}else{var p=s.children[s.childIndex++],h="";try{h+=this.render(p,s.context,s.domNamespace)}catch(f){if(null!=f&&"function"===typeof f.then)throw Error(i(294));throw f}r.length<=this.suspenseDepth&&r.push(""),r[this.suspenseDepth]+=h}}return r[0]}finally{he.current=n,ne=t}},t.render=function(e,t,n){if("string"===typeof e||"number"===typeof e)return""===(n=""+e)?"":this.makeStaticMarkup?j(n):this.previousWasTextNode?"\x3c!-- --\x3e"+j(n):(this.previousWasTextNode=!0,j(n));if(e=(t=be(e,t,this.threadID)).child,t=t.context,null===e||!1===e)return"";if(!o.isValidElement(e)){if(null!=e&&null!=e.$$typeof){if((n=e.$$typeof)===s)throw Error(i(257));throw Error(i(258,n.toString()))}return e=pe(e),this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),""}var a=e.type;if("string"===typeof a)return this.renderDOM(e,t,n);switch(a){case l:case h:case u:case v:case c:return e=pe(e.props.children),this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case m:throw Error(i(294))}if("object"===typeof a&&null!==a)switch(a.$$typeof){case f:V={};var y=a.render(e.props,e.ref);return y=Z(a.render,e.props,y,e.ref),y=pe(y),this.stack.push({type:null,domNamespace:n,children:y,childIndex:0,context:t,footer:""}),"";case g:return e=[o.createElement(a.type,r({ref:e.ref},e.props))],this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case d:return n={type:e,domNamespace:n,children:a=pe(e.props.children),childIndex:0,context:t,footer:""},this.pushProvider(e),this.stack.push(n),"";case p:a=e.type,y=e.props;var T=this.threadID;return R(a,T),a=pe(y.children(a[T])),this.stack.push({type:e,domNamespace:n,children:a,childIndex:0,context:t,footer:""}),"";case _:throw Error(i(338));case E:switch(function(e){if(-1===e._status){e._status=0;var t=e._ctor;t=t(),e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}}(a=e.type),a._status){case 1:return e=[o.createElement(a._result,r({ref:e.ref},e.props))],this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case 2:throw a._result;default:throw Error(i(295))}case b:throw Error(i(343))}throw Error(i(130,null==a?a:typeof a,""))},t.renderDOM=function(e,t,n){var a=e.type.toLowerCase();if(n===oe&&ie(a),!ve.hasOwnProperty(a)){if(!me.test(a))throw Error(i(65,a));ve[a]=!0}var s=e.props;if("input"===a)s=r({type:void 0},s,{defaultChecked:void 0,defaultValue:void 0,value:null!=s.value?s.value:s.defaultValue,checked:null!=s.checked?s.checked:s.defaultChecked});else if("textarea"===a){var c=s.value;if(null==c){c=s.defaultValue;var l=s.children;if(null!=l){if(null!=c)throw Error(i(92));if(Array.isArray(l)){if(!(1>=l.length))throw Error(i(93));l=l[0]}c=""+l}null==c&&(c="")}s=r({},s,{value:void 0,children:""+c})}else if("select"===a)this.currentSelectValue=null!=s.value?s.value:s.defaultValue,s=r({},s,{value:void 0});else if("option"===a){l=this.currentSelectValue;var u=function(e){if(void 0===e||null===e)return e;var t="";return o.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(s.children);if(null!=l){var d=null!=s.value?s.value+"":u;if(c=!1,Array.isArray(l)){for(var p=0;p<l.length;p++)if(""+l[p]===d){c=!0;break}}else c=""+l===d;s=r({selected:void 0,children:void 0},s,{selected:c,children:u})}}if(c=s){if(se[a]&&(null!=c.children||null!=c.dangerouslySetInnerHTML))throw Error(i(137,a,""));if(null!=c.dangerouslySetInnerHTML){if(null!=c.children)throw Error(i(60));if("object"!==typeof c.dangerouslySetInnerHTML||!("__html"in c.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=c.style&&"object"!==typeof c.style)throw Error(i(62,""))}for(_ in c=s,l=this.makeStaticMarkup,u=1===this.stack.length,d="<"+e.type,c)if(Ee.call(c,_)){var h=c[_];if(null!=h){if("style"===_){p=void 0;var f="",m="";for(p in h)if(h.hasOwnProperty(p)){var v=0===p.indexOf("--"),g=h[p];if(null!=g){if(v)var E=p;else if(E=p,ge.hasOwnProperty(E))E=ge[E];else{var y=E.replace(ue,"-$1").toLowerCase().replace(de,"-ms-");E=ge[E]=y}f+=m+E+":",m=p,f+=v=null==g||"boolean"===typeof g||""===g?"":v||"number"!==typeof g||0===g||ce.hasOwnProperty(m)&&ce[m]?(""+g).trim():g+"px",m=";"}}h=f||null}p=null;e:if(v=a,g=c,-1===v.indexOf("-"))v="string"===typeof g.is;else switch(v){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":v=!1;break e;default:v=!0}v?ye.hasOwnProperty(_)||(p=P(p=_)&&null!=h?p+'="'+j(h)+'"':""):p=F(_,h),p&&(d+=" "+p)}}l||u&&(d+=' data-reactroot=""');var _=d;c="",ae.hasOwnProperty(a)?_+="/>":(_+=">",c="</"+e.type+">");e:{if(null!=(l=s.dangerouslySetInnerHTML)){if(null!=l.__html){l=l.__html;break e}}else if("string"===typeof(l=s.children)||"number"===typeof l){l=j(l);break e}l=null}return null!=l?(s=[],fe.hasOwnProperty(a)&&"\n"===l.charAt(0)&&(_+="\n"),_+=l):s=pe(s.children),e=e.type,n=null==n||"http://www.w3.org/1999/xhtml"===n?ie(e):"http://www.w3.org/2000/svg"===n&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":n,this.stack.push({domNamespace:n,type:a,children:s,childIndex:0,context:t,footer:c}),this.previousWasTextNode=!1,_},e}(),Se={renderToString:function(e){e=new Te(e,!1);try{return e.read(1/0)}finally{e.destroy()}},renderToStaticMarkup:function(e){e=new Te(e,!0);try{return e.read(1/0)}finally{e.destroy()}},renderToNodeStream:function(){throw Error(i(207))},renderToStaticNodeStream:function(){throw Error(i(208))},version:"16.14.0"};e.exports=Se.default||Se},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(132),o=n(304),i=n(124),a=6e4;function s(e,t){Object(i.a)(2,arguments);var n=Object(r.a)(t);return Object(o.a)(e,n*a)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(132),o=n(304),i=n(124),a=36e5;function s(e,t){Object(i.a)(2,arguments);var n=Object(r.a)(t);return Object(o.a)(e,n*a)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(306),o=n(124),i=n(132);function a(e,t){Object(o.a)(2,arguments);var n=Object(i.a)(t);return Object(r.default)(e,-n)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(132),o=n(428),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=Object(r.a)(t);return Object(o.default)(e,-n)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(132),o=n(244),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=Object(r.a)(t);return Object(o.default)(e,-n)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(132),o=n(429),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=Object(r.a)(t);return Object(o.default)(e,-n)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(132),o=n(430),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=Object(r.a)(t);return Object(o.default)(e,-n)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){return Object(o.a)(1,arguments),Object(r.default)(e).getSeconds()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){return Object(o.a)(1,arguments),Object(r.default)(e).getMinutes()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){return Object(o.a)(1,arguments),Object(r.default)(e).getHours()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){return Object(o.a)(1,arguments),Object(r.default)(e).getDay()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){return Object(o.a)(1,arguments),Object(r.default)(e).getDate()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){return Object(o.a)(1,arguments),Object(r.default)(e).getMonth()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){Object(o.a)(1,arguments);var t=Object(r.default)(e);return Math.floor(t.getMonth()/3)+1}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){return Object(o.a)(1,arguments),Object(r.default)(e).getFullYear()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){return Object(o.a)(1,arguments),Object(r.default)(e).getTime()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(132),o=n(126),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=Object(o.default)(e),a=Object(r.a)(t);return n.setSeconds(a),n}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(132),o=n(126),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=Object(o.default)(e),a=Object(r.a)(t);return n.setMinutes(a),n}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(132),o=n(126),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=Object(o.default)(e),a=Object(r.a)(t);return n.setHours(a),n}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(132),o=n(126),i=n(329),a=n(124);function s(e,t){Object(a.a)(2,arguments);var n=Object(o.default)(e),s=Object(r.a)(t)-(Math.floor(n.getMonth()/3)+1);return Object(i.default)(n,n.getMonth()+3*s)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(132),o=n(126),i=n(124);function a(e,t){Object(i.a)(2,arguments);var n=Object(o.default)(e),a=Object(r.a)(t);return isNaN(n.getTime())?new Date(NaN):(n.setFullYear(a),n)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(25),o=n(126),i=n(124);function a(e){var t,n;if(Object(i.a)(1,arguments),e&&"function"===typeof e.forEach)t=e;else{if("object"!==Object(r.a)(e)||null===e)return new Date(NaN);t=Array.prototype.slice.call(e)}return t.forEach((function(e){var t=Object(o.default)(e);(void 0===n||n>t||isNaN(t.getDate()))&&(n=t)})),n||new Date(NaN)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(25),o=n(126),i=n(124);function a(e){var t,n;if(Object(i.a)(1,arguments),e&&"function"===typeof e.forEach)t=e;else{if("object"!==Object(r.a)(e)||null===e)return new Date(NaN);t=Array.prototype.slice.call(e)}return t.forEach((function(e){var t=Object(o.default)(e);(void 0===n||n<t||isNaN(Number(t)))&&(n=t)})),n||new Date(NaN)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(303),o=n(307),i=n(124),a=864e5;function s(e,t){Object(i.a)(2,arguments);var n=Object(o.default)(e),s=Object(o.default)(t),c=n.getTime()-Object(r.a)(n),l=s.getTime()-Object(r.a)(s);return Math.round((c-l)/a)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e,t){Object(o.a)(2,arguments);var n=Object(r.default)(e),i=Object(r.default)(t);return 12*(n.getFullYear()-i.getFullYear())+(n.getMonth()-i.getMonth())}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e,t){Object(o.a)(2,arguments);var n=Object(r.default)(e),i=Object(r.default)(t);return n.getFullYear()-i.getFullYear()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){Object(o.a)(1,arguments);var t=Object(r.default)(e);return t.setDate(1),t.setHours(0,0,0,0),t}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){Object(o.a)(1,arguments);var t=Object(r.default)(e),n=new Date(0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){Object(o.a)(1,arguments);var t=Object(r.default)(e);return t.setHours(23,59,59,999),t}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(169),o=n(126),i=n(132),a=n(124);function s(e,t){var n,s,c,l,u,d,p,h;Object(a.a)(1,arguments);var f=Object(r.a)(),m=Object(i.a)(null!==(n=null!==(s=null!==(c=null!==(l=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==l?l:null===t||void 0===t||null===(u=t.locale)||void 0===u||null===(d=u.options)||void 0===d?void 0:d.weekStartsOn)&&void 0!==c?c:f.weekStartsOn)&&void 0!==s?s:null===(p=f.locale)||void 0===p||null===(h=p.options)||void 0===h?void 0:h.weekStartsOn)&&void 0!==n?n:0);if(!(m>=0&&m<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var v=Object(o.default)(e),g=v.getDay(),E=6+(g<m?-7:0)-(g-m);return v.setDate(v.getDate()+E),v.setHours(23,59,59,999),v}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){Object(o.a)(1,arguments);var t=Object(r.default)(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e){Object(o.a)(1,arguments);var t=Object(r.default)(e),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e,t){Object(o.a)(2,arguments);var n=Object(r.default)(e),i=Object(r.default)(t);return n.getTime()===i.getTime()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(307),o=n(124);function i(e,t){Object(o.a)(2,arguments);var n=Object(r.default)(e),i=Object(r.default)(t);return n.getTime()===i.getTime()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e,t){Object(o.a)(2,arguments);var n=Object(r.default)(e),i=Object(r.default)(t);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e,t){Object(o.a)(2,arguments);var n=Object(r.default)(e),i=Object(r.default)(t);return n.getFullYear()===i.getFullYear()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(432),o=n(124);function i(e,t){Object(o.a)(2,arguments);var n=Object(r.default)(e),i=Object(r.default)(t);return n.getTime()===i.getTime()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e,t){Object(o.a)(2,arguments);var n=Object(r.default)(e),i=Object(r.default)(t);return n.getTime()>i.getTime()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e,t){Object(o.a)(2,arguments);var n=Object(r.default)(e),i=Object(r.default)(t);return n.getTime()<i.getTime()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(126),o=n(124);function i(e,t){Object(o.a)(2,arguments);var n=Object(r.default)(e).getTime(),i=Object(r.default)(t.start).getTime(),a=Object(r.default)(t.end).getTime();if(!(i<=a))throw new RangeError("Invalid interval");return n>=i&&n<=a}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(433),o=n(124),i=n(132);function a(e,t){var n;Object(o.a)(1,arguments);var a=Object(i.a)(null!==(n=null===t||void 0===t?void 0:t.additionalDigits)&&void 0!==n?n:2);if(2!==a&&1!==a&&0!==a)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!==typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var m,v=function(e){var t,n={},r=e.split(s.dateTimeDelimiter);if(r.length>2)return n;/:/.test(r[0])?t=r[0]:(n.date=r[0],t=r[1],s.timeZoneDelimiter.test(n.date)&&(n.date=e.split(s.timeZoneDelimiter)[0],t=e.substr(n.date.length,e.length)));if(t){var o=s.timezone.exec(t);o?(n.time=t.replace(o[1],""),n.timezone=o[1]):n.time=t}return n}(e);if(v.date){var g=function(e,t){var n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};var o=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:null===i?o:100*i,restDateString:e.slice((r[1]||r[2]).length)}}(v.date,a);m=function(e,t){if(null===t)return new Date(NaN);var n=e.match(c);if(!n)return new Date(NaN);var r=!!n[4],o=d(n[1]),i=d(n[2])-1,a=d(n[3]),s=d(n[4]),l=d(n[5])-1;if(r)return function(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}(0,s,l)?function(e,t,n){var r=new Date(0);r.setUTCFullYear(e,0,4);var o=r.getUTCDay()||7,i=7*(t-1)+n+1-o;return r.setUTCDate(r.getUTCDate()+i),r}(t,s,l):new Date(NaN);var u=new Date(0);return function(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(h[t]||(f(e)?29:28))}(t,i,a)&&function(e,t){return t>=1&&t<=(f(e)?366:365)}(t,o)?(u.setUTCFullYear(t,i,Math.max(o,a)),u):new Date(NaN)}(g.restDateString,g.year)}if(!m||isNaN(m.getTime()))return new Date(NaN);var E,y=m.getTime(),_=0;if(v.time&&(_=function(e){var t=e.match(l);if(!t)return NaN;var n=p(t[1]),o=p(t[2]),i=p(t[3]);if(!function(e,t,n){if(24===e)return 0===t&&0===n;return n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}(n,o,i))return NaN;return n*r.a+o*r.b+1e3*i}(v.time),isNaN(_)))return new Date(NaN);if(!v.timezone){var b=new Date(y+_),T=new Date(0);return T.setFullYear(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()),T.setHours(b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds(),b.getUTCMilliseconds()),T}return E=function(e){if("Z"===e)return 0;var t=e.match(u);if(!t)return 0;var n="+"===t[1]?-1:1,o=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;if(!function(e,t){return t>=0&&t<=59}(0,i))return NaN;return n*(o*r.a+i*r.b)}(v.timezone),isNaN(E)?new Date(NaN):new Date(y+_+E)}var s={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},c=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,l=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,u=/^([+-])(\d{2})(?::?(\d{2}))?$/;function d(e){return e?parseInt(e):1}function p(e){return e&&parseFloat(e.replace(",","."))||0}var h=[31,null,31,30,31,30,31,31,30,31,30,31];function f(e){return e%400===0||e%4===0&&e%100!==0}},function(e,t,n){"use strict";n.r(t),n.d(t,"IGNORE_CLASS_NAME",(function(){return f}));var r=n(2),o=n(19);function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t,n){return e===t||(e.correspondingElement?e.correspondingElement.classList.contains(n):e.classList.contains(n))}var c,l,u=(void 0===c&&(c=0),function(){return++c}),d={},p={},h=["touchstart","touchmove"],f="ignore-react-onclickoutside";function m(e,t){var n={};return-1!==h.indexOf(t)&&l&&(n.passive=!e.props.preventDefault),n}t.default=function(e,t){var n,c,h=e.displayName||e.name||"Component";return c=n=function(n){var c,f;function v(e){var r;return(r=n.call(this,e)||this).__outsideClickHandler=function(e){if("function"!==typeof r.__clickOutsideHandlerProp){var t=r.getInstance();if("function"!==typeof t.props.handleClickOutside){if("function"!==typeof t.handleClickOutside)throw new Error("WrappedComponent: "+h+" lacks a handleClickOutside(event) function for processing outside click events.");t.handleClickOutside(e)}else t.props.handleClickOutside(e)}else r.__clickOutsideHandlerProp(e)},r.__getComponentNode=function(){var e=r.getInstance();return t&&"function"===typeof t.setClickOutsideRef?t.setClickOutsideRef()(e):"function"===typeof e.setClickOutsideRef?e.setClickOutsideRef():Object(o.findDOMNode)(e)},r.enableOnClickOutside=function(){if("undefined"!==typeof document&&!p[r._uid]){"undefined"===typeof l&&(l=function(){if("undefined"!==typeof window&&"function"===typeof window.addEventListener){var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}}),n=function(){};return window.addEventListener("testPassiveEventSupport",n,t),window.removeEventListener("testPassiveEventSupport",n,t),e}}()),p[r._uid]=!0;var e=r.props.eventTypes;e.forEach||(e=[e]),d[r._uid]=function(e){var t;null!==r.componentNode&&(r.initTimeStamp>e.timeStamp||(r.props.preventDefault&&e.preventDefault(),r.props.stopPropagation&&e.stopPropagation(),r.props.excludeScrollbar&&(t=e,document.documentElement.clientWidth<=t.clientX||document.documentElement.clientHeight<=t.clientY)||function(e,t,n){if(e===t)return!0;for(;e.parentNode||e.host;){if(e.parentNode&&s(e,t,n))return!0;e=e.parentNode||e.host}return e}(e.composed&&e.composedPath&&e.composedPath().shift()||e.target,r.componentNode,r.props.outsideClickIgnoreClass)===document&&r.__outsideClickHandler(e)))},e.forEach((function(e){document.addEventListener(e,d[r._uid],m(a(r),e))}))}},r.disableOnClickOutside=function(){delete p[r._uid];var e=d[r._uid];if(e&&"undefined"!==typeof document){var t=r.props.eventTypes;t.forEach||(t=[t]),t.forEach((function(t){return document.removeEventListener(t,e,m(a(r),t))})),delete d[r._uid]}},r.getRef=function(e){return r.instanceRef=e},r._uid=u(),r.initTimeStamp=performance.now(),r}f=n,(c=v).prototype=Object.create(f.prototype),c.prototype.constructor=c,i(c,f);var g=v.prototype;return g.getInstance=function(){if(e.prototype&&!e.prototype.isReactComponent)return this;var t=this.instanceRef;return t.getInstance?t.getInstance():t},g.componentDidMount=function(){if("undefined"!==typeof document&&document.createElement){var e=this.getInstance();if(t&&"function"===typeof t.handleClickOutside&&(this.__clickOutsideHandlerProp=t.handleClickOutside(e),"function"!==typeof this.__clickOutsideHandlerProp))throw new Error("WrappedComponent: "+h+" lacks a function for processing outside click events specified by the handleClickOutside config option.");this.componentNode=this.__getComponentNode(),this.props.disableOnClickOutside||this.enableOnClickOutside()}},g.componentDidUpdate=function(){this.componentNode=this.__getComponentNode()},g.componentWillUnmount=function(){this.disableOnClickOutside()},g.render=function(){var t=this.props;t.excludeScrollbar;var n=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(t,["excludeScrollbar"]);return e.prototype&&e.prototype.isReactComponent?n.ref=this.getRef:n.wrappedRef=this.getRef,n.disableOnClickOutside=this.disableOnClickOutside,n.enableOnClickOutside=this.enableOnClickOutside,Object(r.createElement)(e,n)},v}(r.Component),n.displayName="OnClickOutside("+h+")",n.defaultProps={eventTypes:["mousedown","touchstart"],excludeScrollbar:t&&t.excludeScrollbar||!1,outsideClickIgnoreClass:f,preventDefault:!1,stopPropagation:!1},n.getClass=function(){return e.getClass?e.getClass():e},c}},function(e,t){var n="undefined"!==typeof Element,r="function"===typeof Map,o="function"===typeof Set,i="function"===typeof ArrayBuffer&&!!ArrayBuffer.isView;function a(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var s,c,l,u;if(Array.isArray(e)){if((s=e.length)!=t.length)return!1;for(c=s;0!==c--;)if(!a(e[c],t[c]))return!1;return!0}if(r&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(u=e.entries();!(c=u.next()).done;)if(!t.has(c.value[0]))return!1;for(u=e.entries();!(c=u.next()).done;)if(!a(c.value[1],t.get(c.value[0])))return!1;return!0}if(o&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(u=e.entries();!(c=u.next()).done;)if(!t.has(c.value[0]))return!1;return!0}if(i&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if((s=e.length)!=t.length)return!1;for(c=s;0!==c--;)if(e[c]!==t[c])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&"function"===typeof e.valueOf&&"function"===typeof t.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&"function"===typeof e.toString&&"function"===typeof t.toString)return e.toString()===t.toString();if((s=(l=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(c=s;0!==c--;)if(!Object.prototype.hasOwnProperty.call(t,l[c]))return!1;if(n&&e instanceof Element)return!1;for(c=s;0!==c--;)if(("_owner"!==l[c]&&"__v"!==l[c]&&"__o"!==l[c]||!e.$$typeof)&&!a(e[l[c]],t[l[c]]))return!1;return!0}return e!==e&&t!==t}e.exports=function(e,t){try{return a(e,t)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}}},function(e,t,n){"use strict";var r=function(){};e.exports=r},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var r=n(25),o=n(126),i=n(329),a=n(132),s=n(124);function c(e,t){if(Object(s.a)(2,arguments),"object"!==Object(r.a)(t)||null===t)throw new RangeError("values parameter must be an object");var n=Object(o.default)(e);return isNaN(n.getTime())?new Date(NaN):(null!=t.year&&n.setFullYear(t.year),null!=t.month&&(n=Object(i.default)(n,t.month)),null!=t.date&&n.setDate(Object(a.a)(t.date)),null!=t.hours&&n.setHours(Object(a.a)(t.hours)),null!=t.minutes&&n.setMinutes(Object(a.a)(t.minutes)),null!=t.seconds&&n.setSeconds(Object(a.a)(t.seconds)),null!=t.milliseconds&&n.setMilliseconds(Object(a.a)(t.milliseconds)),n)}},function(e,t,n){(function(t){self,e.exports=function(){var e={4537:function(e){"use strict";e.exports=function(e,t){for(var n=new Array(arguments.length-1),r=0,o=2,i=!0;o<arguments.length;)n[r++]=arguments[o++];return new Promise((function(o,a){n[r]=function(e){if(i)if(i=!1,e)a(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];o.apply(null,t)}};try{e.apply(t||null,n)}catch(e){i&&(i=!1,a(e))}}))}},7419:function(e,t){"use strict";var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var r=new Array(64),o=new Array(123),i=0;i<64;)o[r[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;n.encode=function(e,t,n){for(var o,i=null,a=[],s=0,c=0;t<n;){var l=e[t++];switch(c){case 0:a[s++]=r[l>>2],o=(3&l)<<4,c=1;break;case 1:a[s++]=r[o|l>>4],o=(15&l)<<2,c=2;break;case 2:a[s++]=r[o|l>>6],a[s++]=r[63&l],c=0}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),s=0)}return c&&(a[s++]=r[o],a[s++]=61,1===c&&(a[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var a="invalid encoding";n.decode=function(e,t,n){for(var r,i=n,s=0,c=0;c<e.length;){var l=e.charCodeAt(c++);if(61===l&&s>1)break;if(void 0===(l=o[l]))throw Error(a);switch(s){case 0:r=l,s=1;break;case 1:t[n++]=r<<2|(48&l)>>4,r=l,s=2;break;case 2:t[n++]=(15&r)<<4|(60&l)>>2,r=l,s=3;break;case 3:t[n++]=(3&r)<<6|l,s=0}}if(1===s)throw Error(a);return n-i},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},5124:function(e){"use strict";function t(e,n){"string"==typeof e&&(n=e,e=void 0);var r=[];function o(e){if("string"!=typeof e){var n=i();if(t.verbose&&console.log("codegen: "+n),n="return "+n,e){for(var a=Object.keys(e),s=new Array(a.length+1),c=new Array(a.length),l=0;l<a.length;)s[l]=a[l],c[l]=e[a[l++]];return s[l]=n,Function.apply(null,s).apply(null,c)}return Function(n)()}for(var u=new Array(arguments.length-1),d=0;d<u.length;)u[d]=arguments[++d];if(d=0,e=e.replace(/%([%dfijs])/g,(function(e,t){var n=u[d++];switch(t){case"d":case"f":return String(Number(n));case"i":return String(Math.floor(n));case"j":return JSON.stringify(n);case"s":return String(n)}return"%"})),d!==u.length)throw Error("parameter count mismatch");return r.push(e),o}function i(t){return"function "+(t||n||"")+"("+(e&&e.join(",")||"")+"){\n  "+r.join("\n  ")+"\n}"}return o.toString=i,o}e.exports=t,t.verbose=!1},9211:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},9054:function(e,t,n){"use strict";e.exports=i;var r=n(4537),o=n(7199)("fs");function i(e,t,n){return"function"==typeof t?(n=t,t={}):t||(t={}),n?!t.xhr&&o&&o.readFile?o.readFile(e,(function(r,o){return r&&"undefined"!=typeof XMLHttpRequest?i.xhr(e,t,n):r?n(r):n(null,t.binary?o:o.toString("utf8"))})):i.xhr(e,t,n):r(i,this,e,t)}i.xhr=function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){if(0!==r.status&&200!==r.status)return n(Error("status "+r.status));if(t.binary){var e=r.response;if(!e){e=[];for(var o=0;o<r.responseText.length;++o)e.push(255&r.responseText.charCodeAt(o))}return n(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return n(null,r.responseText)}},t.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",e),r.send()}},945:function(e){"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function o(e,r,o){t[0]=e,r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3]}function i(e,r,o){t[0]=e,r[o]=n[3],r[o+1]=n[2],r[o+2]=n[1],r[o+3]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?o:i,e.writeFloatBE=r?i:o,e.readFloatLE=r?a:s,e.readFloatBE=r?s:a}():function(){function t(e,t,n,r){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((o<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((o<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var i=Math.floor(Math.log(t)/Math.LN2);e((o<<31|i+127<<23|8388607&Math.round(t*Math.pow(2,-i)*8388608))>>>0,n,r)}}function a(e,t,n){var r=e(t,n),o=2*(r>>31)+1,i=r>>>23&255,a=8388607&r;return 255===i?a?NaN:o*(1/0):0===i?1401298464324817e-60*o*a:o*Math.pow(2,i-150)*(a+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,r),e.readFloatLE=a.bind(null,o),e.readFloatBE=a.bind(null,i)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function o(e,r,o){t[0]=e,r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3],r[o+4]=n[4],r[o+5]=n[5],r[o+6]=n[6],r[o+7]=n[7]}function i(e,r,o){t[0]=e,r[o]=n[7],r[o+1]=n[6],r[o+2]=n[5],r[o+3]=n[4],r[o+4]=n[3],r[o+5]=n[2],r[o+6]=n[1],r[o+7]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?o:i,e.writeDoubleBE=r?i:o,e.readDoubleLE=r?a:s,e.readDoubleBE=r?s:a}():function(){function t(e,t,n,r,o,i){var a=r<0?1:0;if(a&&(r=-r),0===r)e(0,o,i+t),e(1/r>0?0:2147483648,o,i+n);else if(isNaN(r))e(0,o,i+t),e(2146959360,o,i+n);else if(r>17976931348623157e292)e(0,o,i+t),e((a<<31|2146435072)>>>0,o,i+n);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,o,i+t),e((a<<31|s/4294967296)>>>0,o,i+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(s=r*Math.pow(2,-c))>>>0,o,i+t),e((a<<31|c+1023<<20|1048576*s&1048575)>>>0,o,i+n)}}}function a(e,t,n,r,o){var i=e(r,o+t),a=e(r,o+n),s=2*(a>>31)+1,c=a>>>20&2047,l=4294967296*(1048575&a)+i;return 2047===c?l?NaN:s*(1/0):0===c?5e-324*s*l:s*Math.pow(2,c-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,r,4,0),e.readDoubleLE=a.bind(null,o,0,4),e.readDoubleBE=a.bind(null,i,4,0)}(),e}function n(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function r(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function o(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function i(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},7199:function(e,t,n){"use strict";e.exports=function(e){try{var t=n(822)(e);if(t&&(t.length||Object.keys(t).length))return t}catch(e){}return null}},822:function(e){function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=822,e.exports=t},8626:function(e,t){"use strict";var n=t,r=n.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},o=n.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),n=r(e),o="";n&&(o=t.shift()+"/");for(var i=0;i<t.length;)".."===t[i]?i>0&&".."!==t[i-1]?t.splice(--i,2):n?t.splice(i,1):++i:"."===t[i]?t.splice(i,1):++i;return o+t.join("/")};n.resolve=function(e,t,n){return n||(t=o(t)),r(t)?t:(n||(e=o(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?o(e+"/"+t):t)}},6662:function(e){"use strict";e.exports=function(e,t,n){var r=n||8192,o=r>>>1,i=null,a=r;return function(n){if(n<1||n>o)return e(n);a+n>r&&(i=e(r),a=0);var s=t.call(i,a,a+=n);return 7&a&&(a=1+(7|a)),s}}},4997:function(e,t){"use strict";var n=t;n.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},n.read=function(e,t,n){if(n-t<1)return"";for(var r,o=null,i=[],a=0;t<n;)(r=e[t++])<128?i[a++]=r:r>191&&r<224?i[a++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[a++]=55296+(r>>10),i[a++]=56320+(1023&r)):i[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,i)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,i.slice(0,a))),o.join("")):String.fromCharCode.apply(String,i.slice(0,a))},n.write=function(e,t,n){for(var r,o,i=n,a=0;a<e.length;++a)(r=e.charCodeAt(a))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(o=e.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&o),++a,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-i}},4188:function(e,t,n){var r,o,i;!function(a){"use strict";if(null!=t&&"number"!=typeof t.nodeType)e.exports=a();else if(null!=n.amdO)o=[],void 0===(i="function"==typeof(r=a)?r.apply(t,o):r)||(e.exports=i);else{var s=a(),c="undefined"!=typeof self?self:$.global;"function"!=typeof c.btoa&&(c.btoa=s.btoa),"function"!=typeof c.atob&&(c.atob=s.atob)}}((function(){"use strict";var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function t(e){this.message=e}return t.prototype=new Error,t.prototype.name="InvalidCharacterError",{btoa:function(n){for(var r,o,i=String(n),a=0,s=e,c="";i.charAt(0|a)||(s="=",a%1);c+=s.charAt(63&r>>8-a%1*8)){if((o=i.charCodeAt(a+=3/4))>255)throw new t("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");r=r<<8|o}return c},atob:function(n){var r=String(n).replace(/[=]+$/,"");if(r.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,i,a=0,s=0,c="";i=r.charAt(s++);~i&&(o=a%4?64*o+i:i,a++%4)?c+=String.fromCharCode(255&o>>(-2*a&6)):0)i=e.indexOf(i);return c}}}))},9667:function(e,t,n){"use strict";n.r(t),n.d(t,{addUsersToChatRoom:function(){return y},addUsersToChatRoomAllowlist:function(){return z},addUsersToChatRoomWhitelist:function(){return Y},blockChatRoomMember:function(){return L},blockChatRoomMembers:function(){return U},chatRoomBlockMulti:function(){return x},chatRoomBlockSingle:function(){return M},createChatRoom:function(){return d},deleteChatRoomSharedFile:function(){return ae},destroyChatRoom:function(){return p},disableSendChatRoomMsg:function(){return q},enableSendChatRoomMsg:function(){return K},fetchChatRoomAnnouncement:function(){return re},fetchChatRoomSharedFileList:function(){return se},getChatRoomAdmin:function(){return R},getChatRoomAllowlist:function(){return $},getChatRoomAttributes:function(){return le},getChatRoomBlacklist:function(){return G},getChatRoomBlacklistNew:function(){return H},getChatRoomBlocklist:function(){return W},getChatRoomDetails:function(){return h},getChatRoomMuteList:function(){return P},getChatRoomMuted:function(){return k},getChatRoomMutelist:function(){return D},getChatRoomSharedFilelist:function(){return ce},getChatRoomWhitelist:function(){return Q},getChatRooms:function(){return u},getJoinedChatRooms:function(){return fe},isChatRoomWhiteUser:function(){return ee},isInChatRoomAllowlist:function(){return te},isInChatRoomMutelist:function(){return ne},joinChatRoom:function(){return _},leaveChatRoom:function(){return T},listChatRoomMember:function(){return S},listChatRoomMembers:function(){return O},modifyChatRoom:function(){return f},muteChatRoomMember:function(){return I},quitChatRoom:function(){return b},removeChatRoomAdmin:function(){return w},removeChatRoomAllowlistMember:function(){return Z},removeChatRoomAttribute:function(){return he},removeChatRoomAttributes:function(){return pe},removeChatRoomBlockMulti:function(){return B},removeChatRoomBlockSingle:function(){return j},removeChatRoomMember:function(){return v},removeChatRoomMembers:function(){return E},removeChatRoomWhitelistMember:function(){return J},removeMultiChatRoomMember:function(){return g},removeMuteChatRoomMember:function(){return A},removeSingleChatRoomMember:function(){return m},rmUsersFromChatRoomWhitelist:function(){return X},setChatRoomAdmin:function(){return C},setChatRoomAttribute:function(){return de},setChatRoomAttributes:function(){return ue},unblockChatRoomMember:function(){return F},unblockChatRoomMembers:function(){return V},unmuteChatRoomMember:function(){return N},updateChatRoomAnnouncement:function(){return oe},uploadChatRoomSharedFile:function(){return ie}}),n(1539),n(8674),n(8309),n(2526),n(1817),n(2222),n(9753),n(9600),n(1249),n(4916),n(3123),n(2165),n(6992),n(8783),n(3948);var r=n(5531),o=n(7252),i=n(4024),a=n(3246),s=n(7360),c=n(1595);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(e){var t=this;if("number"!=typeof e.pagenum||"number"!=typeof e.pagesize)throw Error("Invalid parameter");if(!a.XZ.call(this)){var n=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(n)}var l={pagenum:e.pagenum||1,pagesize:e.pagesize||20},u=this.context,d=u.orgName,p=u.appName,h=u.accessToken,f={url:this.apiUrl+"/"+d+"/"+p+"/chatrooms",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+h},data:l,success:function(t){"function"==typeof e.success&&e.success(t)},error:function(n){n.error&&n.error_description&&t.onError&&t.onError({type:r.E.WEBIM_CONNCTION_LOAD_CHATROOM_ERROR,message:n.error_description,data:n}),"function"==typeof e.error&&e.error(n)}};return s.kg.debug("Call getChatRooms",e),i.hj.call(this,f,c.fI.GET_CHATROOM_LIST)}function d(e){if("string"!=typeof e.name)throw Error("Invalid parameter");if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n={name:e.name,description:e.description,maxusers:e.maxusers,owner:this.user,members:e.members},l=this.context,u=l.orgName,d=l.appName,p=l.accessToken,h=l.jid,f={url:"".concat(this.apiUrl,"/").concat(u,"/").concat(d,"/chatrooms?resource=").concat(h.clientResource),dataType:"json",type:"POST",data:JSON.stringify(n),headers:{Authorization:"Bearer "+(e.token||p),"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call createChatRoom",e),i.hj.call(this,f,c.fI.CREATE_CHATROOM)}function p(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error("Invalid parameter");if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(e.chatRoomId,"?resource=").concat(p.clientResource,"&version=v3"),dataType:"json",type:"DELETE",headers:{Authorization:"Bearer "+(e.token||d)},success:e.success,error:e.error};return s.kg.debug("Call destroyChatRoom",e),i.hj.call(this,h,c.fI.DESTROY_CHATROOM)}function h(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error("Invalid parameter");if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p={url:this.apiUrl+"/"+l+"/"+u+"/chatrooms/"+e.chatRoomId,dataType:"json",type:"GET",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getChatRoomDetails",e),i.hj.call(this,p,c.fI.GET_CHATROOM_DETAIL)}function f(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error("Invalid parameter");if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.chatRoomId,f={groupname:e.chatRoomName,description:e.description,maxusers:e.maxusers},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"?resource=").concat(p.clientResource),type:"PUT",data:JSON.stringify(f),dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call modifyChatRoom",e),i.hj.call(this,m,c.fI.MODIFY_CHATROOM)}function m(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId||"string"!=typeof e.username)throw Error("Invalid parameter");if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.chatRoomId,f=e.username,m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/users/").concat(f,"?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call removeChatRoomMember",e),i.hj.call(this,m,c.fI.REMOVE_CHATROOM_MEMBER)}var v=m;function g(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId||!Array.isArray(e.users))throw Error("Invalid parameter");if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=e.chatRoomId,l=e.users.join(","),u=this.context,d=u.orgName,p=u.appName,h=u.accessToken,f=u.jid,m={url:"".concat(this.apiUrl,"/").concat(d,"/").concat(p,"/chatrooms/").concat(n,"/users/").concat(l,"?resource=").concat(f.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+h,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call removeChatRoomMembers",e),i.hj.call(this,m,c.fI.MULTI_REMOVE_CHATROOM_MEMBER)}var E=g;function y(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId||!Array.isArray(e.users))throw Error("Invalid parameter");if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=e.chatRoomId,l={usernames:e.users},u=this.context,d=u.orgName,p=u.appName,h=u.accessToken,f=u.jid,m={url:"".concat(this.apiUrl,"/").concat(d,"/").concat(p,"/chatrooms/").concat(n,"/users?resource=").concat(f.clientResource),type:"POST",data:JSON.stringify(l),dataType:"json",headers:{Authorization:"Bearer "+h,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call addUsersToChatRoom",e),i.hj.call(this,m,c.fI.ADD_USERS_TO_CHATROOM)}function _(e){var t=e.roomId,n=e.message,i=void 0===n?"":n,c=e.ext,l=void 0===c?"":c,u=e.leaveOtherRooms,d=void 0!==u&&u,p=e.success,h=e.error;if("string"!=typeof t||""===t)throw Error("Invalid parameter roomId");if("string"!=typeof l)throw Error("Invalid parameter ext");if("boolean"!=typeof d)throw Error("Invalid parameter leaveOtherRooms");if(!a.XZ.call(this)){var f=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(f)}return s.kg.debug("Call joinChatRoom",e),this.logOut?Promise.reject({type:r.E.WEBIM_CONNECTION_CLOSED,message:"not login"}):this.mSync.handleChatRoom({roomId:t,ext:l,leaveOtherRooms:d,message:i,success:p,error:h},"join")}function b(e){if("string"!=typeof e.roomId||""===e.roomId)throw Error("Invalid parameter");if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}return s.kg.debug("Call leaveChatRoom",e),this.logOut?Promise.reject({type:r.E.WEBIM_CONNECTION_CLOSED,message:"not login"}):this.mSync.handleChatRoom(e,"leave")}var T=b;function S(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if(isNaN(e.pageNum)||e.pageNum<=0)throw Error('The parameter "pageNum" should be a positive number');if(isNaN(e.pageSize)||e.pageSize<=0)throw Error('The parameter "pageSize" should be a positive number');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n={pagenum:e.pageNum,pagesize:e.pageSize},l=this.context,u=l.orgName,d=l.appName,p=l.accessToken,h={url:this.apiUrl+"/"+u+"/"+d+"/chatrooms/"+e.chatRoomId+"/users",dataType:"json",type:"GET",data:n,headers:{Authorization:"Bearer "+p,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call listChatRoomMembers",e),i.hj.call(this,h,c.fI.LIST_CHATROOM_MEMBERS)}var O=S;function R(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.chatRoomId,h={url:this.apiUrl+"/"+l+"/"+u+"/chatrooms/"+p+"/admin",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getChatRoomAdmin",e),i.hj.call(this,h,c.fI.GET_CHATROOM_ADMIN)}function C(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if("string"!=typeof e.username||""===e.username)throw Error('Invalid parameter: "username"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.chatRoomId,f={newadmin:e.username},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/admin?resource=").concat(p.clientResource),type:"POST",dataType:"json",data:JSON.stringify(f),headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call setChatRoomAdmin",e),i.hj.call(this,m,c.fI.SET_CHATROOM_ADMIN)}function w(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if("string"!=typeof e.username||""===e.username)throw Error('Invalid parameter: "username"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.chatRoomId,f=e.username,m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/admin/").concat(f,"?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call removeChatRoomAdmin",e),i.hj.call(this,m,c.fI.REMOVE_CHATROOM_ADMIN)}function I(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.username||""===e.username)throw Error('Invalid parameter: "username"');if("number"!=typeof e.muteDuration)throw Error('Invalid parameter: "muteDuration"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.chatRoomId,f={usernames:[e.username],mute_duration:e.muteDuration},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/mute?resource=").concat(p.clientResource),dataType:"json",type:"POST",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},data:JSON.stringify(f),success:e.success,error:e.error};return s.kg.debug("Call muteChatRoomMember",e),i.hj.call(this,m,c.fI.MUTE_CHATROOM_MEMBER)}function A(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if("string"!=typeof e.username||""===e.username)throw Error('Invalid parameter: "username"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.chatRoomId,f=e.username,m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/mute/").concat(f,"?resource=").concat(p.clientResource),dataType:"json",type:"DELETE",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call unmuteChatRoomMember",e),i.hj.call(this,m,c.fI.REMOVE_MUTE_CHATROOM_MEMBER)}var N=A;function k(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.chatRoomId,h={url:this.apiUrl+"/"+l+"/"+u+"/chatrooms/"+p+"/mute",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getChatRoomMutelist",e),i.hj.call(this,h,c.fI.GET_MUTE_CHATROOM_MEMBERS)}var P=k,D=k;function M(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if("string"!=typeof e.username||""===e.username)throw Error('Invalid parameter: "username"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.chatRoomId,f=e.username,m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/blocks/users/").concat(f,"?resource=").concat(p.clientResource),type:"POST",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call blockChatRoomMember",e),i.hj.call(this,m,c.fI.SET_CHATROOM_MEMBER_TO_BLACK)}var L=M;function x(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if(!Array.isArray(e.usernames))throw Error('Invalid parameter: "usernames"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.chatRoomId,f={usernames:e.usernames},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/blocks/users?resource=").concat(p.clientResource),data:JSON.stringify(f),type:"POST",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Chat blockChatRoomMembers:",m),i.hj.call(this,m,c.fI.MULTI_SET_CHATROOM_MEMBER_TO_BLACK)}var U=x;function j(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if("string"!=typeof e.username||""===e.username)throw Error('Invalid parameter: "username"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.chatRoomId,f=e.username,m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/blocks/users/").concat(f,"?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call unblockChatRoomMember",e),i.hj.call(this,m,c.fI.REMOVE_CHATROOM_MEMBER_BLACK)}var F=j;function B(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if(!Array.isArray(e.usernames))throw Error('Invalid parameter: "usernames"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.chatRoomId,f=e.usernames.join(","),m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/blocks/users/").concat(f,"?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call unblockChatRoomMembers",e),i.hj.call(this,m,c.fI.MULTI_REMOVE_CHATROOM_MEMBER_BLACK)}var V=B;function H(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.chatRoomId,h={url:this.apiUrl+"/"+l+"/"+u+"/chatrooms/"+p+"/blocks/users",type:"GET",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getChatRoomBlocklist",e),i.hj.call(this,h,c.fI.GET_CHATROOM_BLOCK_MEMBERS)}var G=H,W=H;function q(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.chatRoomId,f={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/ban?resource=").concat(p.clientResource),type:"POST",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call disableSendChatRoomMsg",e),i.hj.call(this,f,c.fI.DISABLED_CHATROOM_SEND_MSG)}function K(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.chatRoomId,f={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/ban?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call enableSendChatRoomMsg",e),i.hj.call(this,f,c.fI.ENABLE_CHATROOM_SEND_MSG)}function Y(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if(!Array.isArray(e.users))throw Error('Invalid parameter: "users"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.chatRoomId,f={usernames:e.users},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/white/users?resource=").concat(p.clientResource),type:"POST",data:JSON.stringify(f),dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call addUsersToChatRoomWhitelist",e),i.hj.call(this,m,c.fI.ADD_USERS_TO_CHATROOM)}var z=Y;function X(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if("string"!=typeof e.userName||""===e.userName)throw Error('Invalid parameter: "userName"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.chatRoomId,f={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/white/users/").concat(e.userName,"?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call removeChatRoomAllowlistMember",e),i.hj.call(this,f,c.fI.REMOVE_CHATROOM_WHITE_USERS)}var J=X,Z=X;function Q(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.chatRoomId,h={url:this.apiUrl+"/"+l+"/"+u+"/chatrooms/"+p+"/white/users",type:"GET",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getChatRoomAllowlist",e),i.hj.call(this,h,c.fI.GET_CHATROOM_WHITE_USERS)}var $=Q;function ee(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if("string"!=typeof e.userName||""===e.userName)throw Error('Invalid parameter: "userName"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.chatRoomId,h={url:this.apiUrl+"/"+l+"/"+u+"/chatrooms/"+p+"/white/users/"+e.userName,type:"GET",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call isInChatRoomAllowlist",e),i.hj.call(this,h,c.fI.CHECK_CHATROOM_WHITE_USER)}var te=ee;function ne(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error('Invalid parameter: "chatRoomId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,c=n.orgName,l=n.appName,u=n.accessToken,d=n.userId,p={url:this.apiUrl+"/"+c+"/"+l+"/sdk/chatrooms/"+e.chatRoomId+"/mute/"+d,dataType:"json",type:"GET",headers:{Authorization:"Bearer "+u}};return s.kg.debug("Call isInChatRoomMutelist",e),i.hj.call(this,p).then((function(e){return{type:e.type,data:e.data}}))}function re(e){if("string"!=typeof e.roomId||""===e.roomId)throw Error('Invalid parameter: "roomId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.roomId,h={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(p,"/announcement"),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call fetchChatRoomAnnouncement",e),i.hj.call(this,h,c.fI.GET_CHATROOM_ANN)}function oe(e){if("string"!=typeof e.roomId||""===e.roomId)throw Error('Invalid parameter: "roomId"');if("string"!=typeof e.announcement)throw Error('Invalid parameter: "announcement"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.roomId,f={announcement:e.announcement},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/announcement?resource=").concat(p.clientResource),type:"POST",dataType:"json",data:JSON.stringify(f),headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call updateChatRoomAnnouncement:",e),i.hj.call(this,m,c.fI.UPDATE_CHATROOM_ANN)}function ie(e){if("string"!=typeof e.roomId||""===e.roomId)throw Error('Invalid parameter: "roomId"');if("object"!==l(e.file))throw Error('Invalid parameter: "file"');if(a.XZ.call(this)){var t=this.context,n=t.orgName,r=t.appName,o=t.accessToken,u=t.jid,d=e.roomId;i.cT.call(this,{uploadUrl:"".concat(this.apiUrl,"/").concat(n,"/").concat(r,"/chatrooms/").concat(d,"/share_files?resource=").concat(u.clientResource),onFileUploadProgress:e.onFileUploadProgress,onFileUploadComplete:e.onFileUploadComplete,onFileUploadError:e.onFileUploadError,onFileUploadCanceled:e.onFileUploadCanceled,accessToken:o,apiUrl:this.apiUrl,file:e.file,appKey:this.context.appKey},c.fI.UPLOAD_CHATROOM_FILE),s.kg.debug("Call uploadChatRoomSharedFile",e)}}function ae(e){if("string"!=typeof e.roomId||""===e.roomId)throw Error('Invalid parameter: "roomId"');if("string"!=typeof e.fileId||""===e.fileId)throw Error('Invalid parameter: "fileId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.roomId,f=e.fileId,m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(h,"/share_files/").concat(f,"?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call deleteChatRoomSharedFile",e),i.hj.call(this,m,c.fI.DELETE_CHATROOM_FILE)}function se(e){if("string"!=typeof e.roomId||""===e.roomId)throw Error('Invalid parameter: "roomId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.roomId,h={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatrooms/").concat(p,"/share_files"),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json",accept:"application/json"},success:e.success,error:e.error};return s.kg.debug("Call fetchChatRoomSharedFileList",e),i.hj.call(this,h,c.fI.GET_CHATROOM_FILES)}var ce=se;function le(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error("Invalid parameter chatRoomId: "+e.chatRoomId);if(e.attributeKeys&&!Array.isArray(e.attributeKeys))throw Error('"Invalid parameter attributeKeys": '+e.attributeKeys);if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=(n.jid,e.chatRoomId),h={keys:e.attributeKeys},f={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/metadata/chatroom/").concat(p),type:"POST",dataType:"json",data:JSON.stringify(h),headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"}};return s.kg.debug("Call getChatRoomAttributes:",e),i.hj.call(this,f,c.fI.GET_CHATROOM_ATTR).then((function(e){return{data:e.data,type:e.type}}))}function ue(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error("Invalid parameter chatRoomId: "+e.chatRoomId);if("object"!==l(e.attributes))throw Error("Invalid parameter attributes: "+e.attributes);if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,u=n.orgName,d=n.appName,p=n.accessToken,h=n.userId,f=e.chatRoomId,m=e.attributes,v=e.autoDelete,g=void 0===v||v,E=e.isForced?"/forced":"",y={metaData:m,autoDelete:g?"DELETE":"NO_DELETE"},_={url:"".concat(this.apiUrl,"/").concat(u,"/").concat(d,"/metadata/chatroom/").concat(f,"/user/").concat(h)+E,type:"PUT",dataType:"json",data:JSON.stringify(y),headers:{Authorization:"Bearer "+p,"Content-Type":"application/json"}};return s.kg.debug("Call setChatRoomAttributes:",e),i.hj.call(this,_,c.fI.SET_CHATROOM_ATTR).then((function(e){return(0,a._W)(e)}))}function de(e){var t;if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error("Invalid parameter chatRoomId: "+e.chatRoomId);if("string"!=typeof e.attributeKey||""===e.attributeKey)throw Error("Invalid parameter attributeKey: "+e.attributeKey);if("string"!=typeof e.attributeValue||""===e.attributeValue)throw Error("Invalid parameter attributeValue: "+e.attributeValue);if(!a.XZ.call(this)){var n=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(n)}var l=this.context,u=l.orgName,d=l.appName,p=l.accessToken,h=l.userId,f=e.chatRoomId,m=e.attributeKey,v=e.attributeValue,g=e.autoDelete,E=void 0===g||g,y=e.isForced?"/forced":"",_={metaData:(t={},t[m]=v,t),autoDelete:E?"DELETE":"NO_DELETE"},b={url:"".concat(this.apiUrl,"/").concat(u,"/").concat(d,"/metadata/chatroom/").concat(f,"/user/").concat(h)+y,type:"PUT",dataType:"json",data:JSON.stringify(_),headers:{Authorization:"Bearer "+p,"Content-Type":"application/json"}};return s.kg.debug("Call setChatRoomAttribute:",e),i.hj.call(this,b,c.fI.SET_CHATROOM_ATTR).then((function(e){var t=(0,a.H7)(e);if(t)throw t}))}function pe(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error("Invalid parameter chatRoomId: "+e.chatRoomId);if(!Array.isArray(e.attributeKeys))throw Error('"Invalid parameter attributes": '+e.attributeKeys);if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.userId,h=e.chatRoomId,f=e.attributeKeys,m=e.isForced?"/forced":"",v={keys:f},g={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/metadata/chatroom/").concat(h,"/user/").concat(p)+m,type:"DELETE",dataType:"json",data:JSON.stringify(v),headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"}};return s.kg.debug("Call removeChatRoomAttributes:",e),i.hj.call(this,g,c.fI.DELETE_CHATROOM_ATTR).then((function(e){return(0,a._W)(e)}))}function he(e){if("string"!=typeof e.chatRoomId||""===e.chatRoomId)throw Error("Invalid parameter chatRoomId: "+e.chatRoomId);if("string"!=typeof e.attributeKey||""===e.attributeKey)throw Error('"Invalid parameter attributeKey": '+e.attributeKey);if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.userId,h=e.chatRoomId,f=e.attributeKey,m=e.isForced?"/forced":"",v={keys:[f]},g={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/metadata/chatroom/").concat(h,"/user/").concat(p)+m,type:"DELETE",dataType:"json",data:JSON.stringify(v),headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"}};return s.kg.debug("Call removeChatRoomAttribute:",e),i.hj.call(this,g,c.fI.DELETE_CHATROOM_ATTR).then((function(e){var t=(0,a.H7)(e);if(t)throw t}))}function fe(e){var t=this,n=e||{},l=n.pageNum,u=n.pageSize;if(isNaN(l)||l<=0)throw Error("Invalid parameter pageNum:".concat(l));if(isNaN(u)||u<=0)throw Error("Invalid parameter pageSize:".concat(u));if(!a.XZ.call(this)){var d=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(d)}var p={pagenum:l,pagesize:u,detail:!0},h=this.context,f=h.orgName,m=h.appName,v=h.accessToken,g={url:"".concat(this.apiUrl,"/").concat(f,"/").concat(m,"/users/").concat(this.user,"/joined_chatrooms"),dataType:"json",type:"GET",data:p,headers:{Authorization:"Bearer "+v,"Content-Type":"application/json"}};return s.kg.debug("Call getJoinedChatRooms",e),i.hj.call(this,g,c.fI.GET_USER_JOINED_CHATROOM).then((function(e){var n=(e.data||[]).map((function(e){var n=e.id,r=e.title,o=e.owner,i=e.created,a=e.description,s=e.max_users;return{id:n,name:r,owner:o.split("".concat(t.appKey,"_"))[1],created:i,description:a,maxusers:s}}));return{type:e.type,data:n}}))}},4363:function(e,t,n){"use strict";n.d(t,{U:function(){return s},w:function(){return c}}),n(9601),n(2772),n(1249);var r=n(7360),o=n(8161),i=n(4024),a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)},s={chat:"singleChat",chatroom:"chatRoom",groupchat:"groupChat",singleChat:"singleChat",chatRoom:"chatRoom",groupChat:"groupChat"};function c(e,t){var n,c,l,u=t||{},d=u.formatCustomExts,p=void 0===d||d,h=u.formatChatType,f=void 0!==h&&h,m=e.id,v=e.payload,g=e.timestamp,E=e.to,y=v.bodies&&v.bodies.length>0?v.bodies[0]:{},_={},b={},T=v.type?v.type:E.indexOf("@conference.easemob.com")>-1?"groupChat":"singleChat";T="chat"===T?"singleChat":T,f&&v.type&&(T=s[v.type]);var S="";switch(y.type){case"txt":if(Object.prototype.hasOwnProperty.call(y,"subType")&&"sub_combine"===y.subType)S=o.t.call(this,{remotePath:null==y?void 0:y.url,secret:null==y?void 0:y.secret}),_={id:m,type:"combine",chatType:T,to:v.to,from:v.from,ext:v.ext,time:g,title:y.title||"",summary:y.summary||"",url:S||"",secret:y.secret||"",file_length:y.file_length||0,filename:y.filename||"",compatibleText:y.msg,combineLevel:y.combineLevel||0};else{var O=null===(n=null==v?void 0:v.meta)||void 0===n?void 0:n.edit_msg;if(_={id:m,type:"txt",chatType:T,msg:y.msg||"",to:v.to||"",from:v.from,time:g,ext:v.ext},O){var R=O.edit_time,C=O.operator,w=O.count;_.modifiedInfo={operationTime:R,operatorId:C,operationCount:w}}}break;case"img":S=this.useOwnUploadFun?null==y?void 0:y.url:o.t.call(this,{remotePath:null==y?void 0:y.url,secret:null==y?void 0:y.secret}),_={id:m,type:"img",chatType:T,to:v.to,from:v.from,time:g,ext:v.ext,width:(null===(c=y.size)||void 0===c?void 0:c.width)||0,height:(null===(l=y.size)||void 0===l?void 0:l.height)||0,thumb:this.useOwnUploadFun?"":"".concat(S,"&thumbnail=true"),thumb_secret:y.secret,secret:y.secret||"",url:S||"",file_length:y.file_length||0,file:{}};break;case"video":S=this.useOwnUploadFun?null==y?void 0:y.url:o.t.call(this,{remotePath:null==y?void 0:y.url,secret:null==y?void 0:y.secret}),_={id:m,type:"video",chatType:T,from:v.from,to:v.to,thumb:i.P6.formatAttachUrl.call(this,y.thumb),thumb_secret:y.thumb_secret||"",url:S||"",secret:y.secret||"",filename:y.filename,length:y.length||0,file:{},file_length:y.file_length||0,filetype:v.ext.file_type||"",ext:v.ext,time:g};break;case"loc":_={id:m,type:"loc",chatType:T,from:v.from,to:v.to,buildingName:y.buildingName||"",addr:y.addr,lat:y.lat,lng:y.lng,ext:v.ext,time:g};break;case"audio":S=this.useOwnUploadFun?null==y?void 0:y.url:o.t.call(this,{remotePath:null==y?void 0:y.url,secret:null==y?void 0:y.secret}),_={id:m,type:"audio",chatType:T,from:v.from,to:v.to,secret:y.secret||"",ext:v.ext,time:g,url:S||"",file:{},filename:y.filename,length:y.length||0,file_length:y.file_length||0,filetype:v.ext.file_type||""};break;case"file":S=this.useOwnUploadFun?null==y?void 0:y.url:o.t.call(this,{remotePath:null==y?void 0:y.url,secret:null==y?void 0:y.secret}),_={id:m,type:"file",chatType:T,from:v.from,to:v.to,ext:v.ext,time:g,url:S||"",secret:y.secret||"",file:{},filename:y.filename||"",file_length:y.file_length||0,filetype:v.ext.file_type||""};break;case"cmd":_={id:m,type:"cmd",chatType:T,from:v.from,to:v.to,ext:v.ext,time:g,action:y.action||""};break;case"custom":var I=y.customExts||{};p&&y.customExts&&(I={},y.customExts.map((function(e){I=a(a({},I),e)}))),_={id:m,type:"custom",chatType:T,from:v.from,to:v.to,ext:v.ext,time:g,customEvent:y.customEvent||"",customExts:I};break;case"combine":S=o.t.call(this,{remotePath:null==y?void 0:y.url,secret:null==y?void 0:y.secret}),_={id:m,type:"combine",chatType:T,msg:y.msg||"",to:v.to||"",from:v.from,time:g,ext:v.ext,title:y.title||"",summary:y.summary||"",url:S||"",compatibleText:y.text,combineLevel:y.combineLevel||0,secret:y.secret||"",filename:y.filename||"",file_length:y.file_length||0};break;default:r.kg.error("unexpected message: ".concat(e))}if(v.msgConfig&&(b.msgConfig=v.msgConfig),null==v?void 0:v.meta){var A=v.meta;A.thread&&(b.chatThread={messageId:A.thread.msg_parent_id,parentId:A.thread.muc_parent_id,chatThreadName:A.thread.thread_name}),A.reaction&&(b.reactions=A.reaction),A.translations&&(b.translations=A.translations)}return a(a({},_),b)}},2856:function(e,t,n){"use strict";n.r(t),n.d(t,{acceptGroupInvite:function(){return G},acceptGroupJoinRequest:function(){return F},addUsersToGroupAllowlist:function(){return ge},addUsersToGroupWhitelist:function(){return ve},agreeInviteIntoGroup:function(){return H},agreeJoinGroup:function(){return j},blockGroup:function(){return f},blockGroupMember:function(){return oe},blockGroupMembers:function(){return ae},blockGroupMessages:function(){return m},changeGroupOwner:function(){return b},changeOwner:function(){return _},createGroup:function(){return h},createGroupNew:function(){return p},deleteGroupSharedFile:function(){return ke},destroyGroup:function(){return P},disableSendGroupMsg:function(){return fe},dissolveGroup:function(){return k},downloadGroupSharedFile:function(){return Me},enableSendGroupMsg:function(){return me},fetchGroupAnnouncement:function(){return Ie},fetchGroupSharedFileList:function(){return Pe},getGroup:function(){return E},getGroupAdmin:function(){return C},getGroupAllowlist:function(){return Te},getGroupBlacklist:function(){return pe},getGroupBlacklistNew:function(){return de},getGroupBlocklist:function(){return he},getGroupInfo:function(){return T},getGroupMemberAttributes:function(){return xe},getGroupMembersAttributes:function(){return Ue},getGroupMsgReadUser:function(){return we},getGroupMuteList:function(){return te},getGroupMutelist:function(){return ne},getGroupSharedFilelist:function(){return De},getGroupWhitelist:function(){return be},getJoinedGroups:function(){return y},getMuted:function(){return ee},getPublicGroups:function(){return g},groupBlockMulti:function(){return ie},groupBlockSingle:function(){return re},inviteToGroup:function(){return L},inviteUsersToGroup:function(){return x},isGroupWhiteUser:function(){return Se},isInGroupAllowlist:function(){return Re},isInGroupMutelist:function(){return Ce},isInGroupWhiteList:function(){return Oe},joinGroup:function(){return U},leaveGroup:function(){return M},listGroupMember:function(){return O},listGroupMembers:function(){return R},listGroups:function(){return v},modifyGroup:function(){return S},mute:function(){return J},muteGroupMember:function(){return Z},quitGroup:function(){return D},rejectGroupInvite:function(){return q},rejectGroupJoinRequest:function(){return V},rejectInviteIntoGroup:function(){return W},rejectJoinGroup:function(){return B},removeAdmin:function(){return A},removeGroupAdmin:function(){return N},removeGroupAllowlistMember:function(){return _e},removeGroupBlockMulti:function(){return le},removeGroupBlockSingle:function(){return se},removeGroupMember:function(){return Y},removeGroupMembers:function(){return X},removeGroupWhitelistMember:function(){return ye},removeMultiGroupMember:function(){return z},removeMute:function(){return Q},removeSingleGroupMember:function(){return K},rmUsersFromGroupWhitelist:function(){return Ee},setAdmin:function(){return w},setGroupAdmin:function(){return I},setGroupMemberAttributes:function(){return Le},unblockGroupMember:function(){return ce},unblockGroupMembers:function(){return ue},unmuteGroupMember:function(){return $},updateGroupAnnouncement:function(){return Ae},uploadGroupSharedFile:function(){return Ne}}),n(1539),n(8674),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948),n(2222),n(6699),n(2023),n(9554),n(4747),n(8309),n(9753),n(9600);var r=n(5531),o=n(7252),i=n(4024),a=n(3246),s=n(7360),c=n(1595);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}var u=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function p(e){if(!e||!e.data)throw Error("Invalid parameter");if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups?resource=").concat(p.clientResource),dataType:"json",type:"POST",data:JSON.stringify({owner:this.user,groupname:e.data.groupname,desc:e.data.desc,members:e.data.members,public:e.data.public,approval:e.data.approval,allowinvites:e.data.allowinvites,invite_need_confirm:e.data.inviteNeedConfirm,maxusers:e.data.maxusers,custom:e.data.ext}),headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:function(t){e.success&&e.success(t)},error:e.error};return s.kg.debug("Call createGroup:",e),i.hj.call(this,h,c.fI.CREATE_GROUP)}var h=p;function f(e){var t;if("string"!=typeof e.groupId||""===e.groupId)throw Error("Invalid parameter");if(!a.XZ.call(this)){var n=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(n)}var l=this.context,u=l.orgName,d=l.appName,p=l.accessToken,h=l.jid,f={entities:[(t={},t["notification_ignore_"+e.groupId]=!0,t)]},m={type:"PUT",url:"".concat(this.apiUrl,"/").concat(u,"/").concat(d,"/users/").concat(this.user,"?resource=").concat(h.clientResource),data:JSON.stringify(f),dataType:"json",headers:{Authorization:"Bearer "+p,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call blockGroupMessages",e),i.hj.call(this,m,c.fI.BLOCK_GROUP)}var m=f;function v(e){if("number"!=typeof e.limit)throw Error("Invalid parameter");if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p={limit:e.limit,cursor:e.cursor};e.cursor||delete p.cursor;var h={url:this.apiUrl+"/"+l+"/"+u+"/publicchatgroups",type:"GET",dataType:"json",data:p,headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call listGroups",e),i.hj.call(this,h,c.fI.LIST_GROUP)}var g=v;function E(e){if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p={url:this.apiUrl+"/"+l+"/"+u+"/users/"+this.user+"/joined_chatgroups",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e&&(null==e?void 0:e.success),error:e&&(null==e?void 0:e.error)};return s.kg.debug("Call getJoinedGroups",e),i.hj.call(this,p,c.fI.GET_USER_GROUP)}function y(e){if("number"!=typeof e.pageNum||"number"!=typeof e.pageSize)throw Error('Invalid parameter: "pageNum or pageSize"');if(e.pageNum<0||e.pageSize<0)throw Error('"pageNum" should >= 0 and "pageSize" should >= 0');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.needAffiliations||e.needRole?"/chatgroups/user/".concat(this.user,"?pagenum=").concat(e.pageNum,"&pagesize=").concat(e.pageSize,"&needAffiliations=").concat(e.needAffiliations,"&needRole=").concat(e.needRole):"/users/".concat(this.user,"/joined_chatgroups?pagenum=").concat(e.pageNum,"&pagesize=").concat(e.pageSize),h={url:this.apiUrl+"/"+l+"/"+u+p,dataType:"json",type:"GET",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e&&(null==e?void 0:e.success),error:e&&(null==e?void 0:e.error)};return s.kg.debug("Call getGroup",e),i.hj.call(this,h,c.fI.GET_USER_GROUP).then((function(e){var t=e.uri,n=e.entities,r=[];return t.includes("joined_chatgroups")||(n.forEach((function(e){var t={affiliationsCount:e.affiliations_count,groupName:e.name,groupId:e.groupId,role:e.permission,disabled:e.disabled,approval:e.membersonly,allowInvites:e.allowinvites,description:e.description,maxUsers:e.maxusers,public:e.public};r.push(t)})),e.entities=r),e}))}function _(e){if("string"!=typeof e.groupId||"string"!=typeof e.newOwner)throw Error("Invalid parameter");if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n={newowner:e.newOwner},l=this.context,u=l.orgName,d=l.appName,p=l.accessToken,h=l.jid,f={url:"".concat(this.apiUrl,"/").concat(u,"/").concat(d,"/chatgroups/").concat(e.groupId,"?resource=").concat(h.clientResource),type:"PUT",dataType:"json",headers:{Authorization:"Bearer "+p,"Content-Type":"application/json"},data:JSON.stringify(n),success:e.success,error:e.error};return s.kg.debug("Call changeOwner",e),i.hj.call(this,f,c.fI.CHANGE_OWNER)}var b=_;function T(e){if("string"!=typeof e.groupId&&!Array.isArray(e.groupId))throw Error('Invalid parameter: "groupId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p={url:this.apiUrl+"/"+l+"/"+u+"/chatgroups/"+e.groupId+"?joined_time=true",type:"GET",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getGroupInfo",e),i.hj.call(this,p,c.fI.GET_GROUP_INFO)}function S(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error("Invalid parameter");if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={groupname:e.groupName,description:e.description,custom:e.ext},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"?resource=").concat(p.clientResource),type:"PUT",data:JSON.stringify(f),dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call modifyGroup",e),i.hj.call(this,m,c.fI.MODIFY_GROUP)}function O(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(isNaN(e.pageNum)||e.pageNum<=0)throw Error('The parameter "pageNum" should be a positive number');if(isNaN(e.pageSize)||e.pageSize<=0)throw Error('The parameter "pageSize" should be a positive number');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n={pagenum:e.pageNum,pagesize:e.pageSize},l=this.context,u=l.orgName,d=l.appName,p=l.accessToken,h={url:this.apiUrl+"/"+u+"/"+d+"/chatgroups/"+e.groupId+"/users",dataType:"json",type:"GET",data:n,headers:{Authorization:"Bearer "+p,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call listGroupMember",e),i.hj.call(this,h,c.fI.LIST_GROUP_MEMBER)}var R=O;function C(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.groupId,h={url:this.apiUrl+"/"+l+"/"+u+"/chatgroups/"+p+"/admin",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getGroupAdmin",e),i.hj.call(this,h,c.fI.GET_GROUP_ADMIN)}function w(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.username||""===e.username)throw Error('Invalid parameter: "username"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={newadmin:e.username},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/admin?resource=").concat(p.clientResource),type:"POST",dataType:"json",data:JSON.stringify(f),headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call setGroupAdmin",e),i.hj.call(this,m,c.fI.SET_GROUP_ADMIN)}var I=w;function A(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.username||""===e.username)throw Error('Invalid parameter: "username"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f=e.username,m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/admin/").concat(f,"?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call removeAdmin",e),i.hj.call(this,m,c.fI.REMOVE_GROUP_ADMIN)}var N=A;function k(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"?version=v3&resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call destroyGroup",e),i.hj.call(this,f,c.fI.DISSOLVE_GROUP)}var P=k;function D(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/quit?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call quitGroup",e),i.hj.call(this,f,c.fI.QUIT_GROUP)}var M=D;function L(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!Array.isArray(e.users))throw Error('Invalid parameter: "users"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=e.groupId,l={usernames:e.users},u=this.context,d=u.orgName,p=u.appName,h=u.accessToken,f=u.jid,m={url:"".concat(this.apiUrl,"/").concat(d,"/").concat(p,"/chatgroups/").concat(n,"/invite?resource=").concat(f.clientResource),type:"POST",data:JSON.stringify(l),dataType:"json",headers:{Authorization:"Bearer "+h,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call inviteUsersToGroup",e),i.hj.call(this,m,c.fI.INVITE_TO_GROUP)}var x=L;function U(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(e.groupId,"/apply?resource=").concat(p.clientResource),type:"POST",dataType:"json",data:JSON.stringify({message:e.message||""}),headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call joinGroup",e),i.hj.call(this,h,c.fI.JOIN_GROUP)}function j(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.applicant||""===e.applicant)throw Error('Invalid parameter: "applicant"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={applicant:e.applicant,verifyResult:!0,reason:"no clue"},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/apply_verify?resource=").concat(p.clientResource),type:"POST",dataType:"json",data:JSON.stringify(f),headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call agreeJoinGroup",e),i.hj.call(this,m,c.fI.AGREE_JOIN_GROUP)}var F=j;function B(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.applicant||""===e.applicant)throw Error('Invalid parameter: "applicant"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={applicant:e.applicant,verifyResult:!1,reason:e.reason||""},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/apply_verify?resource=").concat(p.clientResource),type:"POST",dataType:"json",data:JSON.stringify(f),headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call rejectGroupJoinRequest",e),i.hj.call(this,m,c.fI.REJECT_JOIN_GROUP)}var V=B;function H(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.invitee||""===e.invitee)throw Error('Invalid parameter: "invitee"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={invitee:e.invitee,verifyResult:!0},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/invite_verify?resource=").concat(p.clientResource),type:"POST",dataType:"json",data:JSON.stringify(f),headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call acceptGroupInvite",e),i.hj.call(this,m,c.fI.AGREE_INVITE_GROUP)}var G=H;function W(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.invitee||""===e.invitee)throw Error('Invalid parameter: "invitee"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={invitee:e.invitee,verifyResult:!1},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/invite_verify?resource=").concat(p.clientResource),type:"POST",dataType:"json",data:JSON.stringify(f),headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call rejectGroupInvite",e),i.hj.call(this,m,c.fI.REJECT_INVITE_GROUP)}var q=W;function K(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.username||""===e.username)throw Error('Invalid parameter: "username"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=e.groupId,l=e.username,u=this.context,d=u.orgName,p=u.appName,h=u.accessToken,f=u.jid,m={url:"".concat(this.apiUrl,"/").concat(d,"/").concat(p,"/chatgroups/").concat(n,"/users/").concat(l,"?resource=").concat(f.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+h,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call removeGroupMember",e),i.hj.call(this,m,c.fI.REMOVE_GROUP_MEMBER)}var Y=K;function z(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!Array.isArray(e.users))throw Error('Invalid parameter: "users"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f=e.users.join(","),m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/users/").concat(f,"?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call removeGroupMembers",e),i.hj.call(this,m,c.fI.MULTI_REMOVE_GROUP_MEMBER)}var X=z;function J(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!(Array.isArray(e.username)||"string"==typeof e.username&&""!==e.username))throw Error('Invalid parameter: "username"');if("number"!=typeof e.muteDuration)throw Error('Invalid parameter: "muteDuration"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={usernames:"string"==typeof e.username?[e.username]:e.username,mute_duration:e.muteDuration},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/mute?resource=").concat(p.clientResource),dataType:"json",type:"POST",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},data:JSON.stringify(f),success:e.success,error:e.error};return s.kg.debug("Call muteGroupMember",e),i.hj.call(this,m,c.fI.MUTE_GROUP_MEMBER)}var Z=J;function Q(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!(Array.isArray(e.username)||"string"==typeof e.username&&""!==e.username))throw Error('Invalid parameter: "username"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f=e.username,m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/mute/").concat(f,"?resource=").concat(p.clientResource),dataType:"json",type:"DELETE",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call unmuteGroupMember",e),i.hj.call(this,m,c.fI.UNMUTE_GROUP_MEMBER)}var $=Q;function ee(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.groupId,h={url:this.apiUrl+"/"+l+"/"+u+"/chatgroups/"+p+"/mute",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getGroupMuteList",e),i.hj.call(this,h,c.fI.GET_GROUP_MUTE_LIST)}var te=ee,ne=ee;function re(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.username||""===e.username)throw Error('Invalid parameter: "username"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f=e.username,m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/blocks/users/").concat(f,"?resource=").concat(p.clientResource),type:"POST",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call blockGroupMember",e),i.hj.call(this,m,c.fI.BLOCK_GROUP_MEMBER)}var oe=re;function ie(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!Array.isArray(e.usernames))throw Error('Invalid parameter: "usernames"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={usernames:e.usernames},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/blocks/users?resource=").concat(p.clientResource),data:JSON.stringify(f),type:"POST",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call blockGroupMembers",e),i.hj.call(this,m,c.fI.BLOCK_GROUP_MEMBERS)}var ae=ie;function se(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.username||""===e.username)throw Error('Invalid parameter: "username"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f=e.username,m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/blocks/users/").concat(f,"?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call unblockGroupMember",e),i.hj.call(this,m,c.fI.UNBLOCK_GROUP_MEMBER)}var ce=se;function le(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!Array.isArray(e.usernames))throw Error('Invalid parameter: "usernames"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f=e.usernames.join(","),m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/blocks/users/").concat(f,"?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call unblockGroupMembers",e),i.hj.call(this,m,c.fI.UNBLOCK_GROUP_MEMBERS)}var ue=le;function de(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.groupId,h={url:this.apiUrl+"/"+l+"/"+u+"/chatgroups/"+p+"/blocks/users",type:"GET",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getGroupBlacklist",e),i.hj.call(this,h,c.fI.GET_GROUP_BLACK_LIST)}var pe=de,he=de;function fe(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/ban?resource=").concat(p.clientResource),type:"POST",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call disableSendGroupMsg",e),i.hj.call(this,f,c.fI.DISABLED_SEND_GROUP_MSG)}function me(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/ban?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call enableSendGroupMsg",e),i.hj.call(this,f,c.fI.ENABLE_SEND_GROUP_MSG)}function ve(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!Array.isArray(e.users))throw Error('Invalid parameter: "users"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={usernames:e.users},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/white/users?resource=").concat(p.clientResource),type:"POST",data:JSON.stringify(f),dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call addUsersToGroupWhitelist",e),i.hj.call(this,m,c.fI.ADD_USERS_TO_GROUP_WHITE)}var ge=ve;function Ee(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.userName||""===e.userName)throw Error('Invalid parameter: "userName"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/white/users/").concat(e.userName,"?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call removeGroupAllowlistMember",e),i.hj.call(this,f,c.fI.REMOVE_GROUP_WHITE_MEMBER)}var ye=Ee,_e=Ee;function be(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.groupId,h={url:this.apiUrl+"/"+l+"/"+u+"/chatgroups/"+p+"/white/users",type:"GET",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getGroupAllowlist",e),i.hj.call(this,h,c.fI.GET_GROUP_WHITE_LIST)}var Te=be;function Se(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.userName||""===e.userName)throw Error('Invalid parameter: "userName"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.groupId,h={url:this.apiUrl+"/"+l+"/"+u+"/chatgroups/"+p+"/white/users/"+e.userName,type:"GET",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call isInGroupAllowlist",e),i.hj.call(this,h,c.fI.IS_IN_GROUP_WHITE_LIST)}var Oe=Se,Re=Se;function Ce(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,c=n.orgName,l=n.appName,u=n.accessToken,d=n.userId,p={url:this.apiUrl+"/"+c+"/"+l+"/sdk/chatgroups/"+e.groupId+"/mute/"+d,dataType:"json",type:"GET",headers:{Authorization:"Bearer "+u}};return s.kg.debug("Call isInGroupMutelist",e),i.hj.call(this,p).then((function(e){return{type:e.type,data:e.data}}))}function we(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.msgId||""===e.msgId)throw Error('Invalid parameter: "msgId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p={url:this.apiUrl+"/"+l+"/"+u+"/chatgroups/"+e.groupId+"/acks/"+e.msgId,dataType:"json",type:"GET",data:{limit:500,key:void 0},headers:{Authorization:"Bearer "+d},success:e.success,error:e.error};return s.kg.debug("Call getGroupMsgReadUser",e),i.hj.call(this,p,c.fI.GET_GROUP_MSG_READ_USER)}function Ie(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.groupId,h={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(p,"/announcement"),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call fetchGroupAnnouncement",e),i.hj.call(this,h,c.fI.GET_GROUP_ANN)}function Ae(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.announcement)throw Error('Invalid parameter: "announcement"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f={announcement:e.announcement},m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/announcement?resource=").concat(p.clientResource),type:"POST",dataType:"json",data:JSON.stringify(f),headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call updateGroupAnnouncement",e),i.hj.call(this,m,c.fI.UPDATE_GROUP_ANN)}function Ne(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("object"!==l(e.file))throw Error('Invalid parameter: "file"');if(a.XZ.call(this)){var t=this.context,n=t.orgName,r=t.appName,o=t.accessToken,u=t.jid,d=e.groupId;i.cT.call(this,{uploadUrl:"".concat(this.apiUrl,"/").concat(n,"/").concat(r,"/chatgroups/").concat(d,"/share_files?resource=").concat(u.clientResource),onFileUploadProgress:e.onFileUploadProgress,onFileUploadComplete:e.onFileUploadComplete,onFileUploadError:e.onFileUploadError,onFileUploadCanceled:e.onFileUploadCanceled,accessToken:o,apiUrl:this.apiUrl,file:e.file,appKey:this.context.appKey},c.fI.UPLOAD_GROUP_FILE),s.kg.debug("Call uploadGroupSharedFile",e)}}function ke(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if("string"!=typeof e.fileId||""===e.fileId)throw Error('Invalid parameter: "file"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=n.jid,h=e.groupId,f=e.fileId,m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(h,"/share_files/").concat(f,"?resource=").concat(p.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call deleteGroupSharedFile",e),i.hj.call(this,m,c.fI.DELETE_GROUP_FILE)}function Pe(e){if("string"!=typeof e.groupId||""===e.groupId)throw Error('Invalid parameter: "groupId"');if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p=e.pageNum||1,h=e.pageSize||10,f=e.groupId,m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/chatgroups/").concat(f,"/share_files?pagenum=").concat(p,"&pagesize=").concat(h),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getGroupSharedFilelist",e),i.hj.call(this,m,c.fI.GET_GROUP_FILE_LIST)}var De=Pe;function Me(e){var t=this.context,n=t.orgName,r=t.appName,o=t.accessToken,a=this.apiUrl,l=e.groupId,u=e.fileId;i.LR.call(this,{url:"".concat(a,"/").concat(n,"/").concat(r,"/chatgroups/").concat(l,"/share_files/").concat(u),onFileDownloadComplete:e.onFileDownloadComplete,onFileDownloadError:e.onFileDownloadError,accessToken:o,id:u,secret:e.secret},c.fI.DOWN_GROUP_FILE),s.kg.debug("Call downloadGroupSharedFile",e)}function Le(e){return u(this,void 0,void 0,(function(){var t,n,u,p,h,f,m,v,g,E,y;return d(this,(function(d){switch(d.label){case 0:if(t=e.groupId,n=e.userId,u=e.memberAttributes,"string"!=typeof t||""===t)throw Error('Invalid parameter: "groupId"');if("string"!=typeof n||""===n)throw Error('Invalid parameter: "userId"');if("object"!==l(u))throw Error('Invalid parameter: "memberAttributes"');return a.XZ.call(this)?(h=this.context,f=h.orgName,m=h.appName,v=h.accessToken,g=h.jid,E={metaData:u},y={url:"".concat(this.apiUrl,"/").concat(f,"/").concat(m,"/sdk/metadata/chatgroup/").concat(t,"/user/").concat(n,"?resource=").concat(g.clientResource),type:"PUT",dataType:"json",data:JSON.stringify(E),headers:{Authorization:"Bearer "+v,"Content-Type":"application/json"}},s.kg.debug("Call setGroupMemberAttributes",e),[4,i.hj.call(this,y,c.fI.SET_GROUP_MEMBER_ATTRS)]):(p=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(p)]);case 1:return d.sent(),[2]}}))}))}function xe(e){var t=e.groupId,n=e.userId;return Ue.call(this,{groupId:t,userIds:[n]}).then((function(e){var t;return{type:e.type,data:null===(t=e.data)||void 0===t?void 0:t[n]}}))}function Ue(e){var t=e.groupId,n=e.userIds,l=e.keys,u=void 0===l?[]:l;if("string"!=typeof t||""===t)throw Error('Invalid parameter: "groupId"');if(!Array.isArray(n)||(null==n?void 0:n.length)<=0)throw Error('Invalid parameter: "userIds"');if(!Array.isArray(u))throw Error('Invalid parameter: "keys"');if(!a.XZ.call(this)){var d=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(d)}var p=this.context,h=p.orgName,f=p.appName,m=p.accessToken,v={targets:n,properties:u},g={url:"".concat(this.apiUrl,"/").concat(h,"/").concat(f,"/sdk/metadata/chatgroup/").concat(t,"/get"),type:"POST",dataType:"json",data:JSON.stringify(v),headers:{Authorization:"Bearer "+m,"Content-Type":"application/json"}};return s.kg.debug("Call getGroupMembersAttributes",e),i.hj.call(this,g,c.fI.GET_GROUP_MEMBER_ATTR).then((function(e){return{type:e.type,data:(null==e?void 0:e.data)||{}}}))}},7479:function(e,t,n){"use strict";n.r(t),n.d(t,{acceptContactInvite:function(){return W},acceptInvitation:function(){return G},addContact:function(){return B},addConversationMark:function(){return ve},addReaction:function(){return te},addToBlackList:function(){return Y},addUsersToBlacklist:function(){return z},addUsersToBlocklist:function(){return X},declineContactInvite:function(){return K},declineInvitation:function(){return q},deleteAllMessagesAndConversations:function(){return _e},deleteContact:function(){return H},deleteConversation:function(){return k},deleteReaction:function(){return ne},deleteSession:function(){return N},fetchHistoryMessages:function(){return U},fetchUserInfoById:function(){return M},getAllContacts:function(){return he},getBlacklist:function(){return b},getBlocklist:function(){return T},getContacts:function(){return O},getContactsWithCursor:function(){return fe},getConversationlist:function(){return I},getHistoryMessages:function(){return F},getReactionDetail:function(){return ie},getReactionList:function(){return re},getReactionlist:function(){return oe},getRoster:function(){return S},getSelfIdsOnOtherPlatform:function(){return ye},getServerConversations:function(){return ce},getServerConversationsByFilter:function(){return Ee},getServerPinnedConversations:function(){return ue},getServerPinnedMessages:function(){return Oe},getSessionList:function(){return w},getTokenExpireTimestamp:function(){return x},modifyMessage:function(){return ee},pinConversation:function(){return de},pinMessage:function(){return Te},recallMessage:function(){return $},removeConversationMark:function(){return ge},removeFromBlackList:function(){return J},removeHistoryMessages:function(){return se},removeRoster:function(){return V},removeUserFromBlackList:function(){return Z},removeUserFromBlocklist:function(){return Q},reportMessage:function(){return ae},setContactRemark:function(){return pe},unbindPushToken:function(){return Re},unpinMessage:function(){return Se},updateCurrentUserNick:function(){return L},updateOwnUserInfo:function(){return P},updateUserInfo:function(){return D},uploadPushToken:function(){return C},uploadToken:function(){return R}}),n(9601),n(1539),n(8674),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948),n(9554),n(4747),n(2222),n(7941),n(6699),n(3710),n(9714),n(9600),n(5069),n(561),n(9753),n(8309),n(1249),n(7327);var r=n(3246),o=n(5531),i=n(7252),a=n(4024),s=n(9937),c=n(8161),l=n(4188),u=n.n(l),d=n(7360),p=n(1595),h=n(4363),f=n(7288),m=n(9743),v=n(6801),g=function(){return g=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},g.apply(this,arguments)},E=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},y=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},_={singleChat:"chat",chatRoom:"chatroom",groupChat:"groupchat"};function b(e){if(!r.XZ.call(this)){var t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u={url:this.apiUrl+"/"+s+"/"+c+"/users/"+this.user+"/blocks/users",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+l},success:function(t){var n={};t.data.forEach((function(e){n[e]={name:e}})),"function"==typeof(null==e?void 0:e.success)&&e.success(t)},error:function(t){"function"==typeof(null==e?void 0:e.error)&&e.error(t)}};return d.kg.debug("Call getBlocklist"),a.hj.call(this,u,p.fI.GET_BLACK_LIST)}var T=b,S=O;function O(e){var t=this;if(!r.XZ.call(this)){var n=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(n)}var s=this.context,c=s.orgName,l=s.appName,u=s.accessToken,h={url:this.apiUrl+"/"+c+"/"+l+"/users/"+this.user+"/contacts/users",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+u},success:function(n){var r=[];n.data.forEach((function(e){r.push({name:e,subscription:"both",jid:t.context.jid})})),"function"==typeof(null==e?void 0:e.success)&&e.success(r)},error:function(t){"function"==typeof(null==e?void 0:e.error)&&e.error(t)}};return d.kg.debug("Call getContacts"),a.hj.call(this,h,p.fI.GET_CONTACTS)}function R(e){return d.kg.debug("Call uploadPushToken"),v.r.call(this,e)}var C=R;function w(e){if(!r.XZ.call(this)){var t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/users/").concat(this.user,"/user_channels"),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"},success:e&&(null==e?void 0:e.success),error:e&&(null==e?void 0:e.error)};return d.kg.debug("Call getSessionList"),a.hj.call(this,u,p.fI.GET_SESSION_LIST)}function I(e){var t=this;if(!r.XZ.call(this)){var n=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(n)}var s=this.context,c=s.orgName,l=s.appName,u=s.accessToken,h=!!(e&&"number"==typeof e.pageNum&&"number"==typeof e.pageSize&&e.pageNum>0&&e.pageSize>0),f={url:"".concat(this.apiUrl,"/").concat(c,"/").concat(l,"/users/").concat(this.user,"/user_channels").concat(h?"/page":""),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+u,"Content-Type":"application/json"},success:e&&(null==e?void 0:e.success),error:e&&(null==e?void 0:e.error)};return h&&(f.data={pageNum:e.pageNum,pageSize:e.pageSize}),d.kg.debug("Call getConversationlist"),a.hj.call(this,f,p.fI.GET_SESSION_LIST).then((function(e){return A.call(t,e)}))}function A(e){var t=this,n=e.data.channel_infos;return null==n||n.forEach((function(e){e.meta&&"{}"!==JSON.stringify(e.meta)?(e.meta.payload=JSON.parse(e.meta.payload),e.lastMessage=h.w.call(t,e.meta,{formatCustomExts:!1})):e.lastMessage=e.meta,delete e.meta})),e}function N(e){if(e&&"string"!=typeof e.channel)throw Error("Invalid parameter channel: ".concat(e.channel));if(e&&"singleChat"!==e.chatType&&"groupChat"!==e.chatType)throw Error("Invalid parameter chatType: ".concat(e.chatType));if(e&&"boolean"!=typeof e.deleteRoam)throw Error("Invalid parameter deleteRoam: ".concat(e.deleteRoam));if(!r.XZ.call(this)){var t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n,s=this.context,c=s.orgName,l=s.appName,u=s.accessToken,h=s.jid;n="singleChat"===e.chatType?"chat":"groupChat";var f={url:"".concat(this.apiUrl,"/").concat(c,"/").concat(l,"/user/").concat(this.user,"/user_channel?resource=").concat(h.clientResource),dataType:"json",type:"DELETE",data:JSON.stringify({channel:e.channel,type:n,delete_roam:e.deleteRoam}),headers:{Authorization:"Bearer "+u,"Content-Type":"application/json"},success:e.success,error:e.error};return d.kg.debug("Call deleteSession",e),a.hj.call(this,f,p.fI.DELETE_SESSION)}var k=N;function P(e,t){if(!r.XZ.call(this)){var n=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(n)}var s=this.context,c=s.orgName,l=s.appName,u=s.accessToken,h=["nickname","avatarurl","mail","phone","gender","sign","birth","ext"],f={},m=a.P6.getEnvInfo();if("wx"===m.platform||"qq"===m.platform)if("string"==typeof e&&void 0!==t){if(!h.includes(e))throw new Error("illegal key, only these keys: nickname, avatarurl, mail, phone, gender, sign, birth, ext are allowed");f[e]=t}else{if("[object Object]"!==Object.prototype.toString.call(e))throw new Error("illegal params");h.forEach((function(t){h.includes(t)&&void 0!==e[t]&&(f[t]=e[t])}))}else if("string"==typeof e){if(!h.includes(e))throw new Error("illegal key, only these keys: nickname, avatarurl, mail, phone, gender, sign, birth, ext are allowed");f=e+"="+t}else{if("[object Object]"!==Object.prototype.toString.call(e))throw new Error("illegal params");var v=[];h.forEach((function(t){if(h.includes(t)&&void 0!==e[t]){var n=encodeURIComponent(t),r=encodeURIComponent(e[t]);v.push(n+"="+r)}})),f=v.join("&")}var g={url:"".concat(this.apiUrl,"/").concat(c,"/").concat(l,"/metadata/user/").concat(this.user),type:"PUT",data:f,dataType:"json",headers:{Authorization:"Bearer "+u,"Content-Type":"application/x-www-form-urlencoded"}};return d.kg.debug("Call updateOwnUserInfo",e),a.hj.call(this,g,p.fI.UPDATE_USER_INFO)}var D=P;function M(e,t){if(!r.XZ.call(this)){var n=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(n)}var s,c=this.context,l=c.orgName,u=c.appName,h=c.accessToken,f=[];if("string"==typeof e)f=[e];else{if("[object Array]"!==Object.prototype.toString.call(e))throw new Error("illegal params");f=e}s="string"==typeof t?[t]:t&&"[object Array]"===Object.prototype.toString.call(t)?t:["nickname","avatarurl","mail","phone","gender","sign","birth","ext"];var m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/metadata/user/get"),type:"POST",data:JSON.stringify({targets:f,properties:s}),dataType:"json",headers:{Authorization:"Bearer "+h,"Content-Type":"application/json"}};return d.kg.debug("Call fetchUserInfoById",e),a.hj.call(this,m,p.fI.GET_USER_INFO)}function L(e){if(!r.XZ.call(this)){var t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/users/").concat(this.user),type:"PUT",dataType:"json",data:JSON.stringify({nickname:e}),headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}};return d.kg.debug("Call updateCurrentUserNick",e),a.hj.call(this,u)}function x(e){if("string"!=typeof e||""===e)throw Error('Invalid parameter: "token"');var t=this.context,n=t.orgName,r=t.appName,o={url:"".concat(this.apiUrl,"/").concat(n,"/").concat(r,"/sdk/users/").concat(this.user,"/token/expires"),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}};return d.kg.debug("Call getTokenExpireTimestamp",e),a.hj.call(this,o,p.fI.SDK_INTERNAL)}function U(e){var t=this;return new Promise((function(n,a){if(!e.queue)throw Error('Invalid parameter: "specified"');if(!r.XZ.call(t)){var s=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(s)}(function e(t){var r=this,o=t.count||20;j.call(this,{count:o,isGroup:!!t.isGroup,queue:t.queue,start:t.start,format:t.format,success:function(i){if(i.msgs.length>=o||i.is_last){var a=i.msgs.splice(0,o).reverse();t.success&&t.success(a),n(a)}else e.call(r,g(g({},t),{start:null}))},fail:function(e){a(e),t.fail&&t.fail(e)}})}).call(t,e),d.kg.debug("Call fetchHistoryMessages",e)}))}function j(e){var t=this,n=e.queue,r=this.mr_cache[n]||(this.mr_cache[n]={msgs:[]}),s=this.context.userId,l=e.start||-1,d=e.count||20;if(r.msgs.length>=d||r.is_last)"function"==typeof e.success&&e.success(r);else{r&&r.next_key&&(l=r.next_key),e.start&&(l=e.start);var h={queue:n+(e.isGroup?"@conference.easemob.com":"@easemob.com"),start:l,end:-1},f=this.context,m=f.orgName,v=f.appName,g={url:"".concat(this.apiUrl,"/").concat(m,"/").concat(v,"/users/").concat(s,"/messageroaming"),dataType:"json",type:"POST",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"},data:JSON.stringify(h),success:function(n){return E(t,void 0,void 0,(function(){var t,o,i,a,s,l,d=this;return y(this,(function(p){switch(p.label){case 0:if(t=null==n?void 0:n.data,!n.data.msgs)return"function"==typeof e.success&&e.success(r),r.is_last=!0,r.next_key="",[2];o=t.msgs,i=o.length,r.is_last=t.is_last,r.next_key=t.next_key,a=function(t){return E(d,void 0,void 0,(function(){var n,r,o,i,a;return y(this,(function(s){switch(s.label){case 0:for(n=[],t=u().atob(t),r=0,o=t.length;r<o;++r)n.push(t.charCodeAt(r));return i=(i=this.context.root.lookup("easemob.pb.Meta")).decode(n),a={errorCode:0,reason:""},1!==i.ns?[3,2]:[4,c.Z.call(this,i,a,!0,e.format)];case 1:return[2,s.sent()];case 2:return[2]}}))}))},s=0,p.label=1;case 1:return s<i?[4,a(o[s].msg)]:[3,4];case 2:(l=p.sent())&&r.msgs.push(l),p.label=3;case 3:return s++,[3,1];case 4:return"function"==typeof e.success&&e.success(r),[2]}}))}))},error:function(e){if(e.error&&e.error_description){var n=i.Z.create({type:o.E.WEBIM_CONNCTION_AJAX_ERROR,message:"fetch history messages error",data:e});t.onError&&t.onError(n)}}};a.hj.call(this,g,p.fI.GET_HISTORY_MSG).catch((function(t){"function"==typeof e.fail&&e.fail(t)}))}}function F(e){var t=this;return new Promise((function(n,s){var l=e.targetId,p=e.cursor,h=void 0===p?-1:p,f=e.pageSize,m=void 0===f?20:f,v=e.chatType,g=e.searchDirection,_=e.searchOptions,b=void 0===_?{}:_,T=b.msgTypes,S=void 0===T?[]:T,O=b.startTime,R=void 0===O?null:O,C=b.endTime,w=void 0===C?null:C,I=b.from,A=void 0===I?null:I;if("string"!=typeof l||""===l)throw Error('"Invalid parameter": "targetId"');if(A&&"string"!=typeof A)throw Error('"Invalid parameter": "searchOptions.from"');if(S&&!Array.isArray(S))throw Error('"Invalid parameter": "searchOptions.msgTypes"');if(R&&"number"!=typeof R)throw Error('"Invalid parameter": "searchOptions.startTime"');if(w&&"number"!=typeof R)throw Error('"Invalid parameter": "searchOptions.endTime"');if(!r.XZ.call(t)){var N=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return s(N)}var k=t.context,P=k.orgName,D=k.appName,M=k.userId,L="singleChat"===e.chatType?"@easemob.com":"@conference.easemob.com",x={queue:"".concat(l).concat(L),start:h,pull_number:m,is_positive:"down"===g,msgType:S.join(",")||"",end:-1,startTime:R,endTime:w,userId:"singleChat"===v?null:A},U={url:"".concat(t.apiUrl,"/").concat(P,"/").concat(D,"/users/").concat(M,"/messageroaming"),dataType:"json",type:"POST",headers:{Authorization:"Bearer "+t.token,"Content-Type":"application/json"},data:JSON.stringify(x),success:function(r){return E(t,void 0,void 0,(function(){var t,o,i,a,s,l,d,p,h=this;return y(this,(function(f){switch(f.label){case 0:t=null==r?void 0:r.data,o=t.msgs||[],i=function(e){return E(h,void 0,void 0,(function(){var t,n,r,o,i;return y(this,(function(a){switch(a.label){case 0:for(t=[],e=u().atob(e),n=0,r=e.length;n<r;++n)t.push(e.charCodeAt(n));return o=(o=this.context.root.lookup("easemob.pb.Meta")).decode(t),i={errorCode:0,reason:""},1!==o.ns?[3,2]:[4,c.Z.call(this,o,i,!0,!0)];case 1:return[2,a.sent()];case 2:return[2]}}))}))},a=[],s=0,f.label=1;case 1:return s<o.length?[4,i(o[s].msg)]:[3,4];case 2:(l=f.sent())&&a.push(l),f.label=3;case 3:return s++,[3,1];case 4:return t.msgs=a,d={cursor:t.next_key,messages:a,isLast:t.is_last},null===(p=e.success)||void 0===p||p.call(e,d),n(d),[2]}}))}))},error:e.fail};a.hj.call(t,U).catch((function(e){s(e)})),d.kg.debug("Call getHistoryMessages",e)}))}function B(e,t){return E(this,void 0,void 0,(function(){var n,s,c,l,u,h,f;return y(this,(function(m){switch(m.label){case 0:if(!r.XZ.call(this))return n=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(n)];if("string"!=typeof e||""===e)throw Error('"Invalid parameter": "to"');return d.kg.debug("Call addContact",e,t),s=this.context,c=s.orgName,l=s.appName,u=s.accessToken,h=s.jid,f={url:"".concat(this.apiUrl,"/").concat(c,"/").concat(l,"/users/").concat(this.user,"/contacts/apply?resource=").concat(h.clientResource),type:"POST",dataType:"json",data:JSON.stringify({usernames:[e],reason:t}),headers:{Authorization:"Bearer "+u,"Content-Type":"application/json"}},[4,a.hj.call(this,f,p.fI.ROSTER_ADD)];case 1:return m.sent(),[2]}}))}))}var V=H;function H(e){return E(this,void 0,void 0,(function(){var t,n,s,c,l,u,h;return y(this,(function(f){switch(f.label){case 0:if(!r.XZ.call(this))return t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)];if("string"!=typeof e||""===e)throw Error('"Invalid parameter": "to"');return d.kg.debug("Call deleteContact",e),n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u=n.jid,h={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/users/").concat(this.user,"/contacts/users/").concat(e,"?resource=").concat(u.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}},[4,a.hj.call(this,h,p.fI.ROSTER_REMOVE)];case 1:return f.sent(),[2]}}))}))}function G(e){return E(this,void 0,void 0,(function(){var t,n,s,c,l,u,h;return y(this,(function(f){switch(f.label){case 0:if(!r.XZ.call(this))return t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)];if("string"!=typeof e||""===e)throw Error('"Invalid parameter": "to"');return d.kg.debug("Call acceptInvitation",e),n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u=n.jid,h={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/users/").concat(this.user,"/contacts/accept/users/").concat(e,"?resource=").concat(u.clientResource),type:"POST",dataType:"json",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}},[4,a.hj.call(this,h,p.fI.ROSTER_ACCEPT)];case 1:return f.sent(),[2]}}))}))}var W=G;function q(e){return E(this,void 0,void 0,(function(){var t,n,s,c,l,u,h;return y(this,(function(f){switch(f.label){case 0:if(!r.XZ.call(this))return t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)];if("string"!=typeof e||""===e)throw Error('"Invalid parameter": "to"');return d.kg.debug("Call declineInvitation",e),n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u=n.jid,h={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/users/").concat(this.user,"/contacts/decline/users/").concat(e,"?resource=").concat(u.clientResource),type:"POST",dataType:"json",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}},[4,a.hj.call(this,h,p.fI.ROSTER_DECLINE)];case 1:return f.sent(),[2]}}))}))}var K=q;function Y(e){return E(this,void 0,void 0,(function(){var t,n,s,c,l,u,h,f,m;return y(this,(function(v){switch(v.label){case 0:if(!r.XZ.call(this))return t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)];if(n=e.name,s=[],"string"==typeof n){if(""===n)throw Error('"Invalid parameter": "name"');s=[n]}else{if(!Array.isArray(n))throw Error('"Invalid parameter": "name"');s=n}return d.kg.debug("Call addToBlockList",e),c=this.context,l=c.orgName,u=c.appName,h=c.accessToken,f=c.jid,m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/sdk/user/").concat(this.user,"/blocks?resource=").concat(f.clientResource),type:"POST",dataType:"json",data:JSON.stringify({usernames:s}),headers:{Authorization:"Bearer "+h,"Content-Type":"application/json"}},[4,a.hj.call(this,m,p.fI.ROSTER_BAN).then((function(e){return{type:e.type,data:{userIds:(null==e?void 0:e.data)||[]}}}))];case 1:return[2,v.sent()]}}))}))}var z=Y,X=Y;function J(e){return E(this,void 0,void 0,(function(){var t,n,s,c,l,u,h,f,m;return y(this,(function(v){switch(v.label){case 0:if(!r.XZ.call(this))return t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)];if(n=e.name,s=[],"string"==typeof n){if(""===n)throw Error('"Invalid parameter": "name"');s=[n]}else{if(!Array.isArray(n))throw Error('"Invalid parameter": "name"');s=n}return d.kg.debug("Call removeFromBlockList",e),c=this.context,l=c.orgName,u=c.appName,h=c.accessToken,f=c.jid,m={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/sdk/user/").concat(this.user,"/blocks?resource=").concat(f.clientResource),type:"DELETE",dataType:"json",data:JSON.stringify({usernames:s}),headers:{Authorization:"Bearer "+h,"Content-Type":"application/json"}},[4,a.hj.call(this,m,p.fI.ROSTER_ALLOW)];case 1:return v.sent(),[2]}}))}))}var Z=J,Q=J;function $(e){var t=this,n=(null==e?void 0:e.ext)||"";if("string"!=typeof n)throw Error('"Invalid parameter": "ext"',n);var r=this.getUniqueId(),o={id:r,to:e.to};this._msgHash[r]=g({},o);var i="";void 0!==e.chatType?i=e.chatType:void 0!==e.type&&(i="chat"===e.type?"singleChat":e.type);var a={id:r,type:"recall",chatType:i,ackId:e.mid,to:e.to,isChatThread:e.isChatThread||!1,metaExt:n,success:function(n){return E(t,void 0,void 0,(function(){var t,r,o,a,s,c,l,u,d;return y(this,(function(p){switch(p.label){case 0:return p.trys.push([0,5,,6]),"singleChat"!==i&&"groupChat"!==i?[3,4]:[4,null===(o=null===(r=this._localCache)||void 0===r?void 0:r.getInstance())||void 0===o?void 0:o.removeMsgByServerMsgId(e.mid)];case 1:return p.sent(),[4,null===(s=null===(a=this._localCache)||void 0===a?void 0:a.getInstance())||void 0===s?void 0:s.getConversationLastMessage(e.to,i)];case 2:return t=p.sent(),[4,null===(l=null===(c=this._localCache)||void 0===c?void 0:c.getInstance())||void 0===l?void 0:l.updateLocalConversation((0,m.MQ)({conversationId:e.to,conversationType:i}),{lastMessageId:null==t?void 0:t.serverMsgId})];case 3:p.sent(),p.label=4;case 4:return null===(u=null==e?void 0:e.success)||void 0===u||u.call(e,n),[3,6];case 5:return p.sent(),null===(d=null==e?void 0:e.success)||void 0===d||d.call(e,n),[3,6];case 6:return[2]}}))}))},fail:e.fail};return d.kg.debug("Call recallMessage",e),this.mSync.send(a,this)}function ee(e){var t=e||{},n=t.messageId,r=t.modifiedMessage;if(d.kg.debug("Call modifyMessage",n,r),""===n)throw Error('Invalid parameter: "messageId"');if("txt"!==r.type)throw Error('Invalid parameter: "modifiedMessage.type"');return this.mSync.send(g({editMessageId:n},r))}function te(e){return E(this,void 0,void 0,(function(){var t,n,s,c,l,u,d,p,h;return y(this,(function(f){switch(f.label){case 0:if("string"!=typeof e.messageId||!e.messageId)throw Error("Invalid parameter messageId: ".concat(e.messageId));if("string"!=typeof e.reaction||!e.reaction)throw Error("Invalid parameter reaction: ".concat(e.reaction));return r.XZ.call(this)?(n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u=e.reaction,d=e.messageId,p={msgId:d,message:u},h={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/reaction/user/").concat(this.user),type:"POST",data:JSON.stringify(p),dataType:"json",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}},[4,a.hj.call(this,h)]):(t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)]);case 1:return f.sent(),[2]}}))}))}function ne(e){return E(this,void 0,void 0,(function(){var t,n,s,c,l,u,d,p;return y(this,(function(h){switch(h.label){case 0:if("string"!=typeof e.reaction||!e.reaction)throw Error("Invalid parameter reactionId: ".concat(e.reaction));return r.XZ.call(this)?(n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u=e.messageId,d=e.reaction,p={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/reaction/user/").concat(this.user,"?msgId=").concat(u,"&message=").concat(d),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}},[4,a.hj.call(this,p)]):(t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)]);case 1:return h.sent(),[2]}}))}))}function re(e){if("string"!=typeof e.chatType||!e.chatType)throw Error("Invalid parameter chatType: ".concat(e.chatType));if(!e.messageId)throw Error("Invalid parameter messageId: ".concat(e.messageId));if(!r.XZ.call(this)){var t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u=e.chatType,d=e.messageId,p={msgIdList:"string"==typeof d?[d]:d,msgType:"singleChat"===u?"chat":"groupchat",groupId:e.groupId||null},h={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/reaction/user/").concat(this.user),type:"GET",data:p,dataType:"json",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}};return a.hj.call(this,h).then((function(e){var t=e.data;return null==t||t.forEach((function(e){null==e||e.reactionList.forEach((function(e){e.isAddedBySelf=e.state,delete e.state,delete e.reactionId}))})),e}))}var oe=re;function ie(e){if("string"!=typeof e.reaction||!e.reaction)throw Error("Invalid parameter reaction: ".concat(e.reaction));if("string"!=typeof e.messageId||!e.messageId)throw Error("Invalid parameter messageId: ".concat(e.messageId));if(!r.XZ.call(this)){var t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u=e.cursor,d=e.pageSize,p={msgId:e.messageId,message:e.reaction,currentPage:u||null,pageSize:d||20},h={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/reaction/user/").concat(this.user,"/detail"),type:"GET",data:p,dataType:"json",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}};return a.hj.call(this,h).then((function(e){return e.data.isAddedBySelf=e.data.state,delete e.data.state,delete e.data.reactionId,e}))}function ae(e){return E(this,void 0,void 0,(function(){var t,n,s,c,l,u,d,p,h,f,m;return y(this,(function(v){switch(v.label){case 0:if("string"!=typeof e.reportType||!e.reportType)throw Error("Invalid parameter reportType: ".concat(e.reportType));if("string"!=typeof e.messageId||!e.messageId)throw Error("Invalid parameter messageId: ".concat(e.messageId));if("string"!=typeof e.reportReason||!e.reportReason)throw Error("Invalid parameter messageId: ".concat(e.reportReason));return r.XZ.call(this)?(n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u=e.reportType,d=e.reportReason,p=e.messageId,h={username:this.user,reportType:u,reportReason:d},f="".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/user/").concat(this.user,"/moderation/report/message/").concat(p),m={url:f,type:"POST",data:JSON.stringify(h),dataType:"json",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}},[4,a.hj.call(this,m)]):(t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)]);case 1:return v.sent(),[2]}}))}))}function se(e){var t;return E(this,void 0,void 0,(function(){var n,s,c,l,u,p,h,f,m;return y(this,(function(v){switch(v.label){case 0:if("string"!=typeof e.targetId||""===e.targetId)throw Error('"Invalid parameter targetId": '+e.targetId);if(!["singleChat","groupChat","chatRoom"].includes(e.chatType))throw Error('"Invalid parameter chatType": '+e.chatType);if(e.beforeTimeStamp&&("number"!=typeof e.beforeTimeStamp||e.beforeTimeStamp<0||(null===(t=e.beforeTimeStamp)||void 0===t?void 0:t.toString().length)>18))throw Error('"Invalid parameter beforeTimeStamp": '+e.beforeTimeStamp);if(e.messageIds&&!(Array.isArray(e.messageIds)&&e.messageIds.length>0&&e.messageIds.length<=20))throw Error('"Invalid parameter messageIds": '+e.messageIds);if(!e.messageIds&&!e.beforeTimeStamp)throw Error("messageIds or beforeTimeStamp field is required.");return r.XZ.call(this)?(s=this.context,c=s.orgName,l=s.appName,u=s.userId,p="singleChat"===e.chatType?"userId":"groupId",h="singleChat"===e.chatType?"chat":"group",f=e.messageIds?"".concat(this.apiUrl,"/").concat(c,"/").concat(l,"/sdk/message/roaming/").concat(h,"/user/").concat(u,"?").concat(p,"=").concat(e.targetId,"&msgIdList=").concat(e.messageIds,"&resource=").concat(this.clientResource):"".concat(this.apiUrl,"/").concat(c,"/").concat(l,"/sdk/message/roaming/").concat(h,"/user/").concat(u,"/time?").concat(p,"=").concat(e.targetId,"&delTime=").concat(e.beforeTimeStamp,"&&resource=").concat(this.clientResource),m={url:f,dataType:"json",type:"DELETE",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}},d.kg.debug("Call removeHistoryMessages",e),[4,a.hj.call(this,m)]):(n=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(n)]);case 1:return v.sent(),[2]}}))}))}function ce(e){var t=this;if(!r.XZ.call(this)){var n=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(n)}if((null==e?void 0:e.pageSize)&&"number"!=typeof e.pageSize)throw Error("Invalid parameter pageSize: ".concat(e.pageSize));if((null==e?void 0:e.cursor)&&"string"!=typeof e.cursor)throw Error("Invalid parameter cursor: ".concat(e.cursor));var s=this.context,c=s.orgName,l=s.appName,u=s.accessToken,h={url:"".concat(this.apiUrl,"/").concat(c,"/").concat(l,"/sdk/user/").concat(this.user,"/user_channels/list?"),type:"GET",dataType:"json",data:{limit:(null==e?void 0:e.pageSize)||20,cursor:(null==e?void 0:e.cursor)||"",need_mark:!0},headers:{Authorization:"Bearer "+u,"Content-Type":"application/json"}};return d.kg.debug("Call getServerConversations",e),new Promise((function(e,n){a.hj.call(t,h,p.fI.GET_SESSION_LIST).then((function(n){return E(t,void 0,void 0,(function(){var t,r,o=this;return y(this,(function(i){switch(i.label){case 0:return t=le.call(this,n),this._localCache?(r=t.data.conversations.map((function(e){return E(o,void 0,void 0,(function(){var t,n,r,o;return y(this,(function(i){switch(i.label){case 0:return[4,null===(n=null===(t=this._localCache)||void 0===t?void 0:t.getInstance())||void 0===n?void 0:n.storeMessage(e.lastMessage,f.r.SUCCESS,!0)];case 1:return i.sent(),[4,null===(o=null===(r=this._localCache)||void 0===r?void 0:r.getInstance())||void 0===o?void 0:o.updateLocalConversation((0,m.MQ)({conversationId:e.conversationId,conversationType:e.conversationType}),{unReadCount:e.unReadCount})];case 2:return i.sent(),[2]}}))}))})),[4,Promise.all(r)]):[3,2];case 1:i.sent(),i.label=2;case 2:return e(t),[2]}}))}))})).catch((function(e){n(e)}))}))}function le(e){var t=this,n=e.data,r=n.cursor,o=n.channel_infos,i=[];null==o||o.forEach((function(e){var n=null;(null==e?void 0:e.meta)&&"{}"!==JSON.stringify(e.meta)&&(e.meta.payload=JSON.parse(e.meta.payload),"delivery"!==(n=h.w.call(t,e.meta)).type&&"read"!==n.type&&"channel"!==n.type&&(n.chatType=h.U[n.chatType]));var r={conversationId:e.session_to,conversationType:"chat"===e.session_type?"singleChat":"groupChat",isPinned:e.is_top,pinnedTime:e.is_top?e.update_top_status_time:0,unReadCount:e.unread_num,lastMessage:n};e.marks&&(r.marks=e.marks.map((function(e){return s.Z[e]}))),i.push(r)}));var a={conversations:i,cursor:r||""};return{type:e.type,data:a}}function ue(e){var t=this;if(!r.XZ.call(this)){var n=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(n)}if((null==e?void 0:e.pageSize)&&"number"!=typeof e.pageSize)throw Error("Invalid parameter pageSize: ".concat(e.pageSize));if((null==e?void 0:e.cursor)&&"string"!=typeof e.cursor)throw Error("Invalid parameter cursor: ".concat(e.cursor));var s=this.context,c=s.orgName,l=s.appName,u=s.accessToken,h={url:"".concat(this.apiUrl,"/").concat(c,"/").concat(l,"/sdk/user/").concat(this.user,"/user_channels/list?"),type:"GET",dataType:"json",data:{limit:(null==e?void 0:e.pageSize)||20,cursor:(null==e?void 0:e.cursor)||"",is_top:!0,need_mark:!0},headers:{Authorization:"Bearer "+u,"Content-Type":"application/json"}};return d.kg.debug("Call getServerPinnedConversations",e),a.hj.call(this,h,p.fI.GET_SESSION_LIST).then((function(e){return le.call(t,e)}))}function de(e){return E(this,void 0,void 0,(function(){var t,n,s,c,l,u,h,f,m,v,g,E,_,b;return y(this,(function(y){if(!r.XZ.call(this))return t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)];if(n=e.conversationId,s=e.conversationType,c=e.isPinned,l="singleChat"===s?"chat":"groupChat","string"!=typeof n||""===n)throw Error("Invalid parameter conversationId: ".concat(n));if(!["singleChat","groupChat"].includes(s))throw Error("Invalid parameter conversationType: ".concat(s));if("boolean"!=typeof c)throw Error("Invalid parameter isPinned: ".concat(c));return u=this.context,h=u.orgName,f=u.appName,m=u.accessToken,v=u.jid,g={type:l,to:n},E=c?"":"type=".concat(l,"&to=").concat(n,"&"),_="".concat(this.apiUrl,"/").concat(h,"/").concat(f,"/sdk/user/").concat(this.user,"/user_channel/top?").concat(E,"resource=").concat(v.clientResource),b={url:_,type:c?"POST":"DELETE",dataType:"json",headers:{Authorization:"Bearer "+m,"Content-Type":"application/json"}},c&&(b.data=JSON.stringify(g)),d.kg.debug("Call pinConversation",e),[2,a.hj.call(this,b,p.fI.PIN_CONVERSATION).then((function(e){var t=e.type,n=e.data;return{type:t,data:{isPinned:n.is_top||!1,pinnedTime:n.is_top?n.update_top_status_time:0}}}))]}))}))}function pe(e){return E(this,void 0,void 0,(function(){var t,n,s,c,l,u,h,f,m,v;return y(this,(function(g){switch(g.label){case 0:if(t=e.userId,n=e.remark,!r.XZ.call(this))return s=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(s)];if("string"!=typeof t||""===t)throw Error('Invalid parameter: "userId"');if("string"!=typeof n)throw Error('Invalid parameter: "remark"');return d.kg.debug("Call setContactRemark",e),c=this.context,l=c.orgName,u=c.appName,h=c.accessToken,f=c.jid,m="".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/users/").concat(this.context.userId,"/contacts/users/").concat(t,"?resource=").concat(f.clientResource),v={url:m,type:"PUT",data:JSON.stringify({remark:n}),dataType:"json",headers:{Authorization:"Bearer "+h,"Content-Type":"application/json"}},[4,a.hj.call(this,v,p.fI.ROSTER_SET_CONTACT_REMARK)];case 1:return g.sent(),[2]}}))}))}function he(){if(!r.XZ.call(this)){var e=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(e)}var t=this.context,n=t.orgName,s=t.appName,c=t.accessToken,l={url:"".concat(this.apiUrl,"/").concat(n,"/").concat(s,"/users/").concat(this.user,"/contacts/users?needReturnRemark=true"),dataType:"json",type:"GET",headers:{Authorization:"Bearer "+c}};return d.kg.debug("Call getAllContacts"),a.hj.call(this,l,p.fI.ROSTER_GET_ALL_CONTACTS_REMARKS).then((function(e){var t=((null==e?void 0:e.entities)||[]).map((function(e){return{userId:e.username,remark:e.remark}}));return{type:e.type,data:t}}))}function fe(e){if(!r.XZ.call(this)){var t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}d.kg.debug("Call getContactsWithCursor",e);var n=e||{},s=n.pageSize,c=void 0===s?20:s,l=n.cursor,u=void 0===l?"":l;if(c&&"number"!=typeof c)throw Error("Invalid parameter pageSize: ".concat(e.pageSize));var h=this.context,f=h.orgName,m=h.appName,v=h.accessToken,g={url:"".concat(this.apiUrl,"/").concat(f,"/").concat(m,"/users/").concat(this.user,"/contacts?needReturnRemark=true&limit=").concat(c,"&cursor=").concat(u),dataType:"json",type:"GET",headers:{Authorization:"Bearer "+v}};return a.hj.call(this,g,p.fI.ROSTER_GET_ALL_CONTACTS_REMARKS_FROM_SERVER_BY_PAGE).then((function(e){var t,n,r=(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.contacts)||[],o=(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.cursor)||"",i=r.map((function(e){return{userId:e.username,remark:e.remark}}));return{type:e.type,data:{cursor:o,contacts:i}}}))}function me(e){return E(this,void 0,void 0,(function(){var t,n,c,l,u,f,m,v,g,E,b,T,S,O,R;return y(this,(function(y){switch(y.label){case 0:if(!r.XZ.call(this))return t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)];if(d.kg.debug("Call markConversation",e),c=(n=e||{}).conversations,l=void 0===c?[]:c,u=n.mark,f=n.isMarked,!Array.isArray(l))throw Error("Invalid parameter conversations");if(m=l.map((function(e){if(!e.conversationId||!["singleChat","groupChat"].includes(e.conversationType))throw Error("Invalid parameter conversations");return{to:e.conversationId,type:_[e.conversationType]}})),"boolean"!=typeof f)throw Error("Invalid parameter isMarked: ".concat(f));if("number"!=typeof u)throw Error("Invalid parameter mark: ".concat(u));return v=this.context,g=v.orgName,E=v.appName,b=v.accessToken,T=v.userId,S=v.jid,O={mark:s.Z[u],targets:m},R={url:"".concat(this.apiUrl,"/").concat(g,"/").concat(E,"/sdk/user/").concat(T,"/user_channels/mark?resource=").concat(S.clientResource),dataType:"json",data:JSON.stringify(O),type:f?"Post":"Delete",headers:{Authorization:"Bearer "+b}},[4,a.hj.call(this,R,p.fI.MARK_CONVERSATION).then((function(e){var t,n=(null===(t=e.data)||void 0===t?void 0:t.ignore)||[];n&&Array.isArray(n)&&n.length>0&&d.kg.debug("markConversation has ignored conversations",n.map((function(e){return{conversationId:e.to,conversationType:h.U[e.type]}})))}))];case 1:return y.sent(),[2]}}))}))}function ve(e){return E(this,void 0,void 0,(function(){var t,n;return y(this,(function(r){return d.kg.debug("Call addConversationMark",e),t=e.conversations,n=e.mark,[2,me.call(this,{conversations:t,mark:n,isMarked:!0})]}))}))}function ge(e){return E(this,void 0,void 0,(function(){var t,n;return y(this,(function(r){return d.kg.debug("Call removeConversationMark",e),t=e.conversations,n=e.mark,[2,me.call(this,{conversations:t,mark:n,isMarked:!1})]}))}))}function Ee(e){var t,n,c=this;if(!r.XZ.call(this)){var l=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(l)}if(d.kg.debug("Call getServerConversationsByFilter",e),(null==e?void 0:e.pageSize)&&"number"!=typeof e.pageSize)throw Error("Invalid parameter pageSize: ".concat(e.pageSize));if((null==e?void 0:e.cursor)&&"string"!=typeof e.cursor)throw Error("Invalid parameter cursor: ".concat(e.cursor));if("number"!=typeof(null===(t=null==e?void 0:e.filter)||void 0===t?void 0:t.mark))throw Error("Invalid parameter mark: ".concat(null===(n=null==e?void 0:e.filter)||void 0===n?void 0:n.mark));var u=this.context,h=u.orgName,f=u.appName,m=u.accessToken,v="".concat(this.apiUrl,"/").concat(h,"/").concat(f,"/sdk/user/").concat(this.user,"/user_channels/mark/search?"),g=e.pageSize,E=e.cursor,y=((null==e?void 0:e.filter)||{}).mark,_={url:v,type:"GET",dataType:"json",data:{limit:g||10,cursor:E||"",need_mark:!0,mark:s.Z[y]},headers:{Authorization:"Bearer "+m,"Content-Type":"application/json"}};return a.hj.call(this,_,p.fI.GET_SESSION_LIST).then((function(e){return le.call(c,e)}))}function ye(){if(!r.XZ.call(this)){var e=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(e)}d.kg.debug("Call getSelfIdsOnOtherPlatform");var t=this.context,n=t.orgName,s=t.appName,c=t.accessToken,l=t.userId,u=t.jid,h={url:"".concat(this.apiUrl,"/").concat(n,"/").concat(s,"/users/").concat(l,"/resources"),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+c,"Content-Type":"application/json"}};return a.hj.call(this,h,p.fI.USER_LOGGEDIN_OTHER_PLATFORM).then((function(e){var t,n=null===(t=e.data)||void 0===t?void 0:t.filter((function(e){return e.res!==u.clientResource})),r=null==n?void 0:n.map((function(e){return"".concat(l,"/").concat(e.res)}));return{type:e.type,data:r}}))}function _e(){var e,t,n,s,c,l;return E(this,void 0,void 0,(function(){var u,h,f,m,v,g,E,_,b;return y(this,(function(y){switch(y.label){case 0:return r.XZ.call(this)?(d.kg.debug("Call deleteAllMessagesAndConversations"),h=this.context,f=h.orgName,m=h.appName,v=h.accessToken,g=h.userId,E=h.jid,_="".concat(this.apiUrl,"/").concat(f,"/").concat(m,"/sdk/message/roaming/user/").concat(g,"/delete/all?resource=").concat(E.clientResource),b={url:_,type:"POST",dataType:"json",headers:{Authorization:"Bearer "+v,"Content-Type":"application/json"}},[4,a.hj.call(this,b,p.fI.REST_DELETE_MESSAGES_CONVERSATIONS)]):(u=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(u)]);case 1:return y.sent(),null===(t=null===(e=this._localCache)||void 0===e?void 0:e.getInstance())||void 0===t||t.clearConversationMap(),[4,null===(s=null===(n=this._localCache)||void 0===n?void 0:n.getInstance())||void 0===s?void 0:s.clearStoreData("conversationList")];case 2:return y.sent(),[4,null===(l=null===(c=this._localCache)||void 0===c?void 0:c.getInstance())||void 0===l?void 0:l.clearStoreData("message")];case 3:return y.sent(),[2]}}))}))}function be(e){return E(this,void 0,void 0,(function(){var t,n,s,c,l,u,h,f,m,v,g,E,b,T,S;return y(this,(function(y){switch(y.label){case 0:if(!r.XZ.call(this))return t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)];if(d.kg.debug("Call setMessagePinStatus",e),s=(n=e||{}).conversationId,c=void 0===s?"":s,l=n.conversationType,u=n.messageId,h=n.isPinned,"string"!=typeof c||""===c)throw Error("Invalid parameter conversationId");if("string"!=typeof u||""===u)throw Error("Invalid parameter messageId");if("boolean"!=typeof h)throw Error("Invalid parameter isPinned");return f=this.context,m=f.orgName,v=f.appName,g=f.accessToken,E=f.userId,b=f.jid,T={to:c,type:_[l],pin_msg_id:u},S={url:"".concat(this.apiUrl,"/").concat(m,"/").concat(v,"/sdk/user/").concat(E,"/user_channel/pin?resource=").concat(b.clientResource),dataType:"json",data:JSON.stringify(T),type:h?"Post":"Delete",headers:{Authorization:"Bearer "+g}},[4,a.hj.call(this,S,p.fI.REST_PIN_MESSAGE)];case 1:return y.sent(),[2]}}))}))}function Te(e){return E(this,void 0,void 0,(function(){var t,n,r,o;return y(this,(function(i){return d.kg.debug("Call pinMessage",e),n=(t=e||{}).conversationType,r=t.conversationId,o=t.messageId,[2,be.call(this,{conversationId:r,conversationType:n,messageId:o,isPinned:!0})]}))}))}function Se(e){return E(this,void 0,void 0,(function(){var t,n,r,o;return y(this,(function(i){return d.kg.debug("Call unpinMessage",e),n=(t=e||{}).conversationType,r=t.conversationId,o=t.messageId,[2,be.call(this,{conversationId:r,conversationType:n,messageId:o,isPinned:!1})]}))}))}function Oe(e){var t=this;if(!r.XZ.call(this)){var n=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(n)}d.kg.debug("Call getServerPinnedMessages",e);var s=e.conversationId,c=e.conversationType,l=e.pageSize,u=e.cursor;if("string"!=typeof s||""===s)throw Error("Invalid parameter conversationId");if(l&&"number"!=typeof l)throw Error("Invalid parameter pageSize: ".concat(l));if(u&&"string"!=typeof u)throw Error("Invalid parameter cursor: ".concat(u));var f=this.context,m=f.orgName,v=f.appName,g=f.accessToken,E={url:"".concat(this.apiUrl,"/").concat(m,"/").concat(v,"/sdk/user/").concat(this.user,"/user_channel/pin"),type:"GET",dataType:"json",data:{to:s,type:_[c],limit:l||10,cursor:u||""},headers:{Authorization:"Bearer "+g,"Content-Type":"application/json"}};return a.hj.call(this,E,p.fI.GET_SESSION_LIST).then((function(e){return{type:0,data:{list:e.data.msg_infos.map((function(e){e.message.payload=JSON.parse(e.message.payload);var n=e.message,r=e.pin_opt_at,o=e.pin_operator;return{message:h.w.call(t,n,{formatChatType:!0}),pinTime:r,operatorId:o}})),cursor:e.data.cursor||""}}}))}function Re(){var e=this;d.kg.debug("Call unbindPushToken");var t={deviceId:this.clientResource,deviceToken:"",notifierName:this.pushCertificateName};return v.r.call(this,t).then((function(t){return e.isRegisterPush=!1,t}))}},3770:function(e,t,n){"use strict";n.r(t),n.d(t,{getPresenceStatus:function(){return m},getSubscribedPresenceList:function(){return h},getSubscribedPresencelist:function(){return f},publishPresence:function(){return u},subscribePresence:function(){return d},unsubscribePresence:function(){return p}}),n(1539),n(8674),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948),n(2222),n(9753);var r=n(4024),o=n(3246),i=n(7252),a=n(5531),s=n(7360),c=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},l=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function u(e){return c(this,void 0,void 0,(function(){var t,n,c,u,d,p,h,f,m;return l(this,(function(l){switch(l.label){case 0:if("string"!=typeof e.description)throw Error('Invalid parameter: "description"');return o.XZ.call(this)?(n=this.context,c=n.accessToken,u=n.orgName,d=n.appName,p=n.userId,h=this.context.jid.clientResource,f={ext:e.description},m={url:"".concat(this.apiUrl,"/").concat(u,"/").concat(d,"/users/").concat(p,"/presence/").concat(h,"/1"),type:"POST",dataType:"json",data:JSON.stringify(f),headers:{Authorization:"Bearer "+c,"Content-Type":"application/json"},success:e.success,error:e.error},s.kg.debug("Call publishPresence:",e),[4,r.hj.call(this,m)]):(t=i.Z.create({type:a.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)]);case 1:return l.sent(),[2]}}))}))}function d(e){if(!Array.isArray(e.usernames))throw Error('Invalid parameter: "usernames"');if(!e.usernames.length)throw Error('"usernames" can not be empty');if("number"!=typeof e.expiry)throw Error('Invalid parameter: "expiry"');if(!o.XZ.call(this)){var t=i.Z.create({type:a.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,c=n.orgName,l=n.appName,u=n.userId,d=n.accessToken,p={usernames:e.usernames},h={url:"".concat(this.apiUrl,"/").concat(c,"/").concat(l,"/users/").concat(u,"/presence/").concat(e.expiry),type:"POST",dataType:"json",data:JSON.stringify(p),headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call subscribePresence:",e),r.hj.call(this,h).then((function(e){return e.data={result:null==e?void 0:e.result},e}))}function p(e){return c(this,void 0,void 0,(function(){var t,n,c,u,d,p,h;return l(this,(function(l){switch(l.label){case 0:if(!Array.isArray(e.usernames))throw Error('Invalid parameter: "usernames"');if(!e.usernames.length)throw Error('"usernames" can not be empty');return o.XZ.call(this)?(n=this.context,c=n.orgName,u=n.appName,d=n.userId,p=n.accessToken,h={url:"".concat(this.apiUrl,"/").concat(c,"/").concat(u,"/users/").concat(d,"/presence"),type:"DELETE",dataType:"json",data:JSON.stringify(e.usernames),headers:{Authorization:"Bearer "+p,"Content-Type":"application/json"},success:e.success,error:e.error},s.kg.debug("Call unsubscribePresence:",e),[4,r.hj.call(this,h)]):(t=i.Z.create({type:a.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)]);case 1:return l.sent(),[2]}}))}))}function h(e){if("number"!=typeof e.pageNum||"number"!=typeof e.pageSize)throw Error('Invalid parameter: "pageNum or pageSize"');if(e.pageNum<0||e.pageSize<0)throw Error('"pageNum" should >= 0 and "pageSize" should >= 0');if(!o.XZ.call(this)){var t=i.Z.create({type:a.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,c=n.orgName,l=n.appName,u=n.userId,d=n.accessToken,p={url:"".concat(this.apiUrl,"/").concat(c,"/").concat(l,"/users/").concat(u,"/presence/sublist?pageNum=").concat(e.pageNum,"&pageSize=").concat(e.pageSize),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getSubscribedPresenceList:",e),r.hj.call(this,p).then((function(e){return e.data={result:null==e?void 0:e.result},e}))}var f=h;function m(e){if(!Array.isArray(e.usernames))throw Error('Invalid parameter: "usernames"');if(!e.usernames.length)throw Error('"usernames" can not be empty');if(!o.XZ.call(this)){var t=i.Z.create({type:a.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n={usernames:e.usernames},c=this.context,l=c.orgName,u=c.appName,d=c.userId,p=c.accessToken,h={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/users/").concat(d,"/presence"),type:"POST",dataType:"json",data:JSON.stringify(n),headers:{Authorization:"Bearer "+p,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getPresenceStatus:",e),r.hj.call(this,h).then((function(e){return e.data={result:null==e?void 0:e.result},e}))}},6801:function(e,t,n){"use strict";n.d(t,{r:function(){return l}}),n(1539),n(8674),n(2222),n(4812);var r=n(3246),o=n(5531),i=n(7252),a=n(4024),s=n(7360),c=n(1595);function l(e){if("string"!=typeof e.deviceId||""===e.deviceId)throw Error('Invalid parameter: "deviceId"');if(!r.XZ.call(this)){var t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,l=n.orgName,u=n.appName,d=n.accessToken,p={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/users/").concat(this.user),type:"PUT",data:JSON.stringify({device_id:e.deviceId,device_token:e.deviceToken,notifier_name:e.notifierName}),dataType:"json",headers:{Authorization:"Bearer "+d,"Content-Type":"application/json"},success:e.success,error:e.error};s.kg.debug("Call uploadPushTokenToServer",e);var h=a.hj.bind(this,p,c.fI.UPLOAD_PUSH_TOKEN);return a.P6.retryPromise(h).then((function(e){var t=e.entities[0]||{};return{type:e.type,data:t}}))}},1735:function(e,t,n){"use strict";n.r(t),n.d(t,{clearRemindTypeForConversation:function(){return d},getPushPerformLanguage:function(){return m},getSilentModeForAll:function(){return l},getSilentModeForConversation:function(){return p},getSilentModeForConversations:function(){return h},getSilentModeRemindTypeConversations:function(){return v},setPushPerformLanguage:function(){return f},setSilentModeForAll:function(){return c},setSilentModeForConversation:function(){return u}}),n(7941),n(1539),n(8674),n(2222),n(9753),n(9554),n(4747),n(9600),n(1249);var r=n(4024),o=n(3246),i=n(7252),a=n(5531),s=n(7360);function c(e){if(!(e.options instanceof Object))throw Error('Invalid parameter: "options"');var t=e.options.paramType;if("number"!=typeof t||t<0||t>2)throw Error('Invalid parameter: "options of paramType"');if(0===t){if("string"!=typeof e.options.remindType)throw Error('Invalid parameter: "options of remindType"')}else if(1===t){if("number"!=typeof e.options.duration)throw Error('Invalid parameter: "options of duration"')}else if(2===t){var n=e.options,c=n.startTime,l=n.endTime;if(!(c instanceof Object&&Object.keys(c).length))throw Error('Invalid parameter: "options of startTime"');if(!c.hours||"number"!=typeof c.hours||!c.minutes||"number"!=typeof c.minutes)throw Error('Invalid parameter: "options of startTime of hours or minutes"');if(!(l instanceof Object&&Object.keys(l).length))throw Error('Invalid parameter: "options of endTime"');if(!l.hours||"number"!=typeof l.hours||!l.minutes||"number"!=typeof l.minutes)throw Error('Invalid parameter: "options of endTime of hours or minutes"')}if(!o.XZ.call(this)){var u=i.Z.create({type:a.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(u)}var d=this.context,p=d.accessToken,h=d.orgName,f=d.appName,m=d.userId,v=d.jid,g={};switch(t){case 0:g={type:e.options.remindType};break;case 1:g={ignoreDuration:e.options.duration};break;case 2:var E=e.options;c=E.startTime,l=E.endTime,g={ignoreInterval:"".concat(c.hours,":").concat(c.minutes,"-").concat(l.hours,":").concat(l.minutes)}}var y={url:"".concat(this.apiUrl,"/").concat(h,"/").concat(f,"/users/").concat(m,"/notification/user/").concat(m,"?resource=").concat(v.clientResource),type:"PUT",dataType:"json",data:JSON.stringify(g),headers:{Authorization:"Bearer "+p,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call setSilentModeForAll:",e),r.hj.call(this,y)}function l(e){if(!o.XZ.call(this)){var t=i.Z.create({type:a.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,c=n.accessToken,l=n.orgName,u=n.appName,d=n.userId,p={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/users/").concat(d,"/notification/user/").concat(d),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+c,"Content-Type":"application/json"},success:null==e?void 0:e.success,error:null==e?void 0:e.error};return s.kg.debug("Call getSilentModeForAll:",e),r.hj.call(this,p)}function u(e){if("string"!=typeof e.conversationId||!e.conversationId)throw Error('Invalid parameter: "conversationId"');if("string"!=typeof e.type||!e.type)throw Error('Invalid parameter: "type"');if(!(e.options instanceof Object))throw Error('Invalid parameter: "options"');var t=e.options.paramType;if("number"!=typeof t||t<0||t>2)throw Error('Invalid parameter: "options of paramType"');if(0===t){if("string"!=typeof e.options.remindType)throw Error('Invalid parameter: "options of remindType"')}else if(1===t){if("number"!=typeof e.options.duration)throw Error('Invalid parameter: "options of duration"')}else if(2===t){var n=e.options,c=n.startTime,l=n.endTime;if(!(c instanceof Object&&Object.keys(c).length))throw Error('Invalid parameter: "options of startTime"');if(!c.hours||"number"!=typeof c.hours||!c.minutes||"number"!=typeof c.minutes)throw Error('Invalid parameter: "options of startTime of hours or minutes"');if(!(l instanceof Object&&Object.keys(l).length))throw Error('Invalid parameter: "options of endTime"');if(!l.hours||"number"!=typeof l.hours||!l.minutes||"number"!=typeof l.minutes)throw Error('Invalid parameter: "options of endTime of hours or minutes"')}if(!o.XZ.call(this)){var u=i.Z.create({type:a.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(u)}var d=this.context,p=d.accessToken,h=d.orgName,f=d.appName,m=d.userId,v=d.jid,g="chatgroup",E={};switch(t){case 0:E={type:e.options.remindType};break;case 1:E={ignoreDuration:e.options.duration};break;case 2:var y=e.options;c=y.startTime,l=y.endTime,E={ignoreInterval:"".concat(c.hours,":").concat(c.minutes,"-").concat(l.hours,":").concat(l.minutes)}}"singleChat"===e.type&&(g="user");var _={url:"".concat(this.apiUrl,"/").concat(h,"/").concat(f,"/users/").concat(m,"/notification/").concat(g,"/").concat(e.conversationId,"?resource=").concat(v.clientResource),type:"PUT",dataType:"json",data:JSON.stringify(E),headers:{Authorization:"Bearer "+p,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call setSilentModeForConversation:",e),r.hj.call(this,_)}function d(e){if("string"!=typeof e.conversationId||!e.conversationId)throw Error('Invalid parameter: "conversationId"');if("string"!=typeof e.type||!e.type)throw Error('Invalid parameter: "type"');if(!o.XZ.call(this)){var t=i.Z.create({type:a.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,c=n.accessToken,l=n.orgName,u=n.appName,d=n.userId,p=n.jid,h="chatgroup";"singleChat"===e.type&&(h="user");var f={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/users/").concat(d,"/notification/").concat(h,"/").concat(e.conversationId,"?resource=").concat(p.clientResource),type:"PUT",dataType:"json",data:JSON.stringify({type:"DEFAULT"}),headers:{Authorization:"Bearer "+c,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call clearRemindTypeForConversation:",e),r.hj.call(this,f)}function p(e){if("string"!=typeof e.conversationId||!e.conversationId)throw Error('Invalid parameter: "conversationId"');if("string"!=typeof e.type||!e.type)throw Error('Invalid parameter: "type"');if(!o.XZ.call(this)){var t=i.Z.create({type:a.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,c=n.accessToken,l=n.orgName,u=n.appName,d=n.userId,p="chatgroup";"singleChat"===e.type&&(p="user");var h={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/users/").concat(d,"/notification/").concat(p,"/").concat(e.conversationId),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+c,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getSilentModeForConversation:",e),r.hj.call(this,h)}function h(e){if(!Array.isArray(e.conversationList))throw Error('Invalid parameter: "conversationList"');if(!o.XZ.call(this)){var t=i.Z.create({type:a.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,c=n.accessToken,l=n.orgName,u=n.appName,d=n.userId,p=[],h=[];e.conversationList.forEach((function(e){"singleChat"===e.type?p.push(e.id):h.push(e.id)}));var f=p.length?p.join(","):"",m=h.length?h.join(","):"",v={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/users/").concat(d,"/notification?user=").concat(f,"&group=").concat(m),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+c,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call getSilentModeForConversations:",e),r.hj.call(this,v)}function f(e){if("string"!=typeof e.language||!e.language)throw Error('Invalid parameter: "language"');if(!o.XZ.call(this)){var t=i.Z.create({type:a.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n={translationLanguage:e.language},c=this.context,l=c.accessToken,u=c.orgName,d=c.appName,p=c.userId,h={url:"".concat(this.apiUrl,"/").concat(u,"/").concat(d,"/users/").concat(p,"/notification/language"),type:"PUT",dataType:"json",data:JSON.stringify(n),headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"},success:e.success,error:e.error};return s.kg.debug("Call setPushPerformLanguage:",e),r.hj.call(this,h)}function m(e){if(!o.XZ.call(this)){var t=i.Z.create({type:a.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,c=n.accessToken,l=n.orgName,u=n.appName,d=n.userId,p={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/users/").concat(d,"/notification/language"),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+c,"Content-Type":"application/json"},success:null==e?void 0:e.success,error:null==e?void 0:e.error};return s.kg.debug("Call getPushPerformLanguage:",e),r.hj.call(this,p)}function v(e){if(!o.XZ.call(this)){var t=i.Z.create({type:a.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}if("number"!=typeof e.pageSize)throw Error('Invalid parameter: "pageSize"');var n=this.context,c=n.accessToken,l=n.orgName,u=n.appName,d=n.userId,p={limit:e.pageSize||10,cursor:e.cursor};e.cursor||delete p.cursor;var h={url:"".concat(this.apiUrl,"/").concat(l,"/").concat(u,"/users/").concat(d,"/notification/mute/type"),type:"GET",dataType:"json",data:p,headers:{Authorization:"Bearer "+c,"Content-Type":"application/json"}};return s.kg.debug("Call getSilentModeRemindTypeConversations:",e),r.hj.call(this,h).then((function(e){return e.data?{data:{conversations:e.data.map((function(e){return"user"in e?{conversationId:e.user,type:"singleChat",remindType:e.value}:{conversationId:e.group,type:"groupChat",remindType:e.value}})),cursor:e.cursor},type:e.type}:e}))}},7384:function(e,t,n){"use strict";n.r(t),n.d(t,{changeChatThreadName:function(){return f},createChatThread:function(){return u},destroyChatThread:function(){return h},getChatThreadDetail:function(){return b},getChatThreadLastMessage:function(){return y},getChatThreadMembers:function(){return m},getChatThreads:function(){return E},getJoinedChatThreads:function(){return g},joinChatThread:function(){return d},leaveChatThread:function(){return p},removeChatThreadMember:function(){return v}}),n(1539),n(8674),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948),n(8309),n(2222),n(9554),n(4747),n(9753);var r=n(5531),o=n(7252),i=n(4024),a=n(3246),s=n(4363),c=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},l=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function u(e){if("string"!=typeof e.name||""===e.name)throw Error("Invalid parameter name: ".concat(e.name));if("string"!=typeof e.messageId||""===e.messageId)throw Error("Invalid parameter messageId: ".concat(e.messageId));if("string"!=typeof e.parentId||""===e.parentId)throw Error("Invalid parameter parentId: ".concat(e.parentId));if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u=n.jid,d={name:e.name,msg_id:e.messageId,group_id:e.parentId,owner:this.user},p={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/thread?resource=").concat(u.clientResource),type:"POST",dataType:"json",data:JSON.stringify(d),headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}};return i.hj.call(this,p).then((function(e){var t=e.data.thread_id;return e.data={chatThreadId:t},e}))}function d(e){if("string"!=typeof e.chatThreadId||""===e.chatThreadId)throw Error("Invalid parameter chatThreadId: ".concat(e.chatThreadId));if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u=n.jid,d={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/thread/").concat(e.chatThreadId,"/user/").concat(this.user,"/join?resource=").concat(u.clientResource),type:"POST",dataType:"json",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}};return i.hj.call(this,d).then((function(e){var t=e.data.detail;return t.messageId=t.msgId,t.parentId=t.groupId,delete t.msgId,delete t.groupId,e}))}function p(e){return c(this,void 0,void 0,(function(){var t,n,s,c,u,d,p;return l(this,(function(l){switch(l.label){case 0:if("string"!=typeof e.chatThreadId||""===e.chatThreadId)throw Error("Invalid parameter chatThreadId: ".concat(e.chatThreadId));return a.XZ.call(this)?(n=this.context,s=n.orgName,c=n.appName,u=n.accessToken,d=n.jid,p={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/thread/").concat(e.chatThreadId,"/user/").concat(this.user,"/quit?resource=").concat(d.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+u,"Content-Type":"application/json"}},[4,i.hj.call(this,p)]):(t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)]);case 1:return l.sent(),[2]}}))}))}function h(e){return c(this,void 0,void 0,(function(){var t,n,s,c,u,d,p;return l(this,(function(l){switch(l.label){case 0:if("string"!=typeof e.chatThreadId||""===e.chatThreadId)throw Error("Invalid parameter chatThreadId: ".concat(e.chatThreadId));return a.XZ.call(this)?(n=this.context,s=n.orgName,c=n.appName,u=n.accessToken,d=n.jid,p={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/thread/").concat(e.chatThreadId,"?resource=").concat(d.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+u,"Content-Type":"application/json"}},[4,i.hj.call(this,p)]):(t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"}),[2,Promise.reject(t)]);case 1:return l.sent(),[2]}}))}))}function f(e){if("string"!=typeof e.chatThreadId||""===e.chatThreadId)throw Error("Invalid parameter chatThreadId: ".concat(e.chatThreadId));if("string"!=typeof e.name||""===e.name)throw Error("Invalid parameter name: ".concat(e.name));if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u=n.jid,d={name:e.name},p={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/thread/").concat(e.chatThreadId,"?resource=").concat(u.clientResource),type:"PUT",dataType:"json",data:JSON.stringify(d),headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}};return i.hj.call(this,p)}function m(e){if("string"!=typeof e.chatThreadId||""===e.chatThreadId)throw Error("Invalid parameter chatThreadId: ".concat(e.chatThreadId));if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u={limit:e.pageSize||20,cursor:e.cursor||""},d={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/thread/").concat(e.chatThreadId,"/users"),type:"GET",dataType:"json",data:u,headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}};return i.hj.call(this,d)}function v(e){if("string"!=typeof e.chatThreadId||""===e.chatThreadId)throw Error("Invalid parameter chatThreadId: ".concat(e.chatThreadId));if("string"!=typeof e.username||""===e.username)throw Error("Invalid parameter username: ".concat(e.username));if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u=n.jid,d={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/thread/").concat(e.chatThreadId,"/users/").concat(e.username,"?resource=").concat(u.clientResource),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}};return i.hj.call(this,d)}function g(e){if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u={limit:e.pageSize||20,cursor:e.cursor||""},d={url:e.parentId?"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/threads/chatgroups/").concat(e.parentId,"/user/").concat(this.user):"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/threads/user/").concat(this.user),type:"GET",dataType:"json",data:u,headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}};return i.hj.call(this,d).then((function(e){var t=e.entities;return null==t||t.forEach((function(e){e.parentId=e.groupId,e.messageId=e.msgId,delete e.groupId,delete e.msgId})),e}))}function E(e){if("string"!=typeof e.parentId||""===e.parentId)throw Error("Invalid parameter parentId: ".concat(e.parentId));if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u={cursor:e.cursor||"",limit:e.pageSize||20},d={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/threads/chatgroups/").concat(e.parentId),type:"GET",dataType:"json",data:u,headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}};return i.hj.call(this,d).then((function(e){var t=e.entities;return null==t||t.forEach((function(e){e.parentId=e.groupId,e.messageId=e.msgId,delete e.groupId,delete e.msgId})),e}))}function y(e){var t=this;if(!Array.isArray(e.chatThreadIds))throw Error("Invalid parameter chatThreadIds: ".concat(e.chatThreadIds));if(!a.XZ.call(this)){var n=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(n)}var s=this.context,c=s.orgName,l=s.appName,u=s.accessToken,d={threadIds:e.chatThreadIds},p={url:"".concat(this.apiUrl,"/").concat(c,"/").concat(l,"/thread/message"),type:"POST",dataType:"json",data:JSON.stringify(d),headers:{Authorization:"Bearer "+u,"Content-Type":"application/json"}};return i.hj.call(this,p).then((function(e){return _.call(t,e)}))}function _(e){var t=this,n=e.entities;return null==n||n.forEach((function(e){e.chatThreadId=e.thread_id,e.last_message&&"{}"!==JSON.stringify(e.last_message)?e.lastMessage=s.w.call(t,e.last_message):e.lastMessage=e.last_message,delete e.thread_id,delete e.last_message})),e}function b(e){if("string"!=typeof e.chatThreadId||""===e.chatThreadId)throw Error("Invalid parameter chatThreadId: ".concat(e.chatThreadId));if(!a.XZ.call(this)){var t=o.Z.create({type:r.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,s=n.orgName,c=n.appName,l=n.accessToken,u={url:"".concat(this.apiUrl,"/").concat(s,"/").concat(c,"/thread/").concat(e.chatThreadId),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}};return i.hj.call(this,u).then((function(e){return e.data.affiliationsCount=e.data.affiliations_count,e.data.messageId=e.data.msgId,e.data.parentId=e.data.groupId,delete e.data.affiliations_count,delete e.data.msgId,delete e.data.groupId,e}))}},70:function(e,t,n){"use strict";n.r(t),n.d(t,{getSupportedLanguages:function(){return c},translateMessage:function(){return l}}),n(1539),n(8674),n(2222),n(9753);var r=n(3246),o=n(5531),i=n(7252),a=n(7360),s=n(4024);function c(){if(!r.XZ.call(this)){var e=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(e)}var t=this.context,n=t.orgName,c=t.appName,l=t.accessToken,u={url:"".concat(this.apiUrl,"/").concat(n,"/").concat(c,"/users/").concat(this.user,"/translate/support/language"),dataType:"json",type:"GET",headers:{Authorization:"Bearer "+l}};return a.kg.debug("Call getSupportedLanguages"),s.hj.call(this,u)}function l(e){if("string"!=typeof e.text||""===e.text)throw Error('Invalid parameter: "text"');if(!Array.isArray(e.languages))throw Error('Invalid parameter: "language"');if(!r.XZ.call(this)){var t=i.Z.create({type:o.E.REST_PARAMS_STATUS,message:"appkey or token error"});return Promise.reject(t)}var n=this.context,c=n.orgName,l=n.appName,u=n.accessToken,d="".concat(this.apiUrl,"/").concat(c,"/").concat(l,"/users/").concat(this.user,"/translate"),p={text:e.text,to:e.languages},h={url:d,dataType:"json",type:"POST",data:JSON.stringify(p),headers:{Authorization:"Bearer "+u}};return a.kg.debug("Call translateMessage"),s.hj.call(this,h)}},3246:function(e,t,n){"use strict";n.d(t,{H7:function(){return u},XZ:function(){return c},_W:function(){return l}}),n(7941),n(9554),n(1539),n(4747),n(6699),n(2023);var r=n(5531),o=n(7252),i=n(7360);function a(){var e=this.context.appName,t=this.context.orgName;return!(!e||!t)||(this.onError&&this.onError({type:r.E.WEBIM_CONNCTION_AUTH_ERROR,message:"appName or orgName is illegal"}),!1)}function s(){var e,t=this.context.accessToken;if(!t){var n=o.Z.create({type:r.E.WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR,message:"token not assign error"});return i.kg.debug("token not assign error",t),this.onError&&this.onError(n),null===(e=this.eventHandler)||void 0===e||e.dispatch("onError",n),!1}return!0}function c(){return s.call(this)&&a.call(this)}function l(e){var t=e.data,n=e.type;return{data:{status:Object.keys(t.errorKeys).length>0?"fail":"success",errorKeys:t.errorKeys,successKeys:t.successKeys},type:n}}function u(e){var t=e.data,n=void 0;return Object.keys(t.errorKeys).length>0&&Object.keys(t.errorKeys).forEach((function(e){var i=t.errorKeys[e];n=i.includes("is not part of you")?o.Z.create({type:r.E.NO_PERMISSION,message:i}):i.includes("size of metadata for this single chatroom exceeds the user defined limit")||i.includes("total size of chatroom metadata for this app exceeds the user defined limit")||i.includes("is exceeding maximum limit")?o.Z.create({type:r.E.MAX_LIMIT,message:i}):i.includes("is not Legal")?o.Z.create({type:r.E.REQUEST_PARAMETER_ERROR,message:i}):i.includes("Failed to update userMetadata. Concurrent updates not allowed")?o.Z.create({type:r.E.OPERATION_NOT_ALLOWED,message:i}):o.Z.create({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,message:i})})),n}},2071:function(e,t,n){"use strict";n.d(t,{$x:function(){return s},F3:function(){return c},TJ:function(){return o},Tp:function(){return d},Wc:function(){return r},el:function(){return i},iB:function(){return l},iO:function(){return a},yK:function(){return u}}),n(6992),n(1532),n(1539),n(8783),n(3948);var r=7,o=new Map,i="im",a=new Map,s="32f24ab2ddb74f508aa9286c356cec84",c=1e3,l={INIT:9674,API:9675},u="direct",d=-1},1595:function(e,t,n){"use strict";var r,o,i,a,s,c;n.d(t,{C8:function(){return r},aC:function(){return c},c:function(){return i},dd:function(){return s},fI:function(){return o},td:function(){return a}}),function(e){e[e.UNKNOWOPERATION=-1]="UNKNOWOPERATION",e[e.REST_GET_SESSION_LIST=1]="REST_GET_SESSION_LIST",e[e.REST_DEL_SESSION=2]="REST_DEL_SESSION",e[e.REST_GET_HISTORY_MESSAGE=3]="REST_GET_HISTORY_MESSAGE",e[e.REST_PIN_CONVERSATION=4]="REST_PIN_CONVERSATION",e[e.REST_MARK_CONVERSATION=5]="REST_MARK_CONVERSATION",e[e.REST_UPLOAD_FILE_IN_PARTS=6]="REST_UPLOAD_FILE_IN_PARTS",e[e.REST_DELETE_MESSAGES_CONVERSATIONS=7]="REST_DELETE_MESSAGES_CONVERSATIONS",e[e.REST_PIN_MESSAGE=8]="REST_PIN_MESSAGE",e[e.REST_FETCH_PINMESSAGES=9]="REST_FETCH_PINMESSAGES",e[e.REST_OPERATE=100]="REST_OPERATE",e[e.MSYNC_SENDMESSAGE=101]="MSYNC_SENDMESSAGE",e[e.MSYNC_RECALLMESSAGE=102]="MSYNC_RECALLMESSAGE",e[e.MSYNC_MODIFYMESSAGE=103]="MSYNC_MODIFYMESSAGE",e[e.MSYNC_OPERATE=200]="MSYNC_OPERATE",e[e.ROSTER_ADD=201]="ROSTER_ADD",e[e.ROSTER_REMOVE=202]="ROSTER_REMOVE",e[e.ROSTER_ACCEPT=203]="ROSTER_ACCEPT",e[e.ROSTER_DECLINE=204]="ROSTER_DECLINE",e[e.ROSTER_BAN=205]="ROSTER_BAN",e[e.ROSTER_ALLOW=206]="ROSTER_ALLOW",e[e.ROSTER_BLACKLIST=207]="ROSTER_BLACKLIST",e[e.ROSTER_CONTACTS=208]="ROSTER_CONTACTS",e[e.ROSTER_GET_ALL_CONTACTS_REMARKS=209]="ROSTER_GET_ALL_CONTACTS_REMARKS",e[e.ROSTER_GET_ALL_CONTACTS_REMARKS_FROM_SERVER_BY_PAGE=210]="ROSTER_GET_ALL_CONTACTS_REMARKS_FROM_SERVER_BY_PAGE",e[e.ROSTER_SET_CONTACT_REMARK=211]="ROSTER_SET_CONTACT_REMARK",e[e.ROSTER_OPERATE=300]="ROSTER_OPERATE",e[e.USER_LOGIN=301]="USER_LOGIN",e[e.USER_CREATE=302]="USER_CREATE",e[e.USER_UPDATE_USERINFO=303]="USER_UPDATE_USERINFO",e[e.USER_FETCH_USERINFO=304]="USER_FETCH_USERINFO",e[e.USER_UPDATE_NICK=305]="USER_UPDATE_NICK",e[e.USER_UPLOAD_PUSH_TOKEN=306]="USER_UPLOAD_PUSH_TOKEN",e[e.USER_LOGGEDIN_OTHER_PLATFORM=307]="USER_LOGGEDIN_OTHER_PLATFORM",e[e.USER_OPERATE=400]="USER_OPERATE",e[e.GROUP_CREATEGROUP=401]="GROUP_CREATEGROUP",e[e.GROUP_BLOCK_MESSAGE=402]="GROUP_BLOCK_MESSAGE",e[e.GROUP_FETCH_PUBLICGROUPS_WITHCURSOR=403]="GROUP_FETCH_PUBLICGROUPS_WITHCURSOR",e[e.GROUP_FETCH_USERS_GROUP=404]="GROUP_FETCH_USERS_GROUP",e[e.GROUP_CHANGE_OWNER=405]="GROUP_CHANGE_OWNER",e[e.GROUP_FETCH_SPECIFICATION=406]="GROUP_FETCH_SPECIFICATION",e[e.GROUP_CHANGE_GROUPATTRIBUTE=407]="GROUP_CHANGE_GROUPATTRIBUTE",e[e.GROUP_FETCH_MEMEBERS=408]="GROUP_FETCH_MEMEBERS",e[e.GROUP_GET_ADMIN=409]="GROUP_GET_ADMIN",e[e.GROUP_SET_ADMIN=410]="GROUP_SET_ADMIN",e[e.GROUP_REMOVE_ADMIN=411]="GROUP_REMOVE_ADMIN",e[e.GROUP_DESTOTYGROUP=412]="GROUP_DESTOTYGROUP",e[e.GROUP_LEAVEGROUP=413]="GROUP_LEAVEGROUP",e[e.GROUP_INVITE_TO_GROUP=414]="GROUP_INVITE_TO_GROUP",e[e.GROUP_JOIN_PUBLICGROUP=415]="GROUP_JOIN_PUBLICGROUP",e[e.GROUP_ACCEPT_JOINPUBLICGROUPAPPL=416]="GROUP_ACCEPT_JOINPUBLICGROUPAPPL",e[e.GROUP_DECLINE_JOINPUBLICGROUPAPPL=417]="GROUP_DECLINE_JOINPUBLICGROUPAPPL",e[e.GROUP_ACCEPT_INVITATION=418]="GROUP_ACCEPT_INVITATION",e[e.GROUP_DECLINE_INVITATION=419]="GROUP_DECLINE_INVITATION",e[e.GROUP_REMOVE_MEMBER=420]="GROUP_REMOVE_MEMBER",e[e.GROUP_REMOVE_MEMBERS=421]="GROUP_REMOVE_MEMBERS",e[e.GROUP_MUTE_MEMBERS=422]="GROUP_MUTE_MEMBERS",e[e.GROUP_UNMUTE_MEMBERS=423]="GROUP_UNMUTE_MEMBERS",e[e.GROUP_FETCH_MUTES=424]="GROUP_FETCH_MUTES",e[e.GROUP_BLOCK_MEMBER=425]="GROUP_BLOCK_MEMBER",e[e.GROUP_BLOCK_MEMBERS=426]="GROUP_BLOCK_MEMBERS",e[e.GROUP_UNBLOCK_MEMBER=427]="GROUP_UNBLOCK_MEMBER",e[e.GROUP_UNBLOCK_MEMBERS=428]="GROUP_UNBLOCK_MEMBERS",e[e.GROUP_GET_BLOCK_LIST=429]="GROUP_GET_BLOCK_LIST",e[e.GROUP_MUTE_ALLMEMBERS=430]="GROUP_MUTE_ALLMEMBERS",e[e.GROUP_UNMUTE_ALLMEMBERS=431]="GROUP_UNMUTE_ALLMEMBERS",e[e.GROUP_ADD_WHITELIST=432]="GROUP_ADD_WHITELIST",e[e.GROUP_REMOVE_WHITELIST=433]="GROUP_REMOVE_WHITELIST",e[e.GROUP_FETCH_WHITELIST=434]="GROUP_FETCH_WHITELIST",e[e.GROUP_IS_IN_WHITELIST=435]="GROUP_IS_IN_WHITELIST",e[e.GROUP_GET_READ_USERS=436]="GROUP_GET_READ_USERS",e[e.GROUP_FETCH_ANNOUNCEMENT=437]="GROUP_FETCH_ANNOUNCEMENT",e[e.GROUP_UPDATE_ANNOUNCEMENT=438]="GROUP_UPDATE_ANNOUNCEMENT",e[e.GROUP_UPLOAD_SHAREDFILE=439]="GROUP_UPLOAD_SHAREDFILE",e[e.GROUP_DELETE_SHAREDFILE=440]="GROUP_DELETE_SHAREDFILE",e[e.GROUP_FETCH_SHAREDFILE=441]="GROUP_FETCH_SHAREDFILE",e[e.GROUP_DOWNLOAD_SHAREDFILE=442]="GROUP_DOWNLOAD_SHAREDFILE",e[e.GROUP_MEMBER_SET_META_DATA=443]="GROUP_MEMBER_SET_META_DATA",e[e.GROUP_MEMBER_FETCH_META_DATA=444]="GROUP_MEMBER_FETCH_META_DATA",e[e.GROUP_OPERATE=500]="GROUP_OPERATE",e[e.CHATROOM_FETCH_CHATROOMSWITHPAGE=501]="CHATROOM_FETCH_CHATROOMSWITHPAGE",e[e.CHATROOM_CREATECHATROOM=502]="CHATROOM_CREATECHATROOM",e[e.CHATROOM_DESTORYCHATROOM=503]="CHATROOM_DESTORYCHATROOM",e[e.CHATROOM_FETCH_SPECIFICATION=504]="CHATROOM_FETCH_SPECIFICATION",e[e.CHATROOM_CHANGE_ATTRIBUTE=505]="CHATROOM_CHANGE_ATTRIBUTE",e[e.CHATROOM_REMOVE_MEMBER=506]="CHATROOM_REMOVE_MEMBER",e[e.CHATROOM_REMOVE_MEMBERS=507]="CHATROOM_REMOVE_MEMBERS",e[e.CHATROOM_ADD_MEMBERS=508]="CHATROOM_ADD_MEMBERS",e[e.CHATROOM_JOINCAHTROOM=509]="CHATROOM_JOINCAHTROOM",e[e.CHATROOM_LEAVECAHTROOM=510]="CHATROOM_LEAVECAHTROOM",e[e.CHATROOM_FETCH_MEMBERS=511]="CHATROOM_FETCH_MEMBERS",e[e.CHATROOM_GET_ADMIN=512]="CHATROOM_GET_ADMIN",e[e.CHATROOM_SET_ADMIN=513]="CHATROOM_SET_ADMIN",e[e.CHATROOM_REMOVE_ADMIN=514]="CHATROOM_REMOVE_ADMIN",e[e.CHATROOM_MUTE_USER=515]="CHATROOM_MUTE_USER",e[e.CHATROOM_UNMUTE_USER=516]="CHATROOM_UNMUTE_USER",e[e.CHATROOM_FETCH_MUTES=517]="CHATROOM_FETCH_MUTES",e[e.CHATROOM_BLOCK_USER=518]="CHATROOM_BLOCK_USER",e[e.CHATROOM_BLOCK_USERS=519]="CHATROOM_BLOCK_USERS",e[e.CHATROOM_UNBLOCK_USER=520]="CHATROOM_UNBLOCK_USER",e[e.CHATROOM_UNBLOCK_USERS=521]="CHATROOM_UNBLOCK_USERS",e[e.CHATROOM_FETCH_BANS=522]="CHATROOM_FETCH_BANS",e[e.CHATROOM_MUTE_ALLMEMEBERS=523]="CHATROOM_MUTE_ALLMEMEBERS",e[e.CHATROOM_UNMUTE_ALLMEMEBERS=524]="CHATROOM_UNMUTE_ALLMEMEBERS",e[e.CHATROOM_ADD_WHITELIST=525]="CHATROOM_ADD_WHITELIST",e[e.CHATROOM_REMOVE_WHITELIST=526]="CHATROOM_REMOVE_WHITELIST",e[e.CHATROOM_FETCH_WHITELIST=527]="CHATROOM_FETCH_WHITELIST",e[e.CHATROOM_FETCH_MEMBERIN_WHITELIST=528]="CHATROOM_FETCH_MEMBERIN_WHITELIST",e[e.CHATROOM_FETCH_ANNOUNCEMENT=529]="CHATROOM_FETCH_ANNOUNCEMENT",e[e.CHATROOM_UPDATE_ANNOUNCEMENT=530]="CHATROOM_UPDATE_ANNOUNCEMENT",e[e.CHATROOM_REMOVE_SHARE_FILE=531]="CHATROOM_REMOVE_SHARE_FILE",e[e.CHATROOM_GET_SHARE_FILE_LIST=532]="CHATROOM_GET_SHARE_FILE_LIST",e[e.CHATROOM_UPLOAD_FILE=533]="CHATROOM_UPLOAD_FILE",e[e.CHATROOM_SET_META_DATA=534]="CHATROOM_SET_META_DATA",e[e.CHATROOM_DELETE_META_DATA=535]="CHATROOM_DELETE_META_DATA",e[e.CHATROOM_FETCH_META_DATA=536]="CHATROOM_FETCH_META_DATA",e[e.CHATROOM_FETCH_USER_JOINED_CHATROOM=537]="CHATROOM_FETCH_USER_JOINED_CHATROOM",e[e.CHATROOM_OPERATE=600]="CHATROOM_OPERATE"}(r||(r={})),function(e){e.SDK_INTERNAL="SDK_INTERNAL",e.LOGIN="USER_LOGIN",e.REGISTER="USER_CREATE",e.GET_CHATROOM_LIST="CHATROOM_FETCH_CHATROOMSWITHPAGE",e.CREATE_CHATROOM="CHATROOM_CREATECHATROOM",e.DESTROY_CHATROOM="CHATROOM_DESTORYCHATROOM",e.GET_CHATROOM_DETAIL="CHATROOM_FETCH_SPECIFICATION",e.MODIFY_CHATROOM="CHATROOM_CHANGE_ATTRIBUTE",e.REMOVE_CHATROOM_MEMBER="CHATROOM_REMOVE_MEMBER",e.MULTI_REMOVE_CHATROOM_MEMBER="CHATROOM_REMOVE_MEMBERS",e.ADD_USERS_TO_CHATROOM="CHATROOM_ADD_MEMBERS",e.JOIN_CHATROOM="CHATROOM_JOINCAHTROOM",e.QUIT_CHATROOM="CHATROOM_LEAVECAHTROOM",e.LIST_CHATROOM_MEMBERS="CHATROOM_FETCH_MEMBERS",e.GET_CHATROOM_ADMIN="CHATROOM_GET_ADMIN",e.SET_CHATROOM_ADMIN="CHATROOM_SET_ADMIN",e.REMOVE_CHATROOM_ADMIN="CHATROOM_REMOVE_ADMIN",e.MUTE_CHATROOM_MEMBER="CHATROOM_MUTE_USER",e.REMOVE_MUTE_CHATROOM_MEMBER="CHATROOM_UNMUTE_USER",e.GET_MUTE_CHATROOM_MEMBERS="CHATROOM_FETCH_MUTES",e.SET_CHATROOM_MEMBER_TO_BLACK="CHATROOM_BLOCK_USER",e.MULTI_SET_CHATROOM_MEMBER_TO_BLACK="CHATROOM_BLOCK_USERS",e.REMOVE_CHATROOM_MEMBER_BLACK="CHATROOM_UNBLOCK_USER",e.MULTI_REMOVE_CHATROOM_MEMBER_BLACK="CHATROOM_UNBLOCK_USERS",e.GET_CHATROOM_BLOCK_MEMBERS="CHATROOM_FETCH_BANS",e.DISABLED_CHATROOM_SEND_MSG="CHATROOM_MUTE_ALLMEMEBERS",e.ENABLE_CHATROOM_SEND_MSG="CHATROOM_UNMUTE_ALLMEMEBERS",e.ADD_CHATROOM_WHITE_USERS="CHATROOM_ADD_WHITELIST",e.REMOVE_CHATROOM_WHITE_USERS="CHATROOM_REMOVE_WHITELIST",e.GET_CHATROOM_WHITE_USERS="CHATROOM_FETCH_WHITELIST",e.CHECK_CHATROOM_WHITE_USER="CHATROOM_FETCH_MEMBERIN_WHITELIST",e.GET_CHATROOM_ANN="CHATROOM_FETCH_ANNOUNCEMENT",e.UPDATE_CHATROOM_ANN="CHATROOM_UPDATE_ANNOUNCEMENT",e.DELETE_CHATROOM_FILE="CHATROOM_REMOVE_SHARE_FILE",e.GET_CHATROOM_FILES="CHATROOM_GET_SHARE_FILE_LIST",e.UPLOAD_CHATROOM_FILE="CHATROOM_UPLOAD_FILE",e.SET_CHATROOM_ATTR="CHATROOM_SET_META_DATA",e.DELETE_CHATROOM_ATTR="CHATROOM_DELETE_META_DATA",e.GET_CHATROOM_ATTR="CHATROOM_FETCH_META_DATA",e.GET_USER_JOINED_CHATROOM="CHATROOM_FETCH_USER_JOINED_CHATROOM",e.CREATE_GROUP="GROUP_CREATEGROUP",e.BLOCK_GROUP="GROUP_BLOCK_MESSAGE",e.LIST_GROUP="GROUP_FETCH_PUBLICGROUPS_WITHCURSOR",e.GET_USER_GROUP="GROUP_FETCH_USERS_GROUP",e.CHANGE_OWNER="GROUP_CHANGE_OWNER",e.GET_GROUP_INFO="GROUP_FETCH_SPECIFICATION",e.MODIFY_GROUP="GROUP_CHANGE_GROUPATTRIBUTE",e.LIST_GROUP_MEMBER="GROUP_FETCH_MEMEBERS",e.GET_GROUP_ADMIN="GROUP_GET_ADMIN",e.SET_GROUP_ADMIN="GROUP_SET_ADMIN",e.REMOVE_GROUP_ADMIN="GROUP_REMOVE_ADMIN",e.DISSOLVE_GROUP="GROUP_DESTOTYGROUP",e.QUIT_GROUP="GROUP_LEAVEGROUP",e.INVITE_TO_GROUP="GROUP_INVITE_TO_GROUP",e.JOIN_GROUP="GROUP_JOIN_PUBLICGROUP",e.AGREE_JOIN_GROUP="GROUP_ACCEPT_JOINPUBLICGROUPAPPL",e.REJECT_JOIN_GROUP="GROUP_DECLINE_JOINPUBLICGROUPAPPL",e.AGREE_INVITE_GROUP="GROUP_ACCEPT_INVITATION",e.REJECT_INVITE_GROUP="GROUP_DECLINE_INVITATION",e.REMOVE_GROUP_MEMBER="GROUP_REMOVE_MEMBER",e.MULTI_REMOVE_GROUP_MEMBER="GROUP_REMOVE_MEMBERS",e.MUTE_GROUP_MEMBER="GROUP_MUTE_MEMBERS",e.UNMUTE_GROUP_MEMBER="GROUP_UNMUTE_MEMBERS",e.GET_GROUP_MUTE_LIST="GROUP_FETCH_MUTES",e.BLOCK_GROUP_MEMBER="GROUP_BLOCK_MEMBER",e.BLOCK_GROUP_MEMBERS="GROUP_BLOCK_MEMBERS",e.UNBLOCK_GROUP_MEMBER="GROUP_UNBLOCK_MEMBER",e.UNBLOCK_GROUP_MEMBERS="GROUP_UNBLOCK_MEMBERS",e.GET_GROUP_BLACK_LIST="GROUP_GET_BLOCK_LIST",e.DISABLED_SEND_GROUP_MSG="GROUP_MUTE_ALLMEMBERS",e.ENABLE_SEND_GROUP_MSG="GROUP_UNMUTE_ALLMEMBERS",e.ADD_USERS_TO_GROUP_WHITE="GROUP_ADD_WHITELIST",e.REMOVE_GROUP_WHITE_MEMBER="GROUP_REMOVE_WHITELIST",e.GET_GROUP_WHITE_LIST="GROUP_FETCH_WHITELIST",e.IS_IN_GROUP_WHITE_LIST="GROUP_IS_IN_WHITELIST",e.GET_GROUP_MSG_READ_USER="GROUP_GET_READ_USERS",e.GET_GROUP_ANN="GROUP_FETCH_ANNOUNCEMENT",e.UPDATE_GROUP_ANN="GROUP_UPDATE_ANNOUNCEMENT",e.UPLOAD_GROUP_FILE="GROUP_UPLOAD_SHAREDFILE",e.DELETE_GROUP_FILE="GROUP_DELETE_SHAREDFILE",e.GET_GROUP_FILE_LIST="GROUP_FETCH_SHAREDFILE",e.DOWN_GROUP_FILE="GROUP_DOWNLOAD_SHAREDFILE",e.SET_GROUP_MEMBER_ATTRS="GROUP_MEMBER_SET_META_DATA",e.GET_GROUP_MEMBER_ATTR="GROUP_MEMBER_FETCH_META_DATA",e.GET_SESSION_LIST="REST_GET_SESSION_LIST",e.DELETE_SESSION="REST_DEL_SESSION",e.GET_HISTORY_MSG="REST_GET_HISTORY_MESSAGE",e.PIN_CONVERSATION="REST_PIN_CONVERSATION",e.REST_UPLOAD_FILE_IN_PARTS="REST_UPLOAD_FILE_IN_PARTS",e.REST_DELETE_MESSAGES_CONVERSATIONS="REST_DELETE_MESSAGES_CONVERSATIONS",e.MARK_CONVERSATION="REST_MARK_CONVERSATION",e.REST_FETCH_PINMESSAGES="REST_FETCH_PINMESSAGES",e.REST_PIN_MESSAGE="REST_PIN_MESSAGE",e.UPDATE_USER_INFO="USER_UPDATE_USERINFO",e.GET_USER_INFO="USER_FETCH_USERINFO",e.UPDATE_USER_NICK="USER_UPDATE_NICK",e.UPLOAD_PUSH_TOKEN="USER_UPLOAD_PUSH_TOKEN",e.USER_LOGGEDIN_OTHER_PLATFORM="USER_LOGGEDIN_OTHER_PLATFORM",e.GET_BLACK_LIST="ROSTER_BLACKLIST",e.GET_CONTACTS="ROSTER_CONTACTS",e.ROSTER_GET_ALL_CONTACTS_REMARKS="ROSTER_GET_ALL_CONTACTS_REMARKS",e.ROSTER_GET_ALL_CONTACTS_REMARKS_FROM_SERVER_BY_PAGE="ROSTER_GET_ALL_CONTACTS_REMARKS_FROM_SERVER_BY_PAGE",e.ROSTER_SET_CONTACT_REMARK="ROSTER_SET_CONTACT_REMARK",e.ROSTER_ADD="ROSTER_ADD",e.ROSTER_REMOVE="ROSTER_REMOVE",e.ROSTER_ACCEPT="ROSTER_ACCEPT",e.ROSTER_DECLINE="ROSTER_DECLINE",e.ROSTER_BAN="ROSTER_BAN",e.ROSTER_ALLOW="ROSTER_ALLOW",e.SEND_MSG="MSYNC_SENDMESSAGE",e.UPLOAD_MSG_ATTACH="UPLOAD_MSG_ATTACH",e.SEND_RECALL_MSG="MSYNC_RECALLMESSAGE",e.MODIFY_MESSAGE="MSYNC_MODIFYMESSAGE"}(o||(o={})),function(e){e.GET_DNS="REST_DNSLIST",e.LOGIN_BY_AGORA_TOKEN="LOGIN_BY_AGORA_TOKEN",e.LOGIN_BY_PWD="LOGIN_BY_PWD",e.RESISTER="REGISTER",e.REST_INIT_UPLOAD_TASK_IN_PARTS="REST_INIT_UPLOAD_TASK_IN_PARTS",e.REST_UPLOAD_PART="REST_UPLOAD_PART",e.REST_COMPLETE_UPLOAD_PART="REST_COMPLETE_UPLOAD_PART",e.REST_ABORT_UPLOAD_PART="REST_ABORT_UPLOAD_PART"}(i||(i={})),function(e){e[e["5G"]=7]="5G",e[e["4G"]=7]="4G",e[e["3G"]=7]="3G",e[e["2G"]=7]="2G",e[e["SLOW-2G"]=7]="SLOW-2G",e[e.WIFI=2]="WIFI",e[e.LAN=1]="LAN",e[e.DISCONNECTED=0]="DISCONNECTED",e[e.NONE=0]="NONE",e[e.UNKNOWN=-1]="UNKNOWN",e[e["WEBIM UNABLE TO GET"]=-2]="WEBIM UNABLE TO GET"}(a||(a={})),function(e){e[e.success=200]="success",e[e.failed=500]="failed",e[e.disconnect=-1]="disconnect",e[e.notFound=404]="notFound",e[e.reachLimit=429]="reachLimit"}(s||(s={})),function(e){e[e.web=0]="web",e[e.native=1]="native"}(c||(c={}))},6424:function(e,t,n){"use strict";n.d(t,{gA:function(){return L},ZP:function(){return Re}}),n(9601),n(1539),n(8674),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948),n(7042),n(2222),n(3710),n(7941),n(9714),n(3843),n(8309),n(2772),n(5212),n(7327),n(5827),n(9826),n(4553),n(561),n(9653),n(1038),n(2564),n(9575),n(2472),n(2990),n(8927),n(3105),n(5035),n(4345),n(7174),n(2846),n(4731),n(7209),n(6319),n(8867),n(7789),n(3739),n(9368),n(4483),n(2056),n(3462),n(678),n(7462),n(3824),n(5021),n(2974),n(5016),n(6699),n(2023),n(3161),n(4048),n(9753),n(9554),n(4747),n(285),n(1637),n(8145),n(1249),n(4812);var r=n(4188),o=n.n(r),i=n(3720),a=n.n(i),s=n(5531),c=n(8161),l=n(7360),u=["public","members_only","allow_user_invites","invite_need_confirm"],d={name:"name",title:"name",description:"description",public:"public",members_only:"approval",allow_user_invites:"allowInvites",max_users:"maxUsers",invite_need_confirm:"inviteNeedConfirm",custom:"ext",last_modified:"lastModified"};function p(e,t){var n,r,o,i,a,s,c=this,l=this.context,p=l.userId,h=l.jid,f=t.from.name===p&&h.clientResource!==t.from.clientResource;return t.isThread?(o={id:t.mucId.name,name:t.mucName,operation:"",parentId:t.mucParentId.name,operator:t.from.name,userName:t.to.length?t.to[0].name:""},i={chatThreadId:t.mucId.name,chatThreadName:t.mucName,operation:"",parentId:t.mucParentId.name}):(r={type:"",owner:t.from.name,gid:t.mucId.name,from:t.from.name,fromJid:t.from,to:t.to.length?t.to[0].name:"",toJid:t.to,chatroom:t.isChatroom,status:t.status},a={operation:"",id:t.mucId.name,from:t.from.name},t.isChatroom&&(null===(n=null==t?void 0:t.eventInfo)||void 0===n?void 0:n.ext)&&(s=JSON.parse(t.eventInfo.ext))),({45:function(){var e,n,r;a.operation="memberAttributesUpdate";var o=JSON.parse(null===(e=null==t?void 0:t.eventInfo)||void 0===e?void 0:e.ext)||{};a.attributes=o.properties||{},a.userId=o.username||"",f?null===(n=c.eventHandler)||void 0===n||n.dispatch("onMultiDeviceEvent",a):null===(r=c.eventHandler)||void 0===r||r.dispatch("onGroupEvent",a)},44:function(){var e;a.operation="removeChatRoomAttributes",a.attributes=s.result.successKeys,s.result.successKeys.length>0&&(null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomEvent",a))},43:function(){var e;a.operation="updateChatRoomAttributes";var t={};s.result.successKeys.forEach((function(e){t[e]=s.properties[e]})),a.attributes=t,s.result.successKeys.length>0&&(null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomEvent",a))},42:function(){},41:function(){},40:function(){},39:function(){},38:function(){var e;i.operation="chatThreadNameUpdate",null===(e=c.eventHandler)||void 0===e||e.dispatch("onMultiDeviceEvent",i)},37:function(){var e;o.operation="userRemove",null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatThreadChange",o)},36:function(){var e;i.operation="chatThreadLeave",null===(e=c.eventHandler)||void 0===e||e.dispatch("onMultiDeviceEvent",i)},35:function(){var e;i.operation="chatThreadJoin",null===(e=c.eventHandler)||void 0===e||e.dispatch("onMultiDeviceEvent",i)},34:function(){var e;i.operation="chatThreadDestroy",null===(e=c.eventHandler)||void 0===e||e.dispatch("onMultiDeviceEvent",i)},33:function(){var e;i.operation="chatThreadCreate",null===(e=c.eventHandler)||void 0===e||e.dispatch("onMultiDeviceEvent",i)},32:function(){var e,n,o,i;r.type=t.isChatroom?"rmChatRoomMute":"rmGroupMute",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="unmuteAllMembers",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},31:function(){var e,n,o,i;r.type=t.isChatroom?"muteChatRoom":"muteGroup",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="muteAllMembers",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},30:function(){var e,n,o,i;r.type=t.isChatroom?"rmUserFromChatRoomWhiteList":"rmUserFromGroupWhiteList",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="removeAllowlistMember",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},29:function(){var e,n,o,i;r.type=t.isChatroom?"addUserToChatRoomWhiteList":"addUserToGroupWhiteList",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="addUserToAllowlist",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},28:function(){var e,n,o,i;r.type="deleteFile",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="deleteFile",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},27:function(){var e,n,o,i;r.type="uploadFile",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="uploadFile",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},26:function(){var e,n,o,i;r.type="deleteAnnouncement",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="deleteAnnouncement",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},25:function(){var e,n,o,i;r.type="updateAnnouncement",r.announcement=t.reason,c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="updateAnnouncement",a.announcement=t.reason,t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},24:function(){var e,n,o,i;r.type="removeMute",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="unmuteMember",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},23:function(){var e,n,o,i;r.type="addMute",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="muteMember",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},22:function(){var e,n,o,i;r.type="removeAdmin",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="removeAdmin",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},21:function(){var e,n,o,i;r.type="addAdmin",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="setAdmin",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},20:function(){var e,n,o,i;r.type="changeOwner",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="changeOwner",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},19:function(){var e,n,o,i;r.type="direct_joined",r.groupName=t.mucName,c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="directJoined",a.name=t.mucName,t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},18:function(){var e,n,o,i;r.type=t.isChatroom?"leaveChatRoom":"leaveGroup",c.onPresence&&c.onPresence(r);var s=t.mucMemberCount;s&&(a.memberCount=s),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="memberAbsence",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},17:function(){var e,n,o,i;t.isChatroom&&t.ext&&(a.ext=t.ext,r.ext=t.ext),r.type=t.isChatroom?"memberJoinChatRoomSuccess":"memberJoinPublicGroupSuccess",c.onPresence&&c.onPresence(r);var s=t.mucMemberCount;t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="memberPresence",s&&(a.memberCount=s),t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},16:function(){var e,n;r.type="unblock",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r)},15:function(){var e,n;r.type="block",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r)},14:function(){var e,n,o,i,s,l=t.isChatroom;if(!l){var p=JSON.parse((null===(e=null==t?void 0:t.eventInfo)||void 0===e?void 0:e.ext)||"{}",(function(e,t){return"last_modified"===e?Number(t):u.includes(e)?"true"===t||!0===t:t}));a.detail=r.detail={},Object.keys(p).forEach((function(e){var t=d[e];if(t){var n=p[e];a.detail&&(a.detail[t]=n),r.detail&&(r.detail[t]=n)}}))}r.type="update",c.onPresence&&c.onPresence(r),l?null===(n=c.eventHandler)||void 0===n||n.dispatch("onChatroomChange",r):null===(o=c.eventHandler)||void 0===o||o.dispatch("onGroupChange",r),a.operation="updateInfo",l?null===(i=c.eventHandler)||void 0===i||i.dispatch("onChatroomEvent",a):null===(s=c.eventHandler)||void 0===s||s.dispatch("onGroupEvent",a)},13:function(){var e,n,o,i;r.type="allow",r.reason=t.reason,c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),t.reason&&(a.reason=t.reason),a.operation="unblockMember",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},12:function(){var e,n;r.type="ban",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r)},11:function(){var e,n;r.type="getBlackList",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r)},10:function(){var e,n,o,i;r.type="removedFromGroup",r.kicked=r.to,c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="removeMember",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},9:function(){var e,n,o,i;r.type="invite_decline",r.kicked=r.to,c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="rejectInvite",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},8:function(){var e,n,o,i;r.type="invite_accept",r.kicked=r.to,c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="acceptInvite",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},7:function(){var e,n,o,i;r.type="invite",r.kicked=r.to,r.groupName=t.mucName,c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="inviteToJoin",a.name=t.mucName,t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},6:function(){var e,n,o,i;r.type="joinPublicGroupDeclined",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="joinPublicGroupDeclined",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):(a.userId=t.to.length?t.to[0].name:"",null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a))},5:function(){var e,n,o,i;r.type="joinPublicGroupSuccess",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="acceptRequest",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},4:function(){var e,n,o,i;r.type="joinGroupNotifications",r.reason=t.reason,c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),t.reason&&(a.reason=t.reason),a.operation="requestToJoin",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},3:function(){var e,n;r.type="leave",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r)},2:function(){var e,n;r.type="join",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r)},1:function(){var e,n,o,i;r.type="deleteGroupChat",c.onPresence&&c.onPresence(r),t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomChange",r):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupChange",r),a.operation="destroy",t.isChatroom?null===(o=c.eventHandler)||void 0===o||o.dispatch("onChatroomEvent",a):null===(i=c.eventHandler)||void 0===i||i.dispatch("onGroupEvent",a)},0:function(){var e,n;a.operation="create",t.isChatroom?null===(e=c.eventHandler)||void 0===e||e.dispatch("onChatroomEvent",a):null===(n=c.eventHandler)||void 0===n||n.dispatch("onGroupEvent",a)}}[e]||function(){console.error("No match operation ".concat(e))})()}var h=function(e){var t=this.root.lookup("easemob.pb.MUCBody").decode(e.payload),n=t.operation;l.kg.debug("onMucMessage",t),p.call(this,n,t)},f={handleRosterMsg:function(e){var t,n,r,o,i,a,s=this.root.lookup("easemob.pb.RosterBody").decode(e.payload),c={type:"",to:s.to[0].name,from:s.from.name,status:s.reason};switch(s.operation){case 2:c.type="subscribe",this.onContactInvited&&this.onContactInvited(c),null===(t=this.eventHandler)||void 0===t||t.dispatch("onContactInvited",c);break;case 3:c.type="unsubscribed",this.onContactDeleted&&this.onContactDeleted(c),null===(n=this.eventHandler)||void 0===n||n.dispatch("onContactDeleted",c);break;case 4:c.type="subscribed",this.onContactAdded&&this.onContactAdded(c),null===(r=this.eventHandler)||void 0===r||r.dispatch("onContactAdded",c);break;case 5:c.type="unsubscribed",this.onContactRefuse&&this.onContactRefuse(c),null===(o=this.eventHandler)||void 0===o||o.dispatch("onContactRefuse",c);break;case 6:case 7:break;case 8:c.type="subscribed",this.onContactAgreed&&this.onContactAgreed(c),null===(i=this.eventHandler)||void 0===i||i.dispatch("onContactAgreed",c);break;case 9:c.type="unsubscribed",this.onContactRefuse&&this.onContactRefuse(c),null===(a=this.eventHandler)||void 0===a||a.dispatch("onContactRefuse",c);break;default:l.kg.error("handleRosterMsg:",s)}this.onPresence&&c.type&&this.onPresence(c)}},m=n(7252),v=function(e){var t,n,r,o,i,a,c=this.root.lookup("easemob.pb.StatisticsBody").decode(e.payload),u=c.operation,d=c.reason;switch(u){case 0:this.onStatisticMessage&&this.onStatisticMessage(c),null===(t=this.eventHandler)||void 0===t||t.dispatch("onStatisticMessage",c);break;case 1:a=m.Z.create({type:s.E.WEBIM_CONNCTION_USER_REMOVED,message:"user has been removed"}),this.disconnectedReason=a,this.logOut=!0,this.onError&&this.onError(a),null===(n=this.eventHandler)||void 0===n||n.dispatch("onError",a);break;case 2:a=m.Z.create({type:s.E.WEBIM_CONNCTION_USER_LOGIN_ANOTHER_DEVICE,message:"the user is already logged on another device"}),d&&(a.data={loginInfoCustomExt:c.reason}),this.disconnectedReason=a,this.logOut=!0,this.onError&&this.onError(a),null===(r=this.eventHandler)||void 0===r||r.dispatch("onError",a);break;case 3:a=m.Z.create({type:s.E.WEBIM_CONNCTION_USER_KICKED_BY_CHANGE_PASSWORD,message:"the user was kicked by changing password"}),this.disconnectedReason=a,this.logOut=!0,this.onError&&this.onError(a),null===(o=this.eventHandler)||void 0===o||o.dispatch("onError",a);break;case 4:a=m.Z.create({type:s.E.WEBIM_CONNCTION_USER_KICKED_BY_OTHER_DEVICE,message:"the user was kicked by other device"}),this.disconnectedReason=a,this.logOut=!0,this.onError&&this.onError(a),null===(i=this.eventHandler)||void 0===i||i.dispatch("onError",a);break;default:l.kg.error("handleStatisticsMsg:",c)}},g=(n(9720),n(4024)),E=n(4363),y=n(9937);function _(e){var t,n=[],r=[],o=e.data;o&&o.values&&o.values.forEach((function(e){Object.entries(e.status).forEach((function(e){r.push({device:e[0],status:Number(e[1])})})),n.push({userId:e.uid,lastTime:Number(e.last_time),expire:Number(e.expiry),ext:e.ext,statusDetails:r})})),this.onPresenceStatusChange&&this.onPresenceStatusChange(n),null===(t=this.eventHandler)||void 0===t||t.dispatch("onPresenceStatusChange",n)}function b(e){var t=this;e.data.forEach((function(e){var n,r={from:e.from,to:e.to,chatType:"chat"===e.channel_type?"singleChat":"groupChat",messageId:e.messageId,reactions:e.reactions,ts:e.ts};null===(n=t.eventHandler)||void 0===n||n.dispatch("onReactionChange",r)}))}function T(e){var t,n,r,o;if(e.data){var i=e.data,a={id:i.id||"",name:i.name||"",parentId:i.muc_parent_id||"",messageId:i.msg_parent_id||"",timestamp:i.timestamp||0,operator:i.from||"",operation:""};switch(i.operation){case"create":a.operation="create",a.createTimestamp=a.timestamp,a.messageCount=0,null===(t=this.eventHandler)||void 0===t||t.dispatch("onChatThreadChange",a);break;case"update_msg":a.operation="update",a.messageCount=i.message_count,i.last_message&&"{}"!==JSON.stringify(i.last_message)?a.lastMessage=E.w.call(this,i.last_message):"{}"===JSON.stringify(i.last_message)&&(a.lastMessage={}),null===(n=this.eventHandler)||void 0===n||n.dispatch("onChatThreadChange",a);break;case"update":a.operation="update",a.messageCount=i.message_count,null===(r=this.eventHandler)||void 0===r||r.dispatch("onChatThreadChange",a);break;case"delete":a.operation="destroy",null===(o=this.eventHandler)||void 0===o||o.dispatch("onChatThreadChange",a)}}}function S(e){var t,n=e.data;if(n.resource!==this.clientResource){var r={operation:"deleteRoaming",conversationId:n.to,chatType:"chat"===n.chatType?"singleChat":"groupChat",resource:n.resource};null===(t=this.eventHandler)||void 0===t||t.dispatch("onMultiDeviceEvent",r)}}function O(e){var t,n,r=e.data,o="";if(this.clientResource!==r.res){switch(r.op){case"del":o="deleteConversation";break;case"top":o="pinnedConversation";break;case"not_top":o="unpinnedConversation";break;case"mark":o="markConversation";break;case"mark_delete":o="unMarkConversation";break;case"pin":o="pin";break;case"pin_delete":o="unpin";break;default:return void l.kg.error("unexpected conversation op:",r.op)}if("pin"!==o&&"unpin"!==o){var i={operation:o,conversationId:r.id,conversationType:"chat"===r.type?"singleChat":"groupChat",timestamp:r.ts};"markConversation"!==i.operation&&"unMarkConversation"!==i.operation||r.ext&&(i.conversationMark=y.Z[r.ext]),null===(n=this.eventHandler)||void 0===n||n.dispatch("onMultiDeviceEvent",i)}else{var a=r.ext,s=r.from,c=r.id,u=r.type,d=r.ts,p={messageId:a||"",conversationId:s===this.user?c:s,conversationType:E.U[u],operation:o,operatorId:s,time:d};null===(t=this.eventHandler)||void 0===t||t.dispatch("onMessagePinEvent",p)}}}function R(e){var t,n=this;null===(t=e.values)||void 0===t||t.forEach((function(e){var t,r,o,i,a;if(e.operator_resource!==n.clientResource)if("ignoreInterval"in e.data){var s={operation:"setSilentModeForUser",resource:e.operator_resource,data:e.data};null===(t=n.eventHandler)||void 0===t||t.dispatch("onMultiDeviceEvent",s)}else"group"in e?(s={operation:0===Object.keys(null!==(r=e.data)&&void 0!==r?r:{}).length?"removeSilentModeForConversation":"setSilentModeForConversation",resource:e.operator_resource,conversationId:e.group,type:"groupChat",data:e.data},null===(o=n.eventHandler)||void 0===o||o.dispatch("onMultiDeviceEvent",s)):(s={operation:0===Object.keys(null!==(i=e.data)&&void 0!==i?i:{}).length?"removeSilentModeForConversation":"setSilentModeForConversation",resource:e.operator_resource,conversationId:e.user,type:"singleChat",data:e.data},null===(a=n.eventHandler)||void 0===a||a.dispatch("onMultiDeviceEvent",s))}))}var C=function(e){var t=g.P6.parseNotify(e.payload);switch(t.type){case"presence":_.call(this,t);break;case"reaction":b.call(this,t);break;case"thread":T.call(this,t);break;case"roaming_delete":S.call(this,t);break;case"conv":O.call(this,t);break;case"user_notification_mute":R.call(this,t);break;default:l.kg.error("unexpected notify type: ".concat(t.type))}},w=n(7288),I=n(9743),A=2,N=n(4998),k=n(6801),P=n(2071),D=n(1595);function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}var L,x,U,j=function(){return j=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},j.apply(this,arguments)},F=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},B=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},V=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};!function(e){e[e.NORMAL=0]="NORMAL",e[e.SINGLECHAT=1]="SINGLECHAT",e[e.GROUPCHAT=2]="GROUPCHAT",e[e.CHATROOM=3]="CHATROOM",e[e.READ_ACK=4]="READ_ACK",e[e.DELIVER_ACK=5]="DELIVER_ACK",e[e.RECALL=6]="RECALL",e[e.CHANNEL_ACK=7]="CHANNEL_ACK",e[e.EDIT=8]="EDIT"}(L||(L={})),function(e){e[e.APNs=0]="APNs",e[e.FCM=1]="FCM",e[e.HMSPUSH=2]="HMSPUSH",e[e.MIPUSH=3]="MIPUSH",e[e.MEIZUPUSH=4]="MEIZUPUSH",e[e.VIVOPUSH=5]="VIVOPUSH",e[e.OPPOPUSH=6]="OPPOPUSH",e[e.HONORPUSH=7]="HONORPUSH"}(x||(x={})),function(e){e[e.OK=0]="OK",e[e.FAIL=1]="FAIL",e[e.UNAUTHORIZED=2]="UNAUTHORIZED",e[e.MISSING_PARAMETER=3]="MISSING_PARAMETER",e[e.WRONG_PARAMETER=4]="WRONG_PARAMETER",e[e.REDIRECT=5]="REDIRECT",e[e.TOKEN_EXPIRED=6]="TOKEN_EXPIRED",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.NO_ROUTE=8]="NO_ROUTE",e[e.UNKNOWN_COMMAND=9]="UNKNOWN_COMMAND",e[e.PB_PARSER_ERROR=10]="PB_PARSER_ERROR",e[e.BIND_ANOTHER_DEVICE=11]="BIND_ANOTHER_DEVICE",e[e.IM_FORBIDDEN=12]="IM_FORBIDDEN",e[e.TOO_MANY_DEVICES=13]="TOO_MANY_DEVICES",e[e.PLATFORM_LIMIT=14]="PLATFORM_LIMIT",e[e.USER_MUTED=15]="USER_MUTED",e[e.ENCRYPT_DISABLE=16]="ENCRYPT_DISABLE",e[e.ENCRYPT_ENABLE=17]="ENCRYPT_ENABLE",e[e.DECRYPT_FAILURE=18]="DECRYPT_FAILURE",e[e.PERMISSION_DENIED_EXTERNAL=19]="PERMISSION_DENIED_EXTERNAL"}(U||(U={}));var H=["txt","img","video","audio","file","loc","custom","cmd","combine"],G=g.P6.getEnvInfo();function W(){var e="webim",t="",n="",r=[],o=(new Date).valueOf(),i=g.P6.getDevicePlatform(G);if(this.isFixedDeviceId){var a=g.P6.getLocalDeviceInfo();if(a){var s=JSON.parse(a);e=s.deviceId,t=s.deviceName,n=s.deviceUuid}else"webim"===this.deviceId?(n="".concat(i,"_").concat(o.toString()),e="".concat(this.deviceId,"_").concat(n),t=this.deviceId):e=t=n="webim_".concat(i,"_").concat(this.deviceId),g.P6.setLocalDeviceInfo(JSON.stringify({deviceId:e,deviceName:t,deviceUuid:n}))}else"webim"===this.deviceId?(n="random_".concat(i,"_").concat(o.toString()),e="".concat(this.deviceId,"_").concat(n),t=this.deviceId):e=t=n="webim_".concat(i,"_").concat(this.deviceId);this.context.jid&&(this.context.jid.clientResource=e);var c=this.root.lookup("easemob.pb.Provision"),u=c.decode(r);u.compressType=this.compressType,u.encryptType=this.encryptType,u.osType=this.osType,u.version=this.version,u.deviceName=t,u.resource=e,u.deviceUuid=n,u.authToken='{"token":"$t$'+this.token+'"}',u.sessionId=Date.now().toString()+":",this.loginInfoCustomExt&&(u.reason=this.loginInfoCustomExt),l.kg.debug("provision info",{version:this.version,resource:e,isFixedDeviceId:this.isFixedDeviceId,loginInfoCustomExt:!!this.loginInfoCustomExt,token:!!this.token}),u.actionVersion="v5.0",u=c.encode(u).finish();var d=this.root.lookup("easemob.pb.MSync"),p=d.decode(r);return p.version=this.version,p.guid=this.context.jid,p.auth="$t$"+this.token,p.command=3,p.deviceId=t,p.serviceId=this.dataReport.getServiceId(),p.encryptType=this.encryptType,p.payload=u,d.encode(p).finish()}function q(e,t){var n=this,r=g.P6.getEnvInfo();if("web"===r.platform||"zfb"===r.platform||"dd"===r.platform){for(var i="",a=0;a<e.length;a++)i+=String.fromCharCode(e[a]);return i=o().btoa(i),"web"===r.platform?i:{data:i,isBuffer:!1,complete:function(){},fail:function(e){"sendSocketMessage:fail taskID not exist"!==e.errMsg&&"SocketTast.send:fail SocketTask.readyState is not OPEN"!==e.errMsg||(l.kg.debug("send message fail and reconnect"),n.reconnecting||n.reconnect()),t&&n._msgHash&&n._msgHash[t]&&n._msgHash[t].fail({id:t})}}}var s=e;return{data:s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength),fail:function(e){"sendSocketMessage:fail taskID not exist"!==e.errMsg&&"SocketTast.send:fail SocketTask.readyState is not OPEN"!==e.errMsg||n.reconnecting||n.reconnect(),t&&n._msgHash&&n._msgHash[t]&&n._msgHash[t].fail({id:t})}}}function K(e,t){var n;return F(this,void 0,void 0,(function(){var r,o,i,s,u,d;return B(this,(function(p){switch(p.label){case 0:for(l.kg.debug("distributeMeta, metas length: ",e.length),r=[],o=function(n){var o=e[n],s=new(a())(o.id.low,o.id.high,o.id.unsigned).toString(),u=o.from.name,d=o.to?o.to.name:"",p=!!o.to&&-1!==o.to.domain.indexOf("conference");if(i._load_msg_cache.some((function(e){return e.msgId===s})))return"continue";switch(i._load_msg_cache.length<=i.max_cache_length||i._load_msg_cache.shift(),i._load_msg_cache.push({msgId:s,from:u,to:d,isGroup:p}),o.ns){case 0:v.call(i,o);break;case 1:r.push(c.Z.call(i,o,t,!1,!0,!0));break;case 2:h.call(i,o);break;case 3:f.handleRosterMsg.call(i,o);break;case 4:i.registerConfrIQHandler&&i.registerConfrIQHandler(o,t,i);break;case 5:C.call(i,o);break;default:l.kg.error("distributeMeta",o)}},i=this,s=0;s<e.length;s++)o(s);return[4,Promise.all(r)];case 1:return u=p.sent(),(d=u.filter((function(e){return e&&"cmd"!==e.type}))).length>0&&(null===(n=this.eventHandler)||void 0===n||n.dispatch("onMessage",d)),[2]}}))}))}function Y(e,t){K.call(this,e,t)}function z(e){var t;this._offlineMessagePullState===N.a.SYNC_INIT&&(this._offlineMessagePullState=N.a.SYNC_START,this._offlineMessagePullQueue=e.unread.reduce((function(e,t){return e.find((function(e){return e.name===t.queue.name}))||e.push(t.queue),e}),[]),null===(t=this.eventHandler)||void 0===t||t.dispatch("onOfflineMessageSyncStart"))}function X(e){var t;if(this._offlineMessagePullState===N.a.SYNC_START){var n=this._offlineMessagePullQueue.findIndex((function(t){return t.name===e.queue.name}));n>-1&&this._offlineMessagePullQueue.splice(n,1),0===this._offlineMessagePullQueue.length&&(this._offlineMessagePullState=N.a.SYNC_FINISH,null===(t=this.eventHandler)||void 0===t||t.dispatch("onOfflineMessageSyncFinish"))}}function J(e){var t=this.root.lookup("easemob.pb.CommUnreadDL");t=t.decode(e.payload);var n=new(a())(t.timestamp.low,t.timestamp.high,t.timestamp.unsigned).toString();if(this.expirationTime&&this.compareTokenExpireTime(Number(n),this.expirationTime),0===t.unread.length)ae.call(this);else{z.call(this,t),l.kg.debug("pull unread message",t.unread);for(var r=0;r<t.unread.length;r++){var o=de(this._queues,t.unread[r].queue),i=de(this.unSyncQueue,t.unread[r].queue);o||i?l.kg.warn("receive unread message and already in queue"):this.unSyncQueue.push(t.unread[r].queue)}for(r=0;r<this.unSyncQueue.length;r++)this.unSyncQueue[r].hasSync||$.call(this,this.unSyncQueue[r]),this.unSyncQueue[r].hasSync=!0}ae.call(this)}function Z(){var e=[],t=this.root.lookup("easemob.pb.StatisticsBody"),n=t.decode(e);n.operation=0,n=t.encode(n).finish();var r=this.root.lookup("easemob.pb.Meta").decode(e);r.id=(new Date).valueOf(),r.ns=0,r.payload=n;var o=this.root.lookup("easemob.pb.CommSyncUL"),i=o.decode(e);i.meta=r,i=o.encode(i).finish();var a=this.root.lookup("easemob.pb.MSync"),s=a.decode(e);return s.version=this.version,s.encryptType=[0],s.command=0,s.payload=i,a.encode(s).finish()}function Q(e){var t=[],n=this.root.lookup("easemob.pb.CommSyncUL"),r=n.decode(t);r.queue=e,r=n.encode(r).finish();var o=this.root.lookup("easemob.pb.MSync"),i=o.decode(t);return i.version=this.version,i.encryptType=this.encryptType,i.command=0,i.payload=r,o.encode(i).finish()}function $(e){l.kg.debug("sendBackqueue");var t=Q.call(this,e);Oe.call(this,t)}function ee(e,t){var n=[],r=this.root.lookup("easemob.pb.CommSyncUL"),o=r.decode(n);o.queue=t,o.key=new(a())(e.low,e.high,e.unsigned).toString(),o=r.encode(o).finish();var i=this.root.lookup("easemob.pb.MSync"),s=i.decode(n);return s.version=this.version,s.encryptType=this.encryptType,s.command=0,s.payload=o,i.encode(s).finish()}function te(){var e=this;this.uniPush&&!1===this.isRegisterPush&&(this.isRegisterPush=!0,this.uniPush.onRegister((function(t){l.kg.debug("push token onRegister",t);var n=e.uniPushConfig||{},r=n.APNsCertificateName,o=void 0===r?"":r,i=n.HMSCertificateName,a=void 0===i?"":i,s=n.HONORCertificateName,c=void 0===s?"":s,u=n.MEIZUCertificateName,d=void 0===u?"":u,p=n.MICertificateName,h=void 0===p?"":p,f=n.OPPOCertificateName,m=void 0===f?"":f,v=n.VIVOCertificateName,g=void 0===v?"":v;switch(t.push_type){case x.APNs:e.pushCertificateName=o;break;case x.HMSPUSH:e.pushCertificateName=a;break;case x.HONORPUSH:e.pushCertificateName=c;break;case x.MEIZUPUSH:e.pushCertificateName=d;break;case x.MIPUSH:e.pushCertificateName=h;break;case x.OPPOPUSH:e.pushCertificateName=m;break;case x.VIVOPUSH:e.pushCertificateName=g;break;default:l.kg.error("unexpected push type",t.push_type)}e.pushCertificateName&&t.push_token&&k.r.call(e,{deviceId:e.clientResource,deviceToken:t.push_token,notifierName:e.pushCertificateName}).then((function(){l.kg.debug("uploadPushToken success")})).catch((function(e){l.kg.debug("uploadPushToken failed",e)}))})))}function ne(){var e;this._offlineMessagePullState=N.a.SYNC_INIT,this._offlineMessagePullQueue=[],this.times=1,this.autoReconnectNumTotal=0,this.onOpened&&this.onOpened(),te.call(this),null===(e=this.eventHandler)||void 0===e||e.dispatch("onConnected"),ie.call(this),ce.call(this),se.call(this),ae.call(this)}function re(e,t){l.kg.debug("sendLastSession",e);var n=ee.call(this,e,t);Oe.call(this,n)}function oe(e){var t,n,r,o,i,a,c,u=this,d=this.root.lookup("easemob.pb.Provision").decode(e.payload);if(this.context.jid&&(this.context.jid.clientResource=d.resource),this.clientResource=d.resource,d.status.errorCode===U.OK){if(this.disconnectedReason=void 0,d.authToken){var p=JSON.parse(d.authToken).expires_in;if(!this.tokenExpiredTimer&&!this.tokenWillExpireTimer){var h=Date.now();this.expirationTime=p;var f=this.expirationTime-h;this.expiresIn=f<0?0:f,this.tokenExpireTimeCountDown(this.expiresIn)}}this.reconnecting=!1,this.logOut=!1,"zfb"!==G.platform&&"dd"!==G.platform||(this.sock.readyState=1),this._localCache?(null===(t=this._localCache)||void 0===t?void 0:t.getInstance())?ne.call(this):this._localCache&&new this._localCache({user:this.user,dbName:"cache_".concat(Math.abs((0,I.un)(this.appKey)),"_").concat(this.user),version:A,onInit:function(){return F(u,void 0,void 0,(function(){return B(this,(function(e){return l.kg.debug("localCache init success"),ne.call(this),[2]}))}))}}):ne.call(this)}else{var v=void 0,g=d.status,E=g.reason,y=g.errorCode;switch(l.kg.debug("provision errorCode: ",y),l.kg.debug("provision reason: ",E),y){case U.FAIL:v="Sorry, user register limit"===E?m.Z.create({type:s.E.MAX_LIMIT,message:"Sorry, the number of user registrations limit has been reached"}):"Sorry, user register rate limit"===E?m.Z.create({type:s.E.MAX_LIMIT,message:"Sorry, user register rate limit"}):"Sorry, token expired"===E?m.Z.create({type:s.E.WEBIM_TOKEN_EXPIRED,message:"Sorry, token expired"}):"Sorry, token or password does not match login info"===E?m.Z.create({type:s.E.WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR,message:"INVALID_TOKEN"}):"Sorry, user not found"===E?m.Z.create({type:s.E.USER_NOT_FOUND,message:"User not found"}):m.Z.create({type:s.E.WEBIM_CONNCTION_AUTH_ERROR,message:"Auth failed"}),null===(n=this.eventHandler)||void 0===n||n.dispatch("onError",v);break;case U.WRONG_PARAMETER:v=m.Z.create({type:s.E.REQUEST_PARAMETER_ERROR,message:"Invalid parameter"}),null===(r=this.eventHandler)||void 0===r||r.dispatch("onError",v);break;case U.UNAUTHORIZED:v=m.Z.create({type:s.E.WEBIM_CONNCTION_AUTH_ERROR,message:"Auth failed"}),null===(o=this.eventHandler)||void 0===o||o.dispatch("onError",v);break;case U.IM_FORBIDDEN:v=m.Z.create({type:s.E.WEBIM_SERVER_SERVING_DISABLED,message:"Server serving disabled."}),null===(i=this.eventHandler)||void 0===i||i.dispatch("onError",v);break;case U.PERMISSION_DENIED:v="Sorry, the app month live count limit"===E?m.Z.create({type:s.E.MAX_LIMIT,message:"Sorry, the monthly active user limit for this app has been reached"}):"Sorry, the app day live count limit"===E?m.Z.create({type:s.E.MAX_LIMIT,message:"Sorry, the daily active user limit for this app has been reached"}):"Sorry, the app online count limit"===E?m.Z.create({type:s.E.MAX_LIMIT,message:"Sorry, the maximum number limit of online users for this app has been reached"}):m.Z.create({type:s.E.WEBIM_CONNCTION_AUTH_ERROR,message:"Auth failed"}),null===(a=this.eventHandler)||void 0===a||a.dispatch("onError",v);break;default:v=m.Z.create({type:s.E.WEBIM_CONNCTION_AUTH_ERROR,message:E}),null===(c=this.eventHandler)||void 0===c||c.dispatch("onError",v)}this.disconnectedReason=v}}function ie(){var e,t;if((null===(e=this.unMSyncSendMsgMap)||void 0===e?void 0:e.size)>0){for(var n=Array.from(this.unMSyncSendMsgMap.keys()),r=0;r<n.length;r++){var o=this.unMSyncSendMsgMap.get(n[r]);Oe.call(this,o,n[r])}null===(t=this.unMSyncSendMsgMap)||void 0===t||t.clear()}}function ae(){var e=Z.call(this);Oe.call(this,e)}function se(){l.kg.debug("sendUnreadDeal");var e=ue.call(this);Oe.call(this,e)}function ce(){var e=this;le.call(this),this.heartBeatID=setInterval((function(){(Date.now()-e.lastHeartbeat)/1e3>=30&&(l.kg.debug("send heart beat"),se.call(e),e.lastHeartbeat=Date.now())}),this.heartBeatWait)}function le(){clearInterval(this.heartBeatID)}function ue(){var e=this.root.lookup("easemob.pb.MSync"),t=e.decode([]);return t.version=this.version,t.encryptType=this.encryptType,t.command=1,e.encode(t).finish()}function de(e,t){return e.some((function(e){return e.name===t.name}))}function pe(e){var t=this.root.lookup("easemob.pb.CommNotice"),n=t.decode(e.payload),r=de(this._queues,n.queue);l.kg.debug("receive notice",t,this._queues);var o=de(this.unSyncQueue,n.queue);r||o||this.clientResource===n.queue.clientResource&&n.queue.name===this.context.userId||(this._queues.push(n.queue),1===this._queues.length&&$.call(this,n.queue))}function he(e){return F(this,void 0,void 0,(function(){var t,n,r,i,a,s,c,l;return B(this,(function(u){if(t=g.P6.getEnvInfo(),n=this.root.lookup("easemob.pb.MSync"),"miniCore"===this.name){try{i=new Uint8Array(e.data),r=n.decode(i)}catch(e){throw new Error("decode message fail.")}return[2,r]}if("web"===t.platform||"zfb"===t.platform||"dd"===t.platform){for(a=o().atob(e.data),s=[],c=0,l=a.length;c<l;++c)s.push(a.charCodeAt(c));return[2,n.decode(s)]}try{r=n.decode(e.data)}catch(e){throw new Error("decode message fail.")}return[2,r]}))}))}function fe(e){var t=this;this.lastHeartbeat=Date.now(),e.then((function(e){if(e)switch(e.command){case 0:me.call(t,e);break;case 1:J.call(t,e);break;case 2:pe.call(t,e);break;case 3:oe.call(t,e);break;default:l.kg.error("unexpected msync command: ".concat(e.command))}else l.kg.error("unexpected msync result: ".concat(e))}))}function me(e){var t,n,r,o,i,u,d,p,h,f,v,E,y,_,b,T,S,O,R,C,I,A,N,k,M,L,x,U,V,H,G,W,q,K,z,J,Z,Q,ee,te,ne,oe,ie,ae,se;return F(this,void 0,void 0,(function(){var F,ce,le,ue,de,pe,he,fe,me,ve,ge,Ee,ye,_e,be,Te,Se,Oe,Re,Ce,we,Ie,Ae,Ne,ke,Pe,De,Me,Le,xe,Ue,je,Fe,Be,Ve,He,Ge,We,qe,Ke,Ye,ze,Xe,Je=this;return B(this,(function(B){switch(B.label){case 0:if(F=(F=this.root.lookup("easemob.pb.CommSyncDL")).decode(e.payload),ce=new(a())(F.serverId.low,F.serverId.high,F.serverId.unsigned).toString(),le=new(a())(F.metaId.low,F.metaId.high,F.metaId.unsigned).toString(),!(Number(le)>0))return[3,23];if(!F.status)return[3,22];if(0!==F.status.errorCode)return[3,21];if(null==(ue=this._msgHash[le])?void 0:ue.isHandleChatroom){try{de="join"===(null===(t=this._msgHash[le])||void 0===t?void 0:t.operation),(null===(n=this._msgHash[le])||void 0===n?void 0:n.resolve)instanceof Function&&de&&this._msgHash[le].resolve({type:0,data:{action:"apply",id:this._msgHash[le].roomId,result:!0,user:this.context.userId}}),(null===(r=this._msgHash[le])||void 0===r?void 0:r.success)instanceof Function&&de&&this._msgHash[le].success({type:0,data:{action:"apply",id:this._msgHash[le].roomId,result:!0,user:this.context.userId}}),(null===(o=this._msgHash[le])||void 0===o?void 0:o.resolve)instanceof Function&&!de&&this._msgHash[le].resolve({type:0,data:{result:!0}}),(null===(i=this._msgHash[le])||void 0===i?void 0:i.success)instanceof Function&&!de&&this._msgHash[le].success({type:0,data:{result:!0}}),P.iO.has(le)&&(pe=P.iO.get(le),Ve=pe.rpt,He=pe.requestName,Ve({isEndApi:!0,data:{isSuccess:1,requestName:He,requestMethod:"WEBSOCKET",requestUrl:this.url,code:D.dd.success}}),P.iO.delete(le))}catch(e){P.iO.has(le)&&(he=P.iO.get(le),Ve=he.rpt,He=he.requestName,Ve({isEndApi:!0,data:{isSuccess:0,requestName:He,requestMethod:"WEBSOCKET",requestUrl:this.url,code:D.dd.failed,codeDesc:"when executing success function error"}}),P.iO.delete(le)),We=m.Z.create({type:s.E.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,message:"when executing success function error",data:e}),this.onError&&this.onError(We),null===(u=this.eventHandler)||void 0===u||u.dispatch("onError",We)}delete this._msgHash[le]}return!ue||ue.isHandleChatroom?[3,20]:(fe=null,me="",ve=0,ge=null,this._msgHash[le].thirdMessage?(this._msgHash[le].thirdMessage.id=F.serverId,this._msgHash[le].thirdMessage.timestamp=F.timestamp,[4,c.Z.call(this,this._msgHash[le].thirdMessage,F.status,!0,!0)]):[3,2]);case 1:ge=B.sent(),B.label=2;case 2:if(0===F.metas.length)return[3,13];B.label=3;case 3:switch(B.trys.push([3,12,,13]),Ee=F.metas[0],ye=F.status,Ee.ns){case 1:return[3,4];case 5:return[3,9]}return[3,10];case 4:return this.useReplacedMessageContents?[4,c.Z.call(this,Ee,ye,!0,!0)]:[3,8];case 5:return ge=B.sent(),[4,null===(p=null===(d=this._localCache)||void 0===d?void 0:d.getInstance())||void 0===p?void 0:p.getMessageByServerMsgId(le)];case 6:return(_e=B.sent())?[4,null===(f=null===(h=this._localCache)||void 0===h?void 0:h.getInstance())||void 0===f?void 0:f.putMessageToDB(j(j(j({},_e),ge),{id:le}))]:[3,8];case 7:B.sent(),B.label=8;case 8:return[3,11];case 9:return(be=g.P6.parseNotify(F.metas[0].payload)).edit_msg&&(Te=be.edit_msg,Se=Te.count,Oe=Te.operator,Re=Te.edit_time,Ce=Te.sender,we=Te.send_time,fe={operationTime:Re,operatorId:Oe,operationCount:Se},me=Ce,ve=Number(we)),[3,11];case 10:return l.kg.error("decode local meta error",Ee),[3,11];case 11:return[3,13];case 12:return Ie=B.sent(),We=m.Z.create({type:s.E.WEBIM_LOAD_MSG_ERROR,message:"decode local meta message error",data:Ie}),this.onError&&this.onError(We),null===(v=this.eventHandler)||void 0===v||v.dispatch("onError",We),[3,13];case 13:P.TJ.has(le)&&(P.TJ.get(le).rpt({isEndApi:!0,data:{isSuccess:1,requestMethod:"WEBSOCKET",requestUrl:this.url,code:D.dd.success,msgId:ce}}),P.TJ.delete(le)),B.label=14;case 14:return B.trys.push([14,18,,19]),Ae={localMsgId:le,serverMsgId:ce},fe&&(this._msgHash[le].modifiedInfo=fe,Ne=this._msgHash[le],ke=Ne.editMessageId,je=Ne.type,Pe=Ne.chatType,De=Ne.msg,Me=Ne.to,Le=Ne.translations,xe={id:ke,type:je,chatType:Pe,msg:De,modifiedInfo:fe,to:Me,from:me,time:Number(ve)},Le&&(xe.translations=Le),Ae.message=xe,null===(_=null===(y=null===(E=this._localCache)||void 0===E?void 0:E.getInstance())||void 0===y?void 0:y.getMessageByServerMsgId(ke))||void 0===_||_.then((function(e){var t,n;e&&"txt"===e.type&&(null===(n=null===(t=Je._localCache)||void 0===t?void 0:t.getInstance())||void 0===n||n.putMessageToDB(j(j({},e),{msg:xe.msg,modifiedInfo:xe.modifiedInfo,translations:xe.translations})))}))),ge&&(Ae.message=ge),[4,null===(T=null===(b=this._localCache)||void 0===b?void 0:b.getInstance())||void 0===T?void 0:T.updateLocalMessage(le,{serverMsgId:ce,status:w.r.SUCCESS})];case 15:return B.sent(),(null===(S=this._msgHash[le])||void 0===S?void 0:S.success)instanceof Function?[4,this._msgHash[le].success(le,ce)]:[3,17];case 16:B.sent(),B.label=17;case 17:return(null===(O=this._msgHash[le])||void 0===O?void 0:O.resolve)instanceof Function&&this._msgHash[le].resolve(Ae),[3,19];case 18:return Ue=B.sent(),We=m.Z.create({type:s.E.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,message:"when executing success function error",data:Ue}),this.onError&&this.onError(We),null===(R=this.eventHandler)||void 0===R||R.dispatch("onError",We),[3,19];case 19:this.onReceivedMessage&&this.onReceivedMessage({id:le,mid:ce,to:this._msgHash[le].to,time:0}),null===(C=this.eventHandler)||void 0===C||C.dispatch("onReceivedMessage",{id:le,mid:ce,to:this._msgHash[le].to}),delete this._msgHash[le],B.label=20;case 20:return[3,22];case 21:if(15===F.status.errorCode)(null===(I=this._msgHash[le])||void 0===I?void 0:I.fail)instanceof Function&&this._msgHash[le].fail({type:s.E.SERVICE_NOT_ALLOW_MESSAGING_MUTE,reason:"you were muted"}),this._msgHash[le].reject instanceof Function&&this._msgHash[le].reject({type:s.E.SERVICE_NOT_ALLOW_MESSAGING_MUTE,reason:"you were muted"}),null===(N=null===(A=this._localCache)||void 0===A?void 0:A.getInstance())||void 0===N||N.updateLocalMessage(le,{serverMsgId:ce,status:w.r.FAIL});else if(1===F.status.errorCode){switch(je=void 0,F.status.reason){case"blocked":je=s.E.PERMISSION_DENIED;break;case"group not found":je=s.E.GROUP_NOT_EXIST;break;case"not in group or chatroom":je=s.E.GROUP_NOT_JOINED;break;case"exceed recall time limit":je=s.E.MESSAGE_RECALL_TIME_LIMIT;break;case"message recall disabled":je=s.E.SERVICE_NOT_ENABLED;break;case"not in group or chatroom white list":je=s.E.SERVICE_NOT_ALLOW_MESSAGING;break;case"nonroster":je=s.E.USER_NOT_FRIEND,F.status.reason="not contact";break;case"group is disabled":je=s.E.GROUP_IS_DISABLED,F.status.reason="group is disabled";break;case"limit directed users":je=s.E.MAX_LIMIT;break;case"Sorry, edit limit reached":je=s.E.MAX_LIMIT,F.status.reason="Modify message limit reached";break;case"Sorry, message does not exist":je=s.E.MODIFY_MESSAGE_NOT_EXIST,F.status.reason="The message does not exist.";break;case"Sorry, You do not have permission":je=s.E.PERMISSION_DENIED,F.status.reason="You do not have the modified permission.";break;case"Sorry, format is incorrect":je=s.E.MODIFY_MESSAGE_FORMAT_ERROR,F.status.reason="The modify messaged format error.";break;case"Sorry, edit is not available":je=s.E.SERVICE_NOT_ENABLED,F.status.reason="The message modify function is not activated.";break;case"Sorry, edit fail":je=s.E.MODIFY_MESSAGE_FAILED,F.status.reason="Modify message failed.";break;default:F.status.reason.includes("grpID")&&F.status.reason.includes("does not exist!")?(je=s.E.CHATROOM_NOT_EXIST,F.status.reason="The chat room dose not exist."):F.status.reason.includes("username")&&F.status.reason.includes("doesn't exist!")?je=s.E.USER_NOT_FOUND:"group member list is full!"===F.status.reason?je=s.E.CHATROOM_MEMBERS_FULL:F.status.reason.includes("can not join this group")&&F.status.reason.includes("is in the blacklist")?(je=s.E.PERMISSION_DENIED,F.status.reason="permission denied"):"can not operate this group, reason: group is disabled"===F.status.reason?je=s.E.GROUP_IS_DISABLED:F.status.reason.includes("moderation")?je=s.E.MESSAGE_MODERATION_BLOCKED:F.status.reason.includes("group ID illegal, please check it")?(je=s.E.REQUEST_PARAMETER_ERROR,F.status.reason="Invalid parameter"):je=F.status.reason.includes("has create too many chatrooms")||F.status.reason.includes("has joined too many chatrooms")?s.E.MAX_LIMIT:F.status.reason.includes("auto create failed")?s.E.SERVER_BUSY:s.E.SERVER_UNKNOWN_ERROR}this._msgHash[le]&&((null===(k=this._msgHash[le])||void 0===k?void 0:k.isHandleChatroom)?(Ge=m.Z.create({type:je,message:F.status.reason||"",data:""}),this._msgHash[le].reject instanceof Function&&this._msgHash[le].reject(Ge),this._msgHash[le].error instanceof Function&&this._msgHash[le].error(Ge),P.iO.has(le)&&(Fe=D.dd.failed,je===s.E.CHATROOM_NOT_EXIST?Fe=D.dd.notFound:je===s.E.CHATROOM_MEMBERS_FULL&&(Fe=D.dd.reachLimit),Be=P.iO.get(le),Ve=Be.rpt,He=Be.requestName,Ve({isEndApi:!0,data:{isSuccess:0,requestName:He,requestMethod:"WEBSOCKET",requestUrl:this.url,code:Fe,codeDesc:F.status.reason}}),P.iO.delete(le))):(Ge=m.Z.create({type:je,message:F.status.reason||"",data:{id:le,mid:ce}}),this._msgHash[le].reject instanceof Function&&this._msgHash[le].reject(Ge),this._msgHash[le].fail instanceof Function&&this._msgHash[le].fail({type:je,reason:F.status.reason?F.status.reason:"",data:{id:le,mid:ce}}),null===(L=null===(M=this._localCache)||void 0===M?void 0:M.getInstance())||void 0===L||L.updateLocalMessage(le,{serverMsgId:ce,status:w.r.FAIL})),delete this._msgHash[le])}else if(7===F.status.errorCode)"sensitive words"===F.status.reason&&this._msgHash[le]?(Ge=m.Z.create({type:s.E.MESSAGE_INCLUDE_ILLEGAL_CONTENT,message:"sensitive words",data:{id:le,mid:ce}}),this._msgHash[le].reject instanceof Function&&this._msgHash[le].reject(Ge),this._msgHash[le].fail instanceof Function&&this._msgHash[le].fail({type:s.E.MESSAGE_INCLUDE_ILLEGAL_CONTENT,data:{id:le,mid:ce,reason:"sensitive words"}}),null===(U=null===(x=this._localCache)||void 0===x?void 0:x.getInstance())||void 0===U||U.updateLocalMessage(le,{serverMsgId:ce,status:w.r.FAIL})):"blocked by mod_antispam"===F.status.reason&&this._msgHash[le]?(Ge=m.Z.create({type:s.E.MESSAGE_INCLUDE_ILLEGAL_CONTENT,message:"blocked by mod_antispam",data:{id:le,mid:ce}}),this._msgHash[le].reject instanceof Function&&this._msgHash[le].reject(Ge),this._msgHash[le].fail instanceof Function&&this._msgHash[le].fail({type:s.E.MESSAGE_INCLUDE_ILLEGAL_CONTENT,data:{id:le,mid:ce,reason:"blocked by mod_antispam"}}),null===(H=null===(V=this._localCache)||void 0===V?void 0:V.getInstance())||void 0===H||H.updateLocalMessage(le,{serverMsgId:ce,status:w.r.FAIL})):"user is mute"===F.status.reason&&this._msgHash[le]?(Ge=m.Z.create({type:s.E.USER_MUTED_BY_ADMIN,message:"user is mute",data:{id:le,mid:ce}}),this._msgHash[le].reject instanceof Function&&this._msgHash[le].reject(Ge),this._msgHash[le].fail instanceof Function&&this._msgHash[le].fail(Ge),null===(W=null===(G=this._localCache)||void 0===G?void 0:G.getInstance())||void 0===W||W.updateLocalMessage(le,{serverMsgId:ce,status:w.r.FAIL})):"traffic limit"===F.status.reason&&this._msgHash[le]?(Ge=m.Z.create({type:s.E.MESSAGE_CURRENT_LIMITING,message:"traffic limit",data:{id:le,mid:ce}}),this._msgHash[le].reject instanceof Function&&this._msgHash[le].reject(Ge),this._msgHash[le].fail instanceof Function&&this._msgHash[le].fail(Ge),null===(K=null===(q=this._localCache)||void 0===q?void 0:q.getInstance())||void 0===K||K.updateLocalMessage(le,{serverMsgId:ce,status:w.r.FAIL})):"Sorry, data is too large"===F.status.reason&&this._msgHash[le]&&(Ge=m.Z.create({type:s.E.MESSAGE_SIZE_LIMIT,message:"Sorry, data is too large",data:{id:le,mid:ce}}),this._msgHash[le].reject instanceof Function&&this._msgHash[le].reject(Ge),this._msgHash[le].fail instanceof Function&&this._msgHash[le].fail(Ge),null===(J=null===(z=this._localCache)||void 0===z?void 0:z.getInstance())||void 0===J||J.updateLocalMessage(le,{serverMsgId:ce,status:w.r.FAIL}));else if(19===F.status.errorCode)this._msgHash[le]&&(P.TJ.has(le)&&(P.TJ.get(le).rpt({isEndApi:!0,data:{isSuccess:0,requestMethod:"WEBSOCKET",requestUrl:this.url,code:s.E.MESSAGE_EXTERNAL_LOGIC_BLOCKED,codeDesc:F.status.reason||"",msgId:ce}}),P.TJ.delete(le)),Ge=m.Z.create({type:s.E.MESSAGE_EXTERNAL_LOGIC_BLOCKED,message:F.status.reason||"",data:{id:le,mid:ce}}),this._msgHash[le].reject instanceof Function&&this._msgHash[le].reject(Ge),this._msgHash[le].fail instanceof Function&&this._msgHash[le].fail({type:s.E.MESSAGE_EXTERNAL_LOGIC_BLOCKED,data:{id:le,mid:ce,reason:F.status.reason}}),null===(Q=null===(Z=this._localCache)||void 0===Z?void 0:Z.getInstance())||void 0===Q||Q.updateLocalMessage(le,{serverMsgId:ce,status:w.r.FAIL}));else if(this._msgHash[le]){P.TJ.has(le)&&(P.TJ.get(le).rpt({isEndApi:!0,data:{isSuccess:0,requestMethod:"WEBSOCKET",requestUrl:this.url,code:s.E.WEBIM_LOAD_MSG_ERROR,codeDesc:(null===(ee=F.status)||void 0===ee?void 0:ee.reason)||"",msgId:ce}}),P.TJ.delete(le));try{Ge=m.Z.create({type:s.E.WEBIM_LOAD_MSG_ERROR,message:(null===(te=F.status)||void 0===te?void 0:te.reason)||"",data:{id:le,mid:ce,reason:F.status&&F.status.reason}}),this._msgHash[le].reject instanceof Function&&this._msgHash[le].reject(Ge),null===(oe=null===(ne=this._localCache)||void 0===ne?void 0:ne.getInstance())||void 0===oe||oe.updateLocalMessage(le,{serverMsgId:ce,status:w.r.FAIL}),this._msgHash[le].fail instanceof Function&&this._msgHash[le].fail({type:s.E.WEBIM_LOAD_MSG_ERROR,data:{errorCode:F.status&&F.status.errorCode,reason:F.status&&F.status.reason}})}catch(e){We=m.Z.create({type:s.E.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,message:"when executing fail function error",data:e}),this.onError&&this.onError(We),null===(ie=this.eventHandler)||void 0===ie||ie.dispatch("onError",We)}delete this._msgHash[le]}else P.TJ.has(le)&&(P.TJ.get(le).rpt({isEndApi:!0,data:{isSuccess:0,requestMethod:"WEBSOCKET",requestUrl:this.url,code:s.E.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,codeDesc:"on message error",msgId:ce}}),P.TJ.delete(le)),We=m.Z.create({type:s.E.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,message:"on message error"}),this.onError&&this.onError(We),null===(ae=this.eventHandler)||void 0===ae||ae.dispatch("onError",We);B.label=22;case 22:return[2];case 23:if(F.metas&&0!==F.metas.length)try{Y.call(this,F.metas,F.status)}catch(e){We=m.Z.create({type:s.E.WEBIM_LOAD_MSG_ERROR,message:"decode message error",data:e}),l.kg.error("decode message error",e),this.onError&&this.onError(We),null===(se=this.eventHandler)||void 0===se||se.dispatch("onError",We)}finally{F.isLast?(l.kg.debug("metas & CommSyncDLMessage.isLast",F.isLast),qe=-1,this._queues.some((function(e,t){return e.name===F.name&&(qe=t,!0)}))&&qe>0&&this._queues.splice(qe,1),this._queues.length>0&&$.call(this,this._queues[0]),Ke=-1,this.unSyncQueue.some((function(e,t){return e.name===F.queue.name&&(Ke=t,!0)}))&&this.unSyncQueue.splice(Ke,1),X.call(this,F)):F.nextKey&&(Xe=new(a())(F.nextKey.low,F.nextKey.high,F.nextKey.unsigned).toString(),l.kg.debug("nexKey:",Xe,"this.nextKey:",this.nexKey),Xe!==this.nexKey&&(this.nexKey=Xe,re.call(this,F.nextKey,F.queue)))}else F.isLast?(l.kg.debug("CommSyncDLMessage.isLast",F.isLast),Ye=-1,this._queues.some((function(e,t){return e.name===F.queue.name&&(Ye=t,!0)}))&&this._queues.splice(Ye,1),this._queues.length>0&&$.call(this,this._queues[0]),ze=-1,this.unSyncQueue.some((function(e,t){return e.name===F.queue.name&&(ze=t,!0)}))&&this.unSyncQueue.splice(ze,1),X.call(this,F)):F.nextKey&&(Xe=new(a())(F.nextKey.low,F.nextKey.high,F.nextKey.unsigned).toString(),l.kg.debug("nexKey:",Xe,"this.nextKey:",this.nexKey),Xe!==this.nexKey&&(this.nexKey=Xe,re.call(this,F.nextKey,F.queue)));return[2]}}))}))}function ve(e){var t=[],n=this.root.lookup("easemob.pb.KeyValue"),r=[];for(var o in e){var i=n.decode(t);if(i.key=o,void 0!==e[o]){if("object"===M(e[o]))i.type=8,i.stringValue=JSON.stringify(e[o]);else if("string"==typeof e[o])i.type=7,i.stringValue=e[o];else if("boolean"==typeof e[o])i.type=1,i.varintValue=!0===e[o]?1:0;else if(Number.isInteger(e[o]))i.type=2,i.varintValue=e[o];else if("bigint"==typeof e[o]||"symbol"===M(e[o])||"function"==typeof e[o]||Number.isNaN(e[o]))i.type=7,i.stringValue=e[o].toString();else{if("number"!=typeof e[o]||Number.isInteger(e[o]))continue;i.type=6,i.doubleValue=e[o]}r.push(i)}}return r}function ge(e){var t,n,r,o=[];if(this.root){var i,c=this.root.lookup("easemob.pb.MessageBody.Content").decode(o);switch(i=!e.group&&"groupchat"!==(null===(t=null==e?void 0:e.chatType)||void 0===t?void 0:t.toLowerCase())||e.roomType?e.group&&e.roomType||"chatroom"===(null===(n=null==e?void 0:e.chatType)||void 0===n?void 0:n.toLowerCase())?"chatRoom":"singleChat":"groupChat",e.type){case"txt":c.type=0,c.text=e.msg;break;case"img":c.type=1,e.body?(c.displayName=e.body.filename,c.remotePath=e.body.url,c.secretKey=e.body.secret,c.fileLength=e.body.file_length,c.size=e.body.size,c.thumbnailDisplayName=e.body.filename):e.file?(c.displayName=e.file.filename,c.remotePath=e.file.url,c.secretKey=e.file.secret,c.fileLength=e.file.file_length,c.size=e.file.size,c.thumbnailDisplayName=e.file.filename):(c.displayName=e.filename,c.remotePath=e.url,c.secretKey=e.secret,c.fileLength=e.file_length,c.size=e.size,c.thumbnailDisplayName=e.filename),e.isBuildCombinedMsg&&(c.remotePath=e.url,c.secretKey=e.secret,c.size={height:e.height,width:e.width});break;case"video":c.type=2,e.body?(c.displayName=e.body.filename,c.remotePath=e.body.url,c.secretKey=e.body.secret,c.fileLength=e.body.file_length,c.duration=e.body.length,c.thumbnailDisplayName=e.body.filename,c.thumbnailRemotePath=this.useOwnUploadFun?"":"".concat(e.body.url,"?vframe=true"),c.thumbnailSecretKey=this.useOwnUploadFun?"":e.body.secret):e.isBuildCombinedMsg&&(c.displayName=e.filename,c.remotePath=e.url,c.secretKey=e.secret,c.fileLength=e.file_length,c.duration=e.length,c.thumbnailDisplayName=e.filename,c.thumbnailRemotePath=e.thumb,c.thumbnailSecretKey=e.thumb_secret);break;case"loc":c.type=3,c.latitude=e.lat,c.longitude=e.lng,c.address=e.addr,c.buildingName=e.buildingName,c.latitude=e.lat;break;case"audio":c.type=4,e.body?(c.displayName=e.body.filename,c.remotePath=e.body.url,c.secretKey=e.body.secret,c.fileLength=e.body.file_length,c.duration=e.body.length,c.thumbnailDisplayName=e.body.filename):e.isBuildCombinedMsg&&(c.displayName=e.filename,c.remotePath=e.url,c.secretKey=e.secret,c.fileLength=e.file_length,c.duration=e.length,c.thumbnailDisplayName=e.filename);break;case"file":c.type=5,e.body?(c.displayName=e.body.filename,c.remotePath=e.body.url,c.secretKey=e.body.secret,c.fileLength=e.body.file_length,c.thumbnailDisplayName=e.body.filename):e.isBuildCombinedMsg&&(c.displayName=e.filename,c.remotePath=e.url,c.secretKey=e.secret,c.fileLength=e.file_length,c.thumbnailDisplayName=e.filename);break;case"cmd":c.type=6,c.action=e.action;break;case"custom":c.type=7,c.customEvent=e.customEvent,c.customExts=ve.call(this,e.customExts);break;case"combine":c.type=0,c.subType=0,c.text=e.compatibleText,c.displayName=e.filename,c.remotePath=e.url,c.secretKey=e.secret,c.fileLength=e.file_length,c.title=e.title,c.summary=e.summary,c.combineLevel=e.combineLevel}var l=[];e.ext&&(l=ve.call(this,e.ext));var u=this.root.lookup("easemob.pb.MessageBody"),d=u.decode(o),p=e.from||this.context.jid.name;d.from={name:e.isBuildCombinedMsg?p:this.context.jid.name};var h=e.to.indexOf("/"),f=h>-1?e.to.substring(0,h):e.to;if(d.to={name:f},"channel"===e.type)d.type=L.CHANNEL_ACK;else if("recall"===e.type)d.type=L.RECALL,d.ackMessageId=e.ackId;else if("delivery"===e.type)d.type=L.DELIVER_ACK,d.ackMessageId=e.ackId;else if("read"===e.type)d.type=L.READ_ACK,d.ackMessageId=e.ackId,"groupChat"===i&&(d.msgConfig={allowGroupAck:!0},d.ackContent=e.ackContent);else if("chatRoom"===i)d.type=L.CHATROOM;else if("groupChat"===i){if(d.type=L.GROUPCHAT,e.msgConfig){var m=e.msgConfig.allowGroupAck;d.msgConfig={allowGroupAck:!!m}}}else"singleChat"===i&&(d.type=L.SINGLECHAT);e.editMessageId&&(d.type=L.EDIT,d.editMessageId=e.editMessageId),d.contents=[c],d.ext=l;var v=function(e){var t={};return"translations"in e&&(t.translations=e.translations),"isChatThread"in e&&e.isChatThread&&(t.thread={}),Object.keys(t).length>0?JSON.stringify(t):""}(e);v&&(d.meta=v),d=u.encode(d).finish();var g=this.root.lookup("easemob.pb.Meta"),E=g.decode(o);E.id=e.id;var y="easemob.com";if("chatRoom"!==i&&"groupChat"!==i||(y="conference.easemob.com"),E.to={appKey:this.appKey,name:f,domain:y},h>-1&&(E.to.clientResource=e.to.substring(h+1,e.to.length)),"chatRoom"===i&&(E.ext=ve.call(this,function(e){return{chatroom_msg_tag:"high"===e.priority?0:"low"===e.priority?2:1}}(e))),"recall"===e.type&&e.metaExt&&(E.ext=ve.call(this,{recallMessageExtensionInfo:e.metaExt})),E.ns=1,E.payload=d,E.routetype=e.deliverOnlineOnly?1:0,"singleChat"!==i&&Array.isArray(e.receiverList)&&(null===(r=e.receiverList)||void 0===r?void 0:r.length)>0&&(E.directedUsers=e.receiverList,E.routetype=2),e.isBuildCombinedMsg)return E.timestamp=a().fromValue(e.time),g.encode(E).finish();var _=this.root.lookup("easemob.pb.CommSyncUL"),b=_.decode(o);b.meta=E,ye.call(this,e,E),b=_.encode(b).finish();var T=this.root.lookup("easemob.pb.MSync"),S=T.decode(o);return S.version=this.version,S.encryptType=this.encryptType,S.command=0,S.payload=b,T.encode(S).finish()}e.fail&&e.fail({type:s.E.WEBIM_CONNCTION_CLIENT_OFFLINE,message:"Not logged in"})}function Ee(e){var t,n,r=this,o=j({},e);if(e.file)return o.accessToken=this.token,o.appKey=this.appKey,o.apiUrl=this.apiUrl,o.body&&o.body.url?ge.call(this,o):new Promise((function(t,n){var i=o.onFileUploadComplete;o.onFileUploadComplete=function(t){var n,a,s,c,l,u;if(t.entities[0]["file-metadata"]){var d=t.entities[0]["file-metadata"]["content-length"];o.file_length=d,o.filetype=t.entities[0]["file-metadata"]["content-type"],d>204800&&(o.thumbnail=!0)}var p="".concat(r.apiUrl,"/").concat(r.orgName,"/").concat(r.appName,"/chatfiles/").concat(t.entities[0].uuid);o.body={type:o.type||"file",secret:t.entities[0]["share-secret"],filename:o.file.filename||o.filename,url:p,length:o.length||0,filetype:o.filetype||o.file.filetype,file_length:(null===(a=null===(n=o.file)||void 0===n?void 0:n.data)||void 0===a?void 0:a.size)||0,size:{width:o.width||0,height:o.height||0}},o.file.url=t.uri,e.secret=t.entities[0]["share-secret"],t.url=e.url="".concat(p,"?em-redirect=true&share-secret=").concat(t.entities[0]["share-secret"]),e.file_length=o.file_length=(null===(c=null===(s=o.file)||void 0===s?void 0:s.data)||void 0===c?void 0:c.size)||0,"img"===o.type&&(e.thumb="".concat(e.url,"&thumbnail=true"),t.thumb="".concat(t.url,"&thumbnail=true")),"video"===o.type&&(e.thumb="".concat(e.url,"&vframe=true"),e.thumb_secret=t.entities[0]["share-secret"],t.thumb="".concat(t.url,"&vframe=true")),i instanceof Function&&i(t,o.id);var h=ge.call(r,o);P.TJ.size<=P.F3&&P.TJ.set(o.id,{rpt:r.dataReport.geOperateFun({operationName:D.fI.SEND_MSG})}),null===(u=null===(l=r._localCache)||void 0===l?void 0:l.getInstance())||void 0===u||u.storeMessage(e,w.r.INPROGRESS),Oe.call(r,h)},g.P6.uploadFile.call(r,o,D.fI.UPLOAD_MSG_ATTACH)}));if("combine"===e.type){o.accessToken=this.token,o.appKey=this.appKey,o.apiUrl=this.apiUrl;var i=o.onFileUploadComplete,a=o.onFileUploadError;return new Promise((function(t,n){var c,u,d,p;if((null===(c=e.messageList)||void 0===c?void 0:c.length)>300||0===(null===(u=e.messageList)||void 0===u?void 0:u.length))return r._msgHash[o.id].reject({type:s.E.MAX_LIMIT,message:"The number of combined messages exceeded the limit."});var h=V([],e.messageList,!0),f=0;if(h.forEach((function(e){(null==e?void 0:e.combineLevel)>f&&(f=null==e?void 0:e.combineLevel)})),o.combineLevel=f+1,o.combineLevel>10)return r._msgHash[o.id].reject({type:s.E.MAX_LIMIT,message:"The level of the merged message exceeded the limit."});var m=_e.call(r,h),v=function(t,n){var a,s,c,l,u,d,p="".concat(r.apiUrl,"/").concat(r.orgName,"/").concat(r.appName,"/chatfiles/").concat(t.entities[0].uuid),h=null===(a=t.entities[0])||void 0===a?void 0:a["share-secret"],f=p+"?em-redirect=true";h&&(f="".concat(f,"&share-secret=").concat(h)),i instanceof Function&&i({url:f,secret:h}),e.url=f,e.secret=h,o.url=f,o.secret=t.entities[0]["share-secret"],o.filename=(null===(s=o.file)||void 0===s?void 0:s.filename)||(null==n?void 0:n.fileName),o.file_length=(null===(l=null===(c=o.file)||void 0===c?void 0:c.data)||void 0===l?void 0:l.size)||(null==n?void 0:n.fileLength)||0,null===(d=null===(u=r._localCache)||void 0===u?void 0:u.getInstance())||void 0===d||d.storeMessage(e,w.r.INPROGRESS);var m=ge.call(r,o);Oe.call(r,m)},E=g.P6.getEnvInfo();if("web"!==E.platform&&"node"!==E.platform&&"quick_app"!==E.platform&&(null===(p=null===(d=E.global)||void 0===d?void 0:d.canIUse)||void 0===p?void 0:p.call(d,"getFileSystemManager"))){var y=E.global.getFileSystemManager(),_="".concat(r.apiUrl,"/").concat(r.orgName,"/").concat(r.appName,"/chatfiles");y.writeFile({filePath:"".concat(E.global.env.USER_DATA_PATH,"/combine"),data:m.buffer,encoding:"binary",success:function(e){E.global.uploadFile({url:_,filePath:"".concat(E.global.env.USER_DATA_PATH,"/combine"),name:"file",header:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+o.accessToken},success:function(e){if(200===e.statusCode){l.kg.debug("upload success",e);var t=JSON.parse(e.data);v(t,{fileName:"combine",fileLength:m.length})}else l.kg.debug("upload fail"),o.onFileUploadError instanceof Function&&o.onFileUploadError(e),this._msgHash[o.id].reject({type:s.E.WEBIM_UPLOADFILE_ERROR,message:"Failed to upload the merge message.Please try again",data:e})},fail:function(t){l.kg.debug("upload fail"),o.onFileUploadError instanceof Function&&o.onFileUploadError(e),this._msgHash[o.id].reject({type:s.E.WEBIM_UPLOADFILE_ERROR,message:"Failed to upload the merge message.Please try again",data:t})}})},fail:function(e){l.kg.debug("write file fail",e),this._msgHash[o.id].reject({type:s.E.WEBIM_UPLOADFILE_ERROR,message:"Failed to upload the merge message.Please try again",data:e})}})}else{var b=new File([m],"combine",{type:"application/octet-stream"}),T={url:URL.createObjectURL(b),filename:o.id,data:b};o.file=T,o.onFileUploadComplete=function(e){v(e)},o.onFileUploadError=function(e){a instanceof Function&&a(e),r._msgHash[o.id].reject({type:s.E.WEBIM_UPLOADFILE_ERROR,message:"Failed to upload the merge message.Please try again",data:e})},g.P6.uploadFile.call(r,o,D.fI.UPLOAD_MSG_ATTACH)}}))}"img"===e.type&&(o.body||(o.body=j(j({},o),{size:{width:o.width||0,height:o.height||0}}))),null===(n=null===(t=this._localCache)||void 0===t?void 0:t.getInstance())||void 0===n||n.storeMessage(e,w.r.INPROGRESS);var c=ge.call(this,o);Oe.call(this,c)}function ye(e,t){e.editMessageId||H.includes(e.type)&&(this._msgHash[e.id].thirdMessage=t)}function _e(e){for(var t=Uint8Array.from("cm",(function(e){return e.charCodeAt(0)})),n=0;n<e.length;n++){for(var r=e[n],o=j(j({},r),{isBuildCombinedMsg:!0}),i=this.mSync.encodeChatMsg.call(this,o),a=i.length,s=new Uint8Array(4),c=0;c<4;c++)s[c]=a>>8*(3-c)&255;l.kg.debug("message length:",s);var u=new Uint8Array(t.length+s.length+i.length);u.set(t),u.set(s,t.length),u.set(i,t.length+s.length),t=u}var d=new Uint8Array(t.length+1),p=0;for(n=2;n<t.length;n++)n%2==1&&(p^=t[n]);return d.set(t),l.kg.debug("checkResult:",p),d[t.length]=p,d}function be(e,t,n){var r=[],o=this.root.lookup("easemob.pb.MUCBody"),i=e.roomId,a=e.ext,s=void 0===a?"":a,c=e.leaveOtherRooms,l=void 0!==c&&c,u=o.decode(r);u.mucId={appKey:this.appKey,name:i,domain:"conference.easemob.com"},u.operation="join"===n?2:3,u.from={name:this.context.userId},u.isChatroom=!0,"join"===n&&(u.ext=s,u.leaveOtherRooms=l),u=o.encode(u).finish();var d=this.root.lookup("easemob.pb.Meta").decode(r);d.id=t,d.from={appKey:this.appKey,name:this.context.userId,domain:"easemob.com",client_resource:this.context.jid.clientResource},d.to={domain:"easemob.com"},d.ns=2,d.payload=u;var p=this.root.lookup("easemob.pb.CommSyncUL"),h=p.decode(r);h.meta=d,h=p.encode(h).finish();var f=this.root.lookup("easemob.pb.MSync"),m=f.decode(r);return m.version=this.version,m.encryptType=this.encryptType,m.command=0,m.payload=h,f.encode(m).finish()}function Te(e,t){var n=g.P6.getUniqueId(),r=be.call(this,e,n,t),o="join"===t?D.fI.JOIN_CHATROOM:D.fI.QUIT_CHATROOM,i=this.dataReport.geOperateFun({operationName:o});return P.iO.size<=P.F3&&P.iO.set(n,{rpt:i,requestName:o}),Oe.call(this,j(j({},e),{isHandleChatroom:!0,joinMsg:r,id:n,operation:t}),n)}function Se(e){var t=this;return new Promise((function(n,r){var o,i,a,c,u,d;if(l.kg.debug("call send"),t.logOut)return l.kg.debug("send message failed",s.E.WEBIM_CONNECTION_CLOSED),r({type:s.E.WEBIM_CONNECTION_CLOSED,message:"not login"});if(!e.id||"string"!=typeof e.id||""===e.id)return r({type:s.E.MESSAGE_PARAMETER_ERROR,message:'Missing required parameter: "id"'});if(!e.to||"string"!=typeof e.to||""===e.to)return r({type:s.E.MESSAGE_PARAMETER_ERROR,message:'Missing required parameter: "to"'});var p="file"===e.type||"img"===e.type||"audio"===e.type||"video"===e.type,h="delivery"===e.type||"read"===e.type||"channel"===e.type,f="cmd"===e.type,m="recall"===e.type,v=null==e?void 0:e.editMessageId,g=!(h||m||f||v);if(e.id){if(!p&&!h||p&&t.useOwnUploadFun){var E="recall"===e.type?D.fI.SEND_RECALL_MSG:D.fI.SEND_MSG;v&&(E=D.fI.MODIFY_MESSAGE),P.TJ.size<=P.F3&&P.TJ.set(e.id,{rpt:t.dataReport.geOperateFun({operationName:E})})}g&&(null===(i=null===(o=t._localCache)||void 0===o?void 0:o.getInstance())||void 0===i||i.storeMessage(e,w.r.CREATE)),t._msgHash[e.id]=j(j({},e),{resolve:n,reject:r})}if(p||"combine"===e.type)return Ee.call(t,e);if("txt"===e.type&&(null===(a=e.msgConfig)||void 0===a?void 0:a.languages)&&Array.isArray(null===(c=e.msgConfig)||void 0===c?void 0:c.languages)&&e.msgConfig.languages.length>0){var y=t.translateMessage||t.translation.translateMessage;if(!y)throw new Error("there is no method to translate message");y.call(t,{text:e.msg,languages:e.msgConfig.languages}).then((function(n){var r,o,i,a=null===(r=n.data[0])||void 0===r?void 0:r.translations;a=a.map((function(e){return{code:e.to,text:e.text}})),e.translations=a,t._msgHash[e.id].translations=a,null===(i=null===(o=t._localCache)||void 0===o?void 0:o.getInstance())||void 0===i||i.storeMessage(e,w.r.INPROGRESS);var s=ge.call(t,e);Oe.call(t,s,e.id)})).catch((function(e){r(e)}))}else{g&&(null===(d=null===(u=t._localCache)||void 0===u?void 0:u.getInstance())||void 0===d||d.storeMessage(e,w.r.INPROGRESS));var _=ge.call(t,e);Oe.call(t,_,e.id)}}))}function Oe(e,t){var n,r,o=this;if(e.isHandleChatroom){if(!this.isOpened()){var i={data:"",type:s.E.WEBIM_CONNCTION_DISCONNECTED,message:"websocket has been disconnected"};if(P.iO.has(e.id)){var a=P.iO.get(e.id);(0,a.rpt)({isEndApi:!0,data:{isSuccess:0,requestName:a.requestName,requestMethod:"WEBSOCKET",requestUrl:this.url,code:D.dd.disconnect,codeDesc:"websocket has been disconnected"}}),P.iO.delete(e.id)}return Promise.reject(i)}return new Promise((function(n,r){var i;o._msgHash[e.id]=j(j({},e),{resolve:n,reject:r}),i="miniCore"===o.name?e.joinMsg:q.call(o,e.joinMsg,t),o.sock.send(i)}))}if(!this.isOpened())return null===(n=this.unMSyncSendMsgMap)||void 0===n||n.set(t,e),!this.logOut&&this.autoReconnectNumTotal<this.autoReconnectNumMax&&(l.kg.debug("need to reconnect",this.autoReconnectNumTotal,this.autoReconnectNumMax),this.offLineSendConnecting=!0,this.reconnecting||this.reconnect()),void(this.onError&&this.onError({type:s.E.WEBIM_CONNCTION_DISCONNECTED,message:"websocket has been disconnected"}));r="miniCore"===this.name?e:q.call(this,e,t),this.sock.send(r)}var Re=function(e,t){return e.send=Se,e.sendMsg=Se,l.kg.debug("init Msync by ".concat(e.name)),{generateProvision:W.bind(e),base64transform:q.bind(e),distributeMeta:K.bind(e),decodeMeta:Y.bind(e),decodeUnreadDL:J.bind(e),_rebuild:Z.bind(e),_lastsession:ee.bind(e),receiveProvision:oe.bind(e),isInQueue:de.bind(e),decodeNotice:pe.bind(e),decodeMSync:he.bind(e),distributeMSync:fe.bind(e),encodeChatMsg:ge.bind(e),upLoadFile:Ee.bind(e),send:Se.bind(e),stopHeartBeat:le.bind(e),handleChatRoom:Te.bind(e)}}},7252:function(e,t){"use strict";var n=function(){function e(e){this.type=e.type,this.message=e.message,this.data=e.data}return e.create=function(t){return new e(t)},e}();t.Z=n},8161:function(e,t,n){"use strict";n.d(t,{t:function(){return g}}),n(9601),n(1539),n(8674),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948),n(7941),n(3710),n(9714),n(9653),n(6699),n(2023),n(2222),n(8309),n(9554),n(4747),n(2772);var r=n(3720),o=n.n(r),i=n(4363),a=n(4024),s=n(6424),c=n(9743),l=n(7360),u=n(2449),d=n(7288),p=function(){return p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},p.apply(this,arguments)},h=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},f=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},m={0:"TEXT",1:"IMAGE",2:"VIDEO",3:"LOCATION",4:"VOICE",5:"FILE",6:"COMMAND",7:"CUSTOM",8:"COMBINE"};function v(e){for(var t={},n=0;n<e.length;n++)if(8===e[n].type)t[e[n].key]=JSON.parse(e[n].stringValue);else if(7===e[n].type)t[e[n].key]=e[n].stringValue;else if(6===e[n].type)t[e[n].key]=e[n].doubleValue;else if(5===e[n].type)t[e[n].key]=e[n].floatValue;else if(1===e[n].type){var r=e[n].varintValue,i=new(o())(r.low,r.high,r.unsigned).toString();t[e[n].key]=0!==Number(i)}else 2!==e[n].type&&3!==e[n].type&&4!==e[n].type||(r=e[n].varintValue,i=new(o())(r.low,r.high,r.unsigned).toString(),t[e[n].key]=Number(i));return t}function g(e){var t="";return e.remotePath&&(t=a.P6.formatAttachUrl.call(this,e.remotePath),e.remotePath.includes("?em-redirect")||(t="".concat(t,"?em-redirect=true"),e.secretKey&&(t="".concat(t,"&share-secret=").concat(e.secretKey)))),t}function E(e,t){var n,r,o=t.from&&t.from.name;if(o===this.context.userId){var i=null===(n=null==e?void 0:e.from)||void 0===n?void 0:n.clientResource;o===(null===(r=null==t?void 0:t.to)||void 0===r?void 0:r.name)&&i&&i!==this.clientResource&&(o="".concat(o,"/").concat(i))}return o}function y(e,t){var n,r=t.to&&t.to.name;return(null===(n=null==e?void 0:e.to)||void 0===n?void 0:n.clientResource)&&(r="".concat(r,"/").concat(e.to.clientResource)),r}function _(e){var t,n,r,o,c,u,p,E,y,_,b,T,S,O,R,C,w,I,A,N,k,P,D,M,L,x,U;return h(this,void 0,void 0,(function(){var h,j,F,B,V,H,G,W,q,K,Y,z,X,J,Z,Q,$,ee,te,ne,re,oe,ie,ae,se,ce,le,ue,de,pe,he,fe,me,ve,ge,Ee,ye,_e,be,Te,Se,Oe,Re,Ce,we,Ie,Ae,Ne,ke,Pe,De,Me;return f(this,(function(f){switch(f.label){case 0:switch(h=e.status,j=e.thirdMessage,F=e.msgBody,B=e.msgId,V=e.type,H=e.from,G=e.to,W=e.time,q=e.onlineState,K=e.chatType,Y=e.ignoreCallback,z=e.priority,X=e.format,J=e.broadcast,Z=void 0!==J&&J,Q=e.isContentReplaced,$=void 0!==Q&&Q,ee={},te={},ne=h.errorCode>0,re=h.errorCode,oe=h.reason,ie={},ae=[],se=[],ce={},le="",ue=0,de=null,pe=null,j.ext&&(ie=v(j.ext)),j.meta&&"string"==typeof j.meta&&((fe=JSON.parse(j.meta)).reaction&&(ae=fe.reaction).forEach((function(e){e.isAddedBySelf=e.state,delete e.state})),fe.translations&&(se=fe.translations),fe.edit_msg&&(me=fe.edit_msg,ve=me.count,ge=me.operator,Ee=me.edit_time,ye=me.sender,_e=me.send_time,ce={operationTime:Ee,operatorId:ge,operationCount:ve},le=ye,ue=_e),fe.thread&&"{}"!==JSON.stringify(fe.thread)&&(de={messageId:fe.thread.msg_parent_id,parentId:fe.thread.muc_parent_id,chatThreadName:fe.thread.thread_name}),fe.thread_overview&&"{}"!==JSON.stringify(fe.thread_overview)&&(pe={id:fe.thread_overview.id,parentId:fe.thread_overview.muc_parent_id,name:fe.thread_overview.name,lastMessage:fe.thread_overview.last_message&&"{}"!==JSON.stringify(fe.thread_overview.last_message)?i.w.call(this,fe.thread_overview.last_message):null,createTimestamp:fe.thread_overview.create_timestamp,updateTimestamp:fe.thread_overview.update_timestamp,messageCount:fe.thread_overview.message_count||0})),F.type){case 0:return[3,1];case 1:return[3,7];case 2:return[3,10];case 3:return[3,13];case 4:return[3,16];case 5:return[3,19];case 6:return[3,22];case 7:return[3,23];case 8:return[3,26]}return[3,27];case 1:return Object.prototype.hasOwnProperty.call(F,"subType")&&0===F.subType?(he=g.call(this,F),be={id:B,type:"combine",chatType:K,to:G,from:H,ext:ie,time:Number(W),onlineState:q,title:F.title||"",summary:F.summary||"",url:he||"",secret:F.secretKey||"",file_length:F.fileLength||0,filename:F.displayName||"",compatibleText:F.text,combineLevel:F.combineLevel||0},ee.msgConfig&&(be.msgConfig=ee.msgConfig),ae.length>0&&(be.reactions=ae),de&&(be.chatThread=de),pe&&(be.chatThreadOverview=pe),"chatRoom"===K&&(be.priority=z,be.broadcast=Z),$&&(be.isContentReplaced=$),te=be,Y?[3,3]:[4,null===(n=null===(t=this._localCache)||void 0===t?void 0:t.getInstance())||void 0===n?void 0:n.storeMessage(be,d.r.SUCCESS)]):[3,4];case 2:f.sent(),null===(r=this.eventHandler)||void 0===r||r.dispatch("onCombineMessage",be),f.label=3;case 3:return[3,28];case 4:return!(ee={id:B,type:V,contentsType:m[F.type],from:H,to:G,data:F.text,ext:ie,sourceMsg:F.text,time:W,msgConfig:j.msgConfig,onlineState:q}).msgConfig&&delete j.msgConfig,ee.error=ne,ee.errorText=oe,ee.errorCode=re,!Y&&this.onTextMessage&&this.onTextMessage(ee),Te={id:B,type:"txt",chatType:K,msg:F.text,to:G,from:H,ext:ie,time:Number(W),onlineState:q},ee.msgConfig&&(Te.msgConfig=ee.msgConfig),ae.length>0&&(Te.reactions=ae),de&&(Te.chatThread=de),pe&&(Te.chatThreadOverview=pe),se.length>0&&(Te.translations=se),ce.operationCount>0&&(Te.modifiedInfo=ce,j.type===s.gA.EDIT&&(Te.from=le,Te.time=ue)),"chatRoom"===K&&(Te.priority=z,Te.broadcast=Z),$&&(Te.isContentReplaced=$),te=Te,Y?[3,6]:[4,null===(c=null===(o=this._localCache)||void 0===o?void 0:o.getInstance())||void 0===c?void 0:c.storeMessage(Te,d.r.SUCCESS)];case 5:f.sent(),null===(u=this.eventHandler)||void 0===u||u.dispatch("onTextMessage",Te),f.label=6;case 6:return[3,28];case 7:return Se=(null===(p=null==F?void 0:F.size)||void 0===p?void 0:p.width)||0,Oe=(null===(E=null==F?void 0:F.size)||void 0===E?void 0:E.height)||0,he=this.useOwnUploadFun?F.remotePath:g.call(this,F),!(ee={id:B,type:V,contentsType:m[F.type],from:H,to:G,url:he,secret:F.secretKey,filename:F.displayName,thumb:this.useOwnUploadFun?"":"".concat(he,"&thumbnail=true"),thumb_secret:F.secretKey,file_length:F.fileLength||"",width:Se,height:Oe,filetype:F.filetype||"",accessToken:this.token,ext:ie,time:W,msgConfig:j.msgConfig,onlineState:q}).delay&&delete ee.delay,!ee.msgConfig&&delete j.msgConfig,ee.error=ne,ee.errorText=oe,ee.errorCode=re,!Y&&this.onPictureMessage&&this.onPictureMessage(ee),Re={id:B,type:"img",chatType:K,from:H,to:G,url:he||"",width:Se,height:Oe,secret:F.secretKey||"",thumb:this.useOwnUploadFun?"":"".concat(he,"&thumbnail=true"),thumb_secret:F.secretKey,file_length:F.fileLength||0,ext:ie,time:Number(W),onlineState:q},ee.msgConfig&&(Re.msgConfig=ee.msgConfig),ae.length>0&&(Re.reactions=ae),de&&(Re.chatThread=de),pe&&(Re.chatThreadOverview=pe),"chatRoom"===K&&(Re.priority=z,Re.broadcast=Z),$&&(Re.isContentReplaced=$),te=Re,Y?[3,9]:[4,null===(_=null===(y=this._localCache)||void 0===y?void 0:y.getInstance())||void 0===_?void 0:_.storeMessage(Re,d.r.SUCCESS)];case 8:f.sent(),null===(b=this.eventHandler)||void 0===b||b.dispatch("onImageMessage",Re),f.label=9;case 9:return[3,28];case 10:return he=this.useOwnUploadFun?F.remotePath:g.call(this,F),!(ee={id:B,type:V,contentsType:m[F.type],from:H,to:G,url:he,secret:F.secretKey,filename:F.displayName,length:F.duration||"",file_length:F.fileLength||"",filetype:F.filetype||"",accessToken:this.token||"",ext:ie,time:W,msgConfig:j.msgConfig,onlineState:q}).delay&&delete ee.delay,!ee.msgConfig&&delete j.msgConfig,ee.error=ne,ee.errorText=oe,ee.errorCode=re,!Y&&this.onVideoMessage&&this.onVideoMessage(ee),Ce={id:B,type:"video",chatType:K,from:H,to:G,url:he,secret:F.secretKey,thumb:a.P6.formatAttachUrl.call(this,F.thumbnailRemotePath),thumb_secret:F.thumbnailSecretKey,filename:F.displayName,length:F.duration||0,file:{},file_length:F.fileLength||0,filetype:F.filetype||"",accessToken:this.token||"",ext:ie,time:Number(W),onlineState:q},ee.msgConfig&&(Ce.msgConfig=ee.msgConfig),ae.length>0&&(Ce.reactions=ae),de&&(Ce.chatThread=de),pe&&(Ce.chatThreadOverview=pe),"chatRoom"===K&&(Ce.priority=z,Ce.broadcast=Z),$&&(Ce.isContentReplaced=$),te=Ce,Y?[3,12]:[4,null===(S=null===(T=this._localCache)||void 0===T?void 0:T.getInstance())||void 0===S?void 0:S.storeMessage(Ce,d.r.SUCCESS)];case 11:f.sent(),null===(O=this.eventHandler)||void 0===O||O.dispatch("onVideoMessage",Ce),f.label=12;case 12:return[3,28];case 13:return!(ee={id:B,type:V,contentsType:m[F.type],from:H,to:G,addr:F.address,buildingName:F.buildingName,lat:F.latitude,lng:F.longitude,ext:ie,time:W,msgConfig:j.msgConfig,onlineState:q}).delay&&delete ee.delay,!ee.msgConfig&&delete j.msgConfig,ee.error=ne,ee.errorText=oe,ee.errorCode=re,!Y&&this.onLocationMessage&&this.onLocationMessage(ee),we={id:B,type:"loc",chatType:K,from:H,to:G,buildingName:F.buildingName,addr:F.address,lat:F.latitude,lng:F.longitude,ext:ie,time:Number(W),onlineState:q},ee.msgConfig&&(we.msgConfig=ee.msgConfig),ae.length>0&&(we.reactions=ae),de&&(we.chatThread=de),pe&&(we.chatThreadOverview=pe),"chatRoom"===K&&(we.priority=z,we.broadcast=Z),$&&(we.isContentReplaced=$),te=we,Y?[3,15]:[4,null===(C=null===(R=this._localCache)||void 0===R?void 0:R.getInstance())||void 0===C?void 0:C.storeMessage(we,d.r.SUCCESS)];case 14:f.sent(),null===(w=this.eventHandler)||void 0===w||w.dispatch("onLocationMessage",we),f.label=15;case 15:return[3,28];case 16:return he=this.useOwnUploadFun?F.remotePath:g.call(this,F),!(ee={id:B,type:V,contentsType:m[F.type],from:H,to:G,url:he,secret:F.secretKey,filename:F.displayName,file_length:F.fileLength||"",accessToken:this.token||"",ext:ie,length:F.duration,time:W,msgConfig:j.msgConfig,onlineState:q}).delay&&delete ee.delay,!ee.msgConfig&&delete j.msgConfig,ee.error=ne,ee.errorText=oe,ee.errorCode=re,!Y&&this.onAudioMessage&&this.onAudioMessage(ee),Ie={id:B,type:"audio",chatType:K,from:H,to:G,url:he,secret:F.secretKey,file:{},filename:F.displayName,length:F.duration||0,file_length:F.fileLength||0,filetype:F.filetype||"",accessToken:this.token||"",ext:ie,time:Number(W),onlineState:q},ee.msgConfig&&(Ie.msgConfig=ee.msgConfig),ae.length>0&&(Ie.reactions=ae),de&&(Ie.chatThread=de),pe&&(Ie.chatThreadOverview=pe),"chatRoom"===K&&(Ie.priority=z,Ie.broadcast=Z),$&&(Ie.isContentReplaced=$),te=Ie,Y?[3,18]:[4,null===(A=null===(I=this._localCache)||void 0===I?void 0:I.getInstance())||void 0===A?void 0:A.storeMessage(Ie,d.r.SUCCESS)];case 17:f.sent(),null===(N=this.eventHandler)||void 0===N||N.dispatch("onAudioMessage",Ie),f.label=18;case 18:return[3,28];case 19:return he=this.useOwnUploadFun?F.remotePath:g.call(this,F),!(ee={id:B,type:V,contentsType:m[F.type],from:H,to:G,url:he,secret:F.secretKey,filename:F.displayName,file_length:F.fileLength,accessToken:this.token||"",ext:ie,time:W,msgConfig:j.msgConfig,onlineState:q}).delay&&delete ee.delay,!ee.msgConfig&&delete j.msgConfig,ee.error=ne,ee.errorText=oe,ee.errorCode=re,!Y&&this.onFileMessage&&this.onFileMessage(ee),Ae={id:B,type:"file",chatType:K,from:H,to:G,url:he,secret:F.secretKey,file:{},filename:F.displayName,length:F.duration||0,file_length:F.fileLength||0,filetype:F.filetype||"",accessToken:this.token||"",ext:ie,time:Number(W),onlineState:q},ee.msgConfig&&(Ae.msgConfig=ee.msgConfig),ae.length>0&&(Ae.reactions=ae),de&&(Ae.chatThread=de),pe&&(Ae.chatThreadOverview=pe),"chatRoom"===K&&(Ae.priority=z,Ae.broadcast=Z),$&&(Ae.isContentReplaced=$),te=Ae,Y?[3,21]:[4,null===(P=null===(k=this._localCache)||void 0===k?void 0:k.getInstance())||void 0===P?void 0:P.storeMessage(Ae,d.r.SUCCESS)];case 20:f.sent(),null===(D=this.eventHandler)||void 0===D||D.dispatch("onFileMessage",Ae),f.label=21;case 21:return[3,28];case 22:return!(ee={id:B,type:V,contentsType:m[F.type],from:H,to:G,action:F.action,ext:ie,time:W,msgConfig:j.msgConfig,onlineState:q}).msgConfig&&delete j.msgConfig,ee.error=ne,ee.errorText=oe,ee.errorCode=re,!Y&&this.onCmdMessage&&this.onCmdMessage(ee),Ne={id:B,type:"cmd",chatType:K,from:H,to:G,action:F.action,ext:ie,time:Number(W),onlineState:q},ee.msgConfig&&(Ne.msgConfig=ee.msgConfig),ae.length>0&&(Ne.reactions=ae),de&&(Ne.chatThread=de),pe&&(Ne.chatThreadOverview=pe),"chatRoom"===K&&(Ne.priority=z,Ne.broadcast=Z),$&&(Ne.isContentReplaced=$),te=Ne,Y||null===(M=this.eventHandler)||void 0===M||M.dispatch("onCmdMessage",Ne),[3,28];case 23:return ke={},Pe={},j.contents[0].customExts&&(ke=v(j.contents[0].customExts)),j.contents[0].params&&(Pe=v(j.contents[0].params)),ee={id:B,type:V,contentsType:m[F.type],from:H,to:G,customEvent:F.customEvent,params:Pe,customExts:ke,ext:ie,time:W,onlineState:q},!Y&&this.onCustomMessage&&this.onCustomMessage(ee),De={id:B,type:"custom",chatType:K,from:H,to:G,customEvent:F.customEvent,params:Pe,customExts:ke,ext:ie,time:Number(W),onlineState:q},ee.msgConfig&&(De.msgConfig=ee.msgConfig),ae.length>0&&(De.reactions=ae),de&&(De.chatThread=de),pe&&(De.chatThreadOverview=pe),ce.operationCount>0&&(De.modifiedInfo=ce,j.type===s.gA.EDIT&&(De.from=le,De.time=ue)),"chatRoom"===K&&(De.priority=z,De.broadcast=Z),$&&(De.isContentReplaced=$),te=De,Y?[3,25]:[4,null===(x=null===(L=this._localCache)||void 0===L?void 0:L.getInstance())||void 0===x?void 0:x.storeMessage(De,d.r.SUCCESS)];case 24:f.sent(),null===(U=this.eventHandler)||void 0===U||U.dispatch("onCustomMessage",De),f.label=25;case 25:return[3,28];case 26:return he=g.call(this,F),Me={id:B,type:"combine",chatType:K,to:G,from:H,ext:ie,time:Number(W),onlineState:q,title:F.title||"",summary:F.summary||"",url:he||"",secret:F.secretKey||"",file_length:F.fileLength||0,filename:F.displayName||"",compatibleText:F.text,combineLevel:F.combineLevel||0},ee.msgConfig&&(Me.msgConfig=ee.msgConfig),ae.length>0&&(Me.reactions=ae),de&&(Me.chatThread=de),pe&&(Me.chatThreadOverview=pe),"chatRoom"===K&&(Me.priority=z,Me.broadcast=Z),$&&(Me.isContentReplaced=$),te=Me,!Y&&this.eventHandler&&this.eventHandler.dispatch("onCombineMessage",Me),[3,28];case 27:return l.kg.error("Unknow message type, message:",F),[3,28];case 28:return X?[2,te]:[2,ee]}}))}))}function b(e,t,n){if(this.delivery&&e!==t){var r=this.getUniqueId(),o=new u.Message("delivery",r);o.set({ackId:n,to:e}),l.kg.debug("send delivery ack"),this.send(o.body)}}t.Z=function(e,t,n,r,i){var u,d,m,g,T,S,O,R,C,w,I,A,N,k,P,D,M,L,x,U,j,F,B,V,H,G;return h(this,void 0,void 0,(function(){var h,W,q,K,Y,z,X,J,Z,Q,$,ee,te,ne,re,oe,ie,ae,se,ce,le,ue,de,pe,he,fe,me,ve,ge,Ee,ye,_e,be,Te,Se,Oe,Re,Ce,we,Ie;return f(this,(function(f){switch(f.label){case 0:if(h=new(o())(e.timestamp.low,e.timestamp.high,e.timestamp.unsigned).toString(),W=this.root.lookup("easemob.pb.MessageBody"),q=W.decode(e.payload),K=3,Y=!1,z=new(o())(e.id.low,e.id.high,e.id.unsigned).toString(),i&&e.from&&e.from.name===this.context.userId&&e.from.clientResource===this.clientResource&&q.type===s.gA.CHATROOM)return[2,l.kg.debug("Discard your own chat room message:",z)];if(e.meta&&e.meta.length){if(X=a.P6.parseNotify(e.meta),J=X.is_online,Z=X.callback_replace,this.useReplacedMessageContents&&Z&&(Y=!0),J||0===J)switch(J){case 0:K=0;break;case 1:K=1;break;default:K=2}}else K=3;switch(Q=q.ackMessageId?new(o())(q.ackMessageId.low,q.ackMessageId.high,q.ackMessageId.unsigned).toString():"",$="",ee=E.call(this,e,q),te=y.call(this,e,q),l.kg.debug("meta thirdMessage:",{metaId:z,metaNs:e.ns,type:q.type,from:ee,to:te,contentType:null===(d=null===(u=q.contents)||void 0===u?void 0:u[0])||void 0===d?void 0:d.type,contentLen:null===(m=q.contents)||void 0===m?void 0:m.length}),q.type){case s.gA.SINGLECHAT:return[3,1];case s.gA.GROUPCHAT:return[3,2];case s.gA.CHATROOM:return[3,3];case s.gA.READ_ACK:return[3,4];case s.gA.DELIVER_ACK:return[3,5];case s.gA.RECALL:return[3,6];case s.gA.CHANNEL_ACK:return[3,15];case s.gA.EDIT:return[3,16]}return[3,20];case 1:return $="chat","agoraToken"===this.grantType&&($="singleChat"),this.delivery&&!n&&ee!==this.context.userId&&b.call(this,ee,te,z),[3,21];case 2:return $="groupchat","agoraToken"===this.grantType&&($="groupChat"),[3,21];case 3:return $="chatroom","agoraToken"===this.grantType&&($="chatRoom"),K=1,[3,21];case 4:return $="read_ack",ne=void 0,q.ext[0]&&JSON.parse(q.ext[0].stringValue)?(ne={id:z,type:"read",from:ee,to:te,mid:Q,groupReadCount:q.ext[0]&&JSON.parse(q.ext[0].stringValue),ackContent:q.ackContent,onlineState:K},this.onReadMessage&&this.onReadMessage(ne),null===(g=this.eventHandler)||void 0===g||g.dispatch("onReadMessage",ne),[2]):(ne={id:z,type:"read",from:ee,to:te,mid:Q,onlineState:K},this.onReadMessage&&this.onReadMessage(ne),null===(T=this.eventHandler)||void 0===T||T.dispatch("onReadMessage",ne),[2]);case 5:return $="deliver_ack",this.onDeliveredMessage&&this.onDeliveredMessage({id:z,type:"delivery",from:ee,to:te,mid:Q,onlineState:K}),re={id:z,type:"delivery",from:ee,to:te,mid:Q,onlineState:K},null===(S=this.eventHandler)||void 0===S||S.dispatch("onDeliveredMessage",re),[2];case 6:return $="recall",oe="",e.ext&&(oe=(null===(O=v(e.ext))||void 0===O?void 0:O.recallMessageExtensionInfo)||""),ie={id:z,from:ee||"admin",to:te,mid:Q,ext:oe,onlineState:K},ae=te===this.user?ee:te,[4,null===(C=null===(R=this._localCache)||void 0===R?void 0:R.getInstance())||void 0===C?void 0:C.getMessageByServerMsgId(ie.mid)];case 7:return(se=f.sent())?[4,null===(I=null===(w=this._localCache)||void 0===w?void 0:w.getInstance())||void 0===I?void 0:I.removeMsgByServerMsgId(ie.mid)]:[3,9];case 8:f.sent(),f.label=9;case 9:return"singleChat"!==(null==se?void 0:se.chatType)&&"groupChat"!==(null==se?void 0:se.chatType)?[3,14]:(ce=(null==se?void 0:se.from)===this.user||""===(null==se?void 0:se.from),[4,null===(N=null===(A=this._localCache)||void 0===A?void 0:A.getInstance())||void 0===N?void 0:N.getConversationLastMessage(ae,se.chatType)]);case 10:return le=f.sent(),[4,null===(P=null===(k=this._localCache)||void 0===k?void 0:k.getInstance())||void 0===P?void 0:P.getConversationBySessionId((0,c.MQ)({conversationId:ae,conversationType:se.chatType}))];case 11:return(ue=f.sent())?[4,null===(M=null===(D=this._localCache)||void 0===D?void 0:D.getInstance())||void 0===M?void 0:M.updateLocalConversation((0,c.MQ)({conversationId:ae,conversationType:se.chatType}),{lastMessageId:null==le?void 0:le.serverMsgId,unReadCount:(0,c.E7)({conversation:ue,isRecallSelfMsg:ce,recalledMsgTime:se.time})})]:[3,13];case 12:f.sent(),f.label=13;case 13:f.label=14;case 14:return this.onRecallMessage&&this.onRecallMessage(ie),null===(L=this.eventHandler)||void 0===L||L.dispatch("onRecallMessage",ie),[2];case 15:return this.onChannelMessage&&this.onChannelMessage({id:z,type:"channel",chatType:"singleChat",from:ee,to:te,time:Number(h),onlineState:K}),de={id:z,type:"channel",chatType:"singleChat",from:ee,to:te,time:Number(h),onlineState:K},null===(x=this.eventHandler)||void 0===x||x.dispatch("onChannelMessage",de),[2];case 16:return pe={errorCode:0,reason:""},[4,_.call(this,{status:pe,thirdMessage:q,msgBody:q.contents[0],msgId:z,type:$,from:ee,to:te,time:h,onlineState:K,ignoreCallback:!0,format:!0,isContentReplaced:Y})];case 17:return he=f.sent(),fe=!!e.to&&-1!==e.to.domain.indexOf("conference"),he.chatType=fe?"groupChat":"singleChat",me=q.editMessageId&&new(o())(q.editMessageId.low,q.editMessageId.high,q.editMessageId.unsigned).toString(),ve={},"txt"===he.type?(ge=he.type,Ee=he.chatType,ye=he.to,_e=he.from,be=he.time,Te=he.modifiedInfo,ve={id:me,type:ge,chatType:Ee,to:ye,from:_e,time:be,modifiedInfo:Te,msg:he.msg},he.translations&&(ve.translations=he.translations)):"custom"===he.type&&((ve=he).id=me,delete ve.onlineState),ve?[4,null===(j=null===(U=this._localCache)||void 0===U?void 0:U.getInstance())||void 0===j?void 0:j.getMessageByServerMsgId(me)]:[3,19];case 18:"txt"===(null==(Se=f.sent())?void 0:Se.type)&&"txt"===ve.type?null===(B=null===(F=this._localCache)||void 0===F?void 0:F.getInstance())||void 0===B||B.putMessageToDB(p(p({},Se),{msg:ve.msg,modifiedInfo:ve.modifiedInfo,translations:ve.translations})):"custom"===(null==Se?void 0:Se.type)&&"custom"===ve.type&&(null===(H=null===(V=this._localCache)||void 0===V?void 0:V.getInstance())||void 0===H||H.putMessageToDB(p(p({},Se),{modifiedInfo:ve.modifiedInfo,customEvent:ve.customEvent,customExts:ve.customExts,ext:ve.ext}))),f.label=19;case 19:return"txt"!==he.type&&"custom"!==he.type||null===(G=this.eventHandler)||void 0===G||G.dispatch("onModifiedMessage",ve),[2];case 20:return l.kg.error("unexpected message type: ".concat(q.type)),[2];case 21:Oe="normal",Ce=!1,"chat"===$.toLowerCase()||"singleChat"===$?Re="singleChat":"groupchat"===$.toLowerCase()||"groupChat"===$?Re="groupChat":(Re="chatRoom",K=1,e.ext&&(we=v(e.ext),Ce=!!(null==we?void 0:we.is_broadcast),Oe=0===we.chatroom_msg_tag?"high":2===we.chatroom_msg_tag?"low":"normal")),Ie=0,f.label=22;case 22:return Ie<q.contents.length?[4,_.call(this,{status:t,thirdMessage:q,msgBody:q.contents[Ie],msgId:z,type:$,from:ee,to:te,time:h,onlineState:K,chatType:Re,ignoreCallback:n,priority:Oe,format:r,broadcast:Ce,isContentReplaced:Y})]:[3,25];case 23:return[2,f.sent()];case 24:return Ie++,[3,22];case 25:return[2]}}))}))}},7288:function(e,t,n){"use strict";var r;n.d(t,{r:function(){return r}}),function(e){e[e.CREATE=0]="CREATE",e[e.FAIL=1]="FAIL",e[e.INPROGRESS=2]="INPROGRESS",e[e.SUCCESS=3]="SUCCESS"}(r||(r={}))},9743:function(e,t,n){"use strict";n.d(t,{E7:function(){return o},MQ:function(){return r},un:function(){return i}}),n(2222);var r=function(e){return"".concat(e.conversationType,"-").concat(e.conversationId)},o=function(e){var t=e.isRecallSelfMsg,n=e.conversation,r=e.recalledMsgTime,o=n.unReadCount,i=void 0===o?0:o,a=n.unreadCountClearTimestamp;return t||(void 0===a?0:a)>r?i:i&&i>0?i-1:0},i=function(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n}},7360:function(e,t,n){"use strict";function r(){console.log&&(console.log.apply?console.log.apply(console,Array.prototype.slice.call(arguments)):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}n.d(t,{kg:function(){return h}}),n(1539),n(8674),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948),n(7042),n(2222),n(8309),n(9600),n(2564),n(285),n(1637),n(4812),n(3710),n(9554),n(2772),n(4916);var o="undefined"!=typeof window&&void 0!==window.navigator&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=n(4024);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}var s,c=function(){},l={};!function(e){e[e.TRACE=0]="TRACE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(s||(s={}));var u=function(){function e(e,t,n){this.name=e||"defaultLogger",this.currentLevel=0,this.useCookiePersist=!1,this.storageLogLevelKey="loglevel",this.levels=s,this.consoleLogVisibility=!0,this.logMethods=["trace","debug","info","warn","error"],this.methodFactory=n||this.defaultMethodFactory,this.report=!1;var r=this._getPersistedLevel();null==r&&(r=null===t?"WARN":t),this.logs=[],this.reportLogs=[],this.reportInterval=3e5,this.timer=null,this.config={useCache:!1,maxCache:3145728,color:"",background:""},this.logBytes=0,this.setLevel(r,!1,"")}return e.prototype.reportLog=function(){var e,t,n,r,o,a,s;return r=this,o=void 0,s=function(){var r,o,a,s,c,l,u,d;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(p){switch(p.label){case 0:if(0===(null===(e=this.reportLogs)||void 0===e?void 0:e.length))return[2];for(r=2097152,o=this.reportLogs.join("\n")+"\n",a=o.length,s=[];a>r;)s.push(o.substring(0,r)),a-=r,o=o.substring(r);s.push(o),c=0,l=s,p.label=1;case 1:if(!(c<l.length))return[3,8];if(u=l[c],this.reportLogs=[],!(null===(n=null===(t=this.connection)||void 0===t?void 0:t.context)||void 0===n?void 0:n.accessToken))return[2];p.label=2;case 2:return p.trys.push([2,4,,5]),[4,this.reportData(u)];case 3:return"ok"!==(null==(d=p.sent())?void 0:d.status)&&this.reportLogs.unshift(u),[3,5];case 4:return p.sent(),this.reportLogs.unshift(u),[3,5];case 5:return[4,i.P6.delay(3e3)];case 6:p.sent(),p.label=7;case 7:return c++,[3,1];case 8:return[2]}}))},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{c(s.next(e))}catch(e){t(e)}}function i(e){try{c(s.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof a?r:new a((function(e){e(r)}))).then(n,i)}c((s=s.apply(r,o||[])).next())}))},e.prototype.reportData=function(e){var t,n=this;if(this.connection){var r=this.connection.context||{},o=r.orgName,a=r.appName,s=r.accessToken,c=r.userId,l={url:"".concat(null===(t=this.connection)||void 0===t?void 0:t.apiUrl,"/").concat(o,"/").concat(a,"/sdk/users/").concat(c,"/client/logs"),type:"POST",data:JSON.stringify({resource:this.connection.clientResource,logContent:e}),dataType:"json",headers:{Authorization:"Bearer "+s,"Content-Type":"application/json"}};return i.hj.call(this.connection,l).then((function(e){return n.log("report log success",e),e})).catch((function(e){n.error("report log error",e)}))}this.error("report log error","connection is null")},e.prototype._regularlyReportLogs=function(){var e,t=this;this.timer&&clearInterval(this.timer),(null!==(e=this.reportInterval)&&void 0!==e?e:0)<6e4&&(this.reportInterval=6e4),this.timer=setInterval((function(){t.reportLog()}),this.reportInterval||3e5)},e.prototype._stopReportLogs=function(){this.reportLog(),clearInterval(this.timer)},e.prototype.setConfig=function(e){this.config=e},e.prototype.getLevel=function(){return this.currentLevel},e.prototype.setLevel=function(e,t,n){if("string"==typeof e&&(e=s[e]),void 0===e&&(e=0),!("number"==typeof e&&e>=0&&e<=this.levels.SILENT))throw Error("log.setLevel() called with invalid level: "+e);if(this.currentLevel=e,!1!==t&&this._persistLevel(e),this.replaceLoggingMethods(e,n||""),"undefined"==typeof console&&e<s.SILENT)throw Error("No console available for logging")},e.prototype.setDefaultLevel=function(e){this._getPersistedLevel()||this.setLevel(e,!1,"")},e.prototype.enableAll=function(e){this.setLevel(this.levels.TRACE,!0,"")},e.prototype.disableAll=function(e){this.setLevel(this.levels.SILENT,!0,"")},e.prototype.getLogs=function(){return this.logs},e.prototype.download=function(){if("undefined"!=typeof window&&"undefined"!=typeof document){var e=this.getLogs().join("\n"),t=new Blob([e],{type:"text/plain;charset=UTF-8"}),n=window.URL.createObjectURL(t),r=document.createElement("a");r.style.display="none",r.href=n,r.setAttribute("download","sdklog"),document.body.appendChild(r),r.click()}},e.prototype.setConsoleLogVisibility=function(e){this.consoleLogVisibility=e},e.prototype._bindMethod=function(e,t,n){var r=this,o=e[t],i=this.getTime();if(n)return this._cacheLog;if("function"==typeof o.bind)return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=r.getTime();r.consoleLogVisibility&&o.call.apply(o,function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([e,"".concat(a," IM SDK [").concat("log"===t?"debug":t,"]: ")],n,!1)),r.onLog&&r.onLog({time:a,level:"log"===t?"debug":t,logs:n}),r._cacheReportLogs.apply(r,n)};try{return Function.prototype.bind.call(o,e,"".concat(i," IM SDK [").concat("log"===t?"debug":t,"]: "))}catch(t){return function(){return Function.prototype.apply.apply(o,[e,arguments])}}},e.prototype.getTime=function(){var e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()},e.prototype._cacheLog=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(new Date).toLocaleString()+": ",r="";e.forEach((function(e){"object"===a(e)?r+=JSON.stringify(e)+" ":r+=e+" "})),this._cacheLogCall(n+r),this._cacheReportLogs.apply(this,e)},e.prototype._cacheLogCall=function(e){var t=e.length,n=this.logBytes+t,r=this.config.maxCache;if(!(t>=r)){if(n<r)this.logBytes+=t;else for(var o=n-r,i=0;i<o;){var a=this.logs.shift();void 0!==a&&(i+=a.length)}this.logs.push(e)}},e.prototype._cacheReportLogs=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.report){var n=(new Date).toLocaleString()+": ",r="";e.forEach((function(e){"object"===a(e)?r+=JSON.stringify(e)+" ":r+=e+" "})),this.reportLogs.push(n+r)}},e.prototype._getPersistedLevel=function(){var e;if("undefined"==typeof window)return 5;if("undefined"===(e=window&&window.localStorage&&window.localStorage[this.storageLogLevelKey])){var t=window.document.cookie,n=t.indexOf(encodeURIComponent(this.storageLogLevelKey));-1!==n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}return e||5},e.prototype._persistLevel=function(e){var t=this.logMethods[e]||"SILENT";"undefined"!=typeof window&&(window.localStorage&&(window.localStorage[this.storageLogLevelKey]=t),this.useCookiePersist&&(window.document.cookie=encodeURIComponent(this.storageLogLevelKey)+"="+t+";"))},e.prototype.replaceLoggingMethods=function(e,t){for(var n=this,r=0;r<this.logMethods.length;r++){var o=this.logMethods[r];this[o]=r<e?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.report&&n._cacheReportLogs.apply(n,e)}:this.methodFactory(o,e,t)}this.log=this.debug},e.prototype.defaultMethodFactory=function(e,t,n){return this.realMethod(e)||this.enableLoggingWhenConsoleArrives.apply(this,[e,t,n])},e.prototype.realMethod=function(e){return"debug"===e&&(e="log"),"undefined"!=typeof console&&("trace"===e&&o?r:void 0!==console[e]?this._bindMethod(console,e,this.config.useCache):void 0!==console.log?this._bindMethod(console,"log",this.config.useCache):c)},e.prototype.enableLoggingWhenConsoleArrives=function(e,t,n){return function(){"undefined"!=typeof console&&(this.replaceLoggingMethods.call(this,t,n),this[e].apply(this,arguments))}.bind(this)},e}(),d=new u;d.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");return this};var p="undefined"!=typeof window?window.log:void 0;d.noConflict=function(){return"undefined"!=typeof window&&window.log===d&&(window.log=p),d},d.getLoggers=function(){return l},d.initReport=function(e){var t=e.report,n=e.reportInterval,r=e.connection;d.report=t,d.reportInterval=n,d.connection=r,t&&d._regularlyReportLogs()};var h=d},2449:function(e,t,n){"use strict";n.d(t,{Message:function(){return v}});var r=n(4024),o=function(){function e(e){var t=e.id;this.id=t,this.type=e.type}return e.prototype.set=function(e){this.body={id:this.id,ackId:e.id,type:"read",to:e.to,from:e.from||"",chatType:e.chatType}},e.create=function(e){return{id:r.P6.getUniqueId(),chatType:e.chatType,ackId:e.id,type:"read",to:e.to,from:e.from||"",ackContent:e.ackContent,isChatThread:e.isChatThread,priority:e.priority,deliverOnlineOnly:e.deliverOnlineOnly}},e}(),i=function(){function e(e){this.id=e.id,this.type=e.type}return e.prototype.set=function(e){this.body={id:this.id,ackId:e.ackId,type:"delivery",to:e.to,from:e.from||""}},e.create=function(e){return{id:r.P6.getUniqueId(),ackId:e.ackId,type:"delivery",to:e.to,from:e.from||"",isChatThread:e.isChatThread,priority:e.priority,deliverOnlineOnly:e.deliverOnlineOnly}},e}(),a=(n(3843),n(3710),function(){function e(e){var t=e.type,n=e.id;this.id=n,this.type=t}return e.prototype.set=function(e){this.body={id:this.id,chatType:e.chatType||"singleChat",type:"channel",to:e.to,from:e.from||"",time:Date.now()}},e.prototype.setChatType=function(e){return!!this.body&&(this.body.chatType=e,!0)},e.prototype.setGroup=function(e){return!!this.body&&(this.body.group=e,!0)},e.create=function(e){return{id:r.P6.getUniqueId(),type:"channel",chatType:e.chatType||"singleChat",to:e.to,from:e.from||"",time:Date.now(),isChatThread:e.isChatThread,priority:e.priority,deliverOnlineOnly:e.deliverOnlineOnly}},e}()),s=(n(9753),function(){function e(e){var t=e.type,n=e.id||r.P6.getUniqueId();this.id=n,this.type=t,this.value=""}return e.prototype.set=function(e){this.body={id:this.id,chatType:e.chatType||"singleChat",type:"txt",to:e.to,msg:e.msg,from:e.from,roomType:e.roomType,success:e.success,fail:e.fail,ext:e.ext,time:Date.now(),isChatThread:e.isChatThread},this.value=e.msg},e.prototype.setChatType=function(e){return!!this.body&&(this.body.chatType=e,!0)},e.prototype.setGroup=function(e){return!!this.body&&(this.body.group=e,!0)},e.create=function(e){var t,n;return(null===(t=e.msgConfig)||void 0===t?void 0:t.languages)&&Array.isArray(null===(n=e.msgConfig)||void 0===n?void 0:n.languages),{type:"txt",id:r.P6.getUniqueId(),msg:e.msg,to:e.to,from:e.from||"",chatType:e.chatType,ext:e.ext,time:Date.now(),msgConfig:e.msgConfig,isChatThread:e.isChatThread,priority:e.priority,deliverOnlineOnly:e.deliverOnlineOnly,receiverList:e.receiverList}},e}()),c=function(){function e(e){var t=e.type,n=e.id;this.id=n||r.P6.getUniqueId(),this.type=t}return e.prototype.set=function(e){this.body={id:this.id,chatType:e.chatType||"singleChat",type:"cmd",to:e.to,action:e.action,from:e.from,roomType:e.roomType,success:e.success,fail:e.fail,ext:e.ext,time:Date.now()}},e.prototype.setChatType=function(e){return!!this.body&&(this.body.chatType=e,!0)},e.prototype.setGroup=function(e){return!!this.body&&(this.body.group=e,!0)},e.create=function(e){return{id:r.P6.getUniqueId(),type:"cmd",to:e.to,from:e.from||"",chatType:e.chatType||"singleChat",action:e.action,time:Date.now(),ext:e.ext,msgConfig:e.msgConfig,isChatThread:e.isChatThread,priority:e.priority,deliverOnlineOnly:e.deliverOnlineOnly,receiverList:e.receiverList}},e}(),l=function(){function e(e){var t=e.type,n=e.id||r.P6.getUniqueId();this.id=n,this.type=t}return e.prototype.set=function(e){this.body={id:this.id,chatType:e.chatType||"singleChat",type:"custom",to:e.to,customEvent:e.customEvent,customExts:e.customExts,from:e.from,roomType:e.roomType,success:e.success,fail:e.fail,ext:e.ext,time:Date.now()}},e.prototype.setChatType=function(e){return!!this.body&&(this.body.chatType=e,!0)},e.prototype.setGroup=function(e){return!!this.body&&(this.body.group=e,!0)},e.create=function(e){return{id:r.P6.getUniqueId(),chatType:e.chatType||"singleChat",type:"custom",to:e.to,customEvent:e.customEvent,customExts:e.customExts,from:e.from||"",ext:e.ext,time:Date.now(),msgConfig:e.msgConfig,isChatThread:e.isChatThread,priority:e.priority,deliverOnlineOnly:e.deliverOnlineOnly,receiverList:e.receiverList}},e}(),u=function(){function e(e){var t=e.type,n=e.id;this.id=n||r.P6.getUniqueId(),this.type=t}return e.prototype.set=function(e){this.body={id:this.id,chatType:e.chatType||"singleChat",type:"loc",to:e.to,addr:e.addr,buildingName:e.buildingName,lat:e.lat,lng:e.lng,from:e.from,roomType:e.roomType,success:e.success,fail:e.fail,ext:e.ext,time:Date.now()}},e.prototype.setChatType=function(e){return!!this.body&&(this.body.chatType=e,!0)},e.prototype.setGroup=function(e){return!!this.body&&(this.body.group=e,!0)},e.create=function(e){return{id:r.P6.getUniqueId(),chatType:e.chatType||"singleChat",type:"loc",to:e.to,addr:e.addr,buildingName:e.buildingName,lat:e.lat,lng:e.lng,from:e.from||"",ext:e.ext,time:Date.now(),msgConfig:e.msgConfig,isChatThread:e.isChatThread,priority:e.priority,deliverOnlineOnly:e.deliverOnlineOnly,receiverList:e.receiverList}},e}(),d=function(){function e(e){var t=e.type,n=e.id||r.P6.getUniqueId();this.id=n,this.type=t}return e.prototype.set=function(e){e.file=e.file||e.fileInputId&&r.P6.getFileUrl(e.fileInputId),this.body={id:this.id,chatType:e.chatType||"singleChat",type:"img",file:e.file,width:e.width,height:e.height,to:e.to,from:e.from||"",roomType:e.roomType,success:e.success,fail:e.fail,ext:e.ext,time:Date.now(),onFileUploadError:e.onFileUploadError,onFileUploadComplete:e.onFileUploadComplete,onFileUploadProgress:e.onFileUploadProgress,body:e.body,isChatThread:e.isChatThread}},e.prototype.setChatType=function(e){return!!this.body&&(this.body.chatType=e,!0)},e.prototype.setGroup=function(e){return!!this.body&&(this.body.group=e,!0)},e.create=function(e){return{id:r.P6.getUniqueId(),chatType:e.chatType,type:"img",url:e.url,width:e.width,height:e.height,file:e.file,to:e.to,from:e.from||"",ext:e.ext,time:Date.now(),msgConfig:e.msgConfig,file_length:e.file_length,onFileUploadError:e.onFileUploadError,onFileUploadComplete:e.onFileUploadComplete,onFileUploadProgress:e.onFileUploadProgress,isChatThread:e.isChatThread,priority:e.priority,deliverOnlineOnly:e.deliverOnlineOnly,receiverList:e.receiverList,thumbnailWidth:e.thumbnailWidth,thumbnailHeight:e.thumbnailHeight}},e}(),p=function(){function e(e){var t=e.type,n=e.id||r.P6.getUniqueId();this.id=n,this.type=t}return e.prototype.set=function(e){e.file=e.file||e.fileInputId&&r.P6.getFileUrl(e.fileInputId),this.body={id:this.id,chatType:e.chatType||"singleChat",type:"audio",file:e.file,filename:e.filename,length:e.length,file_length:e.file_length,fileInputId:e.fileInputId,to:e.to,from:e.from,roomType:e.roomType,success:e.success,fail:e.fail,ext:e.ext,time:Date.now(),onFileUploadError:e.onFileUploadError,onFileUploadComplete:e.onFileUploadComplete,onFileUploadProgress:e.onFileUploadProgress,body:e.body,isChatThread:e.isChatThread}},e.prototype.setChatType=function(e){return!!this.body&&(this.body.chatType=e,!0)},e.prototype.setGroup=function(e){return!!this.body&&(this.body.group=e,!0)},e.create=function(e){return{id:r.P6.getUniqueId(),chatType:e.chatType,type:"audio",filename:e.filename,length:e.length,file:e.file,to:e.to,from:e.from||"",ext:e.ext,time:Date.now(),onFileUploadError:e.onFileUploadError,onFileUploadComplete:e.onFileUploadComplete,onFileUploadProgress:e.onFileUploadProgress,body:e.body,file_length:e.file_length,msgConfig:e.msgConfig,isChatThread:e.isChatThread,priority:e.priority,deliverOnlineOnly:e.deliverOnlineOnly,receiverList:e.receiverList}},e}(),h=function(){function e(e){var t=e.type,n=e.id;this.id=n,this.type=t}return e.prototype.set=function(e){e.file=e.file||e.fileInputId&&r.P6.getFileUrl(e.fileInputId),this.body={id:this.id,chatType:e.chatType||"singleChat",type:"video",file:e.file,filename:e.filename,length:e.length,file_length:e.file_length,fileInputId:e.fileInputId,to:e.to,from:e.from,roomType:e.roomType,success:e.success,fail:e.fail,ext:e.ext,time:Date.now(),apiUrl:e.apiUrl,onFileUploadError:e.onFileUploadError,onFileUploadComplete:e.onFileUploadComplete,onFileUploadProgress:e.onFileUploadProgress,body:e.body,isChatThread:e.isChatThread}},e.prototype.setChatType=function(e){return!!this.body&&(this.body.chatType=e,!0)},e.prototype.setGroup=function(e){return!!this.body&&(this.body.group=e,!0)},e.create=function(e){return{id:r.P6.getUniqueId(),chatType:e.chatType||"singleChat",type:"video",file:e.file,filename:e.filename,length:e.length,file_length:e.file_length,fileInputId:e.fileInputId,to:e.to,from:e.from||"",ext:e.ext,time:Date.now(),onFileUploadError:e.onFileUploadError,onFileUploadComplete:e.onFileUploadComplete,onFileUploadProgress:e.onFileUploadProgress,body:e.body,msgConfig:e.msgConfig,isChatThread:e.isChatThread,priority:e.priority,deliverOnlineOnly:e.deliverOnlineOnly,receiverList:e.receiverList}},e}(),f=function(){function e(e){var t=e.type,n=e.id;this.id=n,this.type=t}return e.prototype.set=function(e){e.file=e.file||e.fileInputId&&r.P6.getFileUrl(e.fileInputId),this.body={id:this.id,chatType:e.chatType||"singleChat",type:"file",file:e.file,filename:e.filename,fileInputId:e.fileInputId,to:e.to,from:e.from,roomType:e.roomType,success:e.success,fail:e.fail,ext:e.ext,time:Date.now(),onFileUploadError:e.onFileUploadError,onFileUploadComplete:e.onFileUploadComplete,onFileUploadProgress:e.onFileUploadProgress,body:e.body,isChatThread:e.isChatThread}},e.prototype.setChatType=function(e){return!!this.body&&(this.body.chatType=e,!0)},e.prototype.setGroup=function(e){return!!this.body&&(this.body.group=e,!0)},e.create=function(e){return{id:r.P6.getUniqueId(),chatType:e.chatType||"singleChat",type:"file",file:e.file,filename:e.filename,fileInputId:e.fileInputId,file_length:e.file_length,to:e.to,from:e.from||"",ext:e.ext,onFileUploadError:e.onFileUploadError,onFileUploadComplete:e.onFileUploadComplete,onFileUploadProgress:e.onFileUploadProgress,body:e.body,time:Date.now(),msgConfig:e.msgConfig,isChatThread:e.isChatThread,priority:e.priority,deliverOnlineOnly:e.deliverOnlineOnly,receiverList:e.receiverList}},e}(),m=function(){function e(e){var t=e.type,n=e.id||r.P6.getUniqueId();this.id=n,this.type=t,this.value=""}return e.create=function(e){return{type:"combine",id:r.P6.getUniqueId(),to:e.to,from:e.from||"",chatType:e.chatType,ext:e.ext,time:Date.now(),msgConfig:e.msgConfig,isChatThread:e.isChatThread,priority:e.priority,deliverOnlineOnly:e.deliverOnlineOnly,receiverList:e.receiverList,compatibleText:e.compatibleText,title:e.title,summary:e.summary,messageList:e.messageList,onFileUploadError:e.onFileUploadError,onFileUploadComplete:e.onFileUploadComplete}},e}(),v=function(){function e(t,n){return this.type=t,this.id=n||r.P6.getUniqueId(),e.createOldMsg({type:t,id:this.id})}return e.createOldMsg=function(e){switch(e.type){case"read":return new o({type:"read",id:e.id});case"delivery":return new i({type:"delivery",id:e.id});case"channel":return new a({type:"channel",id:e.id});case"txt":return new s({type:"txt",id:e.id});case"cmd":return new c({type:"cmd",id:e.id});case"custom":return new l({type:"custom",id:e.id});case"loc":return new u({type:"loc",id:e.id});case"img":return new d({type:"img",id:e.id});case"audio":return new p({type:"audio",id:e.id});case"video":return new h({type:"video",id:e.id});case"file":return new f({type:"file",id:e.id})}},e.create=function(e){return"txt"!==(t=e).type||"version"in t?function(e){return"img"===e.type&&!("version"in e)}(e)?d.create(e):function(e){return"cmd"===e.type&&!("version"in e)}(e)?c.create(e):function(e){return"file"===e.type&&!("version"in e)}(e)?f.create(e):function(e){return"audio"===e.type&&!("version"in e)}(e)?p.create(e):function(e){return"video"===e.type&&!("version"in e)}(e)?h.create(e):function(e){return"custom"===e.type&&!("version"in e)}(e)?l.create(e):function(e){return"loc"===e.type&&!("version"in e)}(e)?u.create(e):function(e){return"channel"===e.type&&!("version"in e)}(e)?a.create(e):function(e){return"delivery"===e.type&&!("version"in e)}(e)?i.create(e):function(e){return"read"===e.type&&!("version"in e)}(e)?o.create(e):function(e){return"combine"===e.type&&!("version"in e)}(e)?m.create(e):{}:s.create(e);var t},e.prototype.set=function(e){},e.getFileUrl=r.P6.getFileUrl,e}()},5531:function(e,t,n){"use strict";var r;n.d(t,{E:function(){return r}}),function(e){e[e.REQUEST_SUCCESS=0]="REQUEST_SUCCESS",e[e.REQUEST_TIMEOUT=-1]="REQUEST_TIMEOUT",e[e.REQUEST_UNKNOWN=-2]="REQUEST_UNKNOWN",e[e.REQUEST_PARAMETER_ERROR=-3]="REQUEST_PARAMETER_ERROR",e[e.REQUEST_ABORT=-4]="REQUEST_ABORT",e[e.WEBIM_CONNCTION_USER_NOT_ASSIGN_ERROR=0]="WEBIM_CONNCTION_USER_NOT_ASSIGN_ERROR",e[e.WEBIM_CONNCTION_OPEN_ERROR=1]="WEBIM_CONNCTION_OPEN_ERROR",e[e.WEBIM_CONNCTION_AUTH_ERROR=2]="WEBIM_CONNCTION_AUTH_ERROR",e[e.WEBIM_CONNCTION_OPEN_USERGRID_ERROR=3]="WEBIM_CONNCTION_OPEN_USERGRID_ERROR",e[e.WEBIM_CONNCTION_ATTACH_ERROR=4]="WEBIM_CONNCTION_ATTACH_ERROR",e[e.WEBIM_CONNCTION_ATTACH_USERGRID_ERROR=5]="WEBIM_CONNCTION_ATTACH_USERGRID_ERROR",e[e.WEBIM_CONNCTION_REOPEN_ERROR=6]="WEBIM_CONNCTION_REOPEN_ERROR",e[e.WEBIM_CONNCTION_SERVER_CLOSE_ERROR=7]="WEBIM_CONNCTION_SERVER_CLOSE_ERROR",e[e.WEBIM_CONNCTION_SERVER_ERROR=8]="WEBIM_CONNCTION_SERVER_ERROR",e[e.WEBIM_CONNCTION_IQ_ERROR=9]="WEBIM_CONNCTION_IQ_ERROR",e[e.WEBIM_CONNCTION_PING_ERROR=10]="WEBIM_CONNCTION_PING_ERROR",e[e.WEBIM_CONNCTION_NOTIFYVERSION_ERROR=11]="WEBIM_CONNCTION_NOTIFYVERSION_ERROR",e[e.WEBIM_CONNCTION_GETROSTER_ERROR=12]="WEBIM_CONNCTION_GETROSTER_ERROR",e[e.WEBIM_CONNCTION_CROSSDOMAIN_ERROR=13]="WEBIM_CONNCTION_CROSSDOMAIN_ERROR",e[e.WEBIM_CONNCTION_LISTENING_OUTOF_MAXRETRIES=14]="WEBIM_CONNCTION_LISTENING_OUTOF_MAXRETRIES",e[e.WEBIM_CONNCTION_RECEIVEMSG_CONTENTERROR=15]="WEBIM_CONNCTION_RECEIVEMSG_CONTENTERROR",e[e.WEBIM_CONNCTION_DISCONNECTED=16]="WEBIM_CONNCTION_DISCONNECTED",e[e.WEBIM_CONNCTION_AJAX_ERROR=17]="WEBIM_CONNCTION_AJAX_ERROR",e[e.WEBIM_CONNCTION_JOINROOM_ERROR=18]="WEBIM_CONNCTION_JOINROOM_ERROR",e[e.WEBIM_CONNCTION_GETROOM_ERROR=19]="WEBIM_CONNCTION_GETROOM_ERROR",e[e.WEBIM_CONNCTION_GETROOMINFO_ERROR=20]="WEBIM_CONNCTION_GETROOMINFO_ERROR",e[e.WEBIM_CONNCTION_GETROOMMEMBER_ERROR=21]="WEBIM_CONNCTION_GETROOMMEMBER_ERROR",e[e.WEBIM_CONNCTION_GETROOMOCCUPANTS_ERROR=22]="WEBIM_CONNCTION_GETROOMOCCUPANTS_ERROR",e[e.WEBIM_CONNCTION_LOAD_CHATROOM_ERROR=23]="WEBIM_CONNCTION_LOAD_CHATROOM_ERROR",e[e.WEBIM_CONNCTION_NOT_SUPPORT_CHATROOM_ERROR=24]="WEBIM_CONNCTION_NOT_SUPPORT_CHATROOM_ERROR",e[e.WEBIM_CONNCTION_JOINCHATROOM_ERROR=25]="WEBIM_CONNCTION_JOINCHATROOM_ERROR",e[e.WEBIM_CONNCTION_QUITCHATROOM_ERROR=26]="WEBIM_CONNCTION_QUITCHATROOM_ERROR",e[e.WEBIM_CONNCTION_APPKEY_NOT_ASSIGN_ERROR=27]="WEBIM_CONNCTION_APPKEY_NOT_ASSIGN_ERROR",e[e.WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR=28]="WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR",e[e.WEBIM_CONNCTION_SESSIONID_NOT_ASSIGN_ERROR=29]="WEBIM_CONNCTION_SESSIONID_NOT_ASSIGN_ERROR",e[e.WEBIM_CONNCTION_RID_NOT_ASSIGN_ERROR=30]="WEBIM_CONNCTION_RID_NOT_ASSIGN_ERROR",e[e.WEBIM_CONNCTION_CALLBACK_INNER_ERROR=31]="WEBIM_CONNCTION_CALLBACK_INNER_ERROR",e[e.WEBIM_CONNCTION_CLIENT_OFFLINE=32]="WEBIM_CONNCTION_CLIENT_OFFLINE",e[e.WEBIM_CONNCTION_CLIENT_LOGOUT=33]="WEBIM_CONNCTION_CLIENT_LOGOUT",e[e.WEBIM_CONNCTION_CLIENT_TOO_MUCH_ERROR=34]="WEBIM_CONNCTION_CLIENT_TOO_MUCH_ERROR",e[e.WEBIM_CONNECTION_ACCEPT_INVITATION_FROM_GROUP=35]="WEBIM_CONNECTION_ACCEPT_INVITATION_FROM_GROUP",e[e.WEBIM_CONNECTION_DECLINE_INVITATION_FROM_GROUP=36]="WEBIM_CONNECTION_DECLINE_INVITATION_FROM_GROUP",e[e.WEBIM_CONNECTION_ACCEPT_JOIN_GROUP=37]="WEBIM_CONNECTION_ACCEPT_JOIN_GROUP",e[e.WEBIM_CONNECTION_DECLINE_JOIN_GROUP=38]="WEBIM_CONNECTION_DECLINE_JOIN_GROUP",e[e.WEBIM_CONNECTION_CLOSED=39]="WEBIM_CONNECTION_CLOSED",e[e.WEBIM_CONNECTION_ERROR=40]="WEBIM_CONNECTION_ERROR",e[e.MAX_LIMIT=50]="MAX_LIMIT",e[e.MESSAGE_NOT_FOUND=51]="MESSAGE_NOT_FOUND",e[e.NO_PERMISSION=52]="NO_PERMISSION",e[e.OPERATION_UNSUPPORTED=53]="OPERATION_UNSUPPORTED",e[e.OPERATION_NOT_ALLOWED=54]="OPERATION_NOT_ALLOWED",e[e.WEBIM_TOKEN_EXPIRED=56]="WEBIM_TOKEN_EXPIRED",e[e.WEBIM_SERVER_SERVING_DISABLED=57]="WEBIM_SERVER_SERVING_DISABLED",e[e.WEBIM_UPLOADFILE_BROWSER_ERROR=100]="WEBIM_UPLOADFILE_BROWSER_ERROR",e[e.WEBIM_UPLOADFILE_ERROR=101]="WEBIM_UPLOADFILE_ERROR",e[e.WEBIM_UPLOADFILE_NO_LOGIN=102]="WEBIM_UPLOADFILE_NO_LOGIN",e[e.WEBIM_UPLOADFILE_NO_FILE=103]="WEBIM_UPLOADFILE_NO_FILE",e[e.WEBIM_DOWNLOADFILE_ERROR=200]="WEBIM_DOWNLOADFILE_ERROR",e[e.WEBIM_DOWNLOADFILE_NO_LOGIN=201]="WEBIM_DOWNLOADFILE_NO_LOGIN",e[e.WEBIM_DOWNLOADFILE_BROWSER_ERROR=202]="WEBIM_DOWNLOADFILE_BROWSER_ERROR",e[e.PARSE_FILE_ERROR=203]="PARSE_FILE_ERROR",e[e.USER_NOT_FOUND=204]="USER_NOT_FOUND",e[e.MESSAGE_PARAMETER_ERROR=205]="MESSAGE_PARAMETER_ERROR",e[e.WEBIM_CONNCTION_USER_LOGIN_ANOTHER_DEVICE=206]="WEBIM_CONNCTION_USER_LOGIN_ANOTHER_DEVICE",e[e.WEBIM_CONNCTION_USER_REMOVED=207]="WEBIM_CONNCTION_USER_REMOVED",e[e.WEBIM_CONNCTION_USER_KICKED_BY_CHANGE_PASSWORD=216]="WEBIM_CONNCTION_USER_KICKED_BY_CHANGE_PASSWORD",e[e.WEBIM_CONNCTION_USER_KICKED_BY_OTHER_DEVICE=217]="WEBIM_CONNCTION_USER_KICKED_BY_OTHER_DEVICE",e[e.USER_MUTED_BY_ADMIN=219]="USER_MUTED_BY_ADMIN",e[e.USER_NOT_FRIEND=221]="USER_NOT_FRIEND",e[e.WEBIM_MESSAGE_REC_TEXT=300]="WEBIM_MESSAGE_REC_TEXT",e[e.WEBIM_MESSAGE_REC_TEXT_ERROR=301]="WEBIM_MESSAGE_REC_TEXT_ERROR",e[e.WEBIM_MESSAGE_REC_EMOTION=302]="WEBIM_MESSAGE_REC_EMOTION",e[e.WEBIM_MESSAGE_REC_PHOTO=303]="WEBIM_MESSAGE_REC_PHOTO",e[e.SERVER_GET_DNSLIST_FAILED=304]="SERVER_GET_DNSLIST_FAILED",e[e.WEBIM_MESSAGE_REC_AUDIO_FILE=305]="WEBIM_MESSAGE_REC_AUDIO_FILE",e[e.WEBIM_MESSAGE_REC_VEDIO=306]="WEBIM_MESSAGE_REC_VEDIO",e[e.WEBIM_MESSAGE_REC_VEDIO_FILE=307]="WEBIM_MESSAGE_REC_VEDIO_FILE",e[e.WEBIM_MESSAGE_REC_FILE=308]="WEBIM_MESSAGE_REC_FILE",e[e.WEBIM_MESSAGE_SED_TEXT=309]="WEBIM_MESSAGE_SED_TEXT",e[e.WEBIM_MESSAGE_SED_EMOTION=310]="WEBIM_MESSAGE_SED_EMOTION",e[e.WEBIM_MESSAGE_SED_PHOTO=311]="WEBIM_MESSAGE_SED_PHOTO",e[e.WEBIM_MESSAGE_SED_AUDIO=312]="WEBIM_MESSAGE_SED_AUDIO",e[e.WEBIM_MESSAGE_SED_AUDIO_FILE=313]="WEBIM_MESSAGE_SED_AUDIO_FILE",e[e.WEBIM_MESSAGE_SED_VEDIO=314]="WEBIM_MESSAGE_SED_VEDIO",e[e.WEBIM_MESSAGE_SED_VEDIO_FILE=315]="WEBIM_MESSAGE_SED_VEDIO_FILE",e[e.WEBIM_MESSAGE_SED_FILE=316]="WEBIM_MESSAGE_SED_FILE",e[e.WEBIM_MESSAGE_SED_ERROR=317]="WEBIM_MESSAGE_SED_ERROR",e[e.STATUS_INIT=400]="STATUS_INIT",e[e.STATUS_DOLOGIN_USERGRID=401]="STATUS_DOLOGIN_USERGRID",e[e.STATUS_DOLOGIN_IM=402]="STATUS_DOLOGIN_IM",e[e.STATUS_OPENED=403]="STATUS_OPENED",e[e.STATUS_CLOSING=404]="STATUS_CLOSING",e[e.STATUS_CLOSED=405]="STATUS_CLOSED",e[e.STATUS_ERROR=406]="STATUS_ERROR",e[e.SERVER_BUSY=500]="SERVER_BUSY",e[e.MESSAGE_INCLUDE_ILLEGAL_CONTENT=501]="MESSAGE_INCLUDE_ILLEGAL_CONTENT",e[e.MESSAGE_EXTERNAL_LOGIC_BLOCKED=502]="MESSAGE_EXTERNAL_LOGIC_BLOCKED",e[e.SERVER_UNKNOWN_ERROR=503]="SERVER_UNKNOWN_ERROR",e[e.MESSAGE_RECALL_TIME_LIMIT=504]="MESSAGE_RECALL_TIME_LIMIT",e[e.SERVICE_NOT_ENABLED=505]="SERVICE_NOT_ENABLED",e[e.SERVICE_NOT_ALLOW_MESSAGING=506]="SERVICE_NOT_ALLOW_MESSAGING",e[e.SERVICE_NOT_ALLOW_MESSAGING_MUTE=507]="SERVICE_NOT_ALLOW_MESSAGING_MUTE",e[e.MESSAGE_MODERATION_BLOCKED=508]="MESSAGE_MODERATION_BLOCKED",e[e.MESSAGE_CURRENT_LIMITING=509]="MESSAGE_CURRENT_LIMITING",e[e.MESSAGE_WEBSOCKET_DISCONNECTED=510]="MESSAGE_WEBSOCKET_DISCONNECTED",e[e.MESSAGE_SIZE_LIMIT=511]="MESSAGE_SIZE_LIMIT",e[e.GROUP_NOT_EXIST=605]="GROUP_NOT_EXIST",e[e.GROUP_NOT_JOINED=602]="GROUP_NOT_JOINED",e[e.GROUP_MEMBERS_FULL=606]="GROUP_MEMBERS_FULL",e[e.PERMISSION_DENIED=603]="PERMISSION_DENIED",e[e.WEBIM_LOAD_MSG_ERROR=604]="WEBIM_LOAD_MSG_ERROR",e[e.GROUP_ALREADY_JOINED=601]="GROUP_ALREADY_JOINED",e[e.GROUP_MEMBERS_LIMIT=607]="GROUP_MEMBERS_LIMIT",e[e.GROUP_IS_DISABLED=608]="GROUP_IS_DISABLED",e[e.GROUP_MEMBER_ATTRIBUTES_SET_FAILED=609]="GROUP_MEMBER_ATTRIBUTES_SET_FAILED",e[e.REST_PARAMS_STATUS=700]="REST_PARAMS_STATUS",e[e.CHATROOM_NOT_JOINED=702]="CHATROOM_NOT_JOINED",e[e.CHATROOM_MEMBERS_FULL=704]="CHATROOM_MEMBERS_FULL",e[e.CHATROOM_NOT_EXIST=705]="CHATROOM_NOT_EXIST",e[e.LOCAL_DB_OPERATION_FAILED=800]="LOCAL_DB_OPERATION_FAILED",e[e.SDK_RUNTIME_ERROR=999]="SDK_RUNTIME_ERROR",e[e.PRESENCE_PARAM_EXCEED=1100]="PRESENCE_PARAM_EXCEED",e[e.REACTION_ALREADY_ADDED=1101]="REACTION_ALREADY_ADDED",e[e.REACTION_CREATING=1102]="REACTION_CREATING",e[e.REACTION_OPERATION_IS_ILLEGAL=1103]="REACTION_OPERATION_IS_ILLEGAL",e[e.TRANSLATION_NOT_VALID=1200]="TRANSLATION_NOT_VALID",e[e.TRANSLATION_TEXT_TOO_LONG=1201]="TRANSLATION_TEXT_TOO_LONG",e[e.TRANSLATION_FAILED=1204]="TRANSLATION_FAILED",e[e.THREAD_NOT_EXIST=1300]="THREAD_NOT_EXIST",e[e.THREAD_ALREADY_EXIST=1301]="THREAD_ALREADY_EXIST",e[e.MODIFY_MESSAGE_NOT_EXIST=1302]="MODIFY_MESSAGE_NOT_EXIST",e[e.MODIFY_MESSAGE_FORMAT_ERROR=1303]="MODIFY_MESSAGE_FORMAT_ERROR",e[e.MODIFY_MESSAGE_FAILED=1304]="MODIFY_MESSAGE_FAILED",e[e.CONVERSATION_NOT_EXIST=1400]="CONVERSATION_NOT_EXIST"}(r||(r={}))},4998:function(e,t,n){"use strict";var r;n.d(t,{a:function(){return r}}),n(7252),function(e){e[e.SYNC_INIT=0]="SYNC_INIT",e[e.SYNC_START=1]="SYNC_START",e[e.SYNC_FINISH=2]="SYNC_FINISH"}(r||(r={}))},9937:function(e,t,n){"use strict";var r;n.d(t,{Z:function(){return r}}),function(e){e[e.mark_0=0]="mark_0",e[e.mark_1=1]="mark_1",e[e.mark_2=2]="mark_2",e[e.mark_3=3]="mark_3",e[e.mark_4=4]="mark_4",e[e.mark_5=5]="mark_5",e[e.mark_6=6]="mark_6",e[e.mark_7=7]="mark_7",e[e.mark_8=8]="mark_8",e[e.mark_9=9]="mark_9",e[e.mark_10=10]="mark_10",e[e.mark_11=11]="mark_11",e[e.mark_12=12]="mark_12",e[e.mark_13=13]="mark_13",e[e.mark_14=14]="mark_14",e[e.mark_15=15]="mark_15",e[e.mark_16=16]="mark_16",e[e.mark_17=17]="mark_17",e[e.mark_18=18]="mark_18",e[e.mark_19=19]="mark_19"}(r||(r={}))},4024:function(e,t,n){"use strict";n.d(t,{PU:function(){return T},iw:function(){return w},hj:function(){return S},LR:function(){return D},cT:function(){return P},P6:function(){return x}}),n(9601),n(1539),n(8674),n(3710),n(7941),n(6699),n(7042),n(2772),n(9714),n(9653),n(6992),n(8783),n(3948),n(285),n(1637),n(8309),n(4986),n(2222),n(4916),n(2564);var r=n(5531),o=(n(2023),function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)}),i=function(e,t,n,i){var a,s,c,l,u,d,p,h,f,m,v,g,E,y,_,b,T,S,O,R,C,w,I,A,N=e.response;N&&"string"==typeof N&&(N=JSON.parse(N));var k=e.status,P={elapse:i,httpCode:k,errDesc:null==N?void 0:N.error_description};if(400===k){if(40002===N.error_code)return void t({type:r.E.THREAD_ALREADY_EXIST,message:null==N?void 0:N.error_description,extraInfo:P});if(40009===N.error_code)return void t({type:r.E.OPERATION_UNSUPPORTED,message:null==N?void 0:N.error_description,extraInfo:P});if(60005===N.error_code)return void t({type:r.E.GROUP_MEMBER_ATTRIBUTES_SET_FAILED,message:(null==N?void 0:N.desc)||(null==N?void 0:N.error_description),extraInfo:P});if(60010===N.error_code)return void((null==N?void 0:N.error_description.includes("exceeds chatgroup user metadata single value limit"))?t({type:r.E.MAX_LIMIT,message:(null==N?void 0:N.desc)||N.error_description,extraInfo:P}):t({type:r.E.NO_PERMISSION,message:(null==N?void 0:N.desc)||N.error_description,extraInfo:P}));if(60011===N.error_code)return void t({type:r.E.CHATROOM_NOT_JOINED,message:null==N?void 0:N.desc,extraInfo:P});if(14403===N.error_code)return void t({type:r.E.WEBIM_UPLOADFILE_ERROR,message:null==N?void 0:N.error_description,data:N,extraInfo:P});if(60006===N.error_code||60007===N.error_code||60009===N.error_code||60012===N.error_code)return void t({type:r.E.MAX_LIMIT,message:(null==N?void 0:N.desc)||(null==N?void 0:N.error_description),extraInfo:P});if(91104===N.error_code)return void t({type:r.E.NO_PERMISSION,message:null==N?void 0:N.error_description,extraInfo:P});if(null===(a=N.error_description)||void 0===a?void 0:a.includes("are not members of this group"))return(null===(s=e.responseURL)||void 0===s?void 0:s.includes("chatgroups"))?t({type:r.E.GROUP_NOT_JOINED,data:e.response||e.responseText,message:N.error_description,extraInfo:P}):t({type:r.E.CHATROOM_NOT_JOINED,data:e.response||e.responseText,message:N.error_description,extraInfo:P}),void n({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,message:null==N?void 0:N.error_description,data:e.responseText,extraInfo:P});if("the app not open presence"===(null==N?void 0:N.result))return void t({type:r.E.SERVICE_NOT_ENABLED,message:null==N?void 0:N.result,extraInfo:P});if(null==N?void 0:N.error_description.includes("remark length must less"))return void t({type:r.E.MAX_LIMIT,message:null==N?void 0:N.error_description,extraInfo:P});switch(null==N?void 0:N.error_description){case"the user is already operation this message":t({type:r.E.REACTION_ALREADY_ADDED,message:null==N?void 0:N.error_description,extraInfo:P});break;case"The quantity has exceeded the limit!":t({type:r.E.MAX_LIMIT,message:null==N?void 0:N.error_description,extraInfo:P});break;case"The user not in this group!":t({type:r.E.GROUP_NOT_JOINED,message:null==N?void 0:N.error_description,extraInfo:P});break;case"the user operation is illegal!":t({type:r.E.REACTION_OPERATION_IS_ILLEGAL,message:null==N?void 0:N.error_description,extraInfo:P});break;case"this appKey is not open reaction service!":case"this appKey not open message roaming":t({type:r.E.SERVICE_NOT_ENABLED,message:null==N?void 0:N.error_description,extraInfo:P});break;case"this message is creating reaction, please try again.":t({type:r.E.REACTION_CREATING,message:null==N?void 0:N.error_description,extraInfo:P});break;case"groupId can not be null!":t({type:r.E.GROUP_NOT_EXIST,message:null==N?void 0:N.error_description,extraInfo:P});break;case"The input text is too long.":t({type:r.E.TRANSLATION_TEXT_TOO_LONG,message:null==N?void 0:N.error_description,extraInfo:P});break;case"The target language is not valid.":t({type:r.E.TRANSLATION_NOT_VALID,message:null==N?void 0:N.error_description,extraInfo:P});break;case"report failed, get message by id failed":t({type:r.E.MESSAGE_NOT_FOUND,message:null==N?void 0:N.error_description,extraInfo:P});break;case"ext is too big ":t({type:r.E.PRESENCE_PARAM_EXCEED,message:null==N?void 0:N.error_description,extraInfo:P});break;case"Request body not readable.Please check content type is correct!":case"param mark must be not empty, please check!":case"param mark illegal, please check it!":case"param pin_msg_id illegal, please check it!":t({type:r.E.REQUEST_PARAMETER_ERROR,message:null==N?void 0:N.error_description,extraInfo:P});break;case"updateRemark | they are not friends, please add as a friend first.":t({type:r.E.USER_NOT_FRIEND,message:null==N?void 0:N.error_description,extraInfo:P});break;default:t({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,message:null==N?void 0:N.error_description,data:e.responseText,extraInfo:P}),n({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,message:null==N?void 0:N.error_description,data:e.responseText,extraInfo:P})}}else if(401===k)40001===N.error_code||60001===N.error_code||"Unable to authenticate (OAuth)"===N.error_description?t({type:r.E.NO_PERMISSION,message:null==N?void 0:N.error_description,extraInfo:P}):(n({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:e.responseText,message:e.responseText,extraInfo:P}),t({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:e.responseText,message:e.responseText,extraInfo:P}));else if(403===k)4e4===N.error_code||60004===N.error_code||15002===N.error_code?t({type:r.E.SERVICE_NOT_ENABLED,message:null==N?void 0:N.error_description,extraInfo:P}):40003===N.error_code||40004===N.error_code?t({type:r.E.THREAD_ALREADY_EXIST,message:null==N?void 0:N.error_description,extraInfo:P}):40005===N.error_code||40007===N.error_code||91002===N.error_code?t({type:r.E.MAX_LIMIT,message:null==N?void 0:N.error_description,extraInfo:P}):60002===N.error_code?t({type:r.E.PERMISSION_DENIED,message:null==N?void 0:N.error_description,extraInfo:P}):91101===N.error_code?t({type:r.E.MAX_LIMIT,message:null==N?void 0:N.error_description,extraInfo:P}):91102===N.error_code&&t({type:r.E.REQUEST_PARAMETER_ERROR,message:N.error_description,extraInfo:P}),"group member list is full!"===N.error_description?(null===(c=e.responseURL)||void 0===c?void 0:c.includes("chatgroups"))?t({type:r.E.GROUP_MEMBERS_FULL,data:e.response||e.responseText,message:N.error_description,extraInfo:P}):t({type:r.E.CHATROOM_MEMBERS_FULL,data:e.response||e.responseText,message:N.error_description,extraInfo:P}):(null===(l=N.error_description)||void 0===l?void 0:l.includes(N.error_description.includes("already in group")))?(null===(u=e.responseURL)||void 0===u?void 0:u.includes("chatgroups"))&&t({type:r.E.GROUP_ALREADY_JOINED,data:e.response||e.responseText,message:N.error_description,extraInfo:P}):(null===(d=N.error_description)||void 0===d?void 0:d.includes("are not members of this group"))?(null===(p=e.responseURL)||void 0===p?void 0:p.includes("chatgroups"))?t({type:r.E.GROUP_NOT_JOINED,data:e.response||e.responseText,message:N.error_description,extraInfo:P}):t({type:r.E.CHATROOM_NOT_JOINED,data:e.response||e.responseText,message:N.error_description,extraInfo:P}):(null===(h=N.error_description)||void 0===h?void 0:h.includes("service not open!"))||(null===(f=N.error_description)||void 0===f?void 0:f.includes("message report not open"))||(null===(m=N.error_description)||void 0===m?void 0:m.includes("messageroaming function not open"))?t({type:r.E.SERVICE_NOT_ENABLED,data:e.response||e.responseText,message:N.error_description,extraInfo:P}):(null===(v=N.error_description)||void 0===v?void 0:v.includes("members size is greater than max user size !"))?t({type:r.E.GROUP_MEMBERS_LIMIT,data:e.response||e.responseText,message:N.error_description,extraInfo:P}):(null===(g=N.error_description)||void 0===g?void 0:g.includes("can not operate this group, reason: group is disabled"))?t({type:r.E.GROUP_IS_DISABLED,data:e.response||e.responseText,message:N.error_description,extraInfo:P}):(null===(E=N.error_description)||void 0===E?void 0:E.includes("Invitee's contact max count"))||(null===(y=N.error_description)||void 0===y?void 0:y.includes("Inviter's contact max count"))?t({type:r.E.MAX_LIMIT,data:e.response||e.responseText,message:N.error_description,extraInfo:P}):t({type:r.E.PERMISSION_DENIED,data:e.response||e.responseText,message:"permission denied",extraInfo:o(o({},P),{errDesc:"permission denied"})}),n({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:e.responseText,message:e.responseText,extraInfo:P});else if(404===k)40011===N.error_code?t({type:r.E.THREAD_NOT_EXIST,message:null==N?void 0:N.error_description,extraInfo:P}):40012===N.error_code?t({type:r.E.NO_PERMISSION,message:null==N?void 0:N.error_description,extraInfo:P}):60003===N.error_code||20004===N.error_code?t({type:r.E.GROUP_NOT_JOINED,message:null==N?void 0:N.error_description,extraInfo:P}):91001===N.error_code&&t({type:r.E.CONVERSATION_NOT_EXIST,message:null==N?void 0:N.error_description,extraInfo:P}),(null===(_=N.error_description)||void 0===_?void 0:_.includes("do not find this group"))||(null===(b=N.error_description)||void 0===b?void 0:b.includes("does not exist"))?(null===(T=e.responseURL)||void 0===T?void 0:T.includes("chatgroups"))?t({type:r.E.GROUP_NOT_EXIST,data:e.response||e.responseText,message:"The chat room dose not exist.",extraInfo:o(o({},P),{errDesc:"The chat room dose not exist."})}):t({type:r.E.CHATROOM_NOT_EXIST,data:e.response||e.responseText,message:"The chat room dose not exist.",extraInfo:o(o({},P),{errDesc:"The chat room dose not exist."})}):(null===(S=N.error_description)||void 0===S?void 0:S.includes("username"))&&(null===(O=N.error_description)||void 0===O?void 0:O.includes("doesn't exist!'"))||(null===(R=N.error_description)||void 0===R?void 0:R.includes("user not found"))||(null===(C=N.error_description)||void 0===C?void 0:C.includes("Service resource not found"))&&"UserNotFoundException"===(null==N?void 0:N.exception)?t({type:r.E.USER_NOT_FOUND,data:e.response||e.responseText,message:N.error_description,extraInfo:P}):N.error_description.includes("user session pin message not exist")?t({type:r.E.MESSAGE_NOT_FOUND,message:N.error_description,extraInfo:P}):t({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:e.response||e.responseText,message:e.responseText,extraInfo:P}),n({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:e.response||e.responseText,message:e.responseText,extraInfo:P});else if(406===k)90004===N.error_code&&t({type:r.E.OPERATION_NOT_ALLOWED,message:null==N?void 0:N.error_description,extraInfo:P});else if(429===k||503===k){if(null===(w=N.error_description)||void 0===w?void 0:w.includes("The request has reached the maximum limit"))return void t({type:r.E.MAX_LIMIT,message:e.responseText,extraInfo:P});if(null===(I=N.error_description)||void 0===I?void 0:I.includes("upload client logs reached limit"))return void t({type:r.E.MAX_LIMIT,message:e.responseText});t({type:r.E.SERVER_BUSY,data:e.response||e.responseText,message:"Server is busy.",extraInfo:o(o({},P),{errDesc:"Server is busy."})}),n({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:e.responseText,message:"Server is busy.",extraInfo:o(o({},P),{errDesc:"Server is busy."})})}else if(500===k){if(40006===N.error_code||40008===N.error_code||40010===N.error_code)return void t({type:r.E.SERVER_UNKNOWN_ERROR,message:null==N?void 0:N.error_description,extraInfo:P});if(90005===N.error_code||99999===N.error_code)return void t({type:r.E.REQUEST_UNKNOWN,message:null==N?void 0:N.error_description,extraInfo:P});if(null===(A=N.error_description)||void 0===A?void 0:A.includes("translte failed!"))return void t({type:r.E.TRANSLATION_FAILED,message:e.responseText,extraInfo:P});t({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:e.responseText,message:"",extraInfo:P}),n({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:e.responseText,message:"",extraInfo:P})}else t({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:e.responseText,message:e.responseText,extraInfo:o(o({},P),{errDesc:"ajax error"})}),n({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:e.responseText,message:e.responseText,extraInfo:o(o({},P),{errDesc:"ajax error"})})},a=n(1595),s=n(2071),c=n(7360),l=5242880,u=5242880,d={size:0},p=(n(2526),n(1817),n(2165),n(5827),n(4553),n(561),function(){return p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},p.apply(this,arguments)});function h(){var e=this.context,t=e.orgName,n=e.appName,r=e.accessToken,o={url:"".concat(this.apiUrl,"/").concat(t,"/").concat(n,"/sdk/chatfiles/part-upload"),dataType:"json",type:"POST",headers:{Authorization:"Bearer "+r}};return c.kg.debug("Call multipartInit"),S.call(this,o,a.fI.SDK_INTERNAL).then((function(e){var t=e.entities[0];return{data:{fileMaxSize:t.file_upper_limit,partMinSize:t.part_lower_limit,uuid:t.uuid},extraInfo:e.extraInfo,type:e.type}}))}function f(e){var t=this;return new Promise((function(n,o){var i,a,s=(new Date).getTime(),l=t.context,u=l.orgName,d=l.appName,h=l.accessToken,f=e.uuid,m=e.partNumber,v=e.part,g=e.onProgress,E="".concat(t.apiUrl,"/").concat(u,"/").concat(d,"/sdk/chatfiles/part-upload/").concat(f),y=new XMLHttpRequest;c.kg.debug("Call multipartUpload"),y.upload&&(null===(a=(i=y.upload).addEventListener)||void 0===a||a.call(i,"progress",(function(e){null==g||g(e)}),!1)),y.addEventListener("abort",(function(){o({type:r.E.REQUEST_ABORT,message:"Request Abort",errorType:"onabort",xhr:y,extraInfo:{elapse:(new Date).getTime()-s,httpCode:y.status||-1,errDesc:"Request Abort",url:E}})}),!1),y.addEventListener("error",(function(){o({type:r.E.WEBIM_UPLOADFILE_ERROR,data:y,extraInfo:{elapse:(new Date).getTime()-s,httpCode:y.status||-1,errDesc:"request error",url:E}})}),!1),y.addEventListener("load",(function(){try{var e=JSON.parse(y.responseText);if(200!==y.status)return o({type:r.E.WEBIM_UPLOADFILE_ERROR,data:e,extraInfo:{elapse:(new Date).getTime()-s,httpCode:y.status||-1,errDesc:"part upload failed",url:E}}),!1;try{n(p(p({},e),{extraInfo:{elapse:(new Date).getTime()-s,httpCode:y.status||-1,url:E}}))}catch(e){o({type:r.E.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,data:e,extraInfo:{elapse:(new Date).getTime()-s,httpCode:y.status||-1,errDesc:"part upload failed",url:E}})}}catch(e){o({type:r.E.WEBIM_UPLOADFILE_ERROR,data:y.responseText,extraInfo:{elapse:(new Date).getTime()-s,httpCode:y.status||-1,errDesc:"part upload failed",url:E}})}}),!1);var _=new FormData;_.append("part_file",v),_.append("part_number",m),y.open("PUT",E),y.setRequestHeader("restrict-access","true"),y.setRequestHeader("Accept","*/*"),y.setRequestHeader("Authorization","Bearer "+h),y.send(_)}))}function m(e){var t=e.uuid,n=e.thumbnailHeight,r=e.thumbnailWidth,o=this.context,i=o.orgName,s=o.appName,l=o.accessToken,u="".concat(this.apiUrl,"/").concat(i,"/").concat(s,"/sdk/chatfiles/part-upload/").concat(t,"?restrict-access=true");r&&(u+="&thumbnail-width=".concat(r)),n&&(u+="&thumbnail-height=".concat(n));var d={url:u,dataType:"json",type:"POST",headers:{Authorization:"Bearer "+l}};return c.kg.debug("Call multipartComplete"),S.call(this,d,a.fI.SDK_INTERNAL)}function v(e){var t=e.uuid,n=this.context,r=n.orgName,o=n.appName,i=n.accessToken,s={url:"".concat(this.apiUrl,"/").concat(r,"/").concat(o,"/sdk/chatfiles/part-upload/").concat(t),dataType:"json",type:"DELETE",headers:{Authorization:"Bearer "+i}};return c.kg.debug("Call multipartAbort"),S.call(this,s,a.fI.SDK_INTERNAL)}var g=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},E=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},y=function(){function e(e,t){var n=this;this.handleUploadProgress=function(e,t){var r,o;if(e.total){n.progressArr[t]=e.loaded;var i=n.progressArr.reduce((function(e,t){return e+t}),0);null===(o=(r=n.options).onFileUploadProgress)||void 0===o||o.call(r,{isTrusted:e.isTrusted,type:e.type,loaded:i>n.file.size?n.file.size:i,total:n.file.size,lengthComputable:e.lengthComputable})}},this.uuid="",this.pool=[],this.progressArr=[],this.connection=e,this.options=t,this.partSize=l,this.file=t.file,this.init(),this.rpt=this.connection.dataReport.geOperateFun({operationName:a.fI.REST_UPLOAD_FILE_IN_PARTS})}return e.prototype.init=function(){var e,t,n,o;return g(this,void 0,void 0,(function(){var i,s,u,p,f,m,v,g,y,_,b,T,S,O,R;return E(this,(function(E){switch(E.label){case 0:return E.trys.push([0,4,,6]),[4,h.call(this.connection)];case 1:return i=E.sent(),s=i.data||{},u=s.fileMaxSize,p=void 0===u?0:u,f=s.partMinSize,m=void 0===f?l:f,v=s.uuid,g=void 0===v?"":v,y=i.extraInfo,T=y.elapse,S=y.httpCode,R=y.url,this.partSize=m,this.uuid=g,d.size=m,c.kg.debug("multipartInit success","uuid: ".concat(g),"fileMaxSize: ".concat(p),"partMinSize: ".concat(m)),this.file.size>p?[4,this.multipartAbort()]:[3,3];case 2:return E.sent(),null===(t=(e=this.options).onFileUploadError)||void 0===t||t.call(e,{code:r.E.WEBIM_UPLOADFILE_ERROR,message:"The file size exceeds the maximum limit"}),[2];case 3:return this.rpt({data:{requestUrl:R,requestName:a.c.REST_INIT_UPLOAD_TASK_IN_PARTS,requestElapse:T,requestMethod:"POST",isSuccess:1,code:S}}),this.upload(),[3,6];case 4:return _=E.sent(),b=(null==_?void 0:_.extraInfo)||{},T=b.elapse,S=b.httpCode,O=b.errDesc,R=b.url,this.rpt({data:{requestUrl:R,requestName:a.c.REST_INIT_UPLOAD_TASK_IN_PARTS,requestElapse:T,requestMethod:"POST",isSuccess:0,codeDesc:O,code:S}}),[4,this.multipartAbort()];case 5:return E.sent(),null===(o=null===(n=this.options)||void 0===n?void 0:n.onInitFail)||void 0===o||o.call(n),[3,6];case 6:return[2]}}))}))},e.prototype.upload=function(){var e,t,n;return g(this,void 0,void 0,(function(){var r,o,i,s,c,l,u=this;return E(this,(function(d){switch(d.label){case 0:(new FileReader).readAsArrayBuffer(this.file),r=this.file.size,o=Math.ceil(r/this.partSize),d.label=1;case 1:d.trys.push([1,7,,9]),i=function(t){var n,o,i,c;return E(this,(function(l){switch(l.label){case 0:return n=t*s.partSize,o=Math.min(r,n+s.partSize),i=null===(e=s.file)||void 0===e?void 0:e.slice(n,o),(c=f.call(s.connection,{uuid:s.uuid,partNumber:"".concat(t+1),part:i,onProgress:function(e){u.handleUploadProgress(e,t)}})).then((function(e){var t=(null==e?void 0:e.extraInfo)||{},n=t.elapse,r=t.httpCode,o=t.url;u.rpt({data:{requestUrl:o,requestName:a.c.REST_UPLOAD_PART,requestElapse:n,isSuccess:1,requestMethod:"PUT",code:r}}),u.handleTask(c)})),c.catch((function(e){var t=(null==e?void 0:e.extraInfo)||{},n=t.elapse,r=t.httpCode,o=t.url,i=t.errDesc;u.rpt({data:{requestUrl:o,requestName:a.c.REST_UPLOAD_PART,requestElapse:n,isSuccess:0,requestMethod:"PUT",code:r,codeDesc:i}}),delete e.extraInfo})),s.pool.push(c),4!==s.pool.length?[3,2]:[4,Promise.race(s.pool)];case 1:l.sent(),l.label=2;case 2:return[2]}}))},s=this,c=0,d.label=2;case 2:return c<o?[5,i(c)]:[3,5];case 3:d.sent(),d.label=4;case 4:return c++,[3,2];case 5:return[4,Promise.all(this.pool)];case 6:return d.sent(),this.multipartComplete(),[3,9];case 7:return l=d.sent(),[4,this.multipartAbort()];case 8:return d.sent(),this.rpt({data:{isLastApi:1,isSuccess:0}}),null===(n=(t=this.options).onFileUploadError)||void 0===n||n.call(t,l),[3,9];case 9:return[2]}}))}))},e.prototype.multipartComplete=function(){var e,t,n,r;return g(this,void 0,void 0,(function(){var o,i,s,c,l,u,d,p,h,f,v;return E(this,(function(g){switch(g.label){case 0:return g.trys.push([0,2,,3]),o=this.options.thumbnailInfo||{},i=o.width,s=o.height,[4,m.call(this.connection,{uuid:this.uuid,thumbnailHeight:s,thumbnailWidth:i})];case 1:return c=g.sent(),l=(null==c?void 0:c.extraInfo)||{},p=l.elapse,h=l.httpCode,v=l.url,this.rpt({data:{requestUrl:v,requestName:a.c.REST_COMPLETE_UPLOAD_PART,requestElapse:p,requestMethod:"POST",isSuccess:1,code:h}}),this.rpt({data:{isLastApi:1,isSuccess:1}}),null===(t=(e=this.options).onFileUploadComplete)||void 0===t||t.call(e,c),[3,3];case 2:return u=g.sent(),d=(null==u?void 0:u.extraInfo)||{},p=d.elapse,h=d.httpCode,f=d.errDesc,v=d.url,this.rpt({data:{requestUrl:v,requestName:a.c.REST_COMPLETE_UPLOAD_PART,requestElapse:p,requestMethod:"POST",isSuccess:0,codeDesc:f,code:h}}),this.rpt({data:{isLastApi:1,isSuccess:0}}),null===(r=(n=this.options).onFileUploadError)||void 0===r||r.call(n,u),[3,3];case 3:return[2]}}))}))},e.prototype.multipartAbort=function(){return g(this,void 0,void 0,(function(){var e,t,n,r,o,i,s,c;return E(this,(function(l){switch(l.label){case 0:if(!this.uuid)return[2];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,v.call(this.connection,{uuid:this.uuid})];case 2:return e=l.sent(),t=(null==e?void 0:e.extraInfo)||{},o=t.elapse,i=t.httpCode,c=t.url,this.rpt({data:{requestUrl:c,requestName:a.c.REST_ABORT_UPLOAD_PART,requestElapse:o,requestMethod:"DELETE",isSuccess:1,code:i}}),[3,4];case 3:return n=l.sent(),r=(null==n?void 0:n.extraInfo)||{},o=r.elapse,i=r.httpCode,s=r.errDesc,c=r.url,this.rpt({data:{requestUrl:c,requestName:a.c.REST_ABORT_UPLOAD_PART,requestElapse:o,requestMethod:"DELETE",isSuccess:0,codeDesc:s,code:i}}),[3,4];case 4:return[2]}}))}))},e.prototype.handleTask=function(e){var t=this.pool.findIndex((function(t){return t===e}));this.pool.splice(t,1)},e}(),_=function(e){var t,n,o=this,i=(new Date).getTime(),s=e.apiUrl,c=e.orgName,l=e.appName,u=e.operateName,d=e.accessToken,p=e.uploadUrl||"".concat(s,"/").concat(c,"/").concat(l,"/chatfiles"),h=function(t){var n=(new Date).getTime()-i;o.dataReport&&u&&[a.fI.UPLOAD_MSG_ATTACH,a.fI.UPLOAD_CHATROOM_FILE,a.fI.UPLOAD_GROUP_FILE].includes(u)&&o.dataReport.geOperateFun({operationName:u})({isEndApi:!0,data:{isSuccess:0,requestMethod:"POST",requestName:u,requestElapse:n,requestUrl:p,code:(null==f?void 0:f.status)||0,codeDesc:"upload file error"}}),e.onFileUploadError&&e.onFileUploadError(t)},f=new XMLHttpRequest;f.upload&&(null===(n=(t=f.upload).addEventListener)||void 0===n||n.call(t,"progress",e.onFileUploadProgress||T,!1)),f.addEventListener("abort",e.onFileUploadCanceled||T,!1),f.addEventListener("error",(function(e){h({type:r.E.WEBIM_UPLOADFILE_ERROR,data:f})}),!1),f.addEventListener("load",(function(t){try{var n=JSON.parse(f.responseText);if(400===f.status)return h({type:r.E.WEBIM_UPLOADFILE_ERROR,data:n}),!1;try{!function(t){var n=(new Date).getTime()-i;o.dataReport&&u&&[a.fI.UPLOAD_MSG_ATTACH,a.fI.UPLOAD_CHATROOM_FILE,a.fI.UPLOAD_GROUP_FILE].includes(u)&&o.dataReport.geOperateFun({operationName:u})({isEndApi:!0,data:{isSuccess:(null==t?void 0:t.error)?0:1,requestMethod:"POST",requestName:u,requestElapse:n,requestUrl:p,code:f.status,codeDesc:(null==t?void 0:t.error_description)||""}}),e.onFileUploadComplete&&e.onFileUploadComplete(t)}(n)}catch(t){h({type:r.E.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,data:t})}}catch(t){h({type:r.E.WEBIM_UPLOADFILE_ERROR,data:f.responseText})}}),!1),f.open("POST",p),f.setRequestHeader("restrict-access","true"),f.setRequestHeader("Accept","*/*"),f.setRequestHeader("Authorization","Bearer "+d);var m=new FormData;m.append("file",e.file.data),e.thumbnailWidth&&m.append("thumbnail-width",e.thumbnailWidth+""),e.thumbnailHeight&&m.append("thumbnail-height",e.thumbnailHeight+""),f.send(m)},b=function(){return b=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},b.apply(this,arguments)},T=function(){};function S(e,t){var n,o=this;return N().platform===w.WEB?new Promise((function(t,o){var a=e.dataType||"text",s=e.success||T,l=e.error||T,u=new XMLHttpRequest;u.ontimeout=function(){o({type:r.E.REQUEST_TIMEOUT,message:"Request Timeout",errorType:"timeout_error",xhr:u})},u.onerror=function(){o({type:r.E.REQUEST_UNKNOWN,message:"Request Unknow Error",errorType:"onerror",xhr:u})},u.onabort=function(){o({type:r.E.REQUEST_ABORT,message:"Request Abort",errorType:"onabort",xhr:u})},u.onreadystatechange=function(){if(4===u.readyState){var e=(new Date).getTime()-n,d=u.status||0,p={elapse:e,httpCode:d};if(200===d){x.ajaxUnconventionalErrorTimes=0;try{switch(a){case"text":return s(u.responseText),void t(u.responseText);case"json":var h=JSON.parse(u.responseText);return h.extraInfo=p,s(h),void t(h);case"xml":return u.responseXML&&u.responseXML.documentElement?(s(u.responseXML.documentElement),void t(u.responseXML.documentElement)):(l({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:u.responseText,message:"XHR.responseXML is null or XHR.responseXML.documentElement is null"}),void o({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:u.responseText,message:"XHR.responseXML is null or XHR.responseXML.documentElement is null"}));default:l({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:u.responseText,message:"Invalid dataType"}),o({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:u.responseText,message:"Invalid dataType"})}return t(u.response||u.responseText),void s(u.response||u.responseText,u)}catch(e){o(e)}return}[400,401,403,404,429,500,503].includes(d)||(c.kg.debug("rest api request fail status:",d),x.ajaxUnconventionalErrorTimes++),i(u,o,l,e)}0===u.readyState&&(l({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:u.responseText,message:"Request not initialized"}),o({type:r.E.WEBIM_CONNCTION_AJAX_ERROR,data:u.responseText,message:"Request not initialized"}))},e.responseType&&u.responseType&&(u.responseType=e.responseType),e.mimeType&&u.overrideMimeType(e.mimeType);var d=e.type||"POST",p=e.data||null,h="";if("get"===d.toLowerCase()&&p){for(var f in p)p.hasOwnProperty(f)&&(h+=f+"="+p[f]+"&");h=h?h.slice(0,-1):h,e.url+=(e.url.indexOf("?")>0?"&":"?")+(h?h+"&":h)+"_v="+(new Date).getTime(),p=null,h=""}n=(new Date).getTime(),u.open(d,e.url);var m=e.headers||{};for(var v in m["Content-Type"]||(m["Content-Type"]="application/json"),m)m.hasOwnProperty(v)&&u.setRequestHeader(v,m[v]);u.send(p)})).then((function(n){return o.dataReport&&t&&t!==a.fI.SDK_INTERNAL&&o.dataReport.geOperateFun({operationName:t})({isEndApi:!0,data:b({isSuccess:1,requestUrl:e.url,requestName:t,requestMethod:e.type},M(n.extraInfo))}),t===a.fI.SDK_INTERNAL&&(n.extraInfo.url=e.url),t!==a.fI.SDK_INTERNAL&&delete n.extraInfo,"Object"===O(n)?b(b({},n),{type:r.E.REQUEST_SUCCESS}):{data:n,type:r.E.REQUEST_SUCCESS}})).catch((function(n){throw o.dataReport&&t&&t!==a.fI.SDK_INTERNAL&&o.dataReport.geOperateFun({operationName:t})({isEndApi:!0,data:b({isSuccess:0,requestUrl:e.url,requestName:t,requestMethod:e.type},M(n.extraInfo))}),t===a.fI.SDK_INTERNAL&&(n.extraInfo.url=e.url),t!==a.fI.SDK_INTERNAL&&delete n.extraInfo,n})):R.call(this,e,t)}function O(e){return Object.prototype.toString.call(e).slice(8,-1)}function R(e,t){var n=this;return new Promise((function(n,r){var o=e.success||T,i=e.error||T,a=e.type||"POST",l=e.data||null,u="",d=(new Date).getTime(),p=x.getEnvInfo();if("get"===a.toLowerCase()&&l){for(var h in l)l.hasOwnProperty(h)&&(u+=h+"="+l[h]+"&");u=u?u.slice(0,-1):u,e.url+=(e.url.indexOf("?")>0?"&":"?")+(u?u+"&":u)+"_v="+(new Date).getTime(),l=null,u=""}var f={url:e.url,data:e.data,method:a,headers:{},success:function(e){var a,s,l,u,p,h={elapse:(new Date).getTime()-d,httpCode:Number((null===(a=e.statusCode)||void 0===a?void 0:a.toString())||(null===(s=e.status)||void 0===s?void 0:s.toString())),errDesc:(null===(l=null==e?void 0:e.data)||void 0===l?void 0:l.error_description)||""};if("200"===(null===(u=e.statusCode)||void 0===u?void 0:u.toString())||"200"===(null===(p=e.status)||void 0===p?void 0:p.toString())){e.data.extraInfo=h;var f=e.data;o(f),n(f)}else e.extraInfo=h,i(f=e),r(f),c.kg.debug(t,"reject reason: ",f)},complete:function(){},fail:function(e){var n={elapse:(new Date).getTime()-d,httpCode:s.Tp,errDesc:"request:fail"};e.extraInfo=n,e.data={error:"request:fail",error_description:"request:fail"},i(e),r(e),c.kg.debug(t,"fail reason:",e)}};if("zfb"===p.platform||"dd"===p.platform?f.headers=e.headers:f.header=e.headers,"dd"===p.platform)return dd.httpRequest(f);p.global.request(f)})).then((function(o){return n.dataReport&&t&&t!==a.fI.SDK_INTERNAL&&n.dataReport.geOperateFun({operationName:t})({isEndApi:!0,data:b({isSuccess:1,requestUrl:e.url,requestName:t,requestMethod:e.type},M(o.extraInfo))}),t!==a.fI.SDK_INTERNAL&&delete o.extraInfo,"Object"===O(o)?b(b({},o),{type:r.E.REQUEST_SUCCESS}):{data:o,type:r.E.REQUEST_SUCCESS}})).catch((function(r){throw n.dataReport&&t&&t!==a.fI.SDK_INTERNAL&&n.dataReport.geOperateFun({operationName:t})({isEndApi:!0,data:b({isSuccess:0,requestUrl:e.url,requestName:t,requestMethod:e.type},M(r.extraInfo))}),t!==a.fI.SDK_INTERNAL&&delete r.extraInfo,r}))}function C(e,t){var n;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];if(!e)return n;n=t?e.apply(t,r):e.apply(void 0,r),e=null}}var w,I=C((function(e,t){var n=N();if(n.platform!==w.WEB){var r=n.global,o=function(n){n.isConnected?e():t()};r.offNetworkStatusChange&&r.offNetworkStatusChange(o),r.onNetworkStatusChange&&r.onNetworkStatusChange(o)}else"undefined"!=typeof addEventListener&&(window.addEventListener("online",e),window.addEventListener("offline",t))})),A=C((function(e,t){var n,r,o=N();if(o.platform===w.WEB)document&&document.addEventListener("visibilitychange",(function(){document.hidden?null==t||t():null==e||e()}),!1);else{var i=o.global;i.onAppShow&&(null===(n=i.onAppShow)||void 0===n||n.call(i,e)),i.onAppHide&&(null===(r=i.onAppHide)||void 0===r||r.call(i,t))}}));function N(){return"undefined"!=typeof swan&&k(swan)?{platform:w.BAIDU,global:swan}:"undefined"!=typeof tt&&k(tt)?{platform:w.TT,global:tt}:"undefined"!=typeof dd&&k(dd)?{platform:w.DD,global:dd}:"undefined"!=typeof my&&k(my)?{platform:w.ZFB,global:my}:"undefined"!=typeof wx&&k(wx)?{platform:w.WX,global:wx}:"undefined"!=typeof qq&&k(qq)?{platform:w.QQ,global:qq}:"undefined"!=typeof uni&&k(uni)?{platform:w.UNI,global:uni}:"undefined"!=typeof window&&window.WebSocket?{platform:w.WEB,global:window}:{platform:w.NODE,global:n.g||{}}}function k(e){for(var t=["canIUse","getSystemInfo"],n=0,r=t.length;n<r;n++)if(!e[t[n]])return!1;return!0}function P(e,t){var n,o,i,a=this,s=e.accessToken,c=e.appKey,l=null===(o=null===(n=null==e?void 0:e.file)||void 0===n?void 0:n.data)||void 0===o?void 0:o.size,p=[],h="",f="";if(s)if(c&&(p=c.split("#"),h=p[0],f=p[1]),h||f)if(l<=0)e.onFileUploadError&&e.onFileUploadError({type:r.E.WEBIM_UPLOADFILE_ERROR,message:"fileSize must be greater than 0"});else if(e.uploadUrl)_.call(this,b(b({},e),{orgName:h,appName:f,operateName:t}));else{var m=d.size||u;this.uploadPartEnable&&l>1.5*m?new y(this,{file:null===(i=null==e?void 0:e.file)||void 0===i?void 0:i.data,onFileUploadProgress:e.onFileUploadProgress||T,onFileUploadComplete:e.onFileUploadComplete||T,onFileUploadError:e.onFileUploadError||T,onFileUploadCanceled:e.onFileUploadCanceled||T,onInitFail:function(){_.call(a,b(b({},e),{orgName:h,appName:f,operateName:t}))},thumbnailInfo:{width:e.thumbnailWidth,height:e.thumbnailHeight}}):_.call(this,b(b({},e),{orgName:h,appName:f,operateName:t}))}else e.onFileUploadError&&e.onFileUploadError({type:r.E.WEBIM_UPLOADFILE_ERROR,message:"AppKey illegal"});else e.onFileUploadError&&e.onFileUploadError({type:r.E.WEBIM_UPLOADFILE_NO_LOGIN,message:"AccessToken cannot be empty"})}function D(e,t){e.onFileDownloadComplete=e.onFileDownloadComplete||T,e.onFileDownloadError=e.onFileDownloadError||T;var n=(new Date).getTime(),o=new XMLHttpRequest,i=this;o.addEventListener("load",(function(r){var s=(new Date).getTime()-n;i.dataReport&&t&&t===a.fI.DOWN_GROUP_FILE&&i.dataReport.geOperateFun({operationName:t})({isEndApi:!0,data:{isSuccess:200===o.status?1:0,requestMethod:"POST",requestName:t,requestElapse:s,requestUrl:null==e?void 0:e.url,code:o.status,codeDesc:200===o.status?"":"download file error"}}),e.onFileDownloadComplete&&e.onFileDownloadComplete(o.response)}),!1),o.addEventListener("error",(function(s){var c=(new Date).getTime()-n;i.dataReport&&t&&t===a.fI.DOWN_GROUP_FILE&&i.dataReport.geOperateFun({operationName:t})({isEndApi:!0,data:{isSuccess:0,requestMethod:"POST",requestName:t,requestElapse:c,requestUrl:null==e?void 0:e.url,code:(null==o?void 0:o.status)||0,codeDesc:"download file error"}}),e.onFileDownloadError&&e.onFileDownloadError({type:r.E.WEBIM_DOWNLOADFILE_ERROR,id:e.id,xhr:o})}),!1);var s=e.method||"GET",c=e.responseType||"blob",l=e.mimeType||"text/plain; charset=x-user-defined";o.open(s,e.url),"undefined"!=typeof Blob?o.responseType=c:o.overrideMimeType(l);var u={"X-Requested-With":"XMLHttpRequest",Accept:"application/octet-stream","share-secret":e.secret,Authorization:"Bearer "+this.context.accessToken},d=e.headers||{};for(var p in d)u[p]=d[p];for(var p in u)u[p]&&o.setRequestHeader(p,u[p]);o.send(null)}function M(e){void 0===e&&(e={});var t=e.elapse,n=void 0===t?0:t,r=e.httpCode,o=void 0===r?0:r,i=e.errDesc;return{requestElapse:n,code:o,codeDesc:void 0===i?"":i}}!function(e){e.WEB="web",e.WX="wx",e.QQ="qq",e.ZFB="zfb",e.DD="dd",e.TT="tt",e.BAIDU="baidu",e.QUICK_APP="quick_app",e.UNI="uni",e.NODE="node"}(w||(w={}));var L="localDeviceInfo",x={autoIncrement:0,ajaxUnconventionalErrorTimes:0,ajax:S,getUniqueId:function(){this.autoIncrement?this.autoIncrement++:this.autoIncrement=1;var e=new Date,t=new Date(2010,1,1);return(e.getTime()-t.getTime()+this.autoIncrement).toString()},getFileUrl:function(e){var t={url:"",filename:"",filetype:"",data:{}},n="string"==typeof e?document.getElementById(e):e;if(window.URL.createObjectURL){if(!n.files)throw Error("this is not HTMLInputElement");var r=n.files;if(r.length>0){var o=r.item(0);t.data=o,t.url=window.URL.createObjectURL(o),t.filename=(null==o?void 0:o.name)||""}}else{if("string"!=typeof e)throw Error("in IE fileInputId must be string");o=document.getElementById(e).value,t.url=o;var i=o.lastIndexOf("/"),a=o.lastIndexOf("\\"),s=Math.max(i,a);t.filename=s<0?o:o.substring(s+1)}var c=t.filename.lastIndexOf(".");return-1!==c&&(t.filetype=t.filename.substring(c+1).toLowerCase()),t},uploadFile:P,flow:function(e){for(var t=e.length,n=t;n--;)if("function"!=typeof e[n])throw new TypeError("Expected a function");return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(var o=0,i=t?e[o].apply(this,n):n[0];++o<t;)i=e[o].call(this,i);return i}},listenNetwork:I,listenBrowserVisibility:A,getEnvInfo:N,wxRequest:R,parseDownloadResponse:function(e){if(!window||!window.URL)throw Error("parseDownloadResponse can be used in broswer only");return e&&e.type&&"application/json"===e.type||0>Object.prototype.toString.call(e).indexOf("Blob")?this.url+"?token=":window.URL.createObjectURL(e)},download:D,parseNotify:function(e){for(var t="",n=0;n<e.length;n++)t+="%"+e[n].toString(16);return JSON.parse(decodeURIComponent(t))},getExtraData:M,retryPromise:function(e,t,n){return new Promise((function(r,o){!function t(i){e().then(r).catch((function(e){i>0?setTimeout((function(){t(i-1)}),n||1e3):o(e)}))}(t||3)}))},formatAttachUrl:function(e){return e&&"string"==typeof e?"".concat(this.apiUrl).concat(e.substr(e.indexOf("/",9))):""},Uint8ArrayToString:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},getLocalDeviceInfo:function(){return function(e){var t,n=x.getEnvInfo(),r=n.platform,o="";r!==w.NODE&&r!==w.QUICK_APP||(o="");try{r===w.WEB?o=localStorage.getItem(e)||"":r===w.WX||r===w.QQ||r===w.TT||r===w.BAIDU||r===w.UNI?o=n.global.getStorageSync(e)||"":r!==w.ZFB&&r!==w.DD||(o=(null===(t=n.global.getStorageSync({key:e}))||void 0===t?void 0:t.data)||"")}catch(t){c.kg.debug("get local ".concat(e," failed: "),t)}return c.kg.debug("".concat(e," "),o),o}(L)},setLocalDeviceInfo:function(e){var t,n,r,o;t=L,n=e,(o=(r=x.getEnvInfo()).platform)!==w.NODE&&o!==w.QUICK_APP&&(o===w.WEB?localStorage.setItem(t,n):r.global.setStorage({key:t,data:n,success:function(e){c.kg.debug("set local ".concat(t," success: "),e)},fail:function(e){c.kg.error("set local ".concat(t," failed: "),e)}}))},detectBrowser:function(){if("undefined"==typeof navigator)return"unknown";var e=navigator.userAgent;return/MicroMessenger/i.test(e)?"WeChat":/QQBrowser/i.test(e)?"QQ":!/Chrome/i.test(e)||/Edg/i.test(e)||/OPR/i.test(e)?!/Safari/i.test(e)||/Chrome/i.test(e)||/CriOS/i.test(e)?/Firefox/i.test(e)?"Firefox":/MSIE/i.test(e)||/Trident/i.test(e)?"IE":/Edg/i.test(e)?"Edge":"unknown":"Safari":"Chrome"},getDevicePlatform:function(e){return e.platform===w.WX&&"undefined"!=typeof uni&&k(uni)?w.UNI:e.platform},delay:function(e){return new Promise((function(t){return setTimeout(t,e)}))}}},9662:function(e,t,n){var r=n(614),o=n(6330),i=TypeError;e.exports=function(e){if(r(e))return e;throw i(o(e)+" is not a function")}},9483:function(e,t,n){var r=n(4411),o=n(6330),i=TypeError;e.exports=function(e){if(r(e))return e;throw i(o(e)+" is not a constructor")}},6077:function(e,t,n){var r=n(614),o=String,i=TypeError;e.exports=function(e){if("object"==typeof e||r(e))return e;throw i("Can't set "+o(e)+" as a prototype")}},1223:function(e,t,n){var r=n(5112),o=n(30),i=n(3070).f,a=r("unscopables"),s=Array.prototype;null==s[a]&&i(s,a,{configurable:!0,value:o(null)}),e.exports=function(e){s[a][e]=!0}},1530:function(e,t,n){"use strict";var r=n(8710).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},5787:function(e,t,n){var r=n(7976),o=TypeError;e.exports=function(e,t){if(r(t,e))return e;throw o("Incorrect invocation")}},9670:function(e,t,n){var r=n(111),o=String,i=TypeError;e.exports=function(e){if(r(e))return e;throw i(o(e)+" is not an object")}},3013:function(e){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},7556:function(e,t,n){var r=n(7293);e.exports=r((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},260:function(e,t,n){"use strict";var r,o,i,a=n(3013),s=n(9781),c=n(7854),l=n(614),u=n(111),d=n(2597),p=n(648),h=n(6330),f=n(8880),m=n(8052),v=n(7045),g=n(7976),E=n(9518),y=n(7674),_=n(5112),b=n(9711),T=n(9909),S=T.enforce,O=T.get,R=c.Int8Array,C=R&&R.prototype,w=c.Uint8ClampedArray,I=w&&w.prototype,A=R&&E(R),N=C&&E(C),k=Object.prototype,P=c.TypeError,D=_("toStringTag"),M=b("TYPED_ARRAY_TAG"),L="TypedArrayConstructor",x=a&&!!y&&"Opera"!==p(c.opera),U=!1,j={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},F={BigInt64Array:8,BigUint64Array:8},B=function(e){var t=E(e);if(u(t)){var n=O(t);return n&&d(n,L)?n[L]:B(t)}},V=function(e){if(!u(e))return!1;var t=p(e);return d(j,t)||d(F,t)};for(r in j)(i=(o=c[r])&&o.prototype)?S(i)[L]=o:x=!1;for(r in F)(i=(o=c[r])&&o.prototype)&&(S(i)[L]=o);if((!x||!l(A)||A===Function.prototype)&&(A=function(){throw P("Incorrect invocation")},x))for(r in j)c[r]&&y(c[r],A);if((!x||!N||N===k)&&(N=A.prototype,x))for(r in j)c[r]&&y(c[r].prototype,N);if(x&&E(I)!==N&&y(I,N),s&&!d(N,D))for(r in U=!0,v(N,D,{configurable:!0,get:function(){return u(this)?this[M]:void 0}}),j)c[r]&&f(c[r],M,r);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:x,TYPED_ARRAY_TAG:U&&M,aTypedArray:function(e){if(V(e))return e;throw P("Target is not a typed array")},aTypedArrayConstructor:function(e){if(l(e)&&(!y||g(A,e)))return e;throw P(h(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,r){if(s){if(n)for(var o in j){var i=c[o];if(i&&d(i.prototype,e))try{delete i.prototype[e]}catch(n){try{i.prototype[e]=t}catch(e){}}}N[e]&&!n||m(N,e,n?t:x&&C[e]||t,r)}},exportTypedArrayStaticMethod:function(e,t,n){var r,o;if(s){if(y){if(n)for(r in j)if((o=c[r])&&d(o,e))try{delete o[e]}catch(e){}if(A[e]&&!n)return;try{return m(A,e,n?t:x&&A[e]||t)}catch(e){}}for(r in j)!(o=c[r])||o[e]&&!n||m(o,e,t)}},getTypedArrayConstructor:B,isView:function(e){if(!u(e))return!1;var t=p(e);return"DataView"===t||d(j,t)||d(F,t)},isTypedArray:V,TypedArray:A,TypedArrayPrototype:N}},3331:function(e,t,n){"use strict";var r=n(7854),o=n(1702),i=n(9781),a=n(3013),s=n(6530),c=n(8880),l=n(7045),u=n(9190),d=n(7293),p=n(5787),h=n(9303),f=n(7466),m=n(7067),v=n(1179),g=n(9518),E=n(7674),y=n(8006).f,_=n(1285),b=n(1589),T=n(8003),S=n(9909),O=s.PROPER,R=s.CONFIGURABLE,C="ArrayBuffer",w="DataView",I="prototype",A="Wrong index",N=S.getterFor(C),k=S.getterFor(w),P=S.set,D=r[C],M=D,L=M&&M[I],x=r[w],U=x&&x[I],j=Object.prototype,F=r.Array,B=r.RangeError,V=o(_),H=o([].reverse),G=v.pack,W=v.unpack,q=function(e){return[255&e]},K=function(e){return[255&e,e>>8&255]},Y=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},z=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},X=function(e){return G(e,23,4)},J=function(e){return G(e,52,8)},Z=function(e,t,n){l(e[I],t,{configurable:!0,get:function(){return n(this)[t]}})},Q=function(e,t,n,r){var o=m(n),i=k(e);if(o+t>i.byteLength)throw B(A);var a=i.bytes,s=o+i.byteOffset,c=b(a,s,s+t);return r?c:H(c)},$=function(e,t,n,r,o,i){var a=m(n),s=k(e);if(a+t>s.byteLength)throw B(A);for(var c=s.bytes,l=a+s.byteOffset,u=r(+o),d=0;d<t;d++)c[l+d]=u[i?d:t-d-1]};if(a){var ee=O&&D.name!==C;if(d((function(){D(1)}))&&d((function(){new D(-1)}))&&!d((function(){return new D,new D(1.5),new D(NaN),1!=D.length||ee&&!R})))ee&&R&&c(D,"name",C);else{(M=function(e){return p(this,L),new D(m(e))})[I]=L;for(var te,ne=y(D),re=0;ne.length>re;)(te=ne[re++])in M||c(M,te,D[te]);L.constructor=M}E&&g(U)!==j&&E(U,j);var oe=new x(new M(2)),ie=o(U.setInt8);oe.setInt8(0,2147483648),oe.setInt8(1,2147483649),!oe.getInt8(0)&&oe.getInt8(1)||u(U,{setInt8:function(e,t){ie(this,e,t<<24>>24)},setUint8:function(e,t){ie(this,e,t<<24>>24)}},{unsafe:!0})}else L=(M=function(e){p(this,L);var t=m(e);P(this,{type:C,bytes:V(F(t),0),byteLength:t}),i||(this.byteLength=t,this.detached=!1)})[I],U=(x=function(e,t,n){p(this,U),p(e,L);var r=N(e),o=r.byteLength,a=h(t);if(a<0||a>o)throw B("Wrong offset");if(a+(n=void 0===n?o-a:f(n))>o)throw B("Wrong length");P(this,{type:w,buffer:e,byteLength:n,byteOffset:a,bytes:r.bytes}),i||(this.buffer=e,this.byteLength=n,this.byteOffset=a)})[I],i&&(Z(M,"byteLength",N),Z(x,"buffer",k),Z(x,"byteLength",k),Z(x,"byteOffset",k)),u(U,{getInt8:function(e){return Q(this,1,e)[0]<<24>>24},getUint8:function(e){return Q(this,1,e)[0]},getInt16:function(e){var t=Q(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=Q(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return z(Q(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return z(Q(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return W(Q(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return W(Q(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){$(this,1,e,q,t)},setUint8:function(e,t){$(this,1,e,q,t)},setInt16:function(e,t){$(this,2,e,K,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){$(this,2,e,K,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){$(this,4,e,Y,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){$(this,4,e,Y,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){$(this,4,e,X,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){$(this,8,e,J,t,arguments.length>2?arguments[2]:void 0)}});T(M,C),T(x,w),e.exports={ArrayBuffer:M,DataView:x}},1048:function(e,t,n){"use strict";var r=n(7908),o=n(1400),i=n(6244),a=n(5117),s=Math.min;e.exports=[].copyWithin||function(e,t){var n=r(this),c=i(n),l=o(e,c),u=o(t,c),d=arguments.length>2?arguments[2]:void 0,p=s((void 0===d?c:o(d,c))-u,c-l),h=1;for(u<l&&l<u+p&&(h=-1,u+=p-1,l+=p-1);p-- >0;)u in n?n[l]=n[u]:a(n,l),l+=h,u+=h;return n}},1285:function(e,t,n){"use strict";var r=n(7908),o=n(1400),i=n(6244);e.exports=function(e){for(var t=r(this),n=i(t),a=arguments.length,s=o(a>1?arguments[1]:void 0,n),c=a>2?arguments[2]:void 0,l=void 0===c?n:o(c,n);l>s;)t[s++]=e;return t}},8533:function(e,t,n){"use strict";var r=n(2092).forEach,o=n(9341)("forEach");e.exports=o?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},7745:function(e,t,n){var r=n(6244);e.exports=function(e,t){for(var n=0,o=r(t),i=new e(o);o>n;)i[n]=t[n++];return i}},8457:function(e,t,n){"use strict";var r=n(9974),o=n(6916),i=n(7908),a=n(3411),s=n(7659),c=n(4411),l=n(6244),u=n(6135),d=n(4121),p=n(1246),h=Array;e.exports=function(e){var t=i(e),n=c(this),f=arguments.length,m=f>1?arguments[1]:void 0,v=void 0!==m;v&&(m=r(m,f>2?arguments[2]:void 0));var g,E,y,_,b,T,S=p(t),O=0;if(!S||this===h&&s(S))for(g=l(t),E=n?new this(g):h(g);g>O;O++)T=v?m(t[O],O):t[O],u(E,O,T);else for(b=(_=d(t,S)).next,E=n?new this:[];!(y=o(b,_)).done;O++)T=v?a(_,m,[y.value,O],!0):y.value,u(E,O,T);return E.length=O,E}},1318:function(e,t,n){var r=n(5656),o=n(1400),i=n(6244),a=function(e){return function(t,n,a){var s,c=r(t),l=i(c),u=o(a,l);if(e&&n!=n){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},2092:function(e,t,n){var r=n(9974),o=n(1702),i=n(8361),a=n(7908),s=n(6244),c=n(5417),l=o([].push),u=function(e){var t=1==e,n=2==e,o=3==e,u=4==e,d=6==e,p=7==e,h=5==e||d;return function(f,m,v,g){for(var E,y,_=a(f),b=i(_),T=r(m,v),S=s(b),O=0,R=g||c,C=t?R(f,S):n||p?R(f,0):void 0;S>O;O++)if((h||O in b)&&(y=T(E=b[O],O,_),e))if(t)C[O]=y;else if(y)switch(e){case 3:return!0;case 5:return E;case 6:return O;case 2:l(C,E)}else switch(e){case 4:return!1;case 7:l(C,E)}return d?-1:o||u?u:C}};e.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},6583:function(e,t,n){"use strict";var r=n(2104),o=n(5656),i=n(9303),a=n(6244),s=n(9341),c=Math.min,l=[].lastIndexOf,u=!!l&&1/[1].lastIndexOf(1,-0)<0,d=s("lastIndexOf"),p=u||!d;e.exports=p?function(e){if(u)return r(l,this,arguments)||0;var t=o(this),n=a(t),s=n-1;for(arguments.length>1&&(s=c(s,i(arguments[1]))),s<0&&(s=n+s);s>=0;s--)if(s in t&&t[s]===e)return s||0;return-1}:l},1194:function(e,t,n){var r=n(7293),o=n(5112),i=n(7392),a=o("species");e.exports=function(e){return i>=51||!r((function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},9341:function(e,t,n){"use strict";var r=n(7293);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){return 1},1)}))}},3671:function(e,t,n){var r=n(9662),o=n(7908),i=n(8361),a=n(6244),s=TypeError,c=function(e){return function(t,n,c,l){r(n);var u=o(t),d=i(u),p=a(u),h=e?p-1:0,f=e?-1:1;if(c<2)for(;;){if(h in d){l=d[h],h+=f;break}if(h+=f,e?h<0:p<=h)throw s("Reduce of empty array with no initial value")}for(;e?h>=0:p>h;h+=f)h in d&&(l=n(l,d[h],h,u));return l}};e.exports={left:c(!1),right:c(!0)}},3658:function(e,t,n){"use strict";var r=n(9781),o=n(3157),i=TypeError,a=Object.getOwnPropertyDescriptor,s=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=s?function(e,t){if(o(e)&&!a(e,"length").writable)throw i("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},1589:function(e,t,n){var r=n(1400),o=n(6244),i=n(6135),a=Array,s=Math.max;e.exports=function(e,t,n){for(var c=o(e),l=r(t,c),u=r(void 0===n?c:n,c),d=a(s(u-l,0)),p=0;l<u;l++,p++)i(d,p,e[l]);return d.length=p,d}},206:function(e,t,n){var r=n(1702);e.exports=r([].slice)},4362:function(e,t,n){var r=n(1589),o=Math.floor,i=function(e,t){var n=e.length,c=o(n/2);return n<8?a(e,t):s(e,i(r(e,0,c),t),i(r(e,c),t),t)},a=function(e,t){for(var n,r,o=e.length,i=1;i<o;){for(r=i,n=e[i];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==i++&&(e[r]=n)}return e},s=function(e,t,n,r){for(var o=t.length,i=n.length,a=0,s=0;a<o||s<i;)e[a+s]=a<o&&s<i?r(t[a],n[s])<=0?t[a++]:n[s++]:a<o?t[a++]:n[s++];return e};e.exports=i},7475:function(e,t,n){var r=n(3157),o=n(4411),i=n(111),a=n(5112)("species"),s=Array;e.exports=function(e){var t;return r(e)&&(t=e.constructor,(o(t)&&(t===s||r(t.prototype))||i(t)&&null===(t=t[a]))&&(t=void 0)),void 0===t?s:t}},5417:function(e,t,n){var r=n(7475);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},3411:function(e,t,n){var r=n(9670),o=n(9212);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){o(e,"throw",t)}}},7072:function(e,t,n){var r=n(5112)("iterator"),o=!1;try{var i=0,a={next:function(){return{done:!!i++}},return:function(){o=!0}};a[r]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var i={};i[r]=function(){return{next:function(){return{done:n=!0}}}},e(i)}catch(e){}return n}},4326:function(e,t,n){var r=n(1702),o=r({}.toString),i=r("".slice);e.exports=function(e){return i(o(e),8,-1)}},648:function(e,t,n){var r=n(1694),o=n(614),i=n(4326),a=n(5112)("toStringTag"),s=Object,c="Arguments"==i(function(){return arguments}());e.exports=r?i:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=s(e),a))?n:c?i(t):"Object"==(r=i(t))&&o(t.callee)?"Arguments":r}},5631:function(e,t,n){"use strict";var r=n(30),o=n(7045),i=n(9190),a=n(9974),s=n(5787),c=n(8554),l=n(408),u=n(1656),d=n(6178),p=n(6340),h=n(9781),f=n(2423).fastKey,m=n(9909),v=m.set,g=m.getterFor;e.exports={getConstructor:function(e,t,n,u){var d=e((function(e,o){s(e,p),v(e,{type:t,index:r(null),first:void 0,last:void 0,size:0}),h||(e.size=0),c(o)||l(o,e[u],{that:e,AS_ENTRIES:n})})),p=d.prototype,m=g(t),E=function(e,t,n){var r,o,i=m(e),a=y(e,t);return a?a.value=n:(i.last=a={index:o=f(t,!0),key:t,value:n,previous:r=i.last,next:void 0,removed:!1},i.first||(i.first=a),r&&(r.next=a),h?i.size++:e.size++,"F"!==o&&(i.index[o]=a)),e},y=function(e,t){var n,r=m(e),o=f(t);if("F"!==o)return r.index[o];for(n=r.first;n;n=n.next)if(n.key==t)return n};return i(p,{clear:function(){for(var e=m(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,h?e.size=0:this.size=0},delete:function(e){var t=this,n=m(t),r=y(t,e);if(r){var o=r.next,i=r.previous;delete n.index[r.index],r.removed=!0,i&&(i.next=o),o&&(o.previous=i),n.first==r&&(n.first=o),n.last==r&&(n.last=i),h?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=m(this),r=a(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!y(this,e)}}),i(p,n?{get:function(e){var t=y(this,e);return t&&t.value},set:function(e,t){return E(this,0===e?0:e,t)}}:{add:function(e){return E(this,e=0===e?0:e,e)}}),h&&o(p,"size",{configurable:!0,get:function(){return m(this).size}}),d},setStrong:function(e,t,n){var r=t+" Iterator",o=g(t),i=g(r);u(e,t,(function(e,t){v(this,{type:r,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=i(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?d("keys"==t?n.key:"values"==t?n.value:[n.key,n.value],!1):(e.target=void 0,d(void 0,!0))}),n?"entries":"values",!n,!0),p(t)}}},7710:function(e,t,n){"use strict";var r=n(2109),o=n(7854),i=n(1702),a=n(4705),s=n(8052),c=n(2423),l=n(408),u=n(5787),d=n(614),p=n(8554),h=n(111),f=n(7293),m=n(7072),v=n(8003),g=n(9587);e.exports=function(e,t,n){var E=-1!==e.indexOf("Map"),y=-1!==e.indexOf("Weak"),_=E?"set":"add",b=o[e],T=b&&b.prototype,S=b,O={},R=function(e){var t=i(T[e]);s(T,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(y&&!h(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return y&&!h(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(y&&!h(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})};if(a(e,!d(b)||!(y||T.forEach&&!f((function(){(new b).entries().next()})))))S=n.getConstructor(t,e,E,_),c.enable();else if(a(e,!0)){var C=new S,w=C[_](y?{}:-0,1)!=C,I=f((function(){C.has(1)})),A=m((function(e){new b(e)})),N=!y&&f((function(){for(var e=new b,t=5;t--;)e[_](t,t);return!e.has(-0)}));A||((S=t((function(e,t){u(e,T);var n=g(new b,e,S);return p(t)||l(t,n[_],{that:n,AS_ENTRIES:E}),n}))).prototype=T,T.constructor=S),(I||N)&&(R("delete"),R("has"),E&&R("get")),(N||w)&&R(_),y&&T.clear&&delete T.clear}return O[e]=S,r({global:!0,constructor:!0,forced:S!=b},O),v(S,e),y||n.setStrong(S,e,E),S}},9920:function(e,t,n){var r=n(2597),o=n(3887),i=n(1236),a=n(3070);e.exports=function(e,t,n){for(var s=o(t),c=a.f,l=i.f,u=0;u<s.length;u++){var d=s[u];r(e,d)||n&&r(n,d)||c(e,d,l(t,d))}}},4964:function(e,t,n){var r=n(5112)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},8544:function(e,t,n){var r=n(7293);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},6178:function(e){e.exports=function(e,t){return{value:e,done:t}}},8880:function(e,t,n){var r=n(9781),o=n(3070),i=n(9114);e.exports=r?function(e,t,n){return o.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},9114:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},6135:function(e,t,n){"use strict";var r=n(4948),o=n(3070),i=n(9114);e.exports=function(e,t,n){var a=r(t);a in e?o.f(e,a,i(0,n)):e[a]=n}},7045:function(e,t,n){var r=n(6339),o=n(3070);e.exports=function(e,t,n){return n.get&&r(n.get,t,{getter:!0}),n.set&&r(n.set,t,{setter:!0}),o.f(e,t,n)}},8052:function(e,t,n){var r=n(614),o=n(3070),i=n(6339),a=n(3072);e.exports=function(e,t,n,s){s||(s={});var c=s.enumerable,l=void 0!==s.name?s.name:t;if(r(n)&&i(n,l,s),s.global)c?e[t]=n:a(t,n);else{try{s.unsafe?e[t]&&(c=!0):delete e[t]}catch(e){}c?e[t]=n:o.f(e,t,{value:n,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return e}},9190:function(e,t,n){var r=n(8052);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},3072:function(e,t,n){var r=n(7854),o=Object.defineProperty;e.exports=function(e,t){try{o(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},5117:function(e,t,n){"use strict";var r=n(6330),o=TypeError;e.exports=function(e,t){if(!delete e[t])throw o("Cannot delete property "+r(t)+" of "+r(e))}},9781:function(e,t,n){var r=n(7293);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4154:function(e){var t="object"==typeof document&&document.all,n=void 0===t&&void 0!==t;e.exports={all:t,IS_HTMLDDA:n}},317:function(e,t,n){var r=n(7854),o=n(111),i=r.document,a=o(i)&&o(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},7207:function(e){var t=TypeError;e.exports=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}},8324:function(e){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8509:function(e,t,n){var r=n(317)("span").classList,o=r&&r.constructor&&r.constructor.prototype;e.exports=o===Object.prototype?void 0:o},8886:function(e,t,n){var r=n(8113).match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},7871:function(e,t,n){var r=n(3823),o=n(5268);e.exports=!r&&!o&&"object"==typeof window&&"object"==typeof document},9363:function(e){e.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},3823:function(e){e.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},256:function(e,t,n){var r=n(8113);e.exports=/MSIE|Trident/.test(r)},1528:function(e,t,n){var r=n(8113);e.exports=/ipad|iphone|ipod/i.test(r)&&"undefined"!=typeof Pebble},6833:function(e,t,n){var r=n(8113);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},5268:function(e,n,r){var o=r(4326);e.exports="undefined"!=typeof t&&"process"==o(t)},1036:function(e,t,n){var r=n(8113);e.exports=/web0s(?!.*chrome)/i.test(r)},8113:function(e){e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},7392:function(e,t,n){var r,o,i=n(7854),a=n(8113),s=i.process,c=i.Deno,l=s&&s.versions||c&&c.version,u=l&&l.v8;u&&(o=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(o=+r[1]),e.exports=o},8008:function(e,t,n){var r=n(8113).match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},748:function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:function(e,t,n){var r=n(7854),o=n(1236).f,i=n(8880),a=n(8052),s=n(3072),c=n(9920),l=n(4705);e.exports=function(e,t){var n,u,d,p,h,f=e.target,m=e.global,v=e.stat;if(n=m?r:v?r[f]||s(f,{}):(r[f]||{}).prototype)for(u in t){if(p=t[u],d=e.dontCallGetSet?(h=o(n,u))&&h.value:n[u],!l(m?u:f+(v?".":"#")+u,e.forced)&&void 0!==d){if(typeof p==typeof d)continue;c(p,d)}(e.sham||d&&d.sham)&&i(p,"sham",!0),a(n,u,p,e)}}},7293:function(e){e.exports=function(e){try{return!!e()}catch(e){return!0}}},7007:function(e,t,n){"use strict";n(4916);var r=n(1470),o=n(8052),i=n(2261),a=n(7293),s=n(5112),c=n(8880),l=s("species"),u=RegExp.prototype;e.exports=function(e,t,n,d){var p=s(e),h=!a((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),f=h&&!a((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[l]=function(){return n},n.flags="",n[p]=/./[p]),n.exec=function(){return t=!0,null},n[p](""),!t}));if(!h||!f||n){var m=r(/./[p]),v=t(p,""[e],(function(e,t,n,o,a){var s=r(e),c=t.exec;return c===i||c===u.exec?h&&!a?{done:!0,value:m(t,n,o)}:{done:!0,value:s(n,t,o)}:{done:!1}}));o(String.prototype,e,v[0]),o(u,p,v[1])}d&&c(u[p],"sham",!0)}},6677:function(e,t,n){var r=n(7293);e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},2104:function(e,t,n){var r=n(4374),o=Function.prototype,i=o.apply,a=o.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(i):function(){return a.apply(i,arguments)})},9974:function(e,t,n){var r=n(1470),o=n(9662),i=n(4374),a=r(r.bind);e.exports=function(e,t){return o(e),void 0===t?e:i?a(e,t):function(){return e.apply(t,arguments)}}},4374:function(e,t,n){var r=n(7293);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},7065:function(e,t,n){"use strict";var r=n(1702),o=n(9662),i=n(111),a=n(2597),s=n(206),c=n(4374),l=Function,u=r([].concat),d=r([].join),p={};e.exports=c?l.bind:function(e){var t=o(this),n=t.prototype,r=s(arguments,1),c=function(){var n=u(r,s(arguments));return this instanceof c?function(e,t,n){if(!a(p,t)){for(var r=[],o=0;o<t;o++)r[o]="a["+o+"]";p[t]=l("C,a","return new C("+d(r,",")+")")}return p[t](e,n)}(t,n.length,n):t.apply(e,n)};return i(n)&&(c.prototype=n),c}},6916:function(e,t,n){var r=n(4374),o=Function.prototype.call;e.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},6530:function(e,t,n){var r=n(9781),o=n(2597),i=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,s=o(i,"name"),c=s&&"something"===function(){}.name,l=s&&(!r||r&&a(i,"name").configurable);e.exports={EXISTS:s,PROPER:c,CONFIGURABLE:l}},5668:function(e,t,n){var r=n(1702),o=n(9662);e.exports=function(e,t,n){try{return r(o(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}}},1470:function(e,t,n){var r=n(4326),o=n(1702);e.exports=function(e){if("Function"===r(e))return o(e)}},1702:function(e,t,n){var r=n(4374),o=Function.prototype,i=o.call,a=r&&o.bind.bind(i,i);e.exports=r?a:function(e){return function(){return i.apply(e,arguments)}}},5005:function(e,t,n){var r=n(7854),o=n(614);e.exports=function(e,t){return arguments.length<2?(n=r[e],o(n)?n:void 0):r[e]&&r[e][t];var n}},1246:function(e,t,n){var r=n(648),o=n(8173),i=n(8554),a=n(7497),s=n(5112)("iterator");e.exports=function(e){if(!i(e))return o(e,s)||o(e,"@@iterator")||a[r(e)]}},4121:function(e,t,n){var r=n(6916),o=n(9662),i=n(9670),a=n(6330),s=n(1246),c=TypeError;e.exports=function(e,t){var n=arguments.length<2?s(e):t;if(o(n))return i(r(n,e));throw c(a(e)+" is not iterable")}},8044:function(e,t,n){var r=n(1702),o=n(3157),i=n(614),a=n(4326),s=n(1340),c=r([].push);e.exports=function(e){if(i(e))return e;if(o(e)){for(var t=e.length,n=[],r=0;r<t;r++){var l=e[r];"string"==typeof l?c(n,l):"number"!=typeof l&&"Number"!=a(l)&&"String"!=a(l)||c(n,s(l))}var u=n.length,d=!0;return function(e,t){if(d)return d=!1,t;if(o(this))return t;for(var r=0;r<u;r++)if(n[r]===e)return t}}}},8173:function(e,t,n){var r=n(9662),o=n(8554);e.exports=function(e,t){var n=e[t];return o(n)?void 0:r(n)}},7854:function(e,t,n){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||this||Function("return this")()},2597:function(e,t,n){var r=n(1702),o=n(7908),i=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return i(o(e),t)}},3501:function(e){e.exports={}},842:function(e){e.exports=function(e,t){try{1==arguments.length?console.error(e):console.error(e,t)}catch(e){}}},490:function(e,t,n){var r=n(5005);e.exports=r("document","documentElement")},4664:function(e,t,n){var r=n(9781),o=n(7293),i=n(317);e.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},1179:function(e){var t=Array,n=Math.abs,r=Math.pow,o=Math.floor,i=Math.log,a=Math.LN2;e.exports={pack:function(e,s,c){var l,u,d,p=t(c),h=8*c-s-1,f=(1<<h)-1,m=f>>1,v=23===s?r(2,-24)-r(2,-77):0,g=e<0||0===e&&1/e<0?1:0,E=0;for((e=n(e))!=e||e===1/0?(u=e!=e?1:0,l=f):(l=o(i(e)/a),e*(d=r(2,-l))<1&&(l--,d*=2),(e+=l+m>=1?v/d:v*r(2,1-m))*d>=2&&(l++,d/=2),l+m>=f?(u=0,l=f):l+m>=1?(u=(e*d-1)*r(2,s),l+=m):(u=e*r(2,m-1)*r(2,s),l=0));s>=8;)p[E++]=255&u,u/=256,s-=8;for(l=l<<s|u,h+=s;h>0;)p[E++]=255&l,l/=256,h-=8;return p[--E]|=128*g,p},unpack:function(e,t){var n,o=e.length,i=8*o-t-1,a=(1<<i)-1,s=a>>1,c=i-7,l=o-1,u=e[l--],d=127&u;for(u>>=7;c>0;)d=256*d+e[l--],c-=8;for(n=d&(1<<-c)-1,d>>=-c,c+=t;c>0;)n=256*n+e[l--],c-=8;if(0===d)d=1-s;else{if(d===a)return n?NaN:u?-1/0:1/0;n+=r(2,t),d-=s}return(u?-1:1)*n*r(2,d-t)}}},8361:function(e,t,n){var r=n(1702),o=n(7293),i=n(4326),a=Object,s=r("".split);e.exports=o((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?s(e,""):a(e)}:a},9587:function(e,t,n){var r=n(614),o=n(111),i=n(7674);e.exports=function(e,t,n){var a,s;return i&&r(a=t.constructor)&&a!==n&&o(s=a.prototype)&&s!==n.prototype&&i(e,s),e}},2788:function(e,t,n){var r=n(1702),o=n(614),i=n(5465),a=r(Function.toString);o(i.inspectSource)||(i.inspectSource=function(e){return a(e)}),e.exports=i.inspectSource},2423:function(e,t,n){var r=n(2109),o=n(1702),i=n(3501),a=n(111),s=n(2597),c=n(3070).f,l=n(8006),u=n(1156),d=n(2050),p=n(9711),h=n(6677),f=!1,m=p("meta"),v=0,g=function(e){c(e,m,{value:{objectID:"O"+v++,weakData:{}}})},E=e.exports={enable:function(){E.enable=function(){},f=!0;var e=l.f,t=o([].splice),n={};n[m]=1,e(n).length&&(l.f=function(n){for(var r=e(n),o=0,i=r.length;o<i;o++)if(r[o]===m){t(r,o,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,m)){if(!d(e))return"F";if(!t)return"E";g(e)}return e[m].objectID},getWeakData:function(e,t){if(!s(e,m)){if(!d(e))return!0;if(!t)return!1;g(e)}return e[m].weakData},onFreeze:function(e){return h&&f&&d(e)&&!s(e,m)&&g(e),e}};i[m]=!0},9909:function(e,t,n){var r,o,i,a=n(4811),s=n(7854),c=n(111),l=n(8880),u=n(2597),d=n(5465),p=n(6200),h=n(3501),f="Object already initialized",m=s.TypeError,v=s.WeakMap;if(a||d.state){var g=d.state||(d.state=new v);g.get=g.get,g.has=g.has,g.set=g.set,r=function(e,t){if(g.has(e))throw m(f);return t.facade=e,g.set(e,t),t},o=function(e){return g.get(e)||{}},i=function(e){return g.has(e)}}else{var E=p("state");h[E]=!0,r=function(e,t){if(u(e,E))throw m(f);return t.facade=e,l(e,E,t),t},o=function(e){return u(e,E)?e[E]:{}},i=function(e){return u(e,E)}}e.exports={set:r,get:o,has:i,enforce:function(e){return i(e)?o(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=o(t)).type!==e)throw m("Incompatible receiver, "+e+" required");return n}}}},7659:function(e,t,n){var r=n(5112),o=n(7497),i=r("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||a[i]===e)}},3157:function(e,t,n){var r=n(4326);e.exports=Array.isArray||function(e){return"Array"==r(e)}},4067:function(e,t,n){var r=n(648);e.exports=function(e){var t=r(e);return"BigInt64Array"==t||"BigUint64Array"==t}},614:function(e,t,n){var r=n(4154),o=r.all;e.exports=r.IS_HTMLDDA?function(e){return"function"==typeof e||e===o}:function(e){return"function"==typeof e}},4411:function(e,t,n){var r=n(1702),o=n(7293),i=n(614),a=n(648),s=n(5005),c=n(2788),l=function(){},u=[],d=s("Reflect","construct"),p=/^\s*(?:class|function)\b/,h=r(p.exec),f=!p.exec(l),m=function(e){if(!i(e))return!1;try{return d(l,u,e),!0}catch(e){return!1}},v=function(e){if(!i(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!h(p,c(e))}catch(e){return!0}};v.sham=!0,e.exports=!d||o((function(){var e;return m(m.call)||!m(Object)||!m((function(){e=!0}))||e}))?v:m},4705:function(e,t,n){var r=n(7293),o=n(614),i=/#|\.prototype\./,a=function(e,t){var n=c[s(e)];return n==u||n!=l&&(o(t)?r(t):!!t)},s=a.normalize=function(e){return String(e).replace(i,".").toLowerCase()},c=a.data={},l=a.NATIVE="N",u=a.POLYFILL="P";e.exports=a},5988:function(e,t,n){var r=n(111),o=Math.floor;e.exports=Number.isInteger||function(e){return!r(e)&&isFinite(e)&&o(e)===e}},8554:function(e){e.exports=function(e){return null==e}},111:function(e,t,n){var r=n(614),o=n(4154),i=o.all;e.exports=o.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:r(e)||e===i}:function(e){return"object"==typeof e?null!==e:r(e)}},1913:function(e){e.exports=!1},7850:function(e,t,n){var r=n(111),o=n(4326),i=n(5112)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[i])?!!t:"RegExp"==o(e))}},2190:function(e,t,n){var r=n(5005),o=n(614),i=n(7976),a=n(3307),s=Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return o(t)&&i(t.prototype,s(e))}},408:function(e,t,n){var r=n(9974),o=n(6916),i=n(9670),a=n(6330),s=n(7659),c=n(6244),l=n(7976),u=n(4121),d=n(1246),p=n(9212),h=TypeError,f=function(e,t){this.stopped=e,this.result=t},m=f.prototype;e.exports=function(e,t,n){var v,g,E,y,_,b,T,S=n&&n.that,O=!(!n||!n.AS_ENTRIES),R=!(!n||!n.IS_RECORD),C=!(!n||!n.IS_ITERATOR),w=!(!n||!n.INTERRUPTED),I=r(t,S),A=function(e){return v&&p(v,"normal",e),new f(!0,e)},N=function(e){return O?(i(e),w?I(e[0],e[1],A):I(e[0],e[1])):w?I(e,A):I(e)};if(R)v=e.iterator;else if(C)v=e;else{if(!(g=d(e)))throw h(a(e)+" is not iterable");if(s(g)){for(E=0,y=c(e);y>E;E++)if((_=N(e[E]))&&l(m,_))return _;return new f(!1)}v=u(e,g)}for(b=R?e.next:v.next;!(T=o(b,v)).done;){try{_=N(T.value)}catch(e){p(v,"throw",e)}if("object"==typeof _&&_&&l(m,_))return _}return new f(!1)}},9212:function(e,t,n){var r=n(6916),o=n(9670),i=n(8173);e.exports=function(e,t,n){var a,s;o(e);try{if(!(a=i(e,"return"))){if("throw"===t)throw n;return n}a=r(a,e)}catch(e){s=!0,a=e}if("throw"===t)throw n;if(s)throw a;return o(a),n}},3061:function(e,t,n){"use strict";var r=n(3383).IteratorPrototype,o=n(30),i=n(9114),a=n(8003),s=n(7497),c=function(){return this};e.exports=function(e,t,n,l){var u=t+" Iterator";return e.prototype=o(r,{next:i(+!l,n)}),a(e,u,!1,!0),s[u]=c,e}},1656:function(e,t,n){"use strict";var r=n(2109),o=n(6916),i=n(1913),a=n(6530),s=n(614),c=n(3061),l=n(9518),u=n(7674),d=n(8003),p=n(8880),h=n(8052),f=n(5112),m=n(7497),v=n(3383),g=a.PROPER,E=a.CONFIGURABLE,y=v.IteratorPrototype,_=v.BUGGY_SAFARI_ITERATORS,b=f("iterator"),T="keys",S="values",O="entries",R=function(){return this};e.exports=function(e,t,n,a,f,v,C){c(n,t,a);var w,I,A,N=function(e){if(e===f&&L)return L;if(!_&&e in D)return D[e];switch(e){case T:case S:case O:return function(){return new n(this,e)}}return function(){return new n(this)}},k=t+" Iterator",P=!1,D=e.prototype,M=D[b]||D["@@iterator"]||f&&D[f],L=!_&&M||N(f),x="Array"==t&&D.entries||M;if(x&&(w=l(x.call(new e)))!==Object.prototype&&w.next&&(i||l(w)===y||(u?u(w,y):s(w[b])||h(w,b,R)),d(w,k,!0,!0),i&&(m[k]=R)),g&&f==S&&M&&M.name!==S&&(!i&&E?p(D,"name",S):(P=!0,L=function(){return o(M,this)})),f)if(I={values:N(S),keys:v?L:N(T),entries:N(O)},C)for(A in I)(_||P||!(A in D))&&h(D,A,I[A]);else r({target:t,proto:!0,forced:_||P},I);return i&&!C||D[b]===L||h(D,b,L,{name:f}),m[t]=L,I}},3383:function(e,t,n){"use strict";var r,o,i,a=n(7293),s=n(614),c=n(111),l=n(30),u=n(9518),d=n(8052),p=n(5112),h=n(1913),f=p("iterator"),m=!1;[].keys&&("next"in(i=[].keys())?(o=u(u(i)))!==Object.prototype&&(r=o):m=!0),!c(r)||a((function(){var e={};return r[f].call(e)!==e}))?r={}:h&&(r=l(r)),s(r[f])||d(r,f,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:m}},7497:function(e){e.exports={}},6244:function(e,t,n){var r=n(7466);e.exports=function(e){return r(e.length)}},6339:function(e,t,n){var r=n(1702),o=n(7293),i=n(614),a=n(2597),s=n(9781),c=n(6530).CONFIGURABLE,l=n(2788),u=n(9909),d=u.enforce,p=u.get,h=String,f=Object.defineProperty,m=r("".slice),v=r("".replace),g=r([].join),E=s&&!o((function(){return 8!==f((function(){}),"length",{value:8}).length})),y=String(String).split("String"),_=e.exports=function(e,t,n){"Symbol("===m(h(t),0,7)&&(t="["+v(h(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!a(e,"name")||c&&e.name!==t)&&(s?f(e,"name",{value:t,configurable:!0}):e.name=t),E&&n&&a(n,"arity")&&e.length!==n.arity&&f(e,"length",{value:n.arity});try{n&&a(n,"constructor")&&n.constructor?s&&f(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=d(e);return a(r,"source")||(r.source=g(y,"string"==typeof t?t:"")),e};Function.prototype.toString=_((function(){return i(this)&&p(this).source||l(this)}),"toString")},4758:function(e){var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},5948:function(e,t,n){var r,o,i,a,s,c=n(7854),l=n(9974),u=n(1236).f,d=n(261).set,p=n(8572),h=n(6833),f=n(1528),m=n(1036),v=n(5268),g=c.MutationObserver||c.WebKitMutationObserver,E=c.document,y=c.process,_=c.Promise,b=u(c,"queueMicrotask"),T=b&&b.value;if(!T){var S=new p,O=function(){var e,t;for(v&&(e=y.domain)&&e.exit();t=S.get();)try{t()}catch(e){throw S.head&&r(),e}e&&e.enter()};h||v||m||!g||!E?!f&&_&&_.resolve?((a=_.resolve(void 0)).constructor=_,s=l(a.then,a),r=function(){s(O)}):v?r=function(){y.nextTick(O)}:(d=l(d,c),r=function(){d(O)}):(o=!0,i=E.createTextNode(""),new g(O).observe(i,{characterData:!0}),r=function(){i.data=o=!o}),T=function(e){S.head||r(),S.add(e)}}e.exports=T},8523:function(e,t,n){"use strict";var r=n(9662),o=TypeError,i=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw o("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new i(e)}},3929:function(e,t,n){var r=n(7850),o=TypeError;e.exports=function(e){if(r(e))throw o("The method doesn't accept regular expressions");return e}},1574:function(e,t,n){"use strict";var r=n(9781),o=n(1702),i=n(6916),a=n(7293),s=n(1956),c=n(5181),l=n(5296),u=n(7908),d=n(8361),p=Object.assign,h=Object.defineProperty,f=o([].concat);e.exports=!p||a((function(){if(r&&1!==p({b:1},p(h({},"a",{enumerable:!0,get:function(){h(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),o="abcdefghijklmnopqrst";return e[n]=7,o.split("").forEach((function(e){t[e]=e})),7!=p({},e)[n]||s(p({},t)).join("")!=o}))?function(e,t){for(var n=u(e),o=arguments.length,a=1,p=c.f,h=l.f;o>a;)for(var m,v=d(arguments[a++]),g=p?f(s(v),p(v)):s(v),E=g.length,y=0;E>y;)m=g[y++],r&&!i(h,v,m)||(n[m]=v[m]);return n}:p},30:function(e,t,n){var r,o=n(9670),i=n(6048),a=n(748),s=n(3501),c=n(490),l=n(317),u=n(6200),d="prototype",p="script",h=u("IE_PROTO"),f=function(){},m=function(e){return"<"+p+">"+e+"</"+p+">"},v=function(e){e.write(m("")),e.close();var t=e.parentWindow.Object;return e=null,t},g=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;g="undefined"!=typeof document?document.domain&&r?v(r):(t=l("iframe"),n="java"+p+":",t.style.display="none",c.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(m("document.F=Object")),e.close(),e.F):v(r);for(var o=a.length;o--;)delete g[d][a[o]];return g()};s[h]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(f[d]=o(e),n=new f,f[d]=null,n[h]=e):n=g(),void 0===t?n:i.f(n,t)}},6048:function(e,t,n){var r=n(9781),o=n(3353),i=n(3070),a=n(9670),s=n(5656),c=n(1956);t.f=r&&!o?Object.defineProperties:function(e,t){a(e);for(var n,r=s(t),o=c(t),l=o.length,u=0;l>u;)i.f(e,n=o[u++],r[n]);return e}},3070:function(e,t,n){var r=n(9781),o=n(4664),i=n(3353),a=n(9670),s=n(4948),c=TypeError,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",p="configurable",h="writable";t.f=r?i?function(e,t,n){if(a(e),t=s(t),a(n),"function"==typeof e&&"prototype"===t&&"value"in n&&h in n&&!n[h]){var r=u(e,t);r&&r[h]&&(e[t]=n.value,n={configurable:p in n?n[p]:r[p],enumerable:d in n?n[d]:r[d],writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(a(e),t=s(t),a(n),o)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},1236:function(e,t,n){var r=n(9781),o=n(6916),i=n(5296),a=n(9114),s=n(5656),c=n(4948),l=n(2597),u=n(4664),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=s(e),t=c(t),u)try{return d(e,t)}catch(e){}if(l(e,t))return a(!o(i.f,e,t),e[t])}},1156:function(e,t,n){var r=n(4326),o=n(5656),i=n(8006).f,a=n(1589),s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"Window"==r(e)?function(e){try{return i(e)}catch(e){return a(s)}}(e):i(o(e))}},8006:function(e,t,n){var r=n(6324),o=n(748).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},5181:function(e,t){t.f=Object.getOwnPropertySymbols},9518:function(e,t,n){var r=n(2597),o=n(614),i=n(7908),a=n(6200),s=n(8544),c=a("IE_PROTO"),l=Object,u=l.prototype;e.exports=s?l.getPrototypeOf:function(e){var t=i(e);if(r(t,c))return t[c];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof l?u:null}},2050:function(e,t,n){var r=n(7293),o=n(111),i=n(4326),a=n(7556),s=Object.isExtensible,c=r((function(){s(1)}));e.exports=c||a?function(e){return!!o(e)&&(!a||"ArrayBuffer"!=i(e))&&(!s||s(e))}:s},7976:function(e,t,n){var r=n(1702);e.exports=r({}.isPrototypeOf)},6324:function(e,t,n){var r=n(1702),o=n(2597),i=n(5656),a=n(1318).indexOf,s=n(3501),c=r([].push);e.exports=function(e,t){var n,r=i(e),l=0,u=[];for(n in r)!o(s,n)&&o(r,n)&&c(u,n);for(;t.length>l;)o(r,n=t[l++])&&(~a(u,n)||c(u,n));return u}},1956:function(e,t,n){var r=n(6324),o=n(748);e.exports=Object.keys||function(e){return r(e,o)}},5296:function(e,t){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);t.f=o?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},7674:function(e,t,n){var r=n(5668),o=n(9670),i=n(6077);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return o(n),i(r),t?e(n,r):n.__proto__=r,n}}():void 0)},4699:function(e,t,n){var r=n(9781),o=n(1702),i=n(1956),a=n(5656),s=o(n(5296).f),c=o([].push),l=function(e){return function(t){for(var n,o=a(t),l=i(o),u=l.length,d=0,p=[];u>d;)n=l[d++],r&&!s(o,n)||c(p,e?[n,o[n]]:o[n]);return p}};e.exports={entries:l(!0),values:l(!1)}},288:function(e,t,n){"use strict";var r=n(1694),o=n(648);e.exports=r?{}.toString:function(){return"[object "+o(this)+"]"}},2140:function(e,t,n){var r=n(6916),o=n(614),i=n(111),a=TypeError;e.exports=function(e,t){var n,s;if("string"===t&&o(n=e.toString)&&!i(s=r(n,e)))return s;if(o(n=e.valueOf)&&!i(s=r(n,e)))return s;if("string"!==t&&o(n=e.toString)&&!i(s=r(n,e)))return s;throw a("Can't convert object to primitive value")}},3887:function(e,t,n){var r=n(5005),o=n(1702),i=n(8006),a=n(5181),s=n(9670),c=o([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(s(e)),n=a.f;return n?c(t,n(e)):t}},857:function(e,t,n){var r=n(7854);e.exports=r},2534:function(e){e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},3702:function(e,t,n){var r=n(7854),o=n(2492),i=n(614),a=n(4705),s=n(2788),c=n(5112),l=n(7871),u=n(3823),d=n(1913),p=n(7392),h=o&&o.prototype,f=c("species"),m=!1,v=i(r.PromiseRejectionEvent),g=a("Promise",(function(){var e=s(o),t=e!==String(o);if(!t&&66===p)return!0;if(d&&(!h.catch||!h.finally))return!0;if(!p||p<51||!/native code/.test(e)){var n=new o((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};if((n.constructor={})[f]=r,!(m=n.then((function(){}))instanceof r))return!0}return!t&&(l||u)&&!v}));e.exports={CONSTRUCTOR:g,REJECTION_EVENT:v,SUBCLASSING:m}},2492:function(e,t,n){var r=n(7854);e.exports=r.Promise},9478:function(e,t,n){var r=n(9670),o=n(111),i=n(8523);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=i.f(e);return(0,n.resolve)(t),n.promise}},612:function(e,t,n){var r=n(2492),o=n(7072),i=n(3702).CONSTRUCTOR;e.exports=i||!o((function(e){r.all(e).then(void 0,(function(){}))}))},8572:function(e){var t=function(){this.head=null,this.tail=null};t.prototype={add:function(e){var t={item:e,next:null},n=this.tail;n?n.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}},e.exports=t},7651:function(e,t,n){var r=n(6916),o=n(9670),i=n(614),a=n(4326),s=n(2261),c=TypeError;e.exports=function(e,t){var n=e.exec;if(i(n)){var l=r(n,e,t);return null!==l&&o(l),l}if("RegExp"===a(e))return r(s,e,t);throw c("RegExp#exec called on incompatible receiver")}},2261:function(e,t,n){"use strict";var r,o,i=n(6916),a=n(1702),s=n(1340),c=n(7066),l=n(2999),u=n(2309),d=n(30),p=n(9909).get,h=n(9441),f=n(7168),m=u("native-string-replace",String.prototype.replace),v=RegExp.prototype.exec,g=v,E=a("".charAt),y=a("".indexOf),_=a("".replace),b=a("".slice),T=(o=/b*/g,i(v,r=/a/,"a"),i(v,o,"a"),0!==r.lastIndex||0!==o.lastIndex),S=l.BROKEN_CARET,O=void 0!==/()??/.exec("")[1];(T||O||S||h||f)&&(g=function(e){var t,n,r,o,a,l,u,h=this,f=p(h),R=s(e),C=f.raw;if(C)return C.lastIndex=h.lastIndex,t=i(g,C,R),h.lastIndex=C.lastIndex,t;var w=f.groups,I=S&&h.sticky,A=i(c,h),N=h.source,k=0,P=R;if(I&&(A=_(A,"y",""),-1===y(A,"g")&&(A+="g"),P=b(R,h.lastIndex),h.lastIndex>0&&(!h.multiline||h.multiline&&"\n"!==E(R,h.lastIndex-1))&&(N="(?: "+N+")",P=" "+P,k++),n=new RegExp("^(?:"+N+")",A)),O&&(n=new RegExp("^"+N+"$(?!\\s)",A)),T&&(r=h.lastIndex),o=i(v,I?n:h,P),I?o?(o.input=b(o.input,k),o[0]=b(o[0],k),o.index=h.lastIndex,h.lastIndex+=o[0].length):h.lastIndex=0:T&&o&&(h.lastIndex=h.global?o.index+o[0].length:r),O&&o&&o.length>1&&i(m,o[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(o[a]=void 0)})),o&&w)for(o.groups=l=d(null),a=0;a<w.length;a++)l[(u=w[a])[0]]=o[u[1]];return o}),e.exports=g},7066:function(e,t,n){"use strict";var r=n(9670);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},4706:function(e,t,n){var r=n(6916),o=n(2597),i=n(7976),a=n(7066),s=RegExp.prototype;e.exports=function(e){var t=e.flags;return void 0!==t||"flags"in s||o(e,"flags")||!i(s,e)?t:r(a,e)}},2999:function(e,t,n){var r=n(7293),o=n(7854).RegExp,i=r((function(){var e=o("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),a=i||r((function(){return!o("a","y").sticky})),s=i||r((function(){var e=o("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:s,MISSED_STICKY:a,UNSUPPORTED_Y:i}},9441:function(e,t,n){var r=n(7293),o=n(7854).RegExp;e.exports=r((function(){var e=o(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},7168:function(e,t,n){var r=n(7293),o=n(7854).RegExp;e.exports=r((function(){var e=o("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},4488:function(e,t,n){var r=n(8554),o=TypeError;e.exports=function(e){if(r(e))throw o("Can't call method on "+e);return e}},7152:function(e,t,n){"use strict";var r,o=n(7854),i=n(2104),a=n(614),s=n(9363),c=n(8113),l=n(206),u=n(8053),d=o.Function,p=/MSIE .\./.test(c)||s&&((r=o.Bun.version.split(".")).length<3||0==r[0]&&(r[1]<3||3==r[1]&&0==r[2]));e.exports=function(e,t){var n=t?2:1;return p?function(r,o){var s=u(arguments.length,1)>n,c=a(r)?r:d(r),p=s?l(arguments,n):[],h=s?function(){i(c,this,p)}:c;return t?e(h,o):e(h)}:e}},6340:function(e,t,n){"use strict";var r=n(5005),o=n(7045),i=n(5112),a=n(9781),s=i("species");e.exports=function(e){var t=r(e);a&&t&&!t[s]&&o(t,s,{configurable:!0,get:function(){return this}})}},8003:function(e,t,n){var r=n(3070).f,o=n(2597),i=n(5112)("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!o(e,i)&&r(e,i,{configurable:!0,value:t})}},6200:function(e,t,n){var r=n(2309),o=n(9711),i=r("keys");e.exports=function(e){return i[e]||(i[e]=o(e))}},5465:function(e,t,n){var r=n(7854),o=n(3072),i="__core-js_shared__",a=r[i]||o(i,{});e.exports=a},2309:function(e,t,n){var r=n(1913),o=n(5465);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.30.2",mode:r?"pure":"global",copyright:"\xa9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.2/LICENSE",source:"https://github.com/zloirock/core-js"})},6707:function(e,t,n){var r=n(9670),o=n(9483),i=n(8554),a=n(5112)("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||i(n=r(s)[a])?t:o(n)}},8710:function(e,t,n){var r=n(1702),o=n(9303),i=n(1340),a=n(4488),s=r("".charAt),c=r("".charCodeAt),l=r("".slice),u=function(e){return function(t,n){var r,u,d=i(a(t)),p=o(n),h=d.length;return p<0||p>=h?e?"":void 0:(r=c(d,p))<55296||r>56319||p+1===h||(u=c(d,p+1))<56320||u>57343?e?s(d,p):r:e?l(d,p,p+2):u-56320+(r-55296<<10)+65536}};e.exports={codeAt:u(!1),charAt:u(!0)}},3197:function(e,t,n){var r=n(1702),o=2147483647,i=/[^\0-\u007E]/,a=/[.\u3002\uFF0E\uFF61]/g,s="Overflow: input needs wider integers to process",c=RangeError,l=r(a.exec),u=Math.floor,d=String.fromCharCode,p=r("".charCodeAt),h=r([].join),f=r([].push),m=r("".replace),v=r("".split),g=r("".toLowerCase),E=function(e){return e+22+75*(e<26)},y=function(e,t,n){var r=0;for(e=n?u(e/700):e>>1,e+=u(e/t);e>455;)e=u(e/35),r+=36;return u(r+36*e/(e+38))},_=function(e){var t=[];e=function(e){for(var t=[],n=0,r=e.length;n<r;){var o=p(e,n++);if(o>=55296&&o<=56319&&n<r){var i=p(e,n++);56320==(64512&i)?f(t,((1023&o)<<10)+(1023&i)+65536):(f(t,o),n--)}else f(t,o)}return t}(e);var n,r,i=e.length,a=128,l=0,m=72;for(n=0;n<e.length;n++)(r=e[n])<128&&f(t,d(r));var v=t.length,g=v;for(v&&f(t,"-");g<i;){var _=o;for(n=0;n<e.length;n++)(r=e[n])>=a&&r<_&&(_=r);var b=g+1;if(_-a>u((o-l)/b))throw c(s);for(l+=(_-a)*b,a=_,n=0;n<e.length;n++){if((r=e[n])<a&&++l>o)throw c(s);if(r==a){for(var T=l,S=36;;){var O=S<=m?1:S>=m+26?26:S-m;if(T<O)break;var R=T-O,C=36-O;f(t,d(E(O+R%C))),T=u(R/C),S+=36}f(t,d(E(T))),m=y(l,b,g==v),l=0,g++}}l++,a++}return h(t,"")};e.exports=function(e){var t,n,r=[],o=v(m(g(e),a,"."),".");for(t=0;t<o.length;t++)n=o[t],f(r,l(i,n)?"xn--"+_(n):n);return h(r,".")}},3111:function(e,t,n){var r=n(1702),o=n(4488),i=n(1340),a=n(1361),s=r("".replace),c=RegExp("^["+a+"]+"),l=RegExp("(^|[^"+a+"])["+a+"]+$"),u=function(e){return function(t){var n=i(o(t));return 1&e&&(n=s(n,c,"")),2&e&&(n=s(n,l,"$1")),n}};e.exports={start:u(1),end:u(2),trim:u(3)}},6293:function(e,t,n){var r=n(7392),o=n(7293),i=n(7854).String;e.exports=!!Object.getOwnPropertySymbols&&!o((function(){var e=Symbol();return!i(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},6532:function(e,t,n){var r=n(6916),o=n(5005),i=n(5112),a=n(8052);e.exports=function(){var e=o("Symbol"),t=e&&e.prototype,n=t&&t.valueOf,s=i("toPrimitive");t&&!t[s]&&a(t,s,(function(e){return r(n,this)}),{arity:1})}},2015:function(e,t,n){var r=n(6293);e.exports=r&&!!Symbol.for&&!!Symbol.keyFor},261:function(e,t,n){var r,o,i,a,s=n(7854),c=n(2104),l=n(9974),u=n(614),d=n(2597),p=n(7293),h=n(490),f=n(206),m=n(317),v=n(8053),g=n(6833),E=n(5268),y=s.setImmediate,_=s.clearImmediate,b=s.process,T=s.Dispatch,S=s.Function,O=s.MessageChannel,R=s.String,C=0,w={},I="onreadystatechange";p((function(){r=s.location}));var A=function(e){if(d(w,e)){var t=w[e];delete w[e],t()}},N=function(e){return function(){A(e)}},k=function(e){A(e.data)},P=function(e){s.postMessage(R(e),r.protocol+"//"+r.host)};y&&_||(y=function(e){v(arguments.length,1);var t=u(e)?e:S(e),n=f(arguments,1);return w[++C]=function(){c(t,void 0,n)},o(C),C},_=function(e){delete w[e]},E?o=function(e){b.nextTick(N(e))}:T&&T.now?o=function(e){T.now(N(e))}:O&&!g?(a=(i=new O).port2,i.port1.onmessage=k,o=l(a.postMessage,a)):s.addEventListener&&u(s.postMessage)&&!s.importScripts&&r&&"file:"!==r.protocol&&!p(P)?(o=P,s.addEventListener("message",k,!1)):o=I in m("script")?function(e){h.appendChild(m("script"))[I]=function(){h.removeChild(this),A(e)}}:function(e){setTimeout(N(e),0)}),e.exports={set:y,clear:_}},863:function(e,t,n){var r=n(1702);e.exports=r(1..valueOf)},1400:function(e,t,n){var r=n(9303),o=Math.max,i=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):i(n,t)}},4599:function(e,t,n){var r=n(7593),o=TypeError;e.exports=function(e){var t=r(e,"number");if("number"==typeof t)throw o("Can't convert number to bigint");return BigInt(t)}},7067:function(e,t,n){var r=n(9303),o=n(7466),i=RangeError;e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=o(t);if(t!==n)throw i("Wrong length or index");return n}},5656:function(e,t,n){var r=n(8361),o=n(4488);e.exports=function(e){return r(o(e))}},9303:function(e,t,n){var r=n(4758);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},7466:function(e,t,n){var r=n(9303),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},7908:function(e,t,n){var r=n(4488),o=Object;e.exports=function(e){return o(r(e))}},4590:function(e,t,n){var r=n(3002),o=RangeError;e.exports=function(e,t){var n=r(e);if(n%t)throw o("Wrong offset");return n}},3002:function(e,t,n){var r=n(9303),o=RangeError;e.exports=function(e){var t=r(e);if(t<0)throw o("The argument can't be less than 0");return t}},7593:function(e,t,n){var r=n(6916),o=n(111),i=n(2190),a=n(8173),s=n(2140),c=n(5112),l=TypeError,u=c("toPrimitive");e.exports=function(e,t){if(!o(e)||i(e))return e;var n,c=a(e,u);if(c){if(void 0===t&&(t="default"),n=r(c,e,t),!o(n)||i(n))return n;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),s(e,t)}},4948:function(e,t,n){var r=n(7593),o=n(2190);e.exports=function(e){var t=r(e,"string");return o(t)?t:t+""}},1694:function(e,t,n){var r={};r[n(5112)("toStringTag")]="z",e.exports="[object z]"===String(r)},1340:function(e,t,n){var r=n(648),o=String;e.exports=function(e){if("Symbol"===r(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},6330:function(e){var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},9843:function(e,t,n){"use strict";var r=n(2109),o=n(7854),i=n(6916),a=n(9781),s=n(3832),c=n(260),l=n(3331),u=n(5787),d=n(9114),p=n(8880),h=n(5988),f=n(7466),m=n(7067),v=n(4590),g=n(4948),E=n(2597),y=n(648),_=n(111),b=n(2190),T=n(30),S=n(7976),O=n(7674),R=n(8006).f,C=n(7321),w=n(2092).forEach,I=n(6340),A=n(7045),N=n(3070),k=n(1236),P=n(9909),D=n(9587),M=P.get,L=P.set,x=P.enforce,U=N.f,j=k.f,F=Math.round,B=o.RangeError,V=l.ArrayBuffer,H=V.prototype,G=l.DataView,W=c.NATIVE_ARRAY_BUFFER_VIEWS,q=c.TYPED_ARRAY_TAG,K=c.TypedArray,Y=c.TypedArrayPrototype,z=c.aTypedArrayConstructor,X=c.isTypedArray,J="BYTES_PER_ELEMENT",Z="Wrong length",Q=function(e,t){z(e);for(var n=0,r=t.length,o=new e(r);r>n;)o[n]=t[n++];return o},$=function(e,t){A(e,t,{configurable:!0,get:function(){return M(this)[t]}})},ee=function(e){var t;return S(H,e)||"ArrayBuffer"==(t=y(e))||"SharedArrayBuffer"==t},te=function(e,t){return X(e)&&!b(t)&&t in e&&h(+t)&&t>=0},ne=function(e,t){return t=g(t),te(e,t)?d(2,e[t]):j(e,t)},re=function(e,t,n){return t=g(t),!(te(e,t)&&_(n)&&E(n,"value"))||E(n,"get")||E(n,"set")||n.configurable||E(n,"writable")&&!n.writable||E(n,"enumerable")&&!n.enumerable?U(e,t,n):(e[t]=n.value,e)};a?(W||(k.f=ne,N.f=re,$(Y,"buffer"),$(Y,"byteOffset"),$(Y,"byteLength"),$(Y,"length")),r({target:"Object",stat:!0,forced:!W},{getOwnPropertyDescriptor:ne,defineProperty:re}),e.exports=function(e,t,n){var a=e.match(/\d+/)[0]/8,c=e+(n?"Clamped":"")+"Array",l="get"+e,d="set"+e,h=o[c],g=h,E=g&&g.prototype,y={},b=function(e,t){U(e,t,{get:function(){return function(e,t){var n=M(e);return n.view[l](t*a+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,r){var o=M(e);n&&(r=(r=F(r))<0?0:r>255?255:255&r),o.view[d](t*a+o.byteOffset,r,!0)}(this,t,e)},enumerable:!0})};W?s&&(g=t((function(e,t,n,r){return u(e,E),D(_(t)?ee(t)?void 0!==r?new h(t,v(n,a),r):void 0!==n?new h(t,v(n,a)):new h(t):X(t)?Q(g,t):i(C,g,t):new h(m(t)),e,g)})),O&&O(g,K),w(R(h),(function(e){e in g||p(g,e,h[e])})),g.prototype=E):(g=t((function(e,t,n,r){u(e,E);var o,s,c,l=0,d=0;if(_(t)){if(!ee(t))return X(t)?Q(g,t):i(C,g,t);o=t,d=v(n,a);var p=t.byteLength;if(void 0===r){if(p%a)throw B(Z);if((s=p-d)<0)throw B(Z)}else if((s=f(r)*a)+d>p)throw B(Z);c=s/a}else c=m(t),o=new V(s=c*a);for(L(e,{buffer:o,byteOffset:d,byteLength:s,length:c,view:new G(o)});l<c;)b(e,l++)})),O&&O(g,K),E=g.prototype=T(Y)),E.constructor!==g&&p(E,"constructor",g),x(E).TypedArrayConstructor=g,q&&p(E,q,c);var S=g!=h;y[c]=g,r({global:!0,constructor:!0,forced:S,sham:!W},y),J in g||p(g,J,a),J in E||p(E,J,a),I(c)}):e.exports=function(){}},3832:function(e,t,n){var r=n(7854),o=n(7293),i=n(7072),a=n(260).NATIVE_ARRAY_BUFFER_VIEWS,s=r.ArrayBuffer,c=r.Int8Array;e.exports=!a||!o((function(){c(1)}))||!o((function(){new c(-1)}))||!i((function(e){new c,new c(null),new c(1.5),new c(e)}),!0)||o((function(){return 1!==new c(new s(2),1,void 0).length}))},3074:function(e,t,n){var r=n(7745),o=n(6304);e.exports=function(e,t){return r(o(e),t)}},7321:function(e,t,n){var r=n(9974),o=n(6916),i=n(9483),a=n(7908),s=n(6244),c=n(4121),l=n(1246),u=n(7659),d=n(4067),p=n(260).aTypedArrayConstructor,h=n(4599);e.exports=function(e){var t,n,f,m,v,g,E,y,_=i(this),b=a(e),T=arguments.length,S=T>1?arguments[1]:void 0,O=void 0!==S,R=l(b);if(R&&!u(R))for(y=(E=c(b,R)).next,b=[];!(g=o(y,E)).done;)b.push(g.value);for(O&&T>2&&(S=r(S,arguments[2])),n=s(b),f=new(p(_))(n),m=d(f),t=0;n>t;t++)v=O?S(b[t],t):b[t],f[t]=m?h(v):+v;return f}},6304:function(e,t,n){var r=n(260),o=n(6707),i=r.aTypedArrayConstructor,a=r.getTypedArrayConstructor;e.exports=function(e){return i(o(e,a(e)))}},9711:function(e,t,n){var r=n(1702),o=0,i=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++o+i,36)}},5143:function(e,t,n){var r=n(7293),o=n(5112),i=n(9781),a=n(1913),s=o("iterator");e.exports=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),a&&!e.toJSON||!t.size&&(a||!i)||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[s]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("http://a#\u0431").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},3307:function(e,t,n){var r=n(6293);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:function(e,t,n){var r=n(9781),o=n(7293);e.exports=r&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8053:function(e){var t=TypeError;e.exports=function(e,n){if(e<n)throw t("Not enough arguments");return e}},4811:function(e,t,n){var r=n(7854),o=n(614),i=r.WeakMap;e.exports=o(i)&&/native code/.test(String(i))},6800:function(e,t,n){var r=n(857),o=n(2597),i=n(6061),a=n(3070).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});o(t,e)||a(t,e,{value:i.f(e)})}},6061:function(e,t,n){var r=n(5112);t.f=r},5112:function(e,t,n){var r=n(7854),o=n(2309),i=n(2597),a=n(9711),s=n(6293),c=n(3307),l=r.Symbol,u=o("wks"),d=c?l.for||l:l&&l.withoutSetter||a;e.exports=function(e){return i(u,e)||(u[e]=s&&i(l,e)?l[e]:d("Symbol."+e)),u[e]}},1361:function(e){e.exports="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff"},9575:function(e,t,n){"use strict";var r=n(2109),o=n(1470),i=n(7293),a=n(3331),s=n(9670),c=n(1400),l=n(7466),u=n(6707),d=a.ArrayBuffer,p=a.DataView,h=p.prototype,f=o(d.prototype.slice),m=o(h.getUint8),v=o(h.setUint8);r({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:i((function(){return!new d(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(f&&void 0===t)return f(s(this),e);for(var n=s(this).byteLength,r=c(e,n),o=c(void 0===t?n:t,n),i=new(u(this,d))(l(o-r)),a=new p(this),h=new p(i),g=0;r<o;)v(h,g++,m(a,r++));return i}})},2222:function(e,t,n){"use strict";var r=n(2109),o=n(7293),i=n(3157),a=n(111),s=n(7908),c=n(6244),l=n(7207),u=n(6135),d=n(5417),p=n(1194),h=n(5112),f=n(7392),m=h("isConcatSpreadable"),v=f>=51||!o((function(){var e=[];return e[m]=!1,e.concat()[0]!==e})),g=function(e){if(!a(e))return!1;var t=e[m];return void 0!==t?!!t:i(e)};r({target:"Array",proto:!0,arity:1,forced:!v||!p("concat")},{concat:function(e){var t,n,r,o,i,a=s(this),p=d(a,0),h=0;for(t=-1,r=arguments.length;t<r;t++)if(g(i=-1===t?a:arguments[t]))for(o=c(i),l(h+o),n=0;n<o;n++,h++)n in i&&u(p,h,i[n]);else l(h+1),u(p,h++,i);return p.length=h,p}})},7327:function(e,t,n){"use strict";var r=n(2109),o=n(2092).filter;r({target:"Array",proto:!0,forced:!n(1194)("filter")},{filter:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},4553:function(e,t,n){"use strict";var r=n(2109),o=n(2092).findIndex,i=n(1223),a="findIndex",s=!0;a in[]&&Array(1)[a]((function(){s=!1})),r({target:"Array",proto:!0,forced:s},{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),i(a)},9826:function(e,t,n){"use strict";var r=n(2109),o=n(2092).find,i=n(1223),a="find",s=!0;a in[]&&Array(1)[a]((function(){s=!1})),r({target:"Array",proto:!0,forced:s},{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),i(a)},9554:function(e,t,n){"use strict";var r=n(2109),o=n(8533);r({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},1038:function(e,t,n){var r=n(2109),o=n(8457);r({target:"Array",stat:!0,forced:!n(7072)((function(e){Array.from(e)}))},{from:o})},6699:function(e,t,n){"use strict";var r=n(2109),o=n(1318).includes,i=n(7293),a=n(1223);r({target:"Array",proto:!0,forced:i((function(){return!Array(1).includes()}))},{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")},2772:function(e,t,n){"use strict";var r=n(2109),o=n(1470),i=n(1318).indexOf,a=n(9341),s=o([].indexOf),c=!!s&&1/s([1],1,-0)<0;r({target:"Array",proto:!0,forced:c||!a("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return c?s(this,e,t)||0:i(this,e,t)}})},9753:function(e,t,n){n(2109)({target:"Array",stat:!0},{isArray:n(3157)})},6992:function(e,t,n){"use strict";var r=n(5656),o=n(1223),i=n(7497),a=n(9909),s=n(3070).f,c=n(1656),l=n(6178),u=n(1913),d=n(9781),p="Array Iterator",h=a.set,f=a.getterFor(p);e.exports=c(Array,"Array",(function(e,t){h(this,{type:p,target:r(e),index:0,kind:t})}),(function(){var e=f(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,l(void 0,!0)):l("keys"==n?r:"values"==n?t[r]:[r,t[r]],!1)}),"values");var m=i.Arguments=i.Array;if(o("keys"),o("values"),o("entries"),!u&&d&&"values"!==m.name)try{s(m,"name",{value:"values"})}catch(e){}},9600:function(e,t,n){"use strict";var r=n(2109),o=n(1702),i=n(8361),a=n(5656),s=n(9341),c=o([].join);r({target:"Array",proto:!0,forced:i!=Object||!s("join",",")},{join:function(e){return c(a(this),void 0===e?",":e)}})},4986:function(e,t,n){var r=n(2109),o=n(6583);r({target:"Array",proto:!0,forced:o!==[].lastIndexOf},{lastIndexOf:o})},1249:function(e,t,n){"use strict";var r=n(2109),o=n(2092).map;r({target:"Array",proto:!0,forced:!n(1194)("map")},{map:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},5827:function(e,t,n){"use strict";var r=n(2109),o=n(3671).left,i=n(9341),a=n(7392);r({target:"Array",proto:!0,forced:!n(5268)&&a>79&&a<83||!i("reduce")},{reduce:function(e){var t=arguments.length;return o(this,e,t,t>1?arguments[1]:void 0)}})},5069:function(e,t,n){"use strict";var r=n(2109),o=n(1702),i=n(3157),a=o([].reverse),s=[1,2];r({target:"Array",proto:!0,forced:String(s)===String(s.reverse())},{reverse:function(){return i(this)&&(this.length=this.length),a(this)}})},7042:function(e,t,n){"use strict";var r=n(2109),o=n(3157),i=n(4411),a=n(111),s=n(1400),c=n(6244),l=n(5656),u=n(6135),d=n(5112),p=n(1194),h=n(206),f=p("slice"),m=d("species"),v=Array,g=Math.max;r({target:"Array",proto:!0,forced:!f},{slice:function(e,t){var n,r,d,p=l(this),f=c(p),E=s(e,f),y=s(void 0===t?f:t,f);if(o(p)&&(n=p.constructor,(i(n)&&(n===v||o(n.prototype))||a(n)&&null===(n=n[m]))&&(n=void 0),n===v||void 0===n))return h(p,E,y);for(r=new(void 0===n?v:n)(g(y-E,0)),d=0;E<y;E++,d++)E in p&&u(r,d,p[E]);return r.length=d,r}})},5212:function(e,t,n){"use strict";var r=n(2109),o=n(2092).some;r({target:"Array",proto:!0,forced:!n(9341)("some")},{some:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},561:function(e,t,n){"use strict";var r=n(2109),o=n(7908),i=n(1400),a=n(9303),s=n(6244),c=n(3658),l=n(7207),u=n(5417),d=n(6135),p=n(5117),h=n(1194)("splice"),f=Math.max,m=Math.min;r({target:"Array",proto:!0,forced:!h},{splice:function(e,t){var n,r,h,v,g,E,y=o(this),_=s(y),b=i(e,_),T=arguments.length;for(0===T?n=r=0:1===T?(n=0,r=_-b):(n=T-2,r=m(f(a(t),0),_-b)),l(_+n-r),h=u(y,r),v=0;v<r;v++)(g=b+v)in y&&d(h,v,y[g]);if(h.length=r,n<r){for(v=b;v<_-r;v++)E=v+n,(g=v+r)in y?y[E]=y[g]:p(y,E);for(v=_;v>_-r+n;v--)p(y,v-1)}else if(n>r)for(v=_-r;v>b;v--)E=v+n-1,(g=v+r-1)in y?y[E]=y[g]:p(y,E);for(v=0;v<n;v++)y[v+b]=arguments[v+2];return c(y,_-r+n),h}})},3843:function(e,t,n){var r=n(2109),o=n(1702),i=Date,a=o(i.prototype.getTime);r({target:"Date",stat:!0},{now:function(){return a(new i)}})},3710:function(e,t,n){var r=n(1702),o=n(8052),i=Date.prototype,a="Invalid Date",s="toString",c=r(i[s]),l=r(i.getTime);String(new Date(NaN))!=a&&o(i,s,(function(){var e=l(this);return e==e?c(this):a}))},4812:function(e,t,n){var r=n(2109),o=n(7065);r({target:"Function",proto:!0,forced:Function.bind!==o},{bind:o})},8309:function(e,t,n){var r=n(9781),o=n(6530).EXISTS,i=n(1702),a=n(7045),s=Function.prototype,c=i(s.toString),l=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=i(l.exec);r&&!o&&a(s,"name",{configurable:!0,get:function(){try{return u(l,c(this))[1]}catch(e){return""}}})},8862:function(e,t,n){var r=n(2109),o=n(5005),i=n(2104),a=n(6916),s=n(1702),c=n(7293),l=n(614),u=n(2190),d=n(206),p=n(8044),h=n(6293),f=String,m=o("JSON","stringify"),v=s(/./.exec),g=s("".charAt),E=s("".charCodeAt),y=s("".replace),_=s(1..toString),b=/[\uD800-\uDFFF]/g,T=/^[\uD800-\uDBFF]$/,S=/^[\uDC00-\uDFFF]$/,O=!h||c((function(){var e=o("Symbol")();return"[null]"!=m([e])||"{}"!=m({a:e})||"{}"!=m(Object(e))})),R=c((function(){return'"\\udf06\\ud834"'!==m("\udf06\ud834")||'"\\udead"'!==m("\udead")})),C=function(e,t){var n=d(arguments),r=p(t);if(l(r)||void 0!==e&&!u(e))return n[1]=function(e,t){if(l(r)&&(t=a(r,this,f(e),t)),!u(t))return t},i(m,null,n)},w=function(e,t,n){var r=g(n,t-1),o=g(n,t+1);return v(T,e)&&!v(S,o)||v(S,e)&&!v(T,r)?"\\u"+_(E(e,0),16):e};m&&r({target:"JSON",stat:!0,arity:3,forced:O||R},{stringify:function(e,t,n){var r=d(arguments),o=i(O?C:m,null,r);return R&&"string"==typeof o?y(o,b,w):o}})},9098:function(e,t,n){"use strict";n(7710)("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(5631))},1532:function(e,t,n){n(9098)},9653:function(e,t,n){"use strict";var r=n(2109),o=n(1913),i=n(9781),a=n(7854),s=n(857),c=n(1702),l=n(4705),u=n(2597),d=n(9587),p=n(7976),h=n(2190),f=n(7593),m=n(7293),v=n(8006).f,g=n(1236).f,E=n(3070).f,y=n(863),_=n(3111).trim,b="Number",T=a[b],S=s[b],O=T.prototype,R=a.TypeError,C=c("".slice),w=c("".charCodeAt),I=l(b,!T(" 0o1")||!T("0b1")||T("+0x1")),A=function(e){var t,n=arguments.length<1?0:T(function(e){var t=f(e,"number");return"bigint"==typeof t?t:function(e){var t,n,r,o,i,a,s,c,l=f(e,"number");if(h(l))throw R("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(l=_(l),43===(t=w(l,0))||45===t){if(88===(n=w(l,2))||120===n)return NaN}else if(48===t){switch(w(l,1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+l}for(a=(i=C(l,2)).length,s=0;s<a;s++)if((c=w(i,s))<48||c>o)return NaN;return parseInt(i,r)}return+l}(t)}(e));return p(O,t=this)&&m((function(){y(t)}))?d(Object(n),this,A):n};A.prototype=O,I&&!o&&(O.constructor=A),r({global:!0,constructor:!0,wrap:!0,forced:I},{Number:A});var N=function(e,t){for(var n,r=i?v(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),o=0;r.length>o;o++)u(t,n=r[o])&&!u(e,n)&&E(e,n,g(t,n))};o&&S&&N(s[b],S),(I||o)&&N(s[b],T)},3161:function(e,t,n){n(2109)({target:"Number",stat:!0},{isInteger:n(5988)})},4048:function(e,t,n){n(2109)({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},9601:function(e,t,n){var r=n(2109),o=n(1574);r({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},9070:function(e,t,n){var r=n(2109),o=n(9781),i=n(3070).f;r({target:"Object",stat:!0,forced:Object.defineProperty!==i,sham:!o},{defineProperty:i})},9720:function(e,t,n){var r=n(2109),o=n(4699).entries;r({target:"Object",stat:!0},{entries:function(e){return o(e)}})},9660:function(e,t,n){var r=n(2109),o=n(6293),i=n(7293),a=n(5181),s=n(7908);r({target:"Object",stat:!0,forced:!o||i((function(){a.f(1)}))},{getOwnPropertySymbols:function(e){var t=a.f;return t?t(s(e)):[]}})},7941:function(e,t,n){var r=n(2109),o=n(7908),i=n(1956);r({target:"Object",stat:!0,forced:n(7293)((function(){i(1)}))},{keys:function(e){return i(o(e))}})},1539:function(e,t,n){var r=n(1694),o=n(8052),i=n(288);r||o(Object.prototype,"toString",i,{unsafe:!0})},821:function(e,t,n){"use strict";var r=n(2109),o=n(6916),i=n(9662),a=n(8523),s=n(2534),c=n(408);r({target:"Promise",stat:!0,forced:n(612)},{all:function(e){var t=this,n=a.f(t),r=n.resolve,l=n.reject,u=s((function(){var n=i(t.resolve),a=[],s=0,u=1;c(e,(function(e){var i=s++,c=!1;u++,o(n,t,e).then((function(e){c||(c=!0,a[i]=e,--u||r(a))}),l)})),--u||r(a)}));return u.error&&l(u.value),n.promise}})},4164:function(e,t,n){"use strict";var r=n(2109),o=n(1913),i=n(3702).CONSTRUCTOR,a=n(2492),s=n(5005),c=n(614),l=n(8052),u=a&&a.prototype;if(r({target:"Promise",proto:!0,forced:i,real:!0},{catch:function(e){return this.then(void 0,e)}}),!o&&c(a)){var d=s("Promise").prototype.catch;u.catch!==d&&l(u,"catch",d,{unsafe:!0})}},3401:function(e,t,n){"use strict";var r,o,i,a=n(2109),s=n(1913),c=n(5268),l=n(7854),u=n(6916),d=n(8052),p=n(7674),h=n(8003),f=n(6340),m=n(9662),v=n(614),g=n(111),E=n(5787),y=n(6707),_=n(261).set,b=n(5948),T=n(842),S=n(2534),O=n(8572),R=n(9909),C=n(2492),w=n(3702),I=n(8523),A="Promise",N=w.CONSTRUCTOR,k=w.REJECTION_EVENT,P=w.SUBCLASSING,D=R.getterFor(A),M=R.set,L=C&&C.prototype,x=C,U=L,j=l.TypeError,F=l.document,B=l.process,V=I.f,H=V,G=!!(F&&F.createEvent&&l.dispatchEvent),W="unhandledrejection",q=function(e){var t;return!(!g(e)||!v(t=e.then))&&t},K=function(e,t){var n,r,o,i=t.value,a=1==t.state,s=a?e.ok:e.fail,c=e.resolve,l=e.reject,d=e.domain;try{s?(a||(2===t.rejection&&Z(t),t.rejection=1),!0===s?n=i:(d&&d.enter(),n=s(i),d&&(d.exit(),o=!0)),n===e.promise?l(j("Promise-chain cycle")):(r=q(n))?u(r,n,c,l):c(n)):l(i)}catch(e){d&&!o&&d.exit(),l(e)}},Y=function(e,t){e.notified||(e.notified=!0,b((function(){for(var n,r=e.reactions;n=r.get();)K(n,e);e.notified=!1,t&&!e.rejection&&X(e)})))},z=function(e,t,n){var r,o;G?((r=F.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),l.dispatchEvent(r)):r={promise:t,reason:n},!k&&(o=l["on"+e])?o(r):e===W&&T("Unhandled promise rejection",n)},X=function(e){u(_,l,(function(){var t,n=e.facade,r=e.value;if(J(e)&&(t=S((function(){c?B.emit("unhandledRejection",r,n):z(W,n,r)})),e.rejection=c||J(e)?2:1,t.error))throw t.value}))},J=function(e){return 1!==e.rejection&&!e.parent},Z=function(e){u(_,l,(function(){var t=e.facade;c?B.emit("rejectionHandled",t):z("rejectionhandled",t,e.value)}))},Q=function(e,t,n){return function(r){e(t,r,n)}},$=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Y(e,!0))},ee=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw j("Promise can't be resolved itself");var r=q(t);r?b((function(){var n={done:!1};try{u(r,t,Q(ee,n,e),Q($,n,e))}catch(t){$(n,t,e)}})):(e.value=t,e.state=1,Y(e,!1))}catch(t){$({done:!1},t,e)}}};if(N&&(U=(x=function(e){E(this,U),m(e),u(r,this);var t=D(this);try{e(Q(ee,t),Q($,t))}catch(e){$(t,e)}}).prototype,(r=function(e){M(this,{type:A,done:!1,notified:!1,parent:!1,reactions:new O,rejection:!1,state:0,value:void 0})}).prototype=d(U,"then",(function(e,t){var n=D(this),r=V(y(this,x));return n.parent=!0,r.ok=!v(e)||e,r.fail=v(t)&&t,r.domain=c?B.domain:void 0,0==n.state?n.reactions.add(r):b((function(){K(r,n)})),r.promise})),o=function(){var e=new r,t=D(e);this.promise=e,this.resolve=Q(ee,t),this.reject=Q($,t)},I.f=V=function(e){return e===x||void 0===e?new o(e):H(e)},!s&&v(C)&&L!==Object.prototype)){i=L.then,P||d(L,"then",(function(e,t){var n=this;return new x((function(e,t){u(i,n,e,t)})).then(e,t)}),{unsafe:!0});try{delete L.constructor}catch(e){}p&&p(L,U)}a({global:!0,constructor:!0,wrap:!0,forced:N},{Promise:x}),h(x,A,!1,!0),f(A)},8674:function(e,t,n){n(3401),n(821),n(4164),n(6027),n(683),n(6294)},6027:function(e,t,n){"use strict";var r=n(2109),o=n(6916),i=n(9662),a=n(8523),s=n(2534),c=n(408);r({target:"Promise",stat:!0,forced:n(612)},{race:function(e){var t=this,n=a.f(t),r=n.reject,l=s((function(){var a=i(t.resolve);c(e,(function(e){o(a,t,e).then(n.resolve,r)}))}));return l.error&&r(l.value),n.promise}})},683:function(e,t,n){"use strict";var r=n(2109),o=n(6916),i=n(8523);r({target:"Promise",stat:!0,forced:n(3702).CONSTRUCTOR},{reject:function(e){var t=i.f(this);return o(t.reject,void 0,e),t.promise}})},6294:function(e,t,n){"use strict";var r=n(2109),o=n(5005),i=n(1913),a=n(2492),s=n(3702).CONSTRUCTOR,c=n(9478),l=o("Promise"),u=i&&!s;r({target:"Promise",stat:!0,forced:i||s},{resolve:function(e){return c(u&&this===l?a:this,e)}})},4916:function(e,t,n){"use strict";var r=n(2109),o=n(2261);r({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},9714:function(e,t,n){"use strict";var r=n(6530).PROPER,o=n(8052),i=n(9670),a=n(1340),s=n(7293),c=n(4706),l="toString",u=RegExp.prototype[l],d=s((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),p=r&&u.name!=l;(d||p)&&o(RegExp.prototype,l,(function(){var e=i(this);return"/"+a(e.source)+"/"+a(c(e))}),{unsafe:!0})},2023:function(e,t,n){"use strict";var r=n(2109),o=n(1702),i=n(3929),a=n(4488),s=n(1340),c=n(4964),l=o("".indexOf);r({target:"String",proto:!0,forced:!c("includes")},{includes:function(e){return!!~l(s(a(this)),s(i(e)),arguments.length>1?arguments[1]:void 0)}})},8783:function(e,t,n){"use strict";var r=n(8710).charAt,o=n(1340),i=n(9909),a=n(1656),s=n(6178),c="String Iterator",l=i.set,u=i.getterFor(c);a(String,"String",(function(e){l(this,{type:c,string:o(e),index:0})}),(function(){var e,t=u(this),n=t.string,o=t.index;return o>=n.length?s(void 0,!0):(e=r(n,o),t.index+=e.length,s(e,!1))}))},3123:function(e,t,n){"use strict";var r=n(2104),o=n(6916),i=n(1702),a=n(7007),s=n(9670),c=n(8554),l=n(7850),u=n(4488),d=n(6707),p=n(1530),h=n(7466),f=n(1340),m=n(8173),v=n(1589),g=n(7651),E=n(2261),y=n(2999),_=n(7293),b=y.UNSUPPORTED_Y,T=4294967295,S=Math.min,O=[].push,R=i(/./.exec),C=i(O),w=i("".slice),I=!_((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));a("split",(function(e,t,n){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var i=f(u(this)),a=void 0===n?T:n>>>0;if(0===a)return[];if(void 0===e)return[i];if(!l(e))return o(t,i,e,a);for(var s,c,d,p=[],h=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),m=0,g=new RegExp(e.source,h+"g");(s=o(E,g,i))&&!((c=g.lastIndex)>m&&(C(p,w(i,m,s.index)),s.length>1&&s.index<i.length&&r(O,p,v(s,1)),d=s[0].length,m=c,p.length>=a));)g.lastIndex===s.index&&g.lastIndex++;return m===i.length?!d&&R(g,"")||C(p,""):C(p,w(i,m)),p.length>a?v(p,0,a):p}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:o(t,this,e,n)}:t,[function(t,n){var r=u(this),a=c(t)?void 0:m(t,e);return a?o(a,t,r,n):o(i,f(r),t,n)},function(e,r){var o=s(this),a=f(e),c=n(i,o,a,r,i!==t);if(c.done)return c.value;var l=d(o,RegExp),u=o.unicode,m=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(b?"g":"y"),v=new l(b?"^(?:"+o.source+")":o,m),E=void 0===r?T:r>>>0;if(0===E)return[];if(0===a.length)return null===g(v,a)?[a]:[];for(var y=0,_=0,O=[];_<a.length;){v.lastIndex=b?0:_;var R,I=g(v,b?w(a,_):a);if(null===I||(R=S(h(v.lastIndex+(b?_:0)),a.length))===y)_=p(a,_,u);else{if(C(O,w(a,y,_)),O.length===E)return O;for(var A=1;A<=I.length-1;A++)if(C(O,I[A]),O.length===E)return O;_=y=R}}return C(O,w(a,y)),O}]}),!I,b)},4032:function(e,t,n){"use strict";var r=n(2109),o=n(7854),i=n(6916),a=n(1702),s=n(1913),c=n(9781),l=n(6293),u=n(7293),d=n(2597),p=n(7976),h=n(9670),f=n(5656),m=n(4948),v=n(1340),g=n(9114),E=n(30),y=n(1956),_=n(8006),b=n(1156),T=n(5181),S=n(1236),O=n(3070),R=n(6048),C=n(5296),w=n(8052),I=n(7045),A=n(2309),N=n(6200),k=n(3501),P=n(9711),D=n(5112),M=n(6061),L=n(6800),x=n(6532),U=n(8003),j=n(9909),F=n(2092).forEach,B=N("hidden"),V="Symbol",H="prototype",G=j.set,W=j.getterFor(V),q=Object[H],K=o.Symbol,Y=K&&K[H],z=o.TypeError,X=o.QObject,J=S.f,Z=O.f,Q=b.f,$=C.f,ee=a([].push),te=A("symbols"),ne=A("op-symbols"),re=A("wks"),oe=!X||!X[H]||!X[H].findChild,ie=c&&u((function(){return 7!=E(Z({},"a",{get:function(){return Z(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=J(q,t);r&&delete q[t],Z(e,t,n),r&&e!==q&&Z(q,t,r)}:Z,ae=function(e,t){var n=te[e]=E(Y);return G(n,{type:V,tag:e,description:t}),c||(n.description=t),n},se=function(e,t,n){e===q&&se(ne,t,n),h(e);var r=m(t);return h(n),d(te,r)?(n.enumerable?(d(e,B)&&e[B][r]&&(e[B][r]=!1),n=E(n,{enumerable:g(0,!1)})):(d(e,B)||Z(e,B,g(1,{})),e[B][r]=!0),ie(e,r,n)):Z(e,r,n)},ce=function(e,t){h(e);var n=f(t),r=y(n).concat(pe(n));return F(r,(function(t){c&&!i(le,n,t)||se(e,t,n[t])})),e},le=function(e){var t=m(e),n=i($,this,t);return!(this===q&&d(te,t)&&!d(ne,t))&&(!(n||!d(this,t)||!d(te,t)||d(this,B)&&this[B][t])||n)},ue=function(e,t){var n=f(e),r=m(t);if(n!==q||!d(te,r)||d(ne,r)){var o=J(n,r);return!o||!d(te,r)||d(n,B)&&n[B][r]||(o.enumerable=!0),o}},de=function(e){var t=Q(f(e)),n=[];return F(t,(function(e){d(te,e)||d(k,e)||ee(n,e)})),n},pe=function(e){var t=e===q,n=Q(t?ne:f(e)),r=[];return F(n,(function(e){!d(te,e)||t&&!d(q,e)||ee(r,te[e])})),r};l||(K=function(){if(p(Y,this))throw z("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?v(arguments[0]):void 0,t=P(e),n=function(e){this===q&&i(n,ne,e),d(this,B)&&d(this[B],t)&&(this[B][t]=!1),ie(this,t,g(1,e))};return c&&oe&&ie(q,t,{configurable:!0,set:n}),ae(t,e)},w(Y=K[H],"toString",(function(){return W(this).tag})),w(K,"withoutSetter",(function(e){return ae(P(e),e)})),C.f=le,O.f=se,R.f=ce,S.f=ue,_.f=b.f=de,T.f=pe,M.f=function(e){return ae(D(e),e)},c&&(I(Y,"description",{configurable:!0,get:function(){return W(this).description}}),s||w(q,"propertyIsEnumerable",le,{unsafe:!0}))),r({global:!0,constructor:!0,wrap:!0,forced:!l,sham:!l},{Symbol:K}),F(y(re),(function(e){L(e)})),r({target:V,stat:!0,forced:!l},{useSetter:function(){oe=!0},useSimple:function(){oe=!1}}),r({target:"Object",stat:!0,forced:!l,sham:!c},{create:function(e,t){return void 0===t?E(e):ce(E(e),t)},defineProperty:se,defineProperties:ce,getOwnPropertyDescriptor:ue}),r({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:de}),x(),U(K,V),k[B]=!0},1817:function(e,t,n){"use strict";var r=n(2109),o=n(9781),i=n(7854),a=n(1702),s=n(2597),c=n(614),l=n(7976),u=n(1340),d=n(7045),p=n(9920),h=i.Symbol,f=h&&h.prototype;if(o&&c(h)&&(!("description"in f)||void 0!==h().description)){var m={},v=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:u(arguments[0]),t=l(f,this)?new h(e):void 0===e?h():h(e);return""===e&&(m[t]=!0),t};p(v,h),v.prototype=f,f.constructor=v;var g="Symbol(test)"==String(h("test")),E=a(f.valueOf),y=a(f.toString),_=/^Symbol\((.*)\)[^)]+$/,b=a("".replace),T=a("".slice);d(f,"description",{configurable:!0,get:function(){var e=E(this);if(s(m,e))return"";var t=y(e),n=g?T(t,7,-1):b(t,_,"$1");return""===n?void 0:n}}),r({global:!0,constructor:!0,forced:!0},{Symbol:v})}},763:function(e,t,n){var r=n(2109),o=n(5005),i=n(2597),a=n(1340),s=n(2309),c=n(2015),l=s("string-to-symbol-registry"),u=s("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!c},{for:function(e){var t=a(e);if(i(l,t))return l[t];var n=o("Symbol")(t);return l[t]=n,u[n]=t,n}})},2165:function(e,t,n){n(6800)("iterator")},2526:function(e,t,n){n(4032),n(763),n(6620),n(8862),n(9660)},6620:function(e,t,n){var r=n(2109),o=n(2597),i=n(2190),a=n(6330),s=n(2309),c=n(2015),l=s("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!c},{keyFor:function(e){if(!i(e))throw TypeError(a(e)+" is not a symbol");if(o(l,e))return l[e]}})},2990:function(e,t,n){"use strict";var r=n(1702),o=n(260),i=r(n(1048)),a=o.aTypedArray;(0,o.exportTypedArrayMethod)("copyWithin",(function(e,t){return i(a(this),e,t,arguments.length>2?arguments[2]:void 0)}))},8927:function(e,t,n){"use strict";var r=n(260),o=n(2092).every,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("every",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},3105:function(e,t,n){"use strict";var r=n(260),o=n(1285),i=n(4599),a=n(648),s=n(6916),c=n(1702),l=n(7293),u=r.aTypedArray,d=r.exportTypedArrayMethod,p=c("".slice);d("fill",(function(e){var t=arguments.length;u(this);var n="Big"===p(a(this),0,3)?i(e):+e;return s(o,this,n,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}),l((function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),1!==e})))},5035:function(e,t,n){"use strict";var r=n(260),o=n(2092).filter,i=n(3074),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("filter",(function(e){var t=o(a(this),e,arguments.length>1?arguments[1]:void 0);return i(this,t)}))},7174:function(e,t,n){"use strict";var r=n(260),o=n(2092).findIndex,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("findIndex",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},4345:function(e,t,n){"use strict";var r=n(260),o=n(2092).find,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("find",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},2846:function(e,t,n){"use strict";var r=n(260),o=n(2092).forEach,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("forEach",(function(e){o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},8145:function(e,t,n){"use strict";var r=n(3832);(0,n(260).exportTypedArrayStaticMethod)("from",n(7321),r)},4731:function(e,t,n){"use strict";var r=n(260),o=n(1318).includes,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("includes",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},7209:function(e,t,n){"use strict";var r=n(260),o=n(1318).indexOf,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("indexOf",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},6319:function(e,t,n){"use strict";var r=n(7854),o=n(7293),i=n(1702),a=n(260),s=n(6992),c=n(5112)("iterator"),l=r.Uint8Array,u=i(s.values),d=i(s.keys),p=i(s.entries),h=a.aTypedArray,f=a.exportTypedArrayMethod,m=l&&l.prototype,v=!o((function(){m[c].call([1])})),g=!!m&&m.values&&m[c]===m.values&&"values"===m.values.name,E=function(){return u(h(this))};f("entries",(function(){return p(h(this))}),v),f("keys",(function(){return d(h(this))}),v),f("values",E,v||!g,{name:"values"}),f(c,E,v||!g,{name:"values"})},8867:function(e,t,n){"use strict";var r=n(260),o=n(1702),i=r.aTypedArray,a=r.exportTypedArrayMethod,s=o([].join);a("join",(function(e){return s(i(this),e)}))},7789:function(e,t,n){"use strict";var r=n(260),o=n(2104),i=n(6583),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return o(i,a(this),t>1?[e,arguments[1]]:[e])}))},3739:function(e,t,n){"use strict";var r=n(260),o=n(2092).map,i=n(6304),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("map",(function(e){return o(a(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(i(e))(t)}))}))},4483:function(e,t,n){"use strict";var r=n(260),o=n(3671).right,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return o(i(this),e,t,t>1?arguments[1]:void 0)}))},9368:function(e,t,n){"use strict";var r=n(260),o=n(3671).left,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return o(i(this),e,t,t>1?arguments[1]:void 0)}))},2056:function(e,t,n){"use strict";var r=n(260),o=r.aTypedArray,i=r.exportTypedArrayMethod,a=Math.floor;i("reverse",(function(){for(var e,t=this,n=o(t).length,r=a(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t}))},3462:function(e,t,n){"use strict";var r=n(7854),o=n(6916),i=n(260),a=n(6244),s=n(4590),c=n(7908),l=n(7293),u=r.RangeError,d=r.Int8Array,p=d&&d.prototype,h=p&&p.set,f=i.aTypedArray,m=i.exportTypedArrayMethod,v=!l((function(){var e=new Uint8ClampedArray(2);return o(h,e,{length:1,0:3},1),3!==e[1]})),g=v&&i.NATIVE_ARRAY_BUFFER_VIEWS&&l((function(){var e=new d(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));m("set",(function(e){f(this);var t=s(arguments.length>1?arguments[1]:void 0,1),n=c(e);if(v)return o(h,this,n,t);var r=this.length,i=a(n),l=0;if(i+t>r)throw u("Wrong length");for(;l<i;)this[t+l]=n[l++]}),!v||g)},678:function(e,t,n){"use strict";var r=n(260),o=n(6304),i=n(7293),a=n(206),s=r.aTypedArray;(0,r.exportTypedArrayMethod)("slice",(function(e,t){for(var n=a(s(this),e,t),r=o(this),i=0,c=n.length,l=new r(c);c>i;)l[i]=n[i++];return l}),i((function(){new Int8Array(1).slice()})))},7462:function(e,t,n){"use strict";var r=n(260),o=n(2092).some,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("some",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},3824:function(e,t,n){"use strict";var r=n(7854),o=n(1470),i=n(7293),a=n(9662),s=n(4362),c=n(260),l=n(8886),u=n(256),d=n(7392),p=n(8008),h=c.aTypedArray,f=c.exportTypedArrayMethod,m=r.Uint16Array,v=m&&o(m.prototype.sort),g=!(!v||i((function(){v(new m(2),null)}))&&i((function(){v(new m(2),{})}))),E=!!v&&!i((function(){if(d)return d<74;if(l)return l<67;if(u)return!0;if(p)return p<602;var e,t,n=new m(516),r=Array(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(v(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==r[e])return!0}));f("sort",(function(e){return void 0!==e&&a(e),E?v(this,e):s(h(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!E||g)},5021:function(e,t,n){"use strict";var r=n(260),o=n(7466),i=n(1400),a=n(6304),s=r.aTypedArray;(0,r.exportTypedArrayMethod)("subarray",(function(e,t){var n=s(this),r=n.length,c=i(e,r);return new(a(n))(n.buffer,n.byteOffset+c*n.BYTES_PER_ELEMENT,o((void 0===t?r:i(t,r))-c))}))},2974:function(e,t,n){"use strict";var r=n(7854),o=n(2104),i=n(260),a=n(7293),s=n(206),c=r.Int8Array,l=i.aTypedArray,u=i.exportTypedArrayMethod,d=[].toLocaleString,p=!!c&&a((function(){d.call(new c(1))}));u("toLocaleString",(function(){return o(d,p?s(l(this)):l(this),s(arguments))}),a((function(){return[1,2].toLocaleString()!=new c([1,2]).toLocaleString()}))||!a((function(){c.prototype.toLocaleString.call([1,2])})))},5016:function(e,t,n){"use strict";var r=n(260).exportTypedArrayMethod,o=n(7293),i=n(7854),a=n(1702),s=i.Uint8Array,c=s&&s.prototype||{},l=[].toString,u=a([].join);o((function(){l.call({})}))&&(l=function(){return u(this)});var d=c.toString!=l;r("toString",l,d)},2472:function(e,t,n){n(9843)("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},4747:function(e,t,n){var r=n(7854),o=n(8324),i=n(8509),a=n(8533),s=n(8880),c=function(e){if(e&&e.forEach!==a)try{s(e,"forEach",a)}catch(t){e.forEach=a}};for(var l in o)o[l]&&c(r[l]&&r[l].prototype);c(i)},3948:function(e,t,n){var r=n(7854),o=n(8324),i=n(8509),a=n(6992),s=n(8880),c=n(5112),l=c("iterator"),u=c("toStringTag"),d=a.values,p=function(e,t){if(e){if(e[l]!==d)try{s(e,l,d)}catch(t){e[l]=d}if(e[u]||s(e,u,t),o[t])for(var n in a)if(e[n]!==a[n])try{s(e,n,a[n])}catch(t){e[n]=a[n]}}};for(var h in o)p(r[h]&&r[h].prototype,h);p(i,"DOMTokenList")},6815:function(e,t,n){var r=n(2109),o=n(7854),i=n(7152)(o.setInterval,!0);r({global:!0,bind:!0,forced:o.setInterval!==i},{setInterval:i})},8417:function(e,t,n){var r=n(2109),o=n(7854),i=n(7152)(o.setTimeout,!0);r({global:!0,bind:!0,forced:o.setTimeout!==i},{setTimeout:i})},2564:function(e,t,n){n(6815),n(8417)},5556:function(e,t,n){"use strict";n(6992);var r=n(2109),o=n(7854),i=n(6916),a=n(1702),s=n(9781),c=n(5143),l=n(8052),u=n(7045),d=n(9190),p=n(8003),h=n(3061),f=n(9909),m=n(5787),v=n(614),g=n(2597),E=n(9974),y=n(648),_=n(9670),b=n(111),T=n(1340),S=n(30),O=n(9114),R=n(4121),C=n(1246),w=n(8053),I=n(5112),A=n(4362),N=I("iterator"),k="URLSearchParams",P=k+"Iterator",D=f.set,M=f.getterFor(k),L=f.getterFor(P),x=Object.getOwnPropertyDescriptor,U=function(e){if(!s)return o[e];var t=x(o,e);return t&&t.value},j=U("fetch"),F=U("Request"),B=U("Headers"),V=F&&F.prototype,H=B&&B.prototype,G=o.RegExp,W=o.TypeError,q=o.decodeURIComponent,K=o.encodeURIComponent,Y=a("".charAt),z=a([].join),X=a([].push),J=a("".replace),Z=a([].shift),Q=a([].splice),$=a("".split),ee=a("".slice),te=/\+/g,ne=Array(4),re=function(e){return ne[e-1]||(ne[e-1]=G("((?:%[\\da-f]{2}){"+e+"})","gi"))},oe=function(e){try{return q(e)}catch(t){return e}},ie=function(e){var t=J(e,te," "),n=4;try{return q(t)}catch(e){for(;n;)t=J(t,re(n--),oe);return t}},ae=/[!'()~]|%20/g,se={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ce=function(e){return se[e]},le=function(e){return J(K(e),ae,ce)},ue=h((function(e,t){D(this,{type:P,iterator:R(M(e).entries),kind:t})}),"Iterator",(function(){var e=L(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n}),!0),de=function(e){this.entries=[],this.url=null,void 0!==e&&(b(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===Y(e,0)?ee(e,1):e:T(e)))};de.prototype={type:k,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,o,a,s,c,l=C(e);if(l)for(n=(t=R(e,l)).next;!(r=i(n,t)).done;){if(a=(o=R(_(r.value))).next,(s=i(a,o)).done||(c=i(a,o)).done||!i(a,o).done)throw W("Expected sequence with length 2");X(this.entries,{key:T(s.value),value:T(c.value)})}else for(var u in e)g(e,u)&&X(this.entries,{key:u,value:T(e[u])})},parseQuery:function(e){if(e)for(var t,n,r=$(e,"&"),o=0;o<r.length;)(t=r[o++]).length&&(n=$(t,"="),X(this.entries,{key:ie(Z(n)),value:ie(z(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],r=0;r<t.length;)e=t[r++],X(n,le(e.key)+"="+le(e.value));return z(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var pe=function(){m(this,he);var e=D(this,new de(arguments.length>0?arguments[0]:void 0));s||(this.length=e.entries.length)},he=pe.prototype;if(d(he,{append:function(e,t){w(arguments.length,2);var n=M(this);X(n.entries,{key:T(e),value:T(t)}),s||this.length++,n.updateURL()},delete:function(e){w(arguments.length,1);for(var t=M(this),n=t.entries,r=T(e),o=0;o<n.length;)n[o].key===r?Q(n,o,1):o++;s||(this.length=n.length),t.updateURL()},get:function(e){w(arguments.length,1);for(var t=M(this).entries,n=T(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){w(arguments.length,1);for(var t=M(this).entries,n=T(e),r=[],o=0;o<t.length;o++)t[o].key===n&&X(r,t[o].value);return r},has:function(e){w(arguments.length,1);for(var t=M(this).entries,n=T(e),r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){w(arguments.length,1);for(var n,r=M(this),o=r.entries,i=!1,a=T(e),c=T(t),l=0;l<o.length;l++)(n=o[l]).key===a&&(i?Q(o,l--,1):(i=!0,n.value=c));i||X(o,{key:a,value:c}),s||(this.length=o.length),r.updateURL()},sort:function(){var e=M(this);A(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=M(this).entries,r=E(e,arguments.length>1?arguments[1]:void 0),o=0;o<n.length;)r((t=n[o++]).value,t.key,this)},keys:function(){return new ue(this,"keys")},values:function(){return new ue(this,"values")},entries:function(){return new ue(this,"entries")}},{enumerable:!0}),l(he,N,he.entries,{name:"entries"}),l(he,"toString",(function(){return M(this).serialize()}),{enumerable:!0}),s&&u(he,"size",{get:function(){return M(this).entries.length},configurable:!0,enumerable:!0}),p(pe,k),r({global:!0,constructor:!0,forced:!c},{URLSearchParams:pe}),!c&&v(B)){var fe=a(H.has),me=a(H.set),ve=function(e){if(b(e)){var t,n=e.body;if(y(n)===k)return t=e.headers?new B(e.headers):new B,fe(t,"content-type")||me(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),S(e,{body:O(0,T(n)),headers:O(0,t)})}return e};if(v(j)&&r({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return j(e,arguments.length>1?ve(arguments[1]):{})}}),v(F)){var ge=function(e){return m(this,V),new F(e,arguments.length>1?ve(arguments[1]):{})};V.constructor=ge,ge.prototype=V,r({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:ge})}}e.exports={URLSearchParams:pe,getState:M}},1637:function(e,t,n){n(5556)},8789:function(e,t,n){"use strict";n(8783);var r,o=n(2109),i=n(9781),a=n(5143),s=n(7854),c=n(9974),l=n(1702),u=n(8052),d=n(7045),p=n(5787),h=n(2597),f=n(1574),m=n(8457),v=n(1589),g=n(8710).codeAt,E=n(3197),y=n(1340),_=n(8003),b=n(8053),T=n(5556),S=n(9909),O=S.set,R=S.getterFor("URL"),C=T.URLSearchParams,w=T.getState,I=s.URL,A=s.TypeError,N=s.parseInt,k=Math.floor,P=Math.pow,D=l("".charAt),M=l(/./.exec),L=l([].join),x=l(1..toString),U=l([].pop),j=l([].push),F=l("".replace),B=l([].shift),V=l("".split),H=l("".slice),G=l("".toLowerCase),W=l([].unshift),q="Invalid scheme",K="Invalid host",Y="Invalid port",z=/[a-z]/i,X=/[\d+-.a-z]/i,J=/\d/,Z=/^0x/i,Q=/^[0-7]+$/,$=/^\d+$/,ee=/^[\da-f]+$/i,te=/[\0\t\n\r #%/:<>?@[\\\]^|]/,ne=/[\0\t\n\r #/:<>?@[\\\]^|]/,re=/^[\u0000-\u0020]+/,oe=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,ie=/[\t\n\r]/g,ae=function(e){var t,n,r,o;if("number"==typeof e){for(t=[],n=0;n<4;n++)W(t,e%256),e=k(e/256);return L(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,o=0,i=0;i<8;i++)0!==e[i]?(o>n&&(t=r,n=o),r=null,o=0):(null===r&&(r=i),++o);return o>n&&(t=r,n=o),t}(e),n=0;n<8;n++)o&&0===e[n]||(o&&(o=!1),r===n?(t+=n?":":"::",o=!0):(t+=x(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},se={},ce=f({},se,{" ":1,'"':1,"<":1,">":1,"`":1}),le=f({},ce,{"#":1,"?":1,"{":1,"}":1}),ue=f({},le,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),de=function(e,t){var n=g(e,0);return n>32&&n<127&&!h(t,e)?e:encodeURIComponent(e)},pe={ftp:21,file:null,http:80,https:443,ws:80,wss:443},he=function(e,t){var n;return 2==e.length&&M(z,D(e,0))&&(":"==(n=D(e,1))||!t&&"|"==n)},fe=function(e){var t;return e.length>1&&he(H(e,0,2))&&(2==e.length||"/"===(t=D(e,2))||"\\"===t||"?"===t||"#"===t)},me=function(e){return"."===e||"%2e"===G(e)},ve={},ge={},Ee={},ye={},_e={},be={},Te={},Se={},Oe={},Re={},Ce={},we={},Ie={},Ae={},Ne={},ke={},Pe={},De={},Me={},Le={},xe={},Ue=function(e,t,n){var r,o,i,a=y(e);if(t){if(o=this.parse(a))throw A(o);this.searchParams=null}else{if(void 0!==n&&(r=new Ue(n,!0)),o=this.parse(a,null,r))throw A(o);(i=w(new C)).bindURL(this),this.searchParams=i}};Ue.prototype={type:"URL",parse:function(e,t,n){var o,i,a,s,c,l=this,u=t||ve,d=0,p="",f=!1,g=!1,E=!1;for(e=y(e),t||(l.scheme="",l.username="",l.password="",l.host=null,l.port=null,l.path=[],l.query=null,l.fragment=null,l.cannotBeABaseURL=!1,e=F(e,re,""),e=F(e,oe,"$1")),e=F(e,ie,""),o=m(e);d<=o.length;){switch(i=o[d],u){case ve:if(!i||!M(z,i)){if(t)return q;u=Ee;continue}p+=G(i),u=ge;break;case ge:if(i&&(M(X,i)||"+"==i||"-"==i||"."==i))p+=G(i);else{if(":"!=i){if(t)return q;p="",u=Ee,d=0;continue}if(t&&(l.isSpecial()!=h(pe,p)||"file"==p&&(l.includesCredentials()||null!==l.port)||"file"==l.scheme&&!l.host))return;if(l.scheme=p,t)return void(l.isSpecial()&&pe[l.scheme]==l.port&&(l.port=null));p="","file"==l.scheme?u=Ae:l.isSpecial()&&n&&n.scheme==l.scheme?u=ye:l.isSpecial()?u=Se:"/"==o[d+1]?(u=_e,d++):(l.cannotBeABaseURL=!0,j(l.path,""),u=Me)}break;case Ee:if(!n||n.cannotBeABaseURL&&"#"!=i)return q;if(n.cannotBeABaseURL&&"#"==i){l.scheme=n.scheme,l.path=v(n.path),l.query=n.query,l.fragment="",l.cannotBeABaseURL=!0,u=xe;break}u="file"==n.scheme?Ae:be;continue;case ye:if("/"!=i||"/"!=o[d+1]){u=be;continue}u=Oe,d++;break;case _e:if("/"==i){u=Re;break}u=De;continue;case be:if(l.scheme=n.scheme,i==r)l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,l.path=v(n.path),l.query=n.query;else if("/"==i||"\\"==i&&l.isSpecial())u=Te;else if("?"==i)l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,l.path=v(n.path),l.query="",u=Le;else{if("#"!=i){l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,l.path=v(n.path),l.path.length--,u=De;continue}l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,l.path=v(n.path),l.query=n.query,l.fragment="",u=xe}break;case Te:if(!l.isSpecial()||"/"!=i&&"\\"!=i){if("/"!=i){l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,u=De;continue}u=Re}else u=Oe;break;case Se:if(u=Oe,"/"!=i||"/"!=D(p,d+1))continue;d++;break;case Oe:if("/"!=i&&"\\"!=i){u=Re;continue}break;case Re:if("@"==i){f&&(p="%40"+p),f=!0,a=m(p);for(var _=0;_<a.length;_++){var b=a[_];if(":"!=b||E){var T=de(b,ue);E?l.password+=T:l.username+=T}else E=!0}p=""}else if(i==r||"/"==i||"?"==i||"#"==i||"\\"==i&&l.isSpecial()){if(f&&""==p)return"Invalid authority";d-=m(p).length+1,p="",u=Ce}else p+=i;break;case Ce:case we:if(t&&"file"==l.scheme){u=ke;continue}if(":"!=i||g){if(i==r||"/"==i||"?"==i||"#"==i||"\\"==i&&l.isSpecial()){if(l.isSpecial()&&""==p)return K;if(t&&""==p&&(l.includesCredentials()||null!==l.port))return;if(s=l.parseHost(p))return s;if(p="",u=Pe,t)return;continue}"["==i?g=!0:"]"==i&&(g=!1),p+=i}else{if(""==p)return K;if(s=l.parseHost(p))return s;if(p="",u=Ie,t==we)return}break;case Ie:if(!M(J,i)){if(i==r||"/"==i||"?"==i||"#"==i||"\\"==i&&l.isSpecial()||t){if(""!=p){var S=N(p,10);if(S>65535)return Y;l.port=l.isSpecial()&&S===pe[l.scheme]?null:S,p=""}if(t)return;u=Pe;continue}return Y}p+=i;break;case Ae:if(l.scheme="file","/"==i||"\\"==i)u=Ne;else{if(!n||"file"!=n.scheme){u=De;continue}if(i==r)l.host=n.host,l.path=v(n.path),l.query=n.query;else if("?"==i)l.host=n.host,l.path=v(n.path),l.query="",u=Le;else{if("#"!=i){fe(L(v(o,d),""))||(l.host=n.host,l.path=v(n.path),l.shortenPath()),u=De;continue}l.host=n.host,l.path=v(n.path),l.query=n.query,l.fragment="",u=xe}}break;case Ne:if("/"==i||"\\"==i){u=ke;break}n&&"file"==n.scheme&&!fe(L(v(o,d),""))&&(he(n.path[0],!0)?j(l.path,n.path[0]):l.host=n.host),u=De;continue;case ke:if(i==r||"/"==i||"\\"==i||"?"==i||"#"==i){if(!t&&he(p))u=De;else if(""==p){if(l.host="",t)return;u=Pe}else{if(s=l.parseHost(p))return s;if("localhost"==l.host&&(l.host=""),t)return;p="",u=Pe}continue}p+=i;break;case Pe:if(l.isSpecial()){if(u=De,"/"!=i&&"\\"!=i)continue}else if(t||"?"!=i)if(t||"#"!=i){if(i!=r&&(u=De,"/"!=i))continue}else l.fragment="",u=xe;else l.query="",u=Le;break;case De:if(i==r||"/"==i||"\\"==i&&l.isSpecial()||!t&&("?"==i||"#"==i)){if(".."===(c=G(c=p))||"%2e."===c||".%2e"===c||"%2e%2e"===c?(l.shortenPath(),"/"==i||"\\"==i&&l.isSpecial()||j(l.path,"")):me(p)?"/"==i||"\\"==i&&l.isSpecial()||j(l.path,""):("file"==l.scheme&&!l.path.length&&he(p)&&(l.host&&(l.host=""),p=D(p,0)+":"),j(l.path,p)),p="","file"==l.scheme&&(i==r||"?"==i||"#"==i))for(;l.path.length>1&&""===l.path[0];)B(l.path);"?"==i?(l.query="",u=Le):"#"==i&&(l.fragment="",u=xe)}else p+=de(i,le);break;case Me:"?"==i?(l.query="",u=Le):"#"==i?(l.fragment="",u=xe):i!=r&&(l.path[0]+=de(i,se));break;case Le:t||"#"!=i?i!=r&&("'"==i&&l.isSpecial()?l.query+="%27":l.query+="#"==i?"%23":de(i,se)):(l.fragment="",u=xe);break;case xe:i!=r&&(l.fragment+=de(i,ce))}d++}},parseHost:function(e){var t,n,r;if("["==D(e,0)){if("]"!=D(e,e.length-1))return K;if(t=function(e){var t,n,r,o,i,a,s,c=[0,0,0,0,0,0,0,0],l=0,u=null,d=0,p=function(){return D(e,d)};if(":"==p()){if(":"!=D(e,1))return;d+=2,u=++l}for(;p();){if(8==l)return;if(":"!=p()){for(t=n=0;n<4&&M(ee,p());)t=16*t+N(p(),16),d++,n++;if("."==p()){if(0==n)return;if(d-=n,l>6)return;for(r=0;p();){if(o=null,r>0){if(!("."==p()&&r<4))return;d++}if(!M(J,p()))return;for(;M(J,p());){if(i=N(p(),10),null===o)o=i;else{if(0==o)return;o=10*o+i}if(o>255)return;d++}c[l]=256*c[l]+o,2!=++r&&4!=r||l++}if(4!=r)return;break}if(":"==p()){if(d++,!p())return}else if(p())return;c[l++]=t}else{if(null!==u)return;d++,u=++l}}if(null!==u)for(a=l-u,l=7;0!=l&&a>0;)s=c[l],c[l--]=c[u+a-1],c[u+--a]=s;else if(8!=l)return;return c}(H(e,1,-1)),!t)return K;this.host=t}else if(this.isSpecial()){if(e=E(e),M(te,e))return K;if(t=function(e){var t,n,r,o,i,a,s,c=V(e,".");if(c.length&&""==c[c.length-1]&&c.length--,(t=c.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(o=c[r]))return e;if(i=10,o.length>1&&"0"==D(o,0)&&(i=M(Z,o)?16:8,o=H(o,8==i?1:2)),""===o)a=0;else{if(!M(10==i?$:8==i?Q:ee,o))return e;a=N(o,i)}j(n,a)}for(r=0;r<t;r++)if(a=n[r],r==t-1){if(a>=P(256,5-t))return null}else if(a>255)return null;for(s=U(n),r=0;r<n.length;r++)s+=n[r]*P(256,3-r);return s}(e),null===t)return K;this.host=t}else{if(M(ne,e))return K;for(t="",n=m(e),r=0;r<n.length;r++)t+=de(n[r],se);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return h(pe,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&he(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,r=e.password,o=e.host,i=e.port,a=e.path,s=e.query,c=e.fragment,l=t+":";return null!==o?(l+="//",e.includesCredentials()&&(l+=n+(r?":"+r:"")+"@"),l+=ae(o),null!==i&&(l+=":"+i)):"file"==t&&(l+="//"),l+=e.cannotBeABaseURL?a[0]:a.length?"/"+L(a,"/"):"",null!==s&&(l+="?"+s),null!==c&&(l+="#"+c),l},setHref:function(e){var t=this.parse(e);if(t)throw A(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new je(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+ae(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(y(e)+":",ve)},getUsername:function(){return this.username},setUsername:function(e){var t=m(y(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=de(t[n],ue)}},getPassword:function(){return this.password},setPassword:function(e){var t=m(y(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=de(t[n],ue)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?ae(e):ae(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Ce)},getHostname:function(){var e=this.host;return null===e?"":ae(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,we)},getPort:function(){var e=this.port;return null===e?"":y(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=y(e))?this.port=null:this.parse(e,Ie))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+L(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Pe))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=y(e))?this.query=null:("?"==D(e,0)&&(e=H(e,1)),this.query="",this.parse(e,Le)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=y(e))?("#"==D(e,0)&&(e=H(e,1)),this.fragment="",this.parse(e,xe)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var je=function(e){var t=p(this,Fe),n=b(arguments.length,1)>1?arguments[1]:void 0,r=O(t,new Ue(e,!1,n));i||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},Fe=je.prototype,Be=function(e,t){return{get:function(){return R(this)[e]()},set:t&&function(e){return R(this)[t](e)},configurable:!0,enumerable:!0}};if(i&&(d(Fe,"href",Be("serialize","setHref")),d(Fe,"origin",Be("getOrigin")),d(Fe,"protocol",Be("getProtocol","setProtocol")),d(Fe,"username",Be("getUsername","setUsername")),d(Fe,"password",Be("getPassword","setPassword")),d(Fe,"host",Be("getHost","setHost")),d(Fe,"hostname",Be("getHostname","setHostname")),d(Fe,"port",Be("getPort","setPort")),d(Fe,"pathname",Be("getPathname","setPathname")),d(Fe,"search",Be("getSearch","setSearch")),d(Fe,"searchParams",Be("getSearchParams")),d(Fe,"hash",Be("getHash","setHash"))),u(Fe,"toJSON",(function(){return R(this).serialize()}),{enumerable:!0}),u(Fe,"toString",(function(){return R(this).serialize()}),{enumerable:!0}),I){var Ve=I.createObjectURL,He=I.revokeObjectURL;Ve&&u(je,"createObjectURL",c(Ve,I)),He&&u(je,"revokeObjectURL",c(He,I))}_(je,"URL"),o({global:!0,constructor:!0,forced:!a,sham:!i},{URL:je})},285:function(e,t,n){n(8789)},5717:function(e){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},3720:function(e){e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var o={},i={};function a(e,t){var n,r,a;return t?(a=0<=(e>>>=0)&&e<256)&&(r=i[e])?r:(n=c(e,(0|e)<0?-1:0,!0),a&&(i[e]=n),n):(a=-128<=(e|=0)&&e<128)&&(r=o[e])?r:(n=c(e,e<0?-1:0,!1),a&&(o[e]=n),n)}function s(e,t){if(isNaN(e))return t?g:v;if(t){if(e<0)return g;if(e>=h)return T}else{if(e<=-f)return S;if(e+1>=f)return b}return e<0?s(-e,t).neg():c(e%p|0,e/p|0,t)}function c(e,t,r){return new n(e,t,r)}n.fromInt=a,n.fromNumber=s,n.fromBits=c;var l=Math.pow;function u(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return v;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return u(e.substring(1),t,n).neg();for(var o=s(l(n,8)),i=v,a=0;a<e.length;a+=8){var c=Math.min(8,e.length-a),d=parseInt(e.substring(a,a+c),n);if(c<8){var p=s(l(n,c));i=i.mul(p).add(s(d))}else i=(i=i.mul(o)).add(s(d))}return i.unsigned=t,i}function d(e,t){return"number"==typeof e?s(e,t):"string"==typeof e?u(e,t):c(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}n.fromString=u,n.fromValue=d;var p=4294967296,h=p*p,f=h/2,m=a(1<<24),v=a(0);n.ZERO=v;var g=a(0,!0);n.UZERO=g;var E=a(1);n.ONE=E;var y=a(1,!0);n.UONE=y;var _=a(-1);n.NEG_ONE=_;var b=c(-1,2147483647,!1);n.MAX_VALUE=b;var T=c(-1,-1,!0);n.MAX_UNSIGNED_VALUE=T;var S=c(0,-2147483648,!1);n.MIN_VALUE=S;var O=n.prototype;O.toInt=function(){return this.unsigned?this.low>>>0:this.low},O.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},O.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=s(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=s(l(e,6),this.unsigned),i=this,a="";;){var c=i.div(o),u=(i.sub(c.mul(o)).toInt()>>>0).toString(e);if((i=c).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},O.getHighBits=function(){return this.high},O.getHighBitsUnsigned=function(){return this.high>>>0},O.getLowBits=function(){return this.low},O.getLowBitsUnsigned=function(){return this.low>>>0},O.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},O.isZero=function(){return 0===this.high&&0===this.low},O.eqz=O.isZero,O.isNegative=function(){return!this.unsigned&&this.high<0},O.isPositive=function(){return this.unsigned||this.high>=0},O.isOdd=function(){return 1==(1&this.low)},O.isEven=function(){return 0==(1&this.low)},O.equals=function(e){return r(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},O.eq=O.equals,O.notEquals=function(e){return!this.eq(e)},O.neq=O.notEquals,O.ne=O.notEquals,O.lessThan=function(e){return this.comp(e)<0},O.lt=O.lessThan,O.lessThanOrEqual=function(e){return this.comp(e)<=0},O.lte=O.lessThanOrEqual,O.le=O.lessThanOrEqual,O.greaterThan=function(e){return this.comp(e)>0},O.gt=O.greaterThan,O.greaterThanOrEqual=function(e){return this.comp(e)>=0},O.gte=O.greaterThanOrEqual,O.ge=O.greaterThanOrEqual,O.compare=function(e){if(r(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},O.comp=O.compare,O.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(E)},O.neg=O.negate,O.add=function(e){r(e)||(e=d(e));var t=this.high>>>16,n=65535&this.high,o=this.low>>>16,i=65535&this.low,a=e.high>>>16,s=65535&e.high,l=e.low>>>16,u=0,p=0,h=0,f=0;return h+=(f+=i+(65535&e.low))>>>16,p+=(h+=o+l)>>>16,u+=(p+=n+s)>>>16,u+=t+a,c((h&=65535)<<16|(f&=65535),(u&=65535)<<16|(p&=65535),this.unsigned)},O.subtract=function(e){return r(e)||(e=d(e)),this.add(e.neg())},O.sub=O.subtract,O.multiply=function(e){if(this.isZero())return v;if(r(e)||(e=d(e)),t)return c(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return v;if(this.eq(S))return e.isOdd()?S:v;if(e.eq(S))return this.isOdd()?S:v;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return s(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,o=65535&this.high,i=this.low>>>16,a=65535&this.low,l=e.high>>>16,u=65535&e.high,p=e.low>>>16,h=65535&e.low,f=0,g=0,E=0,y=0;return E+=(y+=a*h)>>>16,g+=(E+=i*h)>>>16,E&=65535,g+=(E+=a*p)>>>16,f+=(g+=o*h)>>>16,g&=65535,f+=(g+=i*p)>>>16,g&=65535,f+=(g+=a*u)>>>16,f+=n*h+o*p+i*u+a*l,c((E&=65535)<<16|(y&=65535),(f&=65535)<<16|(g&=65535),this.unsigned)},O.mul=O.multiply,O.divide=function(e){if(r(e)||(e=d(e)),e.isZero())throw Error("division by zero");var n,o,i;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?g:v;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return g;if(e.gt(this.shru(1)))return y;i=g}else{if(this.eq(S))return e.eq(E)||e.eq(_)?S:e.eq(S)?E:(n=this.shr(1).div(e).shl(1)).eq(v)?e.isNegative()?E:_:(o=this.sub(e.mul(n)),i=n.add(o.div(e)));if(e.eq(S))return this.unsigned?g:v;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=v}for(o=this;o.gte(e);){n=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(n)/Math.LN2),u=a<=48?1:l(2,a-48),p=s(n),h=p.mul(e);h.isNegative()||h.gt(o);)h=(p=s(n-=u,this.unsigned)).mul(e);p.isZero()&&(p=E),i=i.add(p),o=o.sub(h)}return i},O.div=O.divide,O.modulo=function(e){return r(e)||(e=d(e)),t?c((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},O.mod=O.modulo,O.rem=O.modulo,O.not=function(){return c(~this.low,~this.high,this.unsigned)},O.and=function(e){return r(e)||(e=d(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},O.or=function(e){return r(e)||(e=d(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},O.xor=function(e){return r(e)||(e=d(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},O.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},O.shl=O.shiftLeft,O.shiftRight=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},O.shr=O.shiftRight,O.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?c(this.low>>>e|t<<32-e,t>>>e,this.unsigned):c(32===e?t:t>>>e-32,0,this.unsigned)},O.shru=O.shiftRightUnsigned,O.shr_u=O.shiftRightUnsigned,O.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},O.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},O.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},O.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},O.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},3281:function(e,t,n){"use strict";e.exports=n(9050)},2967:function(e){"use strict";e.exports=r;var t,n=/\/|\./;function r(e,t){n.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),r[e]=t}r("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),r("duration",{Duration:t={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),r("timestamp",{Timestamp:t}),r("empty",{Empty:{fields:{}}}),r("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),r("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),r("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),r.get=function(e){return r[e]||null}},3996:function(e,t,n){"use strict";var r=t,o=n(7025),i=n(9935);function a(e,t,n,r){if(t.resolvedType)if(t.resolvedType instanceof o){e("switch(d%s){",r);for(var i=t.resolvedType.values,a=Object.keys(i),s=0;s<a.length;++s)t.repeated&&i[a[s]]===t.typeDefault&&e("default:"),e("case%j:",a[s])("case %i:",i[a[s]])("m%s=%j",r,i[a[s]])("break");e("}")}else e('if(typeof d%s!=="object")',r)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,n,r);else{var c=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",r,r);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,c)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,c?"true":"");break;case"bytes":e('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length)",r)("m%s=d%s",r,r);break;case"string":e("m%s=String(d%s)",r,r);break;case"bool":e("m%s=Boolean(d%s)",r,r)}}return e}function s(e,t,n,r){if(t.resolvedType)t.resolvedType instanceof o?e("d%s=o.enums===String?types[%i].values[m%s]:m%s",r,n,r,r):e("d%s=types[%i].toObject(m%s,o)",r,n,r);else{var i=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":i=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,i?"true":"",r);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:e("d%s=m%s",r,r)}}return e}r.fromObject=function(e){var t=e.fieldsArray,n=i.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return n("return new this.ctor");n("var m=new this.ctor");for(var r=0;r<t.length;++r){var s=t[r].resolve(),c=i.safeProp(s.name);s.map?(n("if(d%s){",c)('if(typeof d%s!=="object")',c)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",c)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",c),a(n,s,r,c+"[ks[i]]")("}")("}")):s.repeated?(n("if(d%s){",c)("if(!Array.isArray(d%s))",c)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",c)("for(var i=0;i<d%s.length;++i){",c),a(n,s,r,c+"[i]")("}")("}")):(s.resolvedType instanceof o||n("if(d%s!=null){",c),a(n,s,r,c),s.resolvedType instanceof o||n("}"))}return n("return m")},r.toObject=function(e){var t=e.fieldsArray.slice().sort(i.compareFieldsById);if(!t.length)return i.codegen()("return {}");for(var n=i.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),r=[],a=[],c=[],l=0;l<t.length;++l)t[l].partOf||(t[l].resolve().repeated?r:t[l].map?a:c).push(t[l]);if(r.length){for(n("if(o.arrays||o.defaults){"),l=0;l<r.length;++l)n("d%s=[]",i.safeProp(r[l].name));n("}")}if(a.length){for(n("if(o.objects||o.defaults){"),l=0;l<a.length;++l)n("d%s={}",i.safeProp(a[l].name));n("}")}if(c.length){for(n("if(o.defaults){"),l=0;l<c.length;++l){var u=c[l],d=i.safeProp(u.name);if(u.resolvedType instanceof o)n("d%s=o.enums===String?%j:%j",d,u.resolvedType.valuesById[u.typeDefault],u.typeDefault);else if(u.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",d)("}else")("d%s=o.longs===String?%j:%i",d,u.typeDefault.toString(),u.typeDefault.toNumber());else if(u.bytes){var p="["+Array.prototype.slice.call(u.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",d,String.fromCharCode.apply(String,u.typeDefault))("else{")("d%s=%s",d,p)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",d,d)("}")}else n("d%s=%j",d,u.typeDefault)}n("}")}var h=!1;for(l=0;l<t.length;++l){u=t[l];var f=e._fieldsArray.indexOf(u);d=i.safeProp(u.name),u.map?(h||(h=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",d,d)("d%s={}",d)("for(var j=0;j<ks2.length;++j){"),s(n,u,f,d+"[ks2[j]]")("}")):u.repeated?(n("if(m%s&&m%s.length){",d,d)("d%s=[]",d)("for(var j=0;j<m%s.length;++j){",d),s(n,u,f,d+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",d,u.name),s(n,u,f,d),u.partOf&&n("if(o.oneofs)")("d%s=%j",i.safeProp(u.partOf.name),u.name)),n("}")}return n("return d")}},5305:function(e,t,n){"use strict";e.exports=function(e){var t=i.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break"),t("switch(t>>>3){");for(var n=0;n<e.fieldsArray.length;++n){var s=e._fieldsArray[n].resolve(),c=s.resolvedType instanceof r?"int32":s.type,l="m"+i.safeProp(s.name);t("case %i:",s.id),s.map?(t("if(%s===util.emptyObject)",l)("%s={}",l)("var c2 = r.uint32()+r.pos"),void 0!==o.defaults[s.keyType]?t("k=%j",o.defaults[s.keyType]):t("k=null"),void 0!==o.defaults[c]?t("value=%j",o.defaults[c]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",s.keyType)("case 2:"),void 0===o.basic[c]?t("value=types[%i].decode(r,r.uint32())",n):t("value=r.%s()",c),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==o.long[s.keyType]?t('%s[typeof k==="object"?util.longToHash(k):k]=value',l):t("%s[k]=value",l)):s.repeated?(t("if(!(%s&&%s.length))",l,l)("%s=[]",l),void 0!==o.packed[c]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",l,c)("}else"),void 0===o.basic[c]?t(s.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",l,n):t("%s.push(r.%s())",l,c)):void 0===o.basic[c]?t(s.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",l,n):t("%s=r.%s()",l,c),t("break")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),n=0;n<e._fieldsArray.length;++n){var u=e._fieldsArray[n];u.required&&t("if(!m.hasOwnProperty(%j))",u.name)("throw util.ProtocolError(%j,{instance:m})",a(u))}return t("return m")};var r=n(7025),o=n(7063),i=n(9935);function a(e){return"missing required '"+e.name+"'"}},4928:function(e,t,n){"use strict";e.exports=function(e){for(var t,n=i.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),s=e.fieldsArray.slice().sort(i.compareFieldsById),c=0;c<s.length;++c){var l=s[c].resolve(),u=e._fieldsArray.indexOf(l),d=l.resolvedType instanceof r?"int32":l.type,p=o.basic[d];t="m"+i.safeProp(l.name),l.map?(n("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",t,l.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(l.id<<3|2)>>>0,8|o.mapKey[l.keyType],l.keyType),void 0===p?n("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",u,t):n(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|p,d,t),n("}")("}")):l.repeated?(n("if(%s!=null&&%s.length){",t,t),l.packed&&void 0!==o.packed[d]?n("w.uint32(%i).fork()",(l.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",d,t)("w.ldelim()"):(n("for(var i=0;i<%s.length;++i)",t),void 0===p?a(n,l,u,t+"[i]"):n("w.uint32(%i).%s(%s[i])",(l.id<<3|p)>>>0,d,t)),n("}")):(l.optional&&n("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",t,l.name),void 0===p?a(n,l,u,t):n("w.uint32(%i).%s(%s)",(l.id<<3|p)>>>0,d,t))}return n("return w")};var r=n(7025),o=n(7063),i=n(9935);function a(e,t,n,r){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",n,r,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",n,r,(t.id<<3|2)>>>0)}},7025:function(e,t,n){"use strict";e.exports=a;var r=n(3243);((a.prototype=Object.create(r.prototype)).constructor=a).className="Enum";var o=n(9313),i=n(9935);function a(e,t,n,o,i){if(r.call(this,e,n),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=o,this.comments=i||{},this.reserved=void 0,t)for(var a=Object.keys(t),s=0;s<a.length;++s)"number"==typeof t[a[s]]&&(this.valuesById[this.values[a[s]]=t[a[s]]]=a[s])}a.fromJSON=function(e,t){var n=new a(e,t.values,t.options,t.comment,t.comments);return n.reserved=t.reserved,n},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return i.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},a.prototype.add=function(e,t,n){if(!i.isString(e))throw TypeError("name must be a string");if(!i.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=n||null,this},a.prototype.remove=function(e){if(!i.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this},a.prototype.isReservedId=function(e){return o.isReservedId(this.reserved,e)},a.prototype.isReservedName=function(e){return o.isReservedName(this.reserved,e)}},3548:function(e,t,n){"use strict";e.exports=l;var r=n(3243);((l.prototype=Object.create(r.prototype)).constructor=l).className="Field";var o,i=n(7025),a=n(7063),s=n(9935),c=/^required|optional|repeated$/;function l(e,t,n,o,i,l,u){if(s.isObject(o)?(u=i,l=o,o=i=void 0):s.isObject(i)&&(u=l,l=i,i=void 0),r.call(this,e,l),!s.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!s.isString(n))throw TypeError("type must be a string");if(void 0!==o&&!c.test(o=o.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==i&&!s.isString(i))throw TypeError("extend must be a string");"proto3_optional"===o&&(o="optional"),this.rule=o&&"optional"!==o?o:void 0,this.type=n,this.id=t,this.extend=i||void 0,this.required="required"===o,this.optional=!this.required,this.repeated="repeated"===o,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!s.Long&&void 0!==a.long[n],this.bytes="bytes"===n,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=u}l.fromJSON=function(e,t){return new l(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(l.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),l.prototype.setOption=function(e,t,n){return"packed"===e&&(this._packed=null),r.prototype.setOption.call(this,e,t,n)},l.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},l.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=a.defaults[this.type])&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof o?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof i&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof i)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=s.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;s.base64.test(this.typeDefault)?s.base64.decode(this.typeDefault,e=s.newBuffer(s.base64.length(this.typeDefault)),0):s.utf8.write(this.typeDefault,e=s.newBuffer(s.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=s.emptyObject:this.repeated?this.defaultValue=s.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof o&&(this.parent.ctor.prototype[this.name]=this.defaultValue),r.prototype.resolve.call(this)},l.d=function(e,t,n,r){return"function"==typeof t?t=s.decorateType(t).name:t&&"object"==typeof t&&(t=s.decorateEnum(t).name),function(o,i){s.decorateType(o.constructor).add(new l(i,e,t,n,{default:r}))}},l._configure=function(e){o=e}},8836:function(e,t,n){"use strict";var r=e.exports=n(9482);r.build="light",r.load=function(e,t,n){return"function"==typeof t?(n=t,t=new r.Root):t||(t=new r.Root),t.load(e,n)},r.loadSync=function(e,t){return t||(t=new r.Root),t.loadSync(e)},r.encoder=n(4928),r.decoder=n(5305),r.verifier=n(4497),r.converter=n(3996),r.ReflectionObject=n(3243),r.Namespace=n(9313),r.Root=n(9424),r.Enum=n(7025),r.Type=n(7645),r.Field=n(3548),r.OneOf=n(7598),r.MapField=n(6039),r.Service=n(7513),r.Method=n(4429),r.Message=n(8368),r.wrappers=n(1667),r.types=n(7063),r.util=n(9935),r.ReflectionObject._configure(r.Root),r.Namespace._configure(r.Type,r.Service,r.Enum),r.Root._configure(r.Type),r.Field._configure(r.Type)},9482:function(e,t,n){"use strict";var r=t;function o(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(1173),r.BufferWriter=n(3155),r.Reader=n(1408),r.BufferReader=n(593),r.util=n(9693),r.rpc=n(5994),r.roots=n(5054),r.configure=o,o()},9050:function(e,t,n){"use strict";var r=e.exports=n(8836);r.build="full",r.tokenize=n(626),r.parse=n(2228),r.common=n(2967),r.Root._configure(r.Type,r.parse,r.common)},6039:function(e,t,n){"use strict";e.exports=a;var r=n(3548);((a.prototype=Object.create(r.prototype)).constructor=a).className="MapField";var o=n(7063),i=n(9935);function a(e,t,n,o,a,s){if(r.call(this,e,t,o,void 0,void 0,a,s),!i.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}a.fromJSON=function(e,t){return new a(e,t.id,t.keyType,t.type,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return i.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},a.prototype.resolve=function(){if(this.resolved)return this;if(void 0===o.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return r.prototype.resolve.call(this)},a.d=function(e,t,n){return"function"==typeof n?n=i.decorateType(n).name:n&&"object"==typeof n&&(n=i.decorateEnum(n).name),function(r,o){i.decorateType(r.constructor).add(new a(o,e,t,n))}}},8368:function(e,t,n){"use strict";e.exports=o;var r=n(9693);function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)this[t[n]]=e[t[n]]}o.create=function(e){return this.$type.create(e)},o.encode=function(e,t){return this.$type.encode(e,t)},o.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},o.decode=function(e){return this.$type.decode(e)},o.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},o.verify=function(e){return this.$type.verify(e)},o.fromObject=function(e){return this.$type.fromObject(e)},o.toObject=function(e,t){return this.$type.toObject(e,t)},o.prototype.toJSON=function(){return this.$type.toObject(this,r.toJSONOptions)}},4429:function(e,t,n){"use strict";e.exports=i;var r=n(3243);((i.prototype=Object.create(r.prototype)).constructor=i).className="Method";var o=n(9935);function i(e,t,n,i,a,s,c,l,u){if(o.isObject(a)?(c=a,a=s=void 0):o.isObject(s)&&(c=s,s=void 0),void 0!==t&&!o.isString(t))throw TypeError("type must be a string");if(!o.isString(n))throw TypeError("requestType must be a string");if(!o.isString(i))throw TypeError("responseType must be a string");r.call(this,e,c),this.type=t||"rpc",this.requestType=n,this.requestStream=!!a||void 0,this.responseType=i,this.responseStream=!!s||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=l,this.parsedOptions=u}i.fromJSON=function(e,t){return new i(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)},i.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])},i.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),r.prototype.resolve.call(this))}},9313:function(e,t,n){"use strict";e.exports=d;var r=n(3243);((d.prototype=Object.create(r.prototype)).constructor=d).className="Namespace";var o,i,a,s=n(3548),c=n(7598),l=n(9935);function u(e,t){if(e&&e.length){for(var n={},r=0;r<e.length;++r)n[e[r].name]=e[r].toJSON(t);return n}}function d(e,t){r.call(this,e,t),this.nested=void 0,this._nestedArray=null}function p(e){return e._nestedArray=null,e}d.fromJSON=function(e,t){return new d(e,t.options).addJSON(t.nested)},d.arrayToJSON=u,d.isReservedId=function(e,t){if(e)for(var n=0;n<e.length;++n)if("string"!=typeof e[n]&&e[n][0]<=t&&e[n][1]>t)return!0;return!1},d.isReservedName=function(e,t){if(e)for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1},Object.defineProperty(d.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=l.toArray(this.nested))}}),d.prototype.toJSON=function(e){return l.toObject(["options",this.options,"nested",u(this.nestedArray,e)])},d.prototype.addJSON=function(e){if(e)for(var t,n=Object.keys(e),r=0;r<n.length;++r)t=e[n[r]],this.add((void 0!==t.fields?o.fromJSON:void 0!==t.values?a.fromJSON:void 0!==t.methods?i.fromJSON:void 0!==t.id?s.fromJSON:d.fromJSON)(n[r],t));return this},d.prototype.get=function(e){return this.nested&&this.nested[e]||null},d.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof a)return this.nested[e].values;throw Error("no such enum: "+e)},d.prototype.add=function(e){if(!(e instanceof s&&void 0!==e.extend||e instanceof o||e instanceof a||e instanceof i||e instanceof d||e instanceof c))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof d&&e instanceof d)||t instanceof o||t instanceof i)throw Error("duplicate name '"+e.name+"' in "+this);for(var n=t.nestedArray,r=0;r<n.length;++r)e.add(n[r]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),p(this)},d.prototype.remove=function(e){if(!(e instanceof r))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),p(this)},d.prototype.define=function(e,t){if(l.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var n=this;e.length>0;){var r=e.shift();if(n.nested&&n.nested[r]){if(!((n=n.nested[r])instanceof d))throw Error("path conflicts with non-namespace objects")}else n.add(n=new d(r))}return t&&n.addJSON(t),n},d.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof d?e[t++].resolveAll():e[t++].resolve();return this.resolve()},d.prototype.lookup=function(e,t,n){if("boolean"==typeof t?(n=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),l.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(1===e.length){if(!t||t.indexOf(r.constructor)>-1)return r}else if(r instanceof d&&(r=r.lookup(e.slice(1),t,!0)))return r}else for(var o=0;o<this.nestedArray.length;++o)if(this._nestedArray[o]instanceof d&&(r=this._nestedArray[o].lookup(e,t,!0)))return r;return null===this.parent||n?null:this.parent.lookup(e,t)},d.prototype.lookupType=function(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such type: "+e);return t},d.prototype.lookupEnum=function(e){var t=this.lookup(e,[a]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},d.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[o,a]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},d.prototype.lookupService=function(e){var t=this.lookup(e,[i]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},d._configure=function(e,t,n){o=e,i=t,a=n}},3243:function(e,t,n){"use strict";e.exports=i,i.className="ReflectionObject";var r,o=n(9935);function i(e,t){if(!o.isString(e))throw TypeError("name must be a string");if(t&&!o.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(i.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),i.prototype.toJSON=function(){throw Error()},i.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof r&&t._handleAdd(this)},i.prototype.onRemove=function(e){var t=e.root;t instanceof r&&t._handleRemove(this),this.parent=null,this.resolved=!1},i.prototype.resolve=function(){return this.resolved||this.root instanceof r&&(this.resolved=!0),this},i.prototype.getOption=function(e){if(this.options)return this.options[e]},i.prototype.setOption=function(e,t,n){return n&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},i.prototype.setParsedOption=function(e,t,n){this.parsedOptions||(this.parsedOptions=[]);var r=this.parsedOptions;if(n){var i=r.find((function(t){return Object.prototype.hasOwnProperty.call(t,e)}));if(i){var a=i[e];o.setProperty(a,n,t)}else(i={})[e]=o.setProperty({},n,t),r.push(i)}else{var s={};s[e]=t,r.push(s)}return this},i.prototype.setOptions=function(e,t){if(e)for(var n=Object.keys(e),r=0;r<n.length;++r)this.setOption(n[r],e[n[r]],t);return this},i.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},i._configure=function(e){r=e}},7598:function(e,t,n){"use strict";e.exports=a;var r=n(3243);((a.prototype=Object.create(r.prototype)).constructor=a).className="OneOf";var o=n(3548),i=n(9935);function a(e,t,n,o){if(Array.isArray(t)||(n=t,t=void 0),r.call(this,e,n),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=o}function s(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}a.fromJSON=function(e,t){return new a(e,t.oneof,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return i.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},a.prototype.add=function(e){if(!(e instanceof o))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,s(this),this},a.prototype.remove=function(e){if(!(e instanceof o))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},a.prototype.onAdd=function(e){r.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var n=e.get(this.oneof[t]);n&&!n.partOf&&(n.partOf=this,this.fieldsArray.push(n))}s(this)},a.prototype.onRemove=function(e){for(var t,n=0;n<this.fieldsArray.length;++n)(t=this.fieldsArray[n]).parent&&t.parent.remove(t);r.prototype.onRemove.call(this,e)},a.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,n){i.decorateType(t.constructor).add(new a(n,e)),Object.defineProperty(t,n,{get:i.oneOfGetter(e),set:i.oneOfSetter(e)})}}},2228:function(e,t,n){"use strict";e.exports=O,O.filename=null,O.defaults={keepCase:!1};var r=n(626),o=n(9424),i=n(7645),a=n(3548),s=n(6039),c=n(7598),l=n(7025),u=n(7513),d=n(4429),p=n(7063),h=n(9935),f=/^[1-9][0-9]*$/,m=/^-?[1-9][0-9]*$/,v=/^0[x][0-9a-fA-F]+$/,g=/^-?0[x][0-9a-fA-F]+$/,E=/^0[0-7]+$/,y=/^-?0[0-7]+$/,_=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,b=/^[a-zA-Z_][a-zA-Z_0-9]*$/,T=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,S=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function O(e,t,n){t instanceof o||(n=t,t=new o),n||(n=O.defaults);var R,C,w,I,A,N=n.preferTrailingComment||!1,k=r(e,n.alternateCommentMode||!1),P=k.next,D=k.push,M=k.peek,L=k.skip,x=k.cmnt,U=!0,j=!1,F=t,B=n.keepCase?function(e){return e}:h.camelCase;function V(e,t,n){var r=O.filename;return n||(O.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(r?r+", ":"")+"line "+k.line+")")}function H(){var e,t=[];do{if('"'!==(e=P())&&"'"!==e)throw V(e);t.push(P()),L(e),e=M()}while('"'===e||"'"===e);return t.join("")}function G(e){var t=P();switch(t){case"'":case'"':return D(t),H();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return function(e){var t=1;switch("-"===e.charAt(0)&&(t=-1,e=e.substring(1)),e){case"inf":case"INF":case"Inf":return t*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(f.test(e))return t*parseInt(e,10);if(v.test(e))return t*parseInt(e,16);if(E.test(e))return t*parseInt(e,8);if(_.test(e))return t*parseFloat(e);throw V(e,"number",!0)}(t)}catch(n){if(e&&T.test(t))return t;throw V(t,"value")}}function W(e,t){var n,r;do{!t||'"'!==(n=M())&&"'"!==n?e.push([r=q(P()),L("to",!0)?q(P()):r]):e.push(H())}while(L(",",!0));L(";")}function q(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&"-"===e.charAt(0))throw V(e,"id");if(m.test(e))return parseInt(e,10);if(g.test(e))return parseInt(e,16);if(y.test(e))return parseInt(e,8);throw V(e,"id")}function K(){if(void 0!==R)throw V("package");if(R=P(),!T.test(R))throw V(R,"name");F=F.define(R),L(";")}function Y(){var e,t=M();switch(t){case"weak":e=w||(w=[]),P();break;case"public":P();default:e=C||(C=[])}t=H(),L(";"),e.push(t)}function z(){if(L("="),I=H(),!(j="proto3"===I)&&"proto2"!==I)throw V(I,"syntax");L(";")}function X(e,t){switch(t){case"option":return Q(e,t),L(";"),!0;case"message":return function(e,t){if(!b.test(t=P()))throw V(t,"type name");var n=new i(t);J(n,(function(e){if(!X(n,e))switch(e){case"map":!function(e){L("<");var t=P();if(void 0===p.mapKey[t])throw V(t,"type");L(",");var n=P();if(!T.test(n))throw V(n,"type");L(">");var r=P();if(!b.test(r))throw V(r,"name");L("=");var o=new s(B(r),q(P()),t,n);J(o,(function(e){if("option"!==e)throw V(e);Q(o,e),L(";")}),(function(){te(o)})),e.add(o)}(n);break;case"required":case"repeated":Z(n,e);break;case"optional":Z(n,j?"proto3_optional":"optional");break;case"oneof":!function(e,t){if(!b.test(t=P()))throw V(t,"name");var n=new c(B(t));J(n,(function(e){"option"===e?(Q(n,e),L(";")):(D(e),Z(n,"optional"))})),e.add(n)}(n,e);break;case"extensions":W(n.extensions||(n.extensions=[]));break;case"reserved":W(n.reserved||(n.reserved=[]),!0);break;default:if(!j||!T.test(e))throw V(e);D(e),Z(n,"optional")}})),e.add(n)}(e,t),!0;case"enum":return function(e,t){if(!b.test(t=P()))throw V(t,"name");var n=new l(t);J(n,(function(e){switch(e){case"option":Q(n,e),L(";");break;case"reserved":W(n.reserved||(n.reserved=[]),!0);break;default:!function(e,t){if(!b.test(t))throw V(t,"name");L("=");var n=q(P(),!0),r={};J(r,(function(e){if("option"!==e)throw V(e);Q(r,e),L(";")}),(function(){te(r)})),e.add(t,n,r.comment)}(n,e)}})),e.add(n)}(e,t),!0;case"service":return function(e,t){if(!b.test(t=P()))throw V(t,"service name");var n=new u(t);J(n,(function(e){if(!X(n,e)){if("rpc"!==e)throw V(e);!function(e,t){var n=x(),r=t;if(!b.test(t=P()))throw V(t,"name");var o,i,a,s,c=t;if(L("("),L("stream",!0)&&(i=!0),!T.test(t=P()))throw V(t);if(o=t,L(")"),L("returns"),L("("),L("stream",!0)&&(s=!0),!T.test(t=P()))throw V(t);a=t,L(")");var l=new d(c,r,o,a,i,s);l.comment=n,J(l,(function(e){if("option"!==e)throw V(e);Q(l,e),L(";")})),e.add(l)}(n,e)}})),e.add(n)}(e,t),!0;case"extend":return function(e,t){if(!T.test(t=P()))throw V(t,"reference");var n=t;J(null,(function(t){switch(t){case"required":case"repeated":Z(e,t,n);break;case"optional":Z(e,j?"proto3_optional":"optional",n);break;default:if(!j||!T.test(t))throw V(t);D(t),Z(e,"optional",n)}}))}(e,t),!0}return!1}function J(e,t,n){var r=k.line;if(e&&("string"!=typeof e.comment&&(e.comment=x()),e.filename=O.filename),L("{",!0)){for(var o;"}"!==(o=P());)t(o);L(";",!0)}else n&&n(),L(";"),e&&("string"!=typeof e.comment||N)&&(e.comment=x(r)||e.comment)}function Z(e,t,n){var r=P();if("group"!==r){if(!T.test(r))throw V(r,"type");var o=P();if(!b.test(o))throw V(o,"name");o=B(o),L("=");var s=new a(o,q(P()),r,t,n);if(J(s,(function(e){if("option"!==e)throw V(e);Q(s,e),L(";")}),(function(){te(s)})),"proto3_optional"===t){var l=new c("_"+o);s.setOption("proto3_optional",!0),l.add(s),e.add(l)}else e.add(s);j||!s.repeated||void 0===p.packed[r]&&void 0!==p.basic[r]||s.setOption("packed",!1,!0)}else!function(e,t){var n=P();if(!b.test(n))throw V(n,"name");var r=h.lcFirst(n);n===r&&(n=h.ucFirst(n)),L("=");var o=q(P()),s=new i(n);s.group=!0;var c=new a(r,o,n,t);c.filename=O.filename,J(s,(function(e){switch(e){case"option":Q(s,e),L(";");break;case"required":case"repeated":Z(s,e);break;case"optional":Z(s,j?"proto3_optional":"optional");break;default:throw V(e)}})),e.add(s).add(c)}(e,t)}function Q(e,t){var n=L("(",!0);if(!T.test(t=P()))throw V(t,"name");var r,o=t,i=o;n&&(L(")"),i=o="("+o+")",t=M(),S.test(t)&&(r=t.substr(1),o+=t,P())),L("="),function(e,t,n,r){e.setParsedOption&&e.setParsedOption(t,n,r)}(e,i,$(e,o),r)}function $(e,t){if(L("{",!0)){for(var n={};!L("}",!0);){if(!b.test(A=P()))throw V(A,"name");var r,o=A;"{"===M()?r=$(e,t+"."+A):(L(":"),"{"===M()?r=$(e,t+"."+A):(r=G(!0),ee(e,t+"."+A,r)));var i=n[o];i&&(r=[].concat(i).concat(r)),n[o]=r,L(",",!0)}return n}var a=G(!0);return ee(e,t,a),a}function ee(e,t,n){e.setOption&&e.setOption(t,n)}function te(e){if(L("[",!0)){do{Q(e,"option")}while(L(",",!0));L("]")}return e}for(;null!==(A=P());)switch(A){case"package":if(!U)throw V(A);K();break;case"import":if(!U)throw V(A);Y();break;case"syntax":if(!U)throw V(A);z();break;case"option":Q(F,A),L(";");break;default:if(X(F,A)){U=!1;continue}throw V(A)}return O.filename=null,{package:R,imports:C,weakImports:w,syntax:I,root:t}}},1408:function(e,t,n){"use strict";e.exports=c;var r,o=n(9693),i=o.LongBits,a=o.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l,u="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},d=function(){return o.Buffer?function(e){return(c.create=function(e){return o.Buffer.isBuffer(e)?new r(e):u(e)})(e)}:u};function p(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw s(this,8);return new i(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}c.create=d(),c.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,c.prototype.uint32=(l=4294967295,function(){if(l=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return l;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return l}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return h(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|h(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw s(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){r=e,c.create=d(),r._configure();var t=o.Long?"toLong":"toNumber";o.merge(c.prototype,{int64:function(){return p.call(this)[t](!1)},uint64:function(){return p.call(this)[t](!0)},sint64:function(){return p.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},593:function(e,t,n){"use strict";e.exports=i;var r=n(1408);(i.prototype=Object.create(r.prototype)).constructor=i;var o=n(9693);function i(e){r.call(this,e)}i._configure=function(){o.Buffer&&(i.prototype._slice=o.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()},9424:function(e,t,n){"use strict";e.exports=d;var r=n(9313);((d.prototype=Object.create(r.prototype)).constructor=d).className="Root";var o,i,a,s=n(3548),c=n(7025),l=n(7598),u=n(9935);function d(e){r.call(this,"",e),this.deferred=[],this.files=[]}function p(){}d.fromJSON=function(e,t){return t||(t=new d),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},d.prototype.resolvePath=u.path.resolve,d.prototype.fetch=u.fetch,d.prototype.load=function e(t,n,r){"function"==typeof n&&(r=n,n=void 0);var o=this;if(!r)return u.asPromise(e,o,t,n);var s=r===p;function c(e,t){if(r){var n=r;if(r=null,s)throw e;n(e,t)}}function l(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var n=e.substring(t);if(n in a)return n}return null}function d(e,t){try{if(u.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),u.isString(t)){i.filename=e;var r,a=i(t,o,n),d=0;if(a.imports)for(;d<a.imports.length;++d)(r=l(a.imports[d])||o.resolvePath(e,a.imports[d]))&&h(r);if(a.weakImports)for(d=0;d<a.weakImports.length;++d)(r=l(a.weakImports[d])||o.resolvePath(e,a.weakImports[d]))&&h(r,!0)}else o.setOptions(t.options).addJSON(t.nested)}catch(e){c(e)}s||f||c(null,o)}function h(e,t){if(!(o.files.indexOf(e)>-1))if(o.files.push(e),e in a)s?d(e,a[e]):(++f,setTimeout((function(){--f,d(e,a[e])})));else if(s){var n;try{n=u.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||c(e))}d(e,n)}else++f,o.fetch(e,(function(n,i){--f,r&&(n?t?f||c(null,o):c(n):d(e,i))}))}var f=0;u.isString(t)&&(t=[t]);for(var m,v=0;v<t.length;++v)(m=o.resolvePath("",t[v]))&&h(m);if(s)return o;f||c(null,o)},d.prototype.loadSync=function(e,t){if(!u.isNode)throw Error("not supported");return this.load(e,t,p)},d.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return r.prototype.resolveAll.call(this)};var h=/^[A-Z]/;function f(e,t){var n=t.parent.lookup(t.extend);if(n){var r=new s(t.fullName,t.id,t.type,t.rule,void 0,t.options);return r.declaringField=t,t.extensionField=r,n.add(r),!0}return!1}d.prototype._handleAdd=function(e){if(e instanceof s)void 0===e.extend||e.extensionField||f(0,e)||this.deferred.push(e);else if(e instanceof c)h.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof l)){if(e instanceof o)for(var t=0;t<this.deferred.length;)f(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);h.test(e.name)&&(e.parent[e.name]=e)}},d.prototype._handleRemove=function(e){if(e instanceof s){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof c)h.test(e.name)&&delete e.parent[e.name];else if(e instanceof r){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);h.test(e.name)&&delete e.parent[e.name]}},d._configure=function(e,t,n){o=e,i=t,a=n}},5054:function(e){"use strict";e.exports={}},5994:function(e,t,n){"use strict";t.Service=n(7948)},7948:function(e,t,n){"use strict";e.exports=o;var r=n(9693);function o(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(o.prototype=Object.create(r.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function e(t,n,o,i,a){if(!i)throw TypeError("request must be specified");var s=this;if(!a)return r.asPromise(e,s,t,n,o,i);if(s.rpcImpl)try{return s.rpcImpl(t,n[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,n){if(e)return s.emit("error",e,t),a(e);if(null!==n){if(!(n instanceof o))try{n=o[s.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",n,t),a(null,n)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){a(e)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},7513:function(e,t,n){"use strict";e.exports=s;var r=n(9313);((s.prototype=Object.create(r.prototype)).constructor=s).className="Service";var o=n(4429),i=n(9935),a=n(5994);function s(e,t){r.call(this,e,t),this.methods={},this._methodsArray=null}function c(e){return e._methodsArray=null,e}s.fromJSON=function(e,t){var n=new s(e,t.options);if(t.methods)for(var r=Object.keys(t.methods),i=0;i<r.length;++i)n.add(o.fromJSON(r[i],t.methods[r[i]]));return t.nested&&n.addJSON(t.nested),n.comment=t.comment,n},s.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return i.toObject(["options",t&&t.options||void 0,"methods",r.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},Object.defineProperty(s.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=i.toArray(this.methods))}}),s.prototype.get=function(e){return this.methods[e]||r.prototype.get.call(this,e)},s.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return r.prototype.resolve.call(this)},s.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof o?(this.methods[e.name]=e,e.parent=this,c(this)):r.prototype.add.call(this,e)},s.prototype.remove=function(e){if(e instanceof o){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,c(this)}return r.prototype.remove.call(this,e)},s.prototype.create=function(e,t,n){for(var r,o=new a.Service(e,t,n),s=0;s<this.methodsArray.length;++s){var c=i.lcFirst((r=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");o[c]=i.codegen(["r","c"],i.isReserved(c)?c+"_":c)("return this.rpcCall(m,q,s,r,c)")({m:r,q:r.resolvedRequestType.ctor,s:r.resolvedResponseType.ctor})}return o}},626:function(e){"use strict";e.exports=d;var t=/[\s{}=;:[\],'"()<>]/g,n=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,r=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,o=/^ *[*/]+ */,i=/^\s*\*?\/*/,a=/\n/g,s=/\s/,c=/\\(.?)/g,l={0:"\0",r:"\r",n:"\n",t:"\t"};function u(e){return e.replace(c,(function(e,t){switch(t){case"\\":case"":return t;default:return l[t]||""}}))}function d(e,c){e=e.toString();var l=0,d=e.length,p=1,h=null,f=null,m=0,v=!1,g=!1,E=[],y=null;function _(e){return Error("illegal "+e+" (line "+p+")")}function b(t){return e.charAt(t)}function T(t,n,r){h=e.charAt(t++),m=p,v=!1,g=r;var s,l=t-(c?2:3);do{if(--l<0||"\n"===(s=e.charAt(l))){v=!0;break}}while(" "===s||"\t"===s);for(var u=e.substring(t,n).split(a),d=0;d<u.length;++d)u[d]=u[d].replace(c?i:o,"").trim();f=u.join("\n").trim()}function S(t){var n=O(t),r=e.substring(t,n);return/^\s*\/{1,2}/.test(r)}function O(e){for(var t=e;t<d&&"\n"!==b(t);)t++;return t}function R(){if(E.length>0)return E.shift();if(y)return function(){var t="'"===y?r:n;t.lastIndex=l-1;var o=t.exec(e);if(!o)throw _("string");return l=t.lastIndex,C(y),y=null,u(o[1])}();var o,i,a,h,f,m=0===l;do{if(l===d)return null;for(o=!1;s.test(a=b(l));)if("\n"===a&&(m=!0,++p),++l===d)return null;if("/"===b(l)){if(++l===d)throw _("comment");if("/"===b(l))if(c){if(h=l,f=!1,S(l)){f=!0;do{if((l=O(l))===d)break;l++}while(S(l))}else l=Math.min(d,O(l)+1);f&&T(h,l,m),p++,o=!0}else{for(f="/"===b(h=l+1);"\n"!==b(++l);)if(l===d)return null;++l,f&&T(h,l-1,m),++p,o=!0}else{if("*"!==(a=b(l)))return"/";h=l+1,f=c||"*"===b(h);do{if("\n"===a&&++p,++l===d)throw _("comment");i=a,a=b(l)}while("*"!==i||"/"!==a);++l,f&&T(h,l-2,m),o=!0}}}while(o);var v=l;if(t.lastIndex=0,!t.test(b(v++)))for(;v<d&&!t.test(b(v));)++v;var g=e.substring(l,l=v);return'"'!==g&&"'"!==g||(y=g),g}function C(e){E.push(e)}function w(){if(!E.length){var e=R();if(null===e)return null;C(e)}return E[0]}return Object.defineProperty({next:R,peek:w,push:C,skip:function(e,t){var n=w();if(n===e)return R(),!0;if(!t)throw _("token '"+n+"', '"+e+"' expected");return!1},cmnt:function(e){var t=null;return void 0===e?m===p-1&&(c||"*"===h||v)&&(t=g?f:null):(m<e&&w(),m!==e||v||!c&&"/"!==h||(t=g?null:f)),t}},"line",{get:function(){return p}})}d.unescape=u},7645:function(e,t,n){"use strict";e.exports=E;var r=n(9313);((E.prototype=Object.create(r.prototype)).constructor=E).className="Type";var o=n(7025),i=n(7598),a=n(3548),s=n(6039),c=n(7513),l=n(8368),u=n(1408),d=n(1173),p=n(9935),h=n(4928),f=n(5305),m=n(4497),v=n(3996),g=n(1667);function E(e,t){r.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function y(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(E.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var n=this.fields[e[t]],r=n.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=p.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=p.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=E.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof l||((e.prototype=new l).constructor=e,p.merge(e.prototype,t)),e.$type=e.prototype.$type=this,p.merge(e,l,!0),this._ctor=e;for(var n=0;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var r={};for(n=0;n<this.oneofsArray.length;++n)r[this._oneofsArray[n].resolve().name]={get:p.oneOfGetter(this._oneofsArray[n].oneof),set:p.oneOfSetter(this._oneofsArray[n].oneof)};n&&Object.defineProperties(e.prototype,r)}}}),E.generateConstructor=function(e){for(var t,n=p.codegen(["p"],e.name),r=0;r<e.fieldsArray.length;++r)(t=e._fieldsArray[r]).map?n("this%s={}",p.safeProp(t.name)):t.repeated&&n("this%s=[]",p.safeProp(t.name));return n("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},E.fromJSON=function(e,t){var n=new E(e,t.options);n.extensions=t.extensions,n.reserved=t.reserved;for(var l=Object.keys(t.fields),u=0;u<l.length;++u)n.add((void 0!==t.fields[l[u]].keyType?s.fromJSON:a.fromJSON)(l[u],t.fields[l[u]]));if(t.oneofs)for(l=Object.keys(t.oneofs),u=0;u<l.length;++u)n.add(i.fromJSON(l[u],t.oneofs[l[u]]));if(t.nested)for(l=Object.keys(t.nested),u=0;u<l.length;++u){var d=t.nested[l[u]];n.add((void 0!==d.id?a.fromJSON:void 0!==d.fields?E.fromJSON:void 0!==d.values?o.fromJSON:void 0!==d.methods?c.fromJSON:r.fromJSON)(l[u],d))}return t.extensions&&t.extensions.length&&(n.extensions=t.extensions),t.reserved&&t.reserved.length&&(n.reserved=t.reserved),t.group&&(n.group=!0),t.comment&&(n.comment=t.comment),n},E.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return p.toObject(["options",t&&t.options||void 0,"oneofs",r.arrayToJSON(this.oneofsArray,e),"fields",r.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},E.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var n=this.oneofsArray;for(t=0;t<n.length;)n[t++].resolve();return r.prototype.resolveAll.call(this)},E.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},E.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof a&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),y(this)}return e instanceof i?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),y(this)):r.prototype.add.call(this,e)},E.prototype.remove=function(e){if(e instanceof a&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),y(this)}if(e instanceof i){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),y(this)}return r.prototype.remove.call(this,e)},E.prototype.isReservedId=function(e){return r.isReservedId(this.reserved,e)},E.prototype.isReservedName=function(e){return r.isReservedName(this.reserved,e)},E.prototype.create=function(e){return new this.ctor(e)},E.prototype.setup=function(){for(var e=this.fullName,t=[],n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=h(this)({Writer:d,types:t,util:p}),this.decode=f(this)({Reader:u,types:t,util:p}),this.verify=m(this)({types:t,util:p}),this.fromObject=v.fromObject(this)({types:t,util:p}),this.toObject=v.toObject(this)({types:t,util:p});var r=g[e];if(r){var o=Object.create(this);o.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(o),o.toObject=this.toObject,this.toObject=r.toObject.bind(o)}return this},E.prototype.encode=function(e,t){return this.setup().encode(e,t)},E.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},E.prototype.decode=function(e,t){return this.setup().decode(e,t)},E.prototype.decodeDelimited=function(e){return e instanceof u||(e=u.create(e)),this.decode(e,e.uint32())},E.prototype.verify=function(e){return this.setup().verify(e)},E.prototype.fromObject=function(e){return this.setup().fromObject(e)},E.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},E.d=function(e){return function(t){p.decorateType(t,e)}}},7063:function(e,t,n){"use strict";var r=t,o=n(9935),i=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function a(e,t){var n=0,r={};for(t|=0;n<e.length;)r[i[n+t]]=e[n++];return r}r.basic=a([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),r.defaults=a([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",o.emptyArray,null]),r.long=a([0,0,0,1,1],7),r.mapKey=a([0,0,0,5,5,0,0,0,1,1,0,2],2),r.packed=a([1,5,0,0,0,5,5,0,0,0,1,1,0])},9935:function(e,t,n){"use strict";var r,o,i=e.exports=n(9693),a=n(5054);i.codegen=n(5124),i.fetch=n(9054),i.path=n(8626),i.fs=i.inquire("fs"),i.toArray=function(e){if(e){for(var t=Object.keys(e),n=new Array(t.length),r=0;r<t.length;)n[r]=e[t[r++]];return n}return[]},i.toObject=function(e){for(var t={},n=0;n<e.length;){var r=e[n++],o=e[n++];void 0!==o&&(t[r]=o)}return t};var s=/\\/g,c=/"/g;i.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},i.safeProp=function(e){return!/^[$\w_]+$/.test(e)||i.isReserved(e)?'["'+e.replace(s,"\\\\").replace(c,'\\"')+'"]':"."+e},i.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var l=/_([a-z])/g;i.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(l,(function(e,t){return t.toUpperCase()}))},i.compareFieldsById=function(e,t){return e.id-t.id},i.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(i.decorateRoot.remove(e.$type),e.$type.name=t,i.decorateRoot.add(e.$type)),e.$type;r||(r=n(7645));var o=new r(t||e.name);return i.decorateRoot.add(o),o.ctor=e,Object.defineProperty(e,"$type",{value:o,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:o,enumerable:!1}),o};var u=0;i.decorateEnum=function(e){if(e.$type)return e.$type;o||(o=n(7025));var t=new o("Enum"+u++,e);return i.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t},i.setProperty=function(e,t,n){if("object"!=typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return function e(t,n,r){var o=n.shift();if("__proto__"===o)return t;if(n.length>0)t[o]=e(t[o]||{},n,r);else{var i=t[o];i&&(r=[].concat(i).concat(r)),t[o]=r}return t}(e,t=t.split("."),n)},Object.defineProperty(i,"decorateRoot",{get:function(){return a.decorated||(a.decorated=new(n(9424)))}})},1945:function(e,t,n){"use strict";e.exports=o;var r=n(9693);function o(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=o.zero=new o(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var a=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new o(n,r)},o.from=function(e){if("number"==typeof e)return o.fromNumber(e);if(r.isString(e)){if(!r.Long)return o.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new o(e.low>>>0,e.high>>>0):i},o.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;o.fromHash=function(e){return e===a?i:new o((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},o.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},o.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},9693:function(e,t,n){"use strict";var r=t;function o(e,t,n){for(var r=Object.keys(t),o=0;o<r.length;++o)void 0!==e[r[o]]&&n||(e[r[o]]=t[r[o]]);return e}function i(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&o(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=n(4537),r.base64=n(7419),r.EventEmitter=n(9211),r.float=n(945),r.inquire=n(7199),r.utf8=n(4997),r.pool=n(6662),r.LongBits=n(1945),r.isNode=Boolean(void 0!==n.g&&n.g&&n.g.process&&n.g.process.versions&&n.g.process.versions.node),r.global=r.isNode&&n.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=o,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=i,r.ProtocolError=i("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},4497:function(e,t,n){"use strict";e.exports=function(e){var t=o.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),n={};e.oneofsArray.length&&t("var p={}");for(var r=0;r<e.fieldsArray.length;++r){var c=e._fieldsArray[r].resolve(),l="m"+o.safeProp(c.name);if(c.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",l,c.name),c.map)t("if(!util.isObject(%s))",l)("return%j",i(c,"object"))("var k=Object.keys(%s)",l)("for(var i=0;i<k.length;++i){"),s(t,c,"k[i]"),a(t,c,r,l+"[k[i]]")("}");else if(c.repeated)t("if(!Array.isArray(%s))",l)("return%j",i(c,"array"))("for(var i=0;i<%s.length;++i){",l),a(t,c,r,l+"[i]")("}");else{if(c.partOf){var u=o.safeProp(c.partOf.name);1===n[c.partOf.name]&&t("if(p%s===1)",u)("return%j",c.partOf.name+": multiple values"),n[c.partOf.name]=1,t("p%s=1",u)}a(t,c,r,l)}c.optional&&t("}")}return t("return null")};var r=n(7025),o=n(9935);function i(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function a(e,t,n,o){if(t.resolvedType)if(t.resolvedType instanceof r){e("switch(%s){",o)("default:")("return%j",i(t,"enum value"));for(var a=Object.keys(t.resolvedType.values),s=0;s<a.length;++s)e("case %i:",t.resolvedType.values[a[s]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",n,o)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",o)("return%j",i(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",o,o,o,o)("return%j",i(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',o)("return%j",i(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',o)("return%j",i(t,"boolean"));break;case"string":e("if(!util.isString(%s))",o)("return%j",i(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',o,o,o)("return%j",i(t,"buffer"))}return e}function s(e,t,n){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",n)("return%j",i(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",n)("return%j",i(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",n)("return%j",i(t,"boolean key"))}return e}},1667:function(e,t,n){"use strict";var r=t,o=n(8368);r[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),n=this.lookup(t);if(n){var r="."===e["@type"].charAt(0)?e["@type"].substr(1):e["@type"];return-1===r.indexOf("/")&&(r="/"+r),this.create({type_url:r,value:n.encode(n.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var n="",r="";if(t&&t.json&&e.type_url&&e.value){r=e.type_url.substring(e.type_url.lastIndexOf("/")+1),n=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var i=this.lookup(r);i&&(e=i.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof o){var a=e.$type.toObject(e,t);return""===n&&(n="type.googleapis.com/"),r=n+("."===e.$type.fullName[0]?e.$type.fullName.substr(1):e.$type.fullName),a["@type"]=r,a}return this.toObject(e,t)}}},1173:function(e,t,n){"use strict";e.exports=d;var r,o=n(9693),i=o.LongBits,a=o.base64,s=o.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function l(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var p=function(){return o.Buffer?function(){return(d.create=function(){return new r})()}:function(){return new d}};function h(e,t,n){t[n]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function v(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}d.create=p(),d.alloc=function(e){return new o.Array(e)},o.Array!==Array&&(d.alloc=o.pool(d.alloc,o.Array.prototype.subarray)),d.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},f.prototype=Object.create(c.prototype),f.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(m,10,i.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=i.from(e);return this._push(m,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(m,t.length(),t)},d.prototype.bool=function(e){return this._push(h,1,e?1:0)},d.prototype.fixed32=function(e){return this._push(v,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=i.from(e);return this._push(v,4,t.lo)._push(v,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(o.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(o.float.writeDoubleLE,8,e)};var g=o.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(h,1,0);if(o.isString(e)){var n=d.alloc(t=a.length(e));a.decode(e,n,0),e=n}return this.uint32(t)._push(g,t,e)},d.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(h,1,0)},d.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(l,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},d._configure=function(e){r=e,d.create=p(),r._configure()}},3155:function(e,t,n){"use strict";e.exports=i;var r=n(1173);(i.prototype=Object.create(r.prototype)).constructor=i;var o=n(9693);function i(){r.call(this)}function a(e,t,n){e.length<40?o.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}i._configure=function(){i.alloc=o._Buffer_allocUnsafe,i.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&"set"===o.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},i.prototype.bytes=function(e){o.isString(e)&&(e=o._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=o.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},i._configure()},8e3:function(e,t,n){"use strict";var r=n(7581);e.exports=n(3626)(r),"_sockjs_onload"in n.g&&setTimeout(n.g._sockjs_onload,1)},2530:function(e,t,n){"use strict";var r=n(5717),o=n(685);function i(){o.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}r(i,o),e.exports=i},3212:function(e,t,n){"use strict";var r=n(5717),o=n(3184);function i(){o.call(this)}r(i,o),i.prototype.removeAllListeners=function(e){e?delete this._listeners[e]:this._listeners={}},i.prototype.once=function(e,t){var n=this,r=!1;this.on(e,(function o(){n.removeListener(e,o),r||(r=!0,t.apply(this,arguments))}))},i.prototype.emit=function(){var e=arguments[0],t=this._listeners[e];if(t){for(var n=arguments.length,r=new Array(n-1),o=1;o<n;o++)r[o-1]=arguments[o];for(var i=0;i<t.length;i++)t[i].apply(this,r)}},i.prototype.on=i.prototype.addListener=o.prototype.addEventListener,i.prototype.removeListener=o.prototype.removeEventListener,e.exports.v=i},685:function(e){"use strict";function t(e){this.type=e}t.prototype.initEvent=function(e,t,n){return this.type=e,this.bubbles=t,this.cancelable=n,this.timeStamp=+new Date,this},t.prototype.stopPropagation=function(){},t.prototype.preventDefault=function(){},t.CAPTURING_PHASE=1,t.AT_TARGET=2,t.BUBBLING_PHASE=3,e.exports=t},3184:function(e){"use strict";function t(){this._listeners={}}t.prototype.addEventListener=function(e,t){e in this._listeners||(this._listeners[e]=[]);var n=this._listeners[e];-1===n.indexOf(t)&&(n=n.concat([t])),this._listeners[e]=n},t.prototype.removeEventListener=function(e,t){var n=this._listeners[e];if(n){var r=n.indexOf(t);-1===r||(n.length>1?this._listeners[e]=n.slice(0,r).concat(n.slice(r+1)):delete this._listeners[e])}},t.prototype.dispatchEvent=function(){var e=arguments[0],t=e.type,n=1===arguments.length?[e]:Array.apply(null,arguments);if(this["on"+t]&&this["on"+t].apply(this,n),t in this._listeners)for(var r=this._listeners[t],o=0;o<r.length;o++)r[o].apply(this,n)},e.exports=t},3326:function(e,t,n){"use strict";var r=n(5717),o=n(685);function i(e){o.call(this),this.initEvent("message",!1,!1),this.data=e}r(i,o),e.exports=i},691:function(e,t,n){"use strict";var r=n(3683);function o(e){this._transport=e,e.on("message",this._transportMessage.bind(this)),e.on("close",this._transportClose.bind(this))}o.prototype._transportClose=function(e,t){r.postMessage("c",JSON.stringify([e,t]))},o.prototype._transportMessage=function(e){r.postMessage("t",e)},o.prototype._send=function(e){this._transport.send(e)},o.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},e.exports=o},551:function(e,t,n){"use strict";var r=n(273),o=n(7705),i=n(691),a=n(6311),s=n(3683),c=n(7486);e.exports=function(e,t){var n,l={};t.forEach((function(e){e.facadeTransport&&(l[e.facadeTransport.transportName]=e.facadeTransport)})),l[a.transportName]=a,e.bootstrap_iframe=function(){var t;s.currentWindowId=c.hash.slice(1),o.attachEvent("message",(function(o){if(o.source===parent&&(void 0===n&&(n=o.origin),o.origin===n)){var a;try{a=JSON.parse(o.data)}catch(e){return void o.data}if(a.windowId===s.currentWindowId)switch(a.type){case"s":var u;try{u=JSON.parse(a.data)}catch(e){a.data;break}var d=u[0],p=u[1],h=u[2],f=u[3];if(d!==e.version)throw new Error('Incompatible SockJS! Main site uses: "'+d+'", the iframe: "'+e.version+'".');if(!r.isOriginEqual(h,c.href)||!r.isOriginEqual(f,c.href))throw new Error("Can't connect to different domain from within an iframe. ("+c.href+", "+h+", "+f+")");t=new i(new l[p](h,f));break;case"m":t._send(a.data);break;case"c":t&&t._close(),t=null}}})),s.postMessage("s")}}},2550:function(e,t,n){"use strict";var r=n(3212).v,o=n(5717),i=n(2217);function a(e,t){r.call(this);var n=this,o=+new Date;this.xo=new t("GET",e),this.xo.once("finish",(function(e,t){var r,a;if(200===e){if(a=+new Date-o,t)try{r=JSON.parse(t)}catch(e){}i.isObject(r)||(r={})}n.emit("finish",r,a),n.removeAllListeners()}))}o(a,r),a.prototype.close=function(){this.removeAllListeners(),this.xo.close()},e.exports=a},6311:function(e,t,n){"use strict";var r=n(5717),o=n(3212).v,i=n(3515),a=n(2550);function s(e){var t=this;o.call(this),this.ir=new a(e,i),this.ir.once("finish",(function(e,n){t.ir=null,t.emit("message",JSON.stringify([e,n]))}))}r(s,o),s.transportName="iframe-info-receiver",s.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},e.exports=s},3616:function(e,t,n){"use strict";var r=n(3212).v,o=n(5717),i=n(7705),a=n(5088),s=n(6311);function c(e,t){var o=this;r.call(this);var c=function(){var n=o.ifr=new a(s.transportName,t,e);n.once("message",(function(e){if(e){var t;try{t=JSON.parse(e)}catch(e){return o.emit("finish"),void o.close()}var n=t[0],r=t[1];o.emit("finish",n,r)}o.close()})),n.once("close",(function(){o.emit("finish"),o.close()}))};n.g.document.body?c():i.attachEvent("load",c)}o(c,r),c.enabled=function(){return a.enabled()},c.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},e.exports=c},5172:function(e,t,n){"use strict";var r=n(3212).v,o=n(5717),i=n(273),a=n(6073),s=n(9033),c=n(3515),l=n(7103),u=n(3616),d=n(2550);function p(e,t){var n=this;r.call(this),setTimeout((function(){n.doXhr(e,t)}),0)}o(p,r),p._getReceiver=function(e,t,n){return n.sameOrigin?new d(t,c):s.enabled?new d(t,s):a.enabled&&n.sameScheme?new d(t,a):u.enabled()?new u(e,t):new d(t,l)},p.prototype.doXhr=function(e,t){var n=this,r=i.addPath(e,"/info");this.xo=p._getReceiver(e,r,t),this.timeoutRef=setTimeout((function(){n._cleanup(!1),n.emit("finish")}),p.timeout),this.xo.once("finish",(function(e,t){n._cleanup(!0),n.emit("finish",e,t)}))},p.prototype._cleanup=function(e){clearTimeout(this.timeoutRef),this.timeoutRef=null,!e&&this.xo&&this.xo.close(),this.xo=null},p.prototype.close=function(){this.removeAllListeners(),this._cleanup(!1)},p.timeout=8e3,e.exports=p},7486:function(e,t,n){"use strict";e.exports=n.g.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}},3626:function(e,t,n){"use strict";n(1247);var r,o=n(4564),i=n(5717),a=n(8915),s=n(8028),c=n(273),l=n(7705),u=n(5581),d=n(2217),p=n(8510),h=n(4886),f=n(685),m=n(3184),v=n(7486),g=n(2530),E=n(3326),y=n(5172);function _(e,t,n){if(!(this instanceof _))return new _(e,t,n);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");m.call(this),this.readyState=_.CONNECTING,this.extensions="",this.protocol="",(n=n||{}).protocols_whitelist&&h.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=n.transports,this._transportOptions=n.transportOptions||{},this._timeout=n.timeout||0;var r=n.sessionId||8;if("function"==typeof r)this._generateSessionId=r;else{if("number"!=typeof r)throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._generateSessionId=function(){return a.string(r)}}this._server=n.server||a.numberString(1e3);var i=new o(e);if(!i.host||!i.protocol)throw new SyntaxError("The URL '"+e+"' is invalid");if(i.hash)throw new SyntaxError("The URL must not contain a fragment");if("http:"!==i.protocol&&"https:"!==i.protocol)throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+i.protocol+"' is not allowed.");var s="https:"===i.protocol;if("https:"===v.protocol&&!s&&!c.isLoopbackAddr(i.hostname))throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");t?Array.isArray(t)||(t=[t]):t=[];var l=t.sort();l.forEach((function(e,t){if(!e)throw new SyntaxError("The protocols entry '"+e+"' is invalid.");if(t<l.length-1&&e===l[t+1])throw new SyntaxError("The protocols entry '"+e+"' is duplicated.")}));var u=c.getOrigin(v.href);this._origin=u?u.toLowerCase():null,i.set("pathname",i.pathname.replace(/\/+$/,"")),this.url=i.href,this.url,this._urlInfo={nullOrigin:!p.hasDomain(),sameOrigin:c.isOriginEqual(this.url,v.href),sameScheme:c.isSchemeEqual(this.url,v.href)},this._ir=new y(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}function b(e){return 1e3===e||e>=3e3&&e<=4999}i(_,m),_.prototype.close=function(e,t){if(e&&!b(e))throw new Error("InvalidAccessError: Invalid code");if(t&&t.length>123)throw new SyntaxError("reason argument has an invalid length");this.readyState!==_.CLOSING&&this.readyState!==_.CLOSED&&this._close(e||1e3,t||"Normal closure",!0)},_.prototype.send=function(e){if("string"!=typeof e&&(e=""+e),this.readyState===_.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===_.OPEN&&this._transport.send(s.quote(e))},_.version=n(2828),_.CONNECTING=0,_.OPEN=1,_.CLOSING=2,_.CLOSED=3,_.prototype._receiveInfo=function(e,t){if(this._ir=null,e){this._rto=this.countRTO(t),this._transUrl=e.base_url?e.base_url:this.url,e=d.extend(e,this._urlInfo);var n=r.filterToEnabled(this._transportsWhitelist,e);this._transports=n.main,this._transports.length,this._connect()}else this._close(1002,"Cannot connect to server")},_.prototype._connect=function(){for(var e=this._transports.shift();e;e=this._transports.shift()){if(e.transportName,e.needBody&&(!n.g.document.body||void 0!==n.g.document.readyState&&"complete"!==n.g.document.readyState&&"interactive"!==n.g.document.readyState))return this._transports.unshift(e),void l.attachEvent("load",this._connect.bind(this));var t=Math.max(this._timeout,this._rto*e.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),t);var r=c.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),o=this._transportOptions[e.transportName],i=new e(r,this._transUrl,o);return i.on("message",this._transportMessage.bind(this)),i.once("close",this._transportClose.bind(this)),i.transportName=e.transportName,void(this._transport=i)}this._close(2e3,"All transports failed",!1)},_.prototype._transportTimeout=function(){this.readyState===_.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))},_.prototype._transportMessage=function(e){var t,n=this,r=e.slice(0,1),o=e.slice(1);switch(r){case"o":return void this._open();case"h":return this.dispatchEvent(new f("heartbeat")),void this.transport}if(o)try{t=JSON.parse(o)}catch(e){}if(void 0!==t)switch(r){case"a":Array.isArray(t)&&t.forEach((function(e){n.transport,n.dispatchEvent(new E(e))}));break;case"m":this.transport,this.dispatchEvent(new E(t));break;case"c":Array.isArray(t)&&2===t.length&&this._close(t[0],t[1],!0)}},_.prototype._transportClose=function(e,t){this.transport,this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),b(e)||2e3===e||this.readyState!==_.CONNECTING?this._close(e,t):this._connect()},_.prototype._open=function(){this._transport&&this._transport.transportName,this.readyState,this.readyState===_.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=_.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new f("open")),this.transport):this._close(1006,"Server lost session")},_.prototype._close=function(e,t,n){this.transport,this.readyState;var r=!1;if(this._ir&&(r=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===_.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=_.CLOSING,setTimeout(function(){this.readyState=_.CLOSED,r&&this.dispatchEvent(new f("error"));var o=new g("close");o.wasClean=n||!1,o.code=e||1e3,o.reason=t,this.dispatchEvent(o),this.onmessage=this.onclose=this.onerror=null}.bind(this),0)},_.prototype.countRTO=function(e){return e>100?4*e:300+e},e.exports=function(e){return r=u(e),n(551)(_,e),_}},1247:function(){"use strict";var e,t=Array.prototype,n=Object.prototype,r=Function.prototype,o=String.prototype,i=t.slice,a=n.toString,s=function(e){return"[object Function]"===n.toString.call(e)},c=function(e){return"[object String]"===a.call(e)},l=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}();e=l?function(e,t,n,r){!r&&t in e||Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:n})}:function(e,t,n,r){!r&&t in e||(e[t]=n)};var u=function(t,r,o){for(var i in r)n.hasOwnProperty.call(r,i)&&e(t,i,r[i],o)},d=function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return Object(e)};function p(){}u(r,{bind:function(e){var t=this;if(!s(t))throw new TypeError("Function.prototype.bind called on incompatible "+t);for(var n=i.call(arguments,1),r=Math.max(0,t.length-n.length),o=[],a=0;a<r;a++)o.push("$"+a);var c=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this, arguments); }")((function(){if(this instanceof c){var r=t.apply(this,n.concat(i.call(arguments)));return Object(r)===r?r:this}return t.apply(e,n.concat(i.call(arguments)))}));return t.prototype&&(p.prototype=t.prototype,c.prototype=new p,p.prototype=null),c}}),u(Array,{isArray:function(e){return"[object Array]"===a.call(e)}});var h,f,m,v=Object("a"),g="a"!==v[0]||!(0 in v);u(t,{forEach:function(e){var t=d(this),n=g&&c(this)?this.split(""):t,r=arguments[1],o=-1,i=n.length>>>0;if(!s(e))throw new TypeError;for(;++o<i;)o in n&&e.call(r,n[o],o,t)}},(h=t.forEach,f=!0,m=!0,h&&(h.call("foo",(function(e,t,n){"object"!=typeof n&&(f=!1)})),h.call([1],(function(){m="string"==typeof this}),"x")),!(h&&f&&m)));var E=Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2);u(t,{indexOf:function(e){var t=g&&c(this)?this.split(""):d(this),n=t.length>>>0;if(!n)return-1;var r,o=0;for(arguments.length>1&&((r=+arguments[1])!=r?r=0:0!==r&&r!==1/0&&r!==-1/0&&(r=(r>0||-1)*Math.floor(Math.abs(r))),o=r),o=o>=0?o:Math.max(0,n+o);o<n;o++)if(o in t&&t[o]===e)return o;return-1}},E);var y,_=o.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?(y=void 0===/()??/.exec("")[1],o.split=function(e,n){var r=this;if(void 0===e&&0===n)return[];if("[object RegExp]"!==a.call(e))return _.call(this,e,n);var o,i,s,c,l=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),d=0;for(e=new RegExp(e.source,u+"g"),r+="",y||(o=new RegExp("^"+e.source+"$(?!\\s)",u)),n=void 0===n?-1>>>0:n>>>0;(i=e.exec(r))&&!((s=i.index+i[0].length)>d&&(l.push(r.slice(d,i.index)),!y&&i.length>1&&i[0].replace(o,(function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(i[e]=void 0)})),i.length>1&&i.index<r.length&&t.push.apply(l,i.slice(1)),c=i[0].length,d=s,l.length>=n));)e.lastIndex===i.index&&e.lastIndex++;return d===r.length?!c&&e.test("")||l.push(""):l.push(r.slice(d)),l.length>n?l.slice(0,n):l}):"0".split(void 0,0).length&&(o.split=function(e,t){return void 0===e&&0===t?[]:_.call(this,e,t)});var b=o.substr;u(o,{substr:function(e,t){return b.call(this,e<0&&(e=this.length+e)<0?0:e,t)}},"".substr&&"b"!=="0b".substr(-1))},7581:function(e,t,n){"use strict";e.exports=[n(2412),n(9842),n(4620),n(3004),n(882)(n(3004)),n(5616),n(882)(n(5616)),n(2387),n(9998),n(882)(n(2387)),n(5375)]},2940:function(e,t,n){"use strict";var r=n(3212).v,o=n(5717),i=n(7705),a=n(273),s=n.g.XMLHttpRequest;function c(e,t,n,o){var i=this;r.call(this),setTimeout((function(){i._start(e,t,n,o)}),0)}o(c,r),c.prototype._start=function(e,t,n,r){var o=this;try{this.xhr=new s}catch(e){}if(!this.xhr)return this.emit("finish",0,"no xhr support"),void this._cleanup();t=a.addQuery(t,"t="+ +new Date),this.unloadRef=i.unloadAdd((function(){o._cleanup(!0)}));try{this.xhr.open(e,t,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){o.emit("finish",0,""),o._cleanup(!1)})}catch(e){return this.emit("finish",0,""),void this._cleanup(!1)}if(r&&r.noCredentials||!c.supportsCORS||(this.xhr.withCredentials=!0),r&&r.headers)for(var l in r.headers)this.xhr.setRequestHeader(l,r.headers[l]);this.xhr.onreadystatechange=function(){if(o.xhr){var e,t,n=o.xhr;switch(n.readyState,n.readyState){case 3:try{t=n.status,e=n.responseText}catch(e){}1223===t&&(t=204),200===t&&e&&e.length>0&&o.emit("chunk",t,e);break;case 4:1223===(t=n.status)&&(t=204),12005!==t&&12029!==t||(t=0),n.responseText,o.emit("finish",t,n.responseText),o._cleanup(!1)}}};try{o.xhr.send(n)}catch(e){o.emit("finish",0,""),o._cleanup(!1)}},c.prototype._cleanup=function(e){if(this.xhr){if(this.removeAllListeners(),i.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),e)try{this.xhr.abort()}catch(e){}this.unloadRef=this.xhr=null}},c.prototype.close=function(){this._cleanup(!0)},c.enabled=!!s;var l=["Active"].concat("Object").join("X");!c.enabled&&l in n.g&&(s=function(){try{return new n.g[l]("Microsoft.XMLHTTP")}catch(e){return null}},c.enabled=!!new s);var u=!1;try{u="withCredentials"in new s}catch(e){}c.supportsCORS=u,e.exports=c},3759:function(e,t,n){e.exports=n.g.EventSource},9334:function(e,t,n){"use strict";var r=n.g.WebSocket||n.g.MozWebSocket;e.exports=r?function(e){return new r(e)}:void 0},3004:function(e,t,n){"use strict";var r=n(5717),o=n(9395),i=n(6709),a=n(9033),s=n(3759);function c(e){if(!c.enabled())throw new Error("Transport created when disabled");o.call(this,e,"/eventsource",i,a)}r(c,o),c.enabled=function(){return!!s},c.transportName="eventsource",c.roundTrips=2,e.exports=c},5616:function(e,t,n){"use strict";var r=n(5717),o=n(3608),i=n(3515),a=n(9395);function s(e){if(!o.enabled)throw new Error("Transport created when disabled");a.call(this,e,"/htmlfile",o,i)}r(s,a),s.enabled=function(e){return o.enabled&&e.sameOrigin},s.transportName="htmlfile",s.roundTrips=2,e.exports=s},5088:function(e,t,n){"use strict";var r=n(5717),o=n(3212).v,i=n(2828),a=n(273),s=n(3683),c=n(7705),l=n(8915);function u(e,t,n){if(!u.enabled())throw new Error("Transport created when disabled");o.call(this);var r=this;this.origin=a.getOrigin(n),this.baseUrl=n,this.transUrl=t,this.transport=e,this.windowId=l.string(8);var i=a.addPath(n,"/iframe.html")+"#"+this.windowId;this.iframeObj=s.createIframe(i,(function(e){r.emit("close",1006,"Unable to load an iframe ("+e+")"),r.close()})),this.onmessageCallback=this._message.bind(this),c.attachEvent("message",this.onmessageCallback)}r(u,o),u.prototype.close=function(){if(this.removeAllListeners(),this.iframeObj){c.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch(e){}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},u.prototype._message=function(e){if(e.data,!a.isOriginEqual(e.origin,this.origin))return e.origin,void this.origin;var t;try{t=JSON.parse(e.data)}catch(t){return void e.data}if(t.windowId!==this.windowId)return t.windowId,void this.windowId;switch(t.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([i,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",t.data);break;case"c":var n;try{n=JSON.parse(t.data)}catch(e){return void t.data}this.emit("close",n[0],n[1]),this.close()}},u.prototype.postMessage=function(e,t){this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:e,data:t||""}),this.origin)},u.prototype.send=function(e){this.postMessage("m",e)},u.enabled=function(){return s.iframeEnabled},u.transportName="iframe",u.roundTrips=2,e.exports=u},5375:function(e,t,n){"use strict";var r=n(5717),o=n(8347),i=n(514),a=n(771);function s(e){if(!s.enabled())throw new Error("Transport created when disabled");o.call(this,e,"/jsonp",a,i)}r(s,o),s.enabled=function(){return!!n.g.document},s.transportName="jsonp-polling",s.roundTrips=1,s.needBody=!0,e.exports=s},9395:function(e,t,n){"use strict";var r=n(5717),o=n(273),i=n(8347);function a(e,t,n,r){i.call(this,e,t,function(e){return function(t,n,r){var i={};"string"==typeof n&&(i.headers={"Content-type":"text/plain"});var a=o.addPath(t,"/xhr_send"),s=new e("POST",a,n,i);return s.once("finish",(function(e){if(s=null,200!==e&&204!==e)return r(new Error("http status "+e));r()})),function(){s.close(),s=null;var e=new Error("Aborted");e.code=1e3,r(e)}}}(r),n,r)}r(a,i),e.exports=a},1851:function(e,t,n){"use strict";var r=n(5717),o=n(3212).v;function i(e,t){o.call(this),this.sendBuffer=[],this.sender=t,this.url=e}r(i,o),i.prototype.send=function(e){this.sendBuffer.push(e),this.sendStop||this.sendSchedule()},i.prototype.sendScheduleWait=function(){var e,t=this;this.sendStop=function(){t.sendStop=null,clearTimeout(e)},e=setTimeout((function(){t.sendStop=null,t.sendSchedule()}),25)},i.prototype.sendSchedule=function(){this.sendBuffer.length;var e=this;if(this.sendBuffer.length>0){var t="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,t,(function(t){e.sendStop=null,t?(e.emit("close",t.code||1006,"Sending error: "+t),e.close()):e.sendScheduleWait()})),this.sendBuffer=[]}},i.prototype._cleanup=function(){this.removeAllListeners()},i.prototype.close=function(){this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)},e.exports=i},882:function(e,t,n){"use strict";var r=n(5717),o=n(5088),i=n(2217);e.exports=function(e){function t(t,n){o.call(this,e.transportName,t,n)}return r(t,o),t.enabled=function(t,r){if(!n.g.document)return!1;var a=i.extend({},r);return a.sameOrigin=!0,e.enabled(a)&&o.enabled()},t.transportName="iframe-"+e.transportName,t.needBody=!0,t.roundTrips=o.roundTrips+e.roundTrips-1,t.facadeTransport=e,t}},1265:function(e,t,n){"use strict";var r=n(5717),o=n(3212).v;function i(e,t,n){o.call(this),this.Receiver=e,this.receiveUrl=t,this.AjaxObject=n,this._scheduleReceiver()}r(i,o),i.prototype._scheduleReceiver=function(){var e=this,t=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);t.on("message",(function(t){e.emit("message",t)})),t.once("close",(function(n,r){e.pollIsClosing,e.poll=t=null,e.pollIsClosing||("network"===r?e._scheduleReceiver():(e.emit("close",n||1006,r),e.removeAllListeners()))}))},i.prototype.abort=function(){this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},e.exports=i},8347:function(e,t,n){"use strict";var r=n(5717),o=n(273),i=n(1851),a=n(1265);function s(e,t,n,r,s){var c=o.addPath(e,t),l=this;i.call(this,e,n),this.poll=new a(r,c,s),this.poll.on("message",(function(e){l.emit("message",e)})),this.poll.once("close",(function(e,t){l.poll=null,l.emit("close",e,t),l.close()}))}r(s,i),s.prototype.close=function(){i.prototype.close.call(this),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)},e.exports=s},6709:function(e,t,n){"use strict";var r=n(5717),o=n(3212).v,i=n(3759);function a(e){o.call(this);var t=this,n=this.es=new i(e);n.onmessage=function(e){e.data,t.emit("message",decodeURI(e.data))},n.onerror=function(e){n.readyState;var r=2!==n.readyState?"network":"permanent";t._cleanup(),t._close(r)}}r(a,o),a.prototype.abort=function(){this._cleanup(),this._close("user")},a.prototype._cleanup=function(){var e=this.es;e&&(e.onmessage=e.onerror=null,e.close(),this.es=null)},a.prototype._close=function(e){var t=this;setTimeout((function(){t.emit("close",null,e),t.removeAllListeners()}),200)},e.exports=a},3608:function(e,t,n){"use strict";var r=n(5717),o=n(3683),i=n(273),a=n(3212).v,s=n(8915);function c(e){a.call(this);var t=this;o.polluteGlobalNamespace(),this.id="a"+s.string(6),e=i.addQuery(e,"c="+decodeURIComponent(o.WPrefix+"."+this.id)),c.htmlfileEnabled;var r=c.htmlfileEnabled?o.createHtmlfile:o.createIframe;n.g[o.WPrefix][this.id]={start:function(){t.iframeObj.loaded()},message:function(e){t.emit("message",e)},stop:function(){t._cleanup(),t._close("network")}},this.iframeObj=r(e,(function(){t._cleanup(),t._close("permanent")}))}r(c,a),c.prototype.abort=function(){this._cleanup(),this._close("user")},c.prototype._cleanup=function(){this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete n.g[o.WPrefix][this.id]},c.prototype._close=function(e){this.emit("close",null,e),this.removeAllListeners()},c.htmlfileEnabled=!1;var l=["Active"].concat("Object").join("X");if(l in n.g)try{c.htmlfileEnabled=!!new n.g[l]("htmlfile")}catch(e){}c.enabled=c.htmlfileEnabled||o.iframeEnabled,e.exports=c},514:function(e,t,n){"use strict";var r=n(3683),o=n(8915),i=n(8510),a=n(273),s=n(5717),c=n(3212).v;function l(e){var t=this;c.call(this),r.polluteGlobalNamespace(),this.id="a"+o.string(6);var i=a.addQuery(e,"c="+encodeURIComponent(r.WPrefix+"."+this.id));n.g[r.WPrefix][this.id]=this._callback.bind(this),this._createScript(i),this.timeoutId=setTimeout((function(){t._abort(new Error("JSONP script loaded abnormally (timeout)"))}),l.timeout)}s(l,c),l.prototype.abort=function(){if(n.g[r.WPrefix][this.id]){var e=new Error("JSONP user aborted read");e.code=1e3,this._abort(e)}},l.timeout=35e3,l.scriptErrorTimeout=1e3,l.prototype._callback=function(e){this._cleanup(),this.aborting||(e&&this.emit("message",e),this.emit("close",null,"network"),this.removeAllListeners())},l.prototype._abort=function(e){this._cleanup(),this.aborting=!0,this.emit("close",e.code,e.message),this.removeAllListeners()},l.prototype._cleanup=function(){if(clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var e=this.script;e.parentNode.removeChild(e),e.onreadystatechange=e.onerror=e.onload=e.onclick=null,this.script=null}delete n.g[r.WPrefix][this.id]},l.prototype._scriptError=function(){var e=this;this.errorTimer||(this.errorTimer=setTimeout((function(){e.loadedOkay||e._abort(new Error("JSONP script loaded abnormally (onerror)"))}),l.scriptErrorTimeout))},l.prototype._createScript=function(e){var t,r=this,a=this.script=n.g.document.createElement("script");if(a.id="a"+o.string(8),a.src=e,a.type="text/javascript",a.charset="UTF-8",a.onerror=this._scriptError.bind(this),a.onload=function(){r._abort(new Error("JSONP script loaded abnormally (onload)"))},a.onreadystatechange=function(){if(a.readyState,/loaded|closed/.test(a.readyState)){if(a&&a.htmlFor&&a.onclick){r.loadedOkay=!0;try{a.onclick()}catch(e){}}a&&r._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},void 0===a.async&&n.g.document.attachEvent)if(i.isOpera())(t=this.script2=n.g.document.createElement("script")).text="try{var a = document.getElementById('"+a.id+"'); if(a)a.onerror();}catch(x){};",a.async=t.async=!1;else{try{a.htmlFor=a.id,a.event="onclick"}catch(e){}a.async=!0}void 0!==a.async&&(a.async=!0);var s=n.g.document.getElementsByTagName("head")[0];s.insertBefore(a,s.firstChild),t&&s.insertBefore(t,s.firstChild)},e.exports=l},1044:function(e,t,n){"use strict";var r=n(5717),o=n(3212).v;function i(e,t){o.call(this);var n=this;this.bufferPosition=0,this.xo=new t("POST",e,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",(function(e,t){n._chunkHandler(e,t),n.xo=null;var r=200===e?"network":"permanent";n.emit("close",null,r),n._cleanup()}))}r(i,o),i.prototype._chunkHandler=function(e,t){if(200===e&&t)for(var n=-1;;this.bufferPosition+=n+1){var r=t.slice(this.bufferPosition);if(-1===(n=r.indexOf("\n")))break;var o=r.slice(0,n);o&&this.emit("message",o)}},i.prototype._cleanup=function(){this.removeAllListeners()},i.prototype.abort=function(){this.xo&&(this.xo.close(),this.emit("close",null,"user"),this.xo=null),this._cleanup()},e.exports=i},771:function(e,t,n){"use strict";var r,o,i=n(8915),a=n(273);e.exports=function(e,t,s){r||((r=n.g.document.createElement("form")).style.display="none",r.style.position="absolute",r.method="POST",r.enctype="application/x-www-form-urlencoded",r.acceptCharset="UTF-8",(o=n.g.document.createElement("textarea")).name="d",r.appendChild(o),n.g.document.body.appendChild(r));var c="a"+i.string(8);r.target=c,r.action=a.addQuery(a.addPath(e,"/jsonp_send"),"i="+c);var l=function(e){try{return n.g.document.createElement('<iframe name="'+e+'">')}catch(r){var t=n.g.document.createElement("iframe");return t.name=e,t}}(c);l.id=c,l.style.display="none",r.appendChild(l);try{o.value=t}catch(e){}r.submit();var u=function(e){l.onerror&&(l.onreadystatechange=l.onerror=l.onload=null,setTimeout((function(){l.parentNode.removeChild(l),l=null}),500),o.value="",s(e))};return l.onerror=function(){u()},l.onload=function(){u()},l.onreadystatechange=function(e){l.readyState,"complete"===l.readyState&&u()},function(){u(new Error("Aborted"))}}},6073:function(e,t,n){"use strict";var r=n(3212).v,o=n(5717),i=n(7705),a=n(8510),s=n(273);function c(e,t,n){var o=this;r.call(this),setTimeout((function(){o._start(e,t,n)}),0)}o(c,r),c.prototype._start=function(e,t,r){var o=this,a=new n.g.XDomainRequest;t=s.addQuery(t,"t="+ +new Date),a.onerror=function(){o._error()},a.ontimeout=function(){o._error()},a.onprogress=function(){a.responseText,o.emit("chunk",200,a.responseText)},a.onload=function(){o.emit("finish",200,a.responseText),o._cleanup(!1)},this.xdr=a,this.unloadRef=i.unloadAdd((function(){o._cleanup(!0)}));try{this.xdr.open(e,t),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(r)}catch(e){this._error()}},c.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},c.prototype._cleanup=function(e){if(this.xdr){if(this.removeAllListeners(),i.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,e)try{this.xdr.abort()}catch(e){}this.unloadRef=this.xdr=null}},c.prototype.close=function(){this._cleanup(!0)},c.enabled=!(!n.g.XDomainRequest||!a.hasDomain()),e.exports=c},9033:function(e,t,n){"use strict";var r=n(5717),o=n(2940);function i(e,t,n,r){o.call(this,e,t,n,r)}r(i,o),i.enabled=o.enabled&&o.supportsCORS,e.exports=i},7103:function(e,t,n){"use strict";var r=n(3212).v;function o(){var e=this;r.call(this),this.to=setTimeout((function(){e.emit("finish",200,"{}")}),o.timeout)}n(5717)(o,r),o.prototype.close=function(){clearTimeout(this.to)},o.timeout=2e3,e.exports=o},3515:function(e,t,n){"use strict";var r=n(5717),o=n(2940);function i(e,t,n){o.call(this,e,t,n,{noCredentials:!0})}r(i,o),i.enabled=o.enabled,e.exports=i},2412:function(e,t,n){"use strict";var r=n(7705),o=n(273),i=n(5717),a=n(3212).v,s=n(9334);function c(e,t,n){if(!c.enabled())throw new Error("Transport created when disabled");a.call(this);var i=this,l=o.addPath(e,"/websocket");l="https"===l.slice(0,5)?"wss"+l.slice(5):"ws"+l.slice(4),this.url=l,this.ws=new s(this.url,[],n),this.ws.onmessage=function(e){e.data,i.emit("message",e.data)},this.unloadRef=r.unloadAdd((function(){i.ws.close()})),this.ws.onclose=function(e){e.code,e.reason,i.emit("close",e.code,e.reason),i._cleanup()},this.ws.onerror=function(e){i.emit("close",1006,"WebSocket connection broken"),i._cleanup()}}i(c,a),c.prototype.send=function(e){var t="["+e+"]";this.ws.send(t)},c.prototype.close=function(){var e=this.ws;this._cleanup(),e&&e.close()},c.prototype._cleanup=function(){var e=this.ws;e&&(e.onmessage=e.onclose=e.onerror=null),r.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},c.enabled=function(){return!!s},c.transportName="websocket",c.roundTrips=2,e.exports=c},9998:function(e,t,n){"use strict";var r=n(5717),o=n(9395),i=n(4620),a=n(1044),s=n(6073);function c(e){if(!s.enabled)throw new Error("Transport created when disabled");o.call(this,e,"/xhr",a,s)}r(c,o),c.enabled=i.enabled,c.transportName="xdr-polling",c.roundTrips=2,e.exports=c},4620:function(e,t,n){"use strict";var r=n(5717),o=n(9395),i=n(1044),a=n(6073);function s(e){if(!a.enabled)throw new Error("Transport created when disabled");o.call(this,e,"/xhr_streaming",i,a)}r(s,o),s.enabled=function(e){return!e.cookie_needed&&!e.nullOrigin&&a.enabled&&e.sameScheme},s.transportName="xdr-streaming",s.roundTrips=2,e.exports=s},2387:function(e,t,n){"use strict";var r=n(5717),o=n(9395),i=n(1044),a=n(9033),s=n(3515);function c(e){if(!s.enabled&&!a.enabled)throw new Error("Transport created when disabled");o.call(this,e,"/xhr",i,a)}r(c,o),c.enabled=function(e){return!e.nullOrigin&&(!(!s.enabled||!e.sameOrigin)||a.enabled)},c.transportName="xhr-polling",c.roundTrips=2,e.exports=c},9842:function(e,t,n){"use strict";var r=n(5717),o=n(9395),i=n(1044),a=n(9033),s=n(3515),c=n(8510);function l(e){if(!s.enabled&&!a.enabled)throw new Error("Transport created when disabled");o.call(this,e,"/xhr_streaming",i,a)}r(l,o),l.enabled=function(e){return!e.nullOrigin&&!c.isOpera()&&a.enabled},l.transportName="xhr-streaming",l.roundTrips=2,l.needBody=!!n.g.document,e.exports=l},2017:function(e,t,n){"use strict";n.g.crypto&&n.g.crypto.getRandomValues?e.exports.randomBytes=function(e){var t=new Uint8Array(e);return n.g.crypto.getRandomValues(t),t}:e.exports.randomBytes=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=Math.floor(256*Math.random());return t}},8510:function(e,t,n){"use strict";e.exports={isOpera:function(){return n.g.navigator&&/opera/i.test(n.g.navigator.userAgent)},isKonqueror:function(){return n.g.navigator&&/konqueror/i.test(n.g.navigator.userAgent)},hasDomain:function(){if(!n.g.document)return!0;try{return!!n.g.document.domain}catch(e){return!1}}}},8028:function(e){"use strict";var t,n=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g;e.exports={quote:function(e){var r=JSON.stringify(e);return n.lastIndex=0,n.test(r)?(t||(t=function(e){var t,n={},r=[];for(t=0;t<65536;t++)r.push(String.fromCharCode(t));return e.lastIndex=0,r.join("").replace(e,(function(e){return n[e]="\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4),""})),e.lastIndex=0,n}(n)),r.replace(n,(function(e){return t[e]}))):r}}},7705:function(e,t,n){"use strict";var r=n(8915),o={},i=!1,a=n.g.chrome&&n.g.chrome.app&&n.g.chrome.app.runtime;e.exports={attachEvent:function(e,t){void 0!==n.g.addEventListener?n.g.addEventListener(e,t,!1):n.g.document&&n.g.attachEvent&&(n.g.document.attachEvent("on"+e,t),n.g.attachEvent("on"+e,t))},detachEvent:function(e,t){void 0!==n.g.addEventListener?n.g.removeEventListener(e,t,!1):n.g.document&&n.g.detachEvent&&(n.g.document.detachEvent("on"+e,t),n.g.detachEvent("on"+e,t))},unloadAdd:function(e){if(a)return null;var t=r.string(8);return o[t]=e,i&&setTimeout(this.triggerUnloadCallbacks,0),t},unloadDel:function(e){e in o&&delete o[e]},triggerUnloadCallbacks:function(){for(var e in o)o[e](),delete o[e]}},a||e.exports.attachEvent("unload",(function(){i||(i=!0,e.exports.triggerUnloadCallbacks())}))},3683:function(e,t,n){"use strict";var r=n(7705),o=n(8510);e.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){e.exports.WPrefix in n.g||(n.g[e.exports.WPrefix]={})},postMessage:function(t,r){n.g.parent!==n.g&&n.g.parent.postMessage(JSON.stringify({windowId:e.exports.currentWindowId,type:t,data:r||""}),"*")},createIframe:function(e,t){var o,i,a=n.g.document.createElement("iframe"),s=function(){clearTimeout(o);try{a.onload=null}catch(e){}a.onerror=null},c=function(){a&&(s(),setTimeout((function(){a&&a.parentNode.removeChild(a),a=null}),0),r.unloadDel(i))},l=function(e){a&&(c(),t(e))};return a.src=e,a.style.display="none",a.style.position="absolute",a.onerror=function(){l("onerror")},a.onload=function(){clearTimeout(o),o=setTimeout((function(){l("onload timeout")}),2e3)},n.g.document.body.appendChild(a),o=setTimeout((function(){l("timeout")}),15e3),i=r.unloadAdd(c),{post:function(e,t){setTimeout((function(){try{a&&a.contentWindow&&a.contentWindow.postMessage(e,t)}catch(e){}}),0)},cleanup:c,loaded:s}},createHtmlfile:function(t,o){var i,a,s,c=["Active"].concat("Object").join("X"),l=new n.g[c]("htmlfile"),u=function(){clearTimeout(i),s.onerror=null},d=function(){l&&(u(),r.unloadDel(a),s.parentNode.removeChild(s),s=l=null,CollectGarbage())},p=function(e){l&&(d(),o(e))};l.open(),l.write('<html><script>document.domain="'+n.g.document.domain+'";<\/script></html>'),l.close(),l.parentWindow[e.exports.WPrefix]=n.g[e.exports.WPrefix];var h=l.createElement("div");return l.body.appendChild(h),s=l.createElement("iframe"),h.appendChild(s),s.src=t,s.onerror=function(){p("onerror")},i=setTimeout((function(){p("timeout")}),15e3),a=r.unloadAdd(d),{post:function(e,t){try{setTimeout((function(){s&&s.contentWindow&&s.contentWindow.postMessage(e,t)}),0)}catch(e){}},cleanup:d,loaded:u}}},e.exports.iframeEnabled=!1,n.g.document&&(e.exports.iframeEnabled=("function"==typeof n.g.postMessage||"object"==typeof n.g.postMessage)&&!o.isKonqueror())},4886:function(e,t,n){"use strict";var r={};["log","debug","warn"].forEach((function(e){var t;try{t=n.g.console&&n.g.console[e]&&n.g.console[e].apply}catch(e){}r[e]=t?function(){return n.g.console[e].apply(n.g.console,arguments)}:"log"===e?function(){}:r.log})),e.exports=r},2217:function(e){"use strict";e.exports={isObject:function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},extend:function(e){if(!this.isObject(e))return e;for(var t,n,r=1,o=arguments.length;r<o;r++)for(n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}}},8915:function(e,t,n){"use strict";var r=n(2017);e.exports={string:function(e){for(var t=r.randomBytes(e),n=[],o=0;o<e;o++)n.push("abcdefghijklmnopqrstuvwxyz012345".substr(t[o]%32,1));return n.join("")},number:function(e){return Math.floor(Math.random()*e)},numberString:function(e){var t=(""+(e-1)).length;return(new Array(t+1).join("0")+this.number(e)).slice(-t)}}},5581:function(e){"use strict";e.exports=function(e){return{filterToEnabled:function(t,n){var r={main:[],facade:[]};return t?"string"==typeof t&&(t=[t]):t=[],e.forEach((function(e){e&&("websocket"===e.transportName&&!1===n.websocket||(t.length&&-1===t.indexOf(e.transportName)?e.transportName:e.enabled(n)?(e.transportName,r.main.push(e),e.facadeTransport&&r.facade.push(e.facadeTransport)):e.transportName))})),r}}}},273:function(e,t,n){"use strict";var r=n(4564);e.exports={getOrigin:function(e){if(!e)return null;var t=new r(e);if("file:"===t.protocol)return null;var n=t.port;return n||(n="https:"===t.protocol?"443":"80"),t.protocol+"//"+t.hostname+":"+n},isOriginEqual:function(e,t){return this.getOrigin(e)===this.getOrigin(t)},isSchemeEqual:function(e,t){return e.split(":")[0]===t.split(":")[0]},addPath:function(e,t){var n=e.split("?");return n[0]+t+(n[1]?"?"+n[1]:"")},addQuery:function(e,t){return e+(-1===e.indexOf("?")?"?"+t:"&"+t)},isLoopbackAddr:function(e){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^\[::1\]$/.test(e)}}},2828:function(e){e.exports="1.6.1"},4564:function(e,t,n){"use strict";var r=n(4058),o=n(8188),i=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,a=/[\n\r\t]/g,s=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,c=/:\d+$/,l=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,u=/^[a-zA-Z]:/;function d(e){return(e||"").toString().replace(i,"")}var p=[["#","hash"],["?","query"],function(e,t){return m(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],h={hash:1,query:1};function f(e){var t,r=("undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{}).location||{},o={},i=typeof(e=e||r);if("blob:"===e.protocol)o=new g(unescape(e.pathname),{});else if("string"===i)for(t in o=new g(e,{}),h)delete o[t];else if("object"===i){for(t in e)t in h||(o[t]=e[t]);void 0===o.slashes&&(o.slashes=s.test(e.href))}return o}function m(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function v(e,t){e=(e=d(e)).replace(a,""),t=t||{};var n,r=l.exec(e),o=r[1]?r[1].toLowerCase():"",i=!!r[2],s=!!r[3],c=0;return i?s?(n=r[2]+r[3]+r[4],c=r[2].length+r[3].length):(n=r[2]+r[4],c=r[2].length):s?(n=r[3]+r[4],c=r[3].length):n=r[4],"file:"===o?c>=2&&(n=n.slice(2)):m(o)?n=r[4]:o?i&&(n=n.slice(2)):c>=2&&m(t.protocol)&&(n=r[4]),{protocol:o,slashes:i||m(o),slashesCount:c,rest:n}}function g(e,t,n){if(e=(e=d(e)).replace(a,""),!(this instanceof g))return new g(e,t,n);var i,s,c,l,h,E,y=p.slice(),_=typeof t,b=this,T=0;for("object"!==_&&"string"!==_&&(n=t,t=null),n&&"function"!=typeof n&&(n=o.parse),i=!(s=v(e||"",t=f(t))).protocol&&!s.slashes,b.slashes=s.slashes||i&&t.slashes,b.protocol=s.protocol||t.protocol||"",e=s.rest,("file:"===s.protocol&&(2!==s.slashesCount||u.test(e))||!s.slashes&&(s.protocol||s.slashesCount<2||!m(b.protocol)))&&(y[3]=[/(.*)/,"pathname"]);T<y.length;T++)"function"!=typeof(l=y[T])?(c=l[0],E=l[1],c!=c?b[E]=e:"string"==typeof c?~(h="@"===c?e.lastIndexOf(c):e.indexOf(c))&&("number"==typeof l[2]?(b[E]=e.slice(0,h),e=e.slice(h+l[2])):(b[E]=e.slice(h),e=e.slice(0,h))):(h=c.exec(e))&&(b[E]=h[1],e=e.slice(0,h.index)),b[E]=b[E]||i&&l[3]&&t[E]||"",l[4]&&(b[E]=b[E].toLowerCase())):e=l(e,b);n&&(b.query=n(b.query)),i&&t.slashes&&"/"!==b.pathname.charAt(0)&&(""!==b.pathname||""!==t.pathname)&&(b.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,o=n[r-1],i=!1,a=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),a++):a&&(0===r&&(i=!0),n.splice(r,1),a--);return i&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}(b.pathname,t.pathname)),"/"!==b.pathname.charAt(0)&&m(b.protocol)&&(b.pathname="/"+b.pathname),r(b.port,b.protocol)||(b.host=b.hostname,b.port=""),b.username=b.password="",b.auth&&(~(h=b.auth.indexOf(":"))?(b.username=b.auth.slice(0,h),b.username=encodeURIComponent(decodeURIComponent(b.username)),b.password=b.auth.slice(h+1),b.password=encodeURIComponent(decodeURIComponent(b.password))):b.username=encodeURIComponent(decodeURIComponent(b.auth)),b.auth=b.password?b.username+":"+b.password:b.username),b.origin="file:"!==b.protocol&&m(b.protocol)&&b.host?b.protocol+"//"+b.host:"null",b.href=b.toString()}g.prototype={set:function(e,t,n){var i=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||o.parse)(t)),i[e]=t;break;case"port":i[e]=t,r(t,i.protocol)?t&&(i.host=i.hostname+":"+t):(i.host=i.hostname,i[e]="");break;case"hostname":i[e]=t,i.port&&(t+=":"+i.port),i.host=t;break;case"host":i[e]=t,c.test(t)?(t=t.split(":"),i.port=t.pop(),i.hostname=t.join(":")):(i.hostname=t,i.port="");break;case"protocol":i.protocol=t.toLowerCase(),i.slashes=!n;break;case"pathname":case"hash":if(t){var a="pathname"===e?"/":"#";i[e]=t.charAt(0)!==a?a+t:t}else i[e]=t;break;case"username":case"password":i[e]=encodeURIComponent(t);break;case"auth":var s=t.indexOf(":");~s?(i.username=t.slice(0,s),i.username=encodeURIComponent(decodeURIComponent(i.username)),i.password=t.slice(s+1),i.password=encodeURIComponent(decodeURIComponent(i.password))):i.username=encodeURIComponent(decodeURIComponent(t))}for(var l=0;l<p.length;l++){var u=p[l];u[4]&&(i[u[1]]=i[u[1]].toLowerCase())}return i.auth=i.password?i.username+":"+i.password:i.username,i.origin="file:"!==i.protocol&&m(i.protocol)&&i.host?i.protocol+"//"+i.host:"null",i.href=i.toString(),i},toString:function(e){e&&"function"==typeof e||(e=o.stringify);var t,n=this,r=n.host,i=n.protocol;i&&":"!==i.charAt(i.length-1)&&(i+=":");var a=i+(n.protocol&&n.slashes||m(n.protocol)?"//":"");return n.username?(a+=n.username,n.password&&(a+=":"+n.password),a+="@"):n.password?(a+=":"+n.password,a+="@"):"file:"!==n.protocol&&m(n.protocol)&&!r&&"/"!==n.pathname&&(a+="@"),(":"===r[r.length-1]||c.test(n.hostname)&&!n.port)&&(r+=":"),a+=r+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(a+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(a+=n.hash),a}},g.extractProtocol=v,g.location=f,g.trimLeft=d,g.qs=o,e.exports=g},8188:function(e,t){"use strict";var n=Object.prototype.hasOwnProperty;function r(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function o(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var r,i,a=[];for(i in"string"!=typeof t&&(t="?"),e)if(n.call(e,i)){if((r=e[i])||null!=r&&!isNaN(r)||(r=""),i=o(i),r=o(r),null===i||null===r)continue;a.push(i+"="+r)}return a.length?t+a.join("&"):""},t.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,o={};t=n.exec(e);){var i=r(t[1]),a=r(t[2]);null===i||null===a||i in o||(o[i]=a)}return o}},4058:function(e){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={exports:{}};return e[t].call(i.exports,i,i.exports,r),i.exports}r.amdO={},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return function(){"use strict";r.r(o),r.d(o,{default:function(){return pe}});var e=r(8e3),t=r.n(e),n=r(3281),i=r.n(n),a=r(3720),s=r.n(a),c=(r(9601),r(1539),r(8674),r(2526),r(1817),r(2165),r(6992),r(8783),r(3948),r(8309),r(3843),r(3710),r(1532),r(4812),r(9070),r(7941),r(2222),r(9653),r(9575),r(2472),r(2990),r(8927),r(3105),r(5035),r(4345),r(7174),r(2846),r(4731),r(7209),r(6319),r(8867),r(7789),r(3739),r(9368),r(4483),r(2056),r(3462),r(678),r(7462),r(3824),r(5021),r(2974),r(5016),r(5827),r(2564),r(9554),r(4747),r(7327),r(561),r(7252)),l=r(4024),u=r(4998),d=r(5531),p=r(6424),h=(r(6699),r(7360)),f=["onTextMessage","onFileMessage","onAudioMessage","onVideoMessage","onImageMessage","onLocationMessage","onCustomMessage","onCMDMessage"],m=function(){function e(e,t,n){this.handlerData={},this.handlerData={},e.addEventHandler=this.addEventHandler.bind(this),e.removeEventHandler=this.removeEventHandler.bind(this)}return e.prototype.addEventHandler=function(e,t){this.handlerData[e]=t},e.prototype.removeEventHandler=function(e){delete this.handlerData[e]},e.prototype.dispatch=function(e,t){for(var n in f.includes(e)&&t?h.kg.debug("dispatch event: "+e,{id:t.id,type:t.type,time:t.time,from:t.from,to:t.to,chatType:t.chatType}):"onMessage"===e?h.kg.debug("dispatch event: "+e,null==t?void 0:t.length):h.kg.debug("dispatch event: "+e,t||""),this.handlerData){var r=this.handlerData[n][e];r&&r(t)}},e}(),v=function(){};function g(e){this.onOpened=e.onOpened||v,this.onPresence=e.onPresence||v,this.onTextMessage=e.onTextMessage||v,this.onPictureMessage=e.onPictureMessage||v,this.onAudioMessage=e.onAudioMessage||v,this.onVideoMessage=e.onVideoMessage||v,this.onFileMessage=e.onFileMessage||v,this.onLocationMessage=e.onLocationMessage||v,this.onCmdMessage=e.onCmdMessage||v,this.onCustomMessage=e.onCustomMessage||v,this.onReceivedMessage=e.onReceivedMessage||v,this.onDeliveredMessage=e.onDeliveredMessage||v,this.onReadMessage=e.onReadMessage||v,this.onRecallMessage=e.onRecallMessage||v,this.onChannelMessage=e.onChannelMessage||v,this.onError=e.onError||v,this.onOffline=e.onOffline||v,this.onOnline=e.onOnline||v,this.onStatisticMessage=e.onStatisticMessage||v,this.onContactInvited=e.onContactInvited||v,this.onContactAgreed=e.onContactAgreed||v,this.onContactRefuse=e.onContactRefuse||v,this.onContactDeleted=e.onContactDeleted||v,this.onContactAdded=e.onContactAdded||v,this.onTokenWillExpire=e.onTokenWillExpire||v,this.onTokenExpired=e.onTokenExpired||v,this.onClosed=e.onClosed||v,this.onPresenceStatusChange=e.onPresenceStatusChange||v}r(2772);var E={biz:"",debug:!1,token:""},y="https://data-reporting.agora.io/report",_="https://data-reporting.sh.agoralab.co/report",b=(r(2023),r(2071)),T=r(1595),S=function(e){var t=Number(T.C8[e]);return t===T.C8.USER_LOGIN?"MANUALLOGIN":t===T.C8.MSYNC_SENDMESSAGE?"SENDMESSAGE":t>T.C8.UNKNOWOPERATION&&t<T.C8.REST_OPERATE?"REST":t>T.C8.REST_OPERATE&&t<T.C8.MSYNC_OPERATE?"MESSAGE":t>T.C8.MSYNC_OPERATE&&t<T.C8.ROSTER_OPERATE?"ROSTER":t>T.C8.ROSTER_OPERATE&&t<T.C8.USER_OPERATE?"USER":t>T.C8.USER_OPERATE&&t<T.C8.GROUP_OPERATE?"GROUP":t>T.C8.GROUP_OPERATE&&t<T.C8.CHATROOM_OPERATE?"CHATROOM":"OPERATION"},O=function(){return(new Date).getTime()},R=function(e){return[l.iw.BAIDU,l.iw.WX,l.iw.DD,l.iw.ZFB,l.iw.TT,l.iw.QUICK_APP,l.iw.UNI].includes(e.platform)},C=function(){return e=1,t=99999,e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e;var e,t},w={},I=(r(1249),function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}),A=1e3,N=function(){function e(e){this.eventQueue=[],this.stock=A,this.config=e,this.governor()}return e.prototype.add=function(e){this.stock<=0?console.warn("Event Report limit ".concat(A," per minute")):(this.eventQueue.push(e),this.consume(),this.stock-=1)},e.prototype.consume=function(){var e=this;0!==this.eventQueue.length&&(this.timer&&this.eventQueue.length<=10&&clearTimeout(this.timer),this.timer=setTimeout((function(){var t,n=e.eventQueue.splice(0,10),r=n.filter((function(e){return e.appId===n[0].appId})),o=n.filter((function(e){return e.appId!==n[0].appId}));(t=e.eventQueue).unshift.apply(t,o),e.batchSend(r)}),1e3))},e.prototype.governor=function(){var e=this,t=setInterval((function(){e.stock=A}),6e4);"undefined"!=typeof addEventListener&&addEventListener("beforeunload",(function(){clearInterval(t)}))},e.prototype.batchSend=function(e){var t,n;if(void 0===e&&(e=[]),0!==e.length)try{var r=e.map((function(e){e.biz,e.appId;var t=e.eventId,n=I(e,["biz","appId","eventId"]);return{eventId:Number(t),body:n}}));!function(e,t){try{var n=t.biz,r=t.appId,o=t.data,i=t.debug,a=t.onSuccess;if(!n)throw new Error("biz is not defined");w.global||(w=l.P6.getEnvInfo());var s=w;if(R(s)){var c={url:i?_:y,data:o,method:"POST",success:function(){null==a||a()},fail:function(){},complete:function(){}},u={token:e,appid:null!=r?r:"",sendts:"".concat(Math.floor((new Date).getTime()/1e3)),biz:n,debug:"".concat(i)};if("zfb"===s.platform||"dd"===s.platform?c.headers=u:c.header=u,"dd"===s.platform)return s.global.httpRequest(c);s.global.request(c)}else{var d=new XMLHttpRequest;d.onreadystatechange=function(){2===d.readyState&&(null==a||a())},d.open("POST",i?_:y),d.setRequestHeader("Content-Type","application/json"),d.setRequestHeader("token",e),d.setRequestHeader("appid",null!=r?r:""),d.setRequestHeader("sendts","".concat(Math.floor((new Date).getTime()/1e3))),d.setRequestHeader("biz",n),d.setRequestHeader("debug","".concat(i)),d.send(JSON.stringify(o))}}catch(e){console.error(e)}}(this.config.token,{biz:null===(t=e[0])||void 0===t?void 0:t.biz,appId:null===(n=e[0])||void 0===n?void 0:n.appId,data:r,debug:this.config.debug,onSuccess:this.consume.bind(this)})}catch(e){console.error(e)}},e}(),k=function(){return k=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},k.apply(this,arguments)},P=new(function(){function e(e){this.inited=!1,this.appId="",this.biz="",this.eventQueue={},this.config=E,e&&this.init(e)}return e.prototype.init=function(e){var t;if(void 0===e&&(e={}),!e.biz||!e.token)throw new Error("Event Report: biz or token is not defined");try{this.appId=null!==(t=e.appId)&&void 0!==t?t:"",this.biz=e.biz,this.config=k(k({},E),e),this.eventQueue=new N(this.config),this.log(e),this.inited=!0}catch(e){console.error(e)}},e.prototype.send=function(e,t,n){var r;if(void 0===t&&(t={}),this.inited){var o=k(k({},t),{eventId:Number(e),biz:this.biz,appId:null!==(r=null==n?void 0:n.appId)&&void 0!==r?r:this.appId});this.eventQueue.add(o),this.log(o)}else console.error("Event Report: init is not called")},e.prototype.log=function(e){try{if(this.config.debug){var t=e.payload,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["payload"]);console.log("%c Event Report: ".concat(this.config.biz," "),"background: #8A97FC; color: #fff"),console.table(n),t&&(console.info("payload:"),console.table(t))}}catch(e){console.error(e)}},e}()),D=function(){return D=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},D.apply(this,arguments)},M={requestName:"",subrequestid:"1",requestMethod:"GET",requestUrl:"",requestElapse:0,code:0,codeDesc:"",isLastApi:0,isSuccess:1},L=function(){function e(e){this.platform=l.P6.getEnvInfo(),this.isReportDt=e.isReport||!1,this.isCollectDt=!0,R(this.platform)&&!this.isReportDt&&(this.isCollectDt=!1),this.eventQueue=[],this.accessChannel=b.yK,this.options=function(e,t){t.platform||(t=l.P6.getEnvInfo());var n=e.org,r=e.appkey,o=e.deviceId,i=e.sdkVersion,a=(null===navigator||void 0===navigator?void 0:navigator.userAgent)||"".concat(t.platform,"_mini_program");return{org:n,appkey:r,deviceId:o,sdkServiceId:"sid_".concat(l.P6.getUniqueId(),"_").concat(C()),did:a,sdkVersion:i,os:b.Wc,sdkProduct:T.aC.web}}(e,this.platform),this.sid=this.options.sdkServiceId,this.init(e)}return e.getInstance=function(){return e.instance},e.prototype.getServiceId=function(){return this.sid||"sid_0"},e.prototype.setIsReportDt=function(e){this.isReportDt=e,e&&this.rptEventQueue()},e.prototype.setIsCollectDt=function(e){this.isCollectDt=e,e||(this.eventQueue=[])},e.prototype.rptEventQueue=function(){var e=this;this.eventQueue.length&&this.eventQueue.forEach((function(t,n){P.send(t.eventId,t.dt),n>=e.eventQueue.length-1&&(e.eventQueue=[])}))},e.prototype.init=function(t){e.instance||(e.instance=this,P.init({biz:b.el,token:b.$x,appId:t.appkey,debug:!1}),this.reportInit())},e.prototype.reportInit=function(){if(this.isCollectDt){var e=this.options,t=e.did,n=e.os,r=e.sdkVersion,o=e.deviceId;this.reportData(b.iB.INIT,{did:t,os:n,sdkVersion:r,deviceId:o})}},e.prototype.geOperateFun=function(e){var t=this;if(!this.isCollectDt)return function(){};var n=1,r=0,o="",i=O(),a=e.uid,s=e.operationName;a&&(this.uid=a);var c={uid:this.uid,operationId:"opr_".concat(l.P6.getUniqueId(),"_").concat(C()),requestid:"req_".concat(l.P6.getUniqueId(),"_").concat(C()),operationName:s};return function(e){var a,u,d,p;if(e.data.isSuccess?(r=0,o=""):(0===e.data.code&&(e.data.code=b.Tp),r=null!==(a=e.data.code)&&void 0!==a?a:r,o=null!==(u=e.data.codeDesc)&&void 0!==u?u:o),(null===(d=e.data)||void 0===d?void 0:d.accessChannel)&&(t.accessChannel=null===(p=e.data)||void 0===p?void 0:p.accessChannel),e.isRetry?(n++,e.data.subrequestid="".concat(n)):(c.requestid="req_".concat(l.P6.getUniqueId(),"_").concat(C()),n=1),e.data.isLastApi){var h=O();e.data.requestElapse=h-i,e.data.requestMethod="",e.data.subrequestid="0",e.data.code=200===r?0:r,e.data.codeDesc=o}else e.data.requestName||(e.data.requestName=s);e.data.requestElapse||(e.data.requestElapse=O()-i),t.reportData.call(t,b.iB.API,D(D(D(D({},M),c),e.data),{accessChannel:t.accessChannel,operationType:S(s)})),e.isEndApi&&t.reportData.call(t,b.iB.API,D(D(D({},c),M),{isSuccess:e.data.isSuccess,isLastApi:1,subrequestid:"0",requestMethod:"",code:200===r?0:r,codeDesc:o,requestElapse:e.data.requestElapse,accessChannel:t.accessChannel,operationType:S(s)}))}},e.prototype.reportData=function(e,t){return n=this,r=void 0,i=function(){var n,r,o,i,a,s,c,u;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(d){switch(d.label){case 0:return d.trys.push([0,3,,4]),n=O(),r=0,e!==b.iB.API?[3,2]:[4,(p=this.platform,new Promise((function(e){var t;p.platform||(p=l.P6.getEnvInfo());var n="";if(p.platform===l.iw.WEB){var r=navigator.connection;(null==r?void 0:r.type)?(null==r||r.type,n=T.td.WIFI):(null==r?void 0:r.effectiveType)&&(n=T.td[r.effectiveType.toLocaleUpperCase()]),e(n)}else p.platform===l.iw.NODE?(n=T.td.UNKNOWN,e(n)):null===(t=p.global)||void 0===t||t.getNetworkType({success:function(t){n=T.td[t.networkType.toLocaleUpperCase()],e(n)}})})))];case 1:r=d.sent(),d.label=2;case 2:return o=this.options,i=o.appkey,a=o.sdkServiceId,s=o.sdkProduct,c=D({lts:n,net:r,appkey:i,sdkServiceId:a,sdkProduct:s},t),this.isReportDt?P.send(e,c):this.isCollectDt&&this.eventQueue.push({eventId:e,dt:c}),[3,4];case 3:return u=d.sent(),console.warn(u),[3,4];case 4:return[2]}var p}))},new((o=void 0)||(o=Promise))((function(e,t){function a(e){try{c(i.next(e))}catch(e){t(e)}}function s(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(a,s)}c((i=i.apply(n,r||[])).next())}));var n,r,o,i},e}(),x=r(7288),U=r(7479),j=r(2856),F=r(9667),B=r(3770),V=r(1735),H=r(7384),G=r(70),W=r(8161);function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}var K=function(){return K=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},K.apply(this,arguments)},Y=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},z=l.P6.getEnvInfo(),X="web"===z.platform,J=function(){},Z={CLOSED:3,CLOSING:2,CONNECTING:0,OPEN:1},Q=function(){function e(t){var n,r;if(this.name="connection",this.max_cache_length=100,this.enableReportLogs=!1,this._reportLogs=!1,this._reportInterval=3e5,this.unSyncQueue=[],this.lastHeartbeat=Date.now(),this.isDebug=t.isDebug||!1,this.isReport=!1,this.enableReportLogs=t.enableReportLogs||!1,this.uploadPartEnable=!0,this.isHttpDNS=void 0===t.isHttpDNS?X:t.isHttpDNS,this.heartBeatWait=t.heartBeatWait||3e4,this.autoReconnectNumMax=t.autoReconnectNumMax||5,this.refreshDNSIntervals=this.autoReconnectNumMax<5?this.autoReconnectNumMax:5,this.delivery=t.delivery||!1,this.disconnectedReason=void 0,this.loginInfoCustomExt=void 0,this.dnsArr=["https://rs.easemob.com","https://rs.chat.agora.io","http://59.110.89.59","http://39.97.193.190","http://39.97.193.187"],this.dnsIndex=0,this.dnsTotal=this.dnsArr.length,this.restHosts=[],this.restTotal=0,this.restIndex=0,this.hostIndex=0,this.socketHost=[],this.hostTotal=0,this.times=1,this.autoReconnectNumTotal=0,this.domain="easemob.com",this.appKey=t.appKey,this.appName="",this.orgName="",this.token="",this.grantType="",this.apiUrl=t.apiUrl||"",this.url=t.url||"",this.https=t.https||"undefined"!=typeof window&&"https:"===(null===(n=window.location)||void 0===n?void 0:n.protocol),this.version="1.3.1",this.deviceId=t.deviceId||"webim",this.isFixedDeviceId=null===(r=t.isFixedDeviceId)||void 0===r||r,this.osType=16,this.useOwnUploadFun=t.useOwnUploadFun||!1,this.compressType=[0],this.encryptType=[0],this.clientResource="",this.expiresIn=0,this.expirationTime=0,this.useReplacedMessageContents=t.useReplacedMessageContents||!1,this.logOut=!0,this.context={jid:{appKey:"",clientResource:"",domain:"easemob.com",name:""},userId:"",appKey:"",status:0,restTokenData:"",appName:"",orgName:"",root:{},accessToken:""},this._msgHash={},this._msgPromiseHash={},this._queues=[],this._load_msg_cache=[],this.unMSyncSendMsgMap=new Map,this.mr_cache={},this.reconnecting=!1,this._offlineMessagePullState=u.a.SYNC_INIT,this._offlineMessagePullQueue=[],this.uniPushConfig={},this.uniPush=null,this.isRegisterPush=!1,this.pushCertificateName="","string"!=typeof this.appKey||2!==this.appKey.split("#").length)throw Error("Illegal appKey: ".concat(this.appKey));this.devInfos=this.appKey.split("#"),this.orgName=this.devInfos[0],this.appName=this.devInfos[1],this.listen=g.bind(this),this.mSync=this.usePlugin(p.ZP),this.eventHandler=this.usePlugin(m),Object.assign(e.prototype,U),Object.assign(e.prototype,j),Object.assign(e.prototype,F),Object.assign(e.prototype,B),Object.assign(e.prototype,V),Object.assign(e.prototype,H),Object.assign(e.prototype,G),this.dataReport=new L({appkey:this.appKey,org:this.orgName,sdkVersion:this.version,deviceId:this.deviceId,isReport:this.isReport});var o=0,i=this;if(Object.defineProperty(l.P6,"ajaxUnconventionalErrorTimes",{set:function(e){0!==e&&(h.kg.debug("rest api request fail times: ".concat(e)),(o=e)%5==0&&i.isHttpDNS&&(h.kg.debug("refresh dns config when rest request fail."),ae.call(i,"refresh",{},{})))},get:function(){return o}}),this.isFixedDeviceId){var a=l.P6.getLocalDeviceInfo();a&&(this.clientResource=JSON.parse(a).deviceId)}h.kg.debug("init SDK: Conn ".concat(this.version," ").concat(z.platform))}return e.prototype.usePlugin=function(e,t){if("push"!==t)return t?void(this[t]=new e(this)):new e(this);e.config&&e.emPush?(this.uniPushConfig=e.config,this.uniPush=e.emPush):h.kg.error("use push plugin failed","emPush",this.uniPush,"config",this.uniPushConfig)},e.prototype.listen=function(e){},e.prototype.addEventHandler=function(e,t){},e.prototype.removeEventHandler=function(e){},e.prototype.registerUser=function(e){var t=this;return new Promise((function(n,r){var o=t.dataReport.geOperateFun({uid:e.username,operationName:T.fI.REGISTER});if(t.isHttpDNS){t.dnsIndex=0;var i=K(K({},e),{user:e.username,pwd:e.password,promise:{resolve:n,reject:r}});ae.call(t,"signup",i,{rpt:o})}else i=K(K({},e),{promise:{resolve:n,reject:r}}),$.call(t,i,{rpt:o})}))},e.prototype.open=function(e){var t=this;if(h.kg.debug("open",e.user),h.kg.debug("isLogout",this.logOut),"web"===z.platform){var n=l.P6.detectBrowser();h.kg.debug("browser",n)}return new Promise((function(n,r){var o,i=oe.call(t,e);if(i)return null===(o=t.onError)||void 0===o||o.call(t,i),r(i);e.accessToken&&(t.token=e.accessToken);var a=K(K({},e),{promise:{resolve:n,reject:r}}),s=t.dataReport.geOperateFun({uid:e.user,operationName:T.fI.LOGIN});if(t.isHttpDNS)t.dnsIndex=0,ae.call(t,"login",a,{rpt:s});else{if("web"!==z.platform&&t.enableReportLogs)return t.dnsIndex=0,void t.getDNS().then((function(){ee.call(t,a,{rpt:s})})).catch((function(e){var t;a.promise.reject(e),null===(t=a.error)||void 0===t||t.call(a,e)}));ee.call(t,a,{rpt:s})}}))},e.prototype.getDNS=function(){var e=this,t=this.dnsIndex<this.dnsTotal?this.dnsIndex:0,n=this.dnsArr[t]+"/easemob/server.json";return new Promise((function(t,r){var o=e;!function e(){var i={url:n,dataType:"json",type:"GET",data:{app_key:o.appKey},success:function(e){var n=e.enableReportLogs,r=e.reportInterval;o._reportLogs="true"===n,o._reportInterval=Number(r||3e5),t(e)}||J,error:function(t){if(h.kg.debug("getHttpDNS fail: "+o.dnsIndex),o.dnsIndex++,o.dnsIndex<o.dnsTotal)e();else{var n=c.Z.create({type:d.E.SERVER_GET_DNSLIST_FAILED,message:"get DNS failed",data:t});r(n)}}||J};l.P6.ajax(i).catch((function(e){console.warn(e)}))}()}))},e.prototype.isOpened=function(){return this.sock&&this.sock.readyState===Z.OPEN||!1},e.prototype.close=function(){var e,t,n;h.kg.debug("call close"),h.kg._stopReportLogs(),this.logOut=!0,this.disconnectedReason=void 0,this.reconnecting=!1,this.context.status=d.E.STATUS_CLOSING,this.sock&&this.sock.close(),null===(e=this.unMSyncSendMsgMap)||void 0===e||e.clear(),this.stopHeartBeat(),this.rejectMessage(),this.context.status=d.E.STATUS_CLOSED,this._load_msg_cache=[],this._queues=[],this.unSyncQueue=[],this._msgHash={},this.mr_cache={},this.token="",this.context.accessToken="",this.isRegisterPush=!1,this.clearTokenTimeout(),null===(n=null===(t=null==this?void 0:this._localCache)||void 0===t?void 0:t.getInstance())||void 0===n||n.close()},e.prototype.downloadAndParseCombineMessage=function(e){var t=this,n=e.url,r=e.secret;return new Promise((function(e,o){var i,a,s=l.P6.getEnvInfo(),c="web"!==s.platform&&"node"!==s.platform&&"quick_app"!==s.platform&&(null===(a=null===(i=s.global)||void 0===i?void 0:i.canIUse)||void 0===a?void 0:a.call(i,"getFileSystemManager")),u=function(n){var r=function(e){o({type:d.E.PARSE_FILE_ERROR,message:"Read file failed",data:e})},i=function(n){return r=t,i=void 0,s=function(){var t,r,i,a,s,u,p,f,m,v,g,E,y;return Y(this,(function(_){switch(_.label){case 0:for(t=c?new Uint8Array(n.data):new Uint8Array(n.target.result),r=0,i=0,a=2,s=t.subarray(r,r+a),u=l.P6.Uint8ArrayToString(s),h.kg.debug("file header:",u),i+=a,p=0,f=2;f<t.length-1;f++)f%2==1&&(p^=t[f]);if(m=t.subarray(t.length-1,t.length),h.kg.debug("checkResult:",p,m[0]===p),m[0]!==p)return[2,o({type:d.E.PARSE_FILE_ERROR,message:"File verification failed"})];if("cm"!==u)return[3,7];_.label=1;case 1:_.trys.push([1,5,,6]),v=[],g=function(){var e,n,o,s;return Y(this,(function(c){switch(c.label){case 0:return r+=a,i+=a=4,e=t.subarray(r,r+a),r+=a,a=e.reduce((function(t,n,r){return t+(n<<8*(e.length-r-1))}),0),i+=a,n=t.subarray(r,r+a),o=(o=E.root.lookup("easemob.pb.Meta")).decode(n),[4,W.Z.call(E,o,0,!0,!0)];case 1:return s=c.sent(),v.push(s),[2]}}))},E=this,_.label=2;case 2:return i<t.length-1?[5,g()]:[3,4];case 3:return _.sent(),[3,2];case 4:return[2,e(v)];case 5:return y=_.sent(),o({type:d.E.PARSE_FILE_ERROR,message:"Parse file failed",data:y}),[3,6];case 6:return[3,8];case 7:return[2,o({type:d.E.PARSE_FILE_ERROR,message:"File verification failed"})];case 8:return[2]}}))},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{c(s.next(e))}catch(e){t(e)}}function o(e){try{c(s.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof a?r:new a((function(e){e(r)}))).then(n,o)}c((s=s.apply(r,i||[])).next())}));var r,i,a,s};if(c){var a=s.global.getFileSystemManager(),u=n.tempFilePath;a.readFile({filePath:u,success:i,fail:r})}else if(n instanceof Blob){var p=new FileReader;p.readAsArrayBuffer(n),p.onerror=r,p.onload=i}},p=function(e){o({type:d.E.WEBIM_DOWNLOADFILE_ERROR,message:"Download failed, please try again",data:e})};c?s.global.downloadFile({url:n,success:u,fail:p}):l.P6.download.call(t,{url:n,headers:{Accept:"application/json"},onFileDownloadComplete:u,onFileDownloadError:p,secret:r,accessToken:t.context.accessToken})}))},e.prototype.stopHeartBeat=function(){clearInterval(this.heartBeatID)},e.prototype.clear=function(){this.restTotal=0,this.restIndex=0,this.hostIndex=0,this.hostTotal=0},e.prototype.heartBeat=function(){},e.prototype.renewToken=function(e){var t=this;return this.isOpened()?this.getTokenExpireTimestamp(e).then((function(n){var r=n.expire_timestamp,o=Date.now();return t.expirationTime=r,t.expiresIn=r-o,t.token=e,t.context.accessToken=e,t.clearTokenTimeout(),t.tokenExpireTimeCountDown(t.expiresIn),{status:!0,token:e,expire:r}})):Promise.reject({status:!1})},e.prototype.clearTokenTimeout=function(){h.kg.info("clearTokenTimeout"),this.tokenWillExpireTimer&&clearTimeout(this.tokenWillExpireTimer),this.tokenExpiredTimer&&clearTimeout(this.tokenExpiredTimer),this.tokenWillExpireTimer=null,this.tokenExpiredTimer=null},e.prototype.tokenExpireTimeCountDown=function(e){var t=this;h.kg.info("tokenExpireTimeCountDown",e),e>Math.pow(2,31)-1&&(e=Math.pow(2,31)-1),this.tokenWillExpireTimer=setTimeout((function(){var n;t.onTokenWillExpire&&t.onTokenWillExpire(),null===(n=t.eventHandler)||void 0===n||n.dispatch("onTokenWillExpire"),h.kg.info("onTokenWillExpire",Math.floor(e/2))}),e/2),this.tokenExpiredTimer=setTimeout((function(){var e;h.kg.info("onTokenExpired",0),t.onTokenExpired&&t.onTokenExpired(),null===(e=t.eventHandler)||void 0===e||e.dispatch("onTokenExpired"),t.close()}),e)},e.prototype.compareTokenExpireTime=function(e,t){var n,r=Number(t)-Number(e);h.kg.debug("compareTokenExpireTime",r),r<=this.expiresIn/2&&r>0?(this.onTokenWillExpire&&this.onTokenWillExpire(),null===(n=this.eventHandler)||void 0===n||n.dispatch("onTokenWillExpire"),h.kg.info("onTokenWillExpire",r)):r<=0&&(this.closeByTokenExpired(),h.kg.info("closeByTokenExpired",r))},e.prototype.closeByTokenExpired=function(){var e;h.kg.info("closed By TokenExpired"),this.onTokenExpired&&this.onTokenExpired(),null===(e=this.eventHandler)||void 0===e||e.dispatch("onTokenExpired"),this.close()},e.prototype.rejectMessage=function(){var e=this,t=Object.keys(this._msgHash);if(t.length>0){var n=c.Z.create({type:d.E.MESSAGE_WEBSOCKET_DISCONNECTED,message:"websocket disconnected"});t.forEach((function(t){var r,o,i;(null===(r=e.unMSyncSendMsgMap)||void 0===r?void 0:r.has(t))||(e._msgHash[t].reject instanceof Function&&e._msgHash[t].reject(n),null===(i=null===(o=e._localCache)||void 0===o?void 0:o.getInstance())||void 0===i||i.updateLocalMessage(t,{serverMsgId:t,status:x.r.FAIL}),e._msgHash[t].fail instanceof Function&&e._msgHash[t].fail(n),delete e._msgHash[t])}))}},e.prototype.resetConnState=function(){this.mSync.stopHeartBeat(),this.times=1,this.autoReconnectNumTotal=0,this.hostIndex=0},e.prototype.reconnect=function(){var e,t=this;h.kg.debug("socket reconnect readyState",this.sock.readyState),this.sock.readyState!==Z.CONNECTING&&this.sock.readyState!==Z.OPEN&&(h.kg.info("reconnect: time",this.times),h.kg.info("reconnect sock.readyState: ",this.sock.readyState),!1===this.reconnecting&&(this.reconnecting=!0),null===(e=this.eventHandler)||void 0===e||e.dispatch("onReconnecting"),this.rejectMessage(),this.isHttpDNS&&(this.hostIndex<this.socketHost.length-1?this.hostIndex++:this.hostIndex=this.socketHost.length-1),setTimeout((function(){t.sock.readyState!==Z.OPEN&&(h.kg.info("login sock.readyState: ",t.sock.readyState),t.sock.close(),re.call(t,{access_token:t.context.accessToken}),t.times++)}),500*this.times),this.autoReconnectNumTotal++)},e.prototype.send=function(e){return Promise.resolve(null)},e.prototype.setLoginInfoCustomExt=function(e){if(h.kg.debug("setLoginInfoCustomExt","params:",e),e){if("string"!=typeof e)throw new Error("ext must be a string");if(e.length>1024)throw new Error("ext length must be less than 1024")}this.loginInfoCustomExt=e},e._getSock=function(){},e}();function $(e,t){var n=this,r=t.rpt,o=t.isRetry,i=e.promise,a=this.apiUrl+"/"+this.orgName+"/"+this.appName+"/users",s={requestName:T.c.RESISTER,requestUrl:a},u=e.error||J;if(!this.orgName&&!this.appName){var p=c.Z.create({type:d.E.WEBIM_CONNCTION_APPKEY_NOT_ASSIGN_ERROR,message:"signup error"});u(p)}var h={headers:{"Content-type":"application/json"},url:a,dataType:"json",data:JSON.stringify({username:e.username,password:e.password,nickname:e.nickname||""}),success:function(t){e.success&&e.success(t);var n=K(K({},t),{type:d.E.REQUEST_SUCCESS});i.resolve&&i.resolve(n);var a=t.extraInfo,c=a.httpCode,l=a.elapse;r({isEndApi:!0,isRetry:o,data:K(K({},{requestElapse:l,isSuccess:1,code:c}),s)})},error:function(t){var a=t.extraInfo,c=a.elapse,l=a.httpCode,d=a.errDesc;return r({isRetry:o,data:K(K({},{requestElapse:c,isSuccess:0,code:l,codeDesc:d}),s)}),n.isHttpDNS&&n.restIndex+1<n.restTotal?(n.restIndex++,se.call(n),$.call(n,e,{rpt:r,isRetry:o}),Promise.reject(t)):(r({data:{isLastApi:1,isSuccess:0}}),n.clear(),i.reject&&i.reject(t),u(t))}};return l.P6.ajax(h).catch((function(e){i.reject&&i.reject(e)}))}function ee(e,t){var n,r=this;if(!oe.call(this,e))if(h.kg.debug("socket readyState",null===(n=this.sock)||void 0===n?void 0:n.readyState),this.isOpened())h.kg.debug("socket is already opened");else{var o=t.rpt,i=t.isRetry;ie.call(this,e),this.user=e.user;var a=e.promise,s=this.context.appName,u=this.context.orgName,p=this.apiUrl+"/"+u+"/"+s+"/token";if(e.accessToken)h.kg.debug("login with accessToken"),this.grantType="accessToken",this.token=e.accessToken,this.context.accessToken=e.accessToken,this.context.restTokenData=e.accessToken,a.resolve({accessToken:e.accessToken}),re.call(this,e,o),h.kg.initReport({report:this._reportLogs,reportInterval:this._reportInterval,connection:this});else if(e.agoraToken)h.kg.debug("login with agoraToken"),this.grantType="agoraToken",this.token=e.agoraToken,this.context.accessToken=e.agoraToken,this.context.restTokenData=e.agoraToken,a.resolve({accessToken:e.agoraToken}),re.call(this,e,o),h.kg.initReport({report:this._reportLogs,reportInterval:this._reportInterval,connection:this});else{h.kg.debug("login with password"),this.grantType="password";var f={grant_type:"password",username:e.user,password:e.pwd,timestamp:+new Date},m=JSON.stringify(f),v={headers:{"Content-type":"application/json"},url:p,dataType:"json",data:m,success:function(t){h.kg.debug("get token success"),"function"==typeof e.success&&e.success(t),r.token=t.access_token,r.context.restTokenData=t.access_token,r.context.accessToken=t.access_token,r.expiresIn=t.expires_in,a.resolve({accessToken:t.access_token,duration:t.expires_in});var n=t.extraInfo,s=n.httpCode,c=n.elapse,l={requestName:T.c.LOGIN_BY_PWD,requestElapse:c,requestUrl:p,isSuccess:1,code:s};o({isRetry:i,data:l}),re.call(r,t,o),h.kg.initReport({report:r._reportLogs,reportInterval:r._reportInterval,connection:r})}||J,error:function(t){var n,s=t.extraInfo,l=s.elapse,u=s.httpCode,h=s.errDesc,f={requestName:T.c.LOGIN_BY_PWD,requestElapse:l,requestUrl:p,isSuccess:0,code:u,codeDesc:h};if(o({isRetry:i,data:f}),r.isHttpDNS&&r.restIndex+1<r.restTotal)return r.restIndex++,se.call(r),void ee.call(r,e,{rpt:o,isRetry:!0});o({data:{isLastApi:1,isSuccess:0}}),r.clear(),t.error&&t.error_description?(n=c.Z.create({type:d.E.WEBIM_CONNCTION_OPEN_USERGRID_ERROR,message:t.error_description,data:t}),r.onError&&r.onError(n)):(n=c.Z.create({type:d.E.WEBIM_CONNCTION_OPEN_ERROR,message:t.error_description,data:t}),r.onError&&r.onError(n)),"function"==typeof e.error&&e.error(n),a.reject(n)}||J,version:this.version};h.kg.debug("start get token"),l.P6.ajax(v).catch((function(e){console.warn(e)}))}h.kg.debug("grantType",this.grantType),l.P6.listenNetwork(te.bind(this),ne.bind(this)),l.P6.listenBrowserVisibility((function(){h.kg.debug("visibility true")}),(function(){h.kg.debug("visibility false")}))}}function te(){var e;h.kg.debug("online"),this.onOnline&&this.onOnline(),null===(e=this.eventHandler)||void 0===e||e.dispatch("onOnline"),this.sock&&1!==this.sock.readyState&&(h.kg.debug("sock.readyState:",this.sock.readyState),this.logOut||this.reconnecting||this.reconnect())}function ne(){var e,t;h.kg.debug("offline"),null===(e=this.sock)||void 0===e||e.close(),this.onOffline&&this.onOffline(),null===(t=this.eventHandler)||void 0===t||t.dispatch("onOffline")}function re(e,t){var n=this,r=this._getSock();this.sock=r,h.kg.debug("start connect ws");var o=function(){var e;h.kg.debug("websocket onOpen"),t&&t({data:{isLastApi:1,isSuccess:1,accessChannel:null===(e=n.socketHost[n.hostIndex])||void 0===e?void 0:e.channel}});var o=l.P6.flow([n.mSync.generateProvision,n.mSync.base64transform])();try{r.send(o)}catch(e){var i=c.Z.create({type:d.E.SDK_RUNTIME_ERROR,message:"send message error",data:e});n.onError&&n.onError(i)}},i=function(e){setTimeout((function(){var t,r,o,i,a,s,l;if(h.kg.debug("websocket onClose",e),"zfb"!==z.platform&&"dd"!==z.platform||(n.sock.readyState=Z.CLOSED),n.logOut)n.clear(),n.resetConnState(),null===(r=null===(t=null==n?void 0:n._localCache)||void 0===t?void 0:t.getInstance())||void 0===r||r.close(),n.onClosed&&n.onClosed(),null===(o=n.eventHandler)||void 0===o||o.dispatch("onDisconnected",n.disconnectedReason);else if(n.autoReconnectNumTotal<n.autoReconnectNumMax){n.reconnect();var u={type:d.E.WEBIM_CONNCTION_DISCONNECTED,message:"websocket has been disconnected"};n.onError&&n.onError(u),n.autoReconnectNumTotal%n.refreshDNSIntervals==0&&"web"===z.platform&&n.isHttpDNS&&(h.kg.debug("refresh dns config when websocket close"),ae.call(n,"refresh",{},{}))}else null===(i=n.unMSyncSendMsgMap)||void 0===i||i.clear(),n.rejectMessage(),u={type:d.E.WEBIM_CONNCTION_DISCONNECTED,message:"websocket has been disconnected"},n.disconnectedReason=c.Z.create({type:d.E.WEBIM_CONNCTION_DISCONNECTED,message:"reconnection failed"}),n.onError&&n.onError(u),null===(s=null===(a=null==n?void 0:n._localCache)||void 0===a?void 0:a.getInstance())||void 0===s||s.close(),n.onClosed&&n.onClosed(),null===(l=n.eventHandler)||void 0===l||l.dispatch("onDisconnected",n.disconnectedReason),n.resetConnState(),n.reconnecting=!1,h.kg.debug("reconnect fail")}),0)},a=function(e){var t=n.mSync,r=t.decodeMSync,o=t.distributeMSync;l.P6.flow([r,o])(e)};"web"===z.platform?(r.onopen=o,r.onclose=i,r.onmessage=a):(r.onOpen(o),r.onMessage(a),r.onClose(i),"undefined"!=typeof window&&window.WebSocket||r.onError((function(e){var r,o,i,a,s;if(h.kg.debug("mini program sock on error",e),n.sock.readyState!==Z.CLOSED&&(n.sock=K(K({},n.sock),{close:n.sock.close,send:n.sock.send,readyState:Z.CLOSED})),n.onError&&n.onError({type:d.E.WEBIM_CONNECTION_ERROR,message:"on socket error",data:e}),!n.logOut)if(n.autoReconnectNumTotal<n.autoReconnectNumMax)h.kg.debug("sock.onError reconnect",n.autoReconnectNumTotal,n.autoReconnectNumMax),n.reconnect(),n.autoReconnectNumTotal%n.refreshDNSIntervals==0&&"web"===z.platform&&n.isHttpDNS&&(h.kg.debug("refresh dns config when websocket error"),ae.call(n,"refresh",{},{}));else{var l={type:d.E.WEBIM_CONNCTION_DISCONNECTED,message:"websocket has been disconnected"};n.disconnectedReason=c.Z.create({type:d.E.WEBIM_CONNCTION_DISCONNECTED,message:"reconnection failed"}),null===(r=n.unMSyncSendMsgMap)||void 0===r||r.clear(),n.rejectMessage(),n.onError&&n.onError(l),null===(i=null===(o=null==n?void 0:n._localCache)||void 0===o?void 0:o.getInstance())||void 0===i||i.close(),n.onClosed&&n.onClosed(),null===(a=n.eventHandler)||void 0===a||a.dispatch("onDisconnected",n.disconnectedReason),n.resetConnState(),n.reconnecting=!1,h.kg.debug("reconnect fail")}t&&t({data:{isLastApi:1,isSuccess:0,accessChannel:null===(s=n.socketHost[n.hostIndex])||void 0===s?void 0:s.channel}})})))}function oe(e){if("object"!==q(e)||null===e)return c.Z.create({type:d.E.WEBIM_CONNCTION_OPEN_ERROR,message:"the param is illegal"});if(!e.user||"string"!=typeof e.user){var t=c.Z.create({type:d.E.WEBIM_CONNCTION_USER_NOT_ASSIGN_ERROR,message:"the user is empty or type is not string"});return h.kg.debug("open params error",t),t}return!("agoraToken"in e)||e.agoraToken&&"string"==typeof e.agoraToken?!("accessToken"in e)||e.accessToken&&"string"==typeof e.accessToken?"accessToken"in e||"agoraToken"in e||e.pwd?void 0:(t=c.Z.create({type:d.E.WEBIM_CONNCTION_OPEN_ERROR,message:"the accessToken or pwd is illegal"}),h.kg.debug("open params error",t),t):(t=c.Z.create({type:d.E.WEBIM_CONNCTION_OPEN_ERROR,message:"the accessToken is illegal"}),h.kg.debug("open params error",t),t):(t=c.Z.create({type:d.E.WEBIM_CONNCTION_OPEN_ERROR,message:"the agoraToken is illegal"}),h.kg.debug("open params error",t),console.warn("agoraToken is deprecated, please use accessToken instead"),t)}function ie(e){this.context.jid={appKey:this.appKey,name:e.user,domain:this.domain,clientResource:this.clientResource},this.context.root=this.root,this.context.userId=e.user,this.context.appKey=this.appKey,this.context.appName=this.appName,this.context.orgName=this.orgName}function ae(e,t,n){var r=this,o=n.rpt,i=n.isRetry,a=this.dnsIndex<this.dnsTotal?this.dnsIndex:0,s=this.dnsArr[a]+"/easemob/server.json";h.kg.debug("call getHttpDNS: "+this.dnsIndex);var u={url:s,dataType:"json",type:"GET",data:{app_key:encodeURIComponent(this.appKey)},success:function(n){h.kg.debug("getHttpDNS success");var a=n.extraInfo,l=a.elapse,u=a.httpCode,p={requestUrl:s,requestName:T.c.GET_DNS,requestElapse:l,isSuccess:1,code:u};r._reportLogs="true"===n.enableReportLogs,r._reportInterval=Number(n.reportInterval||3e5),"true"===(null==n?void 0:n.enableDataReport)?(r.dataReport.setIsCollectDt(!0),r.dataReport.setIsReportDt(!0)):(r.dataReport.setIsReportDt(!1),r.dataReport.setIsCollectDt(!1)),"false"===(null==n?void 0:n.uploadinparts_enable)&&(r.uploadPartEnable=!1),o&&o({isRetry:i,data:p});var f=n.rest.hosts,m=r.https?"https":"http";if(h.kg.info("httpType: "+m),!f){var v=c.Z.create({type:d.E.SERVER_GET_DNSLIST_FAILED,message:"DNS hosts resolution failed",data:n.rest});t.error&&t.error(v),t.promise.reject&&t.promise.reject(v)}for(var g=f.filter((function(e){if(e.protocol===m)return e})),E=0;E<g.length;E++)if(g[E].protocol===m){var y=g[E];g.splice(E,1),g.unshift(y)}r.restHosts=g,r.restTotal=g.length;var _=n["msync-ws"].hosts;if(!_){var b=c.Z.create({type:d.E.SERVER_GET_DNSLIST_FAILED,message:"DNS msync-ws resolution failed",data:n["msync-ws"]});t.error&&t.error(b),t.promise.reject&&t.promise.reject(b)}var S=_.filter((function(e){return e.protocol===m&&e}));r.socketHost=S,r.hostTotal=S.length,se.call(r),"refresh"!==e&&("login"===e?ee.call(r,t,{rpt:o}):$.call(r,t,{rpt:o}))}||J,error:function(n){var a=n.extraInfo,l=a.elapse,u=a.httpCode,p=a.errDesc,f={requestUrl:s,requestName:T.c.GET_DNS,isSuccess:0,code:u,codeDesc:p,requestElapse:l};if(o&&o({isRetry:i,data:f}),h.kg.debug("getHttpDNS fail: "+r.dnsIndex),r.dnsIndex++,r.dnsIndex<r.dnsTotal)ae.call(r,e,t,{rpt:o,isRetry:!0});else if("login"===e||"signup"===e){var m=c.Z.create({type:d.E.SERVER_GET_DNSLIST_FAILED,message:"get DNS failed",data:n});t.error&&t.error(m),t.promise.reject&&t.promise.reject(m)}}||J};return l.P6.ajax(u).catch((function(e){console.warn(e)}))}function se(){var e,t;if(this.restIndex>this.restTotal)return h.kg.debug("restIndex > restTotal"),"";var n="",r=this.restHosts[this.restIndex],o=r.domain,i=r.ip,a=r.port,s=this.https?"https:":"http:";return i&&"undefined"!=typeof window&&"http:"===(null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.protocol)?n=s+"//"+i+":"+a:(n=s+"//"+o,a&&"80"!==a&&"443"!==a&&(n+=":".concat(a)),"undefined"==typeof window||window.location||(n="https://"+o),"undefined"!=typeof window&&window.location&&"file:"===(null===(t=window.location)||void 0===t?void 0:t.protocol)&&(n="https://"+o)),"undefined"==typeof window&&(n=s+"//"+o),this.apiUrl=n,n}var ce=r(2449);i().util.Long=s(),i().configure();var le=i().Root.fromJSON({nested:{easemob:{nested:{pb:{nested:{MessageBody:{fields:{type:{type:"Type",id:1},from:{type:"JID",id:2},to:{type:"JID",id:3},contents:{rule:"repeated",type:"Content",id:4},ext:{rule:"repeated",type:"KeyValue",id:5},ackMessageId:{type:"uint64",id:6},msgConfig:{type:"MessageConfig",id:7},ackContent:{type:"string",id:8},meta:{type:"string",id:9},editMessageId:{type:"uint64",id:11}},nested:{Content:{fields:{type:{type:"Type",id:1},text:{type:"string",id:2},latitude:{type:"double",id:3},longitude:{type:"double",id:4},address:{type:"string",id:5},displayName:{type:"string",id:6},remotePath:{type:"string",id:7},secretKey:{type:"string",id:8},fileLength:{type:"int32",id:9},action:{type:"string",id:10},params:{rule:"repeated",type:"KeyValue",id:11},duration:{type:"int32",id:12},size:{type:"Size",id:13},thumbnailRemotePath:{type:"string",id:14},thumbnailSecretKey:{type:"string",id:15},thumbnailDisplayName:{type:"string",id:16},thumbnailFileLength:{type:"int32",id:17},thumbnailSize:{type:"Size",id:18},customEvent:{type:"string",id:19},customExts:{rule:"repeated",type:"KeyValue",id:20},buildingName:{type:"string",id:21},subType:{type:"SubType",id:22},title:{type:"string",id:23},summary:{type:"string",id:24},combineLevel:{type:"int32",id:25}},nested:{Type:{values:{TEXT:0,IMAGE:1,VIDEO:2,LOCATION:3,VOICE:4,FILE:5,COMMAND:6,CUSTOM:7,COMBINE:8}},Size:{fields:{width:{type:"double",id:1},height:{type:"double",id:2}}},SubType:{values:{COMBINE:0}}}},Type:{values:{NORMAL:0,CHAT:1,GROUPCHAT:2,CHATROOM:3,READ_ACK:4,DELIVER_ACK:5,RECALL:6,CHANNEL_ACK:7,EDIT:8}},MessageConfig:{fields:{allowGroupAck:{type:"bool",id:1}}}}},KeyValue:{oneofs:{value:{oneof:["varintValue","floatValue","doubleValue","stringValue"]}},fields:{key:{type:"string",id:1},type:{type:"ValueType",id:2},varintValue:{type:"int64",id:3},floatValue:{type:"float",id:4},doubleValue:{type:"double",id:5},stringValue:{type:"string",id:6}},nested:{ValueType:{values:{BOOL:1,INT:2,UINT:3,LLINT:4,FLOAT:5,DOUBLE:6,STRING:7,JSON_STRING:8}}}},JID:{fields:{appKey:{type:"string",id:1},name:{type:"string",id:2},domain:{type:"string",id:3},clientResource:{type:"string",id:4}}},ConferenceBody:{fields:{sessionId:{type:"string",id:1},operation:{type:"Operation",id:2},conferenceId:{type:"string",id:3},type:{type:"Type",id:4},content:{type:"string",id:5},network:{type:"string",id:6},version:{type:"string",id:7},identity:{type:"Identity",id:8},duration:{type:"string",id:9},peerName:{type:"string",id:10},endReason:{type:"EndReason",id:11},status:{type:"Status",id:12},isDirect:{type:"bool",id:13},controlType:{type:"StreamControlType",id:14},routeFlag:{type:"int32",id:15},routeKey:{type:"string",id:16}},nested:{Status:{fields:{errorCode:{type:"int32",id:1}}},Operation:{values:{JOIN:0,INITIATE:1,ACCEPT_INITIATE:2,ANSWER:3,TERMINATE:4,REMOVE:5,STREAM_CONTROL:6,MEDIA_REQUEST:7}},Type:{values:{VOICE:0,VIDEO:1}},Identity:{values:{CALLER:0,CALLEE:1}},EndReason:{values:{HANGUP:0,NORESPONSE:1,REJECT:2,BUSY:3,FAIL:4,UNSUPPORTED:5,OFFLINE:6}},StreamControlType:{values:{PAUSE_VOICE:0,RESUME_VOICE:1,PAUSE_VIDEO:2,RESUME_VIDEO:3}}}},MSync:{fields:{version:{type:"Version",id:1,options:{default:"MSYNC_V1"}},guid:{type:"JID",id:2},auth:{type:"string",id:3},compressAlgorimth:{type:"uint32",id:4},crypto:{type:"uint32",id:5},userAgent:{type:"string",id:6},pov:{type:"uint64",id:7},command:{type:"Command",id:8},deviceId:{type:"uint32",id:10},encryptType:{rule:"repeated",type:"EncryptType",id:11,options:{packed:!1}},encryptKey:{type:"string",id:12},payload:{type:"bytes",id:9}},nested:{Version:{values:{MSYNC_V1:0,MSYNC_V2:1}},Command:{values:{SYNC:0,UNREAD:1,NOTICE:2,PROVISION:3}}}},EncryptType:{values:{ENCRYPT_NONE:0,ENCRYPT_AES_128_CBC:1,ENCRYPT_AES_256_CBC:2}},CommSyncUL:{fields:{meta:{type:"Meta",id:1},key:{type:"uint64",id:2},queue:{type:"JID",id:3},isRoam:{type:"bool",id:4},lastFullRoamKey:{type:"uint64",id:5}}},CommSyncDL:{fields:{status:{type:"Status",id:1},metaId:{type:"uint64",id:2},serverId:{type:"uint64",id:3},metas:{rule:"repeated",type:"Meta",id:4},nextKey:{type:"uint64",id:5},queue:{type:"JID",id:6},isLast:{type:"bool",id:7},timestamp:{type:"uint64",id:8},isRoam:{type:"bool",id:9}}},CommNotice:{fields:{queue:{type:"JID",id:1}}},CommUnreadUL:{fields:{}},CommUnreadDL:{fields:{status:{type:"Status",id:1},unread:{rule:"repeated",type:"MetaQueue",id:2},timestamp:{type:"uint64",id:3}}},MetaQueue:{fields:{queue:{type:"JID",id:1},n:{type:"uint32",id:2}}},Meta:{fields:{id:{type:"uint64",id:1},from:{type:"JID",id:2},to:{type:"JID",id:3},timestamp:{type:"uint64",id:4},ns:{type:"NameSpace",id:5},payload:{type:"bytes",id:6},routetype:{type:"RouteType",id:7},ext:{rule:"repeated",type:"KeyValue",id:8},meta:{type:"bytes",id:9},directedUsers:{rule:"repeated",type:"string",id:10}},nested:{NameSpace:{values:{STATISTIC:0,CHAT:1,MUC:2,ROSTER:3,CONFERENCE:4,NOTIFY:5,QUERY:6}},RouteType:{values:{ROUTE_ALL:0,ROUTE_ONLINE:1,ROUTE_DIRECT:2}}}},Status:{fields:{errorCode:{type:"ErrorCode",id:1},reason:{type:"string",id:2},redirectInfo:{rule:"repeated",type:"RedirectInfo",id:3}},nested:{ErrorCode:{values:{OK:0,FAIL:1,UNAUTHORIZED:2,MISSING_PARAMETER:3,WRONG_PARAMETER:4,REDIRECT:5,TOKEN_EXPIRED:6,PERMISSION_DENIED:7,NO_ROUTE:8,UNKNOWN_COMMAND:9,PB_PARSER_ERROR:10,BIND_ANOTHER_DEVICE:11,IM_FORBIDDEN:12,TOO_MANY_DEVICES:13,PLATFORM_LIMIT:14,USER_MUTED:15,ENCRYPT_DISABLE:16,ENCRYPT_ENABLE:17,DECRYPT_FAILURE:18,PERMISSION_DENIED_EXTERNAL:19}}}},RedirectInfo:{fields:{host:{type:"string",id:1},port:{type:"uint32",id:2}}},Provision:{fields:{osType:{type:"OsType",id:1},version:{type:"string",id:2},networkType:{type:"NetworkType",id:3},appSign:{type:"string",id:4},compressType:{rule:"repeated",type:"CompressType",id:5,options:{packed:!1}},encryptType:{rule:"repeated",type:"EncryptType",id:6,options:{packed:!1}},encryptKey:{type:"string",id:7},status:{type:"Status",id:8},deviceUuid:{type:"string",id:9},isManualLogin:{type:"bool",id:10},password:{type:"string",id:11},deviceName:{type:"string",id:12},resource:{type:"string",id:13},auth:{type:"string",id:14},serviceId:{type:"string",id:16},actionVersion:{type:"string",id:17},authToken:{type:"string",id:18},sessionId:{type:"string",id:20},reason:{type:"string",id:21}},nested:{OsType:{values:{OS_IOS:0,OS_ANDROID:1,OS_LINUX:2,OS_OSX:3,OS_WIN:4,OS_OTHER:16}},NetworkType:{values:{NETWORK_NONE:0,NETWORK_WIFI:1,NETWORK_4G:2,NETWORK_3G:3,NETWORK_2G:4,NETWORK_WIRE:5}},CompressType:{values:{COMPRESS_NONE:0,COMPRESS_ZLIB:1}}}},MUCBody:{fields:{mucId:{type:"JID",id:1},operation:{type:"Operation",id:2},from:{type:"JID",id:3},to:{rule:"repeated",type:"JID",id:4},setting:{type:"Setting",id:5},reason:{type:"string",id:6},isChatroom:{type:"bool",id:7},status:{type:"Status",id:8},isThread:{type:"bool",id:9},mucParentId:{type:"JID",id:10},mucName:{type:"string",id:11},eventInfo:{type:"EventInfo",id:12},mucMemberCount:{type:"int32",id:13},ext:{type:"string",id:14},leaveOtherRooms:{type:"bool",id:15}},nested:{Operation:{values:{CREATE:0,DESTROY:1,JOIN:2,LEAVE:3,APPLY:4,APPLY_ACCEPT:5,APPLY_DECLINE:6,INVITE:7,INVITE_ACCEPT:8,INVITE_DECLINE:9,KICK:10,GET_BLACKLIST:11,BAN:12,ALLOW:13,UPDATE:14,BLOCK:15,UNBLOCK:16,PRESENCE:17,ABSENCE:18,DIRECT_JOINED:19,ASSIGN_OWNER:20,ADD_ADMIN:21,REMOVE_ADMIN:22,ADD_MUTE:23,REMOVE_MUTE:24,UPDATE_ANNOUNCEMENT:25,DELETE_ANNOUNCEMENT:26,UPLOAD_FILE:27,DELETE_FILE:28,ADD_USER_WHITE_LIST:29,REMOVE_USER_WHITE_LIST:30,BAN_GROUP:31,REMOVE_BAN_GROUP:32,THREAD_CREATE:33,THREAD_DESTROY:34,THREAD_JOIN:35,THREAD_LEAVE:36,THREAD_KICK:37,THREAD_UPDATE:38,THREAD_PRESENCE:39,THREAD_ABSENCE:40,DISABLE_GROUP:41,ABLE_GROUP:42,SET_METADATA:43,DELETE_METADATA:44,GROUP_MEMBER_METADATA_UPDATE:45}},Setting:{fields:{name:{type:"string",id:1},desc:{type:"string",id:2},type:{type:"Type",id:3},maxUsers:{type:"int32",id:4},owner:{type:"string",id:5}},nested:{Type:{values:{PRIVATE_OWNER_INVITE:0,PRIVATE_MEMBER_INVITE:1,PUBLIC_JOIN_APPROVAL:2,PUBLIC_JOIN_OPEN:3,PUBLIC_ANONYMOUS:4}}}},Status:{fields:{errorCode:{type:"ErrorCode",id:1},description:{type:"string",id:2}},nested:{ErrorCode:{values:{OK:0,PERMISSION_DENIED:1,WRONG_PARAMETER:2,MUC_NOT_EXIST:3,USER_NOT_EXIST:4,UNKNOWN:5}}}},EventInfo:{fields:{eventType:{type:"EventType",id:1,options:{default:"EVENT_NONE"}},ext:{type:"string",id:2}},nested:{EventType:{values:{EVENT_NONE:0,CIRCLE_CHANNEL:1}}}}}},RosterBody:{fields:{operation:{type:"Operation",id:1},status:{type:"Status",id:2},from:{type:"JID",id:3},to:{rule:"repeated",type:"JID",id:4},reason:{type:"string",id:5},rosterVer:{type:"string",id:6},biDirection:{type:"bool",id:7}},nested:{Operation:{values:{GET_ROSTER:0,GET_BLACKLIST:1,ADD:2,REMOVE:3,ACCEPT:4,DECLINE:5,BAN:6,ALLOW:7,REMOTE_ACCEPT:8,REMOTE_DECLINE:9}},Status:{fields:{errorCode:{type:"ErrorCode",id:1},description:{type:"string",id:2}},nested:{ErrorCode:{values:{OK:0,USER_NOT_EXIST:1,USER_ALREADY_FRIEND:2,USER_ALREADY_BLACKLIST:3}}}}}},StatisticsBody:{fields:{operation:{type:"Operation",id:1},os:{type:"OsType",id:2},version:{type:"string",id:3},network:{type:"NetworkType",id:4},imTime:{type:"uint32",id:5},chatTime:{type:"uint32",id:6},location:{type:"string",id:7},reason:{type:"string",id:10}},nested:{Operation:{values:{INFORMATION:0,USER_REMOVED:1,USER_LOGIN_ANOTHER_DEVICE:2,USER_KICKED_BY_CHANGE_PASSWORD:3,USER_KICKED_BY_OTHER_DEVICE:4}},OsType:{values:{OS_IOS:0,OS_ANDROID:1,OS_LINUX:2,OS_OSX:3,OS_WIN:4,OS_OTHER:16}},NetworkType:{values:{NETWORK_NONE:0,NETWORK_WIFI:1,NETWORK_4G:2,NETWORK_3G:3,NETWORK_2G:4,NETWORK_WIRE:5}}}}}}}}}});Q.prototype.root=le;var ue=h.kg.getLogger("defaultLogger");ue.setConfig({useCache:!1,maxCache:3145728,color:"",background:""}),ue.enableAll(),Q.prototype._getSock=function(){if(this.isHttpDNS){var e=this.socketHost[this.hostIndex];if(!e)throw this.times=1,this.autoReconnectNumTotal=0,this.hostIndex=0,this.onClosed&&this.onClosed(),new Error("No connected domain name when get websocket.");var n=e.domain,r=e.ip,o="",i=e.port;o=n||r,i&&"80"!==i&&"443"!==i&&(o+=":"+i),o&&(this.url="//"+o+"/ws");var a=this.https?"https:":"http:";this.url=a+this.url}return new(t())(this.url,null,{timeout:3e4})},Q.prototype.getUniqueId=l.P6.getUniqueId;var de={connection:Q,message:ce.Message,utils:l.P6,logger:ue,statusCode:d.E};"undefined"!=typeof window&&(window.WebIM=de);var pe=de}(),o}()}).call(this,n(39))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(31)),o=i(n(434));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=function(e,t){var n=t.wizard,r=(n.init,function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(n,["init"]));return(0,o.default)(e,r)};return t.contextTypes={wizard:r.default.object},t.displayName=e,t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),s=u(n(31)),c=n(196),l=u(n(434));function u(e){return e&&e.__esModule?e:{default:e}}function d(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var h=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,a=Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=r=p(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.state={step:{id:null},steps:[]},r.history=r.props.history||(0,c.createMemoryHistory)(),r.steps=[],r.pathToStep=function(e){var t=e.replace(r.basename,""),n=r.state.steps.filter((function(e){return e.id===t}));return o(n,1)[0]||r.state.step},r.init=function(e){r.setState({steps:e},(function(){var e=r.pathToStep(r.history.location.pathname);e.id?r.setState({step:e}):r.history.replace(""+r.basename+r.ids[0])}))},r.push=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.nextStep;return r.history.push(""+r.basename+e)},r.replace=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.nextStep;return r.history.replace(""+r.basename+e)},r.next=function(){r.props.onNext?r.props.onNext(r.getChildContext().wizard):r.push()},p(r,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"getChildContext",value:function(){return{wizard:r({go:this.history.go,history:this.history,init:this.init,next:this.next,previous:this.history.goBack,push:this.push,replace:this.replace},this.state)}}},{key:"componentWillMount",value:function(){var e=this;if(this.unlisten=this.history.listen((function(t){var n=t.pathname;return e.setState({step:e.pathToStep(n)})})),this.props.onNext){var t=this.getChildContext().wizard,n=(t.init,d(t,["init"]));this.props.onNext(n)}}},{key:"componentWillUnmount",value:function(){this.unlisten()}},{key:"render",value:function(){var e=this.getChildContext().wizard,t=(e.init,d(e,["init"]));return(0,l.default)(this.props,t)}},{key:"basename",get:function(){return this.props.basename+"/"}},{key:"ids",get:function(){return this.state.steps.map((function(e){return e.id}))}},{key:"nextStep",get:function(){return this.ids[this.ids.indexOf(this.state.step.id)+1]}}]),t}(a.Component);h.propTypes={basename:s.default.string,history:s.default.shape({entries:s.default.array,go:s.default.func,goBack:s.default.func,listen:s.default.func,location:s.default.object,push:s.default.func,replace:s.default.func}),onNext:s.default.func},h.defaultProps={basename:"",history:null,onNext:null,render:null},h.childContextTypes={wizard:s.default.object},t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=c(i),s=c(n(31));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentWillMount",value:function(){var e=a.default.Children.map(this.props.children,(function(e){var t=e.props;t.children,t.render;return function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(t,["children","render"])}));this.context.wizard.init(e)}},{key:"render",value:function(){var e=(this.props.step||this.context.wizard.step).id,t=a.default.Children.toArray(this.props.children).filter((function(t){return t.props.id===e})),n=r(t,1)[0];return void 0===n?null:n}}]),t}(i.Component);l.propTypes={children:s.default.node.isRequired,step:s.default.shape({id:s.default.string.isRequired})},l.defaultProps={step:null},l.contextTypes={wizard:s.default.object},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=s(n(2)),i=s(n(31)),a=s(n(723));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=function(t,n){var i=n.wizard,a=(i.init,function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(i,["init"]));return o.default.createElement(e,r({wizard:a},t))};return t.contextTypes={wizard:i.default.object},t.displayName="withWizard("+(e.displayName||e.name)+")",t.WrappedComponent=e,(0,a.default)(t,e)}},function(e,t,n){"use strict";var r={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i=Object.defineProperty,a=Object.getOwnPropertyNames,s=Object.getOwnPropertySymbols,c=Object.getOwnPropertyDescriptor,l=Object.getPrototypeOf,u=l&&l(Object);e.exports=function e(t,n,d){if("string"!==typeof n){if(u){var p=l(n);p&&p!==u&&e(t,p,d)}var h=a(n);s&&(h=h.concat(s(n)));for(var f=0;f<h.length;++f){var m=h[f];if(!r[m]&&!o[m]&&(!d||!d[m])){var v=c(n,m);try{i(t,m,v)}catch(g){}}}return t}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(31),i=(r=o)&&r.__esModule?r:{default:r};t.default=i.default.shape({go:i.default.func.isRequired,history:i.default.object.isRequired,next:i.default.func.isRequired,previous:i.default.func.isRequired,push:i.default.func.isRequired,replace:i.default.func.isRequired,step:i.default.shape({id:i.default.string.isRequired}).isRequired,steps:i.default.arrayOf(i.default.shape({id:i.default.string.isRequired}).isRequired).isRequired})},,,,function(e,t,n){var r=n(190);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e){return i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function l(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.r(t),n.d(t,"MultiDrag",(function(){return St})),n.d(t,"Sortable",(function(){return We})),n.d(t,"Swap",(function(){return pt}));function d(e){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var p=d(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),h=d(/Edge/i),f=d(/firefox/i),m=d(/safari/i)&&!d(/chrome/i)&&!d(/android/i),v=d(/iP(ad|od|hone)/i),g=d(/chrome/i)&&d(/android/i),E={capture:!1,passive:!1};function y(e,t,n){e.addEventListener(t,n,!p&&E)}function _(e,t,n){e.removeEventListener(t,n,!p&&E)}function b(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(n){return!1}return!1}}function T(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function S(e,t,n,r){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&b(e,t):b(e,t))||r&&e===n)return e;if(e===n)break}while(e=T(e))}return null}var O,R=/\s+/g;function C(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var r=(" "+e.className+" ").replace(R," ").replace(" "+t+" "," ");e.className=(r+(n?" "+t:"")).replace(R," ")}}function w(e,t,n){var r=e&&e.style;if(r){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in r||-1!==t.indexOf("webkit")||(t="-webkit-"+t),r[t]=n+("string"===typeof n?"":"px")}}function I(e,t){var n="";if("string"===typeof e)n=e;else do{var r=w(e,"transform");r&&"none"!==r&&(n=r+" "+n)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function A(e,t,n){if(e){var r=e.getElementsByTagName(t),o=0,i=r.length;if(n)for(;o<i;o++)n(r[o],o);return r}return[]}function N(){var e=document.scrollingElement;return e||document.documentElement}function k(e,t,n,r,o){if(e.getBoundingClientRect||e===window){var i,a,s,c,l,u,d;if(e!==window&&e.parentNode&&e!==N()?(a=(i=e.getBoundingClientRect()).top,s=i.left,c=i.bottom,l=i.right,u=i.height,d=i.width):(a=0,s=0,c=window.innerHeight,l=window.innerWidth,u=window.innerHeight,d=window.innerWidth),(t||n)&&e!==window&&(o=o||e.parentNode,!p))do{if(o&&o.getBoundingClientRect&&("none"!==w(o,"transform")||n&&"static"!==w(o,"position"))){var h=o.getBoundingClientRect();a-=h.top+parseInt(w(o,"border-top-width")),s-=h.left+parseInt(w(o,"border-left-width")),c=a+i.height,l=s+i.width;break}}while(o=o.parentNode);if(r&&e!==window){var f=I(o||e),m=f&&f.a,v=f&&f.d;f&&(c=(a/=v)+(u/=v),l=(s/=m)+(d/=m))}return{top:a,left:s,bottom:c,right:l,width:d,height:u}}}function P(e,t,n){for(var r=U(e,!0),o=k(e)[t];r;){var i=k(r)[n];if(!("top"===n||"left"===n?o>=i:o<=i))return r;if(r===N())break;r=U(r,!1)}return!1}function D(e,t,n,r){for(var o=0,i=0,a=e.children;i<a.length;){if("none"!==a[i].style.display&&a[i]!==We.ghost&&(r||a[i]!==We.dragged)&&S(a[i],n.draggable,e,!1)){if(o===t)return a[i];o++}i++}return null}function M(e,t){for(var n=e.lastElementChild;n&&(n===We.ghost||"none"===w(n,"display")||t&&!b(n,t));)n=n.previousElementSibling;return n||null}function L(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===We.clone||t&&!b(e,t)||n++;return n}function x(e){var t=0,n=0,r=N();if(e)do{var o=I(e),i=o.a,a=o.d;t+=e.scrollLeft*i,n+=e.scrollTop*a}while(e!==r&&(e=e.parentNode));return[t,n]}function U(e,t){if(!e||!e.getBoundingClientRect)return N();var n=e,r=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=w(n);if(n.clientWidth<n.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!n.getBoundingClientRect||n===document.body)return N();if(r||t)return n;r=!0}}}while(n=n.parentNode);return N()}function j(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function F(e,t){return function(){if(!O){var n=arguments;1===n.length?e.call(this,n[0]):e.apply(this,n),O=setTimeout((function(){O=void 0}),t)}}}function B(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function V(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function H(e,t){w(e,"position","absolute"),w(e,"top",t.top),w(e,"left",t.left),w(e,"width",t.width),w(e,"height",t.height)}function G(e){w(e,"position",""),w(e,"top",""),w(e,"left",""),w(e,"width",""),w(e,"height","")}function W(e,t,n){var r={};return Array.from(e.children).forEach((function(o){var i,a,s,c;if(S(o,t.draggable,e,!1)&&!o.animated&&o!==n){var l=k(o);r.left=Math.min(null!==(i=r.left)&&void 0!==i?i:1/0,l.left),r.top=Math.min(null!==(a=r.top)&&void 0!==a?a:1/0,l.top),r.right=Math.max(null!==(s=r.right)&&void 0!==s?s:-1/0,l.right),r.bottom=Math.max(null!==(c=r.bottom)&&void 0!==c?c:-1/0,l.bottom)}})),r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}var q="Sortable"+(new Date).getTime();function K(){var e,t=[];return{captureAnimationState:function(){(t=[],this.options.animation)&&[].slice.call(this.el.children).forEach((function(e){if("none"!==w(e,"display")&&e!==We.ghost){t.push({target:e,rect:k(e)});var n=o({},t[t.length-1].rect);if(e.thisAnimationDuration){var r=I(e,!0);r&&(n.top-=r.f,n.left-=r.e)}e.fromRect=n}}))},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var r in t)if(t.hasOwnProperty(r)&&t[r]===e[n][r])return Number(n);return-1}(t,{target:e}),1)},animateAll:function(n){var r=this;if(!this.options.animation)return clearTimeout(e),void("function"===typeof n&&n());var o=!1,i=0;t.forEach((function(e){var t=0,n=e.target,a=n.fromRect,s=k(n),c=n.prevFromRect,l=n.prevToRect,u=e.rect,d=I(n,!0);d&&(s.top-=d.f,s.left-=d.e),n.toRect=s,n.thisAnimationDuration&&j(c,s)&&!j(a,s)&&(u.top-s.top)/(u.left-s.left)===(a.top-s.top)/(a.left-s.left)&&(t=function(e,t,n,r){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*r.animation}(u,c,l,r.options)),j(s,a)||(n.prevFromRect=a,n.prevToRect=s,t||(t=r.options.animation),r.animate(n,u,s,t)),t&&(o=!0,i=Math.max(i,t),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),t),n.thisAnimationDuration=t)})),clearTimeout(e),o?e=setTimeout((function(){"function"===typeof n&&n()}),i):"function"===typeof n&&n(),t=[]},animate:function(e,t,n,r){if(r){w(e,"transition",""),w(e,"transform","");var o=I(this.el),i=o&&o.a,a=o&&o.d,s=(t.left-n.left)/(i||1),c=(t.top-n.top)/(a||1);e.animatingX=!!s,e.animatingY=!!c,w(e,"transform","translate3d("+s+"px,"+c+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),w(e,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),w(e,"transform","translate3d(0,0,0)"),"number"===typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){w(e,"transition",""),w(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),r)}}}}var Y=[],z={initializeByDefault:!0},X={mount:function(e){for(var t in z)z.hasOwnProperty(t)&&!(t in e)&&(e[t]=z[t]);Y.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),Y.push(e)},pluginEvent:function(e,t,n){var r=this;this.eventCanceled=!1,n.cancel=function(){r.eventCanceled=!0};var i=e+"Global";Y.forEach((function(r){t[r.pluginName]&&(t[r.pluginName][i]&&t[r.pluginName][i](o({sortable:t},n)),t.options[r.pluginName]&&t[r.pluginName][e]&&t[r.pluginName][e](o({sortable:t},n)))}))},initializePlugins:function(e,t,n,r){for(var o in Y.forEach((function(r){var o=r.pluginName;if(e.options[o]||r.initializeByDefault){var i=new r(e,t,e.options);i.sortable=e,i.options=e.options,e[o]=i,s(n,i.defaults)}})),e.options)if(e.options.hasOwnProperty(o)){var i=this.modifyOption(e,o,e.options[o]);"undefined"!==typeof i&&(e.options[o]=i)}},getEventProperties:function(e,t){var n={};return Y.forEach((function(r){"function"===typeof r.eventProperties&&s(n,r.eventProperties.call(t[r.pluginName],e))})),n},modifyOption:function(e,t,n){var r;return Y.forEach((function(o){e[o.pluginName]&&o.optionListeners&&"function"===typeof o.optionListeners[t]&&(r=o.optionListeners[t].call(e[o.pluginName],n))})),r}};function J(e){var t=e.sortable,n=e.rootEl,r=e.name,i=e.targetEl,a=e.cloneEl,s=e.toEl,c=e.fromEl,l=e.oldIndex,u=e.newIndex,d=e.oldDraggableIndex,f=e.newDraggableIndex,m=e.originalEvent,v=e.putSortable,g=e.extraEventProperties;if(t=t||n&&n[q]){var E,y=t.options,_="on"+r.charAt(0).toUpperCase()+r.substr(1);!window.CustomEvent||p||h?(E=document.createEvent("Event")).initEvent(r,!0,!0):E=new CustomEvent(r,{bubbles:!0,cancelable:!0}),E.to=s||n,E.from=c||n,E.item=i||n,E.clone=a,E.oldIndex=l,E.newIndex=u,E.oldDraggableIndex=d,E.newDraggableIndex=f,E.originalEvent=m,E.pullMode=v?v.lastPutMode:void 0;var b=o(o({},g),X.getEventProperties(r,t));for(var T in b)E[T]=b[T];n&&n.dispatchEvent(E),y[_]&&y[_].call(t,E)}}var Z=["evt"],Q=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.evt,i=c(n,Z);X.pluginEvent.bind(We)(e,t,o({dragEl:ee,parentEl:te,ghostEl:ne,rootEl:re,nextEl:oe,lastDownEl:ie,cloneEl:ae,cloneHidden:se,dragStarted:_e,putSortable:he,activeSortable:We.active,originalEvent:r,oldIndex:ce,oldDraggableIndex:ue,newIndex:le,newDraggableIndex:de,hideGhostForTarget:Be,unhideGhostForTarget:Ve,cloneNowHidden:function(){se=!0},cloneNowShown:function(){se=!1},dispatchSortableEvent:function(e){$({sortable:t,name:e,originalEvent:r})}},i))};function $(e){J(o({putSortable:he,cloneEl:ae,targetEl:ee,rootEl:re,oldIndex:ce,oldDraggableIndex:ue,newIndex:le,newDraggableIndex:de},e))}var ee,te,ne,re,oe,ie,ae,se,ce,le,ue,de,pe,he,fe,me,ve,ge,Ee,ye,_e,be,Te,Se,Oe,Re=!1,Ce=!1,we=[],Ie=!1,Ae=!1,Ne=[],ke=!1,Pe=[],De="undefined"!==typeof document,Me=v,Le=h||p?"cssFloat":"float",xe=De&&!g&&!v&&"draggable"in document.createElement("div"),Ue=function(){if(De){if(p)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),je=function(e,t){var n=w(e),r=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),o=D(e,0,t),i=D(e,1,t),a=o&&w(o),s=i&&w(i),c=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+k(o).width,l=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+k(i).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&a.float&&"none"!==a.float){var u="left"===a.float?"left":"right";return!i||"both"!==s.clear&&s.clear!==u?"horizontal":"vertical"}return o&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||c>=r&&"none"===n[Le]||i&&"none"===n[Le]&&c+l>r)?"vertical":"horizontal"},Fe=function(e){function t(e,n){return function(r,o,i,a){var s=r.options.group.name&&o.options.group.name&&r.options.group.name===o.options.group.name;if(null==e&&(n||s))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"===typeof e)return t(e(r,o,i,a),n)(r,o,i,a);var c=(n?r:o).options.group.name;return!0===e||"string"===typeof e&&e===c||e.join&&e.indexOf(c)>-1}}var n={},r=e.group;r&&"object"==i(r)||(r={name:r}),n.name=r.name,n.checkPull=t(r.pull,!0),n.checkPut=t(r.put),n.revertClone=r.revertClone,e.group=n},Be=function(){!Ue&&ne&&w(ne,"display","none")},Ve=function(){!Ue&&ne&&w(ne,"display","")};De&&!g&&document.addEventListener("click",(function(e){if(Ce)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Ce=!1,!1}),!0);var He=function(e){if(ee){var t=function(e,t){var n;return we.some((function(r){var o=r[q].options.emptyInsertThreshold;if(o&&!M(r)){var i=k(r),a=e>=i.left-o&&e<=i.right+o,s=t>=i.top-o&&t<=i.bottom+o;return a&&s?n=r:void 0}})),n}((e=e.touches?e.touches[0]:e).clientX,e.clientY);if(t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[q]._onDragOver(n)}}},Ge=function(e){ee&&ee.parentNode[q]._isOutsideThisEl(e.target)};function We(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=s({},t),e[q]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return je(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==We.supportPointer&&"PointerEvent"in window&&(!m||v),emptyInsertThreshold:5};for(var r in X.initializePlugins(this,e,n),n)!(r in t)&&(t[r]=n[r]);for(var o in Fe(t),this)"_"===o.charAt(0)&&"function"===typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!t.forceFallback&&xe,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?y(e,"pointerdown",this._onTapStart):(y(e,"mousedown",this._onTapStart),y(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(y(e,"dragover",this),y(e,"dragenter",this)),we.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),s(this,K())}function qe(e,t,n,r,o,i,a,s){var c,l,u=e[q],d=u.options.onMove;return!window.CustomEvent||p||h?(c=document.createEvent("Event")).initEvent("move",!0,!0):c=new CustomEvent("move",{bubbles:!0,cancelable:!0}),c.to=t,c.from=e,c.dragged=n,c.draggedRect=r,c.related=o||t,c.relatedRect=i||k(t),c.willInsertAfter=s,c.originalEvent=a,e.dispatchEvent(c),d&&(l=d.call(u,c,a)),l}function Ke(e){e.draggable=!1}function Ye(){ke=!1}function ze(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,r=0;n--;)r+=t.charCodeAt(n);return r.toString(36)}function Xe(e){return setTimeout(e,0)}function Je(e){return clearTimeout(e)}We.prototype={constructor:We,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(be=null)},_getDirection:function(e,t){return"function"===typeof this.options.direction?this.options.direction.call(this,e,t,ee):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,r=this.options,o=r.preventOnFilter,i=e.type,a=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,s=(a||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,l=r.filter;if(function(e){Pe.length=0;var t=e.getElementsByTagName("input"),n=t.length;for(;n--;){var r=t[n];r.checked&&Pe.push(r)}}(n),!ee&&!(/mousedown|pointerdown/.test(i)&&0!==e.button||r.disabled)&&!c.isContentEditable&&(this.nativeDraggable||!m||!s||"SELECT"!==s.tagName.toUpperCase())&&(!(s=S(s,r.draggable,n,!1))||!s.animated)&&ie!==s){if(ce=L(s),ue=L(s,r.draggable),"function"===typeof l){if(l.call(this,e,s,this))return $({sortable:t,rootEl:c,name:"filter",targetEl:s,toEl:n,fromEl:n}),Q("filter",t,{evt:e}),void(o&&e.preventDefault())}else if(l&&(l=l.split(",").some((function(r){if(r=S(c,r.trim(),n,!1))return $({sortable:t,rootEl:r,name:"filter",targetEl:s,fromEl:n,toEl:n}),Q("filter",t,{evt:e}),!0}))))return void(o&&e.preventDefault());r.handle&&!S(c,r.handle,n,!1)||this._prepareDragStart(e,a,s)}}},_prepareDragStart:function(e,t,n){var r,o=this,i=o.el,a=o.options,s=i.ownerDocument;if(n&&!ee&&n.parentNode===i){var c=k(n);if(re=i,te=(ee=n).parentNode,oe=ee.nextSibling,ie=n,pe=a.group,We.dragged=ee,fe={target:ee,clientX:(t||e).clientX,clientY:(t||e).clientY},Ee=fe.clientX-c.left,ye=fe.clientY-c.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,ee.style["will-change"]="all",r=function(){Q("delayEnded",o,{evt:e}),We.eventCanceled?o._onDrop():(o._disableDelayedDragEvents(),!f&&o.nativeDraggable&&(ee.draggable=!0),o._triggerDragStart(e,t),$({sortable:o,name:"choose",originalEvent:e}),C(ee,a.chosenClass,!0))},a.ignore.split(",").forEach((function(e){A(ee,e.trim(),Ke)})),y(s,"dragover",He),y(s,"mousemove",He),y(s,"touchmove",He),a.supportPointer?(y(s,"pointerup",o._onDrop),!this.nativeDraggable&&y(s,"pointercancel",o._onDrop)):(y(s,"mouseup",o._onDrop),y(s,"touchend",o._onDrop),y(s,"touchcancel",o._onDrop)),f&&this.nativeDraggable&&(this.options.touchStartThreshold=4,ee.draggable=!0),Q("delayStart",this,{evt:e}),!a.delay||a.delayOnTouchOnly&&!t||this.nativeDraggable&&(h||p))r();else{if(We.eventCanceled)return void this._onDrop();a.supportPointer?(y(s,"pointerup",o._disableDelayedDrag),y(s,"pointercancel",o._disableDelayedDrag)):(y(s,"mouseup",o._disableDelayedDrag),y(s,"touchend",o._disableDelayedDrag),y(s,"touchcancel",o._disableDelayedDrag)),y(s,"mousemove",o._delayedDragTouchMoveHandler),y(s,"touchmove",o._delayedDragTouchMoveHandler),a.supportPointer&&y(s,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(r,a.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){ee&&Ke(ee),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;_(e,"mouseup",this._disableDelayedDrag),_(e,"touchend",this._disableDelayedDrag),_(e,"touchcancel",this._disableDelayedDrag),_(e,"pointerup",this._disableDelayedDrag),_(e,"pointercancel",this._disableDelayedDrag),_(e,"mousemove",this._delayedDragTouchMoveHandler),_(e,"touchmove",this._delayedDragTouchMoveHandler),_(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?y(document,"pointermove",this._onTouchMove):y(document,t?"touchmove":"mousemove",this._onTouchMove):(y(ee,"dragend",this),y(re,"dragstart",this._onDragStart));try{document.selection?Xe((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(n){}},_dragStarted:function(e,t){if(Re=!1,re&&ee){Q("dragStarted",this,{evt:t}),this.nativeDraggable&&y(document,"dragover",Ge);var n=this.options;!e&&C(ee,n.dragClass,!1),C(ee,n.ghostClass,!0),We.active=this,e&&this._appendGhost(),$({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(me){this._lastX=me.clientX,this._lastY=me.clientY,Be();for(var e=document.elementFromPoint(me.clientX,me.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(me.clientX,me.clientY))!==t;)t=e;if(ee.parentNode[q]._isOutsideThisEl(e),t)do{if(t[q]){if(t[q]._onDragOver({clientX:me.clientX,clientY:me.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=T(t));Ve()}},_onTouchMove:function(e){if(fe){var t=this.options,n=t.fallbackTolerance,r=t.fallbackOffset,o=e.touches?e.touches[0]:e,i=ne&&I(ne,!0),a=ne&&i&&i.a,s=ne&&i&&i.d,c=Me&&Oe&&x(Oe),l=(o.clientX-fe.clientX+r.x)/(a||1)+(c?c[0]-Ne[0]:0)/(a||1),u=(o.clientY-fe.clientY+r.y)/(s||1)+(c?c[1]-Ne[1]:0)/(s||1);if(!We.active&&!Re){if(n&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(ne){i?(i.e+=l-(ve||0),i.f+=u-(ge||0)):i={a:1,b:0,c:0,d:1,e:l,f:u};var d="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");w(ne,"webkitTransform",d),w(ne,"mozTransform",d),w(ne,"msTransform",d),w(ne,"transform",d),ve=l,ge=u,me=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!ne){var e=this.options.fallbackOnBody?document.body:re,t=k(ee,!0,Me,!0,e),n=this.options;if(Me){for(Oe=e;"static"===w(Oe,"position")&&"none"===w(Oe,"transform")&&Oe!==document;)Oe=Oe.parentNode;Oe!==document.body&&Oe!==document.documentElement?(Oe===document&&(Oe=N()),t.top+=Oe.scrollTop,t.left+=Oe.scrollLeft):Oe=N(),Ne=x(Oe)}C(ne=ee.cloneNode(!0),n.ghostClass,!1),C(ne,n.fallbackClass,!0),C(ne,n.dragClass,!0),w(ne,"transition",""),w(ne,"transform",""),w(ne,"box-sizing","border-box"),w(ne,"margin",0),w(ne,"top",t.top),w(ne,"left",t.left),w(ne,"width",t.width),w(ne,"height",t.height),w(ne,"opacity","0.8"),w(ne,"position",Me?"absolute":"fixed"),w(ne,"zIndex","100000"),w(ne,"pointerEvents","none"),We.ghost=ne,e.appendChild(ne),w(ne,"transform-origin",Ee/parseInt(ne.style.width)*100+"% "+ye/parseInt(ne.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,r=e.dataTransfer,o=n.options;Q("dragStart",this,{evt:e}),We.eventCanceled?this._onDrop():(Q("setupClone",this),We.eventCanceled||((ae=V(ee)).removeAttribute("id"),ae.draggable=!1,ae.style["will-change"]="",this._hideClone(),C(ae,this.options.chosenClass,!1),We.clone=ae),n.cloneId=Xe((function(){Q("clone",n),We.eventCanceled||(n.options.removeCloneOnHide||re.insertBefore(ae,ee),n._hideClone(),$({sortable:n,name:"clone"}))})),!t&&C(ee,o.dragClass,!0),t?(Ce=!0,n._loopId=setInterval(n._emulateDragOver,50)):(_(document,"mouseup",n._onDrop),_(document,"touchend",n._onDrop),_(document,"touchcancel",n._onDrop),r&&(r.effectAllowed="move",o.setData&&o.setData.call(n,r,ee)),y(document,"drop",n),w(ee,"transform","translateZ(0)")),Re=!0,n._dragStartId=Xe(n._dragStarted.bind(n,t,e)),y(document,"selectstart",n),_e=!0,window.getSelection().removeAllRanges(),m&&w(document.body,"user-select","none"))},_onDragOver:function(e){var t,n,r,i,a=this.el,s=e.target,c=this.options,l=c.group,u=We.active,d=pe===l,p=c.sort,h=he||u,f=this,m=!1;if(!ke){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),s=S(s,c.draggable,a,!0),j("dragOver"),We.eventCanceled)return m;if(ee.contains(e.target)||s.animated&&s.animatingX&&s.animatingY||f._ignoreWhileAnimating===s)return V(!1);if(Ce=!1,u&&!c.disabled&&(d?p||(r=te!==re):he===this||(this.lastPutMode=pe.checkPull(this,u,ee,e))&&l.checkPut(this,u,ee,e))){if(i="vertical"===this._getDirection(e,s),t=k(ee),j("dragOverValid"),We.eventCanceled)return m;if(r)return te=re,F(),this._hideClone(),j("revert"),We.eventCanceled||(oe?re.insertBefore(ee,oe):re.appendChild(ee)),V(!0);var v=M(a,c.draggable);if(!v||function(e,t,n){var r=k(M(n.el,n.options.draggable)),o=W(n.el,n.options,ne),i=10;return t?e.clientX>o.right+i||e.clientY>r.bottom&&e.clientX>r.left:e.clientY>o.bottom+i||e.clientX>r.right&&e.clientY>r.top}(e,i,this)&&!v.animated){if(v===ee)return V(!1);if(v&&a===e.target&&(s=v),s&&(n=k(s)),!1!==qe(re,a,ee,t,s,n,e,!!s))return F(),v&&v.nextSibling?a.insertBefore(ee,v.nextSibling):a.appendChild(ee),te=a,H(),V(!0)}else if(v&&function(e,t,n){var r=k(D(n.el,0,n.options,!0)),o=W(n.el,n.options,ne),i=10;return t?e.clientX<o.left-i||e.clientY<r.top&&e.clientX<r.right:e.clientY<o.top-i||e.clientY<r.bottom&&e.clientX<r.left}(e,i,this)){var g=D(a,0,c,!0);if(g===ee)return V(!1);if(n=k(s=g),!1!==qe(re,a,ee,t,s,n,e,!1))return F(),a.insertBefore(ee,g),te=a,H(),V(!0)}else if(s.parentNode===a){n=k(s);var E,y,_,b=ee.parentNode!==a,T=!function(e,t,n){var r=n?e.left:e.top,o=n?e.right:e.bottom,i=n?e.width:e.height,a=n?t.left:t.top,s=n?t.right:t.bottom,c=n?t.width:t.height;return r===a||o===s||r+i/2===a+c/2}(ee.animated&&ee.toRect||t,s.animated&&s.toRect||n,i),O=i?"top":"left",R=P(s,"top","top")||P(ee,"top","top"),I=R?R.scrollTop:void 0;if(be!==s&&(y=n[O],Ie=!1,Ae=!T&&c.invertSwap||b),E=function(e,t,n,r,o,i,a,s){var c=r?e.clientY:e.clientX,l=r?n.height:n.width,u=r?n.top:n.left,d=r?n.bottom:n.right,p=!1;if(!a)if(s&&Se<l*o){if(!Ie&&(1===Te?c>u+l*i/2:c<d-l*i/2)&&(Ie=!0),Ie)p=!0;else if(1===Te?c<u+Se:c>d-Se)return-Te}else if(c>u+l*(1-o)/2&&c<d-l*(1-o)/2)return function(e){return L(ee)<L(e)?1:-1}(t);if((p=p||a)&&(c<u+l*i/2||c>d-l*i/2))return c>u+l/2?1:-1;return 0}(e,s,n,i,T?1:c.swapThreshold,null==c.invertedSwapThreshold?c.swapThreshold:c.invertedSwapThreshold,Ae,be===s),0!==E){var A=L(ee);do{A-=E,_=te.children[A]}while(_&&("none"===w(_,"display")||_===ne))}if(0===E||_===s)return V(!1);be=s,Te=E;var N=s.nextElementSibling,x=!1,U=qe(re,a,ee,t,s,n,e,x=1===E);if(!1!==U)return 1!==U&&-1!==U||(x=1===U),ke=!0,setTimeout(Ye,30),F(),x&&!N?a.appendChild(ee):s.parentNode.insertBefore(ee,x?N:s),R&&B(R,0,I-R.scrollTop),te=ee.parentNode,void 0===y||Ae||(Se=Math.abs(y-k(s)[O])),H(),V(!0)}if(a.contains(ee))return V(!1)}return!1}function j(c,l){Q(c,f,o({evt:e,isOwner:d,axis:i?"vertical":"horizontal",revert:r,dragRect:t,targetRect:n,canSort:p,fromSortable:h,target:s,completed:V,onMove:function(n,r){return qe(re,a,ee,t,n,k(n),e,r)},changed:H},l))}function F(){j("dragOverAnimationCapture"),f.captureAnimationState(),f!==h&&h.captureAnimationState()}function V(t){return j("dragOverCompleted",{insertion:t}),t&&(d?u._hideClone():u._showClone(f),f!==h&&(C(ee,he?he.options.ghostClass:u.options.ghostClass,!1),C(ee,c.ghostClass,!0)),he!==f&&f!==We.active?he=f:f===We.active&&he&&(he=null),h===f&&(f._ignoreWhileAnimating=s),f.animateAll((function(){j("dragOverAnimationComplete"),f._ignoreWhileAnimating=null})),f!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(s===ee&&!ee.animated||s===a&&!s.animated)&&(be=null),c.dragoverBubble||e.rootEl||s===document||(ee.parentNode[q]._isOutsideThisEl(e.target),!t&&He(e)),!c.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function H(){le=L(ee),de=L(ee,c.draggable),$({sortable:f,name:"change",toEl:a,newIndex:le,newDraggableIndex:de,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){_(document,"mousemove",this._onTouchMove),_(document,"touchmove",this._onTouchMove),_(document,"pointermove",this._onTouchMove),_(document,"dragover",He),_(document,"mousemove",He),_(document,"touchmove",He)},_offUpEvents:function(){var e=this.el.ownerDocument;_(e,"mouseup",this._onDrop),_(e,"touchend",this._onDrop),_(e,"pointerup",this._onDrop),_(e,"pointercancel",this._onDrop),_(e,"touchcancel",this._onDrop),_(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;le=L(ee),de=L(ee,n.draggable),Q("drop",this,{evt:e}),te=ee&&ee.parentNode,le=L(ee),de=L(ee,n.draggable),We.eventCanceled||(Re=!1,Ae=!1,Ie=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Je(this.cloneId),Je(this._dragStartId),this.nativeDraggable&&(_(document,"drop",this),_(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),m&&w(document.body,"user-select",""),w(ee,"transform",""),e&&(_e&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),ne&&ne.parentNode&&ne.parentNode.removeChild(ne),(re===te||he&&"clone"!==he.lastPutMode)&&ae&&ae.parentNode&&ae.parentNode.removeChild(ae),ee&&(this.nativeDraggable&&_(ee,"dragend",this),Ke(ee),ee.style["will-change"]="",_e&&!Re&&C(ee,he?he.options.ghostClass:this.options.ghostClass,!1),C(ee,this.options.chosenClass,!1),$({sortable:this,name:"unchoose",toEl:te,newIndex:null,newDraggableIndex:null,originalEvent:e}),re!==te?(le>=0&&($({rootEl:te,name:"add",toEl:te,fromEl:re,originalEvent:e}),$({sortable:this,name:"remove",toEl:te,originalEvent:e}),$({rootEl:te,name:"sort",toEl:te,fromEl:re,originalEvent:e}),$({sortable:this,name:"sort",toEl:te,originalEvent:e})),he&&he.save()):le!==ce&&le>=0&&($({sortable:this,name:"update",toEl:te,originalEvent:e}),$({sortable:this,name:"sort",toEl:te,originalEvent:e})),We.active&&(null!=le&&-1!==le||(le=ce,de=ue),$({sortable:this,name:"end",toEl:te,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){Q("nulling",this),re=ee=te=ne=oe=ae=ie=se=fe=me=_e=le=de=ce=ue=be=Te=he=pe=We.dragged=We.ghost=We.clone=We.active=null,Pe.forEach((function(e){e.checked=!0})),Pe.length=ve=ge=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":ee&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],n=this.el.children,r=0,o=n.length,i=this.options;r<o;r++)S(e=n[r],i.draggable,this.el,!1)&&t.push(e.getAttribute(i.dataIdAttr)||ze(e));return t},sort:function(e,t){var n={},r=this.el;this.toArray().forEach((function(e,t){var o=r.children[t];S(o,this.options.draggable,r,!1)&&(n[e]=o)}),this),t&&this.captureAnimationState(),e.forEach((function(e){n[e]&&(r.removeChild(n[e]),r.appendChild(n[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return S(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var r=X.modifyOption(this,e,t);n[e]="undefined"!==typeof r?r:t,"group"===e&&Fe(n)},destroy:function(){Q("destroy",this);var e=this.el;e[q]=null,_(e,"mousedown",this._onTapStart),_(e,"touchstart",this._onTapStart),_(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(_(e,"dragover",this),_(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),we.splice(we.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!se){if(Q("hideClone",this),We.eventCanceled)return;w(ae,"display","none"),this.options.removeCloneOnHide&&ae.parentNode&&ae.parentNode.removeChild(ae),se=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(se){if(Q("showClone",this),We.eventCanceled)return;ee.parentNode!=re||this.options.group.revertClone?oe?re.insertBefore(ae,oe):re.appendChild(ae):re.insertBefore(ae,ee),this.options.group.revertClone&&this.animate(ee,ae),w(ae,"display",""),se=!1}}else this._hideClone()}},De&&y(document,"touchmove",(function(e){(We.active||Re)&&e.cancelable&&e.preventDefault()})),We.utils={on:y,off:_,css:w,find:A,is:function(e,t){return!!S(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:F,closest:S,toggleClass:C,clone:V,index:L,nextTick:Xe,cancelNextTick:Je,detectDirection:je,getChild:D,expando:q},We.get=function(e){return e[q]},We.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(We.utils=o(o({},We.utils),e.utils)),X.mount(e)}))},We.create=function(e,t){return new We(e,t)},We.version="1.15.6";var Ze,Qe,$e,et,tt,nt,rt=[],ot=!1;function it(){rt.forEach((function(e){clearInterval(e.pid)})),rt=[]}function at(){clearInterval(nt)}var st,ct=F((function(e,t,n,r){if(t.scroll){var o,i=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,c=t.scrollSpeed,l=N(),u=!1;Qe!==n&&(Qe=n,it(),Ze=t.scroll,o=t.scrollFn,!0===Ze&&(Ze=U(n,!0)));var d=0,p=Ze;do{var h=p,f=k(h),m=f.top,v=f.bottom,g=f.left,E=f.right,y=f.width,_=f.height,b=void 0,T=void 0,S=h.scrollWidth,O=h.scrollHeight,R=w(h),C=h.scrollLeft,I=h.scrollTop;h===l?(b=y<S&&("auto"===R.overflowX||"scroll"===R.overflowX||"visible"===R.overflowX),T=_<O&&("auto"===R.overflowY||"scroll"===R.overflowY||"visible"===R.overflowY)):(b=y<S&&("auto"===R.overflowX||"scroll"===R.overflowX),T=_<O&&("auto"===R.overflowY||"scroll"===R.overflowY));var A=b&&(Math.abs(E-i)<=s&&C+y<S)-(Math.abs(g-i)<=s&&!!C),P=T&&(Math.abs(v-a)<=s&&I+_<O)-(Math.abs(m-a)<=s&&!!I);if(!rt[d])for(var D=0;D<=d;D++)rt[D]||(rt[D]={});rt[d].vx==A&&rt[d].vy==P&&rt[d].el===h||(rt[d].el=h,rt[d].vx=A,rt[d].vy=P,clearInterval(rt[d].pid),0==A&&0==P||(u=!0,rt[d].pid=setInterval(function(){r&&0===this.layer&&We.active._onTouchMove(tt);var t=rt[this.layer].vy?rt[this.layer].vy*c:0,n=rt[this.layer].vx?rt[this.layer].vx*c:0;"function"===typeof o&&"continue"!==o.call(We.dragged.parentNode[q],n,t,e,tt,rt[this.layer].el)||B(rt[this.layer].el,n,t)}.bind({layer:d}),24))),d++}while(t.bubbleScroll&&p!==l&&(p=U(p,!1)));ot=u}}),30),lt=function(e){var t=e.originalEvent,n=e.putSortable,r=e.dragEl,o=e.activeSortable,i=e.dispatchSortableEvent,a=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var c=n||o;a();var l=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,u=document.elementFromPoint(l.clientX,l.clientY);s(),c&&!c.el.contains(u)&&(i("spill"),this.onSpill({dragEl:r,putSortable:n}))}};function ut(){}function dt(){}function pt(){function e(){this.defaults={swapClass:"sortable-swap-highlight"}}return e.prototype={dragStart:function(e){var t=e.dragEl;st=t},dragOverValid:function(e){var t=e.completed,n=e.target,r=e.onMove,o=e.activeSortable,i=e.changed,a=e.cancel;if(o.options.swap){var s=this.sortable.el,c=this.options;if(n&&n!==s){var l=st;!1!==r(n)?(C(n,c.swapClass,!0),st=n):st=null,l&&l!==st&&C(l,c.swapClass,!1)}i(),t(!0),a()}},drop:function(e){var t=e.activeSortable,n=e.putSortable,r=e.dragEl,o=n||this.sortable,i=this.options;st&&C(st,i.swapClass,!1),st&&(i.swap||n&&n.options.swap)&&r!==st&&(o.captureAnimationState(),o!==t&&t.captureAnimationState(),function(e,t){var n,r,o=e.parentNode,i=t.parentNode;if(!o||!i||o.isEqualNode(t)||i.isEqualNode(e))return;n=L(e),r=L(t),o.isEqualNode(i)&&n<r&&r++;o.insertBefore(t,o.children[n]),i.insertBefore(e,i.children[r])}(r,st),o.animateAll(),o!==t&&t.animateAll())},nulling:function(){st=null}},s(e,{pluginName:"swap",eventProperties:function(){return{swapItem:st}}})}ut.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var r=D(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(t,r):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:lt},s(ut,{pluginName:"revertOnSpill"}),dt.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:lt},s(dt,{pluginName:"removeOnSpill"});var ht,ft,mt,vt,gt,Et=[],yt=[],_t=!1,bt=!1,Tt=!1;function St(){function e(e){for(var t in this)"_"===t.charAt(0)&&"function"===typeof this[t]&&(this[t]=this[t].bind(this));e.options.avoidImplicitDeselect||(e.options.supportPointer?y(document,"pointerup",this._deselectMultiDrag):(y(document,"mouseup",this._deselectMultiDrag),y(document,"touchend",this._deselectMultiDrag))),y(document,"keydown",this._checkKeyDown),y(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,avoidImplicitDeselect:!1,setData:function(t,n){var r="";Et.length&&ft===e?Et.forEach((function(e,t){r+=(t?", ":"")+e.textContent})):r=n.textContent,t.setData("Text",r)}}}return e.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(e){var t=e.dragEl;mt=t},delayEnded:function(){this.isMultiDrag=~Et.indexOf(mt)},setupClone:function(e){var t=e.sortable,n=e.cancel;if(this.isMultiDrag){for(var r=0;r<Et.length;r++)yt.push(V(Et[r])),yt[r].sortableIndex=Et[r].sortableIndex,yt[r].draggable=!1,yt[r].style["will-change"]="",C(yt[r],this.options.selectedClass,!1),Et[r]===mt&&C(yt[r],this.options.chosenClass,!1);t._hideClone(),n()}},clone:function(e){var t=e.sortable,n=e.rootEl,r=e.dispatchSortableEvent,o=e.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||Et.length&&ft===t&&(Ot(!0,n),r("clone"),o()))},showClone:function(e){var t=e.cloneNowShown,n=e.rootEl,r=e.cancel;this.isMultiDrag&&(Ot(!1,n),yt.forEach((function(e){w(e,"display","")})),t(),gt=!1,r())},hideClone:function(e){var t=this,n=(e.sortable,e.cloneNowHidden),r=e.cancel;this.isMultiDrag&&(yt.forEach((function(e){w(e,"display","none"),t.options.removeCloneOnHide&&e.parentNode&&e.parentNode.removeChild(e)})),n(),gt=!0,r())},dragStartGlobal:function(e){e.sortable;!this.isMultiDrag&&ft&&ft.multiDrag._deselectMultiDrag(),Et.forEach((function(e){e.sortableIndex=L(e)})),Et=Et.sort((function(e,t){return e.sortableIndex-t.sortableIndex})),Tt=!0},dragStarted:function(e){var t=this,n=e.sortable;if(this.isMultiDrag){if(this.options.sort&&(n.captureAnimationState(),this.options.animation)){Et.forEach((function(e){e!==mt&&w(e,"position","absolute")}));var r=k(mt,!1,!0,!0);Et.forEach((function(e){e!==mt&&H(e,r)})),bt=!0,_t=!0}n.animateAll((function(){bt=!1,_t=!1,t.options.animation&&Et.forEach((function(e){G(e)})),t.options.sort&&Rt()}))}},dragOver:function(e){var t=e.target,n=e.completed,r=e.cancel;bt&&~Et.indexOf(t)&&(n(!1),r())},revert:function(e){var t=e.fromSortable,n=e.rootEl,r=e.sortable,o=e.dragRect;Et.length>1&&(Et.forEach((function(e){r.addAnimationState({target:e,rect:bt?k(e):o}),G(e),e.fromRect=o,t.removeAnimationState(e)})),bt=!1,function(e,t){Et.forEach((function(n,r){var o=t.children[n.sortableIndex+(e?Number(r):0)];o?t.insertBefore(n,o):t.appendChild(n)}))}(!this.options.removeCloneOnHide,n))},dragOverCompleted:function(e){var t=e.sortable,n=e.isOwner,r=e.insertion,o=e.activeSortable,i=e.parentEl,a=e.putSortable,s=this.options;if(r){if(n&&o._hideClone(),_t=!1,s.animation&&Et.length>1&&(bt||!n&&!o.options.sort&&!a)){var c=k(mt,!1,!0,!0);Et.forEach((function(e){e!==mt&&(H(e,c),i.appendChild(e))})),bt=!0}if(!n)if(bt||Rt(),Et.length>1){var l=gt;o._showClone(t),o.options.animation&&!gt&&l&&yt.forEach((function(e){o.addAnimationState({target:e,rect:vt}),e.fromRect=vt,e.thisAnimationDuration=null}))}else o._showClone(t)}},dragOverAnimationCapture:function(e){var t=e.dragRect,n=e.isOwner,r=e.activeSortable;if(Et.forEach((function(e){e.thisAnimationDuration=null})),r.options.animation&&!n&&r.multiDrag.isMultiDrag){vt=s({},t);var o=I(mt,!0);vt.top-=o.f,vt.left-=o.e}},dragOverAnimationComplete:function(){bt&&(bt=!1,Rt())},drop:function(e){var t=e.originalEvent,n=e.rootEl,r=e.parentEl,o=e.sortable,i=e.dispatchSortableEvent,a=e.oldIndex,s=e.putSortable,c=s||this.sortable;if(t){var l=this.options,u=r.children;if(!Tt)if(l.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),C(mt,l.selectedClass,!~Et.indexOf(mt)),~Et.indexOf(mt))Et.splice(Et.indexOf(mt),1),ht=null,J({sortable:o,rootEl:n,name:"deselect",targetEl:mt,originalEvent:t});else{if(Et.push(mt),J({sortable:o,rootEl:n,name:"select",targetEl:mt,originalEvent:t}),t.shiftKey&&ht&&o.el.contains(ht)){var d=L(ht),p=L(mt);~d&&~p&&d!==p&&function(){var e,i;p>d?(i=d,e=p):(i=p,e=d+1);for(var a=l.filter;i<e;i++){if(!~Et.indexOf(u[i]))if(S(u[i],l.draggable,r,!1))a&&("function"===typeof a?a.call(o,t,u[i],o):a.split(",").some((function(e){return S(u[i],e.trim(),r,!1)})))||(C(u[i],l.selectedClass,!0),Et.push(u[i]),J({sortable:o,rootEl:n,name:"select",targetEl:u[i],originalEvent:t}))}}()}else ht=mt;ft=c}if(Tt&&this.isMultiDrag){if(bt=!1,(r[q].options.sort||r!==n)&&Et.length>1){var h=k(mt),f=L(mt,":not(."+this.options.selectedClass+")");if(!_t&&l.animation&&(mt.thisAnimationDuration=null),c.captureAnimationState(),!_t&&(l.animation&&(mt.fromRect=h,Et.forEach((function(e){if(e.thisAnimationDuration=null,e!==mt){var t=bt?k(e):h;e.fromRect=t,c.addAnimationState({target:e,rect:t})}}))),Rt(),Et.forEach((function(e){u[f]?r.insertBefore(e,u[f]):r.appendChild(e),f++})),a===L(mt))){var m=!1;Et.forEach((function(e){e.sortableIndex===L(e)||(m=!0)})),m&&(i("update"),i("sort"))}Et.forEach((function(e){G(e)})),c.animateAll()}ft=c}(n===r||s&&"clone"!==s.lastPutMode)&&yt.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))}},nullingGlobal:function(){this.isMultiDrag=Tt=!1,yt.length=0},destroyGlobal:function(){this._deselectMultiDrag(),_(document,"pointerup",this._deselectMultiDrag),_(document,"mouseup",this._deselectMultiDrag),_(document,"touchend",this._deselectMultiDrag),_(document,"keydown",this._checkKeyDown),_(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(e){if(("undefined"===typeof Tt||!Tt)&&ft===this.sortable&&(!e||!S(e.target,this.options.draggable,this.sortable.el,!1))&&(!e||0===e.button))for(;Et.length;){var t=Et[0];C(t,this.options.selectedClass,!1),Et.shift(),J({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:t,originalEvent:e})}},_checkKeyDown:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},s(e,{pluginName:"multiDrag",utils:{select:function(e){var t=e.parentNode[q];t&&t.options.multiDrag&&!~Et.indexOf(e)&&(ft&&ft!==t&&(ft.multiDrag._deselectMultiDrag(),ft=t),C(e,t.options.selectedClass,!0),Et.push(e))},deselect:function(e){var t=e.parentNode[q],n=Et.indexOf(e);t&&t.options.multiDrag&&~n&&(C(e,t.options.selectedClass,!1),Et.splice(n,1))}},eventProperties:function(){var e=this,t=[],n=[];return Et.forEach((function(r){var o;t.push({multiDragElement:r,index:r.sortableIndex}),o=bt&&r!==mt?-1:bt?L(r,":not(."+e.options.selectedClass+")"):L(r),n.push({multiDragElement:r,index:o})})),{items:l(Et),clones:[].concat(yt),oldIndicies:t,newIndicies:n}},optionListeners:{multiDragKey:function(e){return"ctrl"===(e=e.toLowerCase())?e="Control":e.length>1&&(e=e.charAt(0).toUpperCase()+e.substr(1)),e}}})}function Ot(e,t){yt.forEach((function(n,r){var o=t.children[n.sortableIndex+(e?Number(r):0)];o?t.insertBefore(n,o):t.appendChild(n)}))}function Rt(){Et.forEach((function(e){e!==mt&&e.parentNode&&e.parentNode.removeChild(e)}))}We.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"===typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?y(document,"dragover",this._handleAutoScroll):this.options.supportPointer?y(document,"pointermove",this._handleFallbackAutoScroll):t.touches?y(document,"touchmove",this._handleFallbackAutoScroll):y(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?_(document,"dragover",this._handleAutoScroll):(_(document,"pointermove",this._handleFallbackAutoScroll),_(document,"touchmove",this._handleFallbackAutoScroll),_(document,"mousemove",this._handleFallbackAutoScroll)),at(),it(),clearTimeout(O),O=void 0},nulling:function(){tt=Qe=Ze=ot=nt=$e=et=null,rt.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,r=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,i=document.elementFromPoint(r,o);if(tt=e,t||this.options.forceAutoScrollFallback||h||p||m){ct(e,this.options,i,t);var a=U(i,!0);!ot||nt&&r===$e&&o===et||(nt&&at(),nt=setInterval((function(){var i=U(document.elementFromPoint(r,o),!0);i!==a&&(a=i,it()),ct(e,n.options,i,t)}),10),$e=r,et=o)}else{if(!this.options.bubbleScroll||U(i,!0)===N())return void it();ct(e,this.options,U(i,!1),!1)}}},s(e,{pluginName:"scroll",initializeByDefault:!0})}),We.mount(dt,ut),t.default=We},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=!0,o="Invariant failed";function i(e,t){if(!e){if(r)throw new Error(o);var n="function"===typeof t?t():t;throw new Error(n?o+": "+n:o)}}},,function(e,t,n){var r,o;"undefined"!=typeof self&&self,e.exports=(r=n(2),o=n(19),function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t){e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.DropzoneComponent=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(0)),a=r(n(2)),s=r(n(3)),c=n(4),l=null,u=t.DropzoneComponent=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={files:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,i.default.Component),o(e,[{key:"getDjsConfig",value:function(){var e={url:this.props.config.postUrl?this.props.config.postUrl:null};return this.props.djsConfig?(0,s.default)(!0,{},e,this.props.djsConfig):e}},{key:"componentDidMount",value:function(){var e=this.getDjsConfig();(l=l||n(5)).autoDiscover=!1,this.props.config.postUrl||this.props.eventHandlers.drop||console.info('Neither postUrl nor a "drop" eventHandler specified, the React-Dropzone component might misbehave.');var t=this.props.config.dropzoneSelector||a.default.findDOMNode(this);this.dropzone=new l(t,e),this.setupEvents()}},{key:"componentWillUnmount",value:function(){var e=this;if(this.dropzone)if(this.dropzone.getActiveFiles().length>0){this.queueDestroy=!0;var t=window.setInterval((function(){return!1===e.queueDestroy?window.clearInterval(t):0===e.dropzone.getActiveFiles().length?(e.dropzone=e.destroy(e.dropzone),window.clearInterval(t)):void 0}),500)}else this.dropzone=this.destroy(this.dropzone)}},{key:"componentDidUpdate",value:function(){if(this.queueDestroy=!1,!this.dropzone){var e=this.props.config.dropzoneSelector||a.default.findDOMNode(this);this.dropzone=new l(e,this.getDjsConfig())}}},{key:"componentWillUpdate",value:function(){var e,t=void 0;e=this.props.djsConfig?this.props.djsConfig:{};try{t=this.props.config.postUrl?{url:this.props.config.postUrl}:{}}catch(e){t={}}this.dropzone.options=(0,s.default)(!0,{},this.dropzone.options,e,t)}},{key:"render",value:function(){var e=[],t=this.state.files,n=this.props.config,r=this.props.className?"filepicker dropzone "+this.props.className:"filepicker dropzone";if(n.showFiletypeIcon&&n.iconFiletypes&&(!t||t.length<1))for(var o=0;o<this.props.config.iconFiletypes.length;o+=1)e.push(i.default.createElement(c.Icon,{filetype:n.iconFiletypes[o],key:"icon-component"+o}));return!this.props.config.postUrl&&this.props.action?i.default.createElement("form",{action:this.props.action,className:r},e,this.props.children):i.default.createElement("div",{className:r}," ",e," ",this.props.children," ")}},{key:"setupEvents",value:function(){var e=this,t=this.props.eventHandlers;if(this.dropzone&&t){for(var n in t)if(t.hasOwnProperty(n)&&t[n])if("[object Array]"===Object.prototype.toString.call(t[n]))for(var r=0;r<t[n].length;r+=1)"init"===n?t[n][r](this.dropzone):this.dropzone.on(n,t[n][r]);else"init"===n?t[n](this.dropzone):this.dropzone.on(n,t[n]);this.dropzone.on("addedfile",(function(t){if(t){var n=e.state.files||[];n.push(t),e.setState({files:n})}})),this.dropzone.on("removedfile",(function(t){if(t){var n=e.state.files||[];n.forEach((function(e,r){e.name===t.name&&e.size===t.size&&n.splice(r,1)})),e.setState({files:n})}}))}}},{key:"destroy",value:function(e){return e.off(),e.destroy()}}]),e}();u.defaultProps={djsConfig:{},config:{},eventHandlers:{}},t.default=u},function(e,t){e.exports=o},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===o.call(e)},a=function(e){if(!e||"[object Object]"!==o.call(e))return!1;var t,n=r.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&r.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!i)return!1;for(t in e);return void 0===t||r.call(e,t)};e.exports=function e(){var t,n,r,o,s,c,l=arguments[0],u=1,d=arguments.length,p=!1;for("boolean"==typeof l&&(p=l,l=arguments[1]||{},u=2),(null==l||"object"!=typeof l&&"function"!=typeof l)&&(l={});u<d;++u)if(null!=(t=arguments[u]))for(n in t)r=l[n],l!==(o=t[n])&&(p&&o&&(a(o)||(s=i(o)))?(s?(s=!1,c=r&&i(r)?r:[]):c=r&&a(r)?r:{},l[n]=e(p,c,o)):void 0!==o&&(l[n]=o));return l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Icon=void 0;var r,o=(r=n(0))&&r.__esModule?r:{default:r};t.Icon=function(e){return o.default.createElement("div",{"data-filetype":e.filetype,className:"filepicker-file-icon"})}},function(e,t,n){"use strict";(function(e){function t(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,[{key:"on",value:function(e,t){return this._callbacks=this._callbacks||{},this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t),this}},{key:"emit",value:function(e){this._callbacks=this._callbacks||{};var t=this._callbacks[e];if(t){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];for(var i=0,a=a=t;!(i>=a.length);)a[i++].apply(this,r)}return this}},{key:"off",value:function(e,t){if(!this._callbacks||0===arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1===arguments.length)return delete this._callbacks[e],this;for(var r=0;r<n.length;r++)if(n[r]===t){n.splice(r,1);break}return this}}]),e}(),i=function(){function e(r,o){n(this,e);var i,a=t(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),s=void 0;if(a.element=r,a.version=e.version,a.defaultOptions.previewTemplate=a.defaultOptions.previewTemplate.replace(/\n*/g,""),a.clickableElements=[],a.listeners=[],a.files=[],"string"==typeof a.element&&(a.element=document.querySelector(a.element)),!a.element||null==a.element.nodeType)throw new Error("Invalid dropzone element.");if(a.element.dropzone)throw new Error("Dropzone already attached.");e.instances.push(a),a.element.dropzone=a;var c,l=null!=(i=e.optionsForElement(a.element))?i:{};if(a.options=e.extend({},a.defaultOptions,l,null!=o?o:{}),a.options.forceFallback||!e.isBrowserSupported())return c=a.options.fallback.call(a),t(a,c);if(null==a.options.url&&(a.options.url=a.element.getAttribute("action")),!a.options.url)throw new Error("No URL provided.");if(a.options.acceptedFiles&&a.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");if(a.options.uploadMultiple&&a.options.chunking)throw new Error("You cannot set both: uploadMultiple and chunking.");return a.options.acceptedMimeTypes&&(a.options.acceptedFiles=a.options.acceptedMimeTypes,delete a.options.acceptedMimeTypes),null!=a.options.renameFilename&&(a.options.renameFile=function(e){return a.options.renameFilename.call(a,e.name,e)}),a.options.method=a.options.method.toUpperCase(),(s=a.getExistingFallback())&&s.parentNode&&s.parentNode.removeChild(s),!1!==a.options.previewsContainer&&(a.options.previewsContainer?a.previewsContainer=e.getElement(a.options.previewsContainer,"previewsContainer"):a.previewsContainer=a.element),a.options.clickable&&(!0===a.options.clickable?a.clickableElements=[a.element]:a.clickableElements=e.getElements(a.options.clickable,"clickable")),a.init(),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,o),r(e,null,[{key:"initClass",value:function(){this.prototype.Emitter=o,this.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","addedfiles","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],this.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,timeout:3e4,parallelUploads:2,uploadMultiple:!1,chunking:!1,forceChunking:!1,chunkSize:2e6,parallelChunkUploads:!1,retryChunks:!1,retryChunksLimit:3,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,thumbnailMethod:"crop",resizeWidth:null,resizeHeight:null,resizeMimeType:null,resizeQuality:.8,resizeMethod:"contain",filesizeBase:1e3,maxFiles:null,headers:null,clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,hiddenInputContainer:"body",capture:null,renameFilename:null,renameFile:null,forceFallback:!1,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictUploadCanceled:"Upload canceled.",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",dictFileSizeUnits:{tb:"TB",gb:"GB",mb:"MB",kb:"KB",b:"b"},init:function(){},params:function(e,t,n){if(n)return{dzuuid:n.file.upload.uuid,dzchunkindex:n.index,dztotalfilesize:n.file.size,dzchunksize:this.options.chunkSize,dztotalchunkcount:n.file.upload.totalChunkCount,dzchunkbyteoffset:n.index*this.options.chunkSize}},accept:function(e,t){return t()},chunksUploaded:function(e,t){t()},fallback:function(){var t=void 0;this.element.className=this.element.className+" dz-browser-not-supported";for(var n=0,r=r=this.element.getElementsByTagName("div");!(n>=r.length);){var o=r[n++];if(/(^| )dz-message($| )/.test(o.className)){t=o,o.className="dz-message";break}}t||(t=e.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(t));var i=t.getElementsByTagName("span")[0];return i&&(null!=i.textContent?i.textContent=this.options.dictFallbackMessage:null!=i.innerText&&(i.innerText=this.options.dictFallbackMessage)),this.element.appendChild(this.getFallbackForm())},resize:function(e,t,n,r){var o={srcX:0,srcY:0,srcWidth:e.width,srcHeight:e.height},i=e.width/e.height;null==t&&null==n?(t=o.srcWidth,n=o.srcHeight):null==t?t=n*i:null==n&&(n=t/i);var a=(t=Math.min(t,o.srcWidth))/(n=Math.min(n,o.srcHeight));if(o.srcWidth>t||o.srcHeight>n)if("crop"===r)i>a?(o.srcHeight=e.height,o.srcWidth=o.srcHeight*a):(o.srcWidth=e.width,o.srcHeight=o.srcWidth/a);else{if("contain"!==r)throw new Error("Unknown resizeMethod '"+r+"'");i>a?n=t/i:t=n*i}return o.srcX=(e.width-o.srcWidth)/2,o.srcY=(e.height-o.srcHeight)/2,o.trgWidth=t,o.trgHeight=n,o},transformFile:function(e,t){return(this.options.resizeWidth||this.options.resizeHeight)&&e.type.match(/image.*/)?this.resizeImage(e,this.options.resizeWidth,this.options.resizeHeight,this.options.resizeMethod,t):t(e)},previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><img data-dz-thumbnail /></div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size></span></div>\n    <div class="dz-filename"><span data-dz-name></span></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Check</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>\n      </g>\n    </svg>\n  </div>\n  <div class="dz-error-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Error</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">\n          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>',drop:function(e){return this.element.classList.remove("dz-drag-hover")},dragstart:function(e){},dragend:function(e){return this.element.classList.remove("dz-drag-hover")},dragenter:function(e){return this.element.classList.add("dz-drag-hover")},dragover:function(e){return this.element.classList.add("dz-drag-hover")},dragleave:function(e){return this.element.classList.remove("dz-drag-hover")},paste:function(e){},reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(t){var n=this;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){t.previewElement=e.createElement(this.options.previewTemplate.trim()),t.previewTemplate=t.previewElement,this.previewsContainer.appendChild(t.previewElement);for(var r=0,o=o=t.previewElement.querySelectorAll("[data-dz-name]");!(r>=o.length);){var i=o[r++];i.textContent=t.name}for(var a=0,s=s=t.previewElement.querySelectorAll("[data-dz-size]");!(a>=s.length);)(i=s[a++]).innerHTML=this.filesize(t.size);this.options.addRemoveLinks&&(t._removeLink=e.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),t.previewElement.appendChild(t._removeLink));for(var c=function(r){return r.preventDefault(),r.stopPropagation(),t.status===e.UPLOADING?e.confirm(n.options.dictCancelUploadConfirmation,(function(){return n.removeFile(t)})):n.options.dictRemoveFileConfirmation?e.confirm(n.options.dictRemoveFileConfirmation,(function(){return n.removeFile(t)})):n.removeFile(t)},l=0,u=u=t.previewElement.querySelectorAll("[data-dz-remove]");!(l>=u.length);)u[l++].addEventListener("click",c)}},removedfile:function(e){return null!=e.previewElement&&null!=e.previewElement.parentNode&&e.previewElement.parentNode.removeChild(e.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(e,t){if(e.previewElement){e.previewElement.classList.remove("dz-file-preview");for(var n=0,r=r=e.previewElement.querySelectorAll("[data-dz-thumbnail]");!(n>=r.length);){var o=r[n++];o.alt=e.name,o.src=t}return setTimeout((function(){return e.previewElement.classList.add("dz-image-preview")}),1)}},error:function(e,t){if(e.previewElement){e.previewElement.classList.add("dz-error"),"String"!=typeof t&&t.error&&(t=t.error);for(var n=0,r=r=e.previewElement.querySelectorAll("[data-dz-errormessage]");!(n>=r.length);)r[n++].textContent=t}},errormultiple:function(){},processing:function(e){if(e.previewElement&&(e.previewElement.classList.add("dz-processing"),e._removeLink))return e._removeLink.textContent=this.options.dictCancelUpload},processingmultiple:function(){},uploadprogress:function(e,t,n){if(e.previewElement)for(var r=0,o=o=e.previewElement.querySelectorAll("[data-dz-uploadprogress]");!(r>=o.length);){var i=o[r++];"PROGRESS"===i.nodeName?i.value=t:i.style.width=t+"%"}},totaluploadprogress:function(){},sending:function(){},sendingmultiple:function(){},success:function(e){if(e.previewElement)return e.previewElement.classList.add("dz-success")},successmultiple:function(){},canceled:function(e){return this.emit("error",e,this.options.dictUploadCanceled)},canceledmultiple:function(){},complete:function(e){if(e._removeLink&&(e._removeLink.textContent=this.options.dictRemoveFile),e.previewElement)return e.previewElement.classList.add("dz-complete")},completemultiple:function(){},maxfilesexceeded:function(){},maxfilesreached:function(){},queuecomplete:function(){},addedfiles:function(){}},this.prototype._thumbnailQueue=[],this.prototype._processingThumbnail=!1}},{key:"extend",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var o=0,i=i=n;!(o>=i.length);){var a=i[o++];for(var s in a){var c=a[s];e[s]=c}}return e}}]),r(e,[{key:"getAcceptedFiles",value:function(){return this.files.filter((function(e){return e.accepted})).map((function(e){return e}))}},{key:"getRejectedFiles",value:function(){return this.files.filter((function(e){return!e.accepted})).map((function(e){return e}))}},{key:"getFilesWithStatus",value:function(e){return this.files.filter((function(t){return t.status===e})).map((function(e){return e}))}},{key:"getQueuedFiles",value:function(){return this.getFilesWithStatus(e.QUEUED)}},{key:"getUploadingFiles",value:function(){return this.getFilesWithStatus(e.UPLOADING)}},{key:"getAddedFiles",value:function(){return this.getFilesWithStatus(e.ADDED)}},{key:"getActiveFiles",value:function(){return this.files.filter((function(t){return t.status===e.UPLOADING||t.status===e.QUEUED})).map((function(e){return e}))}},{key:"init",value:function(){var t=this;"form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(e.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&function e(){return t.hiddenFileInput&&t.hiddenFileInput.parentNode.removeChild(t.hiddenFileInput),t.hiddenFileInput=document.createElement("input"),t.hiddenFileInput.setAttribute("type","file"),(null===t.options.maxFiles||t.options.maxFiles>1)&&t.hiddenFileInput.setAttribute("multiple","multiple"),t.hiddenFileInput.className="dz-hidden-input",null!==t.options.acceptedFiles&&t.hiddenFileInput.setAttribute("accept",t.options.acceptedFiles),null!==t.options.capture&&t.hiddenFileInput.setAttribute("capture",t.options.capture),t.hiddenFileInput.style.visibility="hidden",t.hiddenFileInput.style.position="absolute",t.hiddenFileInput.style.top="0",t.hiddenFileInput.style.left="0",t.hiddenFileInput.style.height="0",t.hiddenFileInput.style.width="0",document.querySelector(t.options.hiddenInputContainer).appendChild(t.hiddenFileInput),t.hiddenFileInput.addEventListener("change",(function(){var n=t.hiddenFileInput.files;if(n.length)for(var r=0,o=o=n;!(r>=o.length);){var i=o[r++];t.addFile(i)}return t.emit("addedfiles",n),e()}))}(),this.URL=null!==window.URL?window.URL:window.webkitURL;for(var n=0,r=r=this.events;!(n>=r.length);){var o=r[n++];this.on(o,this.options[o])}this.on("uploadprogress",(function(){return t.updateTotalUploadProgress()})),this.on("removedfile",(function(){return t.updateTotalUploadProgress()})),this.on("canceled",(function(e){return t.emit("complete",e)})),this.on("complete",(function(e){if(0===t.getAddedFiles().length&&0===t.getUploadingFiles().length&&0===t.getQueuedFiles().length)return setTimeout((function(){return t.emit("queuecomplete")}),0)}));var i=function(e){return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1};return this.listeners=[{element:this.element,events:{dragstart:function(e){return t.emit("dragstart",e)},dragenter:function(e){return i(e),t.emit("dragenter",e)},dragover:function(e){var n=void 0;try{n=e.dataTransfer.effectAllowed}catch(t){}return e.dataTransfer.dropEffect="move"===n||"linkMove"===n?"move":"copy",i(e),t.emit("dragover",e)},dragleave:function(e){return t.emit("dragleave",e)},drop:function(e){return i(e),t.drop(e)},dragend:function(e){return t.emit("dragend",e)}}}],this.clickableElements.forEach((function(n){return t.listeners.push({element:n,events:{click:function(r){return(n!==t.element||r.target===t.element||e.elementInside(r.target,t.element.querySelector(".dz-message")))&&t.hiddenFileInput.click(),!0}}})})),this.enable(),this.options.init.call(this)}},{key:"destroy",value:function(){return this.disable(),this.removeAllFiles(!0),(null!=this.hiddenFileInput?this.hiddenFileInput.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,e.instances.splice(e.instances.indexOf(this),1)}},{key:"updateTotalUploadProgress",value:function(){var e=void 0,t=0,n=0;if(this.getActiveFiles().length){for(var r=0,o=o=this.getActiveFiles();!(r>=o.length);){var i=o[r++];t+=i.upload.bytesSent,n+=i.upload.total}e=100*t/n}else e=100;return this.emit("totaluploadprogress",e,n,t)}},{key:"_getParamName",value:function(e){return"function"==typeof this.options.paramName?this.options.paramName(e):this.options.paramName+(this.options.uploadMultiple?"["+e+"]":"")}},{key:"_renameFile",value:function(e){return"function"!=typeof this.options.renameFile?e.name:this.options.renameFile(e)}},{key:"getFallbackForm",value:function(){var t,n=void 0;if(t=this.getExistingFallback())return t;var r='<div class="dz-fallback">';this.options.dictFallbackText&&(r+="<p>"+this.options.dictFallbackText+"</p>"),r+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>';var o=e.createElement(r);return"FORM"!==this.element.tagName?(n=e.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>')).appendChild(o):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=n?n:o}},{key:"getExistingFallback",value:function(){for(var e=["div","form"],t=0;t<e.length;t++){var n,r=e[t];if(n=function(e){for(var t=0,n=n=e;!(t>=n.length);){var r=n[t++];if(/(^| )fallback($| )/.test(r.className))return r}}(this.element.getElementsByTagName(r)))return n}}},{key:"setupEventListeners",value:function(){return this.listeners.map((function(e){return function(){var t=[];for(var n in e.events){var r=e.events[n];t.push(e.element.addEventListener(n,r,!1))}return t}()}))}},{key:"removeEventListeners",value:function(){return this.listeners.map((function(e){return function(){var t=[];for(var n in e.events){var r=e.events[n];t.push(e.element.removeEventListener(n,r,!1))}return t}()}))}},{key:"disable",value:function(){var e=this;return this.clickableElements.forEach((function(e){return e.classList.remove("dz-clickable")})),this.removeEventListeners(),this.disabled=!0,this.files.map((function(t){return e.cancelUpload(t)}))}},{key:"enable",value:function(){return delete this.disabled,this.clickableElements.forEach((function(e){return e.classList.add("dz-clickable")})),this.setupEventListeners()}},{key:"filesize",value:function(e){var t=0,n="b";if(e>0){for(var r=["tb","gb","mb","kb","b"],o=0;o<r.length;o++){var i=r[o];if(e>=Math.pow(this.options.filesizeBase,4-o)/10){t=e/Math.pow(this.options.filesizeBase,4-o),n=i;break}}t=Math.round(10*t)/10}return"<strong>"+t+"</strong> "+this.options.dictFileSizeUnits[n]}},{key:"_updateMaxFilesReachedClass",value:function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")}},{key:"drop",value:function(e){if(e.dataTransfer){this.emit("drop",e);for(var t=[],n=0;n<e.dataTransfer.files.length;n++)t[n]=e.dataTransfer.files[n];if(this.emit("addedfiles",t),t.length){var r=e.dataTransfer.items;r&&r.length&&null!=r[0].webkitGetAsEntry?this._addFilesFromItems(r):this.handleFiles(t)}}}},{key:"paste",value:function(e){if(null!=(void 0!==(t=null!=e?e.clipboardData:void 0)&&null!==t?function(e){return e.items}(t):void 0)){var t;this.emit("paste",e);var n=e.clipboardData.items;return n.length?this._addFilesFromItems(n):void 0}}},{key:"handleFiles",value:function(e){for(var t=0,n=n=e;!(t>=n.length);){var r=n[t++];this.addFile(r)}}},{key:"_addFilesFromItems",value:function(e){var t=this;return function(){for(var n=[],r=0,o=o=e;!(r>=o.length);){var i,a=o[r++];null!=a.webkitGetAsEntry&&(i=a.webkitGetAsEntry())?i.isFile?n.push(t.addFile(a.getAsFile())):i.isDirectory?n.push(t._addFilesFromDirectory(i,i.name)):n.push(void 0):null==a.getAsFile||null!=a.kind&&"file"!==a.kind?n.push(void 0):n.push(t.addFile(a.getAsFile()))}return n}()}},{key:"_addFilesFromDirectory",value:function(e,t){var n=this,r=e.createReader(),o=function(e){return n="log",r=function(t){return t.log(e)},void 0!==(t=console)&&null!==t&&"function"==typeof t[n]?r(t,n):void 0;var t,n,r};return function e(){return r.readEntries((function(r){if(r.length>0){for(var o=0,i=i=r;!(o>=i.length);){var a=i[o++];a.isFile?a.file((function(e){if(!n.options.ignoreHiddenFiles||"."!==e.name.substring(0,1))return e.fullPath=t+"/"+e.name,n.addFile(e)})):a.isDirectory&&n._addFilesFromDirectory(a,t+"/"+a.name)}e()}return null}),o)}()}},{key:"accept",value:function(t,n){return t.size>1024*this.options.maxFilesize*1024?n(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(t.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):e.isValidFile(t,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(n(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",t)):this.options.accept.call(this,t,n):n(this.options.dictInvalidFileType)}},{key:"addFile",value:function(t){var n=this;return t.upload={uuid:e.uuidv4(),progress:0,total:t.size,bytesSent:0,filename:this._renameFile(t),chunked:this.options.chunking&&(this.options.forceChunking||t.size>this.options.chunkSize),totalChunkCount:Math.ceil(t.size/this.options.chunkSize)},this.files.push(t),t.status=e.ADDED,this.emit("addedfile",t),this._enqueueThumbnail(t),this.accept(t,(function(e){return e?(t.accepted=!1,n._errorProcessing([t],e)):(t.accepted=!0,n.options.autoQueue&&n.enqueueFile(t)),n._updateMaxFilesReachedClass()}))}},{key:"enqueueFiles",value:function(e){for(var t=0,n=n=e;!(t>=n.length);){var r=n[t++];this.enqueueFile(r)}return null}},{key:"enqueueFile",value:function(t){var n=this;if(t.status!==e.ADDED||!0!==t.accepted)throw new Error("This file can't be queued because it has already been processed or was rejected.");if(t.status=e.QUEUED,this.options.autoProcessQueue)return setTimeout((function(){return n.processQueue()}),0)}},{key:"_enqueueThumbnail",value:function(e){var t=this;if(this.options.createImageThumbnails&&e.type.match(/image.*/)&&e.size<=1024*this.options.maxThumbnailFilesize*1024)return this._thumbnailQueue.push(e),setTimeout((function(){return t._processThumbnailQueue()}),0)}},{key:"_processThumbnailQueue",value:function(){var e=this;if(!this._processingThumbnail&&0!==this._thumbnailQueue.length){this._processingThumbnail=!0;var t=this._thumbnailQueue.shift();return this.createThumbnail(t,this.options.thumbnailWidth,this.options.thumbnailHeight,this.options.thumbnailMethod,!0,(function(n){return e.emit("thumbnail",t,n),e._processingThumbnail=!1,e._processThumbnailQueue()}))}}},{key:"removeFile",value:function(t){if(t.status===e.UPLOADING&&this.cancelUpload(t),this.files=a(this.files,t),this.emit("removedfile",t),0===this.files.length)return this.emit("reset")}},{key:"removeAllFiles",value:function(t){null==t&&(t=!1);for(var n=0,r=r=this.files.slice();!(n>=r.length);){var o=r[n++];(o.status!==e.UPLOADING||t)&&this.removeFile(o)}return null}},{key:"resizeImage",value:function(t,n,r,o,i){var a=this;return this.createThumbnail(t,n,r,o,!1,(function(n,r){if(null==r)return i(t);var o=a.options.resizeMimeType;null==o&&(o=t.type);var s=r.toDataURL(o,a.options.resizeQuality);return"image/jpeg"!==o&&"image/jpg"!==o||(s=l.restore(t.dataURL,s)),i(e.dataURItoBlob(s))}))}},{key:"createThumbnail",value:function(e,t,n,r,o,i){var a=this,s=new FileReader;return s.onload=function(){if(e.dataURL=s.result,"image/svg+xml"!==e.type)return a.createThumbnailFromUrl(e,t,n,r,o,i);null!=i&&i(s.result)},s.readAsDataURL(e)}},{key:"createThumbnailFromUrl",value:function(e,t,n,r,o,i,a){var s=this,l=document.createElement("img");return a&&(l.crossOrigin=a),l.onload=function(){var a=function(e){return e(1)};return"undefined"!=typeof EXIF&&null!==EXIF&&o&&(a=function(e){return EXIF.getData(l,(function(){return e(EXIF.getTag(this,"Orientation"))}))}),a((function(o){e.width=l.width,e.height=l.height;var a=s.options.resize.call(s,e,t,n,r),u=document.createElement("canvas"),d=u.getContext("2d");switch(u.width=a.trgWidth,u.height=a.trgHeight,o>4&&(u.width=a.trgHeight,u.height=a.trgWidth),o){case 2:d.translate(u.width,0),d.scale(-1,1);break;case 3:d.translate(u.width,u.height),d.rotate(Math.PI);break;case 4:d.translate(0,u.height),d.scale(1,-1);break;case 5:d.rotate(.5*Math.PI),d.scale(1,-1);break;case 6:d.rotate(.5*Math.PI),d.translate(0,-u.height);break;case 7:d.rotate(.5*Math.PI),d.translate(u.width,-u.height),d.scale(-1,1);break;case 8:d.rotate(-.5*Math.PI),d.translate(-u.width,0)}c(d,l,null!=a.srcX?a.srcX:0,null!=a.srcY?a.srcY:0,a.srcWidth,a.srcHeight,null!=a.trgX?a.trgX:0,null!=a.trgY?a.trgY:0,a.trgWidth,a.trgHeight);var p=u.toDataURL("image/png");if(null!=i)return i(p,u)}))},null!=i&&(l.onerror=i),l.src=e.dataURL}},{key:"processQueue",value:function(){var e=this.options.parallelUploads,t=this.getUploadingFiles().length,n=t;if(!(t>=e)){var r=this.getQueuedFiles();if(r.length>0){if(this.options.uploadMultiple)return this.processFiles(r.slice(0,e-t));for(;n<e;){if(!r.length)return;this.processFile(r.shift()),n++}}}}},{key:"processFile",value:function(e){return this.processFiles([e])}},{key:"processFiles",value:function(t){for(var n=0,r=r=t;!(n>=r.length);){var o=r[n++];o.processing=!0,o.status=e.UPLOADING,this.emit("processing",o)}return this.options.uploadMultiple&&this.emit("processingmultiple",t),this.uploadFiles(t)}},{key:"_getFilesWithXhr",value:function(e){return this.files.filter((function(t){return t.xhr===e})).map((function(e){return e}))}},{key:"cancelUpload",value:function(t){if(t.status===e.UPLOADING){for(var n=this._getFilesWithXhr(t.xhr),r=0,o=o=n;!(r>=o.length);)o[r++].status=e.CANCELED;void 0!==t.xhr&&t.xhr.abort();for(var i=0,a=a=n;!(i>=a.length);){var s=a[i++];this.emit("canceled",s)}this.options.uploadMultiple&&this.emit("canceledmultiple",n)}else t.status!==e.ADDED&&t.status!==e.QUEUED||(t.status=e.CANCELED,this.emit("canceled",t),this.options.uploadMultiple&&this.emit("canceledmultiple",[t]));if(this.options.autoProcessQueue)return this.processQueue()}},{key:"resolveOption",value:function(e){if("function"==typeof e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.apply(this,n)}return e}},{key:"uploadFile",value:function(e){return this.uploadFiles([e])}},{key:"uploadFiles",value:function(t){var n=this;this._transformFiles(t,(function(r){if(t[0].upload.chunked){var o=t[0],i=r[0];o.upload.chunks=[];var a=function(){for(var r=0;void 0!==o.upload.chunks[r];)r++;if(!(r>=o.upload.totalChunkCount)){var a=r*n.options.chunkSize,s=Math.min(a+n.options.chunkSize,o.size),c={name:n._getParamName(0),data:i.webkitSlice?i.webkitSlice(a,s):i.slice(a,s),filename:o.upload.filename,chunkIndex:r};o.upload.chunks[r]={file:o,index:r,dataBlock:c,status:e.UPLOADING,progress:0,retries:0},n._uploadData(t,[c])}};if(o.upload.finishedChunkUpload=function(r){var i=!0;r.status=e.SUCCESS,r.dataBlock=null;for(var s=0;s<o.upload.totalChunkCount;s++){if(void 0===o.upload.chunks[s])return a();o.upload.chunks[s].status!==e.SUCCESS&&(i=!1)}i&&n.options.chunksUploaded(o,(function(){n._finished(t,"",null)}))},n.options.parallelChunkUploads)for(var s=0;s<o.upload.totalChunkCount;s++)a();else a()}else{for(var c=[],l=0;l<t.length;l++)c[l]={name:n._getParamName(l),data:r[l],filename:t[l].upload.filename};n._uploadData(t,c)}}))}},{key:"_getChunk",value:function(e,t){for(var n=0;n<e.upload.totalChunkCount;n++)if(void 0!==e.upload.chunks[n]&&e.upload.chunks[n].xhr===t)return e.upload.chunks[n]}},{key:"_uploadData",value:function(t,n){for(var r=this,o=new XMLHttpRequest,i=0,a=a=t;!(i>=a.length);)a[i++].xhr=o;t[0].upload.chunked&&(t[0].upload.chunks[n[0].chunkIndex].xhr=o);var s=this.resolveOption(this.options.method,t),c=this.resolveOption(this.options.url,t);o.open(s,c,!0),o.timeout=this.resolveOption(this.options.timeout,t),o.withCredentials=!!this.options.withCredentials,o.onload=function(e){r._finishedUploading(t,o,e)},o.onerror=function(){r._handleUploadError(t,o)},(null!=o.upload?o.upload:o).onprogress=function(e){return r._updateFilesUploadProgress(t,o,e)};var l={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"};for(var u in this.options.headers&&e.extend(l,this.options.headers),l){var d=l[u];d&&o.setRequestHeader(u,d)}var p=new FormData;if(this.options.params){var h=this.options.params;for(var f in"function"==typeof h&&(h=h.call(this,t,o,t[0].upload.chunked?this._getChunk(t[0],o):null)),h){var m=h[f];p.append(f,m)}}for(var v=0,g=g=t;!(v>=g.length);){var E=g[v++];this.emit("sending",E,o,p)}this.options.uploadMultiple&&this.emit("sendingmultiple",t,o,p),this._addFormElementData(p);for(var y=0;y<n.length;y++){var _=n[y];p.append(_.name,_.data,_.filename)}this.submitRequest(o,p,t)}},{key:"_transformFiles",value:function(e,t){for(var n=this,r=[],o=0,i=0;i<e.length;i++)!function(i){n.options.transformFile.call(n,e[i],(function(n){r[i]=n,++o===e.length&&t(r)}))}(i)}},{key:"_addFormElementData",value:function(e){if("FORM"===this.element.tagName)for(var t=0,n=n=this.element.querySelectorAll("input, textarea, select, button");!(t>=n.length);){var r=n[t++],o=r.getAttribute("name"),i=r.getAttribute("type");if(i&&(i=i.toLowerCase()),void 0!==o&&null!==o)if("SELECT"===r.tagName&&r.hasAttribute("multiple"))for(var a=0,s=s=r.options;!(a>=s.length);){var c=s[a++];c.selected&&e.append(o,c.value)}else(!i||"checkbox"!==i&&"radio"!==i||r.checked)&&e.append(o,r.value)}}},{key:"_updateFilesUploadProgress",value:function(e,t,n){var r=void 0;if(void 0!==n){if(r=100*n.loaded/n.total,e[0].upload.chunked){var o=e[0],i=this._getChunk(o,t);i.progress=r,i.total=n.total,i.bytesSent=n.loaded,o.upload.progress=0,o.upload.total=0,o.upload.bytesSent=0;for(var a=0;a<o.upload.totalChunkCount;a++)void 0!==o.upload.chunks[a]&&void 0!==o.upload.chunks[a].progress&&(o.upload.progress+=o.upload.chunks[a].progress,o.upload.total+=o.upload.chunks[a].total,o.upload.bytesSent+=o.upload.chunks[a].bytesSent);o.upload.progress=o.upload.progress/o.upload.totalChunkCount}else for(var s=0,c=c=e;!(s>=c.length);){var l=c[s++];l.upload.progress=r,l.upload.total=n.total,l.upload.bytesSent=n.loaded}for(var u=0,d=d=e;!(u>=d.length);){var p=d[u++];this.emit("uploadprogress",p,p.upload.progress,p.upload.bytesSent)}}else{var h=!0;r=100;for(var f=0,m=m=e;!(f>=m.length);){var v=m[f++];100===v.upload.progress&&v.upload.bytesSent===v.upload.total||(h=!1),v.upload.progress=r,v.upload.bytesSent=v.upload.total}if(h)return;for(var g=0,E=E=e;!(g>=E.length);){var y=E[g++];this.emit("uploadprogress",y,r,y.upload.bytesSent)}}}},{key:"_finishedUploading",value:function(t,n,r){var o=void 0;if(t[0].status!==e.CANCELED&&4===n.readyState){if("arraybuffer"!==n.responseType&&"blob"!==n.responseType&&(o=n.responseText,n.getResponseHeader("content-type")&&~n.getResponseHeader("content-type").indexOf("application/json")))try{o=JSON.parse(o)}catch(t){r=t,o="Invalid JSON response from server."}this._updateFilesUploadProgress(t),200<=n.status&&n.status<300?t[0].upload.chunked?t[0].upload.finishedChunkUpload(this._getChunk(t[0],n)):this._finished(t,o,r):this._handleUploadError(t,n,o)}}},{key:"_handleUploadError",value:function(t,n,r){if(t[0].status!==e.CANCELED){if(t[0].upload.chunked&&this.options.retryChunks){var o=this._getChunk(t[0],n);if(o.retries++<this.options.retryChunksLimit)return void this._uploadData(t,[o.dataBlock]);console.warn("Retried this chunk too often. Giving up.")}for(var i=0,a=a=t;!(i>=a.length);)a[i++],this._errorProcessing(t,r||this.options.dictResponseError.replace("{{statusCode}}",n.status),n)}}},{key:"submitRequest",value:function(e,t,n){e.send(t)}},{key:"_finished",value:function(t,n,r){for(var o=0,i=i=t;!(o>=i.length);){var a=i[o++];a.status=e.SUCCESS,this.emit("success",a,n,r),this.emit("complete",a)}if(this.options.uploadMultiple&&(this.emit("successmultiple",t,n,r),this.emit("completemultiple",t)),this.options.autoProcessQueue)return this.processQueue()}},{key:"_errorProcessing",value:function(t,n,r){for(var o=0,i=i=t;!(o>=i.length);){var a=i[o++];a.status=e.ERROR,this.emit("error",a,n,r),this.emit("complete",a)}if(this.options.uploadMultiple&&(this.emit("errormultiple",t,n,r),this.emit("completemultiple",t)),this.options.autoProcessQueue)return this.processQueue()}}],[{key:"uuidv4",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}}]),e}();i.initClass(),i.version="5.4.0",i.options={},i.optionsForElement=function(e){return e.getAttribute("id")?i.options[s(e.getAttribute("id"))]:void 0},i.instances=[],i.forElement=function(e){if("string"==typeof e&&(e=document.querySelector(e)),null==(null!=e?e.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return e.dropzone},i.autoDiscover=!0,i.discover=function(){var e=void 0;if(document.querySelectorAll)e=document.querySelectorAll(".dropzone");else{e=[];var t=function(t){return function(){for(var n=[],r=0,o=o=t;!(r>=o.length);){var i=o[r++];/(^| )dropzone($| )/.test(i.className)?n.push(e.push(i)):n.push(void 0)}return n}()};t(document.getElementsByTagName("div")),t(document.getElementsByTagName("form"))}return function(){for(var t=[],n=0,r=r=e;!(n>=r.length);){var o=r[n++];!1!==i.optionsForElement(o)?t.push(new i(o)):t.push(void 0)}return t}()},i.blacklistedBrowsers=[/opera.*(Macintosh|Windows Phone).*version\/12/i],i.isBrowserSupported=function(){var e=!0;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(var t=0,n=n=i.blacklistedBrowsers;!(t>=n.length);)n[t++].test(navigator.userAgent)&&(e=!1);else e=!1;else e=!1;return e},i.dataURItoBlob=function(e){for(var t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),o=new Uint8Array(r),i=0,a=t.length,s=0<=a;s?i<=a:i>=a;s?i++:i--)o[i]=t.charCodeAt(i);return new Blob([r],{type:n})};var a=function(e,t){return e.filter((function(e){return e!==t})).map((function(e){return e}))},s=function(e){return e.replace(/[\-_](\w)/g,(function(e){return e.charAt(1).toUpperCase()}))};i.createElement=function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes[0]},i.elementInside=function(e,t){if(e===t)return!0;for(;e=e.parentNode;)if(e===t)return!0;return!1},i.getElement=function(e,t){var n=void 0;if("string"==typeof e?n=document.querySelector(e):null!=e.nodeType&&(n=e),null==n)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector or a plain HTML element.");return n},i.getElements=function(e,t){var n=void 0,r=void 0;if(e instanceof Array){r=[];try{for(var o=0,i=i=e;!(o>=i.length);)n=i[o++],r.push(this.getElement(n,t))}catch(e){r=null}}else if("string"==typeof e){r=[];for(var a=0,s=s=document.querySelectorAll(e);!(a>=s.length);)n=s[a++],r.push(n)}else null!=e.nodeType&&(r=[e]);if(null==r||!r.length)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return r},i.confirm=function(e,t,n){return window.confirm(e)?t():null!=n?n():void 0},i.isValidFile=function(e,t){if(!t)return!0;t=t.split(",");for(var n=e.type,r=n.replace(/\/.*$/,""),o=0,i=i=t;!(o>=i.length);){var a=i[o++];if("."===(a=a.trim()).charAt(0)){if(-1!==e.name.toLowerCase().indexOf(a.toLowerCase(),e.name.length-a.length))return!0}else if(/\/\*$/.test(a)){if(r===a.replace(/\/.*$/,""))return!0}else if(n===a)return!0}return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(e){return this.each((function(){return new i(this,e)}))}),void 0!==e&&null!==e?e.exports=i:window.Dropzone=i,i.ADDED="added",i.QUEUED="queued",i.ACCEPTED=i.QUEUED,i.UPLOADING="uploading",i.PROCESSING=i.UPLOADING,i.CANCELED="canceled",i.ERROR="error",i.SUCCESS="success";var c=function(e,t,n,r,o,i,a,s,c,l){var u=function(e){e.naturalWidth;var t=e.naturalHeight,n=document.createElement("canvas");n.width=1,n.height=t;var r=n.getContext("2d");r.drawImage(e,0,0);for(var o=r.getImageData(1,0,1,t).data,i=0,a=t,s=t;s>i;)0===o[4*(s-1)+3]?a=s:i=s,s=a+i>>1;var c=s/t;return 0===c?1:c}(t);return e.drawImage(t,n,r,o,i,a,s,c,l/u)},l=function(){function e(){n(this,e)}return r(e,null,[{key:"initClass",value:function(){this.KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}},{key:"encode64",value:function(e){for(var t="",n=void 0,r=void 0,o="",i=void 0,a=void 0,s=void 0,c="",l=0;i=(n=e[l++])>>2,a=(3&n)<<4|(r=e[l++])>>4,s=(15&r)<<2|(o=e[l++])>>6,c=63&o,isNaN(r)?s=c=64:isNaN(o)&&(c=64),t=t+this.KEY_STR.charAt(i)+this.KEY_STR.charAt(a)+this.KEY_STR.charAt(s)+this.KEY_STR.charAt(c),n=r=o="",i=a=s=c="",l<e.length;);return t}},{key:"restore",value:function(e,t){if(!e.match("data:image/jpeg;base64,"))return t;var n=this.decode64(e.replace("data:image/jpeg;base64,","")),r=this.slice2Segments(n),o=this.exifManipulation(t,r);return"data:image/jpeg;base64,"+this.encode64(o)}},{key:"exifManipulation",value:function(e,t){var n=this.getExifArray(t),r=this.insertExif(e,n);return new Uint8Array(r)}},{key:"getExifArray",value:function(e){for(var t=void 0,n=0;n<e.length;){if(255===(t=e[n])[0]&225===t[1])return t;n++}return[]}},{key:"insertExif",value:function(e,t){var n=e.replace("data:image/jpeg;base64,",""),r=this.decode64(n),o=r.indexOf(255,3),i=r.slice(0,o),a=r.slice(o),s=i;return(s=s.concat(t)).concat(a)}},{key:"slice2Segments",value:function(e){for(var t=0,n=[];!(255===e[t]&218===e[t+1]);){if(255===e[t]&216===e[t+1])t+=2;else{var r=t+(256*e[t+2]+e[t+3])+2,o=e.slice(t,r);n.push(o),t=r}if(t>e.length)break}return n}},{key:"decode64",value:function(e){var t=void 0,n=void 0,r="",o=void 0,i=void 0,a="",s=0,c=[];for(/[^A-Za-z0-9\+\/\=]/g.exec(e)&&console.warn("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");t=this.KEY_STR.indexOf(e.charAt(s++))<<2|(o=this.KEY_STR.indexOf(e.charAt(s++)))>>4,n=(15&o)<<4|(i=this.KEY_STR.indexOf(e.charAt(s++)))>>2,r=(3&i)<<6|(a=this.KEY_STR.indexOf(e.charAt(s++))),c.push(t),64!==i&&c.push(n),64!==a&&c.push(r),t=n=r="",o=i=a="",s<e.length;);return c}}]),e}();l.initClass(),i._autoDiscoverFunction=function(){if(i.autoDiscover)return i.discover()},function(e,t){var n=!1,r=!0,o=e.document,i=o.documentElement,a=o.addEventListener?"addEventListener":"attachEvent",s=o.addEventListener?"removeEventListener":"detachEvent",c=o.addEventListener?"":"on",l=function r(i){if("readystatechange"!==i.type||"complete"===o.readyState)return("load"===i.type?e:o)[s](c+i.type,r,!1),!n&&(n=!0)?t.call(e,i.type||i):void 0};if("complete"!==o.readyState){if(o.createEventObject&&i.doScroll){try{r=!e.frameElement}catch(e){}r&&function e(){try{i.doScroll("left")}catch(t){return void setTimeout(e,50)}return l("poll")}()}o[a](c+"DOMContentLoaded",l,!1),o[a](c+"readystatechange",l,!1),e[a](c+"load",l,!1)}}(window,i._autoDiscoverFunction)}).call(t,n(6)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}}]))},function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Q}));var r=n(3),o=n(127),i=n(128),a=n(129),s=n(130),c=n(2),l=n.n(c),u={},d=[];function p(e,t){}function h(e,t){}function f(e,t,n){t||u[n]||(e(!1,n),u[n]=!0)}function m(e,t){f(p,e,t)}m.preMessage=function(e){d.push(e)},m.resetWarned=function(){u={}},m.noteOnce=function(e,t){f(h,e,t)};var v=m,g=n(34),E=function(e){var t,n,o=e.className,i=e.included,a=e.vertical,s=e.style,c=e.length,u=e.offset,d=e.reverse;c<0&&(d=!d,c=Math.abs(c),u=100-u);var p=a?(t={},Object(g.a)(t,d?"top":"bottom","".concat(u,"%")),Object(g.a)(t,d?"bottom":"top","auto"),Object(g.a)(t,"height","".concat(c,"%")),t):(n={},Object(g.a)(n,d?"right":"left","".concat(u,"%")),Object(g.a)(n,d?"left":"right","auto"),Object(g.a)(n,"width","".concat(c,"%")),n),h=Object(r.a)(Object(r.a)({},s),p);return i?l.a.createElement("div",{className:o,style:h}):null},y=n(11),_=n(137),b=n(216),T=n(292);function S(){return S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Object(T.a)(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},S.apply(null,arguments)}var O=n(19),R=n.n(O);function C(e,t,n,r){var o=R.a.unstable_batchedUpdates?function(e){R.a.unstable_batchedUpdates(n,e)}:n;return null!==e&&void 0!==e&&e.addEventListener&&e.addEventListener(t,o,r),{remove:function(){null!==e&&void 0!==e&&e.removeEventListener&&e.removeEventListener(t,o,r)}}}var w=n(27),I=n.n(w),A=function(e){var t=e.prefixCls,n=e.vertical,o=e.reverse,i=e.marks,a=e.dots,s=e.step,c=e.included,u=e.lowerBound,d=e.upperBound,p=e.max,h=e.min,f=e.dotStyle,m=e.activeDotStyle,E=p-h,y=function(e,t,n,r,o,i){v(!n||r>0,"`Slider[step]` should be a positive number in order to make Slider[dots] work.");var a=Object.keys(t).map(parseFloat).sort((function(e,t){return e-t}));if(n&&r)for(var s=o;s<=i;s+=r)-1===a.indexOf(s)&&a.push(s);return a}(0,i,a,s,h,p).map((function(e){var i,a="".concat(Math.abs(e-h)/E*100,"%"),s=!c&&e===d||c&&e<=d&&e>=u,p=n?Object(r.a)(Object(r.a)({},f),{},Object(g.a)({},o?"top":"bottom",a)):Object(r.a)(Object(r.a)({},f),{},Object(g.a)({},o?"right":"left",a));s&&(p=Object(r.a)(Object(r.a)({},p),m));var v=I()((i={},Object(g.a)(i,"".concat(t,"-dot"),!0),Object(g.a)(i,"".concat(t,"-dot-active"),s),Object(g.a)(i,"".concat(t,"-dot-reverse"),o),i));return l.a.createElement("span",{className:v,style:p,key:e})}));return l.a.createElement("div",{className:"".concat(t,"-step")},y)},N=n(25),k=function(e){var t=e.className,n=e.vertical,o=e.reverse,i=e.marks,a=e.included,s=e.upperBound,c=e.lowerBound,u=e.max,d=e.min,p=e.onClickLabel,h=Object.keys(i),f=u-d,m=h.map(parseFloat).sort((function(e,t){return e-t})).map((function(e){var u,h=i[e],m="object"===Object(N.a)(h)&&!l.a.isValidElement(h),v=m?h.label:h;if(!v&&0!==v)return null;var E=!a&&e===s||a&&e<=s&&e>=c,y=I()((u={},Object(g.a)(u,"".concat(t,"-text"),!0),Object(g.a)(u,"".concat(t,"-text-active"),E),u)),_=Object(g.a)({marginBottom:"-50%"},o?"top":"bottom","".concat((e-d)/f*100,"%")),b=Object(g.a)({transform:"translateX(".concat(o?"50%":"-50%",")"),msTransform:"translateX(".concat(o?"50%":"-50%",")")},o?"right":"left","".concat((e-d)/f*100,"%")),T=n?_:b,S=m?Object(r.a)(Object(r.a)({},T),h.style):T;return l.a.createElement("span",{className:y,style:S,key:e,onMouseDown:function(t){return p(t,e)},onTouchStart:function(t){return p(t,e)}},v)}));return l.a.createElement("div",{className:t},m)},P=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.apply(this,arguments)).state={clickFocused:!1},e.setHandleRef=function(t){e.handle=t},e.handleMouseUp=function(){document.activeElement===e.handle&&e.setClickFocus(!0)},e.handleMouseDown=function(t){t.preventDefault(),e.focus()},e.handleBlur=function(){e.setClickFocus(!1)},e.handleKeyDown=function(){e.setClickFocus(!1)},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.onMouseUpListener=C(document,"mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){this.onMouseUpListener&&this.onMouseUpListener.remove()}},{key:"setClickFocus",value:function(e){this.setState({clickFocused:e})}},{key:"clickFocus",value:function(){this.setClickFocus(!0),this.focus()}},{key:"focus",value:function(){this.handle.focus()}},{key:"blur",value:function(){this.handle.blur()}},{key:"render",value:function(){var e,t,n,o=this.props,i=o.prefixCls,a=o.vertical,s=o.reverse,c=o.offset,u=o.style,d=o.disabled,p=o.min,h=o.max,f=o.value,m=o.tabIndex,v=o.ariaLabel,E=o.ariaLabelledBy,b=o.ariaValueTextFormatter,T=Object(_.a)(o,["prefixCls","vertical","reverse","offset","style","disabled","min","max","value","tabIndex","ariaLabel","ariaLabelledBy","ariaValueTextFormatter"]),S=I()(this.props.className,Object(g.a)({},"".concat(i,"-handle-click-focused"),this.state.clickFocused)),O=a?(e={},Object(g.a)(e,s?"top":"bottom","".concat(c,"%")),Object(g.a)(e,s?"bottom":"top","auto"),Object(g.a)(e,"transform",s?null:"translateY(+50%)"),e):(t={},Object(g.a)(t,s?"right":"left","".concat(c,"%")),Object(g.a)(t,s?"left":"right","auto"),Object(g.a)(t,"transform","translateX(".concat(s?"+":"-","50%)")),t),R=Object(r.a)(Object(r.a)({},u),O),C=m||0;return(d||null===m)&&(C=null),b&&(n=b(f)),l.a.createElement("div",Object(y.a)({ref:this.setHandleRef,tabIndex:C},T,{className:S,style:R,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onMouseDown:this.handleMouseDown,role:"slider","aria-valuemin":p,"aria-valuemax":h,"aria-valuenow":f,"aria-disabled":!!d,"aria-label":v,"aria-labelledby":E,"aria-valuetext":n}))}}]),n}(l.a.Component),D=n(347);function M(e,t){try{return Object.keys(t).some((function(n){return e.target===Object(O.findDOMNode)(t[n])}))}catch(n){return!1}}function L(e,t){var n=t.min,r=t.max;return e<n||e>r}function x(e){return e.touches.length>1||"touchend"===e.type.toLowerCase()&&e.touches.length>0}function U(e,t){var n=t.marks,r=t.step,o=t.min,i=t.max,a=Object.keys(n).map(parseFloat);if(null!==r){var s=Math.pow(10,j(r)),c=Math.floor((i*s-o*s)/(r*s)),l=Math.min((e-o)/r,c),u=Math.round(l)*r+o;a.push(u)}var d=a.map((function(t){return Math.abs(e-t)}));return a[d.indexOf(Math.min.apply(Math,Object(b.a)(d)))]}function j(e){var t=e.toString(),n=0;return t.indexOf(".")>=0&&(n=t.length-t.indexOf(".")-1),n}function F(e,t){return e?t.clientY:t.pageX}function B(e,t){return e?t.touches[0].clientY:t.touches[0].pageX}function V(e,t){var n=t.getBoundingClientRect();return e?n.top+.5*n.height:window.pageXOffset+n.left+.5*n.width}function H(e,t){var n=t.max,r=t.min;return e<=r?r:e>=n?n:e}function G(e,t){var n=t.step,r=isFinite(U(e,t))?U(e,t):0;return null===n?r:parseFloat(r.toFixed(j(n)))}function W(e){e.stopPropagation(),e.preventDefault()}function q(e,t,n){var r="increase",o="decrease",i=r;switch(e.keyCode){case D.a.UP:i=t&&n?o:r;break;case D.a.RIGHT:i=!t&&n?o:r;break;case D.a.DOWN:i=t&&n?r:o;break;case D.a.LEFT:i=!t&&n?r:o;break;case D.a.END:return function(e,t){return t.max};case D.a.HOME:return function(e,t){return t.min};case D.a.PAGE_UP:return function(e,t){return e+2*t.step};case D.a.PAGE_DOWN:return function(e,t){return e-2*t.step};default:return}return function(e,t){return function(e,t,n){var r={increase:function(e,t){return e+t},decrease:function(e,t){return e-t}},o=r[e](Object.keys(n.marks).indexOf(JSON.stringify(t)),1),i=Object.keys(n.marks)[o];return n.step?r[e](t,n.step):Object.keys(n.marks).length&&n.marks[i]?n.marks[i]:t}(i,e,t)}}function K(){}function Y(e){var t;return(t=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e){var r;Object(o.a)(this,n),(r=t.call(this,e)).onDown=function(e,t){var n=t,o=r.props,i=o.draggableTrack,a=o.vertical,s=r.state.bounds,c=i&&r.positionGetValue&&r.positionGetValue(n)||[],l=M(e,r.handlesRefs);if(r.dragTrack=i&&s.length>=2&&!l&&!c.map((function(e,t){var n=!!t||e>=s[t];return t===c.length-1?e<=s[t]:n})).some((function(e){return!e})),r.dragTrack)r.dragOffset=n,r.startBounds=Object(b.a)(s);else{if(l){var u=V(a,e.target);r.dragOffset=n-u,n=u}else r.dragOffset=0;r.onStart(n)}},r.onMouseDown=function(e){if(0===e.button){r.removeDocumentEvents();var t=F(r.props.vertical,e);r.onDown(e,t),r.addDocumentMouseEvents()}},r.onTouchStart=function(e){if(!x(e)){var t=B(r.props.vertical,e);r.onDown(e,t),r.addDocumentTouchEvents(),W(e)}},r.onFocus=function(e){var t=r.props,n=t.onFocus,o=t.vertical;if(M(e,r.handlesRefs)&&!r.dragTrack){var i=V(o,e.target);r.dragOffset=0,r.onStart(i),W(e),n&&n(e)}},r.onBlur=function(e){var t=r.props.onBlur;r.dragTrack||r.onEnd(),t&&t(e)},r.onMouseUp=function(){r.handlesRefs[r.prevMovedHandleIndex]&&r.handlesRefs[r.prevMovedHandleIndex].clickFocus()},r.onMouseMove=function(e){if(r.sliderRef){var t=F(r.props.vertical,e);r.onMove(e,t-r.dragOffset,r.dragTrack,r.startBounds)}else r.onEnd()},r.onTouchMove=function(e){if(!x(e)&&r.sliderRef){var t=B(r.props.vertical,e);r.onMove(e,t-r.dragOffset,r.dragTrack,r.startBounds)}else r.onEnd()},r.onKeyDown=function(e){r.sliderRef&&M(e,r.handlesRefs)&&r.onKeyboard(e)},r.onClickMarkLabel=function(e,t){e.stopPropagation(),r.onChange({value:t}),r.setState({value:t},(function(){return r.onEnd(!0)}))},r.saveSlider=function(e){r.sliderRef=e};var i=e.step,a=e.max,s=e.min,c=!isFinite(a-s)||(a-s)%i===0;return v(!i||Math.floor(i)!==i||c,"Slider[max] - Slider[min] (".concat(a-s,") should be a multiple of Slider[step] (").concat(i,")")),r.handlesRefs={},r}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.document=this.sliderRef&&this.sliderRef.ownerDocument;var e=this.props,t=e.autoFocus,n=e.disabled;t&&!n&&this.focus()}},{key:"componentWillUnmount",value:function(){S(Object(T.a)(n.prototype),"componentWillUnmount",this)&&S(Object(T.a)(n.prototype),"componentWillUnmount",this).call(this),this.removeDocumentEvents()}},{key:"getSliderStart",value:function(){var e=this.sliderRef,t=this.props,n=t.vertical,r=t.reverse,o=e.getBoundingClientRect();return n?r?o.bottom:o.top:window.pageXOffset+(r?o.right:o.left)}},{key:"getSliderLength",value:function(){var e=this.sliderRef;if(!e)return 0;var t=e.getBoundingClientRect();return this.props.vertical?t.height:t.width}},{key:"addDocumentTouchEvents",value:function(){this.onTouchMoveListener=C(this.document,"touchmove",this.onTouchMove),this.onTouchUpListener=C(this.document,"touchend",this.onEnd)}},{key:"addDocumentMouseEvents",value:function(){this.onMouseMoveListener=C(this.document,"mousemove",this.onMouseMove),this.onMouseUpListener=C(this.document,"mouseup",this.onEnd)}},{key:"removeDocumentEvents",value:function(){this.onTouchMoveListener&&this.onTouchMoveListener.remove(),this.onTouchUpListener&&this.onTouchUpListener.remove(),this.onMouseMoveListener&&this.onMouseMoveListener.remove(),this.onMouseUpListener&&this.onMouseUpListener.remove()}},{key:"focus",value:function(){var e;this.props.disabled||null===(e=this.handlesRefs[0])||void 0===e||e.focus()}},{key:"blur",value:function(){var e=this;this.props.disabled||Object.keys(this.handlesRefs).forEach((function(t){var n,r;null===(n=e.handlesRefs[t])||void 0===n||null===(r=n.blur)||void 0===r||r.call(n)}))}},{key:"calcValue",value:function(e){var t=this.props,n=t.vertical,r=t.min,o=t.max,i=Math.abs(Math.max(e,0)/this.getSliderLength());return n?(1-i)*(o-r)+r:i*(o-r)+r}},{key:"calcValueByPos",value:function(e){var t=(this.props.reverse?-1:1)*(e-this.getSliderStart());return this.trimAlignValue(this.calcValue(t))}},{key:"calcOffset",value:function(e){var t=this.props,n=t.min,r=(e-n)/(t.max-n);return Math.max(0,100*r)}},{key:"saveHandle",value:function(e,t){this.handlesRefs[e]=t}},{key:"render",value:function(){var e,t=this.props,o=t.prefixCls,i=t.className,a=t.marks,s=t.dots,c=t.step,u=t.included,d=t.disabled,p=t.vertical,h=t.reverse,f=t.min,m=t.max,v=t.children,E=t.maximumTrackStyle,y=t.style,_=t.railStyle,b=t.dotStyle,O=t.activeDotStyle,R=S(Object(T.a)(n.prototype),"render",this).call(this),C=R.tracks,w=R.handles,N=I()(o,(e={},Object(g.a)(e,"".concat(o,"-with-marks"),Object.keys(a).length),Object(g.a)(e,"".concat(o,"-disabled"),d),Object(g.a)(e,"".concat(o,"-vertical"),p),Object(g.a)(e,i,i),e));return l.a.createElement("div",{ref:this.saveSlider,className:N,onTouchStart:d?K:this.onTouchStart,onMouseDown:d?K:this.onMouseDown,onMouseUp:d?K:this.onMouseUp,onKeyDown:d?K:this.onKeyDown,onFocus:d?K:this.onFocus,onBlur:d?K:this.onBlur,style:y},l.a.createElement("div",{className:"".concat(o,"-rail"),style:Object(r.a)(Object(r.a)({},E),_)}),C,l.a.createElement(A,{prefixCls:o,vertical:p,reverse:h,marks:a,dots:s,step:c,included:u,lowerBound:this.getLowerBound(),upperBound:this.getUpperBound(),max:m,min:f,dotStyle:b,activeDotStyle:O}),w,l.a.createElement(k,{className:"".concat(o,"-mark"),onClickLabel:d?K:this.onClickMarkLabel,vertical:p,marks:a,included:u,lowerBound:this.getLowerBound(),upperBound:this.getUpperBound(),max:m,min:f,reverse:h}),v)}}]),n}(e)).displayName="ComponentEnhancer(".concat(e.displayName,")"),t.defaultProps=Object(r.a)(Object(r.a)({},e.defaultProps),{},{prefixCls:"rc-slider",className:"",min:0,max:100,step:1,marks:{},handle:function(e){var t=e.index,n=Object(_.a)(e,["index"]);return delete n.dragging,null===n.value?null:l.a.createElement(P,Object(y.a)({},n,{key:t}))},onBeforeChange:K,onChange:K,onAfterChange:K,included:!0,disabled:!1,dots:!1,vertical:!1,reverse:!1,trackStyle:[{}],handleStyle:[{}],railStyle:{},dotStyle:{},activeDotStyle:{}}),t}var z=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e){var r;Object(o.a)(this,n),(r=t.call(this,e)).positionGetValue=function(e){return[]},r.onEnd=function(e){var t=r.state.dragging;r.removeDocumentEvents(),(t||e)&&r.props.onAfterChange(r.getValue()),r.setState({dragging:!1})};var i=void 0!==e.defaultValue?e.defaultValue:e.min,a=void 0!==e.value?e.value:i;return r.state={value:r.trimAlignValue(a),dragging:!1},v(!("minimumTrackStyle"in e),"minimumTrackStyle will be deprecated, please use trackStyle instead."),v(!("maximumTrackStyle"in e),"maximumTrackStyle will be deprecated, please use railStyle instead."),r}return Object(i.a)(n,[{key:"calcValueByPos",value:function(e){return 0}},{key:"calcOffset",value:function(e){return 0}},{key:"saveHandle",value:function(e,t){}},{key:"removeDocumentEvents",value:function(){}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,r=n.min,o=n.max,i=n.value,a=n.onChange;if("min"in this.props||"max"in this.props){var s=void 0!==i?i:t.value,c=this.trimAlignValue(s,this.props);c!==t.value&&(this.setState({value:c}),r===e.min&&o===e.max||!L(s,this.props)||a(c))}}},{key:"onChange",value:function(e){var t=this.props,n=!("value"in t),o=e.value>this.props.max?Object(r.a)(Object(r.a)({},e),{},{value:this.props.max}):e;n&&this.setState(o);var i=o.value;t.onChange(i)}},{key:"onStart",value:function(e){this.setState({dragging:!0});var t=this.props,n=this.getValue();t.onBeforeChange(n);var r=this.calcValueByPos(e);this.startValue=r,this.startPosition=e,r!==n&&(this.prevMovedHandleIndex=0,this.onChange({value:r}))}},{key:"onMove",value:function(e,t){W(e);var n=this.state.value,r=this.calcValueByPos(t);r!==n&&this.onChange({value:r})}},{key:"onKeyboard",value:function(e){var t=this.props,n=t.reverse,r=q(e,t.vertical,n);if(r){W(e);var o=this.state.value,i=r(o,this.props),a=this.trimAlignValue(i);if(a===o)return;this.onChange({value:a}),this.props.onAfterChange(a),this.onEnd()}}},{key:"getValue",value:function(){return this.state.value}},{key:"getLowerBound",value:function(){var e=this.props.startPoint||this.props.min;return this.state.value>e?e:this.state.value}},{key:"getUpperBound",value:function(){return this.state.value<this.props.startPoint?this.props.startPoint:this.state.value}},{key:"trimAlignValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null===e)return null;var n=Object(r.a)(Object(r.a)({},this.props),t);return G(H(e,n),n)}},{key:"render",value:function(){var e=this,t=this.props,n=t.prefixCls,o=t.vertical,i=t.included,a=t.disabled,s=t.minimumTrackStyle,c=t.trackStyle,u=t.handleStyle,d=t.tabIndex,p=t.ariaLabelForHandle,h=t.ariaLabelledByForHandle,f=t.ariaValueTextFormatterForHandle,m=t.min,v=t.max,g=t.startPoint,y=t.reverse,_=t.handle,b=this.state,T=b.value,S=b.dragging,O=this.calcOffset(T),R=_({className:"".concat(n,"-handle"),prefixCls:n,vertical:o,offset:O,value:T,dragging:S,disabled:a,min:m,max:v,reverse:y,index:0,tabIndex:d,ariaLabel:p,ariaLabelledBy:h,ariaValueTextFormatter:f,style:u[0]||u,ref:function(t){return e.saveHandle(0,t)}}),C=void 0!==g?this.calcOffset(g):0,w=c[0]||c;return{tracks:l.a.createElement(E,{className:"".concat(n,"-track"),vertical:o,included:i,offset:C,reverse:y,length:O-C,style:Object(r.a)(Object(r.a)({},s),w)}),handles:R}}}]),n}(l.a.Component),X=Y(z),J=function(e){var t=e.value,n=e.handle,r=e.bounds,o=e.props,i=o.allowCross,a=o.pushable,s=Number(a),c=H(t,o),l=c;return i||null==n||void 0===r||(n>0&&c<=r[n-1]+s&&(l=r[n-1]+s),n<r.length-1&&c>=r[n+1]-s&&(l=r[n+1]-s)),G(l,o)},Z=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e){var r;Object(o.a)(this,n),(r=t.call(this,e)).positionGetValue=function(e){var t=r.getValue(),n=r.calcValueByPos(e),o=r.getClosestBound(n),i=r.getBoundNeedMoving(n,o);if(n===t[i])return null;var a=Object(b.a)(t);return a[i]=n,a},r.onEnd=function(e){var t=r.state.handle;r.removeDocumentEvents(),t||(r.dragTrack=!1),(null!==t||e)&&r.props.onAfterChange(r.getValue()),r.setState({handle:null})};var i=e.count,a=e.min,s=e.max,c=Array.apply(void 0,Object(b.a)(Array(i+1))).map((function(){return a})),l="defaultValue"in e?e.defaultValue:c,u=(void 0!==e.value?e.value:l).map((function(t,n){return J({value:t,handle:n,props:e})})),d=u[0]===s?0:u.length-1;return r.state={handle:null,recent:d,bounds:u},r}return Object(i.a)(n,[{key:"calcValueByPos",value:function(e){return 0}},{key:"getSliderLength",value:function(){return 0}},{key:"calcOffset",value:function(e){return 0}},{key:"saveHandle",value:function(e,t){}},{key:"removeDocumentEvents",value:function(){}},{key:"componentDidUpdate",value:function(e,t){var n=this,r=this.props,o=r.onChange,i=r.value,a=r.min,s=r.max;if(("min"in this.props||"max"in this.props)&&(a!==e.min||s!==e.max)){var c=i||t.bounds;if(c.some((function(e){return L(e,n.props)})))o(c.map((function(e){return H(e,n.props)})))}}},{key:"onChange",value:function(e){var t=this.props;if(!("value"in t))this.setState(e);else{var n={};["handle","recent"].forEach((function(t){void 0!==e[t]&&(n[t]=e[t])})),Object.keys(n).length&&this.setState(n)}var o=Object(r.a)(Object(r.a)({},this.state),e).bounds;t.onChange(o)}},{key:"onStart",value:function(e){var t=this.props,n=this.state,r=this.getValue();t.onBeforeChange(r);var o=this.calcValueByPos(e);this.startValue=o,this.startPosition=e;var i=this.getClosestBound(o);if(this.prevMovedHandleIndex=this.getBoundNeedMoving(o,i),this.setState({handle:this.prevMovedHandleIndex,recent:this.prevMovedHandleIndex}),o!==r[this.prevMovedHandleIndex]){var a=Object(b.a)(n.bounds);a[this.prevMovedHandleIndex]=o,this.onChange({bounds:a})}}},{key:"onMove",value:function(e,t,n,r){W(e);var o=this.state,i=this.props,a=i.max||100,s=i.min||0;if(n){var c=i.vertical?-t:t;c=i.reverse?-c:c;var l=a-Math.max.apply(Math,Object(b.a)(r)),u=s-Math.min.apply(Math,Object(b.a)(r)),d=Math.min(Math.max(c/(this.getSliderLength()/(a-s)),u),l),p=r.map((function(e){return Math.floor(Math.max(Math.min(e+d,a),s))}));o.bounds.map((function(e,t){return e===p[t]})).some((function(e){return!e}))&&this.onChange({bounds:p})}else{var h=this.calcValueByPos(t);h!==o.bounds[o.handle]&&this.moveTo(h)}}},{key:"onKeyboard",value:function(e){var t=this.props,n=t.reverse,r=q(e,t.vertical,n);if(r){W(e);var o=this.state,i=this.props,a=o.bounds,s=o.handle,c=a[null===s?o.recent:s],l=r(c,i),u=J({value:l,handle:s,bounds:o.bounds,props:i});if(u===c)return;this.moveTo(u,!0)}}},{key:"getValue",value:function(){return this.state.bounds}},{key:"getClosestBound",value:function(e){for(var t=this.state.bounds,n=0,r=1;r<t.length-1;r+=1)e>=t[r]&&(n=r);return Math.abs(t[n+1]-e)<Math.abs(t[n]-e)&&(n+=1),n}},{key:"getBoundNeedMoving",value:function(e,t){var n=this.state,r=n.bounds,o=n.recent,i=t,a=r[t+1]===r[t];return a&&r[o]===r[t]&&(i=o),a&&e!==r[t+1]&&(i=e<r[t+1]?t:t+1),i}},{key:"getLowerBound",value:function(){return this.state.bounds[0]}},{key:"getUpperBound",value:function(){var e=this.state.bounds;return e[e.length-1]}},{key:"getPoints",value:function(){var e=this.props,t=e.marks,n=e.step,o=e.min,i=e.max,a=this.internalPointsCache;if(!a||a.marks!==t||a.step!==n){var s=Object(r.a)({},t);if(null!==n)for(var c=o;c<=i;c+=n)s[c]=c;var l=Object.keys(s).map(parseFloat);l.sort((function(e,t){return e-t})),this.internalPointsCache={marks:t,step:n,points:l}}return this.internalPointsCache.points}},{key:"moveTo",value:function(e,t){var n=this,r=this.state,o=this.props,i=Object(b.a)(r.bounds),a=null===r.handle?r.recent:r.handle;i[a]=e;var s=a;!1!==o.pushable?this.pushSurroundingHandles(i,s):o.allowCross&&(i.sort((function(e,t){return e-t})),s=i.indexOf(e)),this.onChange({recent:s,handle:s,bounds:i}),t&&(this.props.onAfterChange(i),this.setState({},(function(){n.handlesRefs[s].focus()})),this.onEnd())}},{key:"pushSurroundingHandles",value:function(e,t){var n=e[t],r=this.props.pushable,o=Number(r),i=0;if(e[t+1]-n<o&&(i=1),n-e[t-1]<o&&(i=-1),0!==i){var a=t+i,s=i*(e[a]-n);this.pushHandle(e,a,i,o-s)||(e[t]=e[a]-i*o)}}},{key:"pushHandle",value:function(e,t,n,r){for(var o=e[t],i=e[t];n*(i-o)<r;){if(!this.pushHandleOnePoint(e,t,n))return e[t]=o,!1;i=e[t]}return!0}},{key:"pushHandleOnePoint",value:function(e,t,n){var r=this.getPoints(),o=r.indexOf(e[t])+n;if(o>=r.length||o<0)return!1;var i=t+n,a=r[o],s=this.props.pushable,c=Number(s),l=n*(e[i]-a);return!!this.pushHandle(e,i,n,c-l)&&(e[t]=a,!0)}},{key:"trimAlignValue",value:function(e){var t=this.state,n=t.handle,r=t.bounds;return J({value:e,handle:n,bounds:r,props:this.props})}},{key:"render",value:function(){var e=this,t=this.state,n=t.handle,r=t.bounds,o=this.props,i=o.prefixCls,a=o.vertical,s=o.included,c=o.disabled,u=o.min,d=o.max,p=o.reverse,h=o.handle,f=o.trackStyle,m=o.handleStyle,v=o.tabIndex,y=o.ariaLabelGroupForHandles,_=o.ariaLabelledByGroupForHandles,b=o.ariaValueTextFormatterGroupForHandles,T=r.map((function(t){return e.calcOffset(t)})),S="".concat(i,"-handle"),O=r.map((function(t,r){var o,s=v[r]||0;(c||null===v[r])&&(s=null);var l=n===r;return h({className:I()((o={},Object(g.a)(o,S,!0),Object(g.a)(o,"".concat(S,"-").concat(r+1),!0),Object(g.a)(o,"".concat(S,"-dragging"),l),o)),prefixCls:i,vertical:a,dragging:l,offset:T[r],value:t,index:r,tabIndex:s,min:u,max:d,reverse:p,disabled:c,style:m[r],ref:function(t){return e.saveHandle(r,t)},ariaLabel:y[r],ariaLabelledBy:_[r],ariaValueTextFormatter:b[r]})}));return{tracks:r.slice(0,-1).map((function(e,t){var n,r=t+1,o=I()((n={},Object(g.a)(n,"".concat(i,"-track"),!0),Object(g.a)(n,"".concat(i,"-track-").concat(r),!0),n));return l.a.createElement(E,{className:o,vertical:a,reverse:p,included:s,offset:T[r-1],length:T[r]-T[r-1],style:f[t],key:r})})),handles:O}}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(!("value"in e||"min"in e||"max"in e))return null;var n=e.value||t.bounds,o=n.map((function(n,r){return J({value:n,handle:r,bounds:t.bounds,props:e})}));if(t.bounds.length===o.length){if(o.every((function(e,n){return e===t.bounds[n]})))return null}else o=n.map((function(t,n){return J({value:t,handle:n,props:e})}));return Object(r.a)(Object(r.a)({},t),{},{bounds:o})}}]),n}(l.a.Component);Z.displayName="Range",Z.defaultProps={count:1,allowCross:!0,pushable:!1,draggableTrack:!1,tabIndex:[],ariaLabelGroupForHandles:[],ariaLabelledByGroupForHandles:[],ariaValueTextFormatterGroupForHandles:[]};var Q=Y(Z),$=n(35),ee=function(e){return+setTimeout(e,16)},te=function(e){return clearTimeout(e)};"undefined"!==typeof window&&"requestAnimationFrame"in window&&(ee=function(e){return window.requestAnimationFrame(e)},te=function(e){return window.cancelAnimationFrame(e)});var ne=0,re=new Map;function oe(e){re.delete(e)}var ie=function(e){var t=ne+=1;return function n(r){if(0===r)oe(t),e();else{var o=ee((function(){n(r-1)}));re.set(t,o)}}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),t};ie.cancel=function(e){var t=re.get(e);return oe(e),te(t)};var ae=ie;function se(e,t){if(!e)return!1;if(e.contains)return e.contains(t);for(var n=t;n;){if(n===e)return!0;n=n.parentNode}return!1}function ce(e){return e instanceof HTMLElement||e instanceof SVGElement}function le(e){var t,n=function(e){return e&&"object"===Object(N.a)(e)&&ce(e.nativeElement)?e.nativeElement:ce(e)?e:null}(e);return n||(e instanceof l.a.Component?null===(t=R.a.findDOMNode)||void 0===t?void 0:t.call(R.a,e):null)}var ue=n(571);var de=Symbol.for("react.element"),pe=Symbol.for("react.transitional.element"),he=Symbol.for("react.fragment");var fe=function(e,t){"function"===typeof e?e(t):"object"===Object(N.a)(e)&&e&&"current"in e&&(e.current=t)},me=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.filter(Boolean);return r.length<=1?r[0]:function(e){t.forEach((function(t){fe(t,e)}))}},ve=function(e){var t,n;if(!e)return!1;if(ge(e)&&e.props.propertyIsEnumerable("ref"))return!0;var r=Object(ue.isMemo)(e)?e.type.type:e.type;return!!("function"!==typeof r||null!==(t=r.prototype)&&void 0!==t&&t.render||r.$$typeof===ue.ForwardRef)&&!!("function"!==typeof e||null!==(n=e.prototype)&&void 0!==n&&n.render||e.$$typeof===ue.ForwardRef)};function ge(e){return Object(c.isValidElement)(e)&&!((t=e)&&"object"===Object(N.a)(t)&&(t.$$typeof===de||t.$$typeof===pe)&&t.type===he);var t}var Ee=n(226),ye=Object(c.forwardRef)((function(e,t){var n=e.didUpdate,r=e.getContainer,o=e.children,i=Object(c.useRef)(),a=Object(c.useRef)();Object(c.useImperativeHandle)(t,(function(){return{}}));var s=Object(c.useRef)(!1);return!s.current&&Object(Ee.a)()&&(a.current=r(),i.current=a.current.parentNode,s.current=!0),Object(c.useEffect)((function(){null===n||void 0===n||n(e)})),Object(c.useEffect)((function(){return null===a.current.parentNode&&null!==i.current&&i.current.appendChild(a.current),function(){var e;null===(e=a.current)||void 0===e||null===(e=e.parentNode)||void 0===e||e.removeChild(a.current)}}),[]),a.current?R.a.createPortal(o,a.current):null}));function _e(e,t,n){return n?e[0]===t[0]:e[0]===t[0]&&e[1]===t[1]}var be=n(148),Te=c.createContext({});var Se=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return this.props.children}}]),n}(c.Component),Oe=Se,Re=n(225);n(272);n(344),n(389),n(224),n(346);"undefined"===typeof Reflect?Object.keys:Reflect.ownKeys;var Ce=n(227);var we="none",Ie="appear",Ae="enter",Ne="leave",ke="none",Pe="prepare",De="start",Me="active",Le="end",xe="prepared";function Ue(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit".concat(e)]="webkit".concat(t),n["Moz".concat(e)]="moz".concat(t),n["ms".concat(e)]="MS".concat(t),n["O".concat(e)]="o".concat(t.toLowerCase()),n}var je=function(e,t){var n={animationend:Ue("Animation","AnimationEnd"),transitionend:Ue("Transition","TransitionEnd")};return e&&("AnimationEvent"in t||delete n.animationend.animation,"TransitionEvent"in t||delete n.transitionend.transition),n}(Object(Ee.a)(),"undefined"!==typeof window?window:{}),Fe={};if(Object(Ee.a)()){var Be=document.createElement("div");Fe=Be.style}var Ve={};function He(e){if(Ve[e])return Ve[e];var t=je[e];if(t)for(var n=Object.keys(t),r=n.length,o=0;o<r;o+=1){var i=n[o];if(Object.prototype.hasOwnProperty.call(t,i)&&i in Fe)return Ve[e]=t[i],Ve[e]}return""}var Ge=He("animationend"),We=He("transitionend"),qe=!(!Ge||!We),Ke=Ge||"animationend",Ye=We||"transitionend";function ze(e,t){return e?"object"===Object(N.a)(e)?e[t.replace(/-\w/g,(function(e){return e[1].toUpperCase()}))]:"".concat(e,"-").concat(t):null}var Xe=Object(Ee.a)()?c.useLayoutEffect:c.useEffect,Je=[Pe,De,Me,Le],Ze=[Pe,xe],Qe=!1;function $e(e){return e===Me||e===Le}var et=function(e,t,n){var r=Object(Ce.a)(ke),o=Object(be.a)(r,2),i=o[0],a=o[1],s=function(){var e=c.useRef(null);function t(){ae.cancel(e.current)}return c.useEffect((function(){return function(){t()}}),[]),[function n(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;t();var i=ae((function(){o<=1?r({isCanceled:function(){return i!==e.current}}):n(r,o-1)}));e.current=i},t]}(),l=Object(be.a)(s,2),u=l[0],d=l[1];var p=t?Ze:Je;return Xe((function(){if(i!==ke&&i!==Le){var e=p.indexOf(i),t=p[e+1],r=n(i);r===Qe?a(t,!0):t&&u((function(e){function n(){e.isCanceled()||a(t,!0)}!0===r?n():Promise.resolve(r).then(n)}))}}),[e,i]),c.useEffect((function(){return function(){d()}}),[]),[function(){a(Pe,!0)},i]};function tt(e,t,n,o){var i=o.motionEnter,a=void 0===i||i,s=o.motionAppear,l=void 0===s||s,u=o.motionLeave,d=void 0===u||u,p=o.motionDeadline,h=o.motionLeaveImmediately,f=o.onAppearPrepare,m=o.onEnterPrepare,v=o.onLeavePrepare,E=o.onAppearStart,y=o.onEnterStart,_=o.onLeaveStart,b=o.onAppearActive,T=o.onEnterActive,S=o.onLeaveActive,O=o.onAppearEnd,R=o.onEnterEnd,C=o.onLeaveEnd,w=o.onVisibleChanged,I=Object(Ce.a)(),A=Object(be.a)(I,2),N=A[0],k=A[1],P=function(e){var t=c.useReducer((function(e){return e+1}),0),n=Object(be.a)(t,2)[1],r=c.useRef(e);return[Object(Re.a)((function(){return r.current})),Object(Re.a)((function(e){r.current="function"===typeof e?e(r.current):e,n()}))]}(we),D=Object(be.a)(P,2),M=D[0],L=D[1],x=Object(Ce.a)(null),U=Object(be.a)(x,2),j=U[0],F=U[1],B=M(),V=Object(c.useRef)(!1),H=Object(c.useRef)(null);function G(){return n()}var W=Object(c.useRef)(!1);function q(){L(we),F(null,!0)}var K=Object(Re.a)((function(e){var t=M();if(t!==we){var n=G();if(!e||e.deadline||e.target===n){var r,o=W.current;t===Ie&&o?r=null===O||void 0===O?void 0:O(n,e):t===Ae&&o?r=null===R||void 0===R?void 0:R(n,e):t===Ne&&o&&(r=null===C||void 0===C?void 0:C(n,e)),o&&!1!==r&&q()}}})),Y=function(e){var t=Object(c.useRef)();function n(t){t&&(t.removeEventListener(Ye,e),t.removeEventListener(Ke,e))}return c.useEffect((function(){return function(){n(t.current)}}),[]),[function(r){t.current&&t.current!==r&&n(t.current),r&&r!==t.current&&(r.addEventListener(Ye,e),r.addEventListener(Ke,e),t.current=r)},n]}(K),z=Object(be.a)(Y,1)[0],X=function(e){switch(e){case Ie:return Object(g.a)(Object(g.a)(Object(g.a)({},Pe,f),De,E),Me,b);case Ae:return Object(g.a)(Object(g.a)(Object(g.a)({},Pe,m),De,y),Me,T);case Ne:return Object(g.a)(Object(g.a)(Object(g.a)({},Pe,v),De,_),Me,S);default:return{}}},J=c.useMemo((function(){return X(B)}),[B]),Z=et(B,!e,(function(e){if(e===Pe){var t=J[Pe];return t?t(G()):Qe}var n;ee in J&&F((null===(n=J[ee])||void 0===n?void 0:n.call(J,G(),null))||null);return ee===Me&&B!==we&&(z(G()),p>0&&(clearTimeout(H.current),H.current=setTimeout((function(){K({deadline:!0})}),p))),ee===xe&&q(),true})),Q=Object(be.a)(Z,2),$=Q[0],ee=Q[1],te=$e(ee);W.current=te;var ne=Object(c.useRef)(null);Xe((function(){if(!V.current||ne.current!==t){k(t);var n,r=V.current;V.current=!0,!r&&t&&l&&(n=Ie),r&&t&&a&&(n=Ae),(r&&!t&&d||!r&&h&&!t&&d)&&(n=Ne);var o=X(n);n&&(e||o[Pe])?(L(n),$()):L(we),ne.current=t}}),[t]),Object(c.useEffect)((function(){(B===Ie&&!l||B===Ae&&!a||B===Ne&&!d)&&L(we)}),[l,a,d]),Object(c.useEffect)((function(){return function(){V.current=!1,clearTimeout(H.current)}}),[]);var re=c.useRef(!1);Object(c.useEffect)((function(){N&&(re.current=!0),void 0!==N&&B===we&&((re.current||N)&&(null===w||void 0===w||w(N)),re.current=!0)}),[N,B]);var oe=j;return J[Pe]&&ee===De&&(oe=Object(r.a)({transition:"none"},oe)),[B,ee,oe,null!==N&&void 0!==N?N:t]}var nt=function(e){var t=e;"object"===Object(N.a)(e)&&(t=e.transitionSupport);var n=c.forwardRef((function(e,n){var o=e.visible,i=void 0===o||o,a=e.removeOnLeave,s=void 0===a||a,l=e.forceRender,u=e.children,d=e.motionName,p=e.leavedClassName,h=e.eventProps,f=function(e,n){return!(!e.motionName||!t||!1===n)}(e,c.useContext(Te).motion),m=Object(c.useRef)(),v=Object(c.useRef)();var E=tt(f,i,(function(){try{return m.current instanceof HTMLElement?m.current:le(v.current)}catch(e){return null}}),e),y=Object(be.a)(E,4),_=y[0],b=y[1],T=y[2],S=y[3],O=c.useRef(S);S&&(O.current=!0);var R,C=c.useCallback((function(e){m.current=e,fe(n,e)}),[n]),w=Object(r.a)(Object(r.a)({},h),{},{visible:i});if(u)if(_===we)R=S?u(Object(r.a)({},w),C):!s&&O.current&&p?u(Object(r.a)(Object(r.a)({},w),{},{className:p}),C):l||!s&&!p?u(Object(r.a)(Object(r.a)({},w),{},{style:{display:"none"}}),C):null;else{var A;b===Pe?A="prepare":$e(b)?A="active":b===De&&(A="start");var N=ze(d,"".concat(_,"-").concat(A));R=u(Object(r.a)(Object(r.a)({},w),{},{className:I()(ze(d,_),Object(g.a)(Object(g.a)({},N,N&&A),d,"string"===typeof d)),style:T}),C)}else R=null;c.isValidElement(R)&&ve(R)&&(function(e){if(e&&ge(e)){var t=e;return t.props.propertyIsEnumerable("ref")?t.props.ref:t.ref}return null}(R)||(R=c.cloneElement(R,{ref:C})));return c.createElement(Oe,{ref:v},R)}));return n.displayName="CSSMotion",n}(qe),rt="add",ot="keep",it="remove",at="removed";function st(e){var t;return t=e&&"object"===Object(N.a)(e)&&"key"in e?e:{key:e},Object(r.a)(Object(r.a)({},t),{},{key:String(t.key)})}function ct(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(st)}var lt=["component","children","onVisibleChanged","onAllRemoved"],ut=["status"],dt=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];!function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nt,t=function(t){Object(a.a)(l,t);var n=Object(s.a)(l);function l(){var e;Object(o.a)(this,l);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return e=n.call.apply(n,[this].concat(i)),Object(g.a)(Object($.a)(e),"state",{keyEntities:[]}),Object(g.a)(Object($.a)(e),"removeKey",(function(t){e.setState((function(e){return{keyEntities:e.keyEntities.map((function(e){return e.key!==t?e:Object(r.a)(Object(r.a)({},e),{},{status:at})}))}}),(function(){0===e.state.keyEntities.filter((function(e){return e.status!==at})).length&&e.props.onAllRemoved&&e.props.onAllRemoved()}))})),e}return Object(i.a)(l,[{key:"render",value:function(){var t=this,n=this.state.keyEntities,o=this.props,i=o.component,a=o.children,s=o.onVisibleChanged,l=(o.onAllRemoved,Object(_.a)(o,lt)),u=i||c.Fragment,d={};return dt.forEach((function(e){d[e]=l[e],delete l[e]})),delete l.keys,c.createElement(u,l,n.map((function(n,o){var i=n.status,l=Object(_.a)(n,ut),u=i===rt||i===ot;return c.createElement(e,Object(y.a)({},d,{key:l.key,visible:u,eventProps:l,onVisibleChanged:function(e){null===s||void 0===s||s(e,{key:l.key}),e||t.removeKey(l.key)}}),(function(e,t){return a(Object(r.a)(Object(r.a)({},e),{},{index:o}),t)}))})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.keys,o=t.keyEntities,i=ct(n),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],o=0,i=t.length,a=ct(e),s=ct(t);a.forEach((function(e){for(var t=!1,a=o;a<i;a+=1){var c=s[a];if(c.key===e.key){o<a&&(n=n.concat(s.slice(o,a).map((function(e){return Object(r.a)(Object(r.a)({},e),{},{status:rt})}))),o=a),n.push(Object(r.a)(Object(r.a)({},c),{},{status:ot})),o+=1,t=!0;break}}t||n.push(Object(r.a)(Object(r.a)({},e),{},{status:it}))})),o<i&&(n=n.concat(s.slice(o).map((function(e){return Object(r.a)(Object(r.a)({},e),{},{status:rt})}))));var c={};return n.forEach((function(e){var t=e.key;c[t]=(c[t]||0)+1})),Object.keys(c).filter((function(e){return c[e]>1})).forEach((function(e){(n=n.filter((function(t){var n=t.key,r=t.status;return n!==e||r!==it}))).forEach((function(t){t.key===e&&(t.status=ot)}))})),n}(o,i);return{keyEntities:a.filter((function(e){var t=o.find((function(t){var n=t.key;return e.key===n}));return!t||t.status!==at||e.status!==it}))}}}]),l}(c.Component);Object(g.a)(t,"defaultProps",{component:"div"})}(qe);var pt,ht=nt;function ft(e){var t=e.prefixCls,n=e.motion,r=e.animation,o=e.transitionName;return n||(r?{motionName:"".concat(t,"-").concat(r)}:o?{motionName:o}:null)}function mt(e){var t=e.prefixCls,n=e.visible,o=e.zIndex,i=e.mask,a=e.maskMotion,s=e.maskAnimation,l=e.maskTransitionName;if(!i)return null;var u={};return(a||l||s)&&(u=Object(r.a)({motionAppear:!0},ft({motion:a,prefixCls:t,transitionName:l,animation:s}))),c.createElement(ht,Object(y.a)({},u,{visible:n,removeOnLeave:!0}),(function(e){var n=e.className;return c.createElement("div",{style:{zIndex:o},className:I()("".concat(t,"-mask"),n)})}))}function vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vt(Object(n),!0).forEach((function(t){yt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Et(e){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Et(e)}function yt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _t={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-",O:"-o-"};function bt(){if(void 0!==pt)return pt;pt="";var e=document.createElement("p").style;for(var t in _t)t+"Transform"in e&&(pt=t);return pt}function Tt(){return bt()?"".concat(bt(),"TransitionProperty"):"transitionProperty"}function St(){return bt()?"".concat(bt(),"Transform"):"transform"}function Ot(e,t){var n=Tt();n&&(e.style[n]=t,"transitionProperty"!==n&&(e.style.transitionProperty=t))}function Rt(e,t){var n=St();n&&(e.style[n]=t,"transform"!==n&&(e.style.transform=t))}var Ct,wt=/matrix\((.*)\)/,It=/matrix3d\((.*)\)/;function At(e){var t=e.style.display;e.style.display="none",e.offsetHeight,e.style.display=t}function Nt(e,t,n){var r=n;if("object"!==Et(t))return"undefined"!==typeof r?("number"===typeof r&&(r="".concat(r,"px")),void(e.style[t]=r)):Ct(e,t);for(var o in t)t.hasOwnProperty(o)&&Nt(e,o,t[o])}function kt(e,t){var n=e["page".concat(t?"Y":"X","Offset")],r="scroll".concat(t?"Top":"Left");if("number"!==typeof n){var o=e.document;"number"!==typeof(n=o.documentElement[r])&&(n=o.body[r])}return n}function Pt(e){return kt(e)}function Dt(e){return kt(e,!0)}function Mt(e){var t=function(e){var t,n,r,o=e.ownerDocument,i=o.body,a=o&&o.documentElement;return t=e.getBoundingClientRect(),n=Math.floor(t.left),r=Math.floor(t.top),{left:n-=a.clientLeft||i.clientLeft||0,top:r-=a.clientTop||i.clientTop||0}}(e),n=e.ownerDocument,r=n.defaultView||n.parentWindow;return t.left+=Pt(r),t.top+=Dt(r),t}function Lt(e){return null!==e&&void 0!==e&&e==e.window}function xt(e){return Lt(e)?e.document:9===e.nodeType?e:e.ownerDocument}var Ut=new RegExp("^(".concat(/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,")(?!px)[a-z%]+$"),"i"),jt=/^(top|right|bottom|left)$/,Ft="currentStyle",Bt="runtimeStyle",Vt="left";function Ht(e,t){return"left"===e?t.useCssRight?"right":e:t.useCssBottom?"bottom":e}function Gt(e){return"left"===e?"right":"right"===e?"left":"top"===e?"bottom":"bottom"===e?"top":void 0}function Wt(e,t,n){"static"===Nt(e,"position")&&(e.style.position="relative");var r=-999,o=-999,i=Ht("left",n),a=Ht("top",n),s=Gt(i),c=Gt(a);"left"!==i&&(r=999),"top"!==a&&(o=999);var l,u="",d=Mt(e);("left"in t||"top"in t)&&(u=(l=e).style.transitionProperty||l.style[Tt()]||"",Ot(e,"none")),"left"in t&&(e.style[s]="",e.style[i]="".concat(r,"px")),"top"in t&&(e.style[c]="",e.style[a]="".concat(o,"px")),At(e);var p=Mt(e),h={};for(var f in t)if(t.hasOwnProperty(f)){var m=Ht(f,n),v="left"===f?r:o,g=d[f]-p[f];h[m]=m===f?v+g:v-g}Nt(e,h),At(e),("left"in t||"top"in t)&&Ot(e,u);var E={};for(var y in t)if(t.hasOwnProperty(y)){var _=Ht(y,n),b=t[y]-d[y];E[_]=y===_?h[_]+b:h[_]-b}Nt(e,E)}function qt(e,t){var n=Mt(e),r=function(e){var t=window.getComputedStyle(e,null),n=t.getPropertyValue("transform")||t.getPropertyValue(St());if(n&&"none"!==n){var r=n.replace(/[^0-9\-.,]/g,"").split(",");return{x:parseFloat(r[12]||r[4],0),y:parseFloat(r[13]||r[5],0)}}return{x:0,y:0}}(e),o={x:r.x,y:r.y};"left"in t&&(o.x=r.x+t.left-n.left),"top"in t&&(o.y=r.y+t.top-n.top),function(e,t){var n=window.getComputedStyle(e,null),r=n.getPropertyValue("transform")||n.getPropertyValue(St());if(r&&"none"!==r){var o,i=r.match(wt);i?((o=(i=i[1]).split(",").map((function(e){return parseFloat(e,10)})))[4]=t.x,o[5]=t.y,Rt(e,"matrix(".concat(o.join(","),")"))):((o=r.match(It)[1].split(",").map((function(e){return parseFloat(e,10)})))[12]=t.x,o[13]=t.y,Rt(e,"matrix3d(".concat(o.join(","),")")))}else Rt(e,"translateX(".concat(t.x,"px) translateY(").concat(t.y,"px) translateZ(0)"))}(e,o)}function Kt(e,t){for(var n=0;n<e.length;n++)t(e[n])}function Yt(e){return"border-box"===Ct(e,"boxSizing")}"undefined"!==typeof window&&(Ct=window.getComputedStyle?function(e,t,n){var r=n,o="",i=xt(e);return(r=r||i.defaultView.getComputedStyle(e,null))&&(o=r.getPropertyValue(t)||r[t]),o}:function(e,t){var n=e[Ft]&&e[Ft][t];if(Ut.test(n)&&!jt.test(t)){var r=e.style,o=r[Vt],i=e[Bt][Vt];e[Bt][Vt]=e[Ft][Vt],r[Vt]="fontSize"===t?"1em":n||0,n=r.pixelLeft+"px",r[Vt]=o,e[Bt][Vt]=i}return""===n?"auto":n});var zt=["margin","border","padding"];function Xt(e,t,n){var r,o,i,a=0;for(o=0;o<t.length;o++)if(r=t[o])for(i=0;i<n.length;i++){var s=void 0;s="border"===r?"".concat(r).concat(n[i],"Width"):r+n[i],a+=parseFloat(Ct(e,s))||0}return a}var Jt={getParent:function(e){var t=e;do{t=11===t.nodeType&&t.host?t.host:t.parentNode}while(t&&1!==t.nodeType&&9!==t.nodeType);return t}};function Zt(e,t,n){var r=n;if(Lt(e))return"width"===t?Jt.viewportWidth(e):Jt.viewportHeight(e);if(9===e.nodeType)return"width"===t?Jt.docWidth(e):Jt.docHeight(e);var o="width"===t?["Left","Right"]:["Top","Bottom"],i="width"===t?Math.floor(e.getBoundingClientRect().width):Math.floor(e.getBoundingClientRect().height),a=Yt(e),s=0;(null===i||void 0===i||i<=0)&&(i=void 0,(null===(s=Ct(e,t))||void 0===s||Number(s)<0)&&(s=e.style[t]||0),s=Math.floor(parseFloat(s))||0),void 0===r&&(r=a?1:-1);var c=void 0!==i||a,l=i||s;return-1===r?c?l-Xt(e,["border","padding"],o):s:c?1===r?l:l+(2===r?-Xt(e,["border"],o):Xt(e,["margin"],o)):s+Xt(e,zt.slice(r),o)}Kt(["Width","Height"],(function(e){Jt["doc".concat(e)]=function(t){var n=t.document;return Math.max(n.documentElement["scroll".concat(e)],n.body["scroll".concat(e)],Jt["viewport".concat(e)](n))},Jt["viewport".concat(e)]=function(t){var n="client".concat(e),r=t.document,o=r.body,i=r.documentElement[n];return"CSS1Compat"===r.compatMode&&i||o&&o[n]||i}}));var Qt={position:"absolute",visibility:"hidden",display:"block"};function $t(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,o=t[0];return 0!==o.offsetWidth?r=Zt.apply(void 0,t):function(e,t,n){var r,o={},i=e.style;for(r in t)t.hasOwnProperty(r)&&(o[r]=i[r],i[r]=t[r]);for(r in n.call(e),t)t.hasOwnProperty(r)&&(i[r]=o[r])}(o,Qt,(function(){r=Zt.apply(void 0,t)})),r}function en(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}Kt(["width","height"],(function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);Jt["outer".concat(t)]=function(t,n){return t&&$t(t,e,n?0:1)};var n="width"===e?["Left","Right"]:["Top","Bottom"];Jt[e]=function(t,r){var o=r;return void 0!==o?t?(Yt(t)&&(o+=Xt(t,["padding","border"],n)),Nt(t,e,o)):void 0:t&&$t(t,e,-1)}}));var tn={getWindow:function(e){if(e&&e.document&&e.setTimeout)return e;var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getDocument:xt,offset:function(e,t,n){if("undefined"===typeof t)return Mt(e);!function(e,t,n){if(n.ignoreShake){var r=Mt(e),o=r.left.toFixed(0),i=r.top.toFixed(0),a=t.left.toFixed(0),s=t.top.toFixed(0);if(o===a&&i===s)return}n.useCssRight||n.useCssBottom?Wt(e,t,n):n.useCssTransform&&St()in document.body.style?qt(e,t):Wt(e,t,n)}(e,t,n||{})},isWindow:Lt,each:Kt,css:Nt,clone:function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);if(e.overflow)for(t in e)e.hasOwnProperty(t)&&(n.overflow[t]=e.overflow[t]);return n},mix:en,getWindowScrollLeft:function(e){return Pt(e)},getWindowScrollTop:function(e){return Dt(e)},merge:function(){for(var e={},t=0;t<arguments.length;t++)tn.mix(e,t<0||arguments.length<=t?void 0:arguments[t]);return e},viewportWidth:0,viewportHeight:0};en(tn,Jt);var nn=tn.getParent;function rn(e){if(tn.isWindow(e)||9===e.nodeType)return null;var t,n=tn.getDocument(e).body,r=tn.css(e,"position");if(!("fixed"===r||"absolute"===r))return"html"===e.nodeName.toLowerCase()?null:nn(e);for(t=nn(e);t&&t!==n&&9!==t.nodeType;t=nn(t))if("static"!==(r=tn.css(t,"position")))return t;return null}var on=tn.getParent;function an(e,t){for(var n={left:0,right:1/0,top:0,bottom:1/0},r=rn(e),o=tn.getDocument(e),i=o.defaultView||o.parentWindow,a=o.body,s=o.documentElement;r;){if(-1!==navigator.userAgent.indexOf("MSIE")&&0===r.clientWidth||r===a||r===s||"visible"===tn.css(r,"overflow")){if(r===a||r===s)break}else{var c=tn.offset(r);c.left+=r.clientLeft,c.top+=r.clientTop,n.top=Math.max(n.top,c.top),n.right=Math.min(n.right,c.left+r.clientWidth),n.bottom=Math.min(n.bottom,c.top+r.clientHeight),n.left=Math.max(n.left,c.left)}r=rn(r)}var l=null;tn.isWindow(e)||9===e.nodeType||(l=e.style.position,"absolute"===tn.css(e,"position")&&(e.style.position="fixed"));var u=tn.getWindowScrollLeft(i),d=tn.getWindowScrollTop(i),p=tn.viewportWidth(i),h=tn.viewportHeight(i),f=s.scrollWidth,m=s.scrollHeight,v=window.getComputedStyle(a);if("hidden"===v.overflowX&&(f=i.innerWidth),"hidden"===v.overflowY&&(m=i.innerHeight),e.style&&(e.style.position=l),t||function(e){if(tn.isWindow(e)||9===e.nodeType)return!1;var t=tn.getDocument(e),n=t.body,r=null;for(r=on(e);r&&r!==n&&r!==t;r=on(r))if("fixed"===tn.css(r,"position"))return!0;return!1}(e))n.left=Math.max(n.left,u),n.top=Math.max(n.top,d),n.right=Math.min(n.right,u+p),n.bottom=Math.min(n.bottom,d+h);else{var g=Math.max(f,u+p);n.right=Math.min(n.right,g);var E=Math.max(m,d+h);n.bottom=Math.min(n.bottom,E)}return n.top>=0&&n.left>=0&&n.bottom>n.top&&n.right>n.left?n:null}function sn(e){var t,n,r;if(tn.isWindow(e)||9===e.nodeType){var o=tn.getWindow(e);t={left:tn.getWindowScrollLeft(o),top:tn.getWindowScrollTop(o)},n=tn.viewportWidth(o),r=tn.viewportHeight(o)}else t=tn.offset(e),n=tn.outerWidth(e),r=tn.outerHeight(e);return t.width=n,t.height=r,t}function cn(e,t){var n=t.charAt(0),r=t.charAt(1),o=e.width,i=e.height,a=e.left,s=e.top;return"c"===n?s+=i/2:"b"===n&&(s+=i),"c"===r?a+=o/2:"r"===r&&(a+=o),{left:a,top:s}}function ln(e,t,n,r,o){var i=cn(t,n[1]),a=cn(e,n[0]),s=[a.left-i.left,a.top-i.top];return{left:Math.round(e.left-s[0]+r[0]-o[0]),top:Math.round(e.top-s[1]+r[1]-o[1])}}function un(e,t,n){return e.left<n.left||e.left+t.width>n.right}function dn(e,t,n){return e.top<n.top||e.top+t.height>n.bottom}function pn(e,t,n){var r=[];return tn.each(e,(function(e){r.push(e.replace(t,(function(e){return n[e]})))})),r}function hn(e,t){return e[t]=-e[t],e}function fn(e,t){return(/%$/.test(e)?parseInt(e.substring(0,e.length-1),10)/100*t:parseInt(e,10))||0}function mn(e,t){e[0]=fn(e[0],t.width),e[1]=fn(e[1],t.height)}function vn(e,t,n,r){var o=n.points,i=n.offset||[0,0],a=n.targetOffset||[0,0],s=n.overflow,c=n.source||e;i=[].concat(i),a=[].concat(a);var l={},u=0,d=an(c,!(!(s=s||{})||!s.alwaysByViewport)),p=sn(c);mn(i,p),mn(a,t);var h=ln(p,t,o,i,a),f=tn.merge(p,h);if(d&&(s.adjustX||s.adjustY)&&r){if(s.adjustX&&un(h,p,d)){var m=pn(o,/[lr]/gi,{l:"r",r:"l"}),v=hn(i,0),g=hn(a,0);(function(e,t,n){return e.left>n.right||e.left+t.width<n.left})(ln(p,t,m,v,g),p,d)||(u=1,o=m,i=v,a=g)}if(s.adjustY&&dn(h,p,d)){var E=pn(o,/[tb]/gi,{t:"b",b:"t"}),y=hn(i,1),_=hn(a,1);(function(e,t,n){return e.top>n.bottom||e.top+t.height<n.top})(ln(p,t,E,y,_),p,d)||(u=1,o=E,i=y,a=_)}u&&(h=ln(p,t,o,i,a),tn.mix(f,h));var b=un(h,p,d),T=dn(h,p,d);if(b||T){var S=o;b&&(S=pn(o,/[lr]/gi,{l:"r",r:"l"})),T&&(S=pn(o,/[tb]/gi,{t:"b",b:"t"})),o=S,i=n.offset||[0,0],a=n.targetOffset||[0,0]}l.adjustX=s.adjustX&&b,l.adjustY=s.adjustY&&T,(l.adjustX||l.adjustY)&&(f=function(e,t,n,r){var o=tn.clone(e),i={width:t.width,height:t.height};return r.adjustX&&o.left<n.left&&(o.left=n.left),r.resizeWidth&&o.left>=n.left&&o.left+i.width>n.right&&(i.width-=o.left+i.width-n.right),r.adjustX&&o.left+i.width>n.right&&(o.left=Math.max(n.right-i.width,n.left)),r.adjustY&&o.top<n.top&&(o.top=n.top),r.resizeHeight&&o.top>=n.top&&o.top+i.height>n.bottom&&(i.height-=o.top+i.height-n.bottom),r.adjustY&&o.top+i.height>n.bottom&&(o.top=Math.max(n.bottom-i.height,n.top)),tn.mix(o,i)}(h,p,d,l))}return f.width!==p.width&&tn.css(c,"width",tn.width(c)+f.width-p.width),f.height!==p.height&&tn.css(c,"height",tn.height(c)+f.height-p.height),tn.offset(c,{left:f.left,top:f.top},{useCssRight:n.useCssRight,useCssBottom:n.useCssBottom,useCssTransform:n.useCssTransform,ignoreShake:n.ignoreShake}),{points:o,offset:i,targetOffset:a,overflow:l}}function gn(e,t,n){var r=n.target||t,o=sn(r),i=!function(e,t){var n=an(e,t),r=sn(e);return!n||r.left+r.width<=n.left||r.top+r.height<=n.top||r.left>=n.right||r.top>=n.bottom}(r,n.overflow&&n.overflow.alwaysByViewport);return vn(e,o,n,i)}gn.__getOffsetParent=rn,gn.__getVisibleRectForElement=an;var En=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=new Set;return function e(t,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=r.has(t);if(v(!a,"Warning: There may be circular references"),a)return!1;if(t===o)return!0;if(n&&i>1)return!1;r.add(t);var s=i+1;if(Array.isArray(t)){if(!Array.isArray(o)||t.length!==o.length)return!1;for(var c=0;c<t.length;c++)if(!e(t[c],o[c],s))return!1;return!0}if(t&&o&&"object"===Object(N.a)(t)&&"object"===Object(N.a)(o)){var l=Object.keys(t);return l.length===Object.keys(o).length&&l.every((function(n){return e(t[n],o[n],s)}))}return!1}(e,t)},yn=n(273),_n=n(573);function bn(e,t){var n=null,r=null;var o=new _n.a((function(e){var o=Object(be.a)(e,1)[0].target;if(document.documentElement.contains(o)){var i=o.getBoundingClientRect(),a=i.width,s=i.height,c=Math.floor(a),l=Math.floor(s);n===c&&r===l||Promise.resolve().then((function(){t({width:c,height:l})})),n=c,r=l}}));return e&&o.observe(e),function(){o.disconnect()}}function Tn(e){return"function"!==typeof e?null:e()}function Sn(e){return"object"===Object(N.a)(e)&&e?e:null}var On=function(e,t){var n=e.children,r=e.disabled,o=e.target,i=e.align,a=e.onAlign,s=e.monitorWindowResize,c=e.monitorBufferTime,u=void 0===c?0:c,d=l.a.useRef({}),p=l.a.useRef(),h=l.a.Children.only(n),f=l.a.useRef({});f.current.disabled=r,f.current.target=o,f.current.align=i,f.current.onAlign=a;var m=function(e,t){var n=l.a.useRef(!1),r=l.a.useRef(null);function o(){window.clearTimeout(r.current)}return[function i(a){if(o(),n.current&&!0!==a)r.current=window.setTimeout((function(){n.current=!1,i()}),t);else{if(!1===e(a))return;n.current=!0,r.current=window.setTimeout((function(){n.current=!1}),t)}},function(){n.current=!1,o()}]}((function(){var e=f.current,t=e.disabled,n=e.target,r=e.align,o=e.onAlign,i=p.current;if(!t&&n&&i){var a,s=Tn(n),c=Sn(n);d.current.element=s,d.current.point=c,d.current.align=r;var l=document.activeElement;return s&&function(e){if(!e)return!1;if(e instanceof Element){if(e.offsetParent)return!0;if(e.getBBox){var t=e.getBBox(),n=t.width,r=t.height;if(n||r)return!0}if(e.getBoundingClientRect){var o=e.getBoundingClientRect(),i=o.width,a=o.height;if(i||a)return!0}}return!1}(s)?a=gn(i,s,r):c&&(a=function(e,t,n){var r,o,i=tn.getDocument(e),a=i.defaultView||i.parentWindow,s=tn.getWindowScrollLeft(a),c=tn.getWindowScrollTop(a),l=tn.viewportWidth(a),u=tn.viewportHeight(a),d={left:r="pageX"in t?t.pageX:s+t.clientX,top:o="pageY"in t?t.pageY:c+t.clientY,width:0,height:0},p=r>=0&&r<=s+l&&o>=0&&o<=c+u,h=[n.points[0],"cc"];return vn(e,d,gt(gt({},n),{},{points:h}),p)}(i,c,r)),function(e,t){e!==document.activeElement&&se(t,e)&&"function"===typeof e.focus&&e.focus()}(l,i),o&&a&&o(i,a),!0}return!1}),u),v=Object(be.a)(m,2),g=v[0],E=v[1],y=l.a.useState(),_=Object(be.a)(y,2),b=_[0],T=_[1],S=l.a.useState(),O=Object(be.a)(S,2),R=O[0],w=O[1];return Object(yn.a)((function(){T(Tn(o)),w(Sn(o))})),l.a.useEffect((function(){var e,t;d.current.element===b&&((e=d.current.point)===(t=R)||e&&t&&("pageX"in t&&"pageY"in t?e.pageX===t.pageX&&e.pageY===t.pageY:"clientX"in t&&"clientY"in t&&e.clientX===t.clientX&&e.clientY===t.clientY))&&En(d.current.align,i)||g()})),l.a.useEffect((function(){return bn(p.current,g)}),[p.current]),l.a.useEffect((function(){return bn(b,g)}),[b]),l.a.useEffect((function(){r?E():g()}),[r]),l.a.useEffect((function(){if(s)return C(window,"resize",g).remove}),[s]),l.a.useEffect((function(){return function(){E()}}),[]),l.a.useImperativeHandle(t,(function(){return{forceAlign:function(){return g(!0)}}})),l.a.isValidElement(h)&&(h=l.a.cloneElement(h,{ref:me(h.ref,p)})),h},Rn=l.a.forwardRef(On);Rn.displayName="Align";var Cn=Rn;function wn(){wn=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof g?t:g,a=Object.create(i.prototype),s=new k(r||[]);return o(a,"_invoke",{value:C(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var p="suspendedStart",h="suspendedYield",f="executing",m="completed",v={};function g(){}function E(){}function y(){}var _={};l(_,a,(function(){return this}));var b=Object.getPrototypeOf,T=b&&b(b(P([])));T&&T!==n&&r.call(T,a)&&(_=T);var S=y.prototype=g.prototype=Object.create(_);function O(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function n(o,i,a,s){var c=d(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==Object(N.a)(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function C(t,n,r){var o=p;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=w(s,r);if(c){if(c===v)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=f;var l=d(t,n,r);if("normal"===l.type){if(o=r.done?m:h,l.arg===v)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=m,r.method="throw",r.arg=l.arg)}}}function w(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,w(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=d(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(Object(N.a)(t)+" is not iterable")}return E.prototype=y,o(S,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:E,configurable:!0}),E.displayName=l(y,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===E||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,c,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},O(R.prototype),l(R.prototype,s,(function(){return this})),t.AsyncIterator=R,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new R(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(S),l(S,c,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return s.type="throw",s.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;A(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}function In(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function An(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){In(i,r,o,a,s,"next",e)}function s(e){In(i,r,o,a,s,"throw",e)}a(void 0)}))}}var Nn=["measure","alignPre","align",null,"motion"],kn=c.forwardRef((function(e,t){var n=e.visible,o=e.prefixCls,i=e.className,a=e.style,s=e.children,l=e.zIndex,u=e.stretch,d=e.destroyPopupOnHide,p=e.forceRender,h=e.align,f=e.point,m=e.getRootDomNode,v=e.getClassNameFromAlign,g=e.onAlign,E=e.onMouseEnter,_=e.onMouseLeave,b=e.onMouseDown,T=e.onTouchStart,S=e.onClick,O=Object(c.useRef)(),R=Object(c.useRef)(),C=Object(c.useState)(),w=Object(be.a)(C,2),A=w[0],N=w[1],k=function(e){var t=c.useState({width:0,height:0}),n=Object(be.a)(t,2),r=n[0],o=n[1];return[c.useMemo((function(){var t={};if(e){var n=r.width,o=r.height;-1!==e.indexOf("height")&&o?t.height=o:-1!==e.indexOf("minHeight")&&o&&(t.minHeight=o),-1!==e.indexOf("width")&&n?t.width=n:-1!==e.indexOf("minWidth")&&n&&(t.minWidth=n)}return t}),[e,r]),function(e){var t=e.offsetWidth,n=e.offsetHeight,r=e.getBoundingClientRect(),i=r.width,a=r.height;Math.abs(t-i)<1&&Math.abs(n-a)<1&&(t=i,n=a),o({width:t,height:n})}]}(u),P=Object(be.a)(k,2),D=P[0],M=P[1];var L=function(e,t){var n=Object(Ce.a)(null),r=Object(be.a)(n,2),o=r[0],i=r[1],a=Object(c.useRef)();function s(e){i(e,!0)}function l(){ae.cancel(a.current)}return Object(c.useEffect)((function(){s("measure")}),[e]),Object(c.useEffect)((function(){"measure"===o&&t(),o&&(a.current=ae(An(wn().mark((function e(){var t,n;return wn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Nn.indexOf(o),(n=Nn[t+1])&&-1!==t&&s(n);case 3:case"end":return e.stop()}}),e)})))))}),[o]),Object(c.useEffect)((function(){return function(){l()}}),[]),[o,function(e){l(),a.current=ae((function(){s((function(e){switch(o){case"align":return"motion";case"motion":return"stable"}return e})),null===e||void 0===e||e()}))}]}(n,(function(){u&&M(m())})),x=Object(be.a)(L,2),U=x[0],j=x[1],F=Object(c.useState)(0),B=Object(be.a)(F,2),V=B[0],H=B[1],G=Object(c.useRef)();function W(){var e;null===(e=O.current)||void 0===e||e.forceAlign()}function q(e,t){var n=v(t);A!==n&&N(n),H((function(e){return e+1})),"align"===U&&(null===g||void 0===g||g(e,t))}Object(yn.a)((function(){"alignPre"===U&&H(0)}),[U]),Object(yn.a)((function(){"align"===U&&(V<3?W():j((function(){var e;null===(e=G.current)||void 0===e||e.call(G)})))}),[V]);var K=Object(r.a)({},ft(e));function Y(){return new Promise((function(e){G.current=e}))}["onAppearEnd","onEnterEnd","onLeaveEnd"].forEach((function(e){var t=K[e];K[e]=function(e,n){return j(),null===t||void 0===t?void 0:t(e,n)}})),c.useEffect((function(){K.motionName||"motion"!==U||j()}),[K.motionName,U]),c.useImperativeHandle(t,(function(){return{forceAlign:W,getElement:function(){return R.current}}}));var z=Object(r.a)(Object(r.a)({},D),{},{zIndex:l,opacity:"motion"!==U&&"stable"!==U&&n?0:void 0,pointerEvents:n||"stable"===U?void 0:"none"},a),X=!0;null===h||void 0===h||!h.points||"align"!==U&&"stable"!==U||(X=!1);var J=s;return c.Children.count(s)>1&&(J=c.createElement("div",{className:"".concat(o,"-content")},s)),c.createElement(ht,Object(y.a)({visible:n,ref:R,leavedClassName:"".concat(o,"-hidden")},K,{onAppearPrepare:Y,onEnterPrepare:Y,removeOnLeave:d,forceRender:p}),(function(e,t){var n=e.className,a=e.style,s=I()(o,i,A,n);return c.createElement(Cn,{target:f||m,key:"popup",ref:O,monitorWindowResize:!0,disabled:X,align:h,onAlign:q},c.createElement("div",{ref:t,className:s,onMouseEnter:E,onMouseLeave:_,onMouseDownCapture:b,onTouchStartCapture:T,onClick:S,style:Object(r.a)(Object(r.a)({},a),z)},J))}))}));kn.displayName="PopupInner";var Pn=kn,Dn=c.forwardRef((function(e,t){var n=e.prefixCls,o=e.visible,i=e.zIndex,a=e.children,s=e.mobile,l=(s=void 0===s?{}:s).popupClassName,u=s.popupStyle,d=s.popupMotion,p=void 0===d?{}:d,h=s.popupRender,f=e.onClick,m=c.useRef();c.useImperativeHandle(t,(function(){return{forceAlign:function(){},getElement:function(){return m.current}}}));var v=Object(r.a)({zIndex:i},u),g=a;return c.Children.count(a)>1&&(g=c.createElement("div",{className:"".concat(n,"-content")},a)),h&&(g=h(g)),c.createElement(ht,Object(y.a)({visible:o,ref:m,removeOnLeave:!0},p),(function(e,t){var o=e.className,i=e.style,a=I()(n,l,o);return c.createElement("div",{ref:t,className:a,onClick:f,style:Object(r.a)(Object(r.a)({},i),v)},g)}))}));Dn.displayName="MobilePopupInner";var Mn=Dn,Ln=["visible","mobile"],xn=c.forwardRef((function(e,t){var n=e.visible,o=e.mobile,i=Object(_.a)(e,Ln),a=Object(c.useState)(n),s=Object(be.a)(a,2),l=s[0],u=s[1],d=Object(c.useState)(!1),p=Object(be.a)(d,2),h=p[0],f=p[1],m=Object(r.a)(Object(r.a)({},i),{},{visible:l});Object(c.useEffect)((function(){u(n),n&&o&&f(function(){if("undefined"===typeof navigator||"undefined"===typeof window)return!1;var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(null===e||void 0===e?void 0:e.substr(0,4))}())}),[n,o]);var v=h?c.createElement(Mn,Object(y.a)({},m,{mobile:o,ref:t})):c.createElement(Pn,Object(y.a)({},m,{ref:t}));return c.createElement("div",null,c.createElement(mt,m),v)}));xn.displayName="Popup";var Un=xn,jn=c.createContext(null);function Fn(){}function Bn(){return""}function Vn(e){return e?e.ownerDocument:window.document}var Hn=["onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur","onContextMenu"];var Gn=function(e){var t=function(t){Object(a.a)(l,t);var n=Object(s.a)(l);function l(e){var t,r;return Object(o.a)(this,l),t=n.call(this,e),Object(g.a)(Object($.a)(t),"popupRef",c.createRef()),Object(g.a)(Object($.a)(t),"triggerRef",c.createRef()),Object(g.a)(Object($.a)(t),"portalContainer",void 0),Object(g.a)(Object($.a)(t),"attachId",void 0),Object(g.a)(Object($.a)(t),"clickOutsideHandler",void 0),Object(g.a)(Object($.a)(t),"touchOutsideHandler",void 0),Object(g.a)(Object($.a)(t),"contextMenuOutsideHandler1",void 0),Object(g.a)(Object($.a)(t),"contextMenuOutsideHandler2",void 0),Object(g.a)(Object($.a)(t),"mouseDownTimeout",void 0),Object(g.a)(Object($.a)(t),"focusTime",void 0),Object(g.a)(Object($.a)(t),"preClickTime",void 0),Object(g.a)(Object($.a)(t),"preTouchTime",void 0),Object(g.a)(Object($.a)(t),"delayTimer",void 0),Object(g.a)(Object($.a)(t),"hasPopupMouseDown",void 0),Object(g.a)(Object($.a)(t),"onMouseEnter",(function(e){var n=t.props.mouseEnterDelay;t.fireEvents("onMouseEnter",e),t.delaySetPopupVisible(!0,n,n?null:e)})),Object(g.a)(Object($.a)(t),"onMouseMove",(function(e){t.fireEvents("onMouseMove",e),t.setPoint(e)})),Object(g.a)(Object($.a)(t),"onMouseLeave",(function(e){t.fireEvents("onMouseLeave",e),t.delaySetPopupVisible(!1,t.props.mouseLeaveDelay)})),Object(g.a)(Object($.a)(t),"onPopupMouseEnter",(function(){t.clearDelayTimer()})),Object(g.a)(Object($.a)(t),"onPopupMouseLeave",(function(e){var n;e.relatedTarget&&!e.relatedTarget.setTimeout&&se(null===(n=t.popupRef.current)||void 0===n?void 0:n.getElement(),e.relatedTarget)||t.delaySetPopupVisible(!1,t.props.mouseLeaveDelay)})),Object(g.a)(Object($.a)(t),"onFocus",(function(e){t.fireEvents("onFocus",e),t.clearDelayTimer(),t.isFocusToShow()&&(t.focusTime=Date.now(),t.delaySetPopupVisible(!0,t.props.focusDelay))})),Object(g.a)(Object($.a)(t),"onMouseDown",(function(e){t.fireEvents("onMouseDown",e),t.preClickTime=Date.now()})),Object(g.a)(Object($.a)(t),"onTouchStart",(function(e){t.fireEvents("onTouchStart",e),t.preTouchTime=Date.now()})),Object(g.a)(Object($.a)(t),"onBlur",(function(e){t.fireEvents("onBlur",e),t.clearDelayTimer(),t.isBlurToHide()&&t.delaySetPopupVisible(!1,t.props.blurDelay)})),Object(g.a)(Object($.a)(t),"onContextMenu",(function(e){e.preventDefault(),t.fireEvents("onContextMenu",e),t.setPopupVisible(!0,e)})),Object(g.a)(Object($.a)(t),"onContextMenuClose",(function(){t.isContextMenuToShow()&&t.close()})),Object(g.a)(Object($.a)(t),"onClick",(function(e){if(t.fireEvents("onClick",e),t.focusTime){var n;if(t.preClickTime&&t.preTouchTime?n=Math.min(t.preClickTime,t.preTouchTime):t.preClickTime?n=t.preClickTime:t.preTouchTime&&(n=t.preTouchTime),Math.abs(n-t.focusTime)<20)return;t.focusTime=0}t.preClickTime=0,t.preTouchTime=0,t.isClickToShow()&&(t.isClickToHide()||t.isBlurToHide())&&e&&e.preventDefault&&e.preventDefault();var r=!t.state.popupVisible;(t.isClickToHide()&&!r||r&&t.isClickToShow())&&t.setPopupVisible(!t.state.popupVisible,e)})),Object(g.a)(Object($.a)(t),"onPopupMouseDown",(function(){var e;(t.hasPopupMouseDown=!0,clearTimeout(t.mouseDownTimeout),t.mouseDownTimeout=window.setTimeout((function(){t.hasPopupMouseDown=!1}),0),t.context)&&(e=t.context).onPopupMouseDown.apply(e,arguments)})),Object(g.a)(Object($.a)(t),"onDocumentClick",(function(e){if(!t.props.mask||t.props.maskClosable){var n=e.target,r=t.getRootDomNode(),o=t.getPopupDomNode();se(r,n)&&!t.isContextMenuOnly()||se(o,n)||t.hasPopupMouseDown||t.close()}})),Object(g.a)(Object($.a)(t),"getRootDomNode",(function(){var e=t.props.getTriggerDOMNode;if(e)return e(t.triggerRef.current);try{var n=le(t.triggerRef.current);if(n)return n}catch(r){}return R.a.findDOMNode(Object($.a)(t))})),Object(g.a)(Object($.a)(t),"getPopupClassNameFromAlign",(function(e){var n=[],r=t.props,o=r.popupPlacement,i=r.builtinPlacements,a=r.prefixCls,s=r.alignPoint,c=r.getPopupClassNameFromAlign;return o&&i&&n.push(function(e,t,n,r){for(var o=n.points,i=Object.keys(e),a=0;a<i.length;a+=1){var s=i[a];if(_e(e[s].points,o,r))return"".concat(t,"-placement-").concat(s)}return""}(i,a,e,s)),c&&n.push(c(e)),n.join(" ")})),Object(g.a)(Object($.a)(t),"getComponent",(function(){var e=t.props,n=e.prefixCls,r=e.destroyPopupOnHide,o=e.popupClassName,i=e.onPopupAlign,a=e.popupMotion,s=e.popupAnimation,l=e.popupTransitionName,u=e.popupStyle,d=e.mask,p=e.maskAnimation,h=e.maskTransitionName,f=e.maskMotion,m=e.zIndex,v=e.popup,g=e.stretch,E=e.alignPoint,_=e.mobile,b=e.forceRender,T=e.onPopupClick,S=t.state,O=S.popupVisible,R=S.point,C=t.getPopupAlign(),w={};return t.isMouseEnterToShow()&&(w.onMouseEnter=t.onPopupMouseEnter),t.isMouseLeaveToHide()&&(w.onMouseLeave=t.onPopupMouseLeave),w.onMouseDown=t.onPopupMouseDown,w.onTouchStart=t.onPopupMouseDown,c.createElement(Un,Object(y.a)({prefixCls:n,destroyPopupOnHide:r,visible:O,point:E&&R,className:o,align:C,onAlign:i,animation:s,getClassNameFromAlign:t.getPopupClassNameFromAlign},w,{stretch:g,getRootDomNode:t.getRootDomNode,style:u,mask:d,zIndex:m,transitionName:l,maskAnimation:p,maskTransitionName:h,maskMotion:f,ref:t.popupRef,motion:a,mobile:_,forceRender:b,onClick:T}),"function"===typeof v?v():v)})),Object(g.a)(Object($.a)(t),"attachParent",(function(e){ae.cancel(t.attachId);var n,r=t.props,o=r.getPopupContainer,i=r.getDocument,a=t.getRootDomNode();o?(a||0===o.length)&&(n=o(a)):n=i(t.getRootDomNode()).body,n?n.appendChild(e):t.attachId=ae((function(){t.attachParent(e)}))})),Object(g.a)(Object($.a)(t),"getContainer",(function(){if(!t.portalContainer){var e=(0,t.props.getDocument)(t.getRootDomNode()).createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",t.portalContainer=e}return t.attachParent(t.portalContainer),t.portalContainer})),Object(g.a)(Object($.a)(t),"setPoint",(function(e){t.props.alignPoint&&e&&t.setState({point:{pageX:e.pageX,pageY:e.pageY}})})),Object(g.a)(Object($.a)(t),"handlePortalUpdate",(function(){t.state.prevPopupVisible!==t.state.popupVisible&&t.props.afterPopupVisibleChange(t.state.popupVisible)})),Object(g.a)(Object($.a)(t),"triggerContextValue",{onPopupMouseDown:t.onPopupMouseDown}),r="popupVisible"in e?!!e.popupVisible:!!e.defaultPopupVisible,t.state={prevPopupVisible:r,popupVisible:r},Hn.forEach((function(e){t["fire".concat(e)]=function(n){t.fireEvents(e,n)}})),t}return Object(i.a)(l,[{key:"componentDidMount",value:function(){this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){var e,t=this.props;if(this.state.popupVisible)return this.clickOutsideHandler||!this.isClickToHide()&&!this.isContextMenuToShow()||(e=t.getDocument(this.getRootDomNode()),this.clickOutsideHandler=C(e,"mousedown",this.onDocumentClick)),this.touchOutsideHandler||(e=e||t.getDocument(this.getRootDomNode()),this.touchOutsideHandler=C(e,"touchstart",this.onDocumentClick)),!this.contextMenuOutsideHandler1&&this.isContextMenuToShow()&&(e=e||t.getDocument(this.getRootDomNode()),this.contextMenuOutsideHandler1=C(e,"scroll",this.onContextMenuClose)),void(!this.contextMenuOutsideHandler2&&this.isContextMenuToShow()&&(this.contextMenuOutsideHandler2=C(window,"blur",this.onContextMenuClose)));this.clearOutsideHandler()}},{key:"componentWillUnmount",value:function(){this.clearDelayTimer(),this.clearOutsideHandler(),clearTimeout(this.mouseDownTimeout),ae.cancel(this.attachId)}},{key:"getPopupDomNode",value:function(){var e;return(null===(e=this.popupRef.current)||void 0===e?void 0:e.getElement())||null}},{key:"getPopupAlign",value:function(){var e=this.props,t=e.popupPlacement,n=e.popupAlign,o=e.builtinPlacements;return t&&o?function(e,t,n){var o=e[t]||{};return Object(r.a)(Object(r.a)({},o),n)}(o,t,n):n}},{key:"setPopupVisible",value:function(e,t){var n=this.props.alignPoint,r=this.state.popupVisible;this.clearDelayTimer(),r!==e&&("popupVisible"in this.props||this.setState({popupVisible:e,prevPopupVisible:r}),this.props.onPopupVisibleChange(e)),n&&t&&e&&this.setPoint(t)}},{key:"delaySetPopupVisible",value:function(e,t,n){var r=this,o=1e3*t;if(this.clearDelayTimer(),o){var i=n?{pageX:n.pageX,pageY:n.pageY}:null;this.delayTimer=window.setTimeout((function(){r.setPopupVisible(e,i),r.clearDelayTimer()}),o)}else this.setPopupVisible(e,n)}},{key:"clearDelayTimer",value:function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)}},{key:"clearOutsideHandler",value:function(){this.clickOutsideHandler&&(this.clickOutsideHandler.remove(),this.clickOutsideHandler=null),this.contextMenuOutsideHandler1&&(this.contextMenuOutsideHandler1.remove(),this.contextMenuOutsideHandler1=null),this.contextMenuOutsideHandler2&&(this.contextMenuOutsideHandler2.remove(),this.contextMenuOutsideHandler2=null),this.touchOutsideHandler&&(this.touchOutsideHandler.remove(),this.touchOutsideHandler=null)}},{key:"createTwoChains",value:function(e){var t=this.props.children.props,n=this.props;return t[e]&&n[e]?this["fire".concat(e)]:t[e]||n[e]}},{key:"isClickToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("click")||-1!==n.indexOf("click")}},{key:"isContextMenuOnly",value:function(){var e=this.props.action;return"contextMenu"===e||1===e.length&&"contextMenu"===e[0]}},{key:"isContextMenuToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("contextMenu")||-1!==n.indexOf("contextMenu")}},{key:"isClickToHide",value:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("click")||-1!==n.indexOf("click")}},{key:"isMouseEnterToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("hover")||-1!==n.indexOf("mouseEnter")}},{key:"isMouseLeaveToHide",value:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("hover")||-1!==n.indexOf("mouseLeave")}},{key:"isFocusToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("focus")||-1!==n.indexOf("focus")}},{key:"isBlurToHide",value:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("focus")||-1!==n.indexOf("blur")}},{key:"forcePopupAlign",value:function(){var e;this.state.popupVisible&&(null===(e=this.popupRef.current)||void 0===e||e.forceAlign())}},{key:"fireEvents",value:function(e,t){var n=this.props.children.props[e];n&&n(t);var r=this.props[e];r&&r(t)}},{key:"close",value:function(){this.setPopupVisible(!1)}},{key:"render",value:function(){var t=this.state.popupVisible,n=this.props,o=n.children,i=n.forceRender,a=n.alignPoint,s=n.className,l=n.autoDestroy,u=c.Children.only(o),d={key:"trigger"};this.isContextMenuToShow()?d.onContextMenu=this.onContextMenu:d.onContextMenu=this.createTwoChains("onContextMenu"),this.isClickToHide()||this.isClickToShow()?(d.onClick=this.onClick,d.onMouseDown=this.onMouseDown,d.onTouchStart=this.onTouchStart):(d.onClick=this.createTwoChains("onClick"),d.onMouseDown=this.createTwoChains("onMouseDown"),d.onTouchStart=this.createTwoChains("onTouchStart")),this.isMouseEnterToShow()?(d.onMouseEnter=this.onMouseEnter,a&&(d.onMouseMove=this.onMouseMove)):d.onMouseEnter=this.createTwoChains("onMouseEnter"),this.isMouseLeaveToHide()?d.onMouseLeave=this.onMouseLeave:d.onMouseLeave=this.createTwoChains("onMouseLeave"),this.isFocusToShow()||this.isBlurToHide()?(d.onFocus=this.onFocus,d.onBlur=this.onBlur):(d.onFocus=this.createTwoChains("onFocus"),d.onBlur=this.createTwoChains("onBlur"));var p=I()(u&&u.props&&u.props.className,s);p&&(d.className=p);var h=Object(r.a)({},d);ve(u)&&(h.ref=me(this.triggerRef,u.ref));var f,m=c.cloneElement(u,h);return(t||this.popupRef.current||i)&&(f=c.createElement(e,{key:"portal",getContainer:this.getContainer,didUpdate:this.handlePortalUpdate},this.getComponent())),!t&&l&&(f=null),c.createElement(jn.Provider,{value:this.triggerContextValue},m,f)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.popupVisible,r={};return void 0!==n&&t.popupVisible!==n&&(r.popupVisible=n,r.prevPopupVisible=t.popupVisible),r}}]),l}(c.Component);return Object(g.a)(t,"contextType",jn),Object(g.a)(t,"defaultProps",{prefixCls:"rc-trigger-popup",getPopupClassNameFromAlign:Bn,getDocument:Vn,onPopupVisibleChange:Fn,afterPopupVisibleChange:Fn,onPopupAlign:Fn,popupClassName:"",mouseEnterDelay:0,mouseLeaveDelay:.1,focusDelay:0,blurDelay:.15,popupStyle:{},destroyPopupOnHide:!1,popupAlign:{},defaultPopupVisible:!1,mask:!1,maskClosable:!0,action:[],showAction:[],hideAction:[],autoDestroy:!1}),t}(ye),Wn={adjustX:1,adjustY:1},qn=[0,0],Kn={left:{points:["cr","cl"],overflow:Wn,offset:[-4,0],targetOffset:qn},right:{points:["cl","cr"],overflow:Wn,offset:[4,0],targetOffset:qn},top:{points:["bc","tc"],overflow:Wn,offset:[0,-4],targetOffset:qn},bottom:{points:["tc","bc"],overflow:Wn,offset:[0,4],targetOffset:qn},topLeft:{points:["bl","tl"],overflow:Wn,offset:[0,-4],targetOffset:qn},leftTop:{points:["tr","tl"],overflow:Wn,offset:[-4,0],targetOffset:qn},topRight:{points:["br","tr"],overflow:Wn,offset:[0,-4],targetOffset:qn},rightTop:{points:["tl","tr"],overflow:Wn,offset:[4,0],targetOffset:qn},bottomRight:{points:["tr","br"],overflow:Wn,offset:[0,4],targetOffset:qn},rightBottom:{points:["bl","br"],overflow:Wn,offset:[4,0],targetOffset:qn},bottomLeft:{points:["tl","bl"],overflow:Wn,offset:[0,4],targetOffset:qn},leftBottom:{points:["br","bl"],overflow:Wn,offset:[-4,0],targetOffset:qn}};function Yn(e){var t=e.showArrow,n=e.arrowContent,r=e.children,o=e.prefixCls,i=e.id,a=e.overlayInnerStyle,s=e.className,l=e.style;return c.createElement("div",{className:I()("".concat(o,"-content"),s),style:l},!1!==t&&c.createElement("div",{className:"".concat(o,"-arrow"),key:"arrow"},n),c.createElement("div",{className:"".concat(o,"-inner"),id:i,role:"tooltip",style:a},"function"===typeof r?r():r))}var zn=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow"],Xn=function(e,t){var n=e.overlayClassName,o=e.trigger,i=void 0===o?["hover"]:o,a=e.mouseEnterDelay,s=void 0===a?0:a,l=e.mouseLeaveDelay,u=void 0===l?.1:l,d=e.overlayStyle,p=e.prefixCls,h=void 0===p?"rc-tooltip":p,f=e.children,m=e.onVisibleChange,v=e.afterVisibleChange,g=e.transitionName,E=e.animation,b=e.motion,T=e.placement,S=void 0===T?"right":T,O=e.align,R=void 0===O?{}:O,C=e.destroyTooltipOnHide,w=void 0!==C&&C,I=e.defaultVisible,A=e.getTooltipContainer,k=e.overlayInnerStyle,P=e.arrowContent,D=e.overlay,M=e.id,L=e.showArrow,x=void 0===L||L,U=Object(_.a)(e,zn),j=Object(c.useRef)(null);Object(c.useImperativeHandle)(t,(function(){return j.current}));var F=Object(r.a)({},U);"visible"in e&&(F.popupVisible=e.visible);var B=!1,V=!1;if("boolean"===typeof w)B=w;else if(w&&"object"===Object(N.a)(w)){var H=w.keepParent;B=!0===H,V=!1===H}return c.createElement(Gn,Object(y.a)({popupClassName:n,prefixCls:h,popup:function(){return c.createElement(Yn,{showArrow:x,arrowContent:P,key:"content",prefixCls:h,id:M,overlayInnerStyle:k},D)},action:i,builtinPlacements:Kn,popupPlacement:S,ref:j,popupAlign:R,getPopupContainer:A,onPopupVisibleChange:m,afterPopupVisibleChange:v,popupTransitionName:g,popupAnimation:E,popupMotion:b,defaultPopupVisible:I,destroyPopupOnHide:B,autoDestroy:V,mouseLeaveDelay:u,popupStyle:d,mouseEnterDelay:s},F),f)},Jn=Object(c.forwardRef)(Xn),Zn=c.forwardRef((function(e,t){var n=e.visible,r=e.overlay,o=c.useRef(null),i=me(t,o),a=c.useRef(null);function s(){ae.cancel(a.current)}return c.useEffect((function(){return n?a.current=ae((function(){var e;null===(e=o.current)||void 0===e||e.forcePopupAlign()})):s(),s}),[n,r]),c.createElement(Jn,Object(y.a)({ref:i},e))}));var Qn=X;Qn.Range=Q,Qn.Handle=P,Qn.createSliderWithTooltip=function(e){var t;return t=function(t){Object(a.a)(c,t);var n=Object(s.a)(c);function c(){var e;return Object(o.a)(this,c),(e=n.apply(this,arguments)).state={visibles:{}},e.handleTooltipVisibleChange=function(t,n){e.setState((function(e){return{visibles:Object(r.a)(Object(r.a)({},e.visibles),{},Object(g.a)({},t,n))}}))},e.handleWithTooltip=function(t){var n,o=t.value,i=t.dragging,a=t.index,s=t.disabled,c=Object(_.a)(t,["value","dragging","index","disabled"]),u=e.props,d=u.tipFormatter,p=u.tipProps,h=u.handleStyle,f=u.getTooltipContainer,m=p.prefixCls,v=void 0===m?"rc-slider-tooltip":m,g=p.overlay,E=void 0===g?d(o):g,b=p.placement,T=void 0===b?"top":b,S=p.visible,O=void 0!==S&&S,R=Object(_.a)(p,["prefixCls","overlay","placement","visible"]);return n=Array.isArray(h)?h[a]||h[0]:h,l.a.createElement(Zn,Object(y.a)({},R,{getTooltipContainer:f,prefixCls:v,overlay:E,placement:T,visible:!s&&(e.state.visibles[a]||i)||O,key:a}),l.a.createElement(P,Object(y.a)({},c,{style:Object(r.a)({},n),value:o,onMouseEnter:function(){return e.handleTooltipVisibleChange(a,!0)},onMouseLeave:function(){return e.handleTooltipVisibleChange(a,!1)}})))},e}return Object(i.a)(c,[{key:"render",value:function(){return l.a.createElement(e,Object(y.a)({},this.props,{handle:this.handleWithTooltip}))}}]),c}(l.a.Component),t.defaultProps={tipFormatter:function(e){return e},handleStyle:[{}],tipProps:{},getTooltipContainer:function(e){return e.parentNode}},t};t.b=Qn},function(e,t,n){"use strict";n.r(t),n.d(t,"Popper",(function(){return Ne})),n.d(t,"Manager",(function(){return a})),n.d(t,"Reference",(function(){return De})),n.d(t,"usePopper",(function(){return Ce}));var r=n(2),o=r.createContext(),i=r.createContext();function a(e){var t=e.children,n=r.useState(null),a=n[0],s=n[1],c=r.useRef(!1);r.useEffect((function(){return function(){c.current=!0}}),[]);var l=r.useCallback((function(e){c.current||s(e)}),[]);return r.createElement(o.Provider,{value:a},r.createElement(i.Provider,{value:l},t))}var s=function(e){return Array.isArray(e)?e[0]:e},c=function(e){if("function"===typeof e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.apply(void 0,n)}},l=function(e,t){if("function"===typeof e)return c(e,t);null!=e&&(e.current=t)},u=function(e){return e.reduce((function(e,t){var n=t[0],r=t[1];return e[n]=r,e}),{})},d="undefined"!==typeof window&&window.document&&window.document.createElement?r.useLayoutEffect:r.useEffect,p=n(19);function h(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function f(e){return e instanceof h(e).Element||e instanceof Element}function m(e){return e instanceof h(e).HTMLElement||e instanceof HTMLElement}function v(e){return"undefined"!==typeof ShadowRoot&&(e instanceof h(e).ShadowRoot||e instanceof ShadowRoot)}var g=Math.max,E=Math.min,y=Math.round;function _(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function b(){return!/^((?!chrome|android).)*safari/i.test(_())}function T(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getBoundingClientRect(),o=1,i=1;t&&m(e)&&(o=e.offsetWidth>0&&y(r.width)/e.offsetWidth||1,i=e.offsetHeight>0&&y(r.height)/e.offsetHeight||1);var a=(f(e)?h(e):window).visualViewport,s=!b()&&n,c=(r.left+(s&&a?a.offsetLeft:0))/o,l=(r.top+(s&&a?a.offsetTop:0))/i,u=r.width/o,d=r.height/i;return{width:u,height:d,top:l,right:c+u,bottom:l+d,left:c,x:c,y:l}}function S(e){var t=h(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function O(e){return e?(e.nodeName||"").toLowerCase():null}function R(e){return((f(e)?e.ownerDocument:e.document)||window.document).documentElement}function C(e){return T(R(e)).left+S(e).scrollLeft}function w(e){return h(e).getComputedStyle(e)}function I(e){var t=w(e),n=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function A(e,t,n){void 0===n&&(n=!1);var r=m(t),o=m(t)&&function(e){var t=e.getBoundingClientRect(),n=y(t.width)/e.offsetWidth||1,r=y(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),i=R(t),a=T(e,o,n),s={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(r||!r&&!n)&&(("body"!==O(t)||I(i))&&(s=function(e){return e!==h(e)&&m(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:S(e);var t}(t)),m(t)?((c=T(t,!0)).x+=t.clientLeft,c.y+=t.clientTop):i&&(c.x=C(i))),{x:a.left+s.scrollLeft-c.x,y:a.top+s.scrollTop-c.y,width:a.width,height:a.height}}function N(e){var t=T(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function k(e){return"html"===O(e)?e:e.assignedSlot||e.parentNode||(v(e)?e.host:null)||R(e)}function P(e){return["html","body","#document"].indexOf(O(e))>=0?e.ownerDocument.body:m(e)&&I(e)?e:P(k(e))}function D(e,t){var n;void 0===t&&(t=[]);var r=P(e),o=r===(null==(n=e.ownerDocument)?void 0:n.body),i=h(r),a=o?[i].concat(i.visualViewport||[],I(r)?r:[]):r,s=t.concat(a);return o?s:s.concat(D(k(a)))}function M(e){return["table","td","th"].indexOf(O(e))>=0}function L(e){return m(e)&&"fixed"!==w(e).position?e.offsetParent:null}function x(e){for(var t=h(e),n=L(e);n&&M(n)&&"static"===w(n).position;)n=L(n);return n&&("html"===O(n)||"body"===O(n)&&"static"===w(n).position)?t:n||function(e){var t=/firefox/i.test(_());if(/Trident/i.test(_())&&m(e)&&"fixed"===w(e).position)return null;var n=k(e);for(v(n)&&(n=n.host);m(n)&&["html","body"].indexOf(O(n))<0;){var r=w(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}var U="top",j="bottom",F="right",B="left",V="auto",H=[U,j,F,B],G="start",W="end",q="viewport",K="popper",Y=H.reduce((function(e,t){return e.concat([t+"-"+G,t+"-"+W])}),[]),z=[].concat(H,[V]).reduce((function(e,t){return e.concat([t,t+"-"+G,t+"-"+W])}),[]),X=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function J(e){var t=new Map,n=new Set,r=[];function o(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&o(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||o(e)})),r}function Z(e){var t;return function(){return t||(t=new Promise((function(n){Promise.resolve().then((function(){t=void 0,n(e())}))}))),t}}var Q={placement:"bottom",modifiers:[],strategy:"absolute"};function $(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"===typeof e.getBoundingClientRect)}))}function ee(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,o=t.defaultOptions,i=void 0===o?Q:o;return function(e,t,n){void 0===n&&(n=i);var o={placement:"bottom",orderedModifiers:[],options:Object.assign({},Q,i),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},a=[],s=!1,c={state:o,setOptions:function(n){var s="function"===typeof n?n(o.options):n;l(),o.options=Object.assign({},i,o.options,s),o.scrollParents={reference:f(e)?D(e):e.contextElement?D(e.contextElement):[],popper:D(t)};var u=function(e){var t=J(e);return X.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}(function(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(r,o.options.modifiers)));return o.orderedModifiers=u.filter((function(e){return e.enabled})),o.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,i=e.effect;if("function"===typeof i){var s=i({state:o,name:t,instance:c,options:r}),l=function(){};a.push(s||l)}})),c.update()},forceUpdate:function(){if(!s){var e=o.elements,t=e.reference,n=e.popper;if($(t,n)){o.rects={reference:A(t,x(n),"fixed"===o.options.strategy),popper:N(n)},o.reset=!1,o.placement=o.options.placement,o.orderedModifiers.forEach((function(e){return o.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0;r<o.orderedModifiers.length;r++)if(!0!==o.reset){var i=o.orderedModifiers[r],a=i.fn,l=i.options,u=void 0===l?{}:l,d=i.name;"function"===typeof a&&(o=a({state:o,options:u,name:d,instance:c})||o)}else o.reset=!1,r=-1}}},update:Z((function(){return new Promise((function(e){c.forceUpdate(),e(o)}))})),destroy:function(){l(),s=!0}};if(!$(e,t))return c;function l(){a.forEach((function(e){return e()})),a=[]}return c.setOptions(n).then((function(e){!s&&n.onFirstUpdate&&n.onFirstUpdate(e)})),c}}var te={passive:!0};function ne(e){return e.split("-")[0]}function re(e){return e.split("-")[1]}function oe(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function ie(e){var t,n=e.reference,r=e.element,o=e.placement,i=o?ne(o):null,a=o?re(o):null,s=n.x+n.width/2-r.width/2,c=n.y+n.height/2-r.height/2;switch(i){case U:t={x:s,y:n.y-r.height};break;case j:t={x:s,y:n.y+n.height};break;case F:t={x:n.x+n.width,y:c};break;case B:t={x:n.x-r.width,y:c};break;default:t={x:n.x,y:n.y}}var l=i?oe(i):null;if(null!=l){var u="y"===l?"height":"width";switch(a){case G:t[l]=t[l]-(n[u]/2-r[u]/2);break;case W:t[l]=t[l]+(n[u]/2-r[u]/2)}}return t}var ae={top:"auto",right:"auto",bottom:"auto",left:"auto"};function se(e){var t,n=e.popper,r=e.popperRect,o=e.placement,i=e.variation,a=e.offsets,s=e.position,c=e.gpuAcceleration,l=e.adaptive,u=e.roundOffsets,d=e.isFixed,p=a.x,f=void 0===p?0:p,m=a.y,v=void 0===m?0:m,g="function"===typeof u?u({x:f,y:v}):{x:f,y:v};f=g.x,v=g.y;var E=a.hasOwnProperty("x"),_=a.hasOwnProperty("y"),b=B,T=U,S=window;if(l){var O=x(n),C="clientHeight",I="clientWidth";if(O===h(n)&&"static"!==w(O=R(n)).position&&"absolute"===s&&(C="scrollHeight",I="scrollWidth"),o===U||(o===B||o===F)&&i===W)T=j,v-=(d&&O===S&&S.visualViewport?S.visualViewport.height:O[C])-r.height,v*=c?1:-1;if(o===B||(o===U||o===j)&&i===W)b=F,f-=(d&&O===S&&S.visualViewport?S.visualViewport.width:O[I])-r.width,f*=c?1:-1}var A,N=Object.assign({position:s},l&&ae),k=!0===u?function(e,t){var n=e.x,r=e.y,o=t.devicePixelRatio||1;return{x:y(n*o)/o||0,y:y(r*o)/o||0}}({x:f,y:v},h(n)):{x:f,y:v};return f=k.x,v=k.y,c?Object.assign({},N,((A={})[T]=_?"0":"",A[b]=E?"0":"",A.transform=(S.devicePixelRatio||1)<=1?"translate("+f+"px, "+v+"px)":"translate3d("+f+"px, "+v+"px, 0)",A)):Object.assign({},N,((t={})[T]=_?v+"px":"",t[b]=E?f+"px":"",t.transform="",t))}var ce={left:"right",right:"left",bottom:"top",top:"bottom"};function le(e){return e.replace(/left|right|bottom|top/g,(function(e){return ce[e]}))}var ue={start:"end",end:"start"};function de(e){return e.replace(/start|end/g,(function(e){return ue[e]}))}function pe(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&v(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function he(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function fe(e,t,n){return t===q?he(function(e,t){var n=h(e),r=R(e),o=n.visualViewport,i=r.clientWidth,a=r.clientHeight,s=0,c=0;if(o){i=o.width,a=o.height;var l=b();(l||!l&&"fixed"===t)&&(s=o.offsetLeft,c=o.offsetTop)}return{width:i,height:a,x:s+C(e),y:c}}(e,n)):f(t)?function(e,t){var n=T(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):he(function(e){var t,n=R(e),r=S(e),o=null==(t=e.ownerDocument)?void 0:t.body,i=g(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),a=g(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),s=-r.scrollLeft+C(e),c=-r.scrollTop;return"rtl"===w(o||n).direction&&(s+=g(n.clientWidth,o?o.clientWidth:0)-i),{width:i,height:a,x:s,y:c}}(R(e)))}function me(e,t,n,r){var o="clippingParents"===t?function(e){var t=D(k(e)),n=["absolute","fixed"].indexOf(w(e).position)>=0&&m(e)?x(e):e;return f(n)?t.filter((function(e){return f(e)&&pe(e,n)&&"body"!==O(e)})):[]}(e):[].concat(t),i=[].concat(o,[n]),a=i[0],s=i.reduce((function(t,n){var o=fe(e,n,r);return t.top=g(o.top,t.top),t.right=E(o.right,t.right),t.bottom=E(o.bottom,t.bottom),t.left=g(o.left,t.left),t}),fe(e,a,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function ve(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function ge(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}function Ee(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=void 0===r?e.placement:r,i=n.strategy,a=void 0===i?e.strategy:i,s=n.boundary,c=void 0===s?"clippingParents":s,l=n.rootBoundary,u=void 0===l?q:l,d=n.elementContext,p=void 0===d?K:d,h=n.altBoundary,m=void 0!==h&&h,v=n.padding,g=void 0===v?0:v,E=ve("number"!==typeof g?g:ge(g,H)),y=p===K?"reference":K,_=e.rects.popper,b=e.elements[m?y:p],S=me(f(b)?b:b.contextElement||R(e.elements.popper),c,u,a),O=T(e.elements.reference),C=ie({reference:O,element:_,strategy:"absolute",placement:o}),w=he(Object.assign({},_,C)),I=p===K?w:O,A={top:S.top-I.top+E.top,bottom:I.bottom-S.bottom+E.bottom,left:S.left-I.left+E.left,right:I.right-S.right+E.right},N=e.modifiersData.offset;if(p===K&&N){var k=N[o];Object.keys(A).forEach((function(e){var t=[F,j].indexOf(e)>=0?1:-1,n=[U,j].indexOf(e)>=0?"y":"x";A[e]+=k[n]*t}))}return A}function ye(e,t,n){return g(e,E(t,n))}function _e(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function be(e){return[U,F,j,B].some((function(t){return e[t]>=0}))}var Te=ee({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,o=r.scroll,i=void 0===o||o,a=r.resize,s=void 0===a||a,c=h(t.elements.popper),l=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&l.forEach((function(e){e.addEventListener("scroll",n.update,te)})),s&&c.addEventListener("resize",n.update,te),function(){i&&l.forEach((function(e){e.removeEventListener("scroll",n.update,te)})),s&&c.removeEventListener("resize",n.update,te)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=ie({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,o=void 0===r||r,i=n.adaptive,a=void 0===i||i,s=n.roundOffsets,c=void 0===s||s,l={placement:ne(t.placement),variation:re(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,se(Object.assign({},l,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:c})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,se(Object.assign({},l,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},{name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},o=t.elements[e];m(o)&&O(o)&&(Object.assign(o.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],o=t.attributes[e]||{},i=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});m(r)&&O(r)&&(Object.assign(r.style,i),Object.keys(o).forEach((function(e){r.removeAttribute(e)})))}))}},requires:["computeStyles"]},{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.offset,i=void 0===o?[0,0]:o,a=z.reduce((function(e,n){return e[n]=function(e,t,n){var r=ne(e),o=[B,U].indexOf(r)>=0?-1:1,i="function"===typeof n?n(Object.assign({},t,{placement:e})):n,a=i[0],s=i[1];return a=a||0,s=(s||0)*o,[B,F].indexOf(r)>=0?{x:s,y:a}:{x:a,y:s}}(n,t.rects,i),e}),{}),s=a[t.placement],c=s.x,l=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=l),t.modifiersData[r]=a}},{name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var o=n.mainAxis,i=void 0===o||o,a=n.altAxis,s=void 0===a||a,c=n.fallbackPlacements,l=n.padding,u=n.boundary,d=n.rootBoundary,p=n.altBoundary,h=n.flipVariations,f=void 0===h||h,m=n.allowedAutoPlacements,v=t.options.placement,g=ne(v),E=c||(g===v||!f?[le(v)]:function(e){if(ne(e)===V)return[];var t=le(e);return[de(e),t,de(t)]}(v)),y=[v].concat(E).reduce((function(e,n){return e.concat(ne(n)===V?function(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=n.boundary,i=n.rootBoundary,a=n.padding,s=n.flipVariations,c=n.allowedAutoPlacements,l=void 0===c?z:c,u=re(r),d=u?s?Y:Y.filter((function(e){return re(e)===u})):H,p=d.filter((function(e){return l.indexOf(e)>=0}));0===p.length&&(p=d);var h=p.reduce((function(t,n){return t[n]=Ee(e,{placement:n,boundary:o,rootBoundary:i,padding:a})[ne(n)],t}),{});return Object.keys(h).sort((function(e,t){return h[e]-h[t]}))}(t,{placement:n,boundary:u,rootBoundary:d,padding:l,flipVariations:f,allowedAutoPlacements:m}):n)}),[]),_=t.rects.reference,b=t.rects.popper,T=new Map,S=!0,O=y[0],R=0;R<y.length;R++){var C=y[R],w=ne(C),I=re(C)===G,A=[U,j].indexOf(w)>=0,N=A?"width":"height",k=Ee(t,{placement:C,boundary:u,rootBoundary:d,altBoundary:p,padding:l}),P=A?I?F:B:I?j:U;_[N]>b[N]&&(P=le(P));var D=le(P),M=[];if(i&&M.push(k[w]<=0),s&&M.push(k[P]<=0,k[D]<=0),M.every((function(e){return e}))){O=C,S=!1;break}T.set(C,M)}if(S)for(var L=function(e){var t=y.find((function(t){var n=T.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return O=t,"break"},x=f?3:1;x>0;x--){if("break"===L(x))break}t.placement!==O&&(t.modifiersData[r]._skip=!0,t.placement=O,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.mainAxis,i=void 0===o||o,a=n.altAxis,s=void 0!==a&&a,c=n.boundary,l=n.rootBoundary,u=n.altBoundary,d=n.padding,p=n.tether,h=void 0===p||p,f=n.tetherOffset,m=void 0===f?0:f,v=Ee(t,{boundary:c,rootBoundary:l,padding:d,altBoundary:u}),y=ne(t.placement),_=re(t.placement),b=!_,T=oe(y),S="x"===T?"y":"x",O=t.modifiersData.popperOffsets,R=t.rects.reference,C=t.rects.popper,w="function"===typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,I="number"===typeof w?{mainAxis:w,altAxis:w}:Object.assign({mainAxis:0,altAxis:0},w),A=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,k={x:0,y:0};if(O){if(i){var P,D="y"===T?U:B,M="y"===T?j:F,L="y"===T?"height":"width",V=O[T],H=V+v[D],W=V-v[M],q=h?-C[L]/2:0,K=_===G?R[L]:C[L],Y=_===G?-C[L]:-R[L],z=t.elements.arrow,X=h&&z?N(z):{width:0,height:0},J=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Z=J[D],Q=J[M],$=ye(0,R[L],X[L]),ee=b?R[L]/2-q-$-Z-I.mainAxis:K-$-Z-I.mainAxis,te=b?-R[L]/2+q+$+Q+I.mainAxis:Y+$+Q+I.mainAxis,ie=t.elements.arrow&&x(t.elements.arrow),ae=ie?"y"===T?ie.clientTop||0:ie.clientLeft||0:0,se=null!=(P=null==A?void 0:A[T])?P:0,ce=V+te-se,le=ye(h?E(H,V+ee-se-ae):H,V,h?g(W,ce):W);O[T]=le,k[T]=le-V}if(s){var ue,de="x"===T?U:B,pe="x"===T?j:F,he=O[S],fe="y"===S?"height":"width",me=he+v[de],ve=he-v[pe],ge=-1!==[U,B].indexOf(y),_e=null!=(ue=null==A?void 0:A[S])?ue:0,be=ge?me:he-R[fe]-C[fe]-_e+I.altAxis,Te=ge?he+R[fe]+C[fe]-_e-I.altAxis:ve,Se=h&&ge?function(e,t,n){var r=ye(e,t,n);return r>n?n:r}(be,he,Te):ye(h?be:me,he,h?Te:ve);O[S]=Se,k[S]=Se-he}t.modifiersData[r]=k}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,o=e.options,i=n.elements.arrow,a=n.modifiersData.popperOffsets,s=ne(n.placement),c=oe(s),l=[B,F].indexOf(s)>=0?"height":"width";if(i&&a){var u=function(e,t){return ve("number"!==typeof(e="function"===typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:ge(e,H))}(o.padding,n),d=N(i),p="y"===c?U:B,h="y"===c?j:F,f=n.rects.reference[l]+n.rects.reference[c]-a[c]-n.rects.popper[l],m=a[c]-n.rects.reference[c],v=x(i),g=v?"y"===c?v.clientHeight||0:v.clientWidth||0:0,E=f/2-m/2,y=u[p],_=g-d[l]-u[h],b=g/2-d[l]/2+E,T=ye(y,b,_),S=c;n.modifiersData[r]=((t={})[S]=T,t.centerOffset=T-b,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!==typeof r||(r=t.elements.popper.querySelector(r)))&&pe(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,o=t.rects.popper,i=t.modifiersData.preventOverflow,a=Ee(t,{elementContext:"reference"}),s=Ee(t,{altBoundary:!0}),c=_e(a,r),l=_e(s,o,i),u=be(c),d=be(l);t.modifiersData[n]={referenceClippingOffsets:c,popperEscapeOffsets:l,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}}]}),Se=n(715),Oe=n.n(Se),Re=[],Ce=function(e,t,n){void 0===n&&(n={});var o=r.useRef(null),i={onFirstUpdate:n.onFirstUpdate,placement:n.placement||"bottom",strategy:n.strategy||"absolute",modifiers:n.modifiers||Re},a=r.useState({styles:{popper:{position:i.strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),s=a[0],c=a[1],l=r.useMemo((function(){return{name:"updateState",enabled:!0,phase:"write",fn:function(e){var t=e.state,n=Object.keys(t.elements);p.flushSync((function(){c({styles:u(n.map((function(e){return[e,t.styles[e]||{}]}))),attributes:u(n.map((function(e){return[e,t.attributes[e]]})))})}))},requires:["computeStyles"]}}),[]),h=r.useMemo((function(){var e={onFirstUpdate:i.onFirstUpdate,placement:i.placement,strategy:i.strategy,modifiers:[].concat(i.modifiers,[l,{name:"applyStyles",enabled:!1}])};return Oe()(o.current,e)?o.current||e:(o.current=e,e)}),[i.onFirstUpdate,i.placement,i.strategy,i.modifiers,l]),f=r.useRef();return d((function(){f.current&&f.current.setOptions(h)}),[h]),d((function(){if(null!=e&&null!=t){var r=(n.createPopper||Te)(e,t,h);return f.current=r,function(){r.destroy(),f.current=null}}}),[e,t,n.createPopper]),{state:f.current?f.current.state:null,styles:s.styles,attributes:s.attributes,update:f.current?f.current.update:null,forceUpdate:f.current?f.current.forceUpdate:null}},we=function(){},Ie=function(){return Promise.resolve(null)},Ae=[];function Ne(e){var t=e.placement,n=void 0===t?"bottom":t,i=e.strategy,a=void 0===i?"absolute":i,c=e.modifiers,u=void 0===c?Ae:c,d=e.referenceElement,p=e.onFirstUpdate,h=e.innerRef,f=e.children,m=r.useContext(o),v=r.useState(null),g=v[0],E=v[1],y=r.useState(null),_=y[0],b=y[1];r.useEffect((function(){l(h,g)}),[h,g]);var T=r.useMemo((function(){return{placement:n,strategy:a,onFirstUpdate:p,modifiers:[].concat(u,[{name:"arrow",enabled:null!=_,options:{element:_}}])}}),[n,a,p,u,_]),S=Ce(d||m,g,T),O=S.state,R=S.styles,C=S.forceUpdate,w=S.update,I=r.useMemo((function(){return{ref:E,style:R.popper,placement:O?O.placement:n,hasPopperEscaped:O&&O.modifiersData.hide?O.modifiersData.hide.hasPopperEscaped:null,isReferenceHidden:O&&O.modifiersData.hide?O.modifiersData.hide.isReferenceHidden:null,arrowProps:{style:R.arrow,ref:b},forceUpdate:C||we,update:w||Ie}}),[E,b,n,O,R,w,C]);return s(f)(I)}var ke=n(716),Pe=n.n(ke);function De(e){var t=e.children,n=e.innerRef,o=r.useContext(i),a=r.useCallback((function(e){l(n,e),c(o,e)}),[n,o]);return r.useEffect((function(){return function(){return l(n,null)}}),[]),r.useEffect((function(){Pe()(Boolean(o),"`Reference` should not be used outside of a `Manager` component.")}),[o]),s(t)({ref:a})}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Qe}));var r=n(25),o=n(224);function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Object(o.a)(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw a}}}}var a=n(479),s=n(424),c=n(126);function l(e,t){if(null==e)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}var u=n(425),d=n(303),p=n(427),h=n(132),f=n(124),m=n(35),v=n(129),g=n(130),E=n(127),y=n(128),_=n(34),b=function(){function e(){Object(E.a)(this,e),Object(_.a)(this,"priority",void 0),Object(_.a)(this,"subPriority",0)}return Object(y.a)(e,[{key:"validate",value:function(e,t){return!0}}]),e}(),T=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(e,r,o,i,a){var s;return Object(E.a)(this,n),(s=t.call(this)).value=e,s.validateValue=r,s.setValue=o,s.priority=i,a&&(s.subPriority=a),s}return Object(y.a)(n,[{key:"validate",value:function(e,t){return this.validateValue(e,this.value,t)}},{key:"set",value:function(e,t,n){return this.setValue(e,t,this.value,n)}}]),n}(b),S=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",10),Object(_.a)(Object(m.a)(e),"subPriority",-1),e}return Object(y.a)(n,[{key:"set",value:function(e,t){if(t.timestampIsSet)return e;var n=new Date(0);return n.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),n.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),n}}]),n}(b),O=function(){function e(){Object(E.a)(this,e),Object(_.a)(this,"incompatibleTokens",void 0),Object(_.a)(this,"priority",void 0),Object(_.a)(this,"subPriority",void 0)}return Object(y.a)(e,[{key:"run",value:function(e,t,n,r){var o=this.parse(e,t,n,r);return o?{setter:new T(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}},{key:"validate",value:function(e,t,n){return!0}}]),e}(),R=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",140),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["R","u","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}}},{key:"set",value:function(e,t,n){return t.era=n,e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e}}]),n}(O),C=n(433),w=/^(1[0-2]|0?\d)/,I=/^(3[0-1]|[0-2]?\d)/,A=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,N=/^(5[0-3]|[0-4]?\d)/,k=/^(2[0-3]|[0-1]?\d)/,P=/^(2[0-4]|[0-1]?\d)/,D=/^(1[0-1]|0?\d)/,M=/^(1[0-2]|0?\d)/,L=/^[0-5]?\d/,x=/^[0-5]?\d/,U=/^\d/,j=/^\d{1,2}/,F=/^\d{1,3}/,B=/^\d{1,4}/,V=/^-?\d+/,H=/^-?\d/,G=/^-?\d{1,2}/,W=/^-?\d{1,3}/,q=/^-?\d{1,4}/,K=/^([+-])(\d{2})(\d{2})?|Z/,Y=/^([+-])(\d{2})(\d{2})|Z/,z=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,X=/^([+-])(\d{2}):(\d{2})|Z/,J=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function Z(e,t){return e?{value:t(e.value),rest:e.rest}:e}function Q(e,t){var n=t.match(e);return n?{value:parseInt(n[0],10),rest:t.slice(n[0].length)}:null}function $(e,t){var n=t.match(e);if(!n)return null;if("Z"===n[0])return{value:0,rest:t.slice(1)};var r="+"===n[1]?1:-1,o=n[2]?parseInt(n[2],10):0,i=n[3]?parseInt(n[3],10):0,a=n[5]?parseInt(n[5],10):0;return{value:r*(o*C.a+i*C.b+a*C.c),rest:t.slice(n[0].length)}}function ee(e){return Q(V,e)}function te(e,t){switch(e){case 1:return Q(U,t);case 2:return Q(j,t);case 3:return Q(F,t);case 4:return Q(B,t);default:return Q(new RegExp("^\\d{1,"+e+"}"),t)}}function ne(e,t){switch(e){case 1:return Q(H,t);case 2:return Q(G,t);case 3:return Q(W,t);case 4:return Q(q,t);default:return Q(new RegExp("^-?\\d{1,"+e+"}"),t)}}function re(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function oe(e,t){var n,r=t>0,o=r?t:1-t;if(o<=50)n=e||100;else{var i=o+50;n=e+100*Math.floor(i/100)-(e>=i%100?100:0)}return r?n:1-n}function ie(e){return e%400===0||e%4===0&&e%100!==0}var ae=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",130),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){var r=function(e){return{year:e,isTwoDigitYear:"yy"===t}};switch(t){case"y":return Z(te(4,e),r);case"yo":return Z(n.ordinalNumber(e,{unit:"year"}),r);default:return Z(te(t.length,e),r)}}},{key:"validate",value:function(e,t){return t.isTwoDigitYear||t.year>0}},{key:"set",value:function(e,t,n){var r=e.getUTCFullYear();if(n.isTwoDigitYear){var o=oe(n.year,r);return e.setUTCFullYear(o,0,1),e.setUTCHours(0,0,0,0),e}var i="era"in t&&1!==t.era?1-n.year:n.year;return e.setUTCFullYear(i,0,1),e.setUTCHours(0,0,0,0),e}}]),n}(O),se=n(305),ce=n(206),le=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",130),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){var r=function(e){return{year:e,isTwoDigitYear:"YY"===t}};switch(t){case"Y":return Z(te(4,e),r);case"Yo":return Z(n.ordinalNumber(e,{unit:"year"}),r);default:return Z(te(t.length,e),r)}}},{key:"validate",value:function(e,t){return t.isTwoDigitYear||t.year>0}},{key:"set",value:function(e,t,n,r){var o=Object(se.a)(e,r);if(n.isTwoDigitYear){var i=oe(n.year,o);return e.setUTCFullYear(i,0,r.firstWeekContainsDate),e.setUTCHours(0,0,0,0),Object(ce.a)(e,r)}var a="era"in t&&1!==t.era?1-n.year:n.year;return e.setUTCFullYear(a,0,r.firstWeekContainsDate),e.setUTCHours(0,0,0,0),Object(ce.a)(e,r)}}]),n}(O),ue=n(207),de=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",130),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t){return ne("R"===t?4:t.length,e)}},{key:"set",value:function(e,t,n){var r=new Date(0);return r.setUTCFullYear(n,0,4),r.setUTCHours(0,0,0,0),Object(ue.a)(r)}}]),n}(O),pe=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",130),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t){return ne("u"===t?4:t.length,e)}},{key:"set",value:function(e,t,n){return e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e}}]),n}(O),he=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",120),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"Q":case"QQ":return te(t.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=1&&t<=4}},{key:"set",value:function(e,t,n){return e.setUTCMonth(3*(n-1),1),e.setUTCHours(0,0,0,0),e}}]),n}(O),fe=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",120),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"q":case"qq":return te(t.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=1&&t<=4}},{key:"set",value:function(e,t,n){return e.setUTCMonth(3*(n-1),1),e.setUTCHours(0,0,0,0),e}}]),n}(O),me=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),Object(_.a)(Object(m.a)(e),"priority",110),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){var r=function(e){return e-1};switch(t){case"M":return Z(Q(w,e),r);case"MM":return Z(te(2,e),r);case"Mo":return Z(n.ordinalNumber(e,{unit:"month"}),r);case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,n){return e.setUTCMonth(n,1),e.setUTCHours(0,0,0,0),e}}]),n}(O),ve=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",110),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){var r=function(e){return e-1};switch(t){case"L":return Z(Q(w,e),r);case"LL":return Z(te(2,e),r);case"Lo":return Z(n.ordinalNumber(e,{unit:"month"}),r);case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,n){return e.setUTCMonth(n,1),e.setUTCHours(0,0,0,0),e}}]),n}(O),ge=n(485);var Ee=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",100),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"w":return Q(N,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return te(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=53}},{key:"set",value:function(e,t,n,r){return Object(ce.a)(function(e,t,n){Object(f.a)(2,arguments);var r=Object(c.default)(e),o=Object(h.a)(t),i=Object(ge.a)(r,n)-o;return r.setUTCDate(r.getUTCDate()-7*i),r}(e,n,r),r)}}]),n}(O),ye=n(486);var _e=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",100),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"I":return Q(N,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return te(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=53}},{key:"set",value:function(e,t,n){return Object(ue.a)(function(e,t){Object(f.a)(2,arguments);var n=Object(c.default)(e),r=Object(h.a)(t),o=Object(ye.a)(n)-r;return n.setUTCDate(n.getUTCDate()-7*o),n}(e,n))}}]),n}(O),be=[31,28,31,30,31,30,31,31,30,31,30,31],Te=[31,29,31,30,31,30,31,31,30,31,30,31],Se=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",90),Object(_.a)(Object(m.a)(e),"subPriority",1),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"d":return Q(I,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return te(t.length,e)}}},{key:"validate",value:function(e,t){var n=ie(e.getUTCFullYear()),r=e.getUTCMonth();return n?t>=1&&t<=Te[r]:t>=1&&t<=be[r]}},{key:"set",value:function(e,t,n){return e.setUTCDate(n),e.setUTCHours(0,0,0,0),e}}]),n}(O),Oe=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",90),Object(_.a)(Object(m.a)(e),"subpriority",1),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"D":case"DD":return Q(A,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return te(t.length,e)}}},{key:"validate",value:function(e,t){return ie(e.getUTCFullYear())?t>=1&&t<=366:t>=1&&t<=365}},{key:"set",value:function(e,t,n){return e.setUTCMonth(0,n),e.setUTCHours(0,0,0,0),e}}]),n}(O),Re=n(169);function Ce(e,t,n){var r,o,i,a,s,l,u,d;Object(f.a)(2,arguments);var p=Object(Re.a)(),m=Object(h.a)(null!==(r=null!==(o=null!==(i=null!==(a=null===n||void 0===n?void 0:n.weekStartsOn)&&void 0!==a?a:null===n||void 0===n||null===(s=n.locale)||void 0===s||null===(l=s.options)||void 0===l?void 0:l.weekStartsOn)&&void 0!==i?i:p.weekStartsOn)&&void 0!==o?o:null===(u=p.locale)||void 0===u||null===(d=u.options)||void 0===d?void 0:d.weekStartsOn)&&void 0!==r?r:0);if(!(m>=0&&m<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var v=Object(c.default)(e),g=Object(h.a)(t),E=((g%7+7)%7<m?7:0)+g-v.getUTCDay();return v.setUTCDate(v.getUTCDate()+E),v}var we=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",90),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["D","i","e","c","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,n,r){return(e=Ce(e,n,r)).setUTCHours(0,0,0,0),e}}]),n}(O),Ie=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",90),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n,r){var o=function(e){var t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return Z(te(t.length,e),o);case"eo":return Z(n.ordinalNumber(e,{unit:"day"}),o);case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,n,r){return(e=Ce(e,n,r)).setUTCHours(0,0,0,0),e}}]),n}(O),Ae=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",90),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n,r){var o=function(e){var t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return Z(te(t.length,e),o);case"co":return Z(n.ordinalNumber(e,{unit:"day"}),o);case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,n,r){return(e=Ce(e,n,r)).setUTCHours(0,0,0,0),e}}]),n}(O);var Ne=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",90),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){var r=function(e){return 0===e?7:e};switch(t){case"i":case"ii":return te(t.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return Z(n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r);case"iiiii":return Z(n.day(e,{width:"narrow",context:"formatting"}),r);case"iiiiii":return Z(n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r);default:return Z(n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r)}}},{key:"validate",value:function(e,t){return t>=1&&t<=7}},{key:"set",value:function(e,t,n){return e=function(e,t){Object(f.a)(2,arguments);var n=Object(h.a)(t);n%7===0&&(n-=7);var r=Object(c.default)(e),o=((n%7+7)%7<1?7:0)+n-r.getUTCDay();return r.setUTCDate(r.getUTCDate()+o),r}(e,n),e.setUTCHours(0,0,0,0),e}}]),n}(O),ke=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",80),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["b","B","H","k","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,n){return e.setUTCHours(re(n),0,0,0),e}}]),n}(O),Pe=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",80),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["a","B","H","k","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,n){return e.setUTCHours(re(n),0,0,0),e}}]),n}(O),De=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",80),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["a","b","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,n){return e.setUTCHours(re(n),0,0,0),e}}]),n}(O),Me=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",70),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["H","K","k","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"h":return Q(M,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return te(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=12}},{key:"set",value:function(e,t,n){var r=e.getUTCHours()>=12;return r&&n<12?e.setUTCHours(n+12,0,0,0):r||12!==n?e.setUTCHours(n,0,0,0):e.setUTCHours(0,0,0,0),e}}]),n}(O),Le=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",70),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["a","b","h","K","k","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"H":return Q(k,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return te(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=23}},{key:"set",value:function(e,t,n){return e.setUTCHours(n,0,0,0),e}}]),n}(O),xe=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",70),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["h","H","k","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"K":return Q(D,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return te(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,n){return e.getUTCHours()>=12&&n<12?e.setUTCHours(n+12,0,0,0):e.setUTCHours(n,0,0,0),e}}]),n}(O),Ue=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",70),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["a","b","h","H","K","t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"k":return Q(P,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return te(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=24}},{key:"set",value:function(e,t,n){var r=n<=24?n%24:n;return e.setUTCHours(r,0,0,0),e}}]),n}(O),je=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",60),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"m":return Q(L,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return te(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=59}},{key:"set",value:function(e,t,n){return e.setUTCMinutes(n,0,0),e}}]),n}(O),Fe=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",50),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t,n){switch(t){case"s":return Q(x,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return te(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=59}},{key:"set",value:function(e,t,n){return e.setUTCSeconds(n,0),e}}]),n}(O),Be=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",30),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["t","T"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t){return Z(te(t.length,e),(function(e){return Math.floor(e*Math.pow(10,3-t.length))}))}},{key:"set",value:function(e,t,n){return e.setUTCMilliseconds(n),e}}]),n}(O),Ve=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",10),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["t","T","x"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t){switch(t){case"X":return $(K,e);case"XX":return $(Y,e);case"XXXX":return $(z,e);case"XXXXX":return $(J,e);default:return $(X,e)}}},{key:"set",value:function(e,t,n){return t.timestampIsSet?e:new Date(e.getTime()-n)}}]),n}(O),He=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",10),Object(_.a)(Object(m.a)(e),"incompatibleTokens",["t","T","X"]),e}return Object(y.a)(n,[{key:"parse",value:function(e,t){switch(t){case"x":return $(K,e);case"xx":return $(Y,e);case"xxxx":return $(z,e);case"xxxxx":return $(J,e);default:return $(X,e)}}},{key:"set",value:function(e,t,n){return t.timestampIsSet?e:new Date(e.getTime()-n)}}]),n}(O),Ge=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",40),Object(_.a)(Object(m.a)(e),"incompatibleTokens","*"),e}return Object(y.a)(n,[{key:"parse",value:function(e){return ee(e)}},{key:"set",value:function(e,t,n){return[new Date(1e3*n),{timestampIsSet:!0}]}}]),n}(O),We=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Object(_.a)(Object(m.a)(e),"priority",20),Object(_.a)(Object(m.a)(e),"incompatibleTokens","*"),e}return Object(y.a)(n,[{key:"parse",value:function(e){return ee(e)}},{key:"set",value:function(e,t,n){return[new Date(n),{timestampIsSet:!0}]}}]),n}(O),qe={G:new R,y:new ae,Y:new le,R:new de,u:new pe,Q:new he,q:new fe,M:new me,L:new ve,w:new Ee,I:new _e,d:new Se,D:new Oe,E:new we,e:new Ie,c:new Ae,i:new Ne,a:new ke,b:new Pe,B:new De,h:new Me,H:new Le,K:new xe,k:new Ue,m:new je,s:new Fe,S:new Be,X:new Ve,x:new He,t:new Ge,T:new We},Ke=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ye=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ze=/^'([^]*?)'?$/,Xe=/''/g,Je=/\S/,Ze=/[a-zA-Z]/;function Qe(e,t,n,o){var m,v,g,E,y,_,b,T,O,R,C,w,I,A,N,k,P,D;Object(f.a)(3,arguments);var M=String(e),L=String(t),x=Object(Re.a)(),U=null!==(m=null!==(v=null===o||void 0===o?void 0:o.locale)&&void 0!==v?v:x.locale)&&void 0!==m?m:a.a;if(!U.match)throw new RangeError("locale must contain match property");var j=Object(h.a)(null!==(g=null!==(E=null!==(y=null!==(_=null===o||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==_?_:null===o||void 0===o||null===(b=o.locale)||void 0===b||null===(T=b.options)||void 0===T?void 0:T.firstWeekContainsDate)&&void 0!==y?y:x.firstWeekContainsDate)&&void 0!==E?E:null===(O=x.locale)||void 0===O||null===(R=O.options)||void 0===R?void 0:R.firstWeekContainsDate)&&void 0!==g?g:1);if(!(j>=1&&j<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var F=Object(h.a)(null!==(C=null!==(w=null!==(I=null!==(A=null===o||void 0===o?void 0:o.weekStartsOn)&&void 0!==A?A:null===o||void 0===o||null===(N=o.locale)||void 0===N||null===(k=N.options)||void 0===k?void 0:k.weekStartsOn)&&void 0!==I?I:x.weekStartsOn)&&void 0!==w?w:null===(P=x.locale)||void 0===P||null===(D=P.options)||void 0===D?void 0:D.weekStartsOn)&&void 0!==C?C:0);if(!(F>=0&&F<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===L)return""===M?Object(c.default)(n):new Date(NaN);var B,V={firstWeekContainsDate:j,weekStartsOn:F,locale:U},H=[new S],G=L.match(Ye).map((function(e){var t=e[0];return t in u.a?(0,u.a[t])(e,U.formatLong):e})).join("").match(Ke),W=[],q=i(G);try{var K=function(){var t=B.value;null!==o&&void 0!==o&&o.useAdditionalWeekYearTokens||!Object(p.b)(t)||Object(p.c)(t,L,e),null!==o&&void 0!==o&&o.useAdditionalDayOfYearTokens||!Object(p.a)(t)||Object(p.c)(t,L,e);var n=t[0],r=qe[n];if(r){var i=r.incompatibleTokens;if(Array.isArray(i)){var a=W.find((function(e){return i.includes(e.token)||e.token===n}));if(a)throw new RangeError("The format string mustn't contain `".concat(a.fullToken,"` and `").concat(t,"` at the same time"))}else if("*"===r.incompatibleTokens&&W.length>0)throw new RangeError("The format string mustn't contain `".concat(t,"` and any other token at the same time"));W.push({token:n,fullToken:t});var s=r.run(M,t,U.match,V);if(!s)return{v:new Date(NaN)};H.push(s.setter),M=s.rest}else{if(n.match(Ze))throw new RangeError("Format string contains an unescaped latin alphabet character `"+n+"`");if("''"===t?t="'":"'"===n&&(t=t.match(ze)[1].replace(Xe,"'")),0!==M.indexOf(t))return{v:new Date(NaN)};M=M.slice(t.length)}};for(q.s();!(B=q.n()).done;){var Y=K();if("object"===Object(r.a)(Y))return Y.v}}catch(ne){q.e(ne)}finally{q.f()}if(M.length>0&&Je.test(M))return new Date(NaN);var z=H.map((function(e){return e.priority})).sort((function(e,t){return t-e})).filter((function(e,t,n){return n.indexOf(e)===t})).map((function(e){return H.filter((function(t){return t.priority===e})).sort((function(e,t){return t.subPriority-e.subPriority}))})).map((function(e){return e[0]})),X=Object(c.default)(n);if(isNaN(X.getTime()))return new Date(NaN);var J,Z=Object(s.a)(X,Object(d.a)(X)),Q={},$=i(z);try{for($.s();!(J=$.n()).done;){var ee=J.value;if(!ee.validate(Z,V))return new Date(NaN);var te=ee.set(Z,Q,V);Array.isArray(te)?(Z=te[0],l(Q,te[1])):Z=te}}catch(ne){$.e(ne)}finally{$.f()}return Z}},,,function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return L}));var r=n(423),o=n(424),i=n(126),a=n(124);var s=n(486),c=n(426),l=n(485),u=n(305);function d(e,t){for(var n=e<0?"-":"",r=Math.abs(e).toString();r.length<t;)r="0"+r;return n+r}var p={y:function(e,t){var n=e.getUTCFullYear(),r=n>0?n:1-n;return d("yy"===t?r%100:r,t.length)},M:function(e,t){var n=e.getUTCMonth();return"M"===t?String(n+1):d(n+1,2)},d:function(e,t){return d(e.getUTCDate(),t.length)},a:function(e,t){var n=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:function(e,t){return d(e.getUTCHours()%12||12,t.length)},H:function(e,t){return d(e.getUTCHours(),t.length)},m:function(e,t){return d(e.getUTCMinutes(),t.length)},s:function(e,t){return d(e.getUTCSeconds(),t.length)},S:function(e,t){var n=t.length,r=e.getUTCMilliseconds();return d(Math.floor(r*Math.pow(10,n-3)),t.length)}},h="midnight",f="noon",m="morning",v="afternoon",g="evening",E="night",y={G:function(e,t,n){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){var r=e.getUTCFullYear(),o=r>0?r:1-r;return n.ordinalNumber(o,{unit:"year"})}return p.y(e,t)},Y:function(e,t,n,r){var o=Object(u.a)(e,r),i=o>0?o:1-o;return"YY"===t?d(i%100,2):"Yo"===t?n.ordinalNumber(i,{unit:"year"}):d(i,t.length)},R:function(e,t){return d(Object(c.a)(e),t.length)},u:function(e,t){return d(e.getUTCFullYear(),t.length)},Q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return d(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return d(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){var r=e.getUTCMonth();switch(t){case"M":case"MM":return p.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return d(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){var o=Object(l.a)(e,r);return"wo"===t?n.ordinalNumber(o,{unit:"week"}):d(o,t.length)},I:function(e,t,n){var r=Object(s.a)(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):d(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):p.d(e,t)},D:function(e,t,n){var r=function(e){Object(a.a)(1,arguments);var t=Object(i.default)(e),n=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=n-t.getTime();return Math.floor(r/864e5)+1}(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):d(r,t.length)},E:function(e,t,n){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){var o=e.getUTCDay(),i=(o-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return d(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(o,{width:"short",context:"formatting"});default:return n.day(o,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){var o=e.getUTCDay(),i=(o-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return d(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(o,{width:"narrow",context:"standalone"});case"cccccc":return n.day(o,{width:"short",context:"standalone"});default:return n.day(o,{width:"wide",context:"standalone"})}},i:function(e,t,n){var r=e.getUTCDay(),o=0===r?7:r;switch(t){case"i":return String(o);case"ii":return d(o,t.length);case"io":return n.ordinalNumber(o,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){var r,o=e.getUTCHours();switch(r=12===o?f:0===o?h:o/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){var r,o=e.getUTCHours();switch(r=o>=17?g:o>=12?v:o>=4?m:E,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){var r=e.getUTCHours()%12;return 0===r&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return p.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):p.H(e,t)},K:function(e,t,n){var r=e.getUTCHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):d(r,t.length)},k:function(e,t,n){var r=e.getUTCHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):d(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):p.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):p.s(e,t)},S:function(e,t){return p.S(e,t)},X:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();if(0===o)return"Z";switch(t){case"X":return b(o);case"XXXX":case"XX":return T(o);default:return T(o,":")}},x:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();switch(t){case"x":return b(o);case"xxxx":case"xx":return T(o);default:return T(o,":")}},O:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+_(o,":");default:return"GMT"+T(o,":")}},z:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+_(o,":");default:return"GMT"+T(o,":")}},t:function(e,t,n,r){var o=r._originalDate||e;return d(Math.floor(o.getTime()/1e3),t.length)},T:function(e,t,n,r){return d((r._originalDate||e).getTime(),t.length)}};function _(e,t){var n=e>0?"-":"+",r=Math.abs(e),o=Math.floor(r/60),i=r%60;if(0===i)return n+String(o);var a=t||"";return n+String(o)+a+d(i,2)}function b(e,t){return e%60===0?(e>0?"-":"+")+d(Math.abs(e)/60,2):T(e,t)}function T(e,t){var n=t||"",r=e>0?"-":"+",o=Math.abs(e);return r+d(Math.floor(o/60),2)+n+d(o%60,2)}var S=y,O=n(425),R=n(303),C=n(427),w=n(132),I=n(169),A=n(479),N=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,k=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,P=/^'([^]*?)'?$/,D=/''/g,M=/[a-zA-Z]/;function L(e,t,n){var s,c,l,u,d,p,h,f,m,v,g,E,y,_,b,T,L,x;Object(a.a)(2,arguments);var U=String(t),j=Object(I.a)(),F=null!==(s=null!==(c=null===n||void 0===n?void 0:n.locale)&&void 0!==c?c:j.locale)&&void 0!==s?s:A.a,B=Object(w.a)(null!==(l=null!==(u=null!==(d=null!==(p=null===n||void 0===n?void 0:n.firstWeekContainsDate)&&void 0!==p?p:null===n||void 0===n||null===(h=n.locale)||void 0===h||null===(f=h.options)||void 0===f?void 0:f.firstWeekContainsDate)&&void 0!==d?d:j.firstWeekContainsDate)&&void 0!==u?u:null===(m=j.locale)||void 0===m||null===(v=m.options)||void 0===v?void 0:v.firstWeekContainsDate)&&void 0!==l?l:1);if(!(B>=1&&B<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var V=Object(w.a)(null!==(g=null!==(E=null!==(y=null!==(_=null===n||void 0===n?void 0:n.weekStartsOn)&&void 0!==_?_:null===n||void 0===n||null===(b=n.locale)||void 0===b||null===(T=b.options)||void 0===T?void 0:T.weekStartsOn)&&void 0!==y?y:j.weekStartsOn)&&void 0!==E?E:null===(L=j.locale)||void 0===L||null===(x=L.options)||void 0===x?void 0:x.weekStartsOn)&&void 0!==g?g:0);if(!(V>=0&&V<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!F.localize)throw new RangeError("locale must contain localize property");if(!F.formatLong)throw new RangeError("locale must contain formatLong property");var H=Object(i.default)(e);if(!Object(r.default)(H))throw new RangeError("Invalid time value");var G=Object(R.a)(H),W=Object(o.a)(H,G),q={firstWeekContainsDate:B,weekStartsOn:V,locale:F,_originalDate:H};return U.match(k).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,O.a[t])(e,F.formatLong):e})).join("").match(N).map((function(r){if("''"===r)return"'";var o=r[0];if("'"===o)return function(e){var t=e.match(P);if(!t)return e;return t[1].replace(D,"'")}(r);var i=S[o];if(i)return null!==n&&void 0!==n&&n.useAdditionalWeekYearTokens||!Object(C.b)(r)||Object(C.c)(r,t,String(e)),null!==n&&void 0!==n&&n.useAdditionalDayOfYearTokens||!Object(C.a)(r)||Object(C.c)(r,t,String(e)),i(W,r,F.localize,q);if(o.match(M))throw new RangeError("Format string contains an unescaped latin alphabet character `"+o+"`");return r})).join("")}},,function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var r=n(126),o=n(431),i=n(124);function a(e){return Object(i.a)(1,arguments),Object(o.default)(e,{weekStartsOn:1})}function s(e){Object(i.a)(1,arguments);var t=function(e){Object(i.a)(1,arguments);var t=Object(r.default)(e),n=t.getFullYear(),o=new Date(0);o.setFullYear(n+1,0,4),o.setHours(0,0,0,0);var s=a(o),c=new Date(0);c.setFullYear(n,0,4),c.setHours(0,0,0,0);var l=a(c);return t.getTime()>=s.getTime()?n+1:t.getTime()>=l.getTime()?n:n-1}(e),n=new Date(0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),a(n)}var c=6048e5;function l(e){Object(i.a)(1,arguments);var t=Object(r.default)(e),n=a(t).getTime()-s(t).getTime();return Math.round(n/c)+1}}])]);
//# sourceMappingURL=16.daa9efd3.chunk.js.map